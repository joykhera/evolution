{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4580923295841015, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.348687814278577, "policy_loss": -0.013939459993449784, "vf_loss": 6.359466173787596, "vf_explained_var": 0.05375530117403263, "kl": 0.015805491981726455, "entropy": 1.5933690284925794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.965557797253132, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.359419359266758, "policy_loss": -0.016927781251918836, "vf_loss": 7.373353987435499, "vf_explained_var": 0.04529421372960011, "kl": 0.01496580376722676, "entropy": 1.594465642919143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": 34.2028585377176, "episode_reward_min": -76.82303161400168, "episode_reward_mean": -6.333620803303808, "episode_len_mean": 190.89473684210526, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 3627, "policy_reward_min": {"agent_policy": -38.41151580700081, "adversary_policy": -26.085952298035714}, "policy_reward_max": {"agent_policy": 17.101429268858766, "adversary_policy": 24.319998860544406}, "policy_reward_mean": {"agent_policy": -3.166810401651901, "adversary_policy": -1.5834052008259505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5221623227962482, 32.82528815479078, 6.897967707704819, 7.402014575937251, -20.18230559397169, 30.813240871591, 4.666774352312991, -51.5968334589771, -28.939182302106722, -23.20860899395508, -46.99947905206316, 34.2028585377176, -25.296057700605864, -76.82303161400168, 32.681768687555376, 22.48234340524761, -27.242542084275485, 3.247640314516225, 5.251511252607024], "episode_lengths": [200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-0.2610811613981001, 16.41264407739539, 3.4489838538524085, 3.701007287968629, -10.091152796985845, 15.4066204357955, 2.3333871761564957, -25.798416729488544, -14.469591151053361, -11.604304496977534, -23.499739526031576, 17.101429268858766, -12.648028850302932, -38.41151580700081, 16.340884343777688, 11.241171702623802, -13.621271042137723, 1.6238201572581126, 2.6257556263035156], "policy_adversary_policy_reward": [-6.190651236322303, 5.929570074924198, 7.412484618527387, 9.000159458868005, 4.303486249343985, -0.8545023954915791, -0.6766396714813148, 4.377646959449944, -4.263872878338198, -5.827279918647648, 1.5864285471561352, 13.820191888639366, 3.7304607342780365, -1.3970735581215408, -24.516724406583627, -1.2816923229049149, -14.920770231699063, 0.45117908064570145, -1.885536069911197, -9.718768427066337, -18.158656005691867, -5.3410835203397085, 7.102094092934095, 9.999335175924667, -6.797769048415034, -5.850259801887898, -26.085952298035714, -12.325563508965072, 11.850193459557154, 4.490690884220534, -13.078827157920614, 24.319998860544406, -17.332653375031892, 3.7113823328941695, 10.687736513456333, -9.06391635619822, -1.3892822037017396, 4.015037830005255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47162847142881476, "mean_inference_ms": 1.2934009419466328, "mean_action_processing_ms": 0.20838806939636617, "mean_env_wait_ms": 0.08075290320285301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00512788170262387, "StateBufferConnector_ms": 0.004218754015470806, "ViewRequirementAgentConnector_ms": 0.07450392371729801}, "num_episodes": 19, "episode_return_max": 34.2028585377176, "episode_return_min": -76.82303161400168, "episode_return_mean": -6.333620803303808}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 480.2275981017615, "num_env_steps_trained_throughput_per_sec": 480.2275981017615, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 8329.392, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8329.353, "sample_time_ms": 965.212, "learn_time_ms": 7353.711, "learn_throughput": 543.943, "synch_weights_time_ms": 9.996}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 1, "trial_id": "eaa30_00000", "date": "2024-08-09_17-40-12", "timestamp": 1723239612, "time_this_iter_s": 8.333357810974121, "time_total_s": 8.333357810974121, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc51670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8.333357810974121, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 37.06923076923077, "ram_util_percent": 80.77692307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8491193305247675, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.187383598751492, "policy_loss": -0.00767962981160809, "vf_loss": 6.191665331522624, "vf_explained_var": 0.06792804892100986, "kl": 0.016989467635987295, "entropy": 1.586864799923367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2507908000300327, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.356225546697775, "policy_loss": -0.008304673584643752, "vf_loss": 7.361082383493582, "vf_explained_var": -0.012529924698173999, "kl": 0.01723916413417707, "entropy": 1.5879087975869577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": 104.73484225014343, "episode_reward_min": -76.82303161400168, "episode_reward_mean": 15.89997812363979, "episode_len_mean": 190.68421052631578, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 7246, "policy_reward_min": {"agent_policy": -38.41151580700081, "adversary_policy": -26.085952298035714}, "policy_reward_max": {"agent_policy": 52.3674211250717, "adversary_policy": 36.138131665882014}, "policy_reward_mean": {"agent_policy": 7.949989061819899, "adversary_policy": 3.9749945309099495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5221623227962482, 32.82528815479078, 6.897967707704819, 7.402014575937251, -20.18230559397169, 30.813240871591, 4.666774352312991, -51.5968334589771, -28.939182302106722, -23.20860899395508, -46.99947905206316, 34.2028585377176, -25.296057700605864, -76.82303161400168, 32.681768687555376, 22.48234340524761, -27.242542084275485, 3.247640314516225, 5.251511252607024, -10.213551632857383, 54.46761256794197, 76.6130331367961, 0.29878486883842825, 62.946144063911035, 68.67297072689877, 29.30784659243337, 34.49732645879803, 104.73484225014343, 14.642612697470664, 58.5398141371336, 19.57921861997567, 37.3390522322742, 10.88617057419971, 56.805897746829345, 21.30425213285473, 52.6812805707894, 23.06613932721673, 8.368516889436682], "episode_lengths": [200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-0.2610811613981001, 16.41264407739539, 3.4489838538524085, 3.701007287968629, -10.091152796985845, 15.4066204357955, 2.3333871761564957, -25.798416729488544, -14.469591151053361, -11.604304496977534, -23.499739526031576, 17.101429268858766, -12.648028850302932, -38.41151580700081, 16.340884343777688, 11.241171702623802, -13.621271042137723, 1.6238201572581126, 2.6257556263035156, -5.106775816428703, 27.23380628397096, 38.30651656839805, 0.1493924344192079, 31.473072031955525, 34.3364853634494, 14.653923296216684, 17.248663229399003, 52.3674211250717, 7.32130634873532, 29.26990706856682, 9.789609309987833, 18.66952611613711, 5.443085287099855, 28.402948873414676, 10.652126066427362, 26.3406402853947, 11.533069663608366, 4.184258444718341], "policy_adversary_policy_reward": [-6.190651236322303, 5.929570074924198, 7.412484618527387, 9.000159458868005, 4.303486249343985, -0.8545023954915791, -0.6766396714813148, 4.377646959449944, -4.263872878338198, -5.827279918647648, 1.5864285471561352, 13.820191888639366, 3.7304607342780365, -1.3970735581215408, -24.516724406583627, -1.2816923229049149, -14.920770231699063, 0.45117908064570145, -1.885536069911197, -9.718768427066337, -18.158656005691867, -5.3410835203397085, 7.102094092934095, 9.999335175924667, -6.797769048415034, -5.850259801887898, -26.085952298035714, -12.325563508965072, 11.850193459557154, 4.490690884220534, -13.078827157920614, 24.319998860544406, -17.332653375031892, 3.7113823328941695, 10.687736513456333, -9.06391635619822, -1.3892822037017396, 4.015037830005255, 3.7424596985303413, -8.849235514959043, 12.309420056475815, 14.924386227495143, 13.406783465627555, 24.899733102770483, 3.3602795373487613, -3.2108871029295543, 22.38183750552585, 9.091234526429664, 22.59481379891666, 11.741671564532737, 12.782001530733838, 1.871921765482849, 9.858377052719524, 7.390286176679481, 36.138131665882014, 16.229289459189737, 11.517016015488712, -4.195709666753382, 20.05568769433562, 9.214219374231199, 12.172041265069224, -2.3824319550813895, 6.999931877348793, 11.669594238788317, 4.038971361355049, 1.4041139257448059, 9.275835132502024, 19.127113740912645, 8.514546505260281, 2.137579561167076, 19.68563875472956, 6.655001530665139, 19.081025261853693, -7.547955598245327, -1.0091106727281414, 5.193369117446484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46618074787571967, "mean_inference_ms": 1.2654130364153666, "mean_action_processing_ms": 0.20367001820491093, "mean_env_wait_ms": 0.08157379846632028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00491048160352205, "StateBufferConnector_ms": 0.0033698583904065585, "ViewRequirementAgentConnector_ms": 0.07177716807315224}, "num_episodes": 19, "episode_return_max": 104.73484225014343, "episode_return_min": -76.82303161400168, "episode_return_mean": 15.89997812363979}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 511.86583204249837, "num_env_steps_trained_throughput_per_sec": 511.86583204249837, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 8071.974, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8071.935, "sample_time_ms": 936.736, "learn_time_ms": 7124.791, "learn_throughput": 561.42, "synch_weights_time_ms": 9.988}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 2, "trial_id": "eaa30_00000", "date": "2024-08-09_17-40-20", "timestamp": 1723239620, "time_this_iter_s": 7.816991329193115, "time_total_s": 16.150349140167236, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc51b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16.150349140167236, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.37272727272727, "ram_util_percent": 80.56363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.909203037446138, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.823029192162569, "policy_loss": -0.003356456067462368, "vf_loss": 6.822926474374438, "vf_explained_var": 0.023754509731575293, "kl": 0.01729580815339451, "entropy": 1.5798991385591092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.413260407621662, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.534230063855648, "policy_loss": -0.002405342770604572, "vf_loss": 7.532822953661283, "vf_explained_var": 0.0015857101728518803, "kl": 0.01906231672716482, "entropy": 1.584287740662694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": 112.82855305834701, "episode_reward_min": -76.82303161400168, "episode_reward_mean": 19.567188421991204, "episode_len_mean": 186.15254237288136, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 10983, "policy_reward_min": {"agent_policy": -38.41151580700081, "adversary_policy": -33.47292247811911}, "policy_reward_max": {"agent_policy": 56.41427652917352, "adversary_policy": 40.33413292776079}, "policy_reward_mean": {"agent_policy": 9.783594210995604, "adversary_policy": 4.891797105497802}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5221623227962482, 32.82528815479078, 6.897967707704819, 7.402014575937251, -20.18230559397169, 30.813240871591, 4.666774352312991, -51.5968334589771, -28.939182302106722, -23.20860899395508, -46.99947905206316, 34.2028585377176, -25.296057700605864, -76.82303161400168, 32.681768687555376, 22.48234340524761, -27.242542084275485, 3.247640314516225, 5.251511252607024, -10.213551632857383, 54.46761256794197, 76.6130331367961, 0.29878486883842825, 62.946144063911035, 68.67297072689877, 29.30784659243337, 34.49732645879803, 104.73484225014343, 14.642612697470664, 58.5398141371336, 19.57921861997567, 37.3390522322742, 10.88617057419971, 56.805897746829345, 21.30425213285473, 52.6812805707894, 23.06613932721673, 8.368516889436682, 8.711710664347336, 54.68283686174268, 1.064670262032219, 48.549861364812216, -7.978241007312517, 32.25686768161485, 82.49864640017309, 78.48207213133495, -15.901657465059472, 74.2526960062756, -10.699294064470287, 0.8011131184865423, 11.775862632350815, -6.854717587455498, 52.87784528219379, -47.55904861379288, 20.233754678216528, -37.24478531855044, 0.5998390629136434, 96.88636305096892, 112.82855305834701], "episode_lengths": [200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 113, 200, 200, 200, 193, 200, 200, 200, 200, 89, 132, 200, 200, 200, 200, 200, 10, 200, 200], "policy_agent_policy_reward": [-0.2610811613981001, 16.41264407739539, 3.4489838538524085, 3.701007287968629, -10.091152796985845, 15.4066204357955, 2.3333871761564957, -25.798416729488544, -14.469591151053361, -11.604304496977534, -23.499739526031576, 17.101429268858766, -12.648028850302932, -38.41151580700081, 16.340884343777688, 11.241171702623802, -13.621271042137723, 1.6238201572581126, 2.6257556263035156, -5.106775816428703, 27.23380628397096, 38.30651656839805, 0.1493924344192079, 31.473072031955525, 34.3364853634494, 14.653923296216684, 17.248663229399003, 52.3674211250717, 7.32130634873532, 29.26990706856682, 9.789609309987833, 18.66952611613711, 5.443085287099855, 28.402948873414676, 10.652126066427362, 26.3406402853947, 11.533069663608366, 4.184258444718341, 4.355855332173663, 27.341418430871357, 0.5323351310161097, 24.274930682406136, -3.9891205036562596, 16.128433840807418, 41.249323200086565, 39.24103606566743, -7.950828732529736, 37.12634800313781, -5.349647032235142, 0.40055655924327205, 5.88793131617541, -3.4273587937277483, 26.438922641096838, -23.77952430689644, 10.116877339108258, -18.62239265927522, 0.29991953145682193, 48.44318152548451, 56.41427652917352], "policy_adversary_policy_reward": [-6.190651236322303, 5.929570074924198, 7.412484618527387, 9.000159458868005, 4.303486249343985, -0.8545023954915791, -0.6766396714813148, 4.377646959449944, -4.263872878338198, -5.827279918647648, 1.5864285471561352, 13.820191888639366, 3.7304607342780365, -1.3970735581215408, -24.516724406583627, -1.2816923229049149, -14.920770231699063, 0.45117908064570145, -1.885536069911197, -9.718768427066337, -18.158656005691867, -5.3410835203397085, 7.102094092934095, 9.999335175924667, -6.797769048415034, -5.850259801887898, -26.085952298035714, -12.325563508965072, 11.850193459557154, 4.490690884220534, -13.078827157920614, 24.319998860544406, -17.332653375031892, 3.7113823328941695, 10.687736513456333, -9.06391635619822, -1.3892822037017396, 4.015037830005255, 3.7424596985303413, -8.849235514959043, 12.309420056475815, 14.924386227495143, 13.406783465627555, 24.899733102770483, 3.3602795373487613, -3.2108871029295543, 22.38183750552585, 9.091234526429664, 22.59481379891666, 11.741671564532737, 12.782001530733838, 1.871921765482849, 9.858377052719524, 7.390286176679481, 36.138131665882014, 16.229289459189737, 11.517016015488712, -4.195709666753382, 20.05568769433562, 9.214219374231199, 12.172041265069224, -2.3824319550813895, 6.999931877348793, 11.669594238788317, 4.038971361355049, 1.4041139257448059, 9.275835132502024, 19.127113740912645, 8.514546505260281, 2.137579561167076, 19.68563875472956, 6.655001530665139, 19.081025261853693, -7.547955598245327, -1.0091106727281414, 5.193369117446484, 14.723813113358482, -10.367957781184819, 8.833695317649298, 18.50772311322205, 4.470126919082553, -3.937791788066445, 6.680228959865659, 17.594701722540478, -3.8729314699172104, -0.11618903373904033, 0.5132740020865088, 15.615159838720915, 27.867133934480524, 13.382189265606044, 21.384385998892487, 17.85665006677495, 0.38529744677901334, -8.33612617930875, 11.692574419033127, 25.433773584104692, -9.258797011237252, 3.9091499790021116, 16.431419192847155, -16.03086263360388, 19.04455033766711, -13.156619021491704, 0.2631716636183583, -3.6905304573461066, 1.0116948200361815, 25.427227821060665, -33.47292247811911, 9.693398171222674, -5.776729936342209, 15.893607275450462, -8.057546776824644, -10.564845882450573, -1.8977875994811981, 2.19770713093802, 40.33413292776079, 8.109048597723733, 37.03247408497264, 19.38180244420086]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4560248495616699, "mean_inference_ms": 1.22469121386689, "mean_action_processing_ms": 0.19845134569749995, "mean_env_wait_ms": 0.0789093160655204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004528538655426542, "StateBufferConnector_ms": 0.003015590926348153, "ViewRequirementAgentConnector_ms": 0.0676397549903999}, "num_episodes": 21, "episode_return_max": 112.82855305834701, "episode_return_min": -76.82303161400168, "episode_return_mean": 19.567188421991204}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 510.5449437940679, "num_env_steps_trained_throughput_per_sec": 510.5449437940679, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 7992.906, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7992.87, "sample_time_ms": 879.58, "learn_time_ms": 7103.072, "learn_throughput": 563.137, "synch_weights_time_ms": 9.81}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 3, "trial_id": "eaa30_00000", "date": "2024-08-09_17-40-28", "timestamp": 1723239628, "time_this_iter_s": 7.837363004684448, "time_total_s": 23.987712144851685, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc9bf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23.987712144851685, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 33.27272727272727, "ram_util_percent": 80.43636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.028282503223924, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.464893705125839, "policy_loss": 0.008338064393373552, "vf_loss": 6.4515234538487025, "vf_explained_var": 0.152977713579854, "kl": 0.025160908466944146, "entropy": 1.5925081077706877, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.507426102956136, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.226858665545781, "policy_loss": -0.006737532306578942, "vf_loss": 7.229631677766641, "vf_explained_var": 0.004930697443584601, "kl": 0.01982260102619572, "entropy": 1.5880456262578566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 112.82855305834701, "episode_reward_min": -76.82303161400168, "episode_reward_mean": 23.426468679242625, "episode_len_mean": 186.92307692307693, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 14580, "policy_reward_min": {"agent_policy": -38.41151580700081, "adversary_policy": -33.47292247811911}, "policy_reward_max": {"agent_policy": 56.41427652917352, "adversary_policy": 46.16603727586835}, "policy_reward_mean": {"agent_policy": 11.713234339621314, "adversary_policy": 5.856617169810656}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5221623227962482, 32.82528815479078, 6.897967707704819, 7.402014575937251, -20.18230559397169, 30.813240871591, 4.666774352312991, -51.5968334589771, -28.939182302106722, -23.20860899395508, -46.99947905206316, 34.2028585377176, -25.296057700605864, -76.82303161400168, 32.681768687555376, 22.48234340524761, -27.242542084275485, 3.247640314516225, 5.251511252607024, -10.213551632857383, 54.46761256794197, 76.6130331367961, 0.29878486883842825, 62.946144063911035, 68.67297072689877, 29.30784659243337, 34.49732645879803, 104.73484225014343, 14.642612697470664, 58.5398141371336, 19.57921861997567, 37.3390522322742, 10.88617057419971, 56.805897746829345, 21.30425213285473, 52.6812805707894, 23.06613932721673, 8.368516889436682, 8.711710664347336, 54.68283686174268, 1.064670262032219, 48.549861364812216, -7.978241007312517, 32.25686768161485, 82.49864640017309, 78.48207213133495, -15.901657465059472, 74.2526960062756, -10.699294064470287, 0.8011131184865423, 11.775862632350815, -6.854717587455498, 52.87784528219379, -47.55904861379288, 20.233754678216528, -37.24478531855044, 0.5998390629136434, 96.88636305096892, 112.82855305834701, 50.977396676559536, 8.391172747181749, 50.679040718045314, -0.7937120896973155, -1.54087341669792, 79.34737033909288, 42.392601435088444, 8.323216436448888, 35.708620083979795, 64.15819642594393, 29.797041115319928, 45.76072264797868, 55.20538531466907, 17.57265729523683, -21.10688639851057, 99.50306331059207, 47.701488487442916, -25.773593066996753, 86.49753202176578], "episode_lengths": [200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 113, 200, 200, 200, 193, 200, 200, 200, 200, 89, 132, 200, 200, 200, 200, 200, 10, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 93, 104, 200, 200], "policy_agent_policy_reward": [-0.2610811613981001, 16.41264407739539, 3.4489838538524085, 3.701007287968629, -10.091152796985845, 15.4066204357955, 2.3333871761564957, -25.798416729488544, -14.469591151053361, -11.604304496977534, -23.499739526031576, 17.101429268858766, -12.648028850302932, -38.41151580700081, 16.340884343777688, 11.241171702623802, -13.621271042137723, 1.6238201572581126, 2.6257556263035156, -5.106775816428703, 27.23380628397096, 38.30651656839805, 0.1493924344192079, 31.473072031955525, 34.3364853634494, 14.653923296216684, 17.248663229399003, 52.3674211250717, 7.32130634873532, 29.26990706856682, 9.789609309987833, 18.66952611613711, 5.443085287099855, 28.402948873414676, 10.652126066427362, 26.3406402853947, 11.533069663608366, 4.184258444718341, 4.355855332173663, 27.341418430871357, 0.5323351310161097, 24.274930682406136, -3.9891205036562596, 16.128433840807418, 41.249323200086565, 39.24103606566743, -7.950828732529736, 37.12634800313781, -5.349647032235142, 0.40055655924327205, 5.88793131617541, -3.4273587937277483, 26.438922641096838, -23.77952430689644, 10.116877339108258, -18.62239265927522, 0.29991953145682193, 48.44318152548451, 56.41427652917352, 25.488698338279754, 4.195586373590874, 25.33952035902268, -0.3968560448486578, -0.7704367083489245, 39.67368516954643, 21.196300717544236, 4.161608218224465, 17.854310041989912, 32.079098212971985, 14.898520557659975, 22.880361323989348, 27.60269265733455, 8.786328647618436, -10.553443199255279, 49.75153165529605, 23.85074424372146, -12.886796533498377, 43.248766010882846], "policy_adversary_policy_reward": [-6.190651236322303, 5.929570074924198, 7.412484618527387, 9.000159458868005, 4.303486249343985, -0.8545023954915791, -0.6766396714813148, 4.377646959449944, -4.263872878338198, -5.827279918647648, 1.5864285471561352, 13.820191888639366, 3.7304607342780365, -1.3970735581215408, -24.516724406583627, -1.2816923229049149, -14.920770231699063, 0.45117908064570145, -1.885536069911197, -9.718768427066337, -18.158656005691867, -5.3410835203397085, 7.102094092934095, 9.999335175924667, -6.797769048415034, -5.850259801887898, -26.085952298035714, -12.325563508965072, 11.850193459557154, 4.490690884220534, -13.078827157920614, 24.319998860544406, -17.332653375031892, 3.7113823328941695, 10.687736513456333, -9.06391635619822, -1.3892822037017396, 4.015037830005255, 3.7424596985303413, -8.849235514959043, 12.309420056475815, 14.924386227495143, 13.406783465627555, 24.899733102770483, 3.3602795373487613, -3.2108871029295543, 22.38183750552585, 9.091234526429664, 22.59481379891666, 11.741671564532737, 12.782001530733838, 1.871921765482849, 9.858377052719524, 7.390286176679481, 36.138131665882014, 16.229289459189737, 11.517016015488712, -4.195709666753382, 20.05568769433562, 9.214219374231199, 12.172041265069224, -2.3824319550813895, 6.999931877348793, 11.669594238788317, 4.038971361355049, 1.4041139257448059, 9.275835132502024, 19.127113740912645, 8.514546505260281, 2.137579561167076, 19.68563875472956, 6.655001530665139, 19.081025261853693, -7.547955598245327, -1.0091106727281414, 5.193369117446484, 14.723813113358482, -10.367957781184819, 8.833695317649298, 18.50772311322205, 4.470126919082553, -3.937791788066445, 6.680228959865659, 17.594701722540478, -3.8729314699172104, -0.11618903373904033, 0.5132740020865088, 15.615159838720915, 27.867133934480524, 13.382189265606044, 21.384385998892487, 17.85665006677495, 0.38529744677901334, -8.33612617930875, 11.692574419033127, 25.433773584104692, -9.258797011237252, 3.9091499790021116, 16.431419192847155, -16.03086263360388, 19.04455033766711, -13.156619021491704, 0.2631716636183583, -3.6905304573461066, 1.0116948200361815, 25.427227821060665, -33.47292247811911, 9.693398171222674, -5.776729936342209, 15.893607275450462, -8.057546776824644, -10.564845882450573, -1.8977875994811981, 2.19770713093802, 40.33413292776079, 8.109048597723733, 37.03247408497264, 19.38180244420086, 13.56918535954695, 11.9195129787328, -0.1241477988197559, 4.31973417241063, 23.997176906296446, 1.342343452726233, -15.336406291765659, 14.939550246917003, -13.421508899687664, 12.651072191338734, 26.245158625681533, 13.428526543864896, 8.177450144632173, 13.018850572912067, 25.558891610027437, -21.39728339180299, 10.813240337916989, 7.0410697040729175, 19.380365402464175, 12.69873281050781, -31.267516718208384, 46.16603727586835, 12.584066173403688, 10.296295150585665, 15.195707115139884, 12.406985542194644, -5.7332051913876825, 14.51953383900612, -5.141757524267236, -5.411685674988043, 18.716328336613582, 31.03520331868245, 7.728963193120585, 16.12178105060088, -10.23953725294809, -2.647259280550287, 14.087056741299183, 29.161709269583636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4484849566726834, "mean_inference_ms": 1.196764712006024, "mean_action_processing_ms": 0.19504564112467382, "mean_env_wait_ms": 0.0766838807545873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004280377656985552, "StateBufferConnector_ms": 0.0028160902170034554, "ViewRequirementAgentConnector_ms": 0.06641424619234525}, "num_episodes": 19, "episode_return_max": 112.82855305834701, "episode_return_min": -76.82303161400168, "episode_return_mean": 23.426468679242625}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 520.7708277480085, "num_env_steps_trained_throughput_per_sec": 520.7708277480085, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 7914.911, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7914.876, "sample_time_ms": 846.816, "learn_time_ms": 7057.906, "learn_throughput": 566.74, "synch_weights_time_ms": 9.748}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 4, "trial_id": "eaa30_00000", "date": "2024-08-09_17-40-36", "timestamp": 1723239636, "time_this_iter_s": 7.683728933334351, "time_total_s": 31.671441078186035, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc7c040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 31.671441078186035, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 28.672727272727272, "ram_util_percent": 80.26363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.844676734814568, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.606830373138347, "policy_loss": 0.007593748057088642, "vf_loss": 6.590700515868172, "vf_explained_var": 0.10377382232398583, "kl": 0.028453738729237878, "entropy": 1.603613003094991, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.214247353747487, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.562191135187944, "policy_loss": -7.548448726690064e-05, "vf_loss": 7.556892195343972, "vf_explained_var": 0.02180781358232101, "kl": 0.026872062772357215, "entropy": 1.585940990348657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": 174.54865427858482, "episode_reward_min": -77.89915967502867, "episode_reward_mean": 27.60903593616069, "episode_len_mean": 183.85, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 18385, "policy_reward_min": {"agent_policy": -38.94957983751429, "adversary_policy": -33.47292247811911}, "policy_reward_max": {"agent_policy": 87.27432713929245, "adversary_policy": 46.4109982319101}, "policy_reward_mean": {"agent_policy": 13.804517968080345, "adversary_policy": 6.9022589840401745}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.18230559397169, 30.813240871591, 4.666774352312991, -51.5968334589771, -28.939182302106722, -23.20860899395508, -46.99947905206316, 34.2028585377176, -25.296057700605864, -76.82303161400168, 32.681768687555376, 22.48234340524761, -27.242542084275485, 3.247640314516225, 5.251511252607024, -10.213551632857383, 54.46761256794197, 76.6130331367961, 0.29878486883842825, 62.946144063911035, 68.67297072689877, 29.30784659243337, 34.49732645879803, 104.73484225014343, 14.642612697470664, 58.5398141371336, 19.57921861997567, 37.3390522322742, 10.88617057419971, 56.805897746829345, 21.30425213285473, 52.6812805707894, 23.06613932721673, 8.368516889436682, 8.711710664347336, 54.68283686174268, 1.064670262032219, 48.549861364812216, -7.978241007312517, 32.25686768161485, 82.49864640017309, 78.48207213133495, -15.901657465059472, 74.2526960062756, -10.699294064470287, 0.8011131184865423, 11.775862632350815, -6.854717587455498, 52.87784528219379, -47.55904861379288, 20.233754678216528, -37.24478531855044, 0.5998390629136434, 96.88636305096892, 112.82855305834701, 50.977396676559536, 8.391172747181749, 50.679040718045314, -0.7937120896973155, -1.54087341669792, 79.34737033909288, 42.392601435088444, 8.323216436448888, 35.708620083979795, 64.15819642594393, 29.797041115319928, 45.76072264797868, 55.20538531466907, 17.57265729523683, -21.10688639851057, 99.50306331059207, 47.701488487442916, -25.773593066996753, 86.49753202176578, -5.257133790227606, 30.738695122522913, 20.36483504408791, 68.70890301479142, -10.024077043000283, 86.07591534253366, 20.742033535126552, 26.569829127627422, -41.44300780963404, 85.42249240623443, -77.89915967502867, 54.38788266796709, 25.181061168849816, 34.38251378618532, 82.32607725022179, 29.326810418782692, 140.2309729566707, -25.304611850977942, 65.3260973047185, 2.473034611818557, 61.994491227930446, 89.95929615923707, -26.16514610875256, 33.74647266999098, 33.82921293452067, 174.54865427858482], "episode_lengths": [200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 113, 200, 200, 200, 193, 200, 200, 200, 200, 89, 132, 200, 200, 200, 200, 200, 10, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 93, 104, 200, 200, 200, 200, 200, 163, 200, 200, 200, 19, 200, 200, 200, 43, 200, 22, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 158], "policy_agent_policy_reward": [-10.091152796985845, 15.4066204357955, 2.3333871761564957, -25.798416729488544, -14.469591151053361, -11.604304496977534, -23.499739526031576, 17.101429268858766, -12.648028850302932, -38.41151580700081, 16.340884343777688, 11.241171702623802, -13.621271042137723, 1.6238201572581126, 2.6257556263035156, -5.106775816428703, 27.23380628397096, 38.30651656839805, 0.1493924344192079, 31.473072031955525, 34.3364853634494, 14.653923296216684, 17.248663229399003, 52.3674211250717, 7.32130634873532, 29.26990706856682, 9.789609309987833, 18.66952611613711, 5.443085287099855, 28.402948873414676, 10.652126066427362, 26.3406402853947, 11.533069663608366, 4.184258444718341, 4.355855332173663, 27.341418430871357, 0.5323351310161097, 24.274930682406136, -3.9891205036562596, 16.128433840807418, 41.249323200086565, 39.24103606566743, -7.950828732529736, 37.12634800313781, -5.349647032235142, 0.40055655924327205, 5.88793131617541, -3.4273587937277483, 26.438922641096838, -23.77952430689644, 10.116877339108258, -18.62239265927522, 0.29991953145682193, 48.44318152548451, 56.41427652917352, 25.488698338279754, 4.195586373590874, 25.33952035902268, -0.3968560448486578, -0.7704367083489245, 39.67368516954643, 21.196300717544236, 4.161608218224465, 17.854310041989912, 32.079098212971985, 14.898520557659975, 22.880361323989348, 27.60269265733455, 8.786328647618436, -10.553443199255279, 49.75153165529605, 23.85074424372146, -12.886796533498377, 43.248766010882846, -2.6285668951138046, 15.36934756126145, 10.182417522043938, 34.354451507395716, -5.012038521500141, 43.037957671266824, 10.371016767563276, 13.284914563813707, -20.72150390481699, 42.7112462031172, -38.94957983751429, 27.19394133398355, 12.590530584424894, 17.19125689309266, 41.16303862511089, 14.663405209391364, 70.11548647833536, -12.652305925488962, 32.66304865235926, 1.2365173059092838, 30.997245613965223, 44.97964807961844, -13.082573054376281, 16.87323633499546, 16.91460646726034, 87.27432713929245], "policy_adversary_policy_reward": [-4.263872878338198, -5.827279918647648, 1.5864285471561352, 13.820191888639366, 3.7304607342780365, -1.3970735581215408, -24.516724406583627, -1.2816923229049149, -14.920770231699063, 0.45117908064570145, -1.885536069911197, -9.718768427066337, -18.158656005691867, -5.3410835203397085, 7.102094092934095, 9.999335175924667, -6.797769048415034, -5.850259801887898, -26.085952298035714, -12.325563508965072, 11.850193459557154, 4.490690884220534, -13.078827157920614, 24.319998860544406, -17.332653375031892, 3.7113823328941695, 10.687736513456333, -9.06391635619822, -1.3892822037017396, 4.015037830005255, 3.7424596985303413, -8.849235514959043, 12.309420056475815, 14.924386227495143, 13.406783465627555, 24.899733102770483, 3.3602795373487613, -3.2108871029295543, 22.38183750552585, 9.091234526429664, 22.59481379891666, 11.741671564532737, 12.782001530733838, 1.871921765482849, 9.858377052719524, 7.390286176679481, 36.138131665882014, 16.229289459189737, 11.517016015488712, -4.195709666753382, 20.05568769433562, 9.214219374231199, 12.172041265069224, -2.3824319550813895, 6.999931877348793, 11.669594238788317, 4.038971361355049, 1.4041139257448059, 9.275835132502024, 19.127113740912645, 8.514546505260281, 2.137579561167076, 19.68563875472956, 6.655001530665139, 19.081025261853693, -7.547955598245327, -1.0091106727281414, 5.193369117446484, 14.723813113358482, -10.367957781184819, 8.833695317649298, 18.50772311322205, 4.470126919082553, -3.937791788066445, 6.680228959865659, 17.594701722540478, -3.8729314699172104, -0.11618903373904033, 0.5132740020865088, 15.615159838720915, 27.867133934480524, 13.382189265606044, 21.384385998892487, 17.85665006677495, 0.38529744677901334, -8.33612617930875, 11.692574419033127, 25.433773584104692, -9.258797011237252, 3.9091499790021116, 16.431419192847155, -16.03086263360388, 19.04455033766711, -13.156619021491704, 0.2631716636183583, -3.6905304573461066, 1.0116948200361815, 25.427227821060665, -33.47292247811911, 9.693398171222674, -5.776729936342209, 15.893607275450462, -8.057546776824644, -10.564845882450573, -1.8977875994811981, 2.19770713093802, 40.33413292776079, 8.109048597723733, 37.03247408497264, 19.38180244420086, 13.56918535954695, 11.9195129787328, -0.1241477988197559, 4.31973417241063, 23.997176906296446, 1.342343452726233, -15.336406291765659, 14.939550246917003, -13.421508899687664, 12.651072191338734, 26.245158625681533, 13.428526543864896, 8.177450144632173, 13.018850572912067, 25.558891610027437, -21.39728339180299, 10.813240337916989, 7.0410697040729175, 19.380365402464175, 12.69873281050781, -31.267516718208384, 46.16603727586835, 12.584066173403688, 10.296295150585665, 15.195707115139884, 12.406985542194644, -5.7332051913876825, 14.51953383900612, -5.141757524267236, -5.411685674988043, 18.716328336613582, 31.03520331868245, 7.728963193120585, 16.12178105060088, -10.23953725294809, -2.647259280550287, 14.087056741299183, 29.161709269583636, 9.14555695230687, -11.774123847420679, 8.328660719053783, 7.04068684220767, -4.525440927126802, 14.70785844917074, 34.20747330521647, 0.14697820217924384, 13.405717824123363, -18.417756345623506, 24.803733287476792, 18.234224383790067, 3.6978670044316755, 6.673149763131601, 7.610973917363757, 5.6739406464499496, -10.811284675221085, -9.910219229595903, 24.60485437460836, 18.10639182850886, -9.045713636580452, -29.903866200933848, 20.291281314247584, 6.902660019735961, 6.7968019953035785, 5.793728589121318, 5.744160188785179, 11.447096704307484, 1.6486212610485609, 39.514417364062325, -15.937169377010946, 30.600574586402296, 37.74761963546325, 32.36786684287209, 8.135343316406889, -20.787649241895856, 27.51901155973976, 5.144037092619506, -2.4996724478311343, 3.736189753740419, -6.110655171521907, 37.107900785487125, 20.117186635165858, 24.862461444452606, 15.581126028213516, -28.663699082589787, -4.473385429368486, 21.346621764363945, 10.971133830156685, 5.943472637103657, 46.4109982319101, 40.863328907382346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4391345408954323, "mean_inference_ms": 1.1619637427784675, "mean_action_processing_ms": 0.18904855840942525, "mean_env_wait_ms": 0.07405501680526178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004018425941467285, "StateBufferConnector_ms": 0.0027451515197753906, "ViewRequirementAgentConnector_ms": 0.06518805027008057}, "num_episodes": 26, "episode_return_max": 174.54865427858482, "episode_return_min": -77.89915967502867, "episode_return_mean": 27.60903593616069}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 518.9629696214922, "num_env_steps_trained_throughput_per_sec": 518.9629696214922, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 7873.467, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7873.432, "sample_time_ms": 822.458, "learn_time_ms": 7040.928, "learn_throughput": 568.107, "synch_weights_time_ms": 9.633}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 5, "trial_id": "eaa30_00000", "date": "2024-08-09_17-40-43", "timestamp": 1723239643, "time_this_iter_s": 7.7104651927948, "time_total_s": 39.381906270980835, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc51b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 39.381906270980835, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.29090909090909, "ram_util_percent": 80.19090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0945618475240373, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.824915388652257, "policy_loss": -0.007862936444679107, "vf_loss": 6.827008010722973, "vf_explained_var": 0.07018479175037808, "kl": 0.0128228849955593, "entropy": 1.5936435265515847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4412060868615906, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.11034784267346, "policy_loss": 0.006378391269633236, "vf_loss": 8.095429009695847, "vf_explained_var": 0.10977827316770951, "kl": 0.028468212819037338, "entropy": 1.5949829323838154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": 174.54865427858482, "episode_reward_min": -77.89915967502867, "episode_reward_mean": 33.87360825952854, "episode_len_mean": 180.3, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18030, "policy_reward_min": {"agent_policy": -38.94957983751429, "adversary_policy": -33.47292247811911}, "policy_reward_max": {"agent_policy": 87.27432713929245, "adversary_policy": 46.4109982319101}, "policy_reward_mean": {"agent_policy": 16.936804129764266, "adversary_policy": 8.468402064882135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [104.73484225014343, 14.642612697470664, 58.5398141371336, 19.57921861997567, 37.3390522322742, 10.88617057419971, 56.805897746829345, 21.30425213285473, 52.6812805707894, 23.06613932721673, 8.368516889436682, 8.711710664347336, 54.68283686174268, 1.064670262032219, 48.549861364812216, -7.978241007312517, 32.25686768161485, 82.49864640017309, 78.48207213133495, -15.901657465059472, 74.2526960062756, -10.699294064470287, 0.8011131184865423, 11.775862632350815, -6.854717587455498, 52.87784528219379, -47.55904861379288, 20.233754678216528, -37.24478531855044, 0.5998390629136434, 96.88636305096892, 112.82855305834701, 50.977396676559536, 8.391172747181749, 50.679040718045314, -0.7937120896973155, -1.54087341669792, 79.34737033909288, 42.392601435088444, 8.323216436448888, 35.708620083979795, 64.15819642594393, 29.797041115319928, 45.76072264797868, 55.20538531466907, 17.57265729523683, -21.10688639851057, 99.50306331059207, 47.701488487442916, -25.773593066996753, 86.49753202176578, -5.257133790227606, 30.738695122522913, 20.36483504408791, 68.70890301479142, -10.024077043000283, 86.07591534253366, 20.742033535126552, 26.569829127627422, -41.44300780963404, 85.42249240623443, -77.89915967502867, 54.38788266796709, 25.181061168849816, 34.38251378618532, 82.32607725022179, 29.326810418782692, 140.2309729566707, -25.304611850977942, 65.3260973047185, 2.473034611818557, 61.994491227930446, 89.95929615923707, -26.16514610875256, 33.74647266999098, 33.82921293452067, 174.54865427858482, 37.84378825418652, 60.981313843963065, 28.955579603256453, -23.96778418870676, 92.38831303686939, 14.796063769791441, 83.40892325856944, 33.5328527151591, -31.72086725463889, 102.61654113405848, 137.50825276809755, 52.98687696062602, 49.81876723995131, 85.81710823090175, 57.09990818838148, 75.92770577690494, 62.98872438058649, -56.3112668063811, 32.422770754886045, -37.67072181775764, -46.96502024020373, 20.091027190107482, -56.44336105747369], "episode_lengths": [200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 113, 200, 200, 200, 193, 200, 200, 200, 200, 89, 132, 200, 200, 200, 200, 200, 10, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 93, 104, 200, 200, 200, 200, 200, 163, 200, 200, 200, 19, 200, 200, 200, 43, 200, 22, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 158, 200, 200, 200, 200, 81, 200, 200, 200, 200, 200, 200, 200, 63, 200, 200, 200, 200, 200, 84, 200, 200, 44, 200], "policy_agent_policy_reward": [52.3674211250717, 7.32130634873532, 29.26990706856682, 9.789609309987833, 18.66952611613711, 5.443085287099855, 28.402948873414676, 10.652126066427362, 26.3406402853947, 11.533069663608366, 4.184258444718341, 4.355855332173663, 27.341418430871357, 0.5323351310161097, 24.274930682406136, -3.9891205036562596, 16.128433840807418, 41.249323200086565, 39.24103606566743, -7.950828732529736, 37.12634800313781, -5.349647032235142, 0.40055655924327205, 5.88793131617541, -3.4273587937277483, 26.438922641096838, -23.77952430689644, 10.116877339108258, -18.62239265927522, 0.29991953145682193, 48.44318152548451, 56.41427652917352, 25.488698338279754, 4.195586373590874, 25.33952035902268, -0.3968560448486578, -0.7704367083489245, 39.67368516954643, 21.196300717544236, 4.161608218224465, 17.854310041989912, 32.079098212971985, 14.898520557659975, 22.880361323989348, 27.60269265733455, 8.786328647618436, -10.553443199255279, 49.75153165529605, 23.85074424372146, -12.886796533498377, 43.248766010882846, -2.6285668951138046, 15.36934756126145, 10.182417522043938, 34.354451507395716, -5.012038521500141, 43.037957671266824, 10.371016767563276, 13.284914563813707, -20.72150390481699, 42.7112462031172, -38.94957983751429, 27.19394133398355, 12.590530584424894, 17.19125689309266, 41.16303862511089, 14.663405209391364, 70.11548647833536, -12.652305925488962, 32.66304865235926, 1.2365173059092838, 30.997245613965223, 44.97964807961844, -13.082573054376281, 16.87323633499546, 16.91460646726034, 87.27432713929245, 18.921894127093253, 30.490656921981525, 14.477789801628226, -11.98389209435338, 46.194156518434745, 7.398031884895719, 41.704461629284694, 16.76642635757956, -15.860433627319459, 51.30827056702925, 68.75412638404893, 26.493438480313035, 24.909383619975664, 42.90855411545084, 28.549954094190753, 37.96385288845243, 31.494362190293224, -28.155633403190564, 16.211385377443005, -18.835360908878922, -23.482510120101864, 10.045513595053734, -28.221680528736865], "policy_adversary_policy_reward": [36.138131665882014, 16.229289459189737, 11.517016015488712, -4.195709666753382, 20.05568769433562, 9.214219374231199, 12.172041265069224, -2.3824319550813895, 6.999931877348793, 11.669594238788317, 4.038971361355049, 1.4041139257448059, 9.275835132502024, 19.127113740912645, 8.514546505260281, 2.137579561167076, 19.68563875472956, 6.655001530665139, 19.081025261853693, -7.547955598245327, -1.0091106727281414, 5.193369117446484, 14.723813113358482, -10.367957781184819, 8.833695317649298, 18.50772311322205, 4.470126919082553, -3.937791788066445, 6.680228959865659, 17.594701722540478, -3.8729314699172104, -0.11618903373904033, 0.5132740020865088, 15.615159838720915, 27.867133934480524, 13.382189265606044, 21.384385998892487, 17.85665006677495, 0.38529744677901334, -8.33612617930875, 11.692574419033127, 25.433773584104692, -9.258797011237252, 3.9091499790021116, 16.431419192847155, -16.03086263360388, 19.04455033766711, -13.156619021491704, 0.2631716636183583, -3.6905304573461066, 1.0116948200361815, 25.427227821060665, -33.47292247811911, 9.693398171222674, -5.776729936342209, 15.893607275450462, -8.057546776824644, -10.564845882450573, -1.8977875994811981, 2.19770713093802, 40.33413292776079, 8.109048597723733, 37.03247408497264, 19.38180244420086, 13.56918535954695, 11.9195129787328, -0.1241477988197559, 4.31973417241063, 23.997176906296446, 1.342343452726233, -15.336406291765659, 14.939550246917003, -13.421508899687664, 12.651072191338734, 26.245158625681533, 13.428526543864896, 8.177450144632173, 13.018850572912067, 25.558891610027437, -21.39728339180299, 10.813240337916989, 7.0410697040729175, 19.380365402464175, 12.69873281050781, -31.267516718208384, 46.16603727586835, 12.584066173403688, 10.296295150585665, 15.195707115139884, 12.406985542194644, -5.7332051913876825, 14.51953383900612, -5.141757524267236, -5.411685674988043, 18.716328336613582, 31.03520331868245, 7.728963193120585, 16.12178105060088, -10.23953725294809, -2.647259280550287, 14.087056741299183, 29.161709269583636, 9.14555695230687, -11.774123847420679, 8.328660719053783, 7.04068684220767, -4.525440927126802, 14.70785844917074, 34.20747330521647, 0.14697820217924384, 13.405717824123363, -18.417756345623506, 24.803733287476792, 18.234224383790067, 3.6978670044316755, 6.673149763131601, 7.610973917363757, 5.6739406464499496, -10.811284675221085, -9.910219229595903, 24.60485437460836, 18.10639182850886, -9.045713636580452, -29.903866200933848, 20.291281314247584, 6.902660019735961, 6.7968019953035785, 5.793728589121318, 5.744160188785179, 11.447096704307484, 1.6486212610485609, 39.514417364062325, -15.937169377010946, 30.600574586402296, 37.74761963546325, 32.36786684287209, 8.135343316406889, -20.787649241895856, 27.51901155973976, 5.144037092619506, -2.4996724478311343, 3.736189753740419, -6.110655171521907, 37.107900785487125, 20.117186635165858, 24.862461444452606, 15.581126028213516, -28.663699082589787, -4.473385429368486, 21.346621764363945, 10.971133830156685, 5.943472637103657, 46.4109982319101, 40.863328907382346, -10.71475910052162, 29.63665322761487, 17.24223381385644, 13.248423108125078, 3.462425125069437, 11.015364676558786, 1.8183752994750542, -13.80226739382843, 28.290193745854264, 17.903962772580442, 8.28106317923891, -0.8830312943431906, 18.925001948021087, 22.779459681263592, -5.034074294953259, 21.800500652532865, -5.552590733563198, -10.307842893756256, 6.818352263495864, 44.48991830353333, 41.57060133886754, 27.18352504518135, 5.6712097694549115, 20.82222871085815, 10.3591545004969, 14.550229119478757, 29.80714697996688, 13.101407135483974, 13.106966060311086, 15.442988033879647, 40.35076520250035, -2.386912314047886, 0.29483321399784757, 31.19952897629541, -23.76553683019002, -4.39009657300053, 2.10169476365483, 14.109690613788175, -5.228754281128239, -13.606606627750683, -32.56103013308154, 9.078520012979666, 6.082660929976446, 3.9628526650772873, -20.1215730351901, -8.100107493546766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4254302123064718, "mean_inference_ms": 1.1090567416902102, "mean_action_processing_ms": 0.1828435116598348, "mean_env_wait_ms": 0.0696608703769052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035969018936157227, "StateBufferConnector_ms": 0.0023870468139648438, "ViewRequirementAgentConnector_ms": 0.0626441240310669}, "num_episodes": 23, "episode_return_max": 174.54865427858482, "episode_return_min": -77.89915967502867, "episode_return_mean": 33.87360825952854}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 527.1636944269645, "num_env_steps_trained_throughput_per_sec": 527.1636944269645, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 7825.852, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7825.818, "sample_time_ms": 804.672, "learn_time_ms": 7011.163, "learn_throughput": 570.519, "synch_weights_time_ms": 9.576}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 6, "trial_id": "eaa30_00000", "date": "2024-08-09_17-40-51", "timestamp": 1723239651, "time_this_iter_s": 7.590338945388794, "time_total_s": 46.97224521636963, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a281ab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 46.97224521636963, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 23.79090909090909, "ram_util_percent": 79.41818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.911361958803954, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.695922738029843, "policy_loss": 0.0020599258684173777, "vf_loss": 6.687958951980349, "vf_explained_var": -0.026962325465742242, "kl": 0.01311968228380595, "entropy": 1.6001179861643957, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8970795877277853, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.486950336396694, "policy_loss": -0.007080898017253882, "vf_loss": 7.48650575230519, "vf_explained_var": 0.02985598656038443, "kl": 0.016723334540923437, "entropy": 1.59709658510983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": 174.54865427858482, "episode_reward_min": -92.44178590443428, "episode_reward_mean": 30.825805521091546, "episode_len_mean": 180.63, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18063, "policy_reward_min": {"agent_policy": -46.220892952217156, "adversary_policy": -33.47292247811911}, "policy_reward_max": {"agent_policy": 87.27432713929245, "adversary_policy": 46.4109982319101}, "policy_reward_mean": {"agent_policy": 15.412902760545776, "adversary_policy": 7.706451380272888}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8011131184865423, 11.775862632350815, -6.854717587455498, 52.87784528219379, -47.55904861379288, 20.233754678216528, -37.24478531855044, 0.5998390629136434, 96.88636305096892, 112.82855305834701, 50.977396676559536, 8.391172747181749, 50.679040718045314, -0.7937120896973155, -1.54087341669792, 79.34737033909288, 42.392601435088444, 8.323216436448888, 35.708620083979795, 64.15819642594393, 29.797041115319928, 45.76072264797868, 55.20538531466907, 17.57265729523683, -21.10688639851057, 99.50306331059207, 47.701488487442916, -25.773593066996753, 86.49753202176578, -5.257133790227606, 30.738695122522913, 20.36483504408791, 68.70890301479142, -10.024077043000283, 86.07591534253366, 20.742033535126552, 26.569829127627422, -41.44300780963404, 85.42249240623443, -77.89915967502867, 54.38788266796709, 25.181061168849816, 34.38251378618532, 82.32607725022179, 29.326810418782692, 140.2309729566707, -25.304611850977942, 65.3260973047185, 2.473034611818557, 61.994491227930446, 89.95929615923707, -26.16514610875256, 33.74647266999098, 33.82921293452067, 174.54865427858482, 37.84378825418652, 60.981313843963065, 28.955579603256453, -23.96778418870676, 92.38831303686939, 14.796063769791441, 83.40892325856944, 33.5328527151591, -31.72086725463889, 102.61654113405848, 137.50825276809755, 52.98687696062602, 49.81876723995131, 85.81710823090175, 57.09990818838148, 75.92770577690494, 62.98872438058649, -56.3112668063811, 32.422770754886045, -37.67072181775764, -46.96502024020373, 20.091027190107482, -56.44336105747369, -31.23227788890678, -37.496485596856786, 54.67674170455874, 71.49196689732638, 39.63708134445589, 71.59422681108308, -33.863349337523246, 8.455950654051122, 20.464603883001068, -43.7173168538091, 87.50320830119307, -92.44178590443428, 49.325600750584044, -14.69822213885169, 82.58318577470806, 81.46334179494379, 29.656615912259127, -22.33380973234049, 14.647982572248168, 17.35714532146322, 73.89275899530689, 22.120528905656045], "episode_lengths": [89, 132, 200, 200, 200, 200, 200, 10, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 93, 104, 200, 200, 200, 200, 200, 163, 200, 200, 200, 19, 200, 200, 200, 43, 200, 22, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 158, 200, 200, 200, 200, 81, 200, 200, 200, 200, 200, 200, 200, 63, 200, 200, 200, 200, 200, 84, 200, 200, 44, 200, 200, 200, 118, 199, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 131, 110], "policy_agent_policy_reward": [0.40055655924327205, 5.88793131617541, -3.4273587937277483, 26.438922641096838, -23.77952430689644, 10.116877339108258, -18.62239265927522, 0.29991953145682193, 48.44318152548451, 56.41427652917352, 25.488698338279754, 4.195586373590874, 25.33952035902268, -0.3968560448486578, -0.7704367083489245, 39.67368516954643, 21.196300717544236, 4.161608218224465, 17.854310041989912, 32.079098212971985, 14.898520557659975, 22.880361323989348, 27.60269265733455, 8.786328647618436, -10.553443199255279, 49.75153165529605, 23.85074424372146, -12.886796533498377, 43.248766010882846, -2.6285668951138046, 15.36934756126145, 10.182417522043938, 34.354451507395716, -5.012038521500141, 43.037957671266824, 10.371016767563276, 13.284914563813707, -20.72150390481699, 42.7112462031172, -38.94957983751429, 27.19394133398355, 12.590530584424894, 17.19125689309266, 41.16303862511089, 14.663405209391364, 70.11548647833536, -12.652305925488962, 32.66304865235926, 1.2365173059092838, 30.997245613965223, 44.97964807961844, -13.082573054376281, 16.87323633499546, 16.91460646726034, 87.27432713929245, 18.921894127093253, 30.490656921981525, 14.477789801628226, -11.98389209435338, 46.194156518434745, 7.398031884895719, 41.704461629284694, 16.76642635757956, -15.860433627319459, 51.30827056702925, 68.75412638404893, 26.493438480313035, 24.909383619975664, 42.90855411545084, 28.549954094190753, 37.96385288845243, 31.494362190293224, -28.155633403190564, 16.211385377443005, -18.835360908878922, -23.482510120101864, 10.045513595053734, -28.221680528736865, -15.61613894445339, -18.748242798428407, 27.338370852279365, 35.745983448663225, 19.818540672227925, 35.79711340554156, -16.93167466876162, 4.227975327025561, 10.232301941500516, -21.85865842690455, 43.75160415059651, -46.220892952217156, 24.66280037529205, -7.349111069425849, 41.29159288735404, 40.7316708974719, 14.828307956129564, -11.166904866170245, 7.323991286124084, 8.67857266073161, 36.94637949765344, 11.06026445282802], "policy_adversary_policy_reward": [16.431419192847155, -16.03086263360388, 19.04455033766711, -13.156619021491704, 0.2631716636183583, -3.6905304573461066, 1.0116948200361815, 25.427227821060665, -33.47292247811911, 9.693398171222674, -5.776729936342209, 15.893607275450462, -8.057546776824644, -10.564845882450573, -1.8977875994811981, 2.19770713093802, 40.33413292776079, 8.109048597723733, 37.03247408497264, 19.38180244420086, 13.56918535954695, 11.9195129787328, -0.1241477988197559, 4.31973417241063, 23.997176906296446, 1.342343452726233, -15.336406291765659, 14.939550246917003, -13.421508899687664, 12.651072191338734, 26.245158625681533, 13.428526543864896, 8.177450144632173, 13.018850572912067, 25.558891610027437, -21.39728339180299, 10.813240337916989, 7.0410697040729175, 19.380365402464175, 12.69873281050781, -31.267516718208384, 46.16603727586835, 12.584066173403688, 10.296295150585665, 15.195707115139884, 12.406985542194644, -5.7332051913876825, 14.51953383900612, -5.141757524267236, -5.411685674988043, 18.716328336613582, 31.03520331868245, 7.728963193120585, 16.12178105060088, -10.23953725294809, -2.647259280550287, 14.087056741299183, 29.161709269583636, 9.14555695230687, -11.774123847420679, 8.328660719053783, 7.04068684220767, -4.525440927126802, 14.70785844917074, 34.20747330521647, 0.14697820217924384, 13.405717824123363, -18.417756345623506, 24.803733287476792, 18.234224383790067, 3.6978670044316755, 6.673149763131601, 7.610973917363757, 5.6739406464499496, -10.811284675221085, -9.910219229595903, 24.60485437460836, 18.10639182850886, -9.045713636580452, -29.903866200933848, 20.291281314247584, 6.902660019735961, 6.7968019953035785, 5.793728589121318, 5.744160188785179, 11.447096704307484, 1.6486212610485609, 39.514417364062325, -15.937169377010946, 30.600574586402296, 37.74761963546325, 32.36786684287209, 8.135343316406889, -20.787649241895856, 27.51901155973976, 5.144037092619506, -2.4996724478311343, 3.736189753740419, -6.110655171521907, 37.107900785487125, 20.117186635165858, 24.862461444452606, 15.581126028213516, -28.663699082589787, -4.473385429368486, 21.346621764363945, 10.971133830156685, 5.943472637103657, 46.4109982319101, 40.863328907382346, -10.71475910052162, 29.63665322761487, 17.24223381385644, 13.248423108125078, 3.462425125069437, 11.015364676558786, 1.8183752994750542, -13.80226739382843, 28.290193745854264, 17.903962772580442, 8.28106317923891, -0.8830312943431906, 18.925001948021087, 22.779459681263592, -5.034074294953259, 21.800500652532865, -5.552590733563198, -10.307842893756256, 6.818352263495864, 44.48991830353333, 41.57060133886754, 27.18352504518135, 5.6712097694549115, 20.82222871085815, 10.3591545004969, 14.550229119478757, 29.80714697996688, 13.101407135483974, 13.106966060311086, 15.442988033879647, 40.35076520250035, -2.386912314047886, 0.29483321399784757, 31.19952897629541, -23.76553683019002, -4.39009657300053, 2.10169476365483, 14.109690613788175, -5.228754281128239, -13.606606627750683, -32.56103013308154, 9.078520012979666, 6.082660929976446, 3.9628526650772873, -20.1215730351901, -8.100107493546766, -4.073920289136176, -11.542218655317214, -16.780646005762364, -1.967596792666047, 17.21653752189363, 10.121833330385737, 2.2327097628699235, 33.5132736857933, 14.824338970003689, 4.994201702224231, 13.581987958451307, 22.21512544709025, -15.166676569193967, -1.7649980995676522, 2.6850398097442536, 1.5429355172813075, 10.7542582002037, -0.5219562587031845, -10.981851601293368, -10.876806825611183, 21.90870430265069, 21.842899847945823, -17.492825170201403, -28.728067782015763, 18.421605733328967, 6.241194641963087, -3.287887772988615, -4.061223296437234, 25.36744082880434, 15.924152058549708, 31.781286250346678, 8.95038464712523, -10.399481365690612, 25.227789321820172, -12.736959507954992, 1.570054641784747, 4.344628844301091, 2.9793624418229925, 0.18372351324433112, 8.49484914748728, 16.026543981691223, 20.919835515962227, 5.322394960142326, 5.737869492685697]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41614201439637283, "mean_inference_ms": 1.0736104237282782, "mean_action_processing_ms": 0.1790066886664572, "mean_env_wait_ms": 0.06681042203013984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003436565399169922, "StateBufferConnector_ms": 0.0023854970932006836, "ViewRequirementAgentConnector_ms": 0.06244635581970215}, "num_episodes": 22, "episode_return_max": 174.54865427858482, "episode_return_min": -92.44178590443428, "episode_return_mean": 30.825805521091546}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 525.9278430145192, "num_env_steps_trained_throughput_per_sec": 525.9278430145192, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 7794.39, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7794.356, "sample_time_ms": 797.184, "learn_time_ms": 6987.254, "learn_throughput": 572.471, "synch_weights_time_ms": 9.51}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 7, "trial_id": "eaa30_00000", "date": "2024-08-09_17-40-59", "timestamp": 1723239659, "time_this_iter_s": 7.608291149139404, "time_total_s": 54.58053636550903, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc78d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 54.58053636550903, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 23.654545454545453, "ram_util_percent": 79.56363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.235244896550658, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.400882278169904, "policy_loss": -0.003131441392556385, "vf_loss": 6.396765180113454, "vf_explained_var": 0.015857045328806316, "kl": 0.016107895914169532, "entropy": 1.5872051478062987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.29186150295039, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.543859659135341, "policy_loss": -0.010719746522954664, "vf_loss": 7.548054999609788, "vf_explained_var": 0.03893090349932512, "kl": 0.014498636095474164, "entropy": 1.5806429337710142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 174.54865427858482, "episode_reward_min": -92.44178590443428, "episode_reward_mean": 31.862638198564742, "episode_len_mean": 180.73, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18073, "policy_reward_min": {"agent_policy": -46.220892952217156, "adversary_policy": -32.56103013308154}, "policy_reward_max": {"agent_policy": 87.27432713929245, "adversary_policy": 46.4109982319101}, "policy_reward_mean": {"agent_policy": 15.93131909928237, "adversary_policy": 7.965659549641185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.797041115319928, 45.76072264797868, 55.20538531466907, 17.57265729523683, -21.10688639851057, 99.50306331059207, 47.701488487442916, -25.773593066996753, 86.49753202176578, -5.257133790227606, 30.738695122522913, 20.36483504408791, 68.70890301479142, -10.024077043000283, 86.07591534253366, 20.742033535126552, 26.569829127627422, -41.44300780963404, 85.42249240623443, -77.89915967502867, 54.38788266796709, 25.181061168849816, 34.38251378618532, 82.32607725022179, 29.326810418782692, 140.2309729566707, -25.304611850977942, 65.3260973047185, 2.473034611818557, 61.994491227930446, 89.95929615923707, -26.16514610875256, 33.74647266999098, 33.82921293452067, 174.54865427858482, 37.84378825418652, 60.981313843963065, 28.955579603256453, -23.96778418870676, 92.38831303686939, 14.796063769791441, 83.40892325856944, 33.5328527151591, -31.72086725463889, 102.61654113405848, 137.50825276809755, 52.98687696062602, 49.81876723995131, 85.81710823090175, 57.09990818838148, 75.92770577690494, 62.98872438058649, -56.3112668063811, 32.422770754886045, -37.67072181775764, -46.96502024020373, 20.091027190107482, -56.44336105747369, -31.23227788890678, -37.496485596856786, 54.67674170455874, 71.49196689732638, 39.63708134445589, 71.59422681108308, -33.863349337523246, 8.455950654051122, 20.464603883001068, -43.7173168538091, 87.50320830119307, -92.44178590443428, 49.325600750584044, -14.69822213885169, 82.58318577470806, 81.46334179494379, 29.656615912259127, -22.33380973234049, 14.647982572248168, 17.35714532146322, 73.89275899530689, 22.120528905656045, 76.89664387965023, 5.872026128804726, 52.44611029617132, 45.46922915393749, 51.02731581982066, 80.43161603788715, -49.44961123179965, 26.3281282429565, 54.51160459752687, 54.823628721907156, 54.622674385247265, -51.23261519671701, 13.901326769511265, 20.35346422405317, 6.3755940840025005, 49.377784612081925, 39.19331053728456, 77.47143612394716, 32.578569412435456, 4.672839868234007], "episode_lengths": [200, 200, 200, 200, 200, 93, 104, 200, 200, 200, 200, 200, 163, 200, 200, 200, 19, 200, 200, 200, 43, 200, 22, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 158, 200, 200, 200, 200, 81, 200, 200, 200, 200, 200, 200, 200, 63, 200, 200, 200, 200, 200, 84, 200, 200, 44, 200, 200, 200, 118, 199, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 131, 110, 189, 61, 200, 200, 200, 200, 200, 178, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [14.898520557659975, 22.880361323989348, 27.60269265733455, 8.786328647618436, -10.553443199255279, 49.75153165529605, 23.85074424372146, -12.886796533498377, 43.248766010882846, -2.6285668951138046, 15.36934756126145, 10.182417522043938, 34.354451507395716, -5.012038521500141, 43.037957671266824, 10.371016767563276, 13.284914563813707, -20.72150390481699, 42.7112462031172, -38.94957983751429, 27.19394133398355, 12.590530584424894, 17.19125689309266, 41.16303862511089, 14.663405209391364, 70.11548647833536, -12.652305925488962, 32.66304865235926, 1.2365173059092838, 30.997245613965223, 44.97964807961844, -13.082573054376281, 16.87323633499546, 16.91460646726034, 87.27432713929245, 18.921894127093253, 30.490656921981525, 14.477789801628226, -11.98389209435338, 46.194156518434745, 7.398031884895719, 41.704461629284694, 16.76642635757956, -15.860433627319459, 51.30827056702925, 68.75412638404893, 26.493438480313035, 24.909383619975664, 42.90855411545084, 28.549954094190753, 37.96385288845243, 31.494362190293224, -28.155633403190564, 16.211385377443005, -18.835360908878922, -23.482510120101864, 10.045513595053734, -28.221680528736865, -15.61613894445339, -18.748242798428407, 27.338370852279365, 35.745983448663225, 19.818540672227925, 35.79711340554156, -16.93167466876162, 4.227975327025561, 10.232301941500516, -21.85865842690455, 43.75160415059651, -46.220892952217156, 24.66280037529205, -7.349111069425849, 41.29159288735404, 40.7316708974719, 14.828307956129564, -11.166904866170245, 7.323991286124084, 8.67857266073161, 36.94637949765344, 11.06026445282802, 38.4483219398251, 2.9360130644023608, 26.223055148085642, 22.734614576968752, 25.51365790991028, 40.215808018943676, -24.72480561589983, 13.164064121478262, 27.255802298763438, 27.411814360953557, 27.311337192623625, -25.616307598358503, 6.950663384755636, 10.176732112026585, 3.1877970420012507, 24.68889230604094, 19.596655268642287, 38.73571806197357, 16.289284706217714, 2.336419934117007], "policy_adversary_policy_reward": [-31.267516718208384, 46.16603727586835, 12.584066173403688, 10.296295150585665, 15.195707115139884, 12.406985542194644, -5.7332051913876825, 14.51953383900612, -5.141757524267236, -5.411685674988043, 18.716328336613582, 31.03520331868245, 7.728963193120585, 16.12178105060088, -10.23953725294809, -2.647259280550287, 14.087056741299183, 29.161709269583636, 9.14555695230687, -11.774123847420679, 8.328660719053783, 7.04068684220767, -4.525440927126802, 14.70785844917074, 34.20747330521647, 0.14697820217924384, 13.405717824123363, -18.417756345623506, 24.803733287476792, 18.234224383790067, 3.6978670044316755, 6.673149763131601, 7.610973917363757, 5.6739406464499496, -10.811284675221085, -9.910219229595903, 24.60485437460836, 18.10639182850886, -9.045713636580452, -29.903866200933848, 20.291281314247584, 6.902660019735961, 6.7968019953035785, 5.793728589121318, 5.744160188785179, 11.447096704307484, 1.6486212610485609, 39.514417364062325, -15.937169377010946, 30.600574586402296, 37.74761963546325, 32.36786684287209, 8.135343316406889, -20.787649241895856, 27.51901155973976, 5.144037092619506, -2.4996724478311343, 3.736189753740419, -6.110655171521907, 37.107900785487125, 20.117186635165858, 24.862461444452606, 15.581126028213516, -28.663699082589787, -4.473385429368486, 21.346621764363945, 10.971133830156685, 5.943472637103657, 46.4109982319101, 40.863328907382346, -10.71475910052162, 29.63665322761487, 17.24223381385644, 13.248423108125078, 3.462425125069437, 11.015364676558786, 1.8183752994750542, -13.80226739382843, 28.290193745854264, 17.903962772580442, 8.28106317923891, -0.8830312943431906, 18.925001948021087, 22.779459681263592, -5.034074294953259, 21.800500652532865, -5.552590733563198, -10.307842893756256, 6.818352263495864, 44.48991830353333, 41.57060133886754, 27.18352504518135, 5.6712097694549115, 20.82222871085815, 10.3591545004969, 14.550229119478757, 29.80714697996688, 13.101407135483974, 13.106966060311086, 15.442988033879647, 40.35076520250035, -2.386912314047886, 0.29483321399784757, 31.19952897629541, -23.76553683019002, -4.39009657300053, 2.10169476365483, 14.109690613788175, -5.228754281128239, -13.606606627750683, -32.56103013308154, 9.078520012979666, 6.082660929976446, 3.9628526650772873, -20.1215730351901, -8.100107493546766, -4.073920289136176, -11.542218655317214, -16.780646005762364, -1.967596792666047, 17.21653752189363, 10.121833330385737, 2.2327097628699235, 33.5132736857933, 14.824338970003689, 4.994201702224231, 13.581987958451307, 22.21512544709025, -15.166676569193967, -1.7649980995676522, 2.6850398097442536, 1.5429355172813075, 10.7542582002037, -0.5219562587031845, -10.981851601293368, -10.876806825611183, 21.90870430265069, 21.842899847945823, -17.492825170201403, -28.728067782015763, 18.421605733328967, 6.241194641963087, -3.287887772988615, -4.061223296437234, 25.36744082880434, 15.924152058549708, 31.781286250346678, 8.95038464712523, -10.399481365690612, 25.227789321820172, -12.736959507954992, 1.570054641784747, 4.344628844301091, 2.9793624418229925, 0.18372351324433112, 8.49484914748728, 16.026543981691223, 20.919835515962227, 5.322394960142326, 5.737869492685697, 24.901676241704877, 13.546645698120228, -2.0657126921034195, 5.00172575650578, 0.3328255443542538, 25.89022960373139, 8.419025936283726, 14.315588640685036, 10.293273122242276, 15.220384787668003, 20.327410752046365, 19.88839726689729, -17.243374781497337, -7.481430834402502, 0.6085065938918728, 12.555557527586389, 12.304088713847204, 14.95171358491623, -4.942502595641493, 32.35431695659504, 29.854373855762894, -2.5430366631392687, -15.195831583065825, -10.420476015292678, 0.2812333947993082, 6.669429989956328, 3.062669623618376, 7.114062488408209, 1.6639390339782487, 1.523858008023002, 11.094847297925684, 13.594045008115264, 28.862029114276, -9.265373845633725, 18.282995179822187, 20.45272288215136, 1.1181203202336074, 15.17116438598411, 1.8968696703194823, 0.4395502637975266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41031970459592726, "mean_inference_ms": 1.0525555133780313, "mean_action_processing_ms": 0.17634981457077537, "mean_env_wait_ms": 0.06497769948774826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033218860626220703, "StateBufferConnector_ms": 0.0023802518844604492, "ViewRequirementAgentConnector_ms": 0.062032222747802734}, "num_episodes": 20, "episode_return_max": 174.54865427858482, "episode_return_min": -92.44178590443428, "episode_return_mean": 31.862638198564742}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 521.1119367388131, "num_env_steps_trained_throughput_per_sec": 521.1119367388131, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 7779.578, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7779.545, "sample_time_ms": 790.984, "learn_time_ms": 6978.69, "learn_throughput": 573.173, "synch_weights_time_ms": 9.459}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 8, "trial_id": "eaa30_00000", "date": "2024-08-09_17-41-07", "timestamp": 1723239667, "time_this_iter_s": 7.67847204208374, "time_total_s": 62.25900840759277, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a282f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.25900840759277, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 28.763636363636362, "ram_util_percent": 79.41818181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.519005207031492, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.741993923540469, "policy_loss": -0.004469648462217597, "vf_loss": 6.739707551935993, "vf_explained_var": 0.036078439850025075, "kl": 0.015013325362214966, "entropy": 1.579441795021138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4348249067241947, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.63079445908467, "policy_loss": -0.002476556855981471, "vf_loss": 7.6241898054877915, "vf_explained_var": -0.0228104954585433, "kl": 0.020180508373111177, "entropy": 1.5891463136921327, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": 174.54865427858482, "episode_reward_min": -92.44178590443428, "episode_reward_mean": 36.179457591551866, "episode_len_mean": 180.41, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18041, "policy_reward_min": {"agent_policy": -46.220892952217156, "adversary_policy": -32.56103013308154}, "policy_reward_max": {"agent_policy": 87.27432713929245, "adversary_policy": 46.4109982319101}, "policy_reward_mean": {"agent_policy": 18.089728795775937, "adversary_policy": 9.044864397887967}, "custom_metrics": {}, "hist_stats": {"episode_reward": [82.32607725022179, 29.326810418782692, 140.2309729566707, -25.304611850977942, 65.3260973047185, 2.473034611818557, 61.994491227930446, 89.95929615923707, -26.16514610875256, 33.74647266999098, 33.82921293452067, 174.54865427858482, 37.84378825418652, 60.981313843963065, 28.955579603256453, -23.96778418870676, 92.38831303686939, 14.796063769791441, 83.40892325856944, 33.5328527151591, -31.72086725463889, 102.61654113405848, 137.50825276809755, 52.98687696062602, 49.81876723995131, 85.81710823090175, 57.09990818838148, 75.92770577690494, 62.98872438058649, -56.3112668063811, 32.422770754886045, -37.67072181775764, -46.96502024020373, 20.091027190107482, -56.44336105747369, -31.23227788890678, -37.496485596856786, 54.67674170455874, 71.49196689732638, 39.63708134445589, 71.59422681108308, -33.863349337523246, 8.455950654051122, 20.464603883001068, -43.7173168538091, 87.50320830119307, -92.44178590443428, 49.325600750584044, -14.69822213885169, 82.58318577470806, 81.46334179494379, 29.656615912259127, -22.33380973234049, 14.647982572248168, 17.35714532146322, 73.89275899530689, 22.120528905656045, 76.89664387965023, 5.872026128804726, 52.44611029617132, 45.46922915393749, 51.02731581982066, 80.43161603788715, -49.44961123179965, 26.3281282429565, 54.51160459752687, 54.823628721907156, 54.622674385247265, -51.23261519671701, 13.901326769511265, 20.35346422405317, 6.3755940840025005, 49.377784612081925, 39.19331053728456, 77.47143612394716, 32.578569412435456, 4.672839868234007, 150.93668667855897, -30.629477810992192, -12.049447550417888, 127.74698455570685, -6.033493262002611, 58.44363692943487, 47.980097175147144, 9.16509821986961, 48.50501814727479, 59.763848827215824, 29.490184207040855, 121.80828819547042, 89.33153208731379, 67.63405110736365, 9.208449897645059, 50.744009168976746, 3.528913932587642, 2.5057058344508496, 61.68424636017452, 74.61549337457106, 25.89799131810703, 15.572026399348793, 78.94028913140136], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 158, 200, 200, 200, 200, 81, 200, 200, 200, 200, 200, 200, 200, 63, 200, 200, 200, 200, 200, 84, 200, 200, 44, 200, 200, 200, 118, 199, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 131, 110, 189, 61, 200, 200, 200, 200, 200, 178, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 200, 200, 200, 84, 192, 86, 200, 200, 91, 195, 200, 113, 200, 18, 200, 200, 33, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [41.16303862511089, 14.663405209391364, 70.11548647833536, -12.652305925488962, 32.66304865235926, 1.2365173059092838, 30.997245613965223, 44.97964807961844, -13.082573054376281, 16.87323633499546, 16.91460646726034, 87.27432713929245, 18.921894127093253, 30.490656921981525, 14.477789801628226, -11.98389209435338, 46.194156518434745, 7.398031884895719, 41.704461629284694, 16.76642635757956, -15.860433627319459, 51.30827056702925, 68.75412638404893, 26.493438480313035, 24.909383619975664, 42.90855411545084, 28.549954094190753, 37.96385288845243, 31.494362190293224, -28.155633403190564, 16.211385377443005, -18.835360908878922, -23.482510120101864, 10.045513595053734, -28.221680528736865, -15.61613894445339, -18.748242798428407, 27.338370852279365, 35.745983448663225, 19.818540672227925, 35.79711340554156, -16.93167466876162, 4.227975327025561, 10.232301941500516, -21.85865842690455, 43.75160415059651, -46.220892952217156, 24.66280037529205, -7.349111069425849, 41.29159288735404, 40.7316708974719, 14.828307956129564, -11.166904866170245, 7.323991286124084, 8.67857266073161, 36.94637949765344, 11.06026445282802, 38.4483219398251, 2.9360130644023608, 26.223055148085642, 22.734614576968752, 25.51365790991028, 40.215808018943676, -24.72480561589983, 13.164064121478262, 27.255802298763438, 27.411814360953557, 27.311337192623625, -25.616307598358503, 6.950663384755636, 10.176732112026585, 3.1877970420012507, 24.68889230604094, 19.596655268642287, 38.73571806197357, 16.289284706217714, 2.336419934117007, 75.46834333927941, -15.314738905496096, -6.024723775208933, 63.87349227785349, -3.016746631001303, 29.221818464717433, 23.990048587573558, 4.582549109934803, 24.25250907363739, 29.881924413607898, 14.745092103520422, 60.904144097735156, 44.66576604365691, 33.817025553681844, 4.604224948822529, 25.372004584488383, 1.764456966293821, 1.2528529172254248, 30.842123180087263, 37.30774668728553, 12.948995659053523, 7.786013199674397, 39.47014456570075], "policy_adversary_policy_reward": [1.6486212610485609, 39.514417364062325, -15.937169377010946, 30.600574586402296, 37.74761963546325, 32.36786684287209, 8.135343316406889, -20.787649241895856, 27.51901155973976, 5.144037092619506, -2.4996724478311343, 3.736189753740419, -6.110655171521907, 37.107900785487125, 20.117186635165858, 24.862461444452606, 15.581126028213516, -28.663699082589787, -4.473385429368486, 21.346621764363945, 10.971133830156685, 5.943472637103657, 46.4109982319101, 40.863328907382346, -10.71475910052162, 29.63665322761487, 17.24223381385644, 13.248423108125078, 3.462425125069437, 11.015364676558786, 1.8183752994750542, -13.80226739382843, 28.290193745854264, 17.903962772580442, 8.28106317923891, -0.8830312943431906, 18.925001948021087, 22.779459681263592, -5.034074294953259, 21.800500652532865, -5.552590733563198, -10.307842893756256, 6.818352263495864, 44.48991830353333, 41.57060133886754, 27.18352504518135, 5.6712097694549115, 20.82222871085815, 10.3591545004969, 14.550229119478757, 29.80714697996688, 13.101407135483974, 13.106966060311086, 15.442988033879647, 40.35076520250035, -2.386912314047886, 0.29483321399784757, 31.19952897629541, -23.76553683019002, -4.39009657300053, 2.10169476365483, 14.109690613788175, -5.228754281128239, -13.606606627750683, -32.56103013308154, 9.078520012979666, 6.082660929976446, 3.9628526650772873, -20.1215730351901, -8.100107493546766, -4.073920289136176, -11.542218655317214, -16.780646005762364, -1.967596792666047, 17.21653752189363, 10.121833330385737, 2.2327097628699235, 33.5132736857933, 14.824338970003689, 4.994201702224231, 13.581987958451307, 22.21512544709025, -15.166676569193967, -1.7649980995676522, 2.6850398097442536, 1.5429355172813075, 10.7542582002037, -0.5219562587031845, -10.981851601293368, -10.876806825611183, 21.90870430265069, 21.842899847945823, -17.492825170201403, -28.728067782015763, 18.421605733328967, 6.241194641963087, -3.287887772988615, -4.061223296437234, 25.36744082880434, 15.924152058549708, 31.781286250346678, 8.95038464712523, -10.399481365690612, 25.227789321820172, -12.736959507954992, 1.570054641784747, 4.344628844301091, 2.9793624418229925, 0.18372351324433112, 8.49484914748728, 16.026543981691223, 20.919835515962227, 5.322394960142326, 5.737869492685697, 24.901676241704877, 13.546645698120228, -2.0657126921034195, 5.00172575650578, 0.3328255443542538, 25.89022960373139, 8.419025936283726, 14.315588640685036, 10.293273122242276, 15.220384787668003, 20.327410752046365, 19.88839726689729, -17.243374781497337, -7.481430834402502, 0.6085065938918728, 12.555557527586389, 12.304088713847204, 14.95171358491623, -4.942502595641493, 32.35431695659504, 29.854373855762894, -2.5430366631392687, -15.195831583065825, -10.420476015292678, 0.2812333947993082, 6.669429989956328, 3.062669623618376, 7.114062488408209, 1.6639390339782487, 1.523858008023002, 11.094847297925684, 13.594045008115264, 28.862029114276, -9.265373845633725, 18.282995179822187, 20.45272288215136, 1.1181203202336074, 15.17116438598411, 1.8968696703194823, 0.4395502637975266, 38.84533823087218, 36.6230051084072, -7.820394862592746, -7.49434404290335, -10.11525131086237, 4.09052753565344, 40.6815225748349, 23.191969703018536, -7.956569299402753, 4.939822668401449, -2.6726221213688675, 31.894440586086308, 13.679309266496961, 10.310739321076602, -11.944102102254611, 16.52665121218941, 8.540660144095467, 15.711848929541956, 9.410899334471555, 20.471025079136357, 16.42086502475515, -1.6757729212347243, 32.599719602448786, 28.304424495286373, 28.979347984161656, 15.686418059495255, 9.533116307081912, 24.283909246599922, -0.7669617045575663, 5.371186653380096, 0.964760049816288, 24.407244534672095, 2.6612173544630764, -0.8967603881692554, 8.427043587280444, -7.174190670055021, 21.746798573203968, 9.095324606883302, 8.513251001011952, 28.79449568627357, -2.8924433834614334, 15.841439042514937, 10.789967388951055, -3.0039541892766586, 20.75747138135474, 18.712673184345956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4065219644829226, "mean_inference_ms": 1.0391258889693467, "mean_action_processing_ms": 0.17470775111257442, "mean_env_wait_ms": 0.06368968398609502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033152103424072266, "StateBufferConnector_ms": 0.0023810863494873047, "ViewRequirementAgentConnector_ms": 0.06282150745391846}, "num_episodes": 23, "episode_return_max": 174.54865427858482, "episode_return_min": -92.44178590443428, "episode_return_mean": 36.179457591551866}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.84097248198145, "num_env_steps_trained_throughput_per_sec": 494.84097248198145, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 7813.338, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7813.304, "sample_time_ms": 793.367, "learn_time_ms": 7010.08, "learn_throughput": 570.607, "synch_weights_time_ms": 9.445}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 9, "trial_id": "eaa30_00000", "date": "2024-08-09_17-41-15", "timestamp": 1723239675, "time_this_iter_s": 8.086990118026733, "time_total_s": 70.3459985256195, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a281ab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 70.3459985256195, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 38.550000000000004, "ram_util_percent": 79.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.413821625898755, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.461323266054587, "policy_loss": 0.0007302209296357379, "vf_loss": 6.4545962018310705, "vf_explained_var": 0.0027804362395453075, "kl": 0.013326297410413938, "entropy": 1.5778916839569335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.64834175730745, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.3477683911720915, "policy_loss": -0.005890497698662026, "vf_loss": 7.345422634979089, "vf_explained_var": -0.052346461762984596, "kl": 0.012201848051336128, "entropy": 1.5784543873121342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 150.93668667855897, "episode_reward_min": -92.44178590443428, "episode_reward_mean": 35.84582813257826, "episode_len_mean": 176.97, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 17697, "policy_reward_min": {"agent_policy": -46.220892952217156, "adversary_policy": -32.56103013308154}, "policy_reward_max": {"agent_policy": 75.46834333927941, "adversary_policy": 43.07577998704495}, "policy_reward_mean": {"agent_policy": 17.922914066289128, "adversary_policy": 8.961457033144566}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.98687696062602, 49.81876723995131, 85.81710823090175, 57.09990818838148, 75.92770577690494, 62.98872438058649, -56.3112668063811, 32.422770754886045, -37.67072181775764, -46.96502024020373, 20.091027190107482, -56.44336105747369, -31.23227788890678, -37.496485596856786, 54.67674170455874, 71.49196689732638, 39.63708134445589, 71.59422681108308, -33.863349337523246, 8.455950654051122, 20.464603883001068, -43.7173168538091, 87.50320830119307, -92.44178590443428, 49.325600750584044, -14.69822213885169, 82.58318577470806, 81.46334179494379, 29.656615912259127, -22.33380973234049, 14.647982572248168, 17.35714532146322, 73.89275899530689, 22.120528905656045, 76.89664387965023, 5.872026128804726, 52.44611029617132, 45.46922915393749, 51.02731581982066, 80.43161603788715, -49.44961123179965, 26.3281282429565, 54.51160459752687, 54.823628721907156, 54.622674385247265, -51.23261519671701, 13.901326769511265, 20.35346422405317, 6.3755940840025005, 49.377784612081925, 39.19331053728456, 77.47143612394716, 32.578569412435456, 4.672839868234007, 150.93668667855897, -30.629477810992192, -12.049447550417888, 127.74698455570685, -6.033493262002611, 58.44363692943487, 47.980097175147144, 9.16509821986961, 48.50501814727479, 59.763848827215824, 29.490184207040855, 121.80828819547042, 89.33153208731379, 67.63405110736365, 9.208449897645059, 50.744009168976746, 3.528913932587642, 2.5057058344508496, 61.68424636017452, 74.61549337457106, 25.89799131810703, 15.572026399348793, 78.94028913140136, 110.66684063702503, 62.79577321899685, 38.27304951486252, 94.25831829859453, 41.896803692609055, 50.324653568624555, 0.056071237177661715, 125.40303299834945, 64.07935396031439, 53.20597149569491, 18.10939086451785, 56.3912176137821, 45.50863841367197, 47.821491232706975, 9.078843032683999, 54.93880275120685, 48.9264706959912, 47.6216782105768, 34.222752246321015, 29.687577249909907, -15.855866566634134, 61.26790715559457, 86.59262137341338], "episode_lengths": [200, 63, 200, 200, 200, 200, 200, 84, 200, 200, 44, 200, 200, 200, 118, 199, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 131, 110, 189, 61, 200, 200, 200, 200, 200, 178, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 200, 200, 200, 84, 192, 86, 200, 200, 91, 195, 200, 113, 200, 18, 200, 200, 33, 200, 200, 200, 200, 200, 200, 200, 37, 200, 200, 198, 200, 200, 196, 200, 200, 200, 200, 131, 200, 133, 200, 60, 140, 200, 200, 200, 200], "policy_agent_policy_reward": [26.493438480313035, 24.909383619975664, 42.90855411545084, 28.549954094190753, 37.96385288845243, 31.494362190293224, -28.155633403190564, 16.211385377443005, -18.835360908878922, -23.482510120101864, 10.045513595053734, -28.221680528736865, -15.61613894445339, -18.748242798428407, 27.338370852279365, 35.745983448663225, 19.818540672227925, 35.79711340554156, -16.93167466876162, 4.227975327025561, 10.232301941500516, -21.85865842690455, 43.75160415059651, -46.220892952217156, 24.66280037529205, -7.349111069425849, 41.29159288735404, 40.7316708974719, 14.828307956129564, -11.166904866170245, 7.323991286124084, 8.67857266073161, 36.94637949765344, 11.06026445282802, 38.4483219398251, 2.9360130644023608, 26.223055148085642, 22.734614576968752, 25.51365790991028, 40.215808018943676, -24.72480561589983, 13.164064121478262, 27.255802298763438, 27.411814360953557, 27.311337192623625, -25.616307598358503, 6.950663384755636, 10.176732112026585, 3.1877970420012507, 24.68889230604094, 19.596655268642287, 38.73571806197357, 16.289284706217714, 2.336419934117007, 75.46834333927941, -15.314738905496096, -6.024723775208933, 63.87349227785349, -3.016746631001303, 29.221818464717433, 23.990048587573558, 4.582549109934803, 24.25250907363739, 29.881924413607898, 14.745092103520422, 60.904144097735156, 44.66576604365691, 33.817025553681844, 4.604224948822529, 25.372004584488383, 1.764456966293821, 1.2528529172254248, 30.842123180087263, 37.30774668728553, 12.948995659053523, 7.786013199674397, 39.47014456570075, 55.33342031851245, 31.39788660949844, 19.13652475743126, 47.129159149297244, 20.94840184630455, 25.16232678431227, 0.028035618588830857, 62.70151649917477, 32.039676980157196, 26.602985747847477, 9.054695432258924, 28.19560880689105, 22.75431920683598, 23.910745616353466, 4.539421516341992, 27.469401375603425, 24.463235347995607, 23.8108391052884, 17.111376123160507, 14.843788624954971, -7.927933283317071, 30.633953577797264, 43.29631068670672], "policy_adversary_policy_reward": [5.6712097694549115, 20.82222871085815, 10.3591545004969, 14.550229119478757, 29.80714697996688, 13.101407135483974, 13.106966060311086, 15.442988033879647, 40.35076520250035, -2.386912314047886, 0.29483321399784757, 31.19952897629541, -23.76553683019002, -4.39009657300053, 2.10169476365483, 14.109690613788175, -5.228754281128239, -13.606606627750683, -32.56103013308154, 9.078520012979666, 6.082660929976446, 3.9628526650772873, -20.1215730351901, -8.100107493546766, -4.073920289136176, -11.542218655317214, -16.780646005762364, -1.967596792666047, 17.21653752189363, 10.121833330385737, 2.2327097628699235, 33.5132736857933, 14.824338970003689, 4.994201702224231, 13.581987958451307, 22.21512544709025, -15.166676569193967, -1.7649980995676522, 2.6850398097442536, 1.5429355172813075, 10.7542582002037, -0.5219562587031845, -10.981851601293368, -10.876806825611183, 21.90870430265069, 21.842899847945823, -17.492825170201403, -28.728067782015763, 18.421605733328967, 6.241194641963087, -3.287887772988615, -4.061223296437234, 25.36744082880434, 15.924152058549708, 31.781286250346678, 8.95038464712523, -10.399481365690612, 25.227789321820172, -12.736959507954992, 1.570054641784747, 4.344628844301091, 2.9793624418229925, 0.18372351324433112, 8.49484914748728, 16.026543981691223, 20.919835515962227, 5.322394960142326, 5.737869492685697, 24.901676241704877, 13.546645698120228, -2.0657126921034195, 5.00172575650578, 0.3328255443542538, 25.89022960373139, 8.419025936283726, 14.315588640685036, 10.293273122242276, 15.220384787668003, 20.327410752046365, 19.88839726689729, -17.243374781497337, -7.481430834402502, 0.6085065938918728, 12.555557527586389, 12.304088713847204, 14.95171358491623, -4.942502595641493, 32.35431695659504, 29.854373855762894, -2.5430366631392687, -15.195831583065825, -10.420476015292678, 0.2812333947993082, 6.669429989956328, 3.062669623618376, 7.114062488408209, 1.6639390339782487, 1.523858008023002, 11.094847297925684, 13.594045008115264, 28.862029114276, -9.265373845633725, 18.282995179822187, 20.45272288215136, 1.1181203202336074, 15.17116438598411, 1.8968696703194823, 0.4395502637975266, 38.84533823087218, 36.6230051084072, -7.820394862592746, -7.49434404290335, -10.11525131086237, 4.09052753565344, 40.6815225748349, 23.191969703018536, -7.956569299402753, 4.939822668401449, -2.6726221213688675, 31.894440586086308, 13.679309266496961, 10.310739321076602, -11.944102102254611, 16.52665121218941, 8.540660144095467, 15.711848929541956, 9.410899334471555, 20.471025079136357, 16.42086502475515, -1.6757729212347243, 32.599719602448786, 28.304424495286373, 28.979347984161656, 15.686418059495255, 9.533116307081912, 24.283909246599922, -0.7669617045575663, 5.371186653380096, 0.964760049816288, 24.407244534672095, 2.6612173544630764, -0.8967603881692554, 8.427043587280444, -7.174190670055021, 21.746798573203968, 9.095324606883302, 8.513251001011952, 28.79449568627357, -2.8924433834614334, 15.841439042514937, 10.789967388951055, -3.0039541892766586, 20.75747138135474, 18.712673184345956, 13.535361572614114, 41.79805874589833, 17.527686663982504, 13.870199945515928, 5.181259241960177, 13.955265515471083, 23.09086368589527, 24.03829546340198, 17.630296409566125, 3.3181054367384277, 25.9690143354616, -0.8066875511493024, -1.3747322256173433, 1.4027678442061742, 22.791342069960383, 39.91017442921439, 19.464460623294908, 12.57521635686227, 22.224872288975337, 4.378113458872107, -3.0273697008324376, 12.082065133091362, 16.657496755100723, 11.538112051790339, 0.3531407092613179, 22.401178497574666, 15.36129922565831, 8.549446390695175, -1.2413112606995789, 5.780732777041571, 19.754720404147115, 7.714680971456318, 43.07577998704495, -18.612544639049354, 9.749246813718617, 14.061592291569777, 3.8498126072163616, 13.26156351594415, 18.766888844500045, -3.9231002195450877, -19.623660836389604, 11.695727553072533, 20.957961748486614, 9.675991829310654, 28.79409083294421, 14.50221985376252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4076227954779016, "mean_inference_ms": 1.0382481089417412, "mean_action_processing_ms": 0.17527795929623324, "mean_env_wait_ms": 0.06340865419436584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034917593002319336, "StateBufferConnector_ms": 0.004077553749084473, "ViewRequirementAgentConnector_ms": 0.08362197875976562}, "num_episodes": 23, "episode_return_max": 150.93668667855897, "episode_return_min": -92.44178590443428, "episode_return_mean": 35.84582813257826}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 512.511870605142, "num_env_steps_trained_throughput_per_sec": 512.511870605142, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 7812.474, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7812.441, "sample_time_ms": 819.145, "learn_time_ms": 6983.419, "learn_throughput": 572.785, "synch_weights_time_ms": 9.468}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 10, "trial_id": "eaa30_00000", "date": "2024-08-09_17-41-23", "timestamp": 1723239683, "time_this_iter_s": 7.807413816452026, "time_total_s": 78.15341234207153, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc8cb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 78.15341234207153, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 31.30909090909091, "ram_util_percent": 80.11818181818184}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.352795773586899, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.4735188554834435, "policy_loss": -0.005859741883194714, "vf_loss": 6.473742783763421, "vf_explained_var": 0.06697800219374359, "kl": 0.012524036809348714, "entropy": 1.5635457908034955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5720535333578787, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.8385377615690235, "policy_loss": -0.00044282330685139945, "vf_loss": 7.8307825575272245, "vf_explained_var": -0.04592024261752765, "kl": 0.012145177270576823, "entropy": 1.5738778932640949, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": 150.93668667855897, "episode_reward_min": -82.69272448585295, "episode_reward_mean": 36.350377652331964, "episode_len_mean": 169.01, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 16901, "policy_reward_min": {"agent_policy": -41.34636224292651, "adversary_policy": -21.436475996410103}, "policy_reward_max": {"agent_policy": 75.46834333927941, "adversary_policy": 43.07577998704495}, "policy_reward_mean": {"agent_policy": 18.175188826165982, "adversary_policy": 9.087594413082991}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.656615912259127, -22.33380973234049, 14.647982572248168, 17.35714532146322, 73.89275899530689, 22.120528905656045, 76.89664387965023, 5.872026128804726, 52.44611029617132, 45.46922915393749, 51.02731581982066, 80.43161603788715, -49.44961123179965, 26.3281282429565, 54.51160459752687, 54.823628721907156, 54.622674385247265, -51.23261519671701, 13.901326769511265, 20.35346422405317, 6.3755940840025005, 49.377784612081925, 39.19331053728456, 77.47143612394716, 32.578569412435456, 4.672839868234007, 150.93668667855897, -30.629477810992192, -12.049447550417888, 127.74698455570685, -6.033493262002611, 58.44363692943487, 47.980097175147144, 9.16509821986961, 48.50501814727479, 59.763848827215824, 29.490184207040855, 121.80828819547042, 89.33153208731379, 67.63405110736365, 9.208449897645059, 50.744009168976746, 3.528913932587642, 2.5057058344508496, 61.68424636017452, 74.61549337457106, 25.89799131810703, 15.572026399348793, 78.94028913140136, 110.66684063702503, 62.79577321899685, 38.27304951486252, 94.25831829859453, 41.896803692609055, 50.324653568624555, 0.056071237177661715, 125.40303299834945, 64.07935396031439, 53.20597149569491, 18.10939086451785, 56.3912176137821, 45.50863841367197, 47.821491232706975, 9.078843032683999, 54.93880275120685, 48.9264706959912, 47.6216782105768, 34.222752246321015, 29.687577249909907, -15.855866566634134, 61.26790715559457, 86.59262137341338, -51.4403801961885, -14.688068145735087, 33.40142570489533, 11.525955639239022, 8.40181971476661, 31.80066645197669, 59.99789509268268, 82.70709293526858, -82.69272448585295, 14.138724214874724, 132.62809624174992, 29.90251780560654, -44.323004343603145, 75.23360542086051, 6.123762216786091, 69.78287683337948, 38.4514781322781, 23.62491483160887, 6.119320295166435, 5.870653323778539, 21.624130133771196, 48.05834077027177, 67.23696037777387, -16.580214893386852, -41.90118980182194, 83.53243933877657, 3.280885628128737, 2.1459617343710704], "episode_lengths": [200, 200, 200, 200, 131, 110, 189, 61, 200, 200, 200, 200, 200, 178, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 200, 200, 200, 84, 192, 86, 200, 200, 91, 195, 200, 113, 200, 18, 200, 200, 33, 200, 200, 200, 200, 200, 200, 200, 37, 200, 200, 198, 200, 200, 196, 200, 200, 200, 200, 131, 200, 133, 200, 60, 140, 200, 200, 200, 200, 200, 200, 200, 200, 200, 177, 200, 200, 200, 96, 121, 200, 200, 200, 8, 200, 200, 200, 3, 14, 39, 200, 182, 200, 200, 200, 53, 19], "policy_agent_policy_reward": [14.828307956129564, -11.166904866170245, 7.323991286124084, 8.67857266073161, 36.94637949765344, 11.06026445282802, 38.4483219398251, 2.9360130644023608, 26.223055148085642, 22.734614576968752, 25.51365790991028, 40.215808018943676, -24.72480561589983, 13.164064121478262, 27.255802298763438, 27.411814360953557, 27.311337192623625, -25.616307598358503, 6.950663384755636, 10.176732112026585, 3.1877970420012507, 24.68889230604094, 19.596655268642287, 38.73571806197357, 16.289284706217714, 2.336419934117007, 75.46834333927941, -15.314738905496096, -6.024723775208933, 63.87349227785349, -3.016746631001303, 29.221818464717433, 23.990048587573558, 4.582549109934803, 24.25250907363739, 29.881924413607898, 14.745092103520422, 60.904144097735156, 44.66576604365691, 33.817025553681844, 4.604224948822529, 25.372004584488383, 1.764456966293821, 1.2528529172254248, 30.842123180087263, 37.30774668728553, 12.948995659053523, 7.786013199674397, 39.47014456570075, 55.33342031851245, 31.39788660949844, 19.13652475743126, 47.129159149297244, 20.94840184630455, 25.16232678431227, 0.028035618588830857, 62.70151649917477, 32.039676980157196, 26.602985747847477, 9.054695432258924, 28.19560880689105, 22.75431920683598, 23.910745616353466, 4.539421516341992, 27.469401375603425, 24.463235347995607, 23.8108391052884, 17.111376123160507, 14.843788624954971, -7.927933283317071, 30.633953577797264, 43.29631068670672, -25.720190098094225, -7.344034072867544, 16.700712852447648, 5.762977819619509, 4.200909857383305, 15.900333225988351, 29.99894754634136, 41.353546467634274, -41.34636224292651, 7.0693621074373665, 66.31404812087496, 14.951258902803268, -22.16150217180161, 37.616802710430235, 3.0618811083930453, 34.89143841668976, 19.225739066139035, 11.812457415804435, 3.0596601475832177, 2.9353266618892695, 10.812065066885602, 24.029170385135878, 33.6184801888869, -8.290107446693424, -20.95059490091098, 41.76621966938828, 1.640442814064369, 1.0729808671855352], "policy_adversary_policy_reward": [-10.399481365690612, 25.227789321820172, -12.736959507954992, 1.570054641784747, 4.344628844301091, 2.9793624418229925, 0.18372351324433112, 8.49484914748728, 16.026543981691223, 20.919835515962227, 5.322394960142326, 5.737869492685697, 24.901676241704877, 13.546645698120228, -2.0657126921034195, 5.00172575650578, 0.3328255443542538, 25.89022960373139, 8.419025936283726, 14.315588640685036, 10.293273122242276, 15.220384787668003, 20.327410752046365, 19.88839726689729, -17.243374781497337, -7.481430834402502, 0.6085065938918728, 12.555557527586389, 12.304088713847204, 14.95171358491623, -4.942502595641493, 32.35431695659504, 29.854373855762894, -2.5430366631392687, -15.195831583065825, -10.420476015292678, 0.2812333947993082, 6.669429989956328, 3.062669623618376, 7.114062488408209, 1.6639390339782487, 1.523858008023002, 11.094847297925684, 13.594045008115264, 28.862029114276, -9.265373845633725, 18.282995179822187, 20.45272288215136, 1.1181203202336074, 15.17116438598411, 1.8968696703194823, 0.4395502637975266, 38.84533823087218, 36.6230051084072, -7.820394862592746, -7.49434404290335, -10.11525131086237, 4.09052753565344, 40.6815225748349, 23.191969703018536, -7.956569299402753, 4.939822668401449, -2.6726221213688675, 31.894440586086308, 13.679309266496961, 10.310739321076602, -11.944102102254611, 16.52665121218941, 8.540660144095467, 15.711848929541956, 9.410899334471555, 20.471025079136357, 16.42086502475515, -1.6757729212347243, 32.599719602448786, 28.304424495286373, 28.979347984161656, 15.686418059495255, 9.533116307081912, 24.283909246599922, -0.7669617045575663, 5.371186653380096, 0.964760049816288, 24.407244534672095, 2.6612173544630764, -0.8967603881692554, 8.427043587280444, -7.174190670055021, 21.746798573203968, 9.095324606883302, 8.513251001011952, 28.79449568627357, -2.8924433834614334, 15.841439042514937, 10.789967388951055, -3.0039541892766586, 20.75747138135474, 18.712673184345956, 13.535361572614114, 41.79805874589833, 17.527686663982504, 13.870199945515928, 5.181259241960177, 13.955265515471083, 23.09086368589527, 24.03829546340198, 17.630296409566125, 3.3181054367384277, 25.9690143354616, -0.8066875511493024, -1.3747322256173433, 1.4027678442061742, 22.791342069960383, 39.91017442921439, 19.464460623294908, 12.57521635686227, 22.224872288975337, 4.378113458872107, -3.0273697008324376, 12.082065133091362, 16.657496755100723, 11.538112051790339, 0.3531407092613179, 22.401178497574666, 15.36129922565831, 8.549446390695175, -1.2413112606995789, 5.780732777041571, 19.754720404147115, 7.714680971456318, 43.07577998704495, -18.612544639049354, 9.749246813718617, 14.061592291569777, 3.8498126072163616, 13.26156351594415, 18.766888844500045, -3.9231002195450877, -19.623660836389604, 11.695727553072533, 20.957961748486614, 9.675991829310654, 28.79409083294421, 14.50221985376252, -5.208844492011661, -20.511345606082557, -21.436475996410103, 14.092441923542559, 12.428094600382359, 4.272618252065289, 7.063114095018619, -1.3001362753991108, 2.736865063306027, 1.464044794077278, 13.917824106312942, 1.9825091196754032, 14.159774971051752, 15.8391725752896, 18.210021465550803, 23.143525002083493, -20.17452085909997, -21.171841383826546, 0.7640245913027321, 6.305337516134634, 35.736502352445896, 30.57754576842906, 5.722372316586098, 9.228886586217168, -14.102716172781474, -8.058785999020134, 18.2118315684053, 19.40497114202495, 1.6900330652326403, 1.371848043160405, 13.356171184832371, 21.535267231857375, -4.634654034554046, 23.860393100693074, -6.336195802749767, 18.1486532185542, 1.126908589077118, 1.9327515585060997, 3.8975316363708106, -0.9622049744815406, -0.1510379333759886, 10.96310300026159, 14.676884070522346, 9.352286314613535, 18.589501559561885, 15.028978629325026, -5.931300484753866, -2.3588069619395604, -8.231210141705322, -12.719384759205642, 17.43448102688532, 24.33173864250295, -7.086194321822113, 8.726637135886484, 2.6980763760722635, -1.6250955088867283]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4090359056871841, "mean_inference_ms": 1.0399480943504882, "mean_action_processing_ms": 0.17647179383814865, "mean_env_wait_ms": 0.06329550570054975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034732818603515625, "StateBufferConnector_ms": 0.004126787185668945, "ViewRequirementAgentConnector_ms": 0.08321774005889893}, "num_episodes": 28, "episode_return_max": 150.93668667855897, "episode_return_min": -82.69272448585295, "episode_return_mean": 36.350377652331964}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 524.6286807495618, "num_env_steps_trained_throughput_per_sec": 524.6286807495618, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 7741.98, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7741.947, "sample_time_ms": 793.138, "learn_time_ms": 6938.961, "learn_throughput": 576.455, "synch_weights_time_ms": 9.441}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 11, "trial_id": "eaa30_00000", "date": "2024-08-09_17-41-31", "timestamp": 1723239691, "time_this_iter_s": 7.627272844314575, "time_total_s": 85.78068518638611, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc92e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 85.78068518638611, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 26.85454545454546, "ram_util_percent": 79.96363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.789216718661091, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.3604463145846415, "policy_loss": -0.006626428347622985, "vf_loss": 6.360356060663859, "vf_explained_var": -0.05948164276975803, "kl": 0.014925976477997012, "entropy": 1.5627918765027686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6589233676592507, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.399588952461879, "policy_loss": -0.001555707624841792, "vf_loss": 7.391055006782214, "vf_explained_var": -0.011219760589301585, "kl": 0.014947648292096953, "entropy": 1.5676047701388598, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 150.93668667855897, "episode_reward_min": -82.69272448585295, "episode_reward_mean": 37.50215547497768, "episode_len_mean": 168.72, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 16872, "policy_reward_min": {"agent_policy": -41.34636224292651, "adversary_policy": -21.436475996410103}, "policy_reward_max": {"agent_policy": 75.46834333927941, "adversary_policy": 43.07577998704495}, "policy_reward_mean": {"agent_policy": 18.75107773748884, "adversary_policy": 9.375538868744421}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.377784612081925, 39.19331053728456, 77.47143612394716, 32.578569412435456, 4.672839868234007, 150.93668667855897, -30.629477810992192, -12.049447550417888, 127.74698455570685, -6.033493262002611, 58.44363692943487, 47.980097175147144, 9.16509821986961, 48.50501814727479, 59.763848827215824, 29.490184207040855, 121.80828819547042, 89.33153208731379, 67.63405110736365, 9.208449897645059, 50.744009168976746, 3.528913932587642, 2.5057058344508496, 61.68424636017452, 74.61549337457106, 25.89799131810703, 15.572026399348793, 78.94028913140136, 110.66684063702503, 62.79577321899685, 38.27304951486252, 94.25831829859453, 41.896803692609055, 50.324653568624555, 0.056071237177661715, 125.40303299834945, 64.07935396031439, 53.20597149569491, 18.10939086451785, 56.3912176137821, 45.50863841367197, 47.821491232706975, 9.078843032683999, 54.93880275120685, 48.9264706959912, 47.6216782105768, 34.222752246321015, 29.687577249909907, -15.855866566634134, 61.26790715559457, 86.59262137341338, -51.4403801961885, -14.688068145735087, 33.40142570489533, 11.525955639239022, 8.40181971476661, 31.80066645197669, 59.99789509268268, 82.70709293526858, -82.69272448585295, 14.138724214874724, 132.62809624174992, 29.90251780560654, -44.323004343603145, 75.23360542086051, 6.123762216786091, 69.78287683337948, 38.4514781322781, 23.62491483160887, 6.119320295166435, 5.870653323778539, 21.624130133771196, 48.05834077027177, 67.23696037777387, -16.580214893386852, -41.90118980182194, 83.53243933877657, 3.280885628128737, 2.1459617343710704, 68.56685755814985, -49.53099435724025, -28.051664792708177, 73.72918308502574, 59.11853052713987, 7.851157180775523, 10.008339221907352, 32.91797446770022, -9.053359986783754, 73.04969893614837, 47.43358433959084, -29.740923999297294, 11.69517810325549, 113.68150795850849, 38.117304841623394, 46.40331096369292, 19.653242971538326, 74.96024240665673, 37.42455621591964, 55.544801395973536, 39.11761311454659], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 84, 192, 86, 200, 200, 91, 195, 200, 113, 200, 18, 200, 200, 33, 200, 200, 200, 200, 200, 200, 200, 37, 200, 200, 198, 200, 200, 196, 200, 200, 200, 200, 131, 200, 133, 200, 60, 140, 200, 200, 200, 200, 200, 200, 200, 200, 200, 177, 200, 200, 200, 96, 121, 200, 200, 200, 8, 200, 200, 200, 3, 14, 39, 200, 182, 200, 200, 200, 53, 19, 91, 200, 200, 200, 66, 200, 115, 200, 200, 200, 200, 200, 200, 200, 73, 189, 200, 132, 200, 187, 200], "policy_agent_policy_reward": [24.68889230604094, 19.596655268642287, 38.73571806197357, 16.289284706217714, 2.336419934117007, 75.46834333927941, -15.314738905496096, -6.024723775208933, 63.87349227785349, -3.016746631001303, 29.221818464717433, 23.990048587573558, 4.582549109934803, 24.25250907363739, 29.881924413607898, 14.745092103520422, 60.904144097735156, 44.66576604365691, 33.817025553681844, 4.604224948822529, 25.372004584488383, 1.764456966293821, 1.2528529172254248, 30.842123180087263, 37.30774668728553, 12.948995659053523, 7.786013199674397, 39.47014456570075, 55.33342031851245, 31.39788660949844, 19.13652475743126, 47.129159149297244, 20.94840184630455, 25.16232678431227, 0.028035618588830857, 62.70151649917477, 32.039676980157196, 26.602985747847477, 9.054695432258924, 28.19560880689105, 22.75431920683598, 23.910745616353466, 4.539421516341992, 27.469401375603425, 24.463235347995607, 23.8108391052884, 17.111376123160507, 14.843788624954971, -7.927933283317071, 30.633953577797264, 43.29631068670672, -25.720190098094225, -7.344034072867544, 16.700712852447648, 5.762977819619509, 4.200909857383305, 15.900333225988351, 29.99894754634136, 41.353546467634274, -41.34636224292651, 7.0693621074373665, 66.31404812087496, 14.951258902803268, -22.16150217180161, 37.616802710430235, 3.0618811083930453, 34.89143841668976, 19.225739066139035, 11.812457415804435, 3.0596601475832177, 2.9353266618892695, 10.812065066885602, 24.029170385135878, 33.6184801888869, -8.290107446693424, -20.95059490091098, 41.76621966938828, 1.640442814064369, 1.0729808671855352, 34.28342877907494, -24.765497178620112, -14.025832396354064, 36.86459154251288, 29.559265263569944, 3.92557859038776, 5.004169610953676, 16.458987233850102, -4.526679993391895, 36.524849468074194, 23.71679216979541, -14.870461999648647, 5.847589051627747, 56.840753979254245, 19.05865242081172, 23.201655481846476, 9.826621485769156, 37.48012120332835, 18.712278107959825, 27.772400697986797, 19.558806557273293], "policy_adversary_policy_reward": [11.094847297925684, 13.594045008115264, 28.862029114276, -9.265373845633725, 18.282995179822187, 20.45272288215136, 1.1181203202336074, 15.17116438598411, 1.8968696703194823, 0.4395502637975266, 38.84533823087218, 36.6230051084072, -7.820394862592746, -7.49434404290335, -10.11525131086237, 4.09052753565344, 40.6815225748349, 23.191969703018536, -7.956569299402753, 4.939822668401449, -2.6726221213688675, 31.894440586086308, 13.679309266496961, 10.310739321076602, -11.944102102254611, 16.52665121218941, 8.540660144095467, 15.711848929541956, 9.410899334471555, 20.471025079136357, 16.42086502475515, -1.6757729212347243, 32.599719602448786, 28.304424495286373, 28.979347984161656, 15.686418059495255, 9.533116307081912, 24.283909246599922, -0.7669617045575663, 5.371186653380096, 0.964760049816288, 24.407244534672095, 2.6612173544630764, -0.8967603881692554, 8.427043587280444, -7.174190670055021, 21.746798573203968, 9.095324606883302, 8.513251001011952, 28.79449568627357, -2.8924433834614334, 15.841439042514937, 10.789967388951055, -3.0039541892766586, 20.75747138135474, 18.712673184345956, 13.535361572614114, 41.79805874589833, 17.527686663982504, 13.870199945515928, 5.181259241960177, 13.955265515471083, 23.09086368589527, 24.03829546340198, 17.630296409566125, 3.3181054367384277, 25.9690143354616, -0.8066875511493024, -1.3747322256173433, 1.4027678442061742, 22.791342069960383, 39.91017442921439, 19.464460623294908, 12.57521635686227, 22.224872288975337, 4.378113458872107, -3.0273697008324376, 12.082065133091362, 16.657496755100723, 11.538112051790339, 0.3531407092613179, 22.401178497574666, 15.36129922565831, 8.549446390695175, -1.2413112606995789, 5.780732777041571, 19.754720404147115, 7.714680971456318, 43.07577998704495, -18.612544639049354, 9.749246813718617, 14.061592291569777, 3.8498126072163616, 13.26156351594415, 18.766888844500045, -3.9231002195450877, -19.623660836389604, 11.695727553072533, 20.957961748486614, 9.675991829310654, 28.79409083294421, 14.50221985376252, -5.208844492011661, -20.511345606082557, -21.436475996410103, 14.092441923542559, 12.428094600382359, 4.272618252065289, 7.063114095018619, -1.3001362753991108, 2.736865063306027, 1.464044794077278, 13.917824106312942, 1.9825091196754032, 14.159774971051752, 15.8391725752896, 18.210021465550803, 23.143525002083493, -20.17452085909997, -21.171841383826546, 0.7640245913027321, 6.305337516134634, 35.736502352445896, 30.57754576842906, 5.722372316586098, 9.228886586217168, -14.102716172781474, -8.058785999020134, 18.2118315684053, 19.40497114202495, 1.6900330652326403, 1.371848043160405, 13.356171184832371, 21.535267231857375, -4.634654034554046, 23.860393100693074, -6.336195802749767, 18.1486532185542, 1.126908589077118, 1.9327515585060997, 3.8975316363708106, -0.9622049744815406, -0.1510379333759886, 10.96310300026159, 14.676884070522346, 9.352286314613535, 18.589501559561885, 15.028978629325026, -5.931300484753866, -2.3588069619395604, -8.231210141705322, -12.719384759205642, 17.43448102688532, 24.33173864250295, -7.086194321822113, 8.726637135886484, 2.6980763760722635, -1.6250955088867283, 19.85248588861731, 14.43094289045762, -7.355582438078876, -17.409914740541236, -1.81746053750126, -12.208371858852805, 25.471458238089312, 11.393133304423522, 9.84704778406443, 19.712217479505515, -3.362569298628509, 7.288147889016265, -16.106117569292493, 21.110287180246164, -4.445460179959085, 20.904447413809187, 3.299242520231047, -7.825922513622945, 16.3224737211333, 20.202375746940888, 2.9105346351323718, 20.80625753466304, -7.049876655009712, -7.8205853446389355, -6.70361678773814, 12.551205839365887, 32.839876585870506, 24.000877393383742, 12.054872601406766, 7.003779819404944, 6.929091889860866, 16.272563591985595, 3.4937005565380232, 6.332920929231128, 18.78797190309953, 18.69214930022883, 15.691995150440032, 3.0202829575198002, 20.021425365308897, 7.750975332677891, 18.405588500755208, 1.1532180565180852]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4105764860084268, "mean_inference_ms": 1.0412559000243797, "mean_action_processing_ms": 0.17704472504207316, "mean_env_wait_ms": 0.06322677749103231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003438234329223633, "StateBufferConnector_ms": 0.004099488258361816, "ViewRequirementAgentConnector_ms": 0.08285963535308838}, "num_episodes": 21, "episode_return_max": 150.93668667855897, "episode_return_min": -82.69272448585295, "episode_return_mean": 37.50215547497768}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 543.7184940141179, "num_env_steps_trained_throughput_per_sec": 543.7184940141179, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 7696.199, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7696.167, "sample_time_ms": 772.653, "learn_time_ms": 6913.695, "learn_throughput": 578.562, "synch_weights_time_ms": 9.413}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 12, "trial_id": "eaa30_00000", "date": "2024-08-09_17-41-38", "timestamp": 1723239698, "time_this_iter_s": 7.359539985656738, "time_total_s": 93.14022517204285, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fca0160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 93.14022517204285, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 23.84545454545454, "ram_util_percent": 79.87272727272726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.75591065688108, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.560787258198652, "policy_loss": -0.004366966211495714, "vf_loss": 6.5589063659546865, "vf_explained_var": 0.19322621667826617, "kl": 0.013884153108669337, "entropy": 1.54178121323308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2517682063703734, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.510016472140948, "policy_loss": 0.005339784602983855, "vf_loss": 7.493442365030448, "vf_explained_var": -0.0916667029261589, "kl": 0.016643424466019498, "entropy": 1.5440889203300079, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": 150.6919885146883, "episode_reward_min": -82.69272448585295, "episode_reward_mean": 36.576457661053084, "episode_len_mean": 170.89, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 17089, "policy_reward_min": {"agent_policy": -41.34636224292651, "adversary_policy": -22.11818567114779}, "policy_reward_max": {"agent_policy": 75.34599425734413, "adversary_policy": 43.07577998704495}, "policy_reward_mean": {"agent_policy": 18.288228830526542, "adversary_policy": 9.144114415263271}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.61549337457106, 25.89799131810703, 15.572026399348793, 78.94028913140136, 110.66684063702503, 62.79577321899685, 38.27304951486252, 94.25831829859453, 41.896803692609055, 50.324653568624555, 0.056071237177661715, 125.40303299834945, 64.07935396031439, 53.20597149569491, 18.10939086451785, 56.3912176137821, 45.50863841367197, 47.821491232706975, 9.078843032683999, 54.93880275120685, 48.9264706959912, 47.6216782105768, 34.222752246321015, 29.687577249909907, -15.855866566634134, 61.26790715559457, 86.59262137341338, -51.4403801961885, -14.688068145735087, 33.40142570489533, 11.525955639239022, 8.40181971476661, 31.80066645197669, 59.99789509268268, 82.70709293526858, -82.69272448585295, 14.138724214874724, 132.62809624174992, 29.90251780560654, -44.323004343603145, 75.23360542086051, 6.123762216786091, 69.78287683337948, 38.4514781322781, 23.62491483160887, 6.119320295166435, 5.870653323778539, 21.624130133771196, 48.05834077027177, 67.23696037777387, -16.580214893386852, -41.90118980182194, 83.53243933877657, 3.280885628128737, 2.1459617343710704, 68.56685755814985, -49.53099435724025, -28.051664792708177, 73.72918308502574, 59.11853052713987, 7.851157180775523, 10.008339221907352, 32.91797446770022, -9.053359986783754, 73.04969893614837, 47.43358433959084, -29.740923999297294, 11.69517810325549, 113.68150795850849, 38.117304841623394, 46.40331096369292, 19.653242971538326, 74.96024240665673, 37.42455621591964, 55.544801395973536, 39.11761311454659, 26.84732399095676, 37.87025545835729, -37.21253820824623, 92.18104847977409, 36.460518666435206, 18.906192755861312, -10.258605799022789, -22.312793898440916, 41.40454948883119, 67.39639996942736, 2.6968661670126473, 56.33838474306737, 49.87434793995504, 65.21789644233303, 33.27622410048376, 48.52486254764378, 62.50183664571651, 25.39380631771143, 6.024388892735284, 57.38438865882998, 46.7386518359155, 150.6919885146883, 65.04861352055207, 79.493884631765], "episode_lengths": [200, 200, 200, 200, 200, 200, 37, 200, 200, 198, 200, 200, 196, 200, 200, 200, 200, 131, 200, 133, 200, 60, 140, 200, 200, 200, 200, 200, 200, 200, 200, 200, 177, 200, 200, 200, 96, 121, 200, 200, 200, 8, 200, 200, 200, 3, 14, 39, 200, 182, 200, 200, 200, 53, 19, 91, 200, 200, 200, 66, 200, 115, 200, 200, 200, 200, 200, 200, 200, 73, 189, 200, 132, 200, 187, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 183, 200, 200, 200, 200, 200, 54, 200, 164, 29, 191, 200, 200], "policy_agent_policy_reward": [37.30774668728553, 12.948995659053523, 7.786013199674397, 39.47014456570075, 55.33342031851245, 31.39788660949844, 19.13652475743126, 47.129159149297244, 20.94840184630455, 25.16232678431227, 0.028035618588830857, 62.70151649917477, 32.039676980157196, 26.602985747847477, 9.054695432258924, 28.19560880689105, 22.75431920683598, 23.910745616353466, 4.539421516341992, 27.469401375603425, 24.463235347995607, 23.8108391052884, 17.111376123160507, 14.843788624954971, -7.927933283317071, 30.633953577797264, 43.29631068670672, -25.720190098094225, -7.344034072867544, 16.700712852447648, 5.762977819619509, 4.200909857383305, 15.900333225988351, 29.99894754634136, 41.353546467634274, -41.34636224292651, 7.0693621074373665, 66.31404812087496, 14.951258902803268, -22.16150217180161, 37.616802710430235, 3.0618811083930453, 34.89143841668976, 19.225739066139035, 11.812457415804435, 3.0596601475832177, 2.9353266618892695, 10.812065066885602, 24.029170385135878, 33.6184801888869, -8.290107446693424, -20.95059490091098, 41.76621966938828, 1.640442814064369, 1.0729808671855352, 34.28342877907494, -24.765497178620112, -14.025832396354064, 36.86459154251288, 29.559265263569944, 3.92557859038776, 5.004169610953676, 16.458987233850102, -4.526679993391895, 36.524849468074194, 23.71679216979541, -14.870461999648647, 5.847589051627747, 56.840753979254245, 19.05865242081172, 23.201655481846476, 9.826621485769156, 37.48012120332835, 18.712278107959825, 27.772400697986797, 19.558806557273293, 13.423661995478374, 18.935127729178653, -18.606269104123122, 46.09052423988704, 18.23025933321761, 9.453096377930649, -5.129302899511394, -11.156396949220458, 20.702274744415583, 33.69819998471368, 1.3484330835063234, 28.169192371533665, 24.937173969977504, 32.60894822116653, 16.63811205024188, 24.26243127382188, 31.25091832285828, 12.69690315885571, 3.0121944463676416, 28.692194329415, 23.369325917957756, 75.34599425734413, 32.52430676027603, 39.74694231588246], "policy_adversary_policy_reward": [8.513251001011952, 28.79449568627357, -2.8924433834614334, 15.841439042514937, 10.789967388951055, -3.0039541892766586, 20.75747138135474, 18.712673184345956, 13.535361572614114, 41.79805874589833, 17.527686663982504, 13.870199945515928, 5.181259241960177, 13.955265515471083, 23.09086368589527, 24.03829546340198, 17.630296409566125, 3.3181054367384277, 25.9690143354616, -0.8066875511493024, -1.3747322256173433, 1.4027678442061742, 22.791342069960383, 39.91017442921439, 19.464460623294908, 12.57521635686227, 22.224872288975337, 4.378113458872107, -3.0273697008324376, 12.082065133091362, 16.657496755100723, 11.538112051790339, 0.3531407092613179, 22.401178497574666, 15.36129922565831, 8.549446390695175, -1.2413112606995789, 5.780732777041571, 19.754720404147115, 7.714680971456318, 43.07577998704495, -18.612544639049354, 9.749246813718617, 14.061592291569777, 3.8498126072163616, 13.26156351594415, 18.766888844500045, -3.9231002195450877, -19.623660836389604, 11.695727553072533, 20.957961748486614, 9.675991829310654, 28.79409083294421, 14.50221985376252, -5.208844492011661, -20.511345606082557, -21.436475996410103, 14.092441923542559, 12.428094600382359, 4.272618252065289, 7.063114095018619, -1.3001362753991108, 2.736865063306027, 1.464044794077278, 13.917824106312942, 1.9825091196754032, 14.159774971051752, 15.8391725752896, 18.210021465550803, 23.143525002083493, -20.17452085909997, -21.171841383826546, 0.7640245913027321, 6.305337516134634, 35.736502352445896, 30.57754576842906, 5.722372316586098, 9.228886586217168, -14.102716172781474, -8.058785999020134, 18.2118315684053, 19.40497114202495, 1.6900330652326403, 1.371848043160405, 13.356171184832371, 21.535267231857375, -4.634654034554046, 23.860393100693074, -6.336195802749767, 18.1486532185542, 1.126908589077118, 1.9327515585060997, 3.8975316363708106, -0.9622049744815406, -0.1510379333759886, 10.96310300026159, 14.676884070522346, 9.352286314613535, 18.589501559561885, 15.028978629325026, -5.931300484753866, -2.3588069619395604, -8.231210141705322, -12.719384759205642, 17.43448102688532, 24.33173864250295, -7.086194321822113, 8.726637135886484, 2.6980763760722635, -1.6250955088867283, 19.85248588861731, 14.43094289045762, -7.355582438078876, -17.409914740541236, -1.81746053750126, -12.208371858852805, 25.471458238089312, 11.393133304423522, 9.84704778406443, 19.712217479505515, -3.362569298628509, 7.288147889016265, -16.106117569292493, 21.110287180246164, -4.445460179959085, 20.904447413809187, 3.299242520231047, -7.825922513622945, 16.3224737211333, 20.202375746940888, 2.9105346351323718, 20.80625753466304, -7.049876655009712, -7.8205853446389355, -6.70361678773814, 12.551205839365887, 32.839876585870506, 24.000877393383742, 12.054872601406766, 7.003779819404944, 6.929091889860866, 16.272563591985595, 3.4937005565380232, 6.332920929231128, 18.78797190309953, 18.69214930022883, 15.691995150440032, 3.0202829575198002, 20.021425365308897, 7.750975332677891, 18.405588500755208, 1.1532180565180852, 14.713742095953668, -1.2900801004752953, 11.716767128304, 7.218360600874654, -22.11818567114779, 3.5119165670246684, 40.68845682106542, 5.402067418821623, 14.382249539370125, 3.8480097938474778, 0.6123559003012851, 8.840740477629364, -6.411963107359952, 1.2826602078485578, -6.6063106271980025, -4.550086322022455, 15.359162658867675, 5.3431120855479115, 13.384365910231498, 20.31383407448216, -0.4311810099177862, 1.7796140934241096, -1.3442875040022813, 29.513479875535936, 8.559131445137663, 16.378042524839834, 19.48452924148774, 13.124418979678786, 3.7368937897877927, 12.901218260454083, 2.1399950539061052, 22.122436219915773, 12.283745216287233, 18.967173106571064, 14.039930307773668, -1.3430271489179546, -14.042861766953909, 17.055056213321546, 22.53943883170845, 6.152755497706531, 13.358593470817766, 10.010732447139986, 37.44214301874993, 37.903851238594186, 13.618183488363186, 18.906123271912854, 24.88932301870952, 14.857619297172937]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4116336757924788, "mean_inference_ms": 1.0407227045451637, "mean_action_processing_ms": 0.17763864931939125, "mean_env_wait_ms": 0.06306677996352274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003529191017150879, "StateBufferConnector_ms": 0.004146575927734375, "ViewRequirementAgentConnector_ms": 0.082977294921875}, "num_episodes": 24, "episode_return_max": 150.6919885146883, "episode_return_min": -82.69272448585295, "episode_return_mean": 36.576457661053084}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 536.5767649100904, "num_env_steps_trained_throughput_per_sec": 536.5767649100904, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 7658.19, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7658.157, "sample_time_ms": 767.177, "learn_time_ms": 6881.153, "learn_throughput": 581.298, "synch_weights_time_ms": 9.408}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 13, "trial_id": "eaa30_00000", "date": "2024-08-09_17-41-46", "timestamp": 1723239706, "time_this_iter_s": 7.457264184951782, "time_total_s": 100.59748935699463, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc94550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 100.59748935699463, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 23.799999999999997, "ram_util_percent": 79.61818181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.647815843612428, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.852599916760884, "policy_loss": -0.005651417798017738, "vf_loss": 6.854257604558632, "vf_explained_var": 0.10139155968156441, "kl": 0.008874936619399008, "entropy": 1.5288228624712223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.214647790417075, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.17651190807422, "policy_loss": 0.0005445658864725071, "vf_loss": 7.168147569398085, "vf_explained_var": -0.005406972393393517, "kl": 0.011584856878228796, "entropy": 1.5399430273721615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": 152.36063710036342, "episode_reward_min": -82.69272448585295, "episode_reward_mean": 34.501113011496365, "episode_len_mean": 174.39, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 17439, "policy_reward_min": {"agent_policy": -41.34636224292651, "adversary_policy": -22.11818567114779}, "policy_reward_max": {"agent_policy": 76.18031855018165, "adversary_policy": 54.10573131006146}, "policy_reward_mean": {"agent_policy": 17.25055650574818, "adversary_policy": 8.625278252874091}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.222752246321015, 29.687577249909907, -15.855866566634134, 61.26790715559457, 86.59262137341338, -51.4403801961885, -14.688068145735087, 33.40142570489533, 11.525955639239022, 8.40181971476661, 31.80066645197669, 59.99789509268268, 82.70709293526858, -82.69272448585295, 14.138724214874724, 132.62809624174992, 29.90251780560654, -44.323004343603145, 75.23360542086051, 6.123762216786091, 69.78287683337948, 38.4514781322781, 23.62491483160887, 6.119320295166435, 5.870653323778539, 21.624130133771196, 48.05834077027177, 67.23696037777387, -16.580214893386852, -41.90118980182194, 83.53243933877657, 3.280885628128737, 2.1459617343710704, 68.56685755814985, -49.53099435724025, -28.051664792708177, 73.72918308502574, 59.11853052713987, 7.851157180775523, 10.008339221907352, 32.91797446770022, -9.053359986783754, 73.04969893614837, 47.43358433959084, -29.740923999297294, 11.69517810325549, 113.68150795850849, 38.117304841623394, 46.40331096369292, 19.653242971538326, 74.96024240665673, 37.42455621591964, 55.544801395973536, 39.11761311454659, 26.84732399095676, 37.87025545835729, -37.21253820824623, 92.18104847977409, 36.460518666435206, 18.906192755861312, -10.258605799022789, -22.312793898440916, 41.40454948883119, 67.39639996942736, 2.6968661670126473, 56.33838474306737, 49.87434793995504, 65.21789644233303, 33.27622410048376, 48.52486254764378, 62.50183664571651, 25.39380631771143, 6.024388892735284, 57.38438865882998, 46.7386518359155, 150.6919885146883, 65.04861352055207, 79.493884631765, 53.86366951319525, 33.62367589968069, 57.460471324199375, 0.15292220366561082, 59.565401498842235, 37.61331258757254, 51.35991845820321, 57.9613594008698, 152.36063710036342, 1.451883580504017, 23.32371953968241, 18.438556366543082, 1.8289947066952124, 130.95983268743643, 27.542095212097145, -16.713977189975267, 63.035683870999904, 81.51568626252839, 132.44681992687072, 11.014987891991218, -11.729904617363172, -10.228009519459778], "episode_lengths": [140, 200, 200, 200, 200, 200, 200, 200, 200, 200, 177, 200, 200, 200, 96, 121, 200, 200, 200, 8, 200, 200, 200, 3, 14, 39, 200, 182, 200, 200, 200, 53, 19, 91, 200, 200, 200, 66, 200, 115, 200, 200, 200, 200, 200, 200, 200, 73, 189, 200, 132, 200, 187, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 183, 200, 200, 200, 200, 200, 54, 200, 164, 29, 191, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 199, 200, 200, 200, 200, 200, 200, 200, 106, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [17.111376123160507, 14.843788624954971, -7.927933283317071, 30.633953577797264, 43.29631068670672, -25.720190098094225, -7.344034072867544, 16.700712852447648, 5.762977819619509, 4.200909857383305, 15.900333225988351, 29.99894754634136, 41.353546467634274, -41.34636224292651, 7.0693621074373665, 66.31404812087496, 14.951258902803268, -22.16150217180161, 37.616802710430235, 3.0618811083930453, 34.89143841668976, 19.225739066139035, 11.812457415804435, 3.0596601475832177, 2.9353266618892695, 10.812065066885602, 24.029170385135878, 33.6184801888869, -8.290107446693424, -20.95059490091098, 41.76621966938828, 1.640442814064369, 1.0729808671855352, 34.28342877907494, -24.765497178620112, -14.025832396354064, 36.86459154251288, 29.559265263569944, 3.92557859038776, 5.004169610953676, 16.458987233850102, -4.526679993391895, 36.524849468074194, 23.71679216979541, -14.870461999648647, 5.847589051627747, 56.840753979254245, 19.05865242081172, 23.201655481846476, 9.826621485769156, 37.48012120332835, 18.712278107959825, 27.772400697986797, 19.558806557273293, 13.423661995478374, 18.935127729178653, -18.606269104123122, 46.09052423988704, 18.23025933321761, 9.453096377930649, -5.129302899511394, -11.156396949220458, 20.702274744415583, 33.69819998471368, 1.3484330835063234, 28.169192371533665, 24.937173969977504, 32.60894822116653, 16.63811205024188, 24.26243127382188, 31.25091832285828, 12.69690315885571, 3.0121944463676416, 28.692194329415, 23.369325917957756, 75.34599425734413, 32.52430676027603, 39.74694231588246, 26.931834756597652, 16.811837949840342, 28.73023566209971, 0.07646110183280541, 29.782700749421107, 18.806656293786272, 25.679959229101616, 28.9806797004349, 76.18031855018165, 0.7259417902519765, 11.661859769841204, 9.219278183271538, 0.9144973533476133, 65.47991634371817, 13.771047606048569, -8.356988594987627, 31.51784193549996, 40.75784313126411, 66.22340996343544, 5.507493945995606, -5.864952308681579, -5.114004759729887], "policy_adversary_policy_reward": [3.8498126072163616, 13.26156351594415, 18.766888844500045, -3.9231002195450877, -19.623660836389604, 11.695727553072533, 20.957961748486614, 9.675991829310654, 28.79409083294421, 14.50221985376252, -5.208844492011661, -20.511345606082557, -21.436475996410103, 14.092441923542559, 12.428094600382359, 4.272618252065289, 7.063114095018619, -1.3001362753991108, 2.736865063306027, 1.464044794077278, 13.917824106312942, 1.9825091196754032, 14.159774971051752, 15.8391725752896, 18.210021465550803, 23.143525002083493, -20.17452085909997, -21.171841383826546, 0.7640245913027321, 6.305337516134634, 35.736502352445896, 30.57754576842906, 5.722372316586098, 9.228886586217168, -14.102716172781474, -8.058785999020134, 18.2118315684053, 19.40497114202495, 1.6900330652326403, 1.371848043160405, 13.356171184832371, 21.535267231857375, -4.634654034554046, 23.860393100693074, -6.336195802749767, 18.1486532185542, 1.126908589077118, 1.9327515585060997, 3.8975316363708106, -0.9622049744815406, -0.1510379333759886, 10.96310300026159, 14.676884070522346, 9.352286314613535, 18.589501559561885, 15.028978629325026, -5.931300484753866, -2.3588069619395604, -8.231210141705322, -12.719384759205642, 17.43448102688532, 24.33173864250295, -7.086194321822113, 8.726637135886484, 2.6980763760722635, -1.6250955088867283, 19.85248588861731, 14.43094289045762, -7.355582438078876, -17.409914740541236, -1.81746053750126, -12.208371858852805, 25.471458238089312, 11.393133304423522, 9.84704778406443, 19.712217479505515, -3.362569298628509, 7.288147889016265, -16.106117569292493, 21.110287180246164, -4.445460179959085, 20.904447413809187, 3.299242520231047, -7.825922513622945, 16.3224737211333, 20.202375746940888, 2.9105346351323718, 20.80625753466304, -7.049876655009712, -7.8205853446389355, -6.70361678773814, 12.551205839365887, 32.839876585870506, 24.000877393383742, 12.054872601406766, 7.003779819404944, 6.929091889860866, 16.272563591985595, 3.4937005565380232, 6.332920929231128, 18.78797190309953, 18.69214930022883, 15.691995150440032, 3.0202829575198002, 20.021425365308897, 7.750975332677891, 18.405588500755208, 1.1532180565180852, 14.713742095953668, -1.2900801004752953, 11.716767128304, 7.218360600874654, -22.11818567114779, 3.5119165670246684, 40.68845682106542, 5.402067418821623, 14.382249539370125, 3.8480097938474778, 0.6123559003012851, 8.840740477629364, -6.411963107359952, 1.2826602078485578, -6.6063106271980025, -4.550086322022455, 15.359162658867675, 5.3431120855479115, 13.384365910231498, 20.31383407448216, -0.4311810099177862, 1.7796140934241096, -1.3442875040022813, 29.513479875535936, 8.559131445137663, 16.378042524839834, 19.48452924148774, 13.124418979678786, 3.7368937897877927, 12.901218260454083, 2.1399950539061052, 22.122436219915773, 12.283745216287233, 18.967173106571064, 14.039930307773668, -1.3430271489179546, -14.042861766953909, 17.055056213321546, 22.53943883170845, 6.152755497706531, 13.358593470817766, 10.010732447139986, 37.44214301874993, 37.903851238594186, 13.618183488363186, 18.906123271912854, 24.88932301870952, 14.857619297172937, 21.297327932216817, 5.634506824380825, 8.247290484193272, 8.56454746564707, 26.39942008656424, 2.3308155755354605, 11.459048408164833, -11.382587306332027, 25.258981836971568, 4.523718912449539, 10.747641768696617, 8.059014525089655, 21.53122847440972, 4.148730754691897, -2.3386979138082644, 31.319377614243162, 54.10573131006146, 22.07458724012023, 8.044078178654352, -7.3181363884023725, -1.3049346893458917, 12.966794459187096, 1.3070590969612148, 7.912219086310323, 5.863392144741656, -4.948894791394043, 46.21796397150709, 19.261952372211052, -5.43161418302792, 19.20266178907649, -7.988406947358282, -0.3685816476293464, 26.99832620223705, 4.519515733262914, 16.752696672298704, 24.00514645896544, 34.67203401256961, 31.551375950865804, 15.81479969095777, -10.307305744962164, -8.139562514680783, 2.274610205999206, -9.104030832018886, 3.9900260722890053]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4095016233751516, "mean_inference_ms": 1.0339931332616126, "mean_action_processing_ms": 0.1767028949500685, "mean_env_wait_ms": 0.06259862396600631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004126548767089844, "StateBufferConnector_ms": 0.002471446990966797, "ViewRequirementAgentConnector_ms": 0.06548631191253662}, "num_episodes": 22, "episode_return_max": 152.36063710036342, "episode_return_min": -82.69272448585295, "episode_return_mean": 34.501113011496365}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 476.25624771342035, "num_env_steps_trained_throughput_per_sec": 476.25624771342035, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 7729.982, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7729.949, "sample_time_ms": 766.46, "learn_time_ms": 6953.327, "learn_throughput": 575.264, "synch_weights_time_ms": 9.745}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 14, "trial_id": "eaa30_00000", "date": "2024-08-09_17-41-54", "timestamp": 1723239714, "time_this_iter_s": 8.403911113739014, "time_total_s": 109.00140047073364, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc92e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 109.00140047073364, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 23.066666666666663, "ram_util_percent": 78.90833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.703052962898577, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.573733823766153, "policy_loss": -0.0016751539966130935, "vf_loss": 6.57213054485422, "vf_explained_var": 0.03650087515513102, "kl": 0.0072854289178928685, "entropy": 1.5215085931555934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.184395458425085, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.721409686406454, "policy_loss": 0.008485286215727684, "vf_loss": 7.700623822212219, "vf_explained_var": -0.05181065344562133, "kl": 0.01822302351841548, "entropy": 1.522594257692496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": 152.36063710036342, "episode_reward_min": -49.53099435724025, "episode_reward_mean": 39.61718066550061, "episode_len_mean": 173.71, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 17371, "policy_reward_min": {"agent_policy": -24.765497178620112, "adversary_policy": -22.11818567114779}, "policy_reward_max": {"agent_policy": 76.18031855018165, "adversary_policy": 54.10573131006146}, "policy_reward_mean": {"agent_policy": 19.80859033275031, "adversary_policy": 9.904295166375153}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.78287683337948, 38.4514781322781, 23.62491483160887, 6.119320295166435, 5.870653323778539, 21.624130133771196, 48.05834077027177, 67.23696037777387, -16.580214893386852, -41.90118980182194, 83.53243933877657, 3.280885628128737, 2.1459617343710704, 68.56685755814985, -49.53099435724025, -28.051664792708177, 73.72918308502574, 59.11853052713987, 7.851157180775523, 10.008339221907352, 32.91797446770022, -9.053359986783754, 73.04969893614837, 47.43358433959084, -29.740923999297294, 11.69517810325549, 113.68150795850849, 38.117304841623394, 46.40331096369292, 19.653242971538326, 74.96024240665673, 37.42455621591964, 55.544801395973536, 39.11761311454659, 26.84732399095676, 37.87025545835729, -37.21253820824623, 92.18104847977409, 36.460518666435206, 18.906192755861312, -10.258605799022789, -22.312793898440916, 41.40454948883119, 67.39639996942736, 2.6968661670126473, 56.33838474306737, 49.87434793995504, 65.21789644233303, 33.27622410048376, 48.52486254764378, 62.50183664571651, 25.39380631771143, 6.024388892735284, 57.38438865882998, 46.7386518359155, 150.6919885146883, 65.04861352055207, 79.493884631765, 53.86366951319525, 33.62367589968069, 57.460471324199375, 0.15292220366561082, 59.565401498842235, 37.61331258757254, 51.35991845820321, 57.9613594008698, 152.36063710036342, 1.451883580504017, 23.32371953968241, 18.438556366543082, 1.8289947066952124, 130.95983268743643, 27.542095212097145, -16.713977189975267, 63.035683870999904, 81.51568626252839, 132.44681992687072, 11.014987891991218, -11.729904617363172, -10.228009519459778, 77.3720149688695, 58.825810265666135, 80.04467241252786, 35.1907524787766, -26.529607310370775, 18.520196492986862, 110.4058086499538, 102.75485002540427, 17.458929416879382, 21.700386484129105, 50.23004311623255, 82.3513897339704, -25.676938573528428, 28.547768483897606, 40.289022553464406, 62.24606858913448, 75.44777012537239, -0.8209711383543841, 107.85591483616687, 84.02525951517849], "episode_lengths": [200, 200, 200, 3, 14, 39, 200, 182, 200, 200, 200, 53, 19, 91, 200, 200, 200, 66, 200, 115, 200, 200, 200, 200, 200, 200, 200, 73, 189, 200, 132, 200, 187, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 183, 200, 200, 200, 200, 200, 54, 200, 164, 29, 191, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 199, 200, 200, 200, 200, 200, 200, 200, 106, 200, 200, 200, 200, 200, 181, 200, 200, 200, 200, 200, 195, 159, 70, 139, 151, 174, 200, 200, 200, 200, 200, 5, 200, 200], "policy_agent_policy_reward": [34.89143841668976, 19.225739066139035, 11.812457415804435, 3.0596601475832177, 2.9353266618892695, 10.812065066885602, 24.029170385135878, 33.6184801888869, -8.290107446693424, -20.95059490091098, 41.76621966938828, 1.640442814064369, 1.0729808671855352, 34.28342877907494, -24.765497178620112, -14.025832396354064, 36.86459154251288, 29.559265263569944, 3.92557859038776, 5.004169610953676, 16.458987233850102, -4.526679993391895, 36.524849468074194, 23.71679216979541, -14.870461999648647, 5.847589051627747, 56.840753979254245, 19.05865242081172, 23.201655481846476, 9.826621485769156, 37.48012120332835, 18.712278107959825, 27.772400697986797, 19.558806557273293, 13.423661995478374, 18.935127729178653, -18.606269104123122, 46.09052423988704, 18.23025933321761, 9.453096377930649, -5.129302899511394, -11.156396949220458, 20.702274744415583, 33.69819998471368, 1.3484330835063234, 28.169192371533665, 24.937173969977504, 32.60894822116653, 16.63811205024188, 24.26243127382188, 31.25091832285828, 12.69690315885571, 3.0121944463676416, 28.692194329415, 23.369325917957756, 75.34599425734413, 32.52430676027603, 39.74694231588246, 26.931834756597652, 16.811837949840342, 28.73023566209971, 0.07646110183280541, 29.782700749421107, 18.806656293786272, 25.679959229101616, 28.9806797004349, 76.18031855018165, 0.7259417902519765, 11.661859769841204, 9.219278183271538, 0.9144973533476133, 65.47991634371817, 13.771047606048569, -8.356988594987627, 31.51784193549996, 40.75784313126411, 66.22340996343544, 5.507493945995606, -5.864952308681579, -5.114004759729887, 38.68600748443477, 29.412905132833064, 40.02233620626393, 17.5953762393883, -13.264803655185391, 9.260098246493419, 55.202904324976885, 51.37742501270212, 8.729464708439693, 10.85019324206455, 25.115021558116283, 41.1756948669852, -12.8384692867642, 14.2738842419488, 20.144511276732192, 31.123034294567248, 37.7238850626862, -0.41048556917719203, 53.92795741808344, 42.01262975758927], "policy_adversary_policy_reward": [13.356171184832371, 21.535267231857375, -4.634654034554046, 23.860393100693074, -6.336195802749767, 18.1486532185542, 1.126908589077118, 1.9327515585060997, 3.8975316363708106, -0.9622049744815406, -0.1510379333759886, 10.96310300026159, 14.676884070522346, 9.352286314613535, 18.589501559561885, 15.028978629325026, -5.931300484753866, -2.3588069619395604, -8.231210141705322, -12.719384759205642, 17.43448102688532, 24.33173864250295, -7.086194321822113, 8.726637135886484, 2.6980763760722635, -1.6250955088867283, 19.85248588861731, 14.43094289045762, -7.355582438078876, -17.409914740541236, -1.81746053750126, -12.208371858852805, 25.471458238089312, 11.393133304423522, 9.84704778406443, 19.712217479505515, -3.362569298628509, 7.288147889016265, -16.106117569292493, 21.110287180246164, -4.445460179959085, 20.904447413809187, 3.299242520231047, -7.825922513622945, 16.3224737211333, 20.202375746940888, 2.9105346351323718, 20.80625753466304, -7.049876655009712, -7.8205853446389355, -6.70361678773814, 12.551205839365887, 32.839876585870506, 24.000877393383742, 12.054872601406766, 7.003779819404944, 6.929091889860866, 16.272563591985595, 3.4937005565380232, 6.332920929231128, 18.78797190309953, 18.69214930022883, 15.691995150440032, 3.0202829575198002, 20.021425365308897, 7.750975332677891, 18.405588500755208, 1.1532180565180852, 14.713742095953668, -1.2900801004752953, 11.716767128304, 7.218360600874654, -22.11818567114779, 3.5119165670246684, 40.68845682106542, 5.402067418821623, 14.382249539370125, 3.8480097938474778, 0.6123559003012851, 8.840740477629364, -6.411963107359952, 1.2826602078485578, -6.6063106271980025, -4.550086322022455, 15.359162658867675, 5.3431120855479115, 13.384365910231498, 20.31383407448216, -0.4311810099177862, 1.7796140934241096, -1.3442875040022813, 29.513479875535936, 8.559131445137663, 16.378042524839834, 19.48452924148774, 13.124418979678786, 3.7368937897877927, 12.901218260454083, 2.1399950539061052, 22.122436219915773, 12.283745216287233, 18.967173106571064, 14.039930307773668, -1.3430271489179546, -14.042861766953909, 17.055056213321546, 22.53943883170845, 6.152755497706531, 13.358593470817766, 10.010732447139986, 37.44214301874993, 37.903851238594186, 13.618183488363186, 18.906123271912854, 24.88932301870952, 14.857619297172937, 21.297327932216817, 5.634506824380825, 8.247290484193272, 8.56454746564707, 26.39942008656424, 2.3308155755354605, 11.459048408164833, -11.382587306332027, 25.258981836971568, 4.523718912449539, 10.747641768696617, 8.059014525089655, 21.53122847440972, 4.148730754691897, -2.3386979138082644, 31.319377614243162, 54.10573131006146, 22.07458724012023, 8.044078178654352, -7.3181363884023725, -1.3049346893458917, 12.966794459187096, 1.3070590969612148, 7.912219086310323, 5.863392144741656, -4.948894791394043, 46.21796397150709, 19.261952372211052, -5.43161418302792, 19.20266178907649, -7.988406947358282, -0.3685816476293464, 26.99832620223705, 4.519515733262914, 16.752696672298704, 24.00514645896544, 34.67203401256961, 31.551375950865804, 15.81479969095777, -10.307305744962164, -8.139562514680783, 2.274610205999206, -9.104030832018886, 3.9900260722890053, 11.16164676438633, 27.524360720048406, 3.537612680410121, 25.87529245242294, 24.725888981834814, 15.296447224429144, 13.395433633432955, 4.199942605955342, -1.645464536869202, -11.619339118316189, -4.007214624958886, 13.267312871452306, 36.85700036297823, 18.345903961998673, 19.492591931504965, 31.88483308119717, -5.651816490878968, 14.381281199318659, 9.949753303088073, 0.9004399389764792, 29.173504133812, -4.058482575695731, 32.14107932121688, 9.034615545768297, -9.1109485676411, -3.727520719123098, 17.76133459596149, -3.4874503540126893, 11.836041719836182, 8.308469556895997, 10.025380204727075, 21.097654089840162, 3.7988714403930643, 33.925013622293164, -2.99283019503702, 2.582344625859828, 22.510846108907785, 31.41711130917564, 25.997576097894175, 16.0150536596951]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40761121084542196, "mean_inference_ms": 1.0281984728342992, "mean_action_processing_ms": 0.17592319067648274, "mean_env_wait_ms": 0.06205362390566673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004106998443603516, "StateBufferConnector_ms": 0.0024541616439819336, "ViewRequirementAgentConnector_ms": 0.06571781635284424}, "num_episodes": 20, "episode_return_max": 152.36063710036342, "episode_return_min": -49.53099435724025, "episode_return_mean": 39.61718066550061}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 476.1359408079006, "num_env_steps_trained_throughput_per_sec": 476.1359408079006, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 7799.31, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7799.277, "sample_time_ms": 765.786, "learn_time_ms": 7023.028, "learn_throughput": 569.555, "synch_weights_time_ms": 10.052}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 15, "trial_id": "eaa30_00000", "date": "2024-08-09_17-42-03", "timestamp": 1723239723, "time_this_iter_s": 8.405583143234253, "time_total_s": 117.4069836139679, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc945e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 117.4069836139679, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 23.650000000000002, "ram_util_percent": 78.97500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.225852015251836, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.150398963847488, "policy_loss": -0.0028290510810813105, "vf_loss": 7.147435609878055, "vf_explained_var": 0.008023956623026934, "kl": 0.01287201025582377, "entropy": 1.5006065663206514, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.6091254017005365, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.594175491730372, "policy_loss": 0.0032488342779591526, "vf_loss": 7.578183628618717, "vf_explained_var": -0.02687310284624497, "kl": 0.01887854679468243, "entropy": 1.4771571257462104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 152.36063710036342, "episode_reward_min": -37.21253820824623, "episode_reward_mean": 48.93235729308956, "episode_len_mean": 183.01, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18301, "policy_reward_min": {"agent_policy": -18.606269104123122, "adversary_policy": -22.11818567114779}, "policy_reward_max": {"agent_policy": 76.18031855018165, "adversary_policy": 54.10573131006146}, "policy_reward_mean": {"agent_policy": 24.466178646544776, "adversary_policy": 12.23308932327239}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.43358433959084, -29.740923999297294, 11.69517810325549, 113.68150795850849, 38.117304841623394, 46.40331096369292, 19.653242971538326, 74.96024240665673, 37.42455621591964, 55.544801395973536, 39.11761311454659, 26.84732399095676, 37.87025545835729, -37.21253820824623, 92.18104847977409, 36.460518666435206, 18.906192755861312, -10.258605799022789, -22.312793898440916, 41.40454948883119, 67.39639996942736, 2.6968661670126473, 56.33838474306737, 49.87434793995504, 65.21789644233303, 33.27622410048376, 48.52486254764378, 62.50183664571651, 25.39380631771143, 6.024388892735284, 57.38438865882998, 46.7386518359155, 150.6919885146883, 65.04861352055207, 79.493884631765, 53.86366951319525, 33.62367589968069, 57.460471324199375, 0.15292220366561082, 59.565401498842235, 37.61331258757254, 51.35991845820321, 57.9613594008698, 152.36063710036342, 1.451883580504017, 23.32371953968241, 18.438556366543082, 1.8289947066952124, 130.95983268743643, 27.542095212097145, -16.713977189975267, 63.035683870999904, 81.51568626252839, 132.44681992687072, 11.014987891991218, -11.729904617363172, -10.228009519459778, 77.3720149688695, 58.825810265666135, 80.04467241252786, 35.1907524787766, -26.529607310370775, 18.520196492986862, 110.4058086499538, 102.75485002540427, 17.458929416879382, 21.700386484129105, 50.23004311623255, 82.3513897339704, -25.676938573528428, 28.547768483897606, 40.289022553464406, 62.24606858913448, 75.44777012537239, -0.8209711383543841, 107.85591483616687, 84.02525951517849, 116.0395616067327, 15.022249915203751, 103.97674757996388, 92.34605922519204, -12.368640819435004, 30.951533849032856, 88.77663387881707, 102.64635757151771, 34.10997213653132, 85.52621071859753, 73.24150005637998, 28.15363456361493, 53.45429652548182, 50.136070550408405, 88.61290717180671, 101.86304485176873, 83.53286366280594, 95.06293767369297, -10.189363871842172, 54.962273995886996, 57.01921867504849, 45.688939055572305, 102.80493273032613], "episode_lengths": [200, 200, 200, 200, 73, 189, 200, 132, 200, 187, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 183, 200, 200, 200, 200, 200, 54, 200, 164, 29, 191, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 199, 200, 200, 200, 200, 200, 200, 200, 106, 200, 200, 200, 200, 200, 181, 200, 200, 200, 200, 200, 195, 159, 70, 139, 151, 174, 200, 200, 200, 200, 200, 5, 200, 200, 183, 200, 172, 200, 200, 99, 200, 200, 200, 200, 200, 200, 144, 159, 200, 200, 200, 200, 200, 200, 177, 187, 191], "policy_agent_policy_reward": [23.71679216979541, -14.870461999648647, 5.847589051627747, 56.840753979254245, 19.05865242081172, 23.201655481846476, 9.826621485769156, 37.48012120332835, 18.712278107959825, 27.772400697986797, 19.558806557273293, 13.423661995478374, 18.935127729178653, -18.606269104123122, 46.09052423988704, 18.23025933321761, 9.453096377930649, -5.129302899511394, -11.156396949220458, 20.702274744415583, 33.69819998471368, 1.3484330835063234, 28.169192371533665, 24.937173969977504, 32.60894822116653, 16.63811205024188, 24.26243127382188, 31.25091832285828, 12.69690315885571, 3.0121944463676416, 28.692194329415, 23.369325917957756, 75.34599425734413, 32.52430676027603, 39.74694231588246, 26.931834756597652, 16.811837949840342, 28.73023566209971, 0.07646110183280541, 29.782700749421107, 18.806656293786272, 25.679959229101616, 28.9806797004349, 76.18031855018165, 0.7259417902519765, 11.661859769841204, 9.219278183271538, 0.9144973533476133, 65.47991634371817, 13.771047606048569, -8.356988594987627, 31.51784193549996, 40.75784313126411, 66.22340996343544, 5.507493945995606, -5.864952308681579, -5.114004759729887, 38.68600748443477, 29.412905132833064, 40.02233620626393, 17.5953762393883, -13.264803655185391, 9.260098246493419, 55.202904324976885, 51.37742501270212, 8.729464708439693, 10.85019324206455, 25.115021558116283, 41.1756948669852, -12.8384692867642, 14.2738842419488, 20.144511276732192, 31.123034294567248, 37.7238850626862, -0.41048556917719203, 53.92795741808344, 42.01262975758927, 58.01978080336638, 7.511124957601886, 51.98837378998196, 46.17302961259596, -6.184320409717504, 15.475766924516446, 44.38831693940854, 51.32317878575885, 17.054986068265666, 42.76310535929875, 36.62075002819, 14.076817281807463, 26.727148262740908, 25.0680352752042, 44.3064535859033, 50.93152242588438, 41.766431831403004, 47.53146883684647, -5.094681935921086, 27.481136997943494, 28.509609337524246, 22.844469527786153, 51.40246636516305], "policy_adversary_policy_reward": [2.9105346351323718, 20.80625753466304, -7.049876655009712, -7.8205853446389355, -6.70361678773814, 12.551205839365887, 32.839876585870506, 24.000877393383742, 12.054872601406766, 7.003779819404944, 6.929091889860866, 16.272563591985595, 3.4937005565380232, 6.332920929231128, 18.78797190309953, 18.69214930022883, 15.691995150440032, 3.0202829575198002, 20.021425365308897, 7.750975332677891, 18.405588500755208, 1.1532180565180852, 14.713742095953668, -1.2900801004752953, 11.716767128304, 7.218360600874654, -22.11818567114779, 3.5119165670246684, 40.68845682106542, 5.402067418821623, 14.382249539370125, 3.8480097938474778, 0.6123559003012851, 8.840740477629364, -6.411963107359952, 1.2826602078485578, -6.6063106271980025, -4.550086322022455, 15.359162658867675, 5.3431120855479115, 13.384365910231498, 20.31383407448216, -0.4311810099177862, 1.7796140934241096, -1.3442875040022813, 29.513479875535936, 8.559131445137663, 16.378042524839834, 19.48452924148774, 13.124418979678786, 3.7368937897877927, 12.901218260454083, 2.1399950539061052, 22.122436219915773, 12.283745216287233, 18.967173106571064, 14.039930307773668, -1.3430271489179546, -14.042861766953909, 17.055056213321546, 22.53943883170845, 6.152755497706531, 13.358593470817766, 10.010732447139986, 37.44214301874993, 37.903851238594186, 13.618183488363186, 18.906123271912854, 24.88932301870952, 14.857619297172937, 21.297327932216817, 5.634506824380825, 8.247290484193272, 8.56454746564707, 26.39942008656424, 2.3308155755354605, 11.459048408164833, -11.382587306332027, 25.258981836971568, 4.523718912449539, 10.747641768696617, 8.059014525089655, 21.53122847440972, 4.148730754691897, -2.3386979138082644, 31.319377614243162, 54.10573131006146, 22.07458724012023, 8.044078178654352, -7.3181363884023725, -1.3049346893458917, 12.966794459187096, 1.3070590969612148, 7.912219086310323, 5.863392144741656, -4.948894791394043, 46.21796397150709, 19.261952372211052, -5.43161418302792, 19.20266178907649, -7.988406947358282, -0.3685816476293464, 26.99832620223705, 4.519515733262914, 16.752696672298704, 24.00514645896544, 34.67203401256961, 31.551375950865804, 15.81479969095777, -10.307305744962164, -8.139562514680783, 2.274610205999206, -9.104030832018886, 3.9900260722890053, 11.16164676438633, 27.524360720048406, 3.537612680410121, 25.87529245242294, 24.725888981834814, 15.296447224429144, 13.395433633432955, 4.199942605955342, -1.645464536869202, -11.619339118316189, -4.007214624958886, 13.267312871452306, 36.85700036297823, 18.345903961998673, 19.492591931504965, 31.88483308119717, -5.651816490878968, 14.381281199318659, 9.949753303088073, 0.9004399389764792, 29.173504133812, -4.058482575695731, 32.14107932121688, 9.034615545768297, -9.1109485676411, -3.727520719123098, 17.76133459596149, -3.4874503540126893, 11.836041719836182, 8.308469556895997, 10.025380204727075, 21.097654089840162, 3.7988714403930643, 33.925013622293164, -2.99283019503702, 2.582344625859828, 22.510846108907785, 31.41711130917564, 25.997576097894175, 16.0150536596951, 9.757524547625659, 48.26225625574069, 6.697463858214691, 0.8136610993871951, 24.993549841070035, 26.994823948911915, 30.369113756138876, 15.803915856457103, -7.418798836613362, 1.2344784268958584, 11.800084440265458, 3.675682484250986, 24.54070895258051, 19.847607986828038, 38.79479066705838, 12.52838811870045, 7.14425437847137, 9.910731689794293, 16.98867623275366, 25.7744291265451, 15.097305745810115, 21.523444282379877, -1.8070614623388206, 15.883878744146278, 25.92615752814131, 0.8009907345996039, 17.988207162861972, 7.079828112342227, 35.60779632724491, 8.698657258658407, 26.221247968704933, 24.710274457179455, 28.44396563331284, 13.32246619809015, 27.881953363519827, 19.649515473326627, 2.6351266781481453, -7.729808614069231, 24.40587821161612, 3.0752587863273764, 12.855411839901262, 15.654197497622986, 20.28935621974587, 2.5551133080402995, 15.414184808374294, 35.988281556788756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40543916922429263, "mean_inference_ms": 1.0201953894450728, "mean_action_processing_ms": 0.17435284316261562, "mean_env_wait_ms": 0.06165018218839981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004112839698791504, "StateBufferConnector_ms": 0.002451658248901367, "ViewRequirementAgentConnector_ms": 0.06745433807373047}, "num_episodes": 23, "episode_return_max": 152.36063710036342, "episode_return_min": -37.21253820824623, "episode_return_mean": 48.93235729308956}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.4020811026541, "num_env_steps_trained_throughput_per_sec": 486.4020811026541, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 7862.897, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7862.864, "sample_time_ms": 774.622, "learn_time_ms": 7077.531, "learn_throughput": 565.169, "synch_weights_time_ms": 10.295}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 16, "trial_id": "eaa30_00000", "date": "2024-08-09_17-42-11", "timestamp": 1723239731, "time_this_iter_s": 8.228925943374634, "time_total_s": 125.63590955734253, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc94790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 125.63590955734253, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 22.708333333333332, "ram_util_percent": 78.99166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.872571357217415, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.539174064252743, "policy_loss": -0.00014890167534489324, "vf_loss": 6.53397875765644, "vf_explained_var": 0.07355667999181797, "kl": 0.011876055826161983, "entropy": 1.4887948510508058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.564613143354654, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.972587121029695, "policy_loss": 0.006972279196876722, "vf_loss": 7.955381422738234, "vf_explained_var": 0.0014360753819346427, "kl": 0.01516066207550466, "entropy": 1.4652639092256625, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "env_runners": {"episode_reward_max": 152.36063710036342, "episode_reward_min": -66.50766037203849, "episode_reward_mean": 52.92217668879074, "episode_len_mean": 182.93, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18293, "policy_reward_min": {"agent_policy": -33.2538301860192, "adversary_policy": -30.152734090059433}, "policy_reward_max": {"agent_policy": 76.18031855018165, "adversary_policy": 54.10573131006146}, "policy_reward_mean": {"agent_policy": 26.46108834439537, "adversary_policy": 13.230544172197684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.87434793995504, 65.21789644233303, 33.27622410048376, 48.52486254764378, 62.50183664571651, 25.39380631771143, 6.024388892735284, 57.38438865882998, 46.7386518359155, 150.6919885146883, 65.04861352055207, 79.493884631765, 53.86366951319525, 33.62367589968069, 57.460471324199375, 0.15292220366561082, 59.565401498842235, 37.61331258757254, 51.35991845820321, 57.9613594008698, 152.36063710036342, 1.451883580504017, 23.32371953968241, 18.438556366543082, 1.8289947066952124, 130.95983268743643, 27.542095212097145, -16.713977189975267, 63.035683870999904, 81.51568626252839, 132.44681992687072, 11.014987891991218, -11.729904617363172, -10.228009519459778, 77.3720149688695, 58.825810265666135, 80.04467241252786, 35.1907524787766, -26.529607310370775, 18.520196492986862, 110.4058086499538, 102.75485002540427, 17.458929416879382, 21.700386484129105, 50.23004311623255, 82.3513897339704, -25.676938573528428, 28.547768483897606, 40.289022553464406, 62.24606858913448, 75.44777012537239, -0.8209711383543841, 107.85591483616687, 84.02525951517849, 116.0395616067327, 15.022249915203751, 103.97674757996388, 92.34605922519204, -12.368640819435004, 30.951533849032856, 88.77663387881707, 102.64635757151771, 34.10997213653132, 85.52621071859753, 73.24150005637998, 28.15363456361493, 53.45429652548182, 50.136070550408405, 88.61290717180671, 101.86304485176873, 83.53286366280594, 95.06293767369297, -10.189363871842172, 54.962273995886996, 57.01921867504849, 45.688939055572305, 102.80493273032613, 33.07248339157487, 89.16983167870511, 92.57371619356772, 52.81076841999551, 43.349713347914566, 77.27322814792896, 128.72613166177317, 105.8407538369037, -10.072162703579114, 34.358513983885935, -2.6231682957933202, 49.61134579024545, 67.74039276792885, -34.03839369440655, 25.01912138352335, 120.72241578408952, 16.074758270977693, 69.43523741046683, 45.846648921639925, -66.50766037203849, 81.29768803827446, 42.34154252065857, 101.56705321190293], "episode_lengths": [200, 200, 200, 200, 200, 54, 200, 164, 29, 191, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 199, 200, 200, 200, 200, 200, 200, 200, 106, 200, 200, 200, 200, 200, 181, 200, 200, 200, 200, 200, 195, 159, 70, 139, 151, 174, 200, 200, 200, 200, 200, 5, 200, 200, 183, 200, 172, 200, 200, 99, 200, 200, 200, 200, 200, 200, 144, 159, 200, 200, 200, 200, 200, 200, 177, 187, 191, 200, 200, 200, 200, 200, 178, 144, 119, 200, 200, 200, 200, 167, 200, 91, 200, 200, 116, 149, 200, 200, 200, 200], "policy_agent_policy_reward": [24.937173969977504, 32.60894822116653, 16.63811205024188, 24.26243127382188, 31.25091832285828, 12.69690315885571, 3.0121944463676416, 28.692194329415, 23.369325917957756, 75.34599425734413, 32.52430676027603, 39.74694231588246, 26.931834756597652, 16.811837949840342, 28.73023566209971, 0.07646110183280541, 29.782700749421107, 18.806656293786272, 25.679959229101616, 28.9806797004349, 76.18031855018165, 0.7259417902519765, 11.661859769841204, 9.219278183271538, 0.9144973533476133, 65.47991634371817, 13.771047606048569, -8.356988594987627, 31.51784193549996, 40.75784313126411, 66.22340996343544, 5.507493945995606, -5.864952308681579, -5.114004759729887, 38.68600748443477, 29.412905132833064, 40.02233620626393, 17.5953762393883, -13.264803655185391, 9.260098246493419, 55.202904324976885, 51.37742501270212, 8.729464708439693, 10.85019324206455, 25.115021558116283, 41.1756948669852, -12.8384692867642, 14.2738842419488, 20.144511276732192, 31.123034294567248, 37.7238850626862, -0.41048556917719203, 53.92795741808344, 42.01262975758927, 58.01978080336638, 7.511124957601886, 51.98837378998196, 46.17302961259596, -6.184320409717504, 15.475766924516446, 44.38831693940854, 51.32317878575885, 17.054986068265666, 42.76310535929875, 36.62075002819, 14.076817281807463, 26.727148262740908, 25.0680352752042, 44.3064535859033, 50.93152242588438, 41.766431831403004, 47.53146883684647, -5.094681935921086, 27.481136997943494, 28.509609337524246, 22.844469527786153, 51.40246636516305, 16.53624169578744, 44.58491583935253, 46.28685809678387, 26.405384209997735, 21.674856673957287, 38.63661407396448, 64.36306583088661, 52.92037691845187, -5.036081351789512, 17.17925699194297, -1.3115841478966814, 24.8056728951227, 33.87019638396441, -17.01919684720328, 12.509560691761664, 60.36120789204476, 8.037379135488845, 34.717618705233384, 22.923324460819934, -33.2538301860192, 40.64884401913721, 21.17077126032927, 50.783526605951536], "policy_adversary_policy_reward": [8.559131445137663, 16.378042524839834, 19.48452924148774, 13.124418979678786, 3.7368937897877927, 12.901218260454083, 2.1399950539061052, 22.122436219915773, 12.283745216287233, 18.967173106571064, 14.039930307773668, -1.3430271489179546, -14.042861766953909, 17.055056213321546, 22.53943883170845, 6.152755497706531, 13.358593470817766, 10.010732447139986, 37.44214301874993, 37.903851238594186, 13.618183488363186, 18.906123271912854, 24.88932301870952, 14.857619297172937, 21.297327932216817, 5.634506824380825, 8.247290484193272, 8.56454746564707, 26.39942008656424, 2.3308155755354605, 11.459048408164833, -11.382587306332027, 25.258981836971568, 4.523718912449539, 10.747641768696617, 8.059014525089655, 21.53122847440972, 4.148730754691897, -2.3386979138082644, 31.319377614243162, 54.10573131006146, 22.07458724012023, 8.044078178654352, -7.3181363884023725, -1.3049346893458917, 12.966794459187096, 1.3070590969612148, 7.912219086310323, 5.863392144741656, -4.948894791394043, 46.21796397150709, 19.261952372211052, -5.43161418302792, 19.20266178907649, -7.988406947358282, -0.3685816476293464, 26.99832620223705, 4.519515733262914, 16.752696672298704, 24.00514645896544, 34.67203401256961, 31.551375950865804, 15.81479969095777, -10.307305744962164, -8.139562514680783, 2.274610205999206, -9.104030832018886, 3.9900260722890053, 11.16164676438633, 27.524360720048406, 3.537612680410121, 25.87529245242294, 24.725888981834814, 15.296447224429144, 13.395433633432955, 4.199942605955342, -1.645464536869202, -11.619339118316189, -4.007214624958886, 13.267312871452306, 36.85700036297823, 18.345903961998673, 19.492591931504965, 31.88483308119717, -5.651816490878968, 14.381281199318659, 9.949753303088073, 0.9004399389764792, 29.173504133812, -4.058482575695731, 32.14107932121688, 9.034615545768297, -9.1109485676411, -3.727520719123098, 17.76133459596149, -3.4874503540126893, 11.836041719836182, 8.308469556895997, 10.025380204727075, 21.097654089840162, 3.7988714403930643, 33.925013622293164, -2.99283019503702, 2.582344625859828, 22.510846108907785, 31.41711130917564, 25.997576097894175, 16.0150536596951, 9.757524547625659, 48.26225625574069, 6.697463858214691, 0.8136610993871951, 24.993549841070035, 26.994823948911915, 30.369113756138876, 15.803915856457103, -7.418798836613362, 1.2344784268958584, 11.800084440265458, 3.675682484250986, 24.54070895258051, 19.847607986828038, 38.79479066705838, 12.52838811870045, 7.14425437847137, 9.910731689794293, 16.98867623275366, 25.7744291265451, 15.097305745810115, 21.523444282379877, -1.8070614623388206, 15.883878744146278, 25.92615752814131, 0.8009907345996039, 17.988207162861972, 7.079828112342227, 35.60779632724491, 8.698657258658407, 26.221247968704933, 24.710274457179455, 28.44396563331284, 13.32246619809015, 27.881953363519827, 19.649515473326627, 2.6351266781481453, -7.729808614069231, 24.40587821161612, 3.0752587863273764, 12.855411839901262, 15.654197497622986, 20.28935621974587, 2.5551133080402995, 15.414184808374294, 35.988281556788756, 4.878097749988475, 11.658143945798972, 26.707581689152263, 17.877334150200262, 14.601202027073782, 31.685656069710085, 32.80906796238284, -6.403683752385096, 12.436272904615613, 9.238583769341671, 29.049180401581367, 9.587433672383115, 40.254078260411674, 24.108987570474937, 22.174413511729675, 30.745963406722204, -23.751970843366387, 18.715889491576867, 6.203873697596519, 10.97538329434645, -3.8404933712075717, 2.5289092233108903, 20.323665439707955, 4.482007455414745, 10.507249590071964, 23.36294679389246, -30.152734090059433, 13.133537242856153, 20.518415196215425, -8.008854504453758, 14.876689527857945, 45.484518364186826, 7.370504104357833, 0.6668750311310045, 18.12785357499754, 16.589765130235843, 9.824872422294556, 13.098452038525384, -14.56106352502717, -18.692766660992035, 34.199717420387294, 6.449126598749929, 11.83936767606976, 9.331403584259508, 19.697735689311983, 31.085790916639546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4037378140085704, "mean_inference_ms": 1.0145926065563389, "mean_action_processing_ms": 0.17354221395840727, "mean_env_wait_ms": 0.06121203282356724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003970503807067871, "StateBufferConnector_ms": 0.002415299415588379, "ViewRequirementAgentConnector_ms": 0.06679511070251465}, "num_episodes": 23, "episode_return_max": 152.36063710036342, "episode_return_min": -66.50766037203849, "episode_return_mean": 52.92217668879074}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 454.15008301660265, "num_env_steps_trained_throughput_per_sec": 454.15008301660265, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 7983.103, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7983.069, "sample_time_ms": 772.002, "learn_time_ms": 7199.933, "learn_throughput": 555.561, "synch_weights_time_ms": 10.672}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "training_iteration": 17, "trial_id": "eaa30_00000", "date": "2024-08-09_17-42-20", "timestamp": 1723239740, "time_this_iter_s": 8.813173055648804, "time_total_s": 134.44908261299133, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc94940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 134.44908261299133, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 29.07692307692308, "ram_util_percent": 79.58461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.045165217742719, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.733083234766804, "policy_loss": -0.004314867214659456, "vf_loss": 6.732615155265445, "vf_explained_var": 0.029667556317395004, "kl": 0.010628807795524754, "entropy": 1.4999306205088498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9576099164783956, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.662093153099219, "policy_loss": 0.019136501507697783, "vf_loss": 7.6241632844010985, "vf_explained_var": -0.023940858182807764, "kl": 0.027842012932524085, "entropy": 1.4384637601673602, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": 132.44681992687072, "episode_reward_min": -66.50766037203849, "episode_reward_mean": 50.77174527935761, "episode_len_mean": 174.38, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 17438, "policy_reward_min": {"agent_policy": -33.2538301860192, "adversary_policy": -30.152734090059433}, "policy_reward_max": {"agent_policy": 66.22340996343544, "adversary_policy": 48.26225625574069}, "policy_reward_mean": {"agent_policy": 25.385872639678805, "adversary_policy": 12.6929363198394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.95983268743643, 27.542095212097145, -16.713977189975267, 63.035683870999904, 81.51568626252839, 132.44681992687072, 11.014987891991218, -11.729904617363172, -10.228009519459778, 77.3720149688695, 58.825810265666135, 80.04467241252786, 35.1907524787766, -26.529607310370775, 18.520196492986862, 110.4058086499538, 102.75485002540427, 17.458929416879382, 21.700386484129105, 50.23004311623255, 82.3513897339704, -25.676938573528428, 28.547768483897606, 40.289022553464406, 62.24606858913448, 75.44777012537239, -0.8209711383543841, 107.85591483616687, 84.02525951517849, 116.0395616067327, 15.022249915203751, 103.97674757996388, 92.34605922519204, -12.368640819435004, 30.951533849032856, 88.77663387881707, 102.64635757151771, 34.10997213653132, 85.52621071859753, 73.24150005637998, 28.15363456361493, 53.45429652548182, 50.136070550408405, 88.61290717180671, 101.86304485176873, 83.53286366280594, 95.06293767369297, -10.189363871842172, 54.962273995886996, 57.01921867504849, 45.688939055572305, 102.80493273032613, 33.07248339157487, 89.16983167870511, 92.57371619356772, 52.81076841999551, 43.349713347914566, 77.27322814792896, 128.72613166177317, 105.8407538369037, -10.072162703579114, 34.358513983885935, -2.6231682957933202, 49.61134579024545, 67.74039276792885, -34.03839369440655, 25.01912138352335, 120.72241578408952, 16.074758270977693, 69.43523741046683, 45.846648921639925, -66.50766037203849, 81.29768803827446, 42.34154252065857, 101.56705321190293, 70.38016945244475, 4.326635491880426, 26.70836301731798, -14.229586151894125, 63.03265413818272, 19.168764294000948, 24.437471598651285, 87.96424324696441, 41.546091633009, 67.72452206005914, 56.68891765748123, 80.14335358504769, 20.45651143067612, 77.16894837689006, 18.114695357415066, -6.379460828199292, 15.577216028831451, 8.392113368644566, 43.620014921681765, 78.12566545101058, 100.67400895968193, 39.451431133248676, 34.626772984136274, 59.37210596909932, 7.040648108771094], "episode_lengths": [200, 200, 200, 106, 200, 200, 200, 200, 200, 181, 200, 200, 200, 200, 200, 195, 159, 70, 139, 151, 174, 200, 200, 200, 200, 200, 5, 200, 200, 183, 200, 172, 200, 200, 99, 200, 200, 200, 200, 200, 200, 144, 159, 200, 200, 200, 200, 200, 200, 177, 187, 191, 200, 200, 200, 200, 200, 178, 144, 119, 200, 200, 200, 200, 167, 200, 91, 200, 200, 116, 149, 200, 200, 200, 200, 200, 16, 200, 200, 136, 200, 163, 195, 200, 118, 200, 200, 99, 200, 23, 200, 200, 11, 200, 200, 165, 200, 51, 200, 5], "policy_agent_policy_reward": [65.47991634371817, 13.771047606048569, -8.356988594987627, 31.51784193549996, 40.75784313126411, 66.22340996343544, 5.507493945995606, -5.864952308681579, -5.114004759729887, 38.68600748443477, 29.412905132833064, 40.02233620626393, 17.5953762393883, -13.264803655185391, 9.260098246493419, 55.202904324976885, 51.37742501270212, 8.729464708439693, 10.85019324206455, 25.115021558116283, 41.1756948669852, -12.8384692867642, 14.2738842419488, 20.144511276732192, 31.123034294567248, 37.7238850626862, -0.41048556917719203, 53.92795741808344, 42.01262975758927, 58.01978080336638, 7.511124957601886, 51.98837378998196, 46.17302961259596, -6.184320409717504, 15.475766924516446, 44.38831693940854, 51.32317878575885, 17.054986068265666, 42.76310535929875, 36.62075002819, 14.076817281807463, 26.727148262740908, 25.0680352752042, 44.3064535859033, 50.93152242588438, 41.766431831403004, 47.53146883684647, -5.094681935921086, 27.481136997943494, 28.509609337524246, 22.844469527786153, 51.40246636516305, 16.53624169578744, 44.58491583935253, 46.28685809678387, 26.405384209997735, 21.674856673957287, 38.63661407396448, 64.36306583088661, 52.92037691845187, -5.036081351789512, 17.17925699194297, -1.3115841478966814, 24.8056728951227, 33.87019638396441, -17.01919684720328, 12.509560691761664, 60.36120789204476, 8.037379135488845, 34.717618705233384, 22.923324460819934, -33.2538301860192, 40.64884401913721, 21.17077126032927, 50.783526605951536, 35.19008472622237, 2.1633177459402124, 13.35418150865899, -7.114793075947063, 31.51632706909132, 9.584382147000461, 12.218735799325641, 43.982121623482215, 20.773045816504492, 33.862261030029586, 28.34445882874062, 40.07167679252386, 10.228255715338053, 38.58447418844501, 9.057347678707533, -3.1897304140996425, 7.788608014415718, 4.196056684322285, 21.81000746084089, 39.0628327255053, 50.33700447984096, 19.725715566624338, 17.313386492068133, 29.686052984549676, 3.520324054385547], "policy_adversary_policy_reward": [46.21796397150709, 19.261952372211052, -5.43161418302792, 19.20266178907649, -7.988406947358282, -0.3685816476293464, 26.99832620223705, 4.519515733262914, 16.752696672298704, 24.00514645896544, 34.67203401256961, 31.551375950865804, 15.81479969095777, -10.307305744962164, -8.139562514680783, 2.274610205999206, -9.104030832018886, 3.9900260722890053, 11.16164676438633, 27.524360720048406, 3.537612680410121, 25.87529245242294, 24.725888981834814, 15.296447224429144, 13.395433633432955, 4.199942605955342, -1.645464536869202, -11.619339118316189, -4.007214624958886, 13.267312871452306, 36.85700036297823, 18.345903961998673, 19.492591931504965, 31.88483308119717, -5.651816490878968, 14.381281199318659, 9.949753303088073, 0.9004399389764792, 29.173504133812, -4.058482575695731, 32.14107932121688, 9.034615545768297, -9.1109485676411, -3.727520719123098, 17.76133459596149, -3.4874503540126893, 11.836041719836182, 8.308469556895997, 10.025380204727075, 21.097654089840162, 3.7988714403930643, 33.925013622293164, -2.99283019503702, 2.582344625859828, 22.510846108907785, 31.41711130917564, 25.997576097894175, 16.0150536596951, 9.757524547625659, 48.26225625574069, 6.697463858214691, 0.8136610993871951, 24.993549841070035, 26.994823948911915, 30.369113756138876, 15.803915856457103, -7.418798836613362, 1.2344784268958584, 11.800084440265458, 3.675682484250986, 24.54070895258051, 19.847607986828038, 38.79479066705838, 12.52838811870045, 7.14425437847137, 9.910731689794293, 16.98867623275366, 25.7744291265451, 15.097305745810115, 21.523444282379877, -1.8070614623388206, 15.883878744146278, 25.92615752814131, 0.8009907345996039, 17.988207162861972, 7.079828112342227, 35.60779632724491, 8.698657258658407, 26.221247968704933, 24.710274457179455, 28.44396563331284, 13.32246619809015, 27.881953363519827, 19.649515473326627, 2.6351266781481453, -7.729808614069231, 24.40587821161612, 3.0752587863273764, 12.855411839901262, 15.654197497622986, 20.28935621974587, 2.5551133080402995, 15.414184808374294, 35.988281556788756, 4.878097749988475, 11.658143945798972, 26.707581689152263, 17.877334150200262, 14.601202027073782, 31.685656069710085, 32.80906796238284, -6.403683752385096, 12.436272904615613, 9.238583769341671, 29.049180401581367, 9.587433672383115, 40.254078260411674, 24.108987570474937, 22.174413511729675, 30.745963406722204, -23.751970843366387, 18.715889491576867, 6.203873697596519, 10.97538329434645, -3.8404933712075717, 2.5289092233108903, 20.323665439707955, 4.482007455414745, 10.507249590071964, 23.36294679389246, -30.152734090059433, 13.133537242856153, 20.518415196215425, -8.008854504453758, 14.876689527857945, 45.484518364186826, 7.370504104357833, 0.6668750311310045, 18.12785357499754, 16.589765130235843, 9.824872422294556, 13.098452038525384, -14.56106352502717, -18.692766660992035, 34.199717420387294, 6.449126598749929, 11.83936767606976, 9.331403584259508, 19.697735689311983, 31.085790916639546, 24.605980537914554, 10.58410418830782, -0.7900508924895746, 2.953368638429787, 14.392652241591229, -1.0384707329322413, -6.156630973290522, -0.9581621026565443, 29.170399414029276, 2.3459276550620345, 6.511056433741481, 3.0733257132589706, -18.19487201500723, 30.41360781433287, 15.82330867606113, 28.158812947421087, -0.6187398422061516, 21.391785658710646, 43.688674014863864, -9.82641298483427, 14.861329572593018, 13.483129256147603, 32.87507733403589, 7.1965994584879756, 13.891863392827995, -3.6636076774899458, 7.763770568968404, 30.820703619476618, 10.00053770687883, -0.9431900281712977, 2.6016072279946556, -5.791337642094296, 6.52422485918261, 1.2643831552331086, 3.8449465819230655, 0.35111010239921825, 25.508090643265596, -3.6980831824247122, 21.780731272677052, 17.28210145282827, 22.28244460847638, 28.05455987136459, 3.4936065095819693, 16.23210905704237, 7.677266606352076, 9.63611988571606, 14.156779250101486, 15.52927373444819, 2.046354208448374, 1.473969845937173]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4021796413170344, "mean_inference_ms": 1.0091120974497307, "mean_action_processing_ms": 0.1727819196605447, "mean_env_wait_ms": 0.06081739604931785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003203272819519043, "StateBufferConnector_ms": 0.0024378299713134766, "ViewRequirementAgentConnector_ms": 0.0637502670288086}, "num_episodes": 25, "episode_return_max": 132.44681992687072, "episode_return_min": -66.50766037203849, "episode_return_mean": 50.77174527935761}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 481.59252044804265, "num_env_steps_trained_throughput_per_sec": 481.59252044804265, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 8046.091, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8046.057, "sample_time_ms": 769.091, "learn_time_ms": 7265.501, "learn_throughput": 550.547, "synch_weights_time_ms": 11.006}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 18, "trial_id": "eaa30_00000", "date": "2024-08-09_17-42-28", "timestamp": 1723239748, "time_this_iter_s": 8.311437129974365, "time_total_s": 142.7605197429657, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc94c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 142.7605197429657, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 23.71666666666667, "ram_util_percent": 79.75000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.754322402376347, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.618579431311794, "policy_loss": -0.003800696514118167, "vf_loss": 6.616867951741294, "vf_explained_var": 0.1562049356087175, "kl": 0.012249287818533875, "entropy": 1.4855140196583259, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1804882507771253, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.237460142870743, "policy_loss": 0.006317254968356186, "vf_loss": 8.21362793346246, "vf_explained_var": -0.05426690764725208, "kl": 0.01729871486410654, "entropy": 1.4313092382003865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "env_runners": {"episode_reward_max": 142.4257495173798, "episode_reward_min": -66.50766037203849, "episode_reward_mean": 55.97159980208786, "episode_len_mean": 172.05, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 17205, "policy_reward_min": {"agent_policy": -33.2538301860192, "adversary_policy": -30.152734090059433}, "policy_reward_max": {"agent_policy": 71.21287475868989, "adversary_policy": 48.26225625574069}, "policy_reward_mean": {"agent_policy": 27.98579990104393, "adversary_policy": 13.992899950521963}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.289022553464406, 62.24606858913448, 75.44777012537239, -0.8209711383543841, 107.85591483616687, 84.02525951517849, 116.0395616067327, 15.022249915203751, 103.97674757996388, 92.34605922519204, -12.368640819435004, 30.951533849032856, 88.77663387881707, 102.64635757151771, 34.10997213653132, 85.52621071859753, 73.24150005637998, 28.15363456361493, 53.45429652548182, 50.136070550408405, 88.61290717180671, 101.86304485176873, 83.53286366280594, 95.06293767369297, -10.189363871842172, 54.962273995886996, 57.01921867504849, 45.688939055572305, 102.80493273032613, 33.07248339157487, 89.16983167870511, 92.57371619356772, 52.81076841999551, 43.349713347914566, 77.27322814792896, 128.72613166177317, 105.8407538369037, -10.072162703579114, 34.358513983885935, -2.6231682957933202, 49.61134579024545, 67.74039276792885, -34.03839369440655, 25.01912138352335, 120.72241578408952, 16.074758270977693, 69.43523741046683, 45.846648921639925, -66.50766037203849, 81.29768803827446, 42.34154252065857, 101.56705321190293, 70.38016945244475, 4.326635491880426, 26.70836301731798, -14.229586151894125, 63.03265413818272, 19.168764294000948, 24.437471598651285, 87.96424324696441, 41.546091633009, 67.72452206005914, 56.68891765748123, 80.14335358504769, 20.45651143067612, 77.16894837689006, 18.114695357415066, -6.379460828199292, 15.577216028831451, 8.392113368644566, 43.620014921681765, 78.12566545101058, 100.67400895968193, 39.451431133248676, 34.626772984136274, 59.37210596909932, 7.040648108771094, 25.475903253622043, 109.38866207960774, 96.30040892319262, 110.65683155800863, 85.0233857657281, 40.42579948153494, 35.05158374062944, -4.606802052562852, 46.42540928713922, 77.15344516068951, 60.200872309403564, 3.9373489309898133, 142.4257495173798, 52.61957709562816, 131.4503865351329, 128.49092548823876, 115.92848944602046, -18.42414660701204, 82.59805869074556, 85.93212379367905, 29.73910382159278, 89.14692923392228, 33.68469799023447], "episode_lengths": [200, 200, 200, 5, 200, 200, 183, 200, 172, 200, 200, 99, 200, 200, 200, 200, 200, 200, 144, 159, 200, 200, 200, 200, 200, 200, 177, 187, 191, 200, 200, 200, 200, 200, 178, 144, 119, 200, 200, 200, 200, 167, 200, 91, 200, 200, 116, 149, 200, 200, 200, 200, 200, 16, 200, 200, 136, 200, 163, 195, 200, 118, 200, 200, 99, 200, 23, 200, 200, 11, 200, 200, 165, 200, 51, 200, 5, 200, 129, 187, 200, 130, 200, 200, 200, 125, 200, 200, 14, 172, 200, 200, 126, 200, 200, 118, 200, 141, 200, 200], "policy_agent_policy_reward": [20.144511276732192, 31.123034294567248, 37.7238850626862, -0.41048556917719203, 53.92795741808344, 42.01262975758927, 58.01978080336638, 7.511124957601886, 51.98837378998196, 46.17302961259596, -6.184320409717504, 15.475766924516446, 44.38831693940854, 51.32317878575885, 17.054986068265666, 42.76310535929875, 36.62075002819, 14.076817281807463, 26.727148262740908, 25.0680352752042, 44.3064535859033, 50.93152242588438, 41.766431831403004, 47.53146883684647, -5.094681935921086, 27.481136997943494, 28.509609337524246, 22.844469527786153, 51.40246636516305, 16.53624169578744, 44.58491583935253, 46.28685809678387, 26.405384209997735, 21.674856673957287, 38.63661407396448, 64.36306583088661, 52.92037691845187, -5.036081351789512, 17.17925699194297, -1.3115841478966814, 24.8056728951227, 33.87019638396441, -17.01919684720328, 12.509560691761664, 60.36120789204476, 8.037379135488845, 34.717618705233384, 22.923324460819934, -33.2538301860192, 40.64884401913721, 21.17077126032927, 50.783526605951536, 35.19008472622237, 2.1633177459402124, 13.35418150865899, -7.114793075947063, 31.51632706909132, 9.584382147000461, 12.218735799325641, 43.982121623482215, 20.773045816504492, 33.862261030029586, 28.34445882874062, 40.07167679252386, 10.228255715338053, 38.58447418844501, 9.057347678707533, -3.1897304140996425, 7.788608014415718, 4.196056684322285, 21.81000746084089, 39.0628327255053, 50.33700447984096, 19.725715566624338, 17.313386492068133, 29.686052984549676, 3.520324054385547, 12.737951626811038, 54.69433103980385, 48.150204461596275, 55.32841577900426, 42.51169288286405, 20.212899740767483, 17.525791870314727, -2.3034010262814277, 23.212704643569612, 38.57672258034473, 30.100436154701782, 1.9686744654949069, 71.21287475868989, 26.309788547814094, 65.72519326756641, 64.24546274411944, 57.96424472301021, -9.212073303506028, 41.299029345372816, 42.96606189683955, 14.869551910796368, 44.57346461696117, 16.84234899511724], "policy_adversary_policy_reward": [11.836041719836182, 8.308469556895997, 10.025380204727075, 21.097654089840162, 3.7988714403930643, 33.925013622293164, -2.99283019503702, 2.582344625859828, 22.510846108907785, 31.41711130917564, 25.997576097894175, 16.0150536596951, 9.757524547625659, 48.26225625574069, 6.697463858214691, 0.8136610993871951, 24.993549841070035, 26.994823948911915, 30.369113756138876, 15.803915856457103, -7.418798836613362, 1.2344784268958584, 11.800084440265458, 3.675682484250986, 24.54070895258051, 19.847607986828038, 38.79479066705838, 12.52838811870045, 7.14425437847137, 9.910731689794293, 16.98867623275366, 25.7744291265451, 15.097305745810115, 21.523444282379877, -1.8070614623388206, 15.883878744146278, 25.92615752814131, 0.8009907345996039, 17.988207162861972, 7.079828112342227, 35.60779632724491, 8.698657258658407, 26.221247968704933, 24.710274457179455, 28.44396563331284, 13.32246619809015, 27.881953363519827, 19.649515473326627, 2.6351266781481453, -7.729808614069231, 24.40587821161612, 3.0752587863273764, 12.855411839901262, 15.654197497622986, 20.28935621974587, 2.5551133080402995, 15.414184808374294, 35.988281556788756, 4.878097749988475, 11.658143945798972, 26.707581689152263, 17.877334150200262, 14.601202027073782, 31.685656069710085, 32.80906796238284, -6.403683752385096, 12.436272904615613, 9.238583769341671, 29.049180401581367, 9.587433672383115, 40.254078260411674, 24.108987570474937, 22.174413511729675, 30.745963406722204, -23.751970843366387, 18.715889491576867, 6.203873697596519, 10.97538329434645, -3.8404933712075717, 2.5289092233108903, 20.323665439707955, 4.482007455414745, 10.507249590071964, 23.36294679389246, -30.152734090059433, 13.133537242856153, 20.518415196215425, -8.008854504453758, 14.876689527857945, 45.484518364186826, 7.370504104357833, 0.6668750311310045, 18.12785357499754, 16.589765130235843, 9.824872422294556, 13.098452038525384, -14.56106352502717, -18.692766660992035, 34.199717420387294, 6.449126598749929, 11.83936767606976, 9.331403584259508, 19.697735689311983, 31.085790916639546, 24.605980537914554, 10.58410418830782, -0.7900508924895746, 2.953368638429787, 14.392652241591229, -1.0384707329322413, -6.156630973290522, -0.9581621026565443, 29.170399414029276, 2.3459276550620345, 6.511056433741481, 3.0733257132589706, -18.19487201500723, 30.41360781433287, 15.82330867606113, 28.158812947421087, -0.6187398422061516, 21.391785658710646, 43.688674014863864, -9.82641298483427, 14.861329572593018, 13.483129256147603, 32.87507733403589, 7.1965994584879756, 13.891863392827995, -3.6636076774899458, 7.763770568968404, 30.820703619476618, 10.00053770687883, -0.9431900281712977, 2.6016072279946556, -5.791337642094296, 6.52422485918261, 1.2643831552331086, 3.8449465819230655, 0.35111010239921825, 25.508090643265596, -3.6980831824247122, 21.780731272677052, 17.28210145282827, 22.28244460847638, 28.05455987136459, 3.4936065095819693, 16.23210905704237, 7.677266606352076, 9.63611988571606, 14.156779250101486, 15.52927373444819, 2.046354208448374, 1.473969845937173, 12.892873892961973, -0.1549222661509475, 14.611459073720614, 40.082871966083246, 32.716029266234514, 15.43417519536175, 23.13745980037106, 32.19095597863321, 0.31368211964754256, 42.19801076321651, 16.03844794666553, 4.174451794101952, 23.059109569200608, -5.533317698885878, 0.2235487497287849, -2.5269497760102126, 21.485595539762656, 1.7271091038069564, 27.52143644109529, 11.05528613924944, 2.3066310716762963, 27.793805083025475, 2.672347962271978, -0.7036734967770713, 41.29437266225882, 29.91850209643104, 13.611393587874069, 12.698394959940007, 37.086294205806276, 28.63889906176015, 27.63918223873211, 36.606280505387296, 38.740245036194146, 19.223999686816065, 5.294233858630696, -14.506307162136725, 17.35755979640376, 23.94146954896905, 19.22612430266861, 23.73993759417094, 9.207564516327484, 5.661987394468882, 33.50924968468569, 11.064214932275487, 4.506353586550688, 12.335995408566554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40064149401784116, "mean_inference_ms": 1.0041483710894223, "mean_action_processing_ms": 0.1719385774791745, "mean_env_wait_ms": 0.06045188704438786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003286600112915039, "StateBufferConnector_ms": 0.00248110294342041, "ViewRequirementAgentConnector_ms": 0.06515657901763916}, "num_episodes": 23, "episode_return_max": 142.4257495173798, "episode_return_min": -66.50766037203849, "episode_return_mean": 55.97159980208786}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 490.4082817805219, "num_env_steps_trained_throughput_per_sec": 490.4082817805219, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 8053.397, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8053.363, "sample_time_ms": 761.086, "learn_time_ms": 7280.538, "learn_throughput": 549.41, "synch_weights_time_ms": 11.279}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "training_iteration": 19, "trial_id": "eaa30_00000", "date": "2024-08-09_17-42-37", "timestamp": 1723239757, "time_this_iter_s": 8.161283731460571, "time_total_s": 150.92180347442627, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc94ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 150.92180347442627, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 24.37272727272727, "ram_util_percent": 79.57272727272726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.636379532460813, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.202072340596921, "policy_loss": -0.0016374768699130053, "vf_loss": 7.198342229197265, "vf_explained_var": 0.18403381471911434, "kl": 0.011927994902654693, "entropy": 1.4732243926436812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.422957467349867, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.431297989189625, "policy_loss": 0.04199900944173957, "vf_loss": 8.344505258897941, "vf_explained_var": -0.0008541340629259745, "kl": 0.04424069924668098, "entropy": 1.4621924382944902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 142.4257495173798, "episode_reward_min": -66.50766037203849, "episode_reward_mean": 60.74068017663637, "episode_len_mean": 161.51, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 16151, "policy_reward_min": {"agent_policy": -33.2538301860192, "adversary_policy": -30.152734090059433}, "policy_reward_max": {"agent_policy": 71.21287475868989, "adversary_policy": 47.34761559294423}, "policy_reward_mean": {"agent_policy": 30.37034008831818, "adversary_policy": 15.18517004415909}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.80493273032613, 33.07248339157487, 89.16983167870511, 92.57371619356772, 52.81076841999551, 43.349713347914566, 77.27322814792896, 128.72613166177317, 105.8407538369037, -10.072162703579114, 34.358513983885935, -2.6231682957933202, 49.61134579024545, 67.74039276792885, -34.03839369440655, 25.01912138352335, 120.72241578408952, 16.074758270977693, 69.43523741046683, 45.846648921639925, -66.50766037203849, 81.29768803827446, 42.34154252065857, 101.56705321190293, 70.38016945244475, 4.326635491880426, 26.70836301731798, -14.229586151894125, 63.03265413818272, 19.168764294000948, 24.437471598651285, 87.96424324696441, 41.546091633009, 67.72452206005914, 56.68891765748123, 80.14335358504769, 20.45651143067612, 77.16894837689006, 18.114695357415066, -6.379460828199292, 15.577216028831451, 8.392113368644566, 43.620014921681765, 78.12566545101058, 100.67400895968193, 39.451431133248676, 34.626772984136274, 59.37210596909932, 7.040648108771094, 25.475903253622043, 109.38866207960774, 96.30040892319262, 110.65683155800863, 85.0233857657281, 40.42579948153494, 35.05158374062944, -4.606802052562852, 46.42540928713922, 77.15344516068951, 60.200872309403564, 3.9373489309898133, 142.4257495173798, 52.61957709562816, 131.4503865351329, 128.49092548823876, 115.92848944602046, -18.42414660701204, 82.59805869074556, 85.93212379367905, 29.73910382159278, 89.14692923392228, 33.68469799023447, 51.936131451442094, 40.123345804064414, 86.72628581928353, 46.202850368074664, 62.448611298026464, 102.23957095496232, 140.22665720646086, 109.84832291628301, 76.03637139764531, 3.853090169189402, 18.6034010810151, 129.65429056029706, 100.05480979055474, 123.82548095818538, 89.33043671876973, 71.91311943220244, 100.38557757034016, 11.610998969015222, 68.85917792395286, 47.5756487512754, 87.75987376354989, 120.85362596173127, 57.86070480967902, 62.35720000409159, 117.75357716970181, 109.04881025996096, 74.77025298247216, 112.6578864163657], "episode_lengths": [191, 200, 200, 200, 200, 200, 178, 144, 119, 200, 200, 200, 200, 167, 200, 91, 200, 200, 116, 149, 200, 200, 200, 200, 200, 16, 200, 200, 136, 200, 163, 195, 200, 118, 200, 200, 99, 200, 23, 200, 200, 11, 200, 200, 165, 200, 51, 200, 5, 200, 129, 187, 200, 130, 200, 200, 200, 125, 200, 200, 14, 172, 200, 200, 126, 200, 200, 118, 200, 141, 200, 200, 200, 156, 161, 175, 116, 200, 167, 105, 196, 1, 93, 145, 200, 152, 142, 132, 120, 91, 200, 51, 125, 171, 142, 200, 188, 200, 135, 108], "policy_agent_policy_reward": [51.40246636516305, 16.53624169578744, 44.58491583935253, 46.28685809678387, 26.405384209997735, 21.674856673957287, 38.63661407396448, 64.36306583088661, 52.92037691845187, -5.036081351789512, 17.17925699194297, -1.3115841478966814, 24.8056728951227, 33.87019638396441, -17.01919684720328, 12.509560691761664, 60.36120789204476, 8.037379135488845, 34.717618705233384, 22.923324460819934, -33.2538301860192, 40.64884401913721, 21.17077126032927, 50.783526605951536, 35.19008472622237, 2.1633177459402124, 13.35418150865899, -7.114793075947063, 31.51632706909132, 9.584382147000461, 12.218735799325641, 43.982121623482215, 20.773045816504492, 33.862261030029586, 28.34445882874062, 40.07167679252386, 10.228255715338053, 38.58447418844501, 9.057347678707533, -3.1897304140996425, 7.788608014415718, 4.196056684322285, 21.81000746084089, 39.0628327255053, 50.33700447984096, 19.725715566624338, 17.313386492068133, 29.686052984549676, 3.520324054385547, 12.737951626811038, 54.69433103980385, 48.150204461596275, 55.32841577900426, 42.51169288286405, 20.212899740767483, 17.525791870314727, -2.3034010262814277, 23.212704643569612, 38.57672258034473, 30.100436154701782, 1.9686744654949069, 71.21287475868989, 26.309788547814094, 65.72519326756641, 64.24546274411944, 57.96424472301021, -9.212073303506028, 41.299029345372816, 42.96606189683955, 14.869551910796368, 44.57346461696117, 16.84234899511724, 25.968065725721047, 20.0616729020322, 43.36314290964174, 23.101425184037343, 31.22430564901325, 51.11978547748116, 70.11332860323044, 54.92416145814147, 38.018185698822634, 1.926545084594701, 9.301700540507548, 64.8271452801485, 50.02740489527746, 61.91274047909269, 44.66521835938486, 35.956559716101225, 50.19278878517009, 5.805499484507614, 34.42958896197643, 23.78782437563769, 43.87993688177496, 60.426812980865606, 28.930352404839503, 31.178600002045783, 58.87678858485096, 54.52440512998051, 37.385126491236086, 56.328943208182864], "policy_adversary_policy_reward": [15.414184808374294, 35.988281556788756, 4.878097749988475, 11.658143945798972, 26.707581689152263, 17.877334150200262, 14.601202027073782, 31.685656069710085, 32.80906796238284, -6.403683752385096, 12.436272904615613, 9.238583769341671, 29.049180401581367, 9.587433672383115, 40.254078260411674, 24.108987570474937, 22.174413511729675, 30.745963406722204, -23.751970843366387, 18.715889491576867, 6.203873697596519, 10.97538329434645, -3.8404933712075717, 2.5289092233108903, 20.323665439707955, 4.482007455414745, 10.507249590071964, 23.36294679389246, -30.152734090059433, 13.133537242856153, 20.518415196215425, -8.008854504453758, 14.876689527857945, 45.484518364186826, 7.370504104357833, 0.6668750311310045, 18.12785357499754, 16.589765130235843, 9.824872422294556, 13.098452038525384, -14.56106352502717, -18.692766660992035, 34.199717420387294, 6.449126598749929, 11.83936767606976, 9.331403584259508, 19.697735689311983, 31.085790916639546, 24.605980537914554, 10.58410418830782, -0.7900508924895746, 2.953368638429787, 14.392652241591229, -1.0384707329322413, -6.156630973290522, -0.9581621026565443, 29.170399414029276, 2.3459276550620345, 6.511056433741481, 3.0733257132589706, -18.19487201500723, 30.41360781433287, 15.82330867606113, 28.158812947421087, -0.6187398422061516, 21.391785658710646, 43.688674014863864, -9.82641298483427, 14.861329572593018, 13.483129256147603, 32.87507733403589, 7.1965994584879756, 13.891863392827995, -3.6636076774899458, 7.763770568968404, 30.820703619476618, 10.00053770687883, -0.9431900281712977, 2.6016072279946556, -5.791337642094296, 6.52422485918261, 1.2643831552331086, 3.8449465819230655, 0.35111010239921825, 25.508090643265596, -3.6980831824247122, 21.780731272677052, 17.28210145282827, 22.28244460847638, 28.05455987136459, 3.4936065095819693, 16.23210905704237, 7.677266606352076, 9.63611988571606, 14.156779250101486, 15.52927373444819, 2.046354208448374, 1.473969845937173, 12.892873892961973, -0.1549222661509475, 14.611459073720614, 40.082871966083246, 32.716029266234514, 15.43417519536175, 23.13745980037106, 32.19095597863321, 0.31368211964754256, 42.19801076321651, 16.03844794666553, 4.174451794101952, 23.059109569200608, -5.533317698885878, 0.2235487497287849, -2.5269497760102126, 21.485595539762656, 1.7271091038069564, 27.52143644109529, 11.05528613924944, 2.3066310716762963, 27.793805083025475, 2.672347962271978, -0.7036734967770713, 41.29437266225882, 29.91850209643104, 13.611393587874069, 12.698394959940007, 37.086294205806276, 28.63889906176015, 27.63918223873211, 36.606280505387296, 38.740245036194146, 19.223999686816065, 5.294233858630696, -14.506307162136725, 17.35755979640376, 23.94146954896905, 19.22612430266861, 23.73993759417094, 9.207564516327484, 5.661987394468882, 33.50924968468569, 11.064214932275487, 4.506353586550688, 12.335995408566554, 0.2518393867917368, 25.716226338929303, 17.982880471879906, 2.0787924301522986, 5.442230646160748, 37.920912263480986, 7.454012367132055, 15.647412816905288, -5.092970774870217, 36.31727642388346, 34.91436041824605, 16.205425059235125, 36.23305113254357, 33.88027747068684, 38.88726332943614, 16.036898128705342, 27.218668873171083, 10.799516825651585, 0.7613607569362495, 1.1651843276584515, -2.527909039861889, 11.829609580369441, 27.487162373485315, 37.33998290666316, 17.270747476580887, 32.756657418696555, 20.501244469554614, 41.41149600953808, 29.77391288000635, 14.891305479378506, 18.41597118932788, 17.540588526773348, 30.01750757554859, 20.175281209621495, 7.164653693705787, -1.3591542091981736, 12.621872948774797, 21.807716013201635, 11.178076574597677, 12.609747801040024, 2.8476419539051623, 41.03229492786979, 26.459326376219412, 33.96748660464622, 14.748780249055983, 14.181572155783513, 15.518923043104493, 15.6596769589413, 11.529172991906705, 47.34761559294423, 22.515200777732282, 32.009204352248204, 8.856211396014341, 28.52891509522175, 38.76636279123035, 17.562580416952493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39895091396777604, "mean_inference_ms": 0.9987140808878392, "mean_action_processing_ms": 0.1706847129619285, "mean_env_wait_ms": 0.06017863244703182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0024673938751220703, "ViewRequirementAgentConnector_ms": 0.06348085403442383}, "num_episodes": 28, "episode_return_max": 142.4257495173798, "episode_return_min": -66.50766037203849, "episode_return_mean": 60.74068017663637}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.24995922558725, "num_env_steps_trained_throughput_per_sec": 485.24995922558725, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 8097.245, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8097.211, "sample_time_ms": 727.787, "learn_time_ms": 7357.368, "learn_throughput": 543.673, "synch_weights_time_ms": 11.594}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 20, "trial_id": "eaa30_00000", "date": "2024-08-09_17-42-45", "timestamp": 1723239765, "time_this_iter_s": 8.248631000518799, "time_total_s": 159.17043447494507, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc7cee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 159.17043447494507, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 23.183333333333334, "ram_util_percent": 79.44166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.730071898742958, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.437835528610876, "policy_loss": -0.004308049999566739, "vf_loss": 7.437144159639954, "vf_explained_var": 0.157540525866564, "kl": 0.011109821219490003, "entropy": 1.4446148789748943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.710837691836059, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.482100882132848, "policy_loss": 0.030634308344936776, "vf_loss": 8.394138944645723, "vf_explained_var": -0.06113375338415305, "kl": 0.0377465674537234, "entropy": 1.4736023103197415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "env_runners": {"episode_reward_max": 179.00509001633154, "episode_reward_min": -18.42414660701204, "episode_reward_mean": 67.47813728262621, "episode_len_mean": 151.89, "episode_media": {}, "episodes_this_iter": 29, "episodes_timesteps_total": 15189, "policy_reward_min": {"agent_policy": -9.212073303506028, "adversary_policy": -18.19487201500723}, "policy_reward_max": {"agent_policy": 89.50254500816564, "adversary_policy": 48.58806607252072}, "policy_reward_mean": {"agent_policy": 33.739068641313104, "adversary_policy": 16.869534320656552}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.168764294000948, 24.437471598651285, 87.96424324696441, 41.546091633009, 67.72452206005914, 56.68891765748123, 80.14335358504769, 20.45651143067612, 77.16894837689006, 18.114695357415066, -6.379460828199292, 15.577216028831451, 8.392113368644566, 43.620014921681765, 78.12566545101058, 100.67400895968193, 39.451431133248676, 34.626772984136274, 59.37210596909932, 7.040648108771094, 25.475903253622043, 109.38866207960774, 96.30040892319262, 110.65683155800863, 85.0233857657281, 40.42579948153494, 35.05158374062944, -4.606802052562852, 46.42540928713922, 77.15344516068951, 60.200872309403564, 3.9373489309898133, 142.4257495173798, 52.61957709562816, 131.4503865351329, 128.49092548823876, 115.92848944602046, -18.42414660701204, 82.59805869074556, 85.93212379367905, 29.73910382159278, 89.14692923392228, 33.68469799023447, 51.936131451442094, 40.123345804064414, 86.72628581928353, 46.202850368074664, 62.448611298026464, 102.23957095496232, 140.22665720646086, 109.84832291628301, 76.03637139764531, 3.853090169189402, 18.6034010810151, 129.65429056029706, 100.05480979055474, 123.82548095818538, 89.33043671876973, 71.91311943220244, 100.38557757034016, 11.610998969015222, 68.85917792395286, 47.5756487512754, 87.75987376354989, 120.85362596173127, 57.86070480967902, 62.35720000409159, 117.75357716970181, 109.04881025996096, 74.77025298247216, 112.6578864163657, 67.50722521795032, 179.00509001633154, 156.40967572362675, 33.98277098228013, 84.13587069156678, 63.40119490501304, 68.86811614476814, 2.8266635328774408, 121.70780876890316, 80.1596170849424, 108.49675124401406, 51.36266381450969, 100.12214626530522, 64.16964526714676, 79.45821378771241, 49.286743937470185, 66.68308527019215, 9.040944845811179, 35.43543100039188, 121.98300384482317, 17.841606825637243, 82.2997144406323, 81.82573559177702, 54.02262723110526, 85.64825695043442, 38.29630946419218, 48.4469337020392, 115.95945346446011, 21.97553895746855], "episode_lengths": [200, 163, 195, 200, 118, 200, 200, 99, 200, 23, 200, 200, 11, 200, 200, 165, 200, 51, 200, 5, 200, 129, 187, 200, 130, 200, 200, 200, 125, 200, 200, 14, 172, 200, 200, 126, 200, 200, 118, 200, 141, 200, 200, 200, 156, 161, 175, 116, 200, 167, 105, 196, 1, 93, 145, 200, 152, 142, 132, 120, 91, 200, 51, 125, 171, 142, 200, 188, 200, 135, 108, 130, 190, 103, 169, 200, 96, 127, 5, 152, 99, 191, 76, 113, 200, 172, 103, 182, 170, 169, 183, 200, 161, 79, 126, 149, 119, 156, 128, 197], "policy_agent_policy_reward": [9.584382147000461, 12.218735799325641, 43.982121623482215, 20.773045816504492, 33.862261030029586, 28.34445882874062, 40.07167679252386, 10.228255715338053, 38.58447418844501, 9.057347678707533, -3.1897304140996425, 7.788608014415718, 4.196056684322285, 21.81000746084089, 39.0628327255053, 50.33700447984096, 19.725715566624338, 17.313386492068133, 29.686052984549676, 3.520324054385547, 12.737951626811038, 54.69433103980385, 48.150204461596275, 55.32841577900426, 42.51169288286405, 20.212899740767483, 17.525791870314727, -2.3034010262814277, 23.212704643569612, 38.57672258034473, 30.100436154701782, 1.9686744654949069, 71.21287475868989, 26.309788547814094, 65.72519326756641, 64.24546274411944, 57.96424472301021, -9.212073303506028, 41.299029345372816, 42.96606189683955, 14.869551910796368, 44.57346461696117, 16.84234899511724, 25.968065725721047, 20.0616729020322, 43.36314290964174, 23.101425184037343, 31.22430564901325, 51.11978547748116, 70.11332860323044, 54.92416145814147, 38.018185698822634, 1.926545084594701, 9.301700540507548, 64.8271452801485, 50.02740489527746, 61.91274047909269, 44.66521835938486, 35.956559716101225, 50.19278878517009, 5.805499484507614, 34.42958896197643, 23.78782437563769, 43.87993688177496, 60.426812980865606, 28.930352404839503, 31.178600002045783, 58.87678858485096, 54.52440512998051, 37.385126491236086, 56.328943208182864, 33.75361260897518, 89.50254500816564, 78.2048378618134, 16.991385491140065, 42.067935345783354, 31.700597452506525, 34.43405807238407, 1.4133317664387204, 60.85390438445158, 40.07980854247119, 54.24837562200704, 25.681331907254865, 50.06107313265265, 32.0848226335734, 39.72910689385619, 24.6433719687351, 33.341542635096076, 4.520472422905585, 17.71771550019595, 60.99150192241159, 8.920803412818648, 41.14985722031613, 40.91286779588854, 27.01131361555262, 42.82412847521721, 19.148154732096092, 24.223466851019626, 57.97972673223007, 10.987769478734277], "policy_adversary_policy_reward": [6.511056433741481, 3.0733257132589706, -18.19487201500723, 30.41360781433287, 15.82330867606113, 28.158812947421087, -0.6187398422061516, 21.391785658710646, 43.688674014863864, -9.82641298483427, 14.861329572593018, 13.483129256147603, 32.87507733403589, 7.1965994584879756, 13.891863392827995, -3.6636076774899458, 7.763770568968404, 30.820703619476618, 10.00053770687883, -0.9431900281712977, 2.6016072279946556, -5.791337642094296, 6.52422485918261, 1.2643831552331086, 3.8449465819230655, 0.35111010239921825, 25.508090643265596, -3.6980831824247122, 21.780731272677052, 17.28210145282827, 22.28244460847638, 28.05455987136459, 3.4936065095819693, 16.23210905704237, 7.677266606352076, 9.63611988571606, 14.156779250101486, 15.52927373444819, 2.046354208448374, 1.473969845937173, 12.892873892961973, -0.1549222661509475, 14.611459073720614, 40.082871966083246, 32.716029266234514, 15.43417519536175, 23.13745980037106, 32.19095597863321, 0.31368211964754256, 42.19801076321651, 16.03844794666553, 4.174451794101952, 23.059109569200608, -5.533317698885878, 0.2235487497287849, -2.5269497760102126, 21.485595539762656, 1.7271091038069564, 27.52143644109529, 11.05528613924944, 2.3066310716762963, 27.793805083025475, 2.672347962271978, -0.7036734967770713, 41.29437266225882, 29.91850209643104, 13.611393587874069, 12.698394959940007, 37.086294205806276, 28.63889906176015, 27.63918223873211, 36.606280505387296, 38.740245036194146, 19.223999686816065, 5.294233858630696, -14.506307162136725, 17.35755979640376, 23.94146954896905, 19.22612430266861, 23.73993759417094, 9.207564516327484, 5.661987394468882, 33.50924968468569, 11.064214932275487, 4.506353586550688, 12.335995408566554, 0.2518393867917368, 25.716226338929303, 17.982880471879906, 2.0787924301522986, 5.442230646160748, 37.920912263480986, 7.454012367132055, 15.647412816905288, -5.092970774870217, 36.31727642388346, 34.91436041824605, 16.205425059235125, 36.23305113254357, 33.88027747068684, 38.88726332943614, 16.036898128705342, 27.218668873171083, 10.799516825651585, 0.7613607569362495, 1.1651843276584515, -2.527909039861889, 11.829609580369441, 27.487162373485315, 37.33998290666316, 17.270747476580887, 32.756657418696555, 20.501244469554614, 41.41149600953808, 29.77391288000635, 14.891305479378506, 18.41597118932788, 17.540588526773348, 30.01750757554859, 20.175281209621495, 7.164653693705787, -1.3591542091981736, 12.621872948774797, 21.807716013201635, 11.178076574597677, 12.609747801040024, 2.8476419539051623, 41.03229492786979, 26.459326376219412, 33.96748660464622, 14.748780249055983, 14.181572155783513, 15.518923043104493, 15.6596769589413, 11.529172991906705, 47.34761559294423, 22.515200777732282, 32.009204352248204, 8.856211396014341, 28.52891509522175, 38.76636279123035, 17.562580416952493, 6.393281828539342, 27.360330780435838, 48.58806607252072, 40.914478935644986, 31.916697585969327, 46.28814027584405, 13.651935424240733, 3.3394500668993476, 3.197259841316601, 38.87067550446679, 12.257626869073103, 19.44297058343341, 15.739311283995054, 18.694746788389015, 2.229571667546385, -0.8162399011076644, 39.46633738826278, 21.387566996188774, 23.44784599972167, 16.63196254274952, 28.09520432278493, 26.153171299222116, 0.5587700590861413, 25.12256184816872, 23.53412419828952, 26.526948934363105, 14.032332964355197, 18.05248966921821, 11.075903609475189, 28.653203284380993, 12.330066409980596, 12.313305558754493, 39.539719672815075, -6.198177037719008, 8.935155801764394, -4.41468337885881, -1.0154794994808753, 18.733194999676815, 27.98861104833518, 33.00289087407638, 3.4676898216206946, 5.45311359119795, 33.483087356118205, 7.666769864197899, 25.76702556584323, 15.145842230045309, 20.533220350941548, 6.478093264611072, 14.892583861231538, 27.931544613985658, 18.594266512808314, 0.5538882192877725, 14.412118172501568, 9.811348678518044, 31.449438462948677, 26.530288269281396, -5.426461113087312, 16.414230591821585]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3972130717103158, "mean_inference_ms": 0.9931380166819247, "mean_action_processing_ms": 0.1699435822518582, "mean_env_wait_ms": 0.05986657943693995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003356337547302246, "StateBufferConnector_ms": 0.0024279356002807617, "ViewRequirementAgentConnector_ms": 0.06398177146911621}, "num_episodes": 29, "episode_return_max": 179.00509001633154, "episode_return_min": -18.42414660701204, "episode_return_mean": 67.47813728262621}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 489.76272750743203, "num_env_steps_trained_throughput_per_sec": 489.76272750743203, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 8151.523, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8151.489, "sample_time_ms": 729.396, "learn_time_ms": 7409.744, "learn_throughput": 539.83, "synch_weights_time_ms": 11.888}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "training_iteration": 21, "trial_id": "eaa30_00000", "date": "2024-08-09_17-42-53", "timestamp": 1723239773, "time_this_iter_s": 8.172303199768066, "time_total_s": 167.34273767471313, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc94e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 167.34273767471313, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 23.224999999999998, "ram_util_percent": 79.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.54321697962978, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.095348242855577, "policy_loss": 0.0017489760002939317, "vf_loss": 7.086696686315789, "vf_explained_var": 0.059436354813752354, "kl": 0.015339082904238865, "entropy": 1.412809561106263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.94543977615734, "cur_kl_coeff": 2.2781249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.113056540985902, "policy_loss": 0.014635165661942059, "vf_loss": 8.018604574600856, "vf_explained_var": -0.0017819627498586973, "kl": 0.035036179328259705, "entropy": 1.4595662005245686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": 179.00509001633154, "episode_reward_min": -18.42414660701204, "episode_reward_mean": 79.52908164971483, "episode_len_mean": 143.32, "episode_media": {}, "episodes_this_iter": 32, "episodes_timesteps_total": 14332, "policy_reward_min": {"agent_policy": -9.212073303506028, "adversary_policy": -14.506307162136725}, "policy_reward_max": {"agent_policy": 89.50254500816564, "adversary_policy": 50.01957706595477}, "policy_reward_mean": {"agent_policy": 39.76454082485741, "adversary_policy": 19.882270412428703}, "custom_metrics": {}, "hist_stats": {"episode_reward": [142.4257495173798, 52.61957709562816, 131.4503865351329, 128.49092548823876, 115.92848944602046, -18.42414660701204, 82.59805869074556, 85.93212379367905, 29.73910382159278, 89.14692923392228, 33.68469799023447, 51.936131451442094, 40.123345804064414, 86.72628581928353, 46.202850368074664, 62.448611298026464, 102.23957095496232, 140.22665720646086, 109.84832291628301, 76.03637139764531, 3.853090169189402, 18.6034010810151, 129.65429056029706, 100.05480979055474, 123.82548095818538, 89.33043671876973, 71.91311943220244, 100.38557757034016, 11.610998969015222, 68.85917792395286, 47.5756487512754, 87.75987376354989, 120.85362596173127, 57.86070480967902, 62.35720000409159, 117.75357716970181, 109.04881025996096, 74.77025298247216, 112.6578864163657, 67.50722521795032, 179.00509001633154, 156.40967572362675, 33.98277098228013, 84.13587069156678, 63.40119490501304, 68.86811614476814, 2.8266635328774408, 121.70780876890316, 80.1596170849424, 108.49675124401406, 51.36266381450969, 100.12214626530522, 64.16964526714676, 79.45821378771241, 49.286743937470185, 66.68308527019215, 9.040944845811179, 35.43543100039188, 121.98300384482317, 17.841606825637243, 82.2997144406323, 81.82573559177702, 54.02262723110526, 85.64825695043442, 38.29630946419218, 48.4469337020392, 115.95945346446011, 21.97553895746855, 82.21797991545243, 83.68561425397101, 97.76972456488453, 58.91492610598891, 56.0931586279027, 78.0289553875503, 81.42054705507752, 118.57044537030109, 164.51642015766168, 76.28051705706515, 78.25709273954513, 102.91985343405767, 82.54460845463035, 90.97227339282747, 164.19463184621335, 136.0370030696234, 86.1804572450455, 76.21785444399356, 100.9645106923991, 39.17889826985994, 95.63588718144773, 75.64076269160971, 84.73161922520347, 125.24133637238944, 81.83765463051373, 28.760341498233128, 116.90635808569797, 86.30520788733861, 61.48344462622543, 27.090468894061384, 91.13172567233994, 34.711041634833116], "episode_lengths": [172, 200, 200, 126, 200, 200, 118, 200, 141, 200, 200, 200, 156, 161, 175, 116, 200, 167, 105, 196, 1, 93, 145, 200, 152, 142, 132, 120, 91, 200, 51, 125, 171, 142, 200, 188, 200, 135, 108, 130, 190, 103, 169, 200, 96, 127, 5, 152, 99, 191, 76, 113, 200, 172, 103, 182, 170, 169, 183, 200, 161, 79, 126, 149, 119, 156, 128, 197, 146, 134, 129, 95, 200, 87, 166, 117, 181, 53, 170, 166, 145, 140, 200, 148, 122, 75, 107, 94, 130, 150, 126, 190, 136, 32, 200, 121, 89, 64, 200, 45], "policy_agent_policy_reward": [71.21287475868989, 26.309788547814094, 65.72519326756641, 64.24546274411944, 57.96424472301021, -9.212073303506028, 41.299029345372816, 42.96606189683955, 14.869551910796368, 44.57346461696117, 16.84234899511724, 25.968065725721047, 20.0616729020322, 43.36314290964174, 23.101425184037343, 31.22430564901325, 51.11978547748116, 70.11332860323044, 54.92416145814147, 38.018185698822634, 1.926545084594701, 9.301700540507548, 64.8271452801485, 50.02740489527746, 61.91274047909269, 44.66521835938486, 35.956559716101225, 50.19278878517009, 5.805499484507614, 34.42958896197643, 23.78782437563769, 43.87993688177496, 60.426812980865606, 28.930352404839503, 31.178600002045783, 58.87678858485096, 54.52440512998051, 37.385126491236086, 56.328943208182864, 33.75361260897518, 89.50254500816564, 78.2048378618134, 16.991385491140065, 42.067935345783354, 31.700597452506525, 34.43405807238407, 1.4133317664387204, 60.85390438445158, 40.07980854247119, 54.24837562200704, 25.681331907254865, 50.06107313265265, 32.0848226335734, 39.72910689385619, 24.6433719687351, 33.341542635096076, 4.520472422905585, 17.71771550019595, 60.99150192241159, 8.920803412818648, 41.14985722031613, 40.91286779588854, 27.01131361555262, 42.82412847521721, 19.148154732096092, 24.223466851019626, 57.97972673223007, 10.987769478734277, 41.10898995772623, 41.84280712698551, 48.88486228244224, 29.457463052994452, 28.04657931395137, 39.01447769377516, 40.71027352753875, 59.28522268515055, 82.2582100788308, 38.14025852853256, 39.12854636977259, 51.459926717028864, 41.27230422731519, 45.48613669641374, 82.09731592310673, 68.01850153481173, 43.09022862252275, 38.108927221996765, 50.48225534619958, 19.589449134929982, 47.81794359072389, 37.82038134580484, 42.36580961260174, 62.62066818619477, 40.918827315256856, 14.38017074911657, 58.45317904284897, 43.1526039436693, 30.741722313112724, 13.545234447030694, 45.565862836169934, 17.355520817416558], "policy_adversary_policy_reward": [41.29437266225882, 29.91850209643104, 13.611393587874069, 12.698394959940007, 37.086294205806276, 28.63889906176015, 27.63918223873211, 36.606280505387296, 38.740245036194146, 19.223999686816065, 5.294233858630696, -14.506307162136725, 17.35755979640376, 23.94146954896905, 19.22612430266861, 23.73993759417094, 9.207564516327484, 5.661987394468882, 33.50924968468569, 11.064214932275487, 4.506353586550688, 12.335995408566554, 0.2518393867917368, 25.716226338929303, 17.982880471879906, 2.0787924301522986, 5.442230646160748, 37.920912263480986, 7.454012367132055, 15.647412816905288, -5.092970774870217, 36.31727642388346, 34.91436041824605, 16.205425059235125, 36.23305113254357, 33.88027747068684, 38.88726332943614, 16.036898128705342, 27.218668873171083, 10.799516825651585, 0.7613607569362495, 1.1651843276584515, -2.527909039861889, 11.829609580369441, 27.487162373485315, 37.33998290666316, 17.270747476580887, 32.756657418696555, 20.501244469554614, 41.41149600953808, 29.77391288000635, 14.891305479378506, 18.41597118932788, 17.540588526773348, 30.01750757554859, 20.175281209621495, 7.164653693705787, -1.3591542091981736, 12.621872948774797, 21.807716013201635, 11.178076574597677, 12.609747801040024, 2.8476419539051623, 41.03229492786979, 26.459326376219412, 33.96748660464622, 14.748780249055983, 14.181572155783513, 15.518923043104493, 15.6596769589413, 11.529172991906705, 47.34761559294423, 22.515200777732282, 32.009204352248204, 8.856211396014341, 28.52891509522175, 38.76636279123035, 17.562580416952493, 6.393281828539342, 27.360330780435838, 48.58806607252072, 40.914478935644986, 31.916697585969327, 46.28814027584405, 13.651935424240733, 3.3394500668993476, 3.197259841316601, 38.87067550446679, 12.257626869073103, 19.44297058343341, 15.739311283995054, 18.694746788389015, 2.229571667546385, -0.8162399011076644, 39.46633738826278, 21.387566996188774, 23.44784599972167, 16.63196254274952, 28.09520432278493, 26.153171299222116, 0.5587700590861413, 25.12256184816872, 23.53412419828952, 26.526948934363105, 14.032332964355197, 18.05248966921821, 11.075903609475189, 28.653203284380993, 12.330066409980596, 12.313305558754493, 39.539719672815075, -6.198177037719008, 8.935155801764394, -4.41468337885881, -1.0154794994808753, 18.733194999676815, 27.98861104833518, 33.00289087407638, 3.4676898216206946, 5.45311359119795, 33.483087356118205, 7.666769864197899, 25.76702556584323, 15.145842230045309, 20.533220350941548, 6.478093264611072, 14.892583861231538, 27.931544613985658, 18.594266512808314, 0.5538882192877725, 14.412118172501568, 9.811348678518044, 31.449438462948677, 26.530288269281396, -5.426461113087312, 16.414230591821585, 15.717575236347567, 25.391414721378638, 6.313629651383672, 35.529177475601834, 25.942743214798682, 22.942119067643564, 11.42549600294174, 18.031967050052707, -3.253557244737479, 31.30013655868885, 17.099767097482093, 21.914710596293066, 18.12267601591001, 22.587597511628744, 47.13311038279301, 12.15211230235756, 43.57842712149419, 38.67978295733667, 12.183374564963128, 25.956883963569446, 29.72791865705369, 9.400627712718874, 25.590247286226997, 25.869679430801835, 41.090082197394125, 0.18222202992108905, 20.277492699087574, 25.208643997326163, 41.67818670005904, 40.41912922304766, 50.01957706595477, 17.99892446885694, 14.195827091955351, 28.8944015305674, 19.006814601652344, 19.10211262034443, 27.053704167386947, 23.428551178812622, 1.8465786046754538, 17.742870530254525, 42.51913247651688, 5.298811114207016, 35.81773621578844, 2.002645130016404, 20.295174326639458, 22.070635285962275, 38.996105756586054, 23.624562429608712, 27.0551755641055, 13.863651751151338, 5.187089359277171, 9.1930813898394, 20.148032974843126, 38.305146068005826, 28.620713258587962, 14.531890685081327, 24.924723373912435, 5.816998939200275, 3.669350621921737, 9.875883825108957, 13.588853142313443, 31.977009693856477, 15.141921124054704, 2.2135996933618554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3961718938155403, "mean_inference_ms": 0.9887882893539502, "mean_action_processing_ms": 0.16951926567706493, "mean_env_wait_ms": 0.0595862143394804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033118724822998047, "StateBufferConnector_ms": 0.0024651288986206055, "ViewRequirementAgentConnector_ms": 0.06528306007385254}, "num_episodes": 32, "episode_return_max": 179.00509001633154, "episode_return_min": -18.42414660701204, "episode_return_mean": 79.52908164971483}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 490.096423046183, "num_env_steps_trained_throughput_per_sec": 490.096423046183, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 8232.014, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8231.98, "sample_time_ms": 733.801, "learn_time_ms": 7485.614, "learn_throughput": 534.358, "synch_weights_time_ms": 12.053}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 22, "trial_id": "eaa30_00000", "date": "2024-08-09_17-43-02", "timestamp": 1723239782, "time_this_iter_s": 8.167364120483398, "time_total_s": 175.51010179519653, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc1d160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 175.51010179519653, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 22.575, "ram_util_percent": 79.44166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.547450699629607, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.361439668816864, "policy_loss": 0.012265295921282834, "vf_loss": 7.338200761401464, "vf_explained_var": 0.04938502948750895, "kl": 0.024385855120739767, "entropy": 1.3934579600732793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.4278761631498735, "cur_kl_coeff": 3.417187499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.768725584447385, "policy_loss": 0.037933610251639036, "vf_loss": 8.499274549881617, "vf_explained_var": -0.04955841302871704, "kl": 0.06775086371150489, "entropy": 1.4905116262535254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "env_runners": {"episode_reward_max": 179.00509001633154, "episode_reward_min": 2.8266635328774408, "episode_reward_mean": 84.73448627727244, "episode_len_mean": 137.82, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 13782, "policy_reward_min": {"agent_policy": 1.4133317664387204, "adversary_policy": -6.198177037719008}, "policy_reward_max": {"agent_policy": 89.50254500816564, "adversary_policy": 50.01957706595477}, "policy_reward_mean": {"agent_policy": 42.36724313863622, "adversary_policy": 21.183621569318106}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.610998969015222, 68.85917792395286, 47.5756487512754, 87.75987376354989, 120.85362596173127, 57.86070480967902, 62.35720000409159, 117.75357716970181, 109.04881025996096, 74.77025298247216, 112.6578864163657, 67.50722521795032, 179.00509001633154, 156.40967572362675, 33.98277098228013, 84.13587069156678, 63.40119490501304, 68.86811614476814, 2.8266635328774408, 121.70780876890316, 80.1596170849424, 108.49675124401406, 51.36266381450969, 100.12214626530522, 64.16964526714676, 79.45821378771241, 49.286743937470185, 66.68308527019215, 9.040944845811179, 35.43543100039188, 121.98300384482317, 17.841606825637243, 82.2997144406323, 81.82573559177702, 54.02262723110526, 85.64825695043442, 38.29630946419218, 48.4469337020392, 115.95945346446011, 21.97553895746855, 82.21797991545243, 83.68561425397101, 97.76972456488453, 58.91492610598891, 56.0931586279027, 78.0289553875503, 81.42054705507752, 118.57044537030109, 164.51642015766168, 76.28051705706515, 78.25709273954513, 102.91985343405767, 82.54460845463035, 90.97227339282747, 164.19463184621335, 136.0370030696234, 86.1804572450455, 76.21785444399356, 100.9645106923991, 39.17889826985994, 95.63588718144773, 75.64076269160971, 84.73161922520347, 125.24133637238944, 81.83765463051373, 28.760341498233128, 116.90635808569797, 86.30520788733861, 61.48344462622543, 27.090468894061384, 91.13172567233994, 34.711041634833116, 81.30938599131801, 113.40302892107582, 159.96640369504243, 86.5303069460815, 76.91848215675071, 82.2368885569959, 119.85555659607628, 139.55409227495997, 84.10710776340473, 116.72129860002323, 166.34474012416774, 119.52365931154017, 87.80276996619838, 97.13977280038175, 48.595151334296375, 130.61571014362121, 152.30112353507053, 102.1912448386376, 99.12409373909296, 61.4597170490659, 6.238026361111704, 109.45816022961104, 87.24871607676599, 57.354461040370715, 59.05414213068951, 46.154720308462494, 110.741689289283, 145.5902614780244], "episode_lengths": [91, 200, 51, 125, 171, 142, 200, 188, 200, 135, 108, 130, 190, 103, 169, 200, 96, 127, 5, 152, 99, 191, 76, 113, 200, 172, 103, 182, 170, 169, 183, 200, 161, 79, 126, 149, 119, 156, 128, 197, 146, 134, 129, 95, 200, 87, 166, 117, 181, 53, 170, 166, 145, 140, 200, 148, 122, 75, 107, 94, 130, 150, 126, 190, 136, 32, 200, 121, 89, 64, 200, 45, 62, 38, 200, 93, 63, 200, 153, 140, 72, 200, 154, 129, 112, 149, 200, 158, 167, 200, 190, 200, 2, 175, 112, 73, 116, 139, 200, 171], "policy_agent_policy_reward": [5.805499484507614, 34.42958896197643, 23.78782437563769, 43.87993688177496, 60.426812980865606, 28.930352404839503, 31.178600002045783, 58.87678858485096, 54.52440512998051, 37.385126491236086, 56.328943208182864, 33.75361260897518, 89.50254500816564, 78.2048378618134, 16.991385491140065, 42.067935345783354, 31.700597452506525, 34.43405807238407, 1.4133317664387204, 60.85390438445158, 40.07980854247119, 54.24837562200704, 25.681331907254865, 50.06107313265265, 32.0848226335734, 39.72910689385619, 24.6433719687351, 33.341542635096076, 4.520472422905585, 17.71771550019595, 60.99150192241159, 8.920803412818648, 41.14985722031613, 40.91286779588854, 27.01131361555262, 42.82412847521721, 19.148154732096092, 24.223466851019626, 57.97972673223007, 10.987769478734277, 41.10898995772623, 41.84280712698551, 48.88486228244224, 29.457463052994452, 28.04657931395137, 39.01447769377516, 40.71027352753875, 59.28522268515055, 82.2582100788308, 38.14025852853256, 39.12854636977259, 51.459926717028864, 41.27230422731519, 45.48613669641374, 82.09731592310673, 68.01850153481173, 43.09022862252275, 38.108927221996765, 50.48225534619958, 19.589449134929982, 47.81794359072389, 37.82038134580484, 42.36580961260174, 62.62066818619477, 40.918827315256856, 14.38017074911657, 58.45317904284897, 43.1526039436693, 30.741722313112724, 13.545234447030694, 45.565862836169934, 17.355520817416558, 40.654692995659005, 56.701514460537894, 79.98320184752114, 43.265153473040755, 38.45924107837536, 41.11844427849795, 59.92777829803813, 69.77704613748006, 42.05355388170239, 58.36064930001164, 83.17237006208386, 59.76182965577008, 43.901384983099184, 48.56988640019087, 24.29757566714816, 65.30785507181066, 76.15056176753525, 51.09562241931877, 49.56204686954646, 30.72985852453295, 3.119013180555852, 54.72908011480549, 43.62435803838302, 28.677230520185365, 29.527071065344778, 23.077360154231254, 55.370844644641515, 72.79513073901224], "policy_adversary_policy_reward": [7.164653693705787, -1.3591542091981736, 12.621872948774797, 21.807716013201635, 11.178076574597677, 12.609747801040024, 2.8476419539051623, 41.03229492786979, 26.459326376219412, 33.96748660464622, 14.748780249055983, 14.181572155783513, 15.518923043104493, 15.6596769589413, 11.529172991906705, 47.34761559294423, 22.515200777732282, 32.009204352248204, 8.856211396014341, 28.52891509522175, 38.76636279123035, 17.562580416952493, 6.393281828539342, 27.360330780435838, 48.58806607252072, 40.914478935644986, 31.916697585969327, 46.28814027584405, 13.651935424240733, 3.3394500668993476, 3.197259841316601, 38.87067550446679, 12.257626869073103, 19.44297058343341, 15.739311283995054, 18.694746788389015, 2.229571667546385, -0.8162399011076644, 39.46633738826278, 21.387566996188774, 23.44784599972167, 16.63196254274952, 28.09520432278493, 26.153171299222116, 0.5587700590861413, 25.12256184816872, 23.53412419828952, 26.526948934363105, 14.032332964355197, 18.05248966921821, 11.075903609475189, 28.653203284380993, 12.330066409980596, 12.313305558754493, 39.539719672815075, -6.198177037719008, 8.935155801764394, -4.41468337885881, -1.0154794994808753, 18.733194999676815, 27.98861104833518, 33.00289087407638, 3.4676898216206946, 5.45311359119795, 33.483087356118205, 7.666769864197899, 25.76702556584323, 15.145842230045309, 20.533220350941548, 6.478093264611072, 14.892583861231538, 27.931544613985658, 18.594266512808314, 0.5538882192877725, 14.412118172501568, 9.811348678518044, 31.449438462948677, 26.530288269281396, -5.426461113087312, 16.414230591821585, 15.717575236347567, 25.391414721378638, 6.313629651383672, 35.529177475601834, 25.942743214798682, 22.942119067643564, 11.42549600294174, 18.031967050052707, -3.253557244737479, 31.30013655868885, 17.099767097482093, 21.914710596293066, 18.12267601591001, 22.587597511628744, 47.13311038279301, 12.15211230235756, 43.57842712149419, 38.67978295733667, 12.183374564963128, 25.956883963569446, 29.72791865705369, 9.400627712718874, 25.590247286226997, 25.869679430801835, 41.090082197394125, 0.18222202992108905, 20.277492699087574, 25.208643997326163, 41.67818670005904, 40.41912922304766, 50.01957706595477, 17.99892446885694, 14.195827091955351, 28.8944015305674, 19.006814601652344, 19.10211262034443, 27.053704167386947, 23.428551178812622, 1.8465786046754538, 17.742870530254525, 42.51913247651688, 5.298811114207016, 35.81773621578844, 2.002645130016404, 20.295174326639458, 22.070635285962275, 38.996105756586054, 23.624562429608712, 27.0551755641055, 13.863651751151338, 5.187089359277171, 9.1930813898394, 20.148032974843126, 38.305146068005826, 28.620713258587962, 14.531890685081327, 24.924723373912435, 5.816998939200275, 3.669350621921737, 9.875883825108957, 13.588853142313443, 31.977009693856477, 15.141921124054704, 2.2135996933618554, 16.992153499476533, 23.662539496182465, 26.079497757409644, 30.62201670312826, 33.18062023152782, 46.802581615993304, 20.243088809659763, 23.022064663381, 22.75432858423923, 15.70491249413611, 35.6198906194289, 5.498553659069058, 20.845274574672626, 39.08250372336551, 41.281240479331146, 28.495805658148882, 23.9188985330211, 18.134655348681292, 33.101196660133354, 25.259452639878276, 44.46407848296068, 38.708291579123205, 24.526746906606615, 35.235082749163446, 20.393963269421477, 23.507421713677722, 32.202941078687374, 16.36694532150349, 14.292376208365908, 10.005199458782243, 19.27722314424635, 46.03063192756432, 48.42462281375769, 27.725938953777554, 30.971050690787294, 20.124571728531475, 23.91889512364216, 25.643151745904323, 0.6772019674730352, 30.05265655705992, 2.141502805216289, 0.9775103753395626, 25.672005209189926, 29.057074905615572, 14.445915038735304, 29.178442999647736, 9.677847294706437, 18.999383225478926, 26.14825088916028, 3.3788201761844956, 3.183117396534861, 19.89424275769639, 41.9564639209657, 13.414380723675768, 36.39949177778384, 36.39563896122833]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3956455851004066, "mean_inference_ms": 0.9860949390282522, "mean_action_processing_ms": 0.1694849187350959, "mean_env_wait_ms": 0.05937290148002633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003268003463745117, "StateBufferConnector_ms": 0.0023919343948364258, "ViewRequirementAgentConnector_ms": 0.06458067893981934}, "num_episodes": 28, "episode_return_max": 179.00509001633154, "episode_return_min": 2.8266635328774408, "episode_return_mean": 84.73448627727244}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 483.5492896741723, "num_env_steps_trained_throughput_per_sec": 483.5492896741723, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 8313.764, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8313.731, "sample_time_ms": 737.644, "learn_time_ms": 7563.182, "learn_throughput": 528.878, "synch_weights_time_ms": 12.369}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "training_iteration": 23, "trial_id": "eaa30_00000", "date": "2024-08-09_17-43-10", "timestamp": 1723239790, "time_this_iter_s": 8.278175115585327, "time_total_s": 183.78827691078186, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc1d310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 183.78827691078186, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 23.258333333333336, "ram_util_percent": 79.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.768768730239263, "cur_kl_coeff": 0.675, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.36257158713366, "policy_loss": 0.004515341512499151, "vf_loss": 7.346352151840452, "vf_explained_var": -0.00045693340124907316, "kl": 0.017339403291661587, "entropy": 1.4083194721943486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.406025564608474, "cur_kl_coeff": 5.125781250000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.813637315730254, "policy_loss": 0.043398519641292904, "vf_loss": 8.329861950377623, "vf_explained_var": 0.0802087281520168, "kl": 0.08591410288742433, "entropy": 1.513541153818369, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 169.80223540928893, "episode_reward_min": -21.312195277074096, "episode_reward_mean": 79.98005057277004, "episode_len_mean": 139.97, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 13997, "policy_reward_min": {"agent_policy": -10.656097638536991, "adversary_policy": -6.608740063799212}, "policy_reward_max": {"agent_policy": 84.9011177046445, "adversary_policy": 50.86493421259023}, "policy_reward_mean": {"agent_policy": 39.99002528638502, "adversary_policy": 19.99501264319251}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.286743937470185, 66.68308527019215, 9.040944845811179, 35.43543100039188, 121.98300384482317, 17.841606825637243, 82.2997144406323, 81.82573559177702, 54.02262723110526, 85.64825695043442, 38.29630946419218, 48.4469337020392, 115.95945346446011, 21.97553895746855, 82.21797991545243, 83.68561425397101, 97.76972456488453, 58.91492610598891, 56.0931586279027, 78.0289553875503, 81.42054705507752, 118.57044537030109, 164.51642015766168, 76.28051705706515, 78.25709273954513, 102.91985343405767, 82.54460845463035, 90.97227339282747, 164.19463184621335, 136.0370030696234, 86.1804572450455, 76.21785444399356, 100.9645106923991, 39.17889826985994, 95.63588718144773, 75.64076269160971, 84.73161922520347, 125.24133637238944, 81.83765463051373, 28.760341498233128, 116.90635808569797, 86.30520788733861, 61.48344462622543, 27.090468894061384, 91.13172567233994, 34.711041634833116, 81.30938599131801, 113.40302892107582, 159.96640369504243, 86.5303069460815, 76.91848215675071, 82.2368885569959, 119.85555659607628, 139.55409227495997, 84.10710776340473, 116.72129860002323, 166.34474012416774, 119.52365931154017, 87.80276996619838, 97.13977280038175, 48.595151334296375, 130.61571014362121, 152.30112353507053, 102.1912448386376, 99.12409373909296, 61.4597170490659, 6.238026361111704, 109.45816022961104, 87.24871607676599, 57.354461040370715, 59.05414213068951, 46.154720308462494, 110.741689289283, 145.5902614780244, 98.12564497187985, 2.708448131275615, 20.10244004448417, 121.7321244107851, 70.91776184130356, 103.8400279345081, 74.1317985150282, 70.02727048575193, 34.88873074984526, 31.28429702264708, 169.80223540928893, 75.29447531732933, 7.068577488830515, -21.312195277074096, 96.32193222266746, 64.94169908239182, 56.205956896380215, 29.3525453202026, 67.86454284825122, 110.99283317899652, 104.5571902460927, 49.91584197640089, 20.991625544169224, 96.04912628437174, 22.56136067601843, 78.9113486866784], "episode_lengths": [103, 182, 170, 169, 183, 200, 161, 79, 126, 149, 119, 156, 128, 197, 146, 134, 129, 95, 200, 87, 166, 117, 181, 53, 170, 166, 145, 140, 200, 148, 122, 75, 107, 94, 130, 150, 126, 190, 136, 32, 200, 121, 89, 64, 200, 45, 62, 38, 200, 93, 63, 200, 153, 140, 72, 200, 154, 129, 112, 149, 200, 158, 167, 200, 190, 200, 2, 175, 112, 73, 116, 139, 200, 171, 138, 2, 200, 141, 38, 200, 121, 104, 193, 200, 200, 200, 17, 200, 135, 200, 200, 200, 200, 197, 181, 90, 18, 126, 200, 148], "policy_agent_policy_reward": [24.6433719687351, 33.341542635096076, 4.520472422905585, 17.71771550019595, 60.99150192241159, 8.920803412818648, 41.14985722031613, 40.91286779588854, 27.01131361555262, 42.82412847521721, 19.148154732096092, 24.223466851019626, 57.97972673223007, 10.987769478734277, 41.10898995772623, 41.84280712698551, 48.88486228244224, 29.457463052994452, 28.04657931395137, 39.01447769377516, 40.71027352753875, 59.28522268515055, 82.2582100788308, 38.14025852853256, 39.12854636977259, 51.459926717028864, 41.27230422731519, 45.48613669641374, 82.09731592310673, 68.01850153481173, 43.09022862252275, 38.108927221996765, 50.48225534619958, 19.589449134929982, 47.81794359072389, 37.82038134580484, 42.36580961260174, 62.62066818619477, 40.918827315256856, 14.38017074911657, 58.45317904284897, 43.1526039436693, 30.741722313112724, 13.545234447030694, 45.565862836169934, 17.355520817416558, 40.654692995659005, 56.701514460537894, 79.98320184752114, 43.265153473040755, 38.45924107837536, 41.11844427849795, 59.92777829803813, 69.77704613748006, 42.05355388170239, 58.36064930001164, 83.17237006208386, 59.76182965577008, 43.901384983099184, 48.56988640019087, 24.29757566714816, 65.30785507181066, 76.15056176753525, 51.09562241931877, 49.56204686954646, 30.72985852453295, 3.119013180555852, 54.72908011480549, 43.62435803838302, 28.677230520185365, 29.527071065344778, 23.077360154231254, 55.370844644641515, 72.79513073901224, 49.06282248593992, 1.3542240656378075, 10.051220022242084, 60.86606220539251, 35.45888092065175, 51.920013967254064, 37.06589925751412, 35.01363524287594, 17.44436537492262, 15.642148511323605, 84.9011177046445, 37.64723765866464, 3.534288744415257, -10.656097638536991, 48.160966111333785, 32.47084954119592, 28.102978448190093, 14.67627266010129, 33.9322714241256, 55.49641658949826, 52.27859512304638, 24.957920988200456, 10.495812772084614, 48.02456314218581, 11.280680338009208, 39.45567434333924], "policy_adversary_policy_reward": [12.330066409980596, 12.313305558754493, 39.539719672815075, -6.198177037719008, 8.935155801764394, -4.41468337885881, -1.0154794994808753, 18.733194999676815, 27.98861104833518, 33.00289087407638, 3.4676898216206946, 5.45311359119795, 33.483087356118205, 7.666769864197899, 25.76702556584323, 15.145842230045309, 20.533220350941548, 6.478093264611072, 14.892583861231538, 27.931544613985658, 18.594266512808314, 0.5538882192877725, 14.412118172501568, 9.811348678518044, 31.449438462948677, 26.530288269281396, -5.426461113087312, 16.414230591821585, 15.717575236347567, 25.391414721378638, 6.313629651383672, 35.529177475601834, 25.942743214798682, 22.942119067643564, 11.42549600294174, 18.031967050052707, -3.253557244737479, 31.30013655868885, 17.099767097482093, 21.914710596293066, 18.12267601591001, 22.587597511628744, 47.13311038279301, 12.15211230235756, 43.57842712149419, 38.67978295733667, 12.183374564963128, 25.956883963569446, 29.72791865705369, 9.400627712718874, 25.590247286226997, 25.869679430801835, 41.090082197394125, 0.18222202992108905, 20.277492699087574, 25.208643997326163, 41.67818670005904, 40.41912922304766, 50.01957706595477, 17.99892446885694, 14.195827091955351, 28.8944015305674, 19.006814601652344, 19.10211262034443, 27.053704167386947, 23.428551178812622, 1.8465786046754538, 17.742870530254525, 42.51913247651688, 5.298811114207016, 35.81773621578844, 2.002645130016404, 20.295174326639458, 22.070635285962275, 38.996105756586054, 23.624562429608712, 27.0551755641055, 13.863651751151338, 5.187089359277171, 9.1930813898394, 20.148032974843126, 38.305146068005826, 28.620713258587962, 14.531890685081327, 24.924723373912435, 5.816998939200275, 3.669350621921737, 9.875883825108957, 13.588853142313443, 31.977009693856477, 15.141921124054704, 2.2135996933618554, 16.992153499476533, 23.662539496182465, 26.079497757409644, 30.62201670312826, 33.18062023152782, 46.802581615993304, 20.243088809659763, 23.022064663381, 22.75432858423923, 15.70491249413611, 35.6198906194289, 5.498553659069058, 20.845274574672626, 39.08250372336551, 41.281240479331146, 28.495805658148882, 23.9188985330211, 18.134655348681292, 33.101196660133354, 25.259452639878276, 44.46407848296068, 38.708291579123205, 24.526746906606615, 35.235082749163446, 20.393963269421477, 23.507421713677722, 32.202941078687374, 16.36694532150349, 14.292376208365908, 10.005199458782243, 19.27722314424635, 46.03063192756432, 48.42462281375769, 27.725938953777554, 30.971050690787294, 20.124571728531475, 23.91889512364216, 25.643151745904323, 0.6772019674730352, 30.05265655705992, 2.141502805216289, 0.9775103753395626, 25.672005209189926, 29.057074905615572, 14.445915038735304, 29.178442999647736, 9.677847294706437, 18.999383225478926, 26.14825088916028, 3.3788201761844956, 3.183117396534861, 19.89424275769639, 41.9564639209657, 13.414380723675768, 36.39949177778384, 36.39563896122833, 34.41998133299199, 14.642841152947927, 1.2575597311153608, 0.09666433452244638, 5.790257173106187, 4.260962849135892, 29.576591055882755, 31.289471149509765, 18.144561170705853, 17.314319749945906, 18.553978863286382, 33.36603510396767, 9.095529787824672, 27.970369469689444, 4.721279513952345, 30.292355728923585, 3.1668403000855445, 14.277525074837072, 21.096212084691725, -5.454063573368121, 50.86493421259023, 34.03618349205425, 28.931078353866322, 8.716159304798321, 5.628596977246457, -2.0943082328311995, -6.020095582209919, -4.636002056327083, 24.987947602631532, 23.173018508702242, 15.466976190325003, 17.003873350870922, 9.582605696228832, 18.520372751961265, 7.433371167081679, 7.242901493019611, 25.947540071847715, 7.984731352277901, 33.71417848723803, 21.782238102260212, 19.315706336576643, 32.96288878646972, 16.465784832779423, 8.492136155421031, -1.4736680412220977, 11.969480813306712, 21.24596522561589, 26.778597916569915, 17.889420401808415, -6.608740063799212, 27.962285572097443, 11.493388771241783]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39500573350954854, "mean_inference_ms": 0.9851697855800181, "mean_action_processing_ms": 0.1692224061902448, "mean_env_wait_ms": 0.059144921789693515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032187700271606445, "StateBufferConnector_ms": 0.002435922622680664, "ViewRequirementAgentConnector_ms": 0.06365585327148438}, "num_episodes": 26, "episode_return_max": 169.80223540928893, "episode_return_min": -21.312195277074096, "episode_return_mean": 79.98005057277004}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 449.15185629553037, "num_env_steps_trained_throughput_per_sec": 449.15185629553037, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 8364.447, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8364.413, "sample_time_ms": 737.662, "learn_time_ms": 7612.978, "learn_throughput": 525.419, "synch_weights_time_ms": 13.07}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 24, "trial_id": "eaa30_00000", "date": "2024-08-09_17-43-19", "timestamp": 1723239799, "time_this_iter_s": 8.918590784072876, "time_total_s": 192.70686769485474, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc1d4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 192.70686769485474, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 33.792307692307695, "ram_util_percent": 79.54615384615386}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.559176754951476, "cur_kl_coeff": 0.675, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.226266377565091, "policy_loss": 0.016139126985664012, "vf_loss": 6.198726992380052, "vf_explained_var": -0.012263955861803085, "kl": 0.01688925879736426, "entropy": 1.42943441110944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.982949744537473, "cur_kl_coeff": 7.688671874999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.187565515438715, "policy_loss": 0.010238570172805338, "vf_loss": 7.91466335306565, "vf_explained_var": 0.1053039697309335, "kl": 0.03416241777401107, "entropy": 1.5193868113060793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": 169.80223540928893, "episode_reward_min": -21.312195277074096, "episode_reward_mean": 83.35258938773921, "episode_len_mean": 144.29, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 14429, "policy_reward_min": {"agent_policy": -10.656097638536991, "adversary_policy": -7.402495138336132}, "policy_reward_max": {"agent_policy": 84.9011177046445, "adversary_policy": 50.86493421259023}, "policy_reward_mean": {"agent_policy": 41.67629469386961, "adversary_policy": 20.838147346934804}, "custom_metrics": {}, "hist_stats": {"episode_reward": [164.51642015766168, 76.28051705706515, 78.25709273954513, 102.91985343405767, 82.54460845463035, 90.97227339282747, 164.19463184621335, 136.0370030696234, 86.1804572450455, 76.21785444399356, 100.9645106923991, 39.17889826985994, 95.63588718144773, 75.64076269160971, 84.73161922520347, 125.24133637238944, 81.83765463051373, 28.760341498233128, 116.90635808569797, 86.30520788733861, 61.48344462622543, 27.090468894061384, 91.13172567233994, 34.711041634833116, 81.30938599131801, 113.40302892107582, 159.96640369504243, 86.5303069460815, 76.91848215675071, 82.2368885569959, 119.85555659607628, 139.55409227495997, 84.10710776340473, 116.72129860002323, 166.34474012416774, 119.52365931154017, 87.80276996619838, 97.13977280038175, 48.595151334296375, 130.61571014362121, 152.30112353507053, 102.1912448386376, 99.12409373909296, 61.4597170490659, 6.238026361111704, 109.45816022961104, 87.24871607676599, 57.354461040370715, 59.05414213068951, 46.154720308462494, 110.741689289283, 145.5902614780244, 98.12564497187985, 2.708448131275615, 20.10244004448417, 121.7321244107851, 70.91776184130356, 103.8400279345081, 74.1317985150282, 70.02727048575193, 34.88873074984526, 31.28429702264708, 169.80223540928893, 75.29447531732933, 7.068577488830515, -21.312195277074096, 96.32193222266746, 64.94169908239182, 56.205956896380215, 29.3525453202026, 67.86454284825122, 110.99283317899652, 104.5571902460927, 49.91584197640089, 20.991625544169224, 96.04912628437174, 22.56136067601843, 78.9113486866784, -16.27368902346005, 119.47864720253683, 73.86792229313876, 110.24458200140893, 150.45784900098107, 68.13311777308512, 91.95346721433205, 85.2662885560038, 109.83374736023681, 103.1148134337358, 73.8986349368273, 93.22285348629502, 85.53323730928913, 136.54998051603275, 73.13585873915173, 101.9507240836288, 64.90402614804336, 86.08609917616262, 43.281897479886325, 82.5839972469733, 78.66533576465342, 6.811227605536139], "episode_lengths": [181, 53, 170, 166, 145, 140, 200, 148, 122, 75, 107, 94, 130, 150, 126, 190, 136, 32, 200, 121, 89, 64, 200, 45, 62, 38, 200, 93, 63, 200, 153, 140, 72, 200, 154, 129, 112, 149, 200, 158, 167, 200, 190, 200, 2, 175, 112, 73, 116, 139, 200, 171, 138, 2, 200, 141, 38, 200, 121, 104, 193, 200, 200, 200, 17, 200, 135, 200, 200, 200, 200, 197, 181, 90, 18, 126, 200, 148, 200, 172, 200, 76, 158, 200, 104, 200, 109, 200, 200, 187, 183, 127, 150, 197, 200, 200, 69, 200, 96, 200], "policy_agent_policy_reward": [82.2582100788308, 38.14025852853256, 39.12854636977259, 51.459926717028864, 41.27230422731519, 45.48613669641374, 82.09731592310673, 68.01850153481173, 43.09022862252275, 38.108927221996765, 50.48225534619958, 19.589449134929982, 47.81794359072389, 37.82038134580484, 42.36580961260174, 62.62066818619477, 40.918827315256856, 14.38017074911657, 58.45317904284897, 43.1526039436693, 30.741722313112724, 13.545234447030694, 45.565862836169934, 17.355520817416558, 40.654692995659005, 56.701514460537894, 79.98320184752114, 43.265153473040755, 38.45924107837536, 41.11844427849795, 59.92777829803813, 69.77704613748006, 42.05355388170239, 58.36064930001164, 83.17237006208386, 59.76182965577008, 43.901384983099184, 48.56988640019087, 24.29757566714816, 65.30785507181066, 76.15056176753525, 51.09562241931877, 49.56204686954646, 30.72985852453295, 3.119013180555852, 54.72908011480549, 43.62435803838302, 28.677230520185365, 29.527071065344778, 23.077360154231254, 55.370844644641515, 72.79513073901224, 49.06282248593992, 1.3542240656378075, 10.051220022242084, 60.86606220539251, 35.45888092065175, 51.920013967254064, 37.06589925751412, 35.01363524287594, 17.44436537492262, 15.642148511323605, 84.9011177046445, 37.64723765866464, 3.534288744415257, -10.656097638536991, 48.160966111333785, 32.47084954119592, 28.102978448190093, 14.67627266010129, 33.9322714241256, 55.49641658949826, 52.27859512304638, 24.957920988200456, 10.495812772084614, 48.02456314218581, 11.280680338009208, 39.45567434333924, -8.136844511729997, 59.73932360126838, 36.9339611465694, 55.122291000704436, 75.22892450049058, 34.06655888654255, 45.97673360716601, 42.63314427800186, 54.916873680118385, 51.55740671686791, 36.94931746841364, 46.61142674314751, 42.76661865464456, 68.27499025801636, 36.56792936957585, 50.97536204181443, 32.45201307402166, 43.04304958808131, 21.640948739943166, 41.29199862348664, 39.33266788232669, 3.405613802768084], "policy_adversary_policy_reward": [43.57842712149419, 38.67978295733667, 12.183374564963128, 25.956883963569446, 29.72791865705369, 9.400627712718874, 25.590247286226997, 25.869679430801835, 41.090082197394125, 0.18222202992108905, 20.277492699087574, 25.208643997326163, 41.67818670005904, 40.41912922304766, 50.01957706595477, 17.99892446885694, 14.195827091955351, 28.8944015305674, 19.006814601652344, 19.10211262034443, 27.053704167386947, 23.428551178812622, 1.8465786046754538, 17.742870530254525, 42.51913247651688, 5.298811114207016, 35.81773621578844, 2.002645130016404, 20.295174326639458, 22.070635285962275, 38.996105756586054, 23.624562429608712, 27.0551755641055, 13.863651751151338, 5.187089359277171, 9.1930813898394, 20.148032974843126, 38.305146068005826, 28.620713258587962, 14.531890685081327, 24.924723373912435, 5.816998939200275, 3.669350621921737, 9.875883825108957, 13.588853142313443, 31.977009693856477, 15.141921124054704, 2.2135996933618554, 16.992153499476533, 23.662539496182465, 26.079497757409644, 30.62201670312826, 33.18062023152782, 46.802581615993304, 20.243088809659763, 23.022064663381, 22.75432858423923, 15.70491249413611, 35.6198906194289, 5.498553659069058, 20.845274574672626, 39.08250372336551, 41.281240479331146, 28.495805658148882, 23.9188985330211, 18.134655348681292, 33.101196660133354, 25.259452639878276, 44.46407848296068, 38.708291579123205, 24.526746906606615, 35.235082749163446, 20.393963269421477, 23.507421713677722, 32.202941078687374, 16.36694532150349, 14.292376208365908, 10.005199458782243, 19.27722314424635, 46.03063192756432, 48.42462281375769, 27.725938953777554, 30.971050690787294, 20.124571728531475, 23.91889512364216, 25.643151745904323, 0.6772019674730352, 30.05265655705992, 2.141502805216289, 0.9775103753395626, 25.672005209189926, 29.057074905615572, 14.445915038735304, 29.178442999647736, 9.677847294706437, 18.999383225478926, 26.14825088916028, 3.3788201761844956, 3.183117396534861, 19.89424275769639, 41.9564639209657, 13.414380723675768, 36.39949177778384, 36.39563896122833, 34.41998133299199, 14.642841152947927, 1.2575597311153608, 0.09666433452244638, 5.790257173106187, 4.260962849135892, 29.576591055882755, 31.289471149509765, 18.144561170705853, 17.314319749945906, 18.553978863286382, 33.36603510396767, 9.095529787824672, 27.970369469689444, 4.721279513952345, 30.292355728923585, 3.1668403000855445, 14.277525074837072, 21.096212084691725, -5.454063573368121, 50.86493421259023, 34.03618349205425, 28.931078353866322, 8.716159304798321, 5.628596977246457, -2.0943082328311995, -6.020095582209919, -4.636002056327083, 24.987947602631532, 23.173018508702242, 15.466976190325003, 17.003873350870922, 9.582605696228832, 18.520372751961265, 7.433371167081679, 7.242901493019611, 25.947540071847715, 7.984731352277901, 33.71417848723803, 21.782238102260212, 19.315706336576643, 32.96288878646972, 16.465784832779423, 8.492136155421031, -1.4736680412220977, 11.969480813306712, 21.24596522561589, 26.778597916569915, 17.889420401808415, -6.608740063799212, 27.962285572097443, 11.493388771241783, -7.402495138336132, -0.7343493733938686, 42.81271138067303, 16.92661222059537, 8.05870117277438, 28.875259973795018, 30.099092968979598, 25.023198031724835, 46.435448015020626, 28.793476485469974, 13.410132192420008, 20.65642669412253, 22.918009693221187, 23.05872391394482, 8.830131439876467, 33.803012838125426, 27.731290839421337, 27.185582840697045, 23.4900910528063, 28.067315664061603, 17.450345593382433, 19.498971875031216, 30.54262141909568, 16.068805324051844, 22.475890728360582, 20.29072792628399, 38.50396691030987, 29.77102334770649, 24.572209791726458, 11.995719577849393, 16.77497613797237, 34.20038590384205, 19.015333975145758, 13.436679098875906, 17.360692119208913, 25.682357468872397, 11.54128637206129, 10.099662367881882, 27.08396292914083, 14.208035694345796, 16.404009732038528, 22.928658150288165, 9.51298162630814, -6.107367823540056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39464668711627693, "mean_inference_ms": 0.9851353751324965, "mean_action_processing_ms": 0.16903929223337769, "mean_env_wait_ms": 0.05921294780495663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033881664276123047, "StateBufferConnector_ms": 0.002536773681640625, "ViewRequirementAgentConnector_ms": 0.06691491603851318}, "num_episodes": 22, "episode_return_max": 169.80223540928893, "episode_return_min": -21.312195277074096, "episode_return_mean": 83.35258938773921}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 490.54421462198246, "num_env_steps_trained_throughput_per_sec": 490.54421462198246, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 8339.772, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8339.738, "sample_time_ms": 748.026, "learn_time_ms": 7577.848, "learn_throughput": 527.854, "synch_weights_time_ms": 13.154}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 25, "trial_id": "eaa30_00000", "date": "2024-08-09_17-43-27", "timestamp": 1723239807, "time_this_iter_s": 8.158968925476074, "time_total_s": 200.8658366203308, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc1d550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 200.8658366203308, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 27.20909090909091, "ram_util_percent": 80.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.056674291847875, "cur_kl_coeff": 0.675, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.048328739246994, "policy_loss": 0.006240742978462506, "vf_loss": 7.027811404636928, "vf_explained_var": -0.08001536241284123, "kl": 0.02115047827471422, "entropy": 1.4409355249985185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.1226089355846245, "cur_kl_coeff": 11.533007812499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.198784351845582, "policy_loss": 0.01584636680248271, "vf_loss": 7.81625121931235, "vf_explained_var": 0.0606399180367589, "kl": 0.0317945464553001, "entropy": 1.5169249755640826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": 169.80223540928893, "episode_reward_min": -39.87667419428374, "episode_reward_mean": 76.28617946239096, "episode_len_mean": 158.05, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 15805, "policy_reward_min": {"agent_policy": -19.938337097141872, "adversary_policy": -16.528301065752117}, "policy_reward_max": {"agent_policy": 84.9011177046445, "adversary_policy": 54.00187716065041}, "policy_reward_mean": {"agent_policy": 38.14308973119548, "adversary_policy": 19.071544865597744}, "custom_metrics": {}, "hist_stats": {"episode_reward": [81.30938599131801, 113.40302892107582, 159.96640369504243, 86.5303069460815, 76.91848215675071, 82.2368885569959, 119.85555659607628, 139.55409227495997, 84.10710776340473, 116.72129860002323, 166.34474012416774, 119.52365931154017, 87.80276996619838, 97.13977280038175, 48.595151334296375, 130.61571014362121, 152.30112353507053, 102.1912448386376, 99.12409373909296, 61.4597170490659, 6.238026361111704, 109.45816022961104, 87.24871607676599, 57.354461040370715, 59.05414213068951, 46.154720308462494, 110.741689289283, 145.5902614780244, 98.12564497187985, 2.708448131275615, 20.10244004448417, 121.7321244107851, 70.91776184130356, 103.8400279345081, 74.1317985150282, 70.02727048575193, 34.88873074984526, 31.28429702264708, 169.80223540928893, 75.29447531732933, 7.068577488830515, -21.312195277074096, 96.32193222266746, 64.94169908239182, 56.205956896380215, 29.3525453202026, 67.86454284825122, 110.99283317899652, 104.5571902460927, 49.91584197640089, 20.991625544169224, 96.04912628437174, 22.56136067601843, 78.9113486866784, -16.27368902346005, 119.47864720253683, 73.86792229313876, 110.24458200140893, 150.45784900098107, 68.13311777308512, 91.95346721433205, 85.2662885560038, 109.83374736023681, 103.1148134337358, 73.8986349368273, 93.22285348629502, 85.53323730928913, 136.54998051603275, 73.13585873915173, 101.9507240836288, 64.90402614804336, 86.08609917616262, 43.281897479886325, 82.5839972469733, 78.66533576465342, 6.811227605536139, 127.32294223948196, 34.90672153900842, 47.901476244159895, 97.49820428029781, 90.08807619695068, 87.58655762948946, 31.31789791555358, 111.07174216257742, 5.349015273101277, 38.84213107386557, 59.01058176884118, 7.180662099373226, 140.9699972826908, 25.03939661470877, 52.500390568516934, -3.920989852049427, 8.413612161446482, -39.87667419428374, 64.16130043761935, 26.726209873140434, 78.11455036461507, 74.52356621228247, 119.14282635377626, 117.22878242282992], "episode_lengths": [62, 38, 200, 93, 63, 200, 153, 140, 72, 200, 154, 129, 112, 149, 200, 158, 167, 200, 190, 200, 2, 175, 112, 73, 116, 139, 200, 171, 138, 2, 200, 141, 38, 200, 121, 104, 193, 200, 200, 200, 17, 200, 135, 200, 200, 200, 200, 197, 181, 90, 18, 126, 200, 148, 200, 172, 200, 76, 158, 200, 104, 200, 109, 200, 200, 187, 183, 127, 150, 197, 200, 200, 69, 200, 96, 200, 200, 191, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 197, 200, 200, 200, 152, 200, 200, 200, 123, 200, 188, 200], "policy_agent_policy_reward": [40.654692995659005, 56.701514460537894, 79.98320184752114, 43.265153473040755, 38.45924107837536, 41.11844427849795, 59.92777829803813, 69.77704613748006, 42.05355388170239, 58.36064930001164, 83.17237006208386, 59.76182965577008, 43.901384983099184, 48.56988640019087, 24.29757566714816, 65.30785507181066, 76.15056176753525, 51.09562241931877, 49.56204686954646, 30.72985852453295, 3.119013180555852, 54.72908011480549, 43.62435803838302, 28.677230520185365, 29.527071065344778, 23.077360154231254, 55.370844644641515, 72.79513073901224, 49.06282248593992, 1.3542240656378075, 10.051220022242084, 60.86606220539251, 35.45888092065175, 51.920013967254064, 37.06589925751412, 35.01363524287594, 17.44436537492262, 15.642148511323605, 84.9011177046445, 37.64723765866464, 3.534288744415257, -10.656097638536991, 48.160966111333785, 32.47084954119592, 28.102978448190093, 14.67627266010129, 33.9322714241256, 55.49641658949826, 52.27859512304638, 24.957920988200456, 10.495812772084614, 48.02456314218581, 11.280680338009208, 39.45567434333924, -8.136844511729997, 59.73932360126838, 36.9339611465694, 55.122291000704436, 75.22892450049058, 34.06655888654255, 45.97673360716601, 42.63314427800186, 54.916873680118385, 51.55740671686791, 36.94931746841364, 46.61142674314751, 42.76661865464456, 68.27499025801636, 36.56792936957585, 50.97536204181443, 32.45201307402166, 43.04304958808131, 21.640948739943166, 41.29199862348664, 39.33266788232669, 3.405613802768084, 63.661471119740995, 17.453360769504194, 23.95073812207994, 48.74910214014881, 45.044038098475355, 43.793278814744745, 15.658948957776794, 55.53587108128879, 2.6745076365506386, 19.42106553693278, 29.50529088442059, 3.590331049686627, 70.48499864134544, 12.519698307354385, 26.25019528425846, -1.9604949260247118, 4.206806080723251, -19.938337097141872, 32.08065021880968, 13.363104936570226, 39.057275182307514, 37.26178310614125, 59.57141317688818, 58.614391211414954], "policy_adversary_policy_reward": [16.992153499476533, 23.662539496182465, 26.079497757409644, 30.62201670312826, 33.18062023152782, 46.802581615993304, 20.243088809659763, 23.022064663381, 22.75432858423923, 15.70491249413611, 35.6198906194289, 5.498553659069058, 20.845274574672626, 39.08250372336551, 41.281240479331146, 28.495805658148882, 23.9188985330211, 18.134655348681292, 33.101196660133354, 25.259452639878276, 44.46407848296068, 38.708291579123205, 24.526746906606615, 35.235082749163446, 20.393963269421477, 23.507421713677722, 32.202941078687374, 16.36694532150349, 14.292376208365908, 10.005199458782243, 19.27722314424635, 46.03063192756432, 48.42462281375769, 27.725938953777554, 30.971050690787294, 20.124571728531475, 23.91889512364216, 25.643151745904323, 0.6772019674730352, 30.05265655705992, 2.141502805216289, 0.9775103753395626, 25.672005209189926, 29.057074905615572, 14.445915038735304, 29.178442999647736, 9.677847294706437, 18.999383225478926, 26.14825088916028, 3.3788201761844956, 3.183117396534861, 19.89424275769639, 41.9564639209657, 13.414380723675768, 36.39949177778384, 36.39563896122833, 34.41998133299199, 14.642841152947927, 1.2575597311153608, 0.09666433452244638, 5.790257173106187, 4.260962849135892, 29.576591055882755, 31.289471149509765, 18.144561170705853, 17.314319749945906, 18.553978863286382, 33.36603510396767, 9.095529787824672, 27.970369469689444, 4.721279513952345, 30.292355728923585, 3.1668403000855445, 14.277525074837072, 21.096212084691725, -5.454063573368121, 50.86493421259023, 34.03618349205425, 28.931078353866322, 8.716159304798321, 5.628596977246457, -2.0943082328311995, -6.020095582209919, -4.636002056327083, 24.987947602631532, 23.173018508702242, 15.466976190325003, 17.003873350870922, 9.582605696228832, 18.520372751961265, 7.433371167081679, 7.242901493019611, 25.947540071847715, 7.984731352277901, 33.71417848723803, 21.782238102260212, 19.315706336576643, 32.96288878646972, 16.465784832779423, 8.492136155421031, -1.4736680412220977, 11.969480813306712, 21.24596522561589, 26.778597916569915, 17.889420401808415, -6.608740063799212, 27.962285572097443, 11.493388771241783, -7.402495138336132, -0.7343493733938686, 42.81271138067303, 16.92661222059537, 8.05870117277438, 28.875259973795018, 30.099092968979598, 25.023198031724835, 46.435448015020626, 28.793476485469974, 13.410132192420008, 20.65642669412253, 22.918009693221187, 23.05872391394482, 8.830131439876467, 33.803012838125426, 27.731290839421337, 27.185582840697045, 23.4900910528063, 28.067315664061603, 17.450345593382433, 19.498971875031216, 30.54262141909568, 16.068805324051844, 22.475890728360582, 20.29072792628399, 38.50396691030987, 29.77102334770649, 24.572209791726458, 11.995719577849393, 16.77497613797237, 34.20038590384205, 19.015333975145758, 13.436679098875906, 17.360692119208913, 25.682357468872397, 11.54128637206129, 10.099662367881882, 27.08396292914083, 14.208035694345796, 16.404009732038528, 22.928658150288165, 9.51298162630814, -6.107367823540056, 9.659593959090579, 54.00187716065041, 11.455305237556749, 5.998055531947444, 6.469867619187348, 17.480870502892586, 24.64950438562773, 24.099597754521138, 21.016732238835118, 24.027305859640233, 24.562714760191767, 19.23056405455298, 4.541270282118738, 11.117678675658059, 24.698536852727585, 30.83733422856121, 7.273801846962118, -4.599294210411479, 6.0867297451616835, 13.334335791771096, 27.71298540181024, 1.7923054826103648, -2.043347270242524, 5.633678319929153, 21.368193094506907, 49.11680554683854, 15.614431868438334, -3.094733561083949, 23.484358327595217, 2.765836956663234, -1.078078992859755, -0.8824159331649568, -6.377892348219277, 10.584698428942522, -3.410036031389737, -16.528301065752117, 10.428946642614244, 21.651703576195423, 16.32226898880045, -2.959164052230224, 7.547268166047617, 31.51000701625989, 24.13101862205823, 13.130764484083013, 42.83578607683017, 16.735627100057997, 26.142808115300355, 32.4715830961146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3950816713883802, "mean_inference_ms": 0.984793094135188, "mean_action_processing_ms": 0.16924064786038262, "mean_env_wait_ms": 0.05917284129483953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034880638122558594, "StateBufferConnector_ms": 0.0025407075881958008, "ViewRequirementAgentConnector_ms": 0.06607770919799805}, "num_episodes": 24, "episode_return_max": 169.80223540928893, "episode_return_min": -39.87667419428374, "episode_return_mean": 76.28617946239096}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 478.2046302393082, "num_env_steps_trained_throughput_per_sec": 478.2046302393082, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 8353.869, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8353.835, "sample_time_ms": 746.756, "learn_time_ms": 7593.222, "learn_throughput": 526.786, "synch_weights_time_ms": 13.148}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 26, "trial_id": "eaa30_00000", "date": "2024-08-09_17-43-36", "timestamp": 1723239816, "time_this_iter_s": 8.371031045913696, "time_total_s": 209.2368676662445, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fca03a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 209.2368676662445, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 23.525000000000002, "ram_util_percent": 80.58333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.085702761708113, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.681347212211165, "policy_loss": 0.0249620571907452, "vf_loss": 6.62865330983722, "vf_explained_var": -0.07802090625914317, "kl": 0.027389497717438392, "entropy": 1.4485728732492558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.252840897316734, "cur_kl_coeff": 17.299511718750004, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.465435123443603, "policy_loss": 0.029324799847381657, "vf_loss": 7.846316272517045, "vf_explained_var": 0.19331486206501722, "kl": 0.034093104563847496, "entropy": 1.5254527999709049, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "env_runners": {"episode_reward_max": 169.80223540928893, "episode_reward_min": -39.87667419428374, "episode_reward_mean": 68.62620917019358, "episode_len_mean": 166.32, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 16632, "policy_reward_min": {"agent_policy": -19.938337097141872, "adversary_policy": -22.747843724286383}, "policy_reward_max": {"agent_policy": 84.9011177046445, "adversary_policy": 54.00187716065041}, "policy_reward_mean": {"agent_policy": 34.31310458509679, "adversary_policy": 17.156552292548394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.354461040370715, 59.05414213068951, 46.154720308462494, 110.741689289283, 145.5902614780244, 98.12564497187985, 2.708448131275615, 20.10244004448417, 121.7321244107851, 70.91776184130356, 103.8400279345081, 74.1317985150282, 70.02727048575193, 34.88873074984526, 31.28429702264708, 169.80223540928893, 75.29447531732933, 7.068577488830515, -21.312195277074096, 96.32193222266746, 64.94169908239182, 56.205956896380215, 29.3525453202026, 67.86454284825122, 110.99283317899652, 104.5571902460927, 49.91584197640089, 20.991625544169224, 96.04912628437174, 22.56136067601843, 78.9113486866784, -16.27368902346005, 119.47864720253683, 73.86792229313876, 110.24458200140893, 150.45784900098107, 68.13311777308512, 91.95346721433205, 85.2662885560038, 109.83374736023681, 103.1148134337358, 73.8986349368273, 93.22285348629502, 85.53323730928913, 136.54998051603275, 73.13585873915173, 101.9507240836288, 64.90402614804336, 86.08609917616262, 43.281897479886325, 82.5839972469733, 78.66533576465342, 6.811227605536139, 127.32294223948196, 34.90672153900842, 47.901476244159895, 97.49820428029781, 90.08807619695068, 87.58655762948946, 31.31789791555358, 111.07174216257742, 5.349015273101277, 38.84213107386557, 59.01058176884118, 7.180662099373226, 140.9699972826908, 25.03939661470877, 52.500390568516934, -3.920989852049427, 8.413612161446482, -39.87667419428374, 64.16130043761935, 26.726209873140434, 78.11455036461507, 74.52356621228247, 119.14282635377626, 117.22878242282992, 34.95923292962641, 58.487900943106155, 115.2325450038543, 49.22862586060463, 130.7481898923458, 82.80834185088784, 83.64365127701595, 36.403771954577294, -18.875167472198143, 108.83398473061683, 151.51368214293805, 5.793301568237417, 46.337840322641796, 146.4288064005993, 22.449821430609383, 49.926239080894845, 74.81813865920608, 98.39353180972944, 124.1605611934267, 52.75714672042105, 46.340305393930954, -29.98998277678126, 92.24793887525867], "episode_lengths": [73, 116, 139, 200, 171, 138, 2, 200, 141, 38, 200, 121, 104, 193, 200, 200, 200, 17, 200, 135, 200, 200, 200, 200, 197, 181, 90, 18, 126, 200, 148, 200, 172, 200, 76, 158, 200, 104, 200, 109, 200, 200, 187, 183, 127, 150, 197, 200, 200, 69, 200, 96, 200, 200, 191, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 197, 200, 200, 200, 152, 200, 200, 200, 123, 200, 188, 200, 200, 200, 73, 200, 137, 155, 200, 200, 200, 200, 200, 10, 200, 170, 200, 143, 200, 200, 143, 200, 200, 200, 165], "policy_agent_policy_reward": [28.677230520185365, 29.527071065344778, 23.077360154231254, 55.370844644641515, 72.79513073901224, 49.06282248593992, 1.3542240656378075, 10.051220022242084, 60.86606220539251, 35.45888092065175, 51.920013967254064, 37.06589925751412, 35.01363524287594, 17.44436537492262, 15.642148511323605, 84.9011177046445, 37.64723765866464, 3.534288744415257, -10.656097638536991, 48.160966111333785, 32.47084954119592, 28.102978448190093, 14.67627266010129, 33.9322714241256, 55.49641658949826, 52.27859512304638, 24.957920988200456, 10.495812772084614, 48.02456314218581, 11.280680338009208, 39.45567434333924, -8.136844511729997, 59.73932360126838, 36.9339611465694, 55.122291000704436, 75.22892450049058, 34.06655888654255, 45.97673360716601, 42.63314427800186, 54.916873680118385, 51.55740671686791, 36.94931746841364, 46.61142674314751, 42.76661865464456, 68.27499025801636, 36.56792936957585, 50.97536204181443, 32.45201307402166, 43.04304958808131, 21.640948739943166, 41.29199862348664, 39.33266788232669, 3.405613802768084, 63.661471119740995, 17.453360769504194, 23.95073812207994, 48.74910214014881, 45.044038098475355, 43.793278814744745, 15.658948957776794, 55.53587108128879, 2.6745076365506386, 19.42106553693278, 29.50529088442059, 3.590331049686627, 70.48499864134544, 12.519698307354385, 26.25019528425846, -1.9604949260247118, 4.206806080723251, -19.938337097141872, 32.08065021880968, 13.363104936570226, 39.057275182307514, 37.26178310614125, 59.57141317688818, 58.614391211414954, 17.479616464813212, 29.24395047155308, 57.61627250192708, 24.614312930302308, 65.37409494617289, 41.40417092544394, 41.82182563850801, 18.201885977288637, -9.437583736099128, 54.4169923653084, 75.75684107146897, 2.896650784118709, 23.168920161320898, 73.21440320029956, 11.224910715304695, 24.963119540447423, 37.40906932960304, 49.196765904864705, 62.0802805967133, 26.378573360210538, 23.170152696965484, -14.994991388390623, 46.123969437629405], "policy_adversary_policy_reward": [9.677847294706437, 18.999383225478926, 26.14825088916028, 3.3788201761844956, 3.183117396534861, 19.89424275769639, 41.9564639209657, 13.414380723675768, 36.39949177778384, 36.39563896122833, 34.41998133299199, 14.642841152947927, 1.2575597311153608, 0.09666433452244638, 5.790257173106187, 4.260962849135892, 29.576591055882755, 31.289471149509765, 18.144561170705853, 17.314319749945906, 18.553978863286382, 33.36603510396767, 9.095529787824672, 27.970369469689444, 4.721279513952345, 30.292355728923585, 3.1668403000855445, 14.277525074837072, 21.096212084691725, -5.454063573368121, 50.86493421259023, 34.03618349205425, 28.931078353866322, 8.716159304798321, 5.628596977246457, -2.0943082328311995, -6.020095582209919, -4.636002056327083, 24.987947602631532, 23.173018508702242, 15.466976190325003, 17.003873350870922, 9.582605696228832, 18.520372751961265, 7.433371167081679, 7.242901493019611, 25.947540071847715, 7.984731352277901, 33.71417848723803, 21.782238102260212, 19.315706336576643, 32.96288878646972, 16.465784832779423, 8.492136155421031, -1.4736680412220977, 11.969480813306712, 21.24596522561589, 26.778597916569915, 17.889420401808415, -6.608740063799212, 27.962285572097443, 11.493388771241783, -7.402495138336132, -0.7343493733938686, 42.81271138067303, 16.92661222059537, 8.05870117277438, 28.875259973795018, 30.099092968979598, 25.023198031724835, 46.435448015020626, 28.793476485469974, 13.410132192420008, 20.65642669412253, 22.918009693221187, 23.05872391394482, 8.830131439876467, 33.803012838125426, 27.731290839421337, 27.185582840697045, 23.4900910528063, 28.067315664061603, 17.450345593382433, 19.498971875031216, 30.54262141909568, 16.068805324051844, 22.475890728360582, 20.29072792628399, 38.50396691030987, 29.77102334770649, 24.572209791726458, 11.995719577849393, 16.77497613797237, 34.20038590384205, 19.015333975145758, 13.436679098875906, 17.360692119208913, 25.682357468872397, 11.54128637206129, 10.099662367881882, 27.08396292914083, 14.208035694345796, 16.404009732038528, 22.928658150288165, 9.51298162630814, -6.107367823540056, 9.659593959090579, 54.00187716065041, 11.455305237556749, 5.998055531947444, 6.469867619187348, 17.480870502892586, 24.64950438562773, 24.099597754521138, 21.016732238835118, 24.027305859640233, 24.562714760191767, 19.23056405455298, 4.541270282118738, 11.117678675658059, 24.698536852727585, 30.83733422856121, 7.273801846962118, -4.599294210411479, 6.0867297451616835, 13.334335791771096, 27.71298540181024, 1.7923054826103648, -2.043347270242524, 5.633678319929153, 21.368193094506907, 49.11680554683854, 15.614431868438334, -3.094733561083949, 23.484358327595217, 2.765836956663234, -1.078078992859755, -0.8824159331649568, -6.377892348219277, 10.584698428942522, -3.410036031389737, -16.528301065752117, 10.428946642614244, 21.651703576195423, 16.32226898880045, -2.959164052230224, 7.547268166047617, 31.51000701625989, 24.13101862205823, 13.130764484083013, 42.83578607683017, 16.735627100057997, 26.142808115300355, 32.4715830961146, 10.24253720058497, 7.237079264228242, -2.77923833966976, 32.02318881122284, 36.83417691461357, 20.782095587313503, 8.197396659143944, 16.416916271158367, 23.96087174464101, 41.4132232015319, 21.03975427006513, 20.3644166553788, 29.758618451545757, 12.063207186962256, 12.290194716718315, 5.911691260570321, -22.083756444627895, 12.646172708528745, 36.07857123394781, 18.33842113136064, 40.981014208328155, 34.77582686314091, -1.278595665962058, 4.175246450080767, 11.497221876162275, 11.671698285158627, 47.36556716827516, 25.848836032024426, 4.460912152683285, 6.76399856262141, 23.6896839226873, 1.2734356177601267, 20.247473783214527, 17.16159554638851, 14.739154125796233, 34.45761177906848, 13.892739718653544, 48.18754087805977, 14.758699058271494, 11.619874301939035, 0.9302974813819915, 22.23985521558349, 7.75285233589576, -22.747843724286383, 23.239166375893518, 22.884803061735877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.395143929848358, "mean_inference_ms": 0.9853401520347528, "mean_action_processing_ms": 0.16912564366972987, "mean_env_wait_ms": 0.05907300339626552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035582780838012695, "StateBufferConnector_ms": 0.002556324005126953, "ViewRequirementAgentConnector_ms": 0.06555521488189697}, "num_episodes": 23, "episode_return_max": 169.80223540928893, "episode_return_min": -39.87667419428374, "episode_return_mean": 68.62620917019358}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 492.4539311859014, "num_env_steps_trained_throughput_per_sec": 492.4539311859014, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 8285.362, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8285.328, "sample_time_ms": 746.435, "learn_time_ms": 7525.24, "learn_throughput": 531.545, "synch_weights_time_ms": 12.992}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "training_iteration": 27, "trial_id": "eaa30_00000", "date": "2024-08-09_17-43-44", "timestamp": 1723239824, "time_this_iter_s": 8.127384901046753, "time_total_s": 217.36425256729126, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc1d700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 217.36425256729126, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 22.241666666666664, "ram_util_percent": 80.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.225772670778648, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.149508802474491, "policy_loss": 0.011563004673798642, "vf_loss": 7.106110842518075, "vf_explained_var": -0.026186855665590397, "kl": 0.020961292780856924, "entropy": 1.4527281662774465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.905286543816328, "cur_kl_coeff": 25.949267578124992, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.463156855603058, "policy_loss": 0.0033745758829657763, "vf_loss": 8.082395639518897, "vf_explained_var": 0.27768079011390606, "kl": 0.014543248459570652, "entropy": 1.5223144353677829, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 151.51368214293805, "episode_reward_min": -112.33311151419056, "episode_reward_mean": 56.06377242627368, "episode_len_mean": 176.13, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 17613, "policy_reward_min": {"agent_policy": -56.166555757095296, "adversary_policy": -34.3509477017609}, "policy_reward_max": {"agent_policy": 75.75684107146897, "adversary_policy": 54.00187716065041}, "policy_reward_mean": {"agent_policy": 28.031886213136843, "adversary_policy": 14.015943106568425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.205956896380215, 29.3525453202026, 67.86454284825122, 110.99283317899652, 104.5571902460927, 49.91584197640089, 20.991625544169224, 96.04912628437174, 22.56136067601843, 78.9113486866784, -16.27368902346005, 119.47864720253683, 73.86792229313876, 110.24458200140893, 150.45784900098107, 68.13311777308512, 91.95346721433205, 85.2662885560038, 109.83374736023681, 103.1148134337358, 73.8986349368273, 93.22285348629502, 85.53323730928913, 136.54998051603275, 73.13585873915173, 101.9507240836288, 64.90402614804336, 86.08609917616262, 43.281897479886325, 82.5839972469733, 78.66533576465342, 6.811227605536139, 127.32294223948196, 34.90672153900842, 47.901476244159895, 97.49820428029781, 90.08807619695068, 87.58655762948946, 31.31789791555358, 111.07174216257742, 5.349015273101277, 38.84213107386557, 59.01058176884118, 7.180662099373226, 140.9699972826908, 25.03939661470877, 52.500390568516934, -3.920989852049427, 8.413612161446482, -39.87667419428374, 64.16130043761935, 26.726209873140434, 78.11455036461507, 74.52356621228247, 119.14282635377626, 117.22878242282992, 34.95923292962641, 58.487900943106155, 115.2325450038543, 49.22862586060463, 130.7481898923458, 82.80834185088784, 83.64365127701595, 36.403771954577294, -18.875167472198143, 108.83398473061683, 151.51368214293805, 5.793301568237417, 46.337840322641796, 146.4288064005993, 22.449821430609383, 49.926239080894845, 74.81813865920608, 98.39353180972944, 124.1605611934267, 52.75714672042105, 46.340305393930954, -29.98998277678126, 92.24793887525867, 52.022188134368776, -44.65597877311697, 66.26481933651374, -39.44490716546851, 50.88494567912707, 52.16390349169296, -17.028895849976216, 83.68905942838964, 34.63800960475764, -112.33311151419056, 32.72689108427646, -87.7701259499561, -9.633010369622077, -39.06988118316765, -93.06178618933943, 128.91040600219188, 29.263674434420174, 1.8707278842731583, -69.74065993080296, 96.53657922963093, 66.294020821783], "episode_lengths": [200, 200, 200, 197, 181, 90, 18, 126, 200, 148, 200, 172, 200, 76, 158, 200, 104, 200, 109, 200, 200, 187, 183, 127, 150, 197, 200, 200, 69, 200, 96, 200, 200, 191, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 197, 200, 200, 200, 152, 200, 200, 200, 123, 200, 188, 200, 200, 200, 73, 200, 137, 155, 200, 200, 200, 200, 200, 10, 200, 170, 200, 143, 200, 200, 143, 200, 200, 200, 165, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 148, 21, 200, 200, 200, 200], "policy_agent_policy_reward": [28.102978448190093, 14.67627266010129, 33.9322714241256, 55.49641658949826, 52.27859512304638, 24.957920988200456, 10.495812772084614, 48.02456314218581, 11.280680338009208, 39.45567434333924, -8.136844511729997, 59.73932360126838, 36.9339611465694, 55.122291000704436, 75.22892450049058, 34.06655888654255, 45.97673360716601, 42.63314427800186, 54.916873680118385, 51.55740671686791, 36.94931746841364, 46.61142674314751, 42.76661865464456, 68.27499025801636, 36.56792936957585, 50.97536204181443, 32.45201307402166, 43.04304958808131, 21.640948739943166, 41.29199862348664, 39.33266788232669, 3.405613802768084, 63.661471119740995, 17.453360769504194, 23.95073812207994, 48.74910214014881, 45.044038098475355, 43.793278814744745, 15.658948957776794, 55.53587108128879, 2.6745076365506386, 19.42106553693278, 29.50529088442059, 3.590331049686627, 70.48499864134544, 12.519698307354385, 26.25019528425846, -1.9604949260247118, 4.206806080723251, -19.938337097141872, 32.08065021880968, 13.363104936570226, 39.057275182307514, 37.26178310614125, 59.57141317688818, 58.614391211414954, 17.479616464813212, 29.24395047155308, 57.61627250192708, 24.614312930302308, 65.37409494617289, 41.40417092544394, 41.82182563850801, 18.201885977288637, -9.437583736099128, 54.4169923653084, 75.75684107146897, 2.896650784118709, 23.168920161320898, 73.21440320029956, 11.224910715304695, 24.963119540447423, 37.40906932960304, 49.196765904864705, 62.0802805967133, 26.378573360210538, 23.170152696965484, -14.994991388390623, 46.123969437629405, 26.01109406718436, -22.327989386558457, 33.132409668256884, -19.722453582734254, 25.442472839563525, 26.081951745846485, -8.514447924988104, 41.84452971419487, 17.31900480237883, -56.166555757095296, 16.363445542138223, -43.885062974978055, -4.816505184811067, -19.534940591583812, -46.530893094669686, 64.45520300109595, 14.631837217210094, 0.9353639421365685, -34.87032996540148, 48.268289614815494, 33.147010410891525], "policy_adversary_policy_reward": [9.582605696228832, 18.520372751961265, 7.433371167081679, 7.242901493019611, 25.947540071847715, 7.984731352277901, 33.71417848723803, 21.782238102260212, 19.315706336576643, 32.96288878646972, 16.465784832779423, 8.492136155421031, -1.4736680412220977, 11.969480813306712, 21.24596522561589, 26.778597916569915, 17.889420401808415, -6.608740063799212, 27.962285572097443, 11.493388771241783, -7.402495138336132, -0.7343493733938686, 42.81271138067303, 16.92661222059537, 8.05870117277438, 28.875259973795018, 30.099092968979598, 25.023198031724835, 46.435448015020626, 28.793476485469974, 13.410132192420008, 20.65642669412253, 22.918009693221187, 23.05872391394482, 8.830131439876467, 33.803012838125426, 27.731290839421337, 27.185582840697045, 23.4900910528063, 28.067315664061603, 17.450345593382433, 19.498971875031216, 30.54262141909568, 16.068805324051844, 22.475890728360582, 20.29072792628399, 38.50396691030987, 29.77102334770649, 24.572209791726458, 11.995719577849393, 16.77497613797237, 34.20038590384205, 19.015333975145758, 13.436679098875906, 17.360692119208913, 25.682357468872397, 11.54128637206129, 10.099662367881882, 27.08396292914083, 14.208035694345796, 16.404009732038528, 22.928658150288165, 9.51298162630814, -6.107367823540056, 9.659593959090579, 54.00187716065041, 11.455305237556749, 5.998055531947444, 6.469867619187348, 17.480870502892586, 24.64950438562773, 24.099597754521138, 21.016732238835118, 24.027305859640233, 24.562714760191767, 19.23056405455298, 4.541270282118738, 11.117678675658059, 24.698536852727585, 30.83733422856121, 7.273801846962118, -4.599294210411479, 6.0867297451616835, 13.334335791771096, 27.71298540181024, 1.7923054826103648, -2.043347270242524, 5.633678319929153, 21.368193094506907, 49.11680554683854, 15.614431868438334, -3.094733561083949, 23.484358327595217, 2.765836956663234, -1.078078992859755, -0.8824159331649568, -6.377892348219277, 10.584698428942522, -3.410036031389737, -16.528301065752117, 10.428946642614244, 21.651703576195423, 16.32226898880045, -2.959164052230224, 7.547268166047617, 31.51000701625989, 24.13101862205823, 13.130764484083013, 42.83578607683017, 16.735627100057997, 26.142808115300355, 32.4715830961146, 10.24253720058497, 7.237079264228242, -2.77923833966976, 32.02318881122284, 36.83417691461357, 20.782095587313503, 8.197396659143944, 16.416916271158367, 23.96087174464101, 41.4132232015319, 21.03975427006513, 20.3644166553788, 29.758618451545757, 12.063207186962256, 12.290194716718315, 5.911691260570321, -22.083756444627895, 12.646172708528745, 36.07857123394781, 18.33842113136064, 40.981014208328155, 34.77582686314091, -1.278595665962058, 4.175246450080767, 11.497221876162275, 11.671698285158627, 47.36556716827516, 25.848836032024426, 4.460912152683285, 6.76399856262141, 23.6896839226873, 1.2734356177601267, 20.247473783214527, 17.16159554638851, 14.739154125796233, 34.45761177906848, 13.892739718653544, 48.18754087805977, 14.758699058271494, 11.619874301939035, 0.9302974813819915, 22.23985521558349, 7.75285233589576, -22.747843724286383, 23.239166375893518, 22.884803061735877, 6.063124850309487, 19.94796921687488, -19.482285474909247, -2.8457039116492098, -2.392234080465286, 35.52464374872217, -10.550247595896323, -9.17220598683793, 5.887562073696184, 19.55491076586734, 17.9208689471733, 8.161082798673188, 12.713836287870144, -21.22828421285825, 26.050973176980932, 15.793556537213913, 17.524455072343457, -0.20545026996462568, -26.50190065495948, -29.664655102135775, 2.1262204452699898, 14.237225096868222, -26.451008536924576, -17.434054438053472, 4.728667988627048, -9.545173173438119, -15.285541322697302, -4.24939926888651, -12.179945392908769, -34.3509477017609, 38.72889432875075, 25.726308672345212, 8.343384016444164, 6.288453200765928, -1.231244149193639, 2.1666080913302075, -21.451359400483675, -13.418970564917807, 35.829022555778955, 12.439267059036569, 21.214378521680544, 11.932631889210985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3952280714797381, "mean_inference_ms": 0.9850088315270453, "mean_action_processing_ms": 0.16924752683553784, "mean_env_wait_ms": 0.059031186057899844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034743547439575195, "StateBufferConnector_ms": 0.002498149871826172, "ViewRequirementAgentConnector_ms": 0.06505024433135986}, "num_episodes": 21, "episode_return_max": 151.51368214293805, "episode_return_min": -112.33311151419056, "episode_return_mean": 56.06377242627368}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 483.55245333780346, "num_env_steps_trained_throughput_per_sec": 483.55245333780346, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 8281.995, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8281.961, "sample_time_ms": 748.383, "learn_time_ms": 7520.055, "learn_throughput": 531.911, "synch_weights_time_ms": 12.862}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 28, "trial_id": "eaa30_00000", "date": "2024-08-09_17-43-53", "timestamp": 1723239833, "time_this_iter_s": 8.277828693389893, "time_total_s": 225.64208126068115, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc1d940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 225.64208126068115, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 26.375, "ram_util_percent": 80.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.847361002712653, "cur_kl_coeff": 2.278124999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.869360045528916, "policy_loss": 0.03137852076229161, "vf_loss": 6.764684035286071, "vf_explained_var": 0.046901371176280675, "kl": 0.03217448111495407, "entropy": 1.450416439424747, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.822624283159772, "cur_kl_coeff": 25.949267578124992, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.69976007193327, "policy_loss": 0.012374410720076412, "vf_loss": 8.182731127242247, "vf_explained_var": 0.21719281108429034, "kl": 0.01944773607465322, "entropy": 1.5244236055761575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "env_runners": {"episode_reward_max": 151.51368214293805, "episode_reward_min": -112.33311151419056, "episode_reward_mean": 40.808269647611304, "episode_len_mean": 175.75, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 17575, "policy_reward_min": {"agent_policy": -56.166555757095296, "adversary_policy": -34.3509477017609}, "policy_reward_max": {"agent_policy": 75.75684107146897, "adversary_policy": 54.00187716065041}, "policy_reward_mean": {"agent_policy": 20.404134823805656, "adversary_policy": 10.202067411902826}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.13585873915173, 101.9507240836288, 64.90402614804336, 86.08609917616262, 43.281897479886325, 82.5839972469733, 78.66533576465342, 6.811227605536139, 127.32294223948196, 34.90672153900842, 47.901476244159895, 97.49820428029781, 90.08807619695068, 87.58655762948946, 31.31789791555358, 111.07174216257742, 5.349015273101277, 38.84213107386557, 59.01058176884118, 7.180662099373226, 140.9699972826908, 25.03939661470877, 52.500390568516934, -3.920989852049427, 8.413612161446482, -39.87667419428374, 64.16130043761935, 26.726209873140434, 78.11455036461507, 74.52356621228247, 119.14282635377626, 117.22878242282992, 34.95923292962641, 58.487900943106155, 115.2325450038543, 49.22862586060463, 130.7481898923458, 82.80834185088784, 83.64365127701595, 36.403771954577294, -18.875167472198143, 108.83398473061683, 151.51368214293805, 5.793301568237417, 46.337840322641796, 146.4288064005993, 22.449821430609383, 49.926239080894845, 74.81813865920608, 98.39353180972944, 124.1605611934267, 52.75714672042105, 46.340305393930954, -29.98998277678126, 92.24793887525867, 52.022188134368776, -44.65597877311697, 66.26481933651374, -39.44490716546851, 50.88494567912707, 52.16390349169296, -17.028895849976216, 83.68905942838964, 34.63800960475764, -112.33311151419056, 32.72689108427646, -87.7701259499561, -9.633010369622077, -39.06988118316765, -93.06178618933943, 128.91040600219188, 29.263674434420174, 1.8707278842731583, -69.74065993080296, 96.53657922963093, 66.294020821783, -15.059914410731082, 35.94670031335369, 3.970294738559531, -23.975523005046426, 65.7201762789682, 43.34403833097467, -18.569771488734958, 84.42052894834175, -34.64501647715532, 85.90821593942964, -7.402195896286386, -33.99999688859319, 37.92505788832102, -4.13724222862168, -8.340766892822174, 34.8880063336169, 1.7726558727054917, 38.9501670440724, 18.4777189695312, 81.84350965180462, -68.01339984970146, 28.454183874512537, 72.68709082540535, -23.030972020137426], "episode_lengths": [150, 197, 200, 200, 69, 200, 96, 200, 200, 191, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 197, 200, 200, 200, 152, 200, 200, 200, 123, 200, 188, 200, 200, 200, 73, 200, 137, 155, 200, 200, 200, 200, 200, 10, 200, 170, 200, 143, 200, 200, 143, 200, 200, 200, 165, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 148, 21, 200, 200, 200, 200, 200, 200, 200, 200, 200, 149, 200, 172, 200, 37, 200, 200, 200, 200, 200, 12, 18, 39, 21, 190, 200, 200, 200, 200], "policy_agent_policy_reward": [36.56792936957585, 50.97536204181443, 32.45201307402166, 43.04304958808131, 21.640948739943166, 41.29199862348664, 39.33266788232669, 3.405613802768084, 63.661471119740995, 17.453360769504194, 23.95073812207994, 48.74910214014881, 45.044038098475355, 43.793278814744745, 15.658948957776794, 55.53587108128879, 2.6745076365506386, 19.42106553693278, 29.50529088442059, 3.590331049686627, 70.48499864134544, 12.519698307354385, 26.25019528425846, -1.9604949260247118, 4.206806080723251, -19.938337097141872, 32.08065021880968, 13.363104936570226, 39.057275182307514, 37.26178310614125, 59.57141317688818, 58.614391211414954, 17.479616464813212, 29.24395047155308, 57.61627250192708, 24.614312930302308, 65.37409494617289, 41.40417092544394, 41.82182563850801, 18.201885977288637, -9.437583736099128, 54.4169923653084, 75.75684107146897, 2.896650784118709, 23.168920161320898, 73.21440320029956, 11.224910715304695, 24.963119540447423, 37.40906932960304, 49.196765904864705, 62.0802805967133, 26.378573360210538, 23.170152696965484, -14.994991388390623, 46.123969437629405, 26.01109406718436, -22.327989386558457, 33.132409668256884, -19.722453582734254, 25.442472839563525, 26.081951745846485, -8.514447924988104, 41.84452971419487, 17.31900480237883, -56.166555757095296, 16.363445542138223, -43.885062974978055, -4.816505184811067, -19.534940591583812, -46.530893094669686, 64.45520300109595, 14.631837217210094, 0.9353639421365685, -34.87032996540148, 48.268289614815494, 33.147010410891525, -7.529957205365541, 17.97335015667683, 1.985147369279769, -11.987761502523252, 32.86008813948412, 21.672019165487335, -9.284885744367479, 42.210264474170856, -17.3225082385777, 42.95410796971483, -3.701097948143186, -16.999998444296583, 18.96252894416051, -2.068621114310819, -4.170383446411087, 17.444003166808447, 0.8863279363527459, 19.475083522036197, 9.238859484765596, 40.92175482590232, -34.00669992485071, 14.227091937256265, 36.34354541270264, -11.515486010068734], "policy_adversary_policy_reward": [24.572209791726458, 11.995719577849393, 16.77497613797237, 34.20038590384205, 19.015333975145758, 13.436679098875906, 17.360692119208913, 25.682357468872397, 11.54128637206129, 10.099662367881882, 27.08396292914083, 14.208035694345796, 16.404009732038528, 22.928658150288165, 9.51298162630814, -6.107367823540056, 9.659593959090579, 54.00187716065041, 11.455305237556749, 5.998055531947444, 6.469867619187348, 17.480870502892586, 24.64950438562773, 24.099597754521138, 21.016732238835118, 24.027305859640233, 24.562714760191767, 19.23056405455298, 4.541270282118738, 11.117678675658059, 24.698536852727585, 30.83733422856121, 7.273801846962118, -4.599294210411479, 6.0867297451616835, 13.334335791771096, 27.71298540181024, 1.7923054826103648, -2.043347270242524, 5.633678319929153, 21.368193094506907, 49.11680554683854, 15.614431868438334, -3.094733561083949, 23.484358327595217, 2.765836956663234, -1.078078992859755, -0.8824159331649568, -6.377892348219277, 10.584698428942522, -3.410036031389737, -16.528301065752117, 10.428946642614244, 21.651703576195423, 16.32226898880045, -2.959164052230224, 7.547268166047617, 31.51000701625989, 24.13101862205823, 13.130764484083013, 42.83578607683017, 16.735627100057997, 26.142808115300355, 32.4715830961146, 10.24253720058497, 7.237079264228242, -2.77923833966976, 32.02318881122284, 36.83417691461357, 20.782095587313503, 8.197396659143944, 16.416916271158367, 23.96087174464101, 41.4132232015319, 21.03975427006513, 20.3644166553788, 29.758618451545757, 12.063207186962256, 12.290194716718315, 5.911691260570321, -22.083756444627895, 12.646172708528745, 36.07857123394781, 18.33842113136064, 40.981014208328155, 34.77582686314091, -1.278595665962058, 4.175246450080767, 11.497221876162275, 11.671698285158627, 47.36556716827516, 25.848836032024426, 4.460912152683285, 6.76399856262141, 23.6896839226873, 1.2734356177601267, 20.247473783214527, 17.16159554638851, 14.739154125796233, 34.45761177906848, 13.892739718653544, 48.18754087805977, 14.758699058271494, 11.619874301939035, 0.9302974813819915, 22.23985521558349, 7.75285233589576, -22.747843724286383, 23.239166375893518, 22.884803061735877, 6.063124850309487, 19.94796921687488, -19.482285474909247, -2.8457039116492098, -2.392234080465286, 35.52464374872217, -10.550247595896323, -9.17220598683793, 5.887562073696184, 19.55491076586734, 17.9208689471733, 8.161082798673188, 12.713836287870144, -21.22828421285825, 26.050973176980932, 15.793556537213913, 17.524455072343457, -0.20545026996462568, -26.50190065495948, -29.664655102135775, 2.1262204452699898, 14.237225096868222, -26.451008536924576, -17.434054438053472, 4.728667988627048, -9.545173173438119, -15.285541322697302, -4.24939926888651, -12.179945392908769, -34.3509477017609, 38.72889432875075, 25.726308672345212, 8.343384016444164, 6.288453200765928, -1.231244149193639, 2.1666080913302075, -21.451359400483675, -13.418970564917807, 35.829022555778955, 12.439267059036569, 21.214378521680544, 11.932631889210985, -2.0030333245060277, -5.526923880859513, 3.0531920521795826, 14.920158104497244, -13.500653564122164, 15.485800933401933, -3.894323997655386, -8.093437504867858, 29.162670637346057, 3.69741750213808, -1.387666510051747, 23.059685675539072, -11.741425811256264, 2.4565400668887847, 19.05671055195495, 23.153553922215902, -1.9782038113178153, -15.344304427259878, 14.64451173079879, 28.309596238916036, -7.726906973339773, 4.025809025196571, -8.165996538377005, -8.834001905919582, 15.564832749806094, 3.3976961943544133, 4.042799275623744, -6.11142038993456, -7.839797719501927, 3.669414273090844, 9.878570213197582, 7.565432953610863, -10.580058431729675, 11.466386368082421, 10.464059659057353, 9.011023862978846, -6.521904922470103, 15.760764407235701, 13.009424320896589, 27.91233050500571, -11.770698347578517, -22.23600157727221, -6.09103801856795, 20.318129955824208, 15.794059167277588, 20.549486245425044, -3.4756085679237128, -8.039877442145023]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3952125345104365, "mean_inference_ms": 0.9837573543189047, "mean_action_processing_ms": 0.16911014226178017, "mean_env_wait_ms": 0.05886841811551061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003385186195373535, "StateBufferConnector_ms": 0.0024313926696777344, "ViewRequirementAgentConnector_ms": 0.06303417682647705}, "num_episodes": 24, "episode_return_max": 151.51368214293805, "episode_return_min": -112.33311151419056, "episode_return_mean": 40.808269647611304}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 489.1569753245248, "num_env_steps_trained_throughput_per_sec": 489.1569753245248, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 8284.082, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8284.047, "sample_time_ms": 745.967, "learn_time_ms": 7524.489, "learn_throughput": 531.598, "synch_weights_time_ms": 12.937}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "training_iteration": 29, "trial_id": "eaa30_00000", "date": "2024-08-09_17-44-01", "timestamp": 1723239841, "time_this_iter_s": 8.183007001876831, "time_total_s": 233.82508826255798, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc1db80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 233.82508826255798, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 22.666666666666668, "ram_util_percent": 80.37499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.465597181030052, "cur_kl_coeff": 3.417187499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.885464919307244, "policy_loss": 0.00804151630930839, "vf_loss": 6.798847585758835, "vf_explained_var": -0.007230495271228609, "kl": 0.022994296970190824, "entropy": 1.453189206312573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.7855819970369335, "cur_kl_coeff": 25.949267578124992, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.453418121735256, "policy_loss": 0.0022251438242771354, "vf_loss": 7.6467106461524965, "vf_explained_var": 0.3836153527721763, "kl": 0.03100212011728824, "entropy": 1.5147279671082894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 151.51368214293805, "episode_reward_min": -112.33311151419056, "episode_reward_mean": 23.915424421724055, "episode_len_mean": 174.88, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 17488, "policy_reward_min": {"agent_policy": -56.166555757095296, "adversary_policy": -34.3509477017609}, "policy_reward_max": {"agent_policy": 75.75684107146897, "adversary_policy": 48.18754087805977}, "policy_reward_mean": {"agent_policy": 11.957712210862027, "adversary_policy": 5.978856105431016}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.03939661470877, 52.500390568516934, -3.920989852049427, 8.413612161446482, -39.87667419428374, 64.16130043761935, 26.726209873140434, 78.11455036461507, 74.52356621228247, 119.14282635377626, 117.22878242282992, 34.95923292962641, 58.487900943106155, 115.2325450038543, 49.22862586060463, 130.7481898923458, 82.80834185088784, 83.64365127701595, 36.403771954577294, -18.875167472198143, 108.83398473061683, 151.51368214293805, 5.793301568237417, 46.337840322641796, 146.4288064005993, 22.449821430609383, 49.926239080894845, 74.81813865920608, 98.39353180972944, 124.1605611934267, 52.75714672042105, 46.340305393930954, -29.98998277678126, 92.24793887525867, 52.022188134368776, -44.65597877311697, 66.26481933651374, -39.44490716546851, 50.88494567912707, 52.16390349169296, -17.028895849976216, 83.68905942838964, 34.63800960475764, -112.33311151419056, 32.72689108427646, -87.7701259499561, -9.633010369622077, -39.06988118316765, -93.06178618933943, 128.91040600219188, 29.263674434420174, 1.8707278842731583, -69.74065993080296, 96.53657922963093, 66.294020821783, -15.059914410731082, 35.94670031335369, 3.970294738559531, -23.975523005046426, 65.7201762789682, 43.34403833097467, -18.569771488734958, 84.42052894834175, -34.64501647715532, 85.90821593942964, -7.402195896286386, -33.99999688859319, 37.92505788832102, -4.13724222862168, -8.340766892822174, 34.8880063336169, 1.7726558727054917, 38.9501670440724, 18.4777189695312, 81.84350965180462, -68.01339984970146, 28.454183874512537, 72.68709082540535, -23.030972020137426, -40.28600039747131, -36.22007506686927, 37.14344078436864, -102.46432905271519, -19.563445396147984, -33.04249079770426, 51.519730359524736, 40.96893271532639, -58.711382798692156, 7.618283262230195, -30.893523969308077, -75.16276720509717, -37.889221128943134, -85.46700543653373, 1.544217152033248, -18.612828169091788, 43.656474329826345, 58.089655615165896, -23.582414394957453, 41.20174273779011, 7.333656217967643], "episode_lengths": [200, 200, 200, 152, 200, 200, 200, 123, 200, 188, 200, 200, 200, 73, 200, 137, 155, 200, 200, 200, 200, 200, 10, 200, 170, 200, 143, 200, 200, 143, 200, 200, 200, 165, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 148, 21, 200, 200, 200, 200, 200, 200, 200, 200, 200, 149, 200, 172, 200, 37, 200, 200, 200, 200, 200, 12, 18, 39, 21, 190, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3], "policy_agent_policy_reward": [12.519698307354385, 26.25019528425846, -1.9604949260247118, 4.206806080723251, -19.938337097141872, 32.08065021880968, 13.363104936570226, 39.057275182307514, 37.26178310614125, 59.57141317688818, 58.614391211414954, 17.479616464813212, 29.24395047155308, 57.61627250192708, 24.614312930302308, 65.37409494617289, 41.40417092544394, 41.82182563850801, 18.201885977288637, -9.437583736099128, 54.4169923653084, 75.75684107146897, 2.896650784118709, 23.168920161320898, 73.21440320029956, 11.224910715304695, 24.963119540447423, 37.40906932960304, 49.196765904864705, 62.0802805967133, 26.378573360210538, 23.170152696965484, -14.994991388390623, 46.123969437629405, 26.01109406718436, -22.327989386558457, 33.132409668256884, -19.722453582734254, 25.442472839563525, 26.081951745846485, -8.514447924988104, 41.84452971419487, 17.31900480237883, -56.166555757095296, 16.363445542138223, -43.885062974978055, -4.816505184811067, -19.534940591583812, -46.530893094669686, 64.45520300109595, 14.631837217210094, 0.9353639421365685, -34.87032996540148, 48.268289614815494, 33.147010410891525, -7.529957205365541, 17.97335015667683, 1.985147369279769, -11.987761502523252, 32.86008813948412, 21.672019165487335, -9.284885744367479, 42.210264474170856, -17.3225082385777, 42.95410796971483, -3.701097948143186, -16.999998444296583, 18.96252894416051, -2.068621114310819, -4.170383446411087, 17.444003166808447, 0.8863279363527459, 19.475083522036197, 9.238859484765596, 40.92175482590232, -34.00669992485071, 14.227091937256265, 36.34354541270264, -11.515486010068734, -20.143000198735656, -18.11003753343462, 18.57172039218433, -51.232164526357565, -9.781722698073992, -16.521245398852116, 25.75986517976236, 20.48446635766324, -29.35569139934605, 3.809141631115098, -15.446761984654003, -37.58138360254851, -18.944610564471567, -42.7335027182669, 0.772108576016624, -9.30641408454591, 21.828237164913173, 29.04482780758295, -11.791207197478727, 20.600871368895024, 3.6668281089838217], "policy_adversary_policy_reward": [15.614431868438334, -3.094733561083949, 23.484358327595217, 2.765836956663234, -1.078078992859755, -0.8824159331649568, -6.377892348219277, 10.584698428942522, -3.410036031389737, -16.528301065752117, 10.428946642614244, 21.651703576195423, 16.32226898880045, -2.959164052230224, 7.547268166047617, 31.51000701625989, 24.13101862205823, 13.130764484083013, 42.83578607683017, 16.735627100057997, 26.142808115300355, 32.4715830961146, 10.24253720058497, 7.237079264228242, -2.77923833966976, 32.02318881122284, 36.83417691461357, 20.782095587313503, 8.197396659143944, 16.416916271158367, 23.96087174464101, 41.4132232015319, 21.03975427006513, 20.3644166553788, 29.758618451545757, 12.063207186962256, 12.290194716718315, 5.911691260570321, -22.083756444627895, 12.646172708528745, 36.07857123394781, 18.33842113136064, 40.981014208328155, 34.77582686314091, -1.278595665962058, 4.175246450080767, 11.497221876162275, 11.671698285158627, 47.36556716827516, 25.848836032024426, 4.460912152683285, 6.76399856262141, 23.6896839226873, 1.2734356177601267, 20.247473783214527, 17.16159554638851, 14.739154125796233, 34.45761177906848, 13.892739718653544, 48.18754087805977, 14.758699058271494, 11.619874301939035, 0.9302974813819915, 22.23985521558349, 7.75285233589576, -22.747843724286383, 23.239166375893518, 22.884803061735877, 6.063124850309487, 19.94796921687488, -19.482285474909247, -2.8457039116492098, -2.392234080465286, 35.52464374872217, -10.550247595896323, -9.17220598683793, 5.887562073696184, 19.55491076586734, 17.9208689471733, 8.161082798673188, 12.713836287870144, -21.22828421285825, 26.050973176980932, 15.793556537213913, 17.524455072343457, -0.20545026996462568, -26.50190065495948, -29.664655102135775, 2.1262204452699898, 14.237225096868222, -26.451008536924576, -17.434054438053472, 4.728667988627048, -9.545173173438119, -15.285541322697302, -4.24939926888651, -12.179945392908769, -34.3509477017609, 38.72889432875075, 25.726308672345212, 8.343384016444164, 6.288453200765928, -1.231244149193639, 2.1666080913302075, -21.451359400483675, -13.418970564917807, 35.829022555778955, 12.439267059036569, 21.214378521680544, 11.932631889210985, -2.0030333245060277, -5.526923880859513, 3.0531920521795826, 14.920158104497244, -13.500653564122164, 15.485800933401933, -3.894323997655386, -8.093437504867858, 29.162670637346057, 3.69741750213808, -1.387666510051747, 23.059685675539072, -11.741425811256264, 2.4565400668887847, 19.05671055195495, 23.153553922215902, -1.9782038113178153, -15.344304427259878, 14.64451173079879, 28.309596238916036, -7.726906973339773, 4.025809025196571, -8.165996538377005, -8.834001905919582, 15.564832749806094, 3.3976961943544133, 4.042799275623744, -6.11142038993456, -7.839797719501927, 3.669414273090844, 9.878570213197582, 7.565432953610863, -10.580058431729675, 11.466386368082421, 10.464059659057353, 9.011023862978846, -6.521904922470103, 15.760764407235701, 13.009424320896589, 27.91233050500571, -11.770698347578517, -22.23600157727221, -6.09103801856795, 20.318129955824208, 15.794059167277588, 20.549486245425044, -3.4756085679237128, -8.039877442145023, -7.888265781089956, -12.2547344176457, -21.861360130362, 3.7513225969273876, 13.581660614041303, 4.990059778143035, -26.45727544182898, -24.77488908452858, -7.88191728710644, -1.8998054109675522, -15.495349518927146, -1.025895879924967, 14.580891554273155, 11.178973625489204, 3.675443231748286, 16.809023125914948, -24.97726186795355, -4.378429531392499, 2.3891154830328603, 1.4200261480822376, -18.352846009877936, 2.906084025223933, -14.805533635411578, -22.775849967136928, -28.85415368441977, 9.909543119948204, -17.69710695093487, -25.03639576733201, -9.546113014695443, 10.318221590712067, -2.2540265589527895, -7.05238752559311, 16.472629178731466, 5.355607986181706, 19.565506160572884, 9.479321647010067, -11.677388224165547, -0.11381897331317958, 2.408820025302809, 18.192051343592272, 0.9677850107209365, 2.6990430982628855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3945277168717909, "mean_inference_ms": 0.9823366282607884, "mean_action_processing_ms": 0.16853208170892814, "mean_env_wait_ms": 0.0587121459795212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003451824188232422, "StateBufferConnector_ms": 0.002503514289855957, "ViewRequirementAgentConnector_ms": 0.06542730331420898}, "num_episodes": 21, "episode_return_max": 151.51368214293805, "episode_return_min": -112.33311151419056, "episode_return_mean": 23.915424421724055}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.703920313339, "num_env_steps_trained_throughput_per_sec": 496.703920313339, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 8265.073, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8265.038, "sample_time_ms": 745.378, "learn_time_ms": 7506.145, "learn_throughput": 532.897, "synch_weights_time_ms": 12.862}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 30, "trial_id": "eaa30_00000", "date": "2024-08-09_17-44-09", "timestamp": 1723239849, "time_this_iter_s": 8.057549715042114, "time_total_s": 241.8826379776001, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc1dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 241.8826379776001, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 22.150000000000002, "ram_util_percent": 80.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.583647538114477, "cur_kl_coeff": 5.125781250000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.561191778586655, "policy_loss": 0.022192876123966126, "vf_loss": 7.375553076103251, "vf_explained_var": 0.003863083054779699, "kl": 0.03188700515717741, "entropy": 1.4626778785513823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.117024770006537, "cur_kl_coeff": 38.9239013671875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.613408483564854, "policy_loss": 0.03427668185031507, "vf_loss": 8.262865534424781, "vf_explained_var": 0.4392367862785856, "kl": 0.03381640091344404, "entropy": 1.506707589328289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "env_runners": {"episode_reward_max": 146.4288064005993, "episode_reward_min": -122.60143854314859, "episode_reward_mean": -0.9052546386014849, "episode_len_mean": 177.45, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 17745, "policy_reward_min": {"agent_policy": -61.300719271574394, "adversary_policy": -38.04764835111298}, "policy_reward_max": {"agent_policy": 73.21440320029956, "adversary_policy": 48.18754087805977}, "policy_reward_mean": {"agent_policy": -0.4526273193007434, "adversary_policy": -0.22631365965037048}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.337840322641796, 146.4288064005993, 22.449821430609383, 49.926239080894845, 74.81813865920608, 98.39353180972944, 124.1605611934267, 52.75714672042105, 46.340305393930954, -29.98998277678126, 92.24793887525867, 52.022188134368776, -44.65597877311697, 66.26481933651374, -39.44490716546851, 50.88494567912707, 52.16390349169296, -17.028895849976216, 83.68905942838964, 34.63800960475764, -112.33311151419056, 32.72689108427646, -87.7701259499561, -9.633010369622077, -39.06988118316765, -93.06178618933943, 128.91040600219188, 29.263674434420174, 1.8707278842731583, -69.74065993080296, 96.53657922963093, 66.294020821783, -15.059914410731082, 35.94670031335369, 3.970294738559531, -23.975523005046426, 65.7201762789682, 43.34403833097467, -18.569771488734958, 84.42052894834175, -34.64501647715532, 85.90821593942964, -7.402195896286386, -33.99999688859319, 37.92505788832102, -4.13724222862168, -8.340766892822174, 34.8880063336169, 1.7726558727054917, 38.9501670440724, 18.4777189695312, 81.84350965180462, -68.01339984970146, 28.454183874512537, 72.68709082540535, -23.030972020137426, -40.28600039747131, -36.22007506686927, 37.14344078436864, -102.46432905271519, -19.563445396147984, -33.04249079770426, 51.519730359524736, 40.96893271532639, -58.711382798692156, 7.618283262230195, -30.893523969308077, -75.16276720509717, -37.889221128943134, -85.46700543653373, 1.544217152033248, -18.612828169091788, 43.656474329826345, 58.089655615165896, -23.582414394957453, 41.20174273779011, 7.333656217967643, -61.10694381920818, 8.580105664649672, 20.08522263751496, -44.8087342623751, -85.21916545827224, 19.790008889572697, -102.44763928848408, -84.46253143898312, -2.6056747936638445, -113.29482817339539, -85.89222216958393, -102.72059329150835, -122.60143854314859, -51.83997039716854, -2.299057067159943, -96.90352662702486, 52.08094155986676, -56.18635146813677, -24.68937769482897, 44.947248186238596, -102.01506642308078, -87.1140528010778, -40.51322760908114], "episode_lengths": [200, 170, 200, 143, 200, 200, 143, 200, 200, 200, 165, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 148, 21, 200, 200, 200, 200, 200, 200, 200, 200, 200, 149, 200, 172, 200, 37, 200, 200, 200, 200, 200, 12, 18, 39, 21, 190, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 68, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [23.168920161320898, 73.21440320029956, 11.224910715304695, 24.963119540447423, 37.40906932960304, 49.196765904864705, 62.0802805967133, 26.378573360210538, 23.170152696965484, -14.994991388390623, 46.123969437629405, 26.01109406718436, -22.327989386558457, 33.132409668256884, -19.722453582734254, 25.442472839563525, 26.081951745846485, -8.514447924988104, 41.84452971419487, 17.31900480237883, -56.166555757095296, 16.363445542138223, -43.885062974978055, -4.816505184811067, -19.534940591583812, -46.530893094669686, 64.45520300109595, 14.631837217210094, 0.9353639421365685, -34.87032996540148, 48.268289614815494, 33.147010410891525, -7.529957205365541, 17.97335015667683, 1.985147369279769, -11.987761502523252, 32.86008813948412, 21.672019165487335, -9.284885744367479, 42.210264474170856, -17.3225082385777, 42.95410796971483, -3.701097948143186, -16.999998444296583, 18.96252894416051, -2.068621114310819, -4.170383446411087, 17.444003166808447, 0.8863279363527459, 19.475083522036197, 9.238859484765596, 40.92175482590232, -34.00669992485071, 14.227091937256265, 36.34354541270264, -11.515486010068734, -20.143000198735656, -18.11003753343462, 18.57172039218433, -51.232164526357565, -9.781722698073992, -16.521245398852116, 25.75986517976236, 20.48446635766324, -29.35569139934605, 3.809141631115098, -15.446761984654003, -37.58138360254851, -18.944610564471567, -42.7335027182669, 0.772108576016624, -9.30641408454591, 21.828237164913173, 29.04482780758295, -11.791207197478727, 20.600871368895024, 3.6668281089838217, -30.553471909604077, 4.290052832324836, 10.042611318757478, -22.404367131187556, -42.609582729136164, 9.895004444786373, -51.22381964424213, -42.23126571949154, -1.302837396831933, -56.64741408669768, -42.946111084792044, -51.36029664575418, -61.300719271574394, -25.919985198584257, -1.1495285335799714, -48.45176331351237, 26.040470779933372, -28.093175734068385, -12.344688847414485, 22.47362409311932, -51.007533211540405, -43.55702640053894, -20.256613804540567], "policy_adversary_policy_reward": [11.497221876162275, 11.671698285158627, 47.36556716827516, 25.848836032024426, 4.460912152683285, 6.76399856262141, 23.6896839226873, 1.2734356177601267, 20.247473783214527, 17.16159554638851, 14.739154125796233, 34.45761177906848, 13.892739718653544, 48.18754087805977, 14.758699058271494, 11.619874301939035, 0.9302974813819915, 22.23985521558349, 7.75285233589576, -22.747843724286383, 23.239166375893518, 22.884803061735877, 6.063124850309487, 19.94796921687488, -19.482285474909247, -2.8457039116492098, -2.392234080465286, 35.52464374872217, -10.550247595896323, -9.17220598683793, 5.887562073696184, 19.55491076586734, 17.9208689471733, 8.161082798673188, 12.713836287870144, -21.22828421285825, 26.050973176980932, 15.793556537213913, 17.524455072343457, -0.20545026996462568, -26.50190065495948, -29.664655102135775, 2.1262204452699898, 14.237225096868222, -26.451008536924576, -17.434054438053472, 4.728667988627048, -9.545173173438119, -15.285541322697302, -4.24939926888651, -12.179945392908769, -34.3509477017609, 38.72889432875075, 25.726308672345212, 8.343384016444164, 6.288453200765928, -1.231244149193639, 2.1666080913302075, -21.451359400483675, -13.418970564917807, 35.829022555778955, 12.439267059036569, 21.214378521680544, 11.932631889210985, -2.0030333245060277, -5.526923880859513, 3.0531920521795826, 14.920158104497244, -13.500653564122164, 15.485800933401933, -3.894323997655386, -8.093437504867858, 29.162670637346057, 3.69741750213808, -1.387666510051747, 23.059685675539072, -11.741425811256264, 2.4565400668887847, 19.05671055195495, 23.153553922215902, -1.9782038113178153, -15.344304427259878, 14.64451173079879, 28.309596238916036, -7.726906973339773, 4.025809025196571, -8.165996538377005, -8.834001905919582, 15.564832749806094, 3.3976961943544133, 4.042799275623744, -6.11142038993456, -7.839797719501927, 3.669414273090844, 9.878570213197582, 7.565432953610863, -10.580058431729675, 11.466386368082421, 10.464059659057353, 9.011023862978846, -6.521904922470103, 15.760764407235701, 13.009424320896589, 27.91233050500571, -11.770698347578517, -22.23600157727221, -6.09103801856795, 20.318129955824208, 15.794059167277588, 20.549486245425044, -3.4756085679237128, -8.039877442145023, -7.888265781089956, -12.2547344176457, -21.861360130362, 3.7513225969273876, 13.581660614041303, 4.990059778143035, -26.45727544182898, -24.77488908452858, -7.88191728710644, -1.8998054109675522, -15.495349518927146, -1.025895879924967, 14.580891554273155, 11.178973625489204, 3.675443231748286, 16.809023125914948, -24.97726186795355, -4.378429531392499, 2.3891154830328603, 1.4200261480822376, -18.352846009877936, 2.906084025223933, -14.805533635411578, -22.775849967136928, -28.85415368441977, 9.909543119948204, -17.69710695093487, -25.03639576733201, -9.546113014695443, 10.318221590712067, -2.2540265589527895, -7.05238752559311, 16.472629178731466, 5.355607986181706, 19.565506160572884, 9.479321647010067, -11.677388224165547, -0.11381897331317958, 2.408820025302809, 18.192051343592272, 0.9677850107209365, 2.6990430982628855, 2.0910511809966508, -32.64452309060072, 4.76904585291485, -0.47899302059001414, 17.85492717690957, -7.81231585815209, -8.434049565358773, -13.970317565828783, -14.326864617014902, -28.282718112121266, 23.790094540073767, -13.895090095287403, -38.04764835111298, -13.17617129312913, -16.106907505717466, -26.124358213774077, 0.6729763256873937, -1.9758137225193249, -24.49363004660841, -32.153784040089235, -22.570195504316455, -20.375915580475592, -32.41932818775092, -18.940968458003265, -27.432045829143256, -33.86867344243119, -0.37311573783029317, -25.54686946075396, 9.821767848216162, -10.971296381796133, -31.976151130581215, -16.47561218293115, 36.37470895739112, -10.334238177457738, -28.1802551143529, 0.08707938028451423, -1.5441668606303622, -10.800521986784123, 0.8312075319120478, 21.642416561207277, -27.61438470694769, -23.393148504592723, -13.38398483672264, -30.173041563816298, -36.983518073307124, 16.726904268766546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39414819745463275, "mean_inference_ms": 0.9803450335629688, "mean_action_processing_ms": 0.1681511937616214, "mean_env_wait_ms": 0.05860767521344064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003925681114196777, "StateBufferConnector_ms": 0.0025616884231567383, "ViewRequirementAgentConnector_ms": 0.06508100032806396}, "num_episodes": 23, "episode_return_max": 146.4288064005993, "episode_return_min": -122.60143854314859, "episode_return_mean": -0.9052546386014849}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 467.0288866048865, "num_env_steps_trained_throughput_per_sec": 467.0288866048865, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 8304.83, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8304.795, "sample_time_ms": 750.646, "learn_time_ms": 7540.763, "learn_throughput": 530.45, "synch_weights_time_ms": 12.733}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "training_iteration": 31, "trial_id": "eaa30_00000", "date": "2024-08-09_17-44-18", "timestamp": 1723239858, "time_this_iter_s": 8.571411848068237, "time_total_s": 250.45404982566833, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc1df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 250.45404982566833, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 30.983333333333334, "ram_util_percent": 80.22500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.530614580931488, "cur_kl_coeff": 7.688671874999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.138820228627119, "policy_loss": 0.008080644931190858, "vf_loss": 6.943328570058106, "vf_explained_var": 0.019455049214539704, "kl": 0.024374953369122175, "entropy": 1.471336769490015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.742897804702322, "cur_kl_coeff": 58.38585205078127, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.811636321246624, "policy_loss": 0.006608570994285401, "vf_loss": 7.868107329805692, "vf_explained_var": 0.34976889155805113, "kl": 0.016047045079782645, "entropy": 1.4962177695085606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 128.91040600219188, "episode_reward_min": -139.8032568714764, "episode_reward_mean": -24.77641502562537, "episode_len_mean": 179.24, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 17924, "policy_reward_min": {"agent_policy": -69.90162843573813, "adversary_policy": -44.88914907190967}, "policy_reward_max": {"agent_policy": 64.45520300109595, "adversary_policy": 38.72889432875075}, "policy_reward_mean": {"agent_policy": -12.388207512812684, "adversary_policy": -6.194103756406342}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-87.7701259499561, -9.633010369622077, -39.06988118316765, -93.06178618933943, 128.91040600219188, 29.263674434420174, 1.8707278842731583, -69.74065993080296, 96.53657922963093, 66.294020821783, -15.059914410731082, 35.94670031335369, 3.970294738559531, -23.975523005046426, 65.7201762789682, 43.34403833097467, -18.569771488734958, 84.42052894834175, -34.64501647715532, 85.90821593942964, -7.402195896286386, -33.99999688859319, 37.92505788832102, -4.13724222862168, -8.340766892822174, 34.8880063336169, 1.7726558727054917, 38.9501670440724, 18.4777189695312, 81.84350965180462, -68.01339984970146, 28.454183874512537, 72.68709082540535, -23.030972020137426, -40.28600039747131, -36.22007506686927, 37.14344078436864, -102.46432905271519, -19.563445396147984, -33.04249079770426, 51.519730359524736, 40.96893271532639, -58.711382798692156, 7.618283262230195, -30.893523969308077, -75.16276720509717, -37.889221128943134, -85.46700543653373, 1.544217152033248, -18.612828169091788, 43.656474329826345, 58.089655615165896, -23.582414394957453, 41.20174273779011, 7.333656217967643, -61.10694381920818, 8.580105664649672, 20.08522263751496, -44.8087342623751, -85.21916545827224, 19.790008889572697, -102.44763928848408, -84.46253143898312, -2.6056747936638445, -113.29482817339539, -85.89222216958393, -102.72059329150835, -122.60143854314859, -51.83997039716854, -2.299057067159943, -96.90352662702486, 52.08094155986676, -56.18635146813677, -24.68937769482897, 44.947248186238596, -102.01506642308078, -87.1140528010778, -40.51322760908114, -108.4195685688114, -67.67628797907108, -43.99290187361306, -114.62441823843685, -139.8032568714764, -82.3723848122452, -74.47649942319848, -124.93926877403035, -50.65064798291152, -57.73538124979358, -115.42242351445452, -96.21356153475452, -110.19311828733748, -10.964801856745758, -135.26051489670743, 57.32445628197837, -27.38649302027595, 36.243801851036615, -137.03924709970966, -8.887971726956849, -4.501498723477926, -87.32677983508444], "episode_lengths": [200, 200, 200, 200, 148, 21, 200, 200, 200, 200, 200, 200, 200, 200, 200, 149, 200, 172, 200, 37, 200, 200, 200, 200, 200, 12, 18, 39, 21, 190, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 68, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-43.885062974978055, -4.816505184811067, -19.534940591583812, -46.530893094669686, 64.45520300109595, 14.631837217210094, 0.9353639421365685, -34.87032996540148, 48.268289614815494, 33.147010410891525, -7.529957205365541, 17.97335015667683, 1.985147369279769, -11.987761502523252, 32.86008813948412, 21.672019165487335, -9.284885744367479, 42.210264474170856, -17.3225082385777, 42.95410796971483, -3.701097948143186, -16.999998444296583, 18.96252894416051, -2.068621114310819, -4.170383446411087, 17.444003166808447, 0.8863279363527459, 19.475083522036197, 9.238859484765596, 40.92175482590232, -34.00669992485071, 14.227091937256265, 36.34354541270264, -11.515486010068734, -20.143000198735656, -18.11003753343462, 18.57172039218433, -51.232164526357565, -9.781722698073992, -16.521245398852116, 25.75986517976236, 20.48446635766324, -29.35569139934605, 3.809141631115098, -15.446761984654003, -37.58138360254851, -18.944610564471567, -42.7335027182669, 0.772108576016624, -9.30641408454591, 21.828237164913173, 29.04482780758295, -11.791207197478727, 20.600871368895024, 3.6668281089838217, -30.553471909604077, 4.290052832324836, 10.042611318757478, -22.404367131187556, -42.609582729136164, 9.895004444786373, -51.22381964424213, -42.23126571949154, -1.302837396831933, -56.64741408669768, -42.946111084792044, -51.36029664575418, -61.300719271574394, -25.919985198584257, -1.1495285335799714, -48.45176331351237, 26.040470779933372, -28.093175734068385, -12.344688847414485, 22.47362409311932, -51.007533211540405, -43.55702640053894, -20.256613804540567, -54.20978428440575, -33.83814398953558, -21.996450936806514, -57.31220911921838, -69.90162843573813, -41.186192406122586, -37.23824971159922, -62.46963438701515, -25.32532399145576, -28.867690624896788, -57.711211757227275, -48.106780767377316, -55.096559143668756, -5.4824009283728685, -67.63025744835366, 28.66222814098917, -13.693246510137975, 18.121900925518304, -68.5196235498548, -4.443985863478424, -2.250749361738963, -43.663389917542254], "policy_adversary_policy_reward": [-26.451008536924576, -17.434054438053472, 4.728667988627048, -9.545173173438119, -15.285541322697302, -4.24939926888651, -12.179945392908769, -34.3509477017609, 38.72889432875075, 25.726308672345212, 8.343384016444164, 6.288453200765928, -1.231244149193639, 2.1666080913302075, -21.451359400483675, -13.418970564917807, 35.829022555778955, 12.439267059036569, 21.214378521680544, 11.932631889210985, -2.0030333245060277, -5.526923880859513, 3.0531920521795826, 14.920158104497244, -13.500653564122164, 15.485800933401933, -3.894323997655386, -8.093437504867858, 29.162670637346057, 3.69741750213808, -1.387666510051747, 23.059685675539072, -11.741425811256264, 2.4565400668887847, 19.05671055195495, 23.153553922215902, -1.9782038113178153, -15.344304427259878, 14.64451173079879, 28.309596238916036, -7.726906973339773, 4.025809025196571, -8.165996538377005, -8.834001905919582, 15.564832749806094, 3.3976961943544133, 4.042799275623744, -6.11142038993456, -7.839797719501927, 3.669414273090844, 9.878570213197582, 7.565432953610863, -10.580058431729675, 11.466386368082421, 10.464059659057353, 9.011023862978846, -6.521904922470103, 15.760764407235701, 13.009424320896589, 27.91233050500571, -11.770698347578517, -22.23600157727221, -6.09103801856795, 20.318129955824208, 15.794059167277588, 20.549486245425044, -3.4756085679237128, -8.039877442145023, -7.888265781089956, -12.2547344176457, -21.861360130362, 3.7513225969273876, 13.581660614041303, 4.990059778143035, -26.45727544182898, -24.77488908452858, -7.88191728710644, -1.8998054109675522, -15.495349518927146, -1.025895879924967, 14.580891554273155, 11.178973625489204, 3.675443231748286, 16.809023125914948, -24.97726186795355, -4.378429531392499, 2.3891154830328603, 1.4200261480822376, -18.352846009877936, 2.906084025223933, -14.805533635411578, -22.775849967136928, -28.85415368441977, 9.909543119948204, -17.69710695093487, -25.03639576733201, -9.546113014695443, 10.318221590712067, -2.2540265589527895, -7.05238752559311, 16.472629178731466, 5.355607986181706, 19.565506160572884, 9.479321647010067, -11.677388224165547, -0.11381897331317958, 2.408820025302809, 18.192051343592272, 0.9677850107209365, 2.6990430982628855, 2.0910511809966508, -32.64452309060072, 4.76904585291485, -0.47899302059001414, 17.85492717690957, -7.81231585815209, -8.434049565358773, -13.970317565828783, -14.326864617014902, -28.282718112121266, 23.790094540073767, -13.895090095287403, -38.04764835111298, -13.17617129312913, -16.106907505717466, -26.124358213774077, 0.6729763256873937, -1.9758137225193249, -24.49363004660841, -32.153784040089235, -22.570195504316455, -20.375915580475592, -32.41932818775092, -18.940968458003265, -27.432045829143256, -33.86867344243119, -0.37311573783029317, -25.54686946075396, 9.821767848216162, -10.971296381796133, -31.976151130581215, -16.47561218293115, 36.37470895739112, -10.334238177457738, -28.1802551143529, 0.08707938028451423, -1.5441668606303622, -10.800521986784123, 0.8312075319120478, 21.642416561207277, -27.61438470694769, -23.393148504592723, -13.38398483672264, -30.173041563816298, -36.983518073307124, 16.726904268766546, -25.365366083752708, -28.84441820065304, -23.784903003009518, -10.053240986526063, -7.3454884990508305, -14.650962437755693, -43.638001314472184, -13.674207804746203, -36.92829578653244, -32.97333264920572, -19.52755237123981, -21.65864003488278, -20.04891834769249, -17.18933136390674, -17.58048531510547, -44.88914907190967, -5.896345346635421, -19.428978644820344, -3.2103191553990627, -25.657371469497726, -35.67330903770145, -22.037902719525835, -29.878075699750408, -18.228705067626915, -22.742959186259274, -32.35359995740949, -5.982803247730306, 0.5004023193574376, -30.661138318596343, -36.969119129757296, 13.140268132935422, 15.52196000805375, -2.337525032589639, -11.355721477548336, 5.370411032195843, 12.751489893322454, -26.841776690777266, -41.67784685907753, 6.045245803917133, -10.489231667395558, -5.905874167500302, 3.6551248057613392, -10.483604078794514, -33.17978583874774]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3936951409169845, "mean_inference_ms": 0.9787327569503048, "mean_action_processing_ms": 0.1677898002923252, "mean_env_wait_ms": 0.05849956564744228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003954648971557617, "StateBufferConnector_ms": 0.002550959587097168, "ViewRequirementAgentConnector_ms": 0.06578624248504639}, "num_episodes": 22, "episode_return_max": 128.91040600219188, "episode_return_min": -139.8032568714764, "episode_return_mean": -24.77641502562537}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.7923422426546, "num_env_steps_trained_throughput_per_sec": 485.7923422426546, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 8312.061, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8312.025, "sample_time_ms": 748.83, "learn_time_ms": 7549.701, "learn_throughput": 529.822, "synch_weights_time_ms": 12.896}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 32, "trial_id": "eaa30_00000", "date": "2024-08-09_17-44-26", "timestamp": 1723239866, "time_this_iter_s": 8.240227937698364, "time_total_s": 258.6942777633667, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc94f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 258.6942777633667, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 23.0, "ram_util_percent": 79.94999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.0293811007782265, "cur_kl_coeff": 11.5330078125, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.884116916807871, "policy_loss": 0.008917128460767566, "vf_loss": 6.65652924668852, "vf_explained_var": -0.0394522730950956, "kl": 0.018960408207827382, "entropy": 1.4719247344309692, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.026787548015514, "cur_kl_coeff": 58.38585205078127, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.56593331694603, "policy_loss": 0.010929058441251981, "vf_loss": 7.710635738571485, "vf_explained_var": 0.4172241011013587, "kl": 0.014461868297318384, "entropy": 1.490507539610068, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "env_runners": {"episode_reward_max": 92.14574275689324, "episode_reward_min": -139.8032568714764, "episode_reward_mean": -37.092076196558594, "episode_len_mean": 182.53, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18253, "policy_reward_min": {"agent_policy": -69.90162843573813, "adversary_policy": -44.88914907190967}, "policy_reward_max": {"agent_policy": 46.07287137844662, "adversary_policy": 50.52499176795221}, "policy_reward_mean": {"agent_policy": -18.546038098279297, "adversary_policy": -9.273019049139648}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.402195896286386, -33.99999688859319, 37.92505788832102, -4.13724222862168, -8.340766892822174, 34.8880063336169, 1.7726558727054917, 38.9501670440724, 18.4777189695312, 81.84350965180462, -68.01339984970146, 28.454183874512537, 72.68709082540535, -23.030972020137426, -40.28600039747131, -36.22007506686927, 37.14344078436864, -102.46432905271519, -19.563445396147984, -33.04249079770426, 51.519730359524736, 40.96893271532639, -58.711382798692156, 7.618283262230195, -30.893523969308077, -75.16276720509717, -37.889221128943134, -85.46700543653373, 1.544217152033248, -18.612828169091788, 43.656474329826345, 58.089655615165896, -23.582414394957453, 41.20174273779011, 7.333656217967643, -61.10694381920818, 8.580105664649672, 20.08522263751496, -44.8087342623751, -85.21916545827224, 19.790008889572697, -102.44763928848408, -84.46253143898312, -2.6056747936638445, -113.29482817339539, -85.89222216958393, -102.72059329150835, -122.60143854314859, -51.83997039716854, -2.299057067159943, -96.90352662702486, 52.08094155986676, -56.18635146813677, -24.68937769482897, 44.947248186238596, -102.01506642308078, -87.1140528010778, -40.51322760908114, -108.4195685688114, -67.67628797907108, -43.99290187361306, -114.62441823843685, -139.8032568714764, -82.3723848122452, -74.47649942319848, -124.93926877403035, -50.65064798291152, -57.73538124979358, -115.42242351445452, -96.21356153475452, -110.19311828733748, -10.964801856745758, -135.26051489670743, 57.32445628197837, -27.38649302027595, 36.243801851036615, -137.03924709970966, -8.887971726956849, -4.501498723477926, -87.32677983508444, -19.60448029770817, -21.213889935620458, -102.06283642542945, -61.65115241497797, 1.4062237331629959, 26.262595014132096, -25.457373753419937, -109.60924619619561, -64.1720060437408, -104.87820315085031, -134.6764355775315, -9.090570654509548, 3.7221698229828846, -99.92533500872588, -103.46095692992694, 92.14574275689324, -115.33137429999144, 22.374526100688684, -113.17573961323504, -42.50810030194914], "episode_lengths": [200, 200, 200, 200, 200, 12, 18, 39, 21, 190, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 68, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 56, 200, 200, 200, 200], "policy_agent_policy_reward": [-3.701097948143186, -16.999998444296583, 18.96252894416051, -2.068621114310819, -4.170383446411087, 17.444003166808447, 0.8863279363527459, 19.475083522036197, 9.238859484765596, 40.92175482590232, -34.00669992485071, 14.227091937256265, 36.34354541270264, -11.515486010068734, -20.143000198735656, -18.11003753343462, 18.57172039218433, -51.232164526357565, -9.781722698073992, -16.521245398852116, 25.75986517976236, 20.48446635766324, -29.35569139934605, 3.809141631115098, -15.446761984654003, -37.58138360254851, -18.944610564471567, -42.7335027182669, 0.772108576016624, -9.30641408454591, 21.828237164913173, 29.04482780758295, -11.791207197478727, 20.600871368895024, 3.6668281089838217, -30.553471909604077, 4.290052832324836, 10.042611318757478, -22.404367131187556, -42.609582729136164, 9.895004444786373, -51.22381964424213, -42.23126571949154, -1.302837396831933, -56.64741408669768, -42.946111084792044, -51.36029664575418, -61.300719271574394, -25.919985198584257, -1.1495285335799714, -48.45176331351237, 26.040470779933372, -28.093175734068385, -12.344688847414485, 22.47362409311932, -51.007533211540405, -43.55702640053894, -20.256613804540567, -54.20978428440575, -33.83814398953558, -21.996450936806514, -57.31220911921838, -69.90162843573813, -41.186192406122586, -37.23824971159922, -62.46963438701515, -25.32532399145576, -28.867690624896788, -57.711211757227275, -48.106780767377316, -55.096559143668756, -5.4824009283728685, -67.63025744835366, 28.66222814098917, -13.693246510137975, 18.121900925518304, -68.5196235498548, -4.443985863478424, -2.250749361738963, -43.663389917542254, -9.80224014885409, -10.606944967810229, -51.03141821271473, -30.825576207489014, 0.7031118665814979, 13.131297507066058, -12.728686876709972, -54.80462309809782, -32.086003021870354, -52.43910157542519, -67.33821778876572, -4.545285327254774, 1.8610849114914352, -49.962667504362955, -51.730478464963504, 46.07287137844662, -57.66568714999571, 11.187263050344342, -56.58786980661744, -21.25405015097457], "policy_adversary_policy_reward": [-7.726906973339773, 4.025809025196571, -8.165996538377005, -8.834001905919582, 15.564832749806094, 3.3976961943544133, 4.042799275623744, -6.11142038993456, -7.839797719501927, 3.669414273090844, 9.878570213197582, 7.565432953610863, -10.580058431729675, 11.466386368082421, 10.464059659057353, 9.011023862978846, -6.521904922470103, 15.760764407235701, 13.009424320896589, 27.91233050500571, -11.770698347578517, -22.23600157727221, -6.09103801856795, 20.318129955824208, 15.794059167277588, 20.549486245425044, -3.4756085679237128, -8.039877442145023, -7.888265781089956, -12.2547344176457, -21.861360130362, 3.7513225969273876, 13.581660614041303, 4.990059778143035, -26.45727544182898, -24.77488908452858, -7.88191728710644, -1.8998054109675522, -15.495349518927146, -1.025895879924967, 14.580891554273155, 11.178973625489204, 3.675443231748286, 16.809023125914948, -24.97726186795355, -4.378429531392499, 2.3891154830328603, 1.4200261480822376, -18.352846009877936, 2.906084025223933, -14.805533635411578, -22.775849967136928, -28.85415368441977, 9.909543119948204, -17.69710695093487, -25.03639576733201, -9.546113014695443, 10.318221590712067, -2.2540265589527895, -7.05238752559311, 16.472629178731466, 5.355607986181706, 19.565506160572884, 9.479321647010067, -11.677388224165547, -0.11381897331317958, 2.408820025302809, 18.192051343592272, 0.9677850107209365, 2.6990430982628855, 2.0910511809966508, -32.64452309060072, 4.76904585291485, -0.47899302059001414, 17.85492717690957, -7.81231585815209, -8.434049565358773, -13.970317565828783, -14.326864617014902, -28.282718112121266, 23.790094540073767, -13.895090095287403, -38.04764835111298, -13.17617129312913, -16.106907505717466, -26.124358213774077, 0.6729763256873937, -1.9758137225193249, -24.49363004660841, -32.153784040089235, -22.570195504316455, -20.375915580475592, -32.41932818775092, -18.940968458003265, -27.432045829143256, -33.86867344243119, -0.37311573783029317, -25.54686946075396, 9.821767848216162, -10.971296381796133, -31.976151130581215, -16.47561218293115, 36.37470895739112, -10.334238177457738, -28.1802551143529, 0.08707938028451423, -1.5441668606303622, -10.800521986784123, 0.8312075319120478, 21.642416561207277, -27.61438470694769, -23.393148504592723, -13.38398483672264, -30.173041563816298, -36.983518073307124, 16.726904268766546, -25.365366083752708, -28.84441820065304, -23.784903003009518, -10.053240986526063, -7.3454884990508305, -14.650962437755693, -43.638001314472184, -13.674207804746203, -36.92829578653244, -32.97333264920572, -19.52755237123981, -21.65864003488278, -20.04891834769249, -17.18933136390674, -17.58048531510547, -44.88914907190967, -5.896345346635421, -19.428978644820344, -3.2103191553990627, -25.657371469497726, -35.67330903770145, -22.037902719525835, -29.878075699750408, -18.228705067626915, -22.742959186259274, -32.35359995740949, -5.982803247730306, 0.5004023193574376, -30.661138318596343, -36.969119129757296, 13.140268132935422, 15.52196000805375, -2.337525032589639, -11.355721477548336, 5.370411032195843, 12.751489893322454, -26.841776690777266, -41.67784685907753, 6.045245803917133, -10.489231667395558, -5.905874167500302, 3.6551248057613392, -10.483604078794514, -33.17978583874774, -2.000667790706693, -7.801572358147395, -11.71382631196363, 1.1068813441534004, -19.40448093220584, -31.626937280508898, -16.406987586484703, -14.418588621004313, 6.817190022914495, -6.114078156332997, 11.811048374641885, 1.3202491324241734, -10.09366876281613, -2.635018113893823, -34.29071188327002, -20.513911214827807, -20.805207210811577, -11.280795811058773, -18.603624689072607, -33.83547688635258, -37.108442630456025, -30.229775158309707, -4.561698551803211, 0.01641322454844385, -5.30598385617621, 7.167068767667644, -40.24142220495573, -9.721245299407222, -25.901686231892512, -25.82879223307099, 50.52499176795221, -4.452120389505575, -34.848998660308, -22.816688489687714, 1.1362977807921055, 10.050965269552236, -19.4122588180675, -37.17561098854994, -7.127854912798057, -14.126195238176514]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3933410825192827, "mean_inference_ms": 0.9774661669614447, "mean_action_processing_ms": 0.16766150814484995, "mean_env_wait_ms": 0.05840978350653216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004055976867675781, "StateBufferConnector_ms": 0.0026286840438842773, "ViewRequirementAgentConnector_ms": 0.06654560565948486}, "num_episodes": 20, "episode_return_max": 92.14574275689324, "episode_return_min": -139.8032568714764, "episode_return_mean": -37.092076196558594}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.38037958054355, "num_env_steps_trained_throughput_per_sec": 486.38037958054355, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 8307.246, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8307.21, "sample_time_ms": 746.482, "learn_time_ms": 7547.244, "learn_throughput": 529.995, "synch_weights_time_ms": 12.923}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "training_iteration": 33, "trial_id": "eaa30_00000", "date": "2024-08-09_17-44-34", "timestamp": 1723239874, "time_this_iter_s": 8.229300022125244, "time_total_s": 266.92357778549194, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf2160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 266.92357778549194, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 21.974999999999998, "ram_util_percent": 79.79166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.052916872249079, "cur_kl_coeff": 11.5330078125, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.97377500079927, "policy_loss": 0.01321695609025598, "vf_loss": 6.715355661937169, "vf_explained_var": 0.05487666372899656, "kl": 0.021260922958473205, "entropy": 1.4812068992821628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.909255825976532, "cur_kl_coeff": 58.38585205078127, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.561459261675676, "policy_loss": -0.003898352878362251, "vf_loss": 7.906393847366174, "vf_explained_var": 0.1781354631607731, "kl": 0.028413797532509003, "entropy": 1.4516411462177834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "env_runners": {"episode_reward_max": 92.14574275689324, "episode_reward_min": -143.89440065387274, "episode_reward_mean": -50.830509671509034, "episode_len_mean": 187.9, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18790, "policy_reward_min": {"agent_policy": -71.9472003269363, "adversary_policy": -49.68921425678727}, "policy_reward_max": {"agent_policy": 46.07287137844662, "adversary_policy": 50.52499176795221}, "policy_reward_mean": {"agent_policy": -25.415254835754517, "adversary_policy": -12.707627417877257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.519730359524736, 40.96893271532639, -58.711382798692156, 7.618283262230195, -30.893523969308077, -75.16276720509717, -37.889221128943134, -85.46700543653373, 1.544217152033248, -18.612828169091788, 43.656474329826345, 58.089655615165896, -23.582414394957453, 41.20174273779011, 7.333656217967643, -61.10694381920818, 8.580105664649672, 20.08522263751496, -44.8087342623751, -85.21916545827224, 19.790008889572697, -102.44763928848408, -84.46253143898312, -2.6056747936638445, -113.29482817339539, -85.89222216958393, -102.72059329150835, -122.60143854314859, -51.83997039716854, -2.299057067159943, -96.90352662702486, 52.08094155986676, -56.18635146813677, -24.68937769482897, 44.947248186238596, -102.01506642308078, -87.1140528010778, -40.51322760908114, -108.4195685688114, -67.67628797907108, -43.99290187361306, -114.62441823843685, -139.8032568714764, -82.3723848122452, -74.47649942319848, -124.93926877403035, -50.65064798291152, -57.73538124979358, -115.42242351445452, -96.21356153475452, -110.19311828733748, -10.964801856745758, -135.26051489670743, 57.32445628197837, -27.38649302027595, 36.243801851036615, -137.03924709970966, -8.887971726956849, -4.501498723477926, -87.32677983508444, -19.60448029770817, -21.213889935620458, -102.06283642542945, -61.65115241497797, 1.4062237331629959, 26.262595014132096, -25.457373753419937, -109.60924619619561, -64.1720060437408, -104.87820315085031, -134.6764355775315, -9.090570654509548, 3.7221698229828846, -99.92533500872588, -103.46095692992694, 92.14574275689324, -115.33137429999144, 22.374526100688684, -113.17573961323504, -42.50810030194914, -66.36917899153272, -94.17060077461193, -66.10232031402084, -123.59760881492144, -88.02536918981582, -99.43914756196574, -56.15196675121463, -70.76751919259235, -143.89440065387274, -107.0805796310035, -69.76879945575945, -48.74364179357839, -84.5024524793404, -121.6469320960183, -33.30761848720619, -41.680200923815775, 12.867289662302124, 41.13281357032436, -58.79685592303866, -78.15734093609237], "episode_lengths": [15, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 68, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 56, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 17, 200, 200], "policy_agent_policy_reward": [25.75986517976236, 20.48446635766324, -29.35569139934605, 3.809141631115098, -15.446761984654003, -37.58138360254851, -18.944610564471567, -42.7335027182669, 0.772108576016624, -9.30641408454591, 21.828237164913173, 29.04482780758295, -11.791207197478727, 20.600871368895024, 3.6668281089838217, -30.553471909604077, 4.290052832324836, 10.042611318757478, -22.404367131187556, -42.609582729136164, 9.895004444786373, -51.22381964424213, -42.23126571949154, -1.302837396831933, -56.64741408669768, -42.946111084792044, -51.36029664575418, -61.300719271574394, -25.919985198584257, -1.1495285335799714, -48.45176331351237, 26.040470779933372, -28.093175734068385, -12.344688847414485, 22.47362409311932, -51.007533211540405, -43.55702640053894, -20.256613804540567, -54.20978428440575, -33.83814398953558, -21.996450936806514, -57.31220911921838, -69.90162843573813, -41.186192406122586, -37.23824971159922, -62.46963438701515, -25.32532399145576, -28.867690624896788, -57.711211757227275, -48.106780767377316, -55.096559143668756, -5.4824009283728685, -67.63025744835366, 28.66222814098917, -13.693246510137975, 18.121900925518304, -68.5196235498548, -4.443985863478424, -2.250749361738963, -43.663389917542254, -9.80224014885409, -10.606944967810229, -51.03141821271473, -30.825576207489014, 0.7031118665814979, 13.131297507066058, -12.728686876709972, -54.80462309809782, -32.086003021870354, -52.43910157542519, -67.33821778876572, -4.545285327254774, 1.8610849114914352, -49.962667504362955, -51.730478464963504, 46.07287137844662, -57.66568714999571, 11.187263050344342, -56.58786980661744, -21.25405015097457, -33.184589495766375, -47.085300387305914, -33.051160157010436, -61.79880440746073, -44.01268459490787, -49.71957378098288, -28.075983375607308, -35.383759596296144, -71.9472003269363, -53.54028981550189, -34.88439972787977, -24.371820896789185, -42.25122623967019, -60.823466048009195, -16.65380924360307, -20.840100461907888, 6.433644831151067, 20.56640678516217, -29.398427961519353, -39.07867046804618], "policy_adversary_policy_reward": [14.580891554273155, 11.178973625489204, 3.675443231748286, 16.809023125914948, -24.97726186795355, -4.378429531392499, 2.3891154830328603, 1.4200261480822376, -18.352846009877936, 2.906084025223933, -14.805533635411578, -22.775849967136928, -28.85415368441977, 9.909543119948204, -17.69710695093487, -25.03639576733201, -9.546113014695443, 10.318221590712067, -2.2540265589527895, -7.05238752559311, 16.472629178731466, 5.355607986181706, 19.565506160572884, 9.479321647010067, -11.677388224165547, -0.11381897331317958, 2.408820025302809, 18.192051343592272, 0.9677850107209365, 2.6990430982628855, 2.0910511809966508, -32.64452309060072, 4.76904585291485, -0.47899302059001414, 17.85492717690957, -7.81231585815209, -8.434049565358773, -13.970317565828783, -14.326864617014902, -28.282718112121266, 23.790094540073767, -13.895090095287403, -38.04764835111298, -13.17617129312913, -16.106907505717466, -26.124358213774077, 0.6729763256873937, -1.9758137225193249, -24.49363004660841, -32.153784040089235, -22.570195504316455, -20.375915580475592, -32.41932818775092, -18.940968458003265, -27.432045829143256, -33.86867344243119, -0.37311573783029317, -25.54686946075396, 9.821767848216162, -10.971296381796133, -31.976151130581215, -16.47561218293115, 36.37470895739112, -10.334238177457738, -28.1802551143529, 0.08707938028451423, -1.5441668606303622, -10.800521986784123, 0.8312075319120478, 21.642416561207277, -27.61438470694769, -23.393148504592723, -13.38398483672264, -30.173041563816298, -36.983518073307124, 16.726904268766546, -25.365366083752708, -28.84441820065304, -23.784903003009518, -10.053240986526063, -7.3454884990508305, -14.650962437755693, -43.638001314472184, -13.674207804746203, -36.92829578653244, -32.97333264920572, -19.52755237123981, -21.65864003488278, -20.04891834769249, -17.18933136390674, -17.58048531510547, -44.88914907190967, -5.896345346635421, -19.428978644820344, -3.2103191553990627, -25.657371469497726, -35.67330903770145, -22.037902719525835, -29.878075699750408, -18.228705067626915, -22.742959186259274, -32.35359995740949, -5.982803247730306, 0.5004023193574376, -30.661138318596343, -36.969119129757296, 13.140268132935422, 15.52196000805375, -2.337525032589639, -11.355721477548336, 5.370411032195843, 12.751489893322454, -26.841776690777266, -41.67784685907753, 6.045245803917133, -10.489231667395558, -5.905874167500302, 3.6551248057613392, -10.483604078794514, -33.17978583874774, -2.000667790706693, -7.801572358147395, -11.71382631196363, 1.1068813441534004, -19.40448093220584, -31.626937280508898, -16.406987586484703, -14.418588621004313, 6.817190022914495, -6.114078156332997, 11.811048374641885, 1.3202491324241734, -10.09366876281613, -2.635018113893823, -34.29071188327002, -20.513911214827807, -20.805207210811577, -11.280795811058773, -18.603624689072607, -33.83547688635258, -37.108442630456025, -30.229775158309707, -4.561698551803211, 0.01641322454844385, -5.30598385617621, 7.167068767667644, -40.24142220495573, -9.721245299407222, -25.901686231892512, -25.82879223307099, 50.52499176795221, -4.452120389505575, -34.848998660308, -22.816688489687714, 1.1362977807921055, 10.050965269552236, -19.4122588180675, -37.17561098854994, -7.127854912798057, -14.126195238176514, -14.99653729026834, -18.188052205498035, -22.96246663889173, -24.12283374841418, -39.58225967380559, 6.531099516795159, -49.68921425678727, -12.109590150673469, -9.449741336885083, -34.562943258022784, -31.845778464540807, -17.87379531644207, -18.907364196759097, -9.16861917884821, -16.955971434903688, -18.427788161392456, -33.096677130852946, -38.850523196083344, -17.203675012902, -36.33661480259989, -21.381171133066786, -13.503228594812978, -11.19882052250533, -13.173000374283854, -17.534428305327083, -24.716797934343106, -22.929395533315425, -37.89407051469377, -2.1733473111875057, -14.480461932415565, -13.021239359952745, -7.818861101955143, -12.628213402004638, 19.061858233155704, 6.848200066335437, 13.718206718826734, -24.230028431270522, -5.168399530248827, -3.5455064529794633, -35.533164015066724]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3926890542082525, "mean_inference_ms": 0.9765281759536774, "mean_action_processing_ms": 0.1671930264241442, "mean_env_wait_ms": 0.058375264158331996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004067063331604004, "StateBufferConnector_ms": 0.0026504993438720703, "ViewRequirementAgentConnector_ms": 0.06667256355285645}, "num_episodes": 20, "episode_return_max": 92.14574275689324, "episode_return_min": -143.89440065387274, "episode_return_mean": -50.830509671509034}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 479.9972717440228, "num_env_steps_trained_throughput_per_sec": 479.9972717440228, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 8250.016, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8249.981, "sample_time_ms": 746.978, "learn_time_ms": 7490.568, "learn_throughput": 534.005, "synch_weights_time_ms": 12.044}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "training_iteration": 34, "trial_id": "eaa30_00000", "date": "2024-08-09_17-44-43", "timestamp": 1723239883, "time_this_iter_s": 8.338841915130615, "time_total_s": 275.26241970062256, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf2430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 275.26241970062256, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 23.491666666666664, "ram_util_percent": 79.80833333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.608655170978063, "cur_kl_coeff": 17.299511718750004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.611881100689923, "policy_loss": 0.007393880743316557, "vf_loss": 6.278758611376324, "vf_explained_var": 0.12097664062308255, "kl": 0.018828775393456298, "entropy": 1.4820676958750165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.53632205153505, "cur_kl_coeff": 87.57877807617186, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.613167380293211, "policy_loss": -0.004179364020819776, "vf_loss": 7.561474369466305, "vf_explained_var": 0.07418760638684034, "kl": 0.02347454859991558, "entropy": 1.4122375333060821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "env_runners": {"episode_reward_max": 92.14574275689324, "episode_reward_min": -147.0151167623693, "episode_reward_mean": -65.49720141039906, "episode_len_mean": 195.41, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 19541, "policy_reward_min": {"agent_policy": -73.50755838118475, "adversary_policy": -49.68921425678727}, "policy_reward_max": {"agent_policy": 46.07287137844662, "adversary_policy": 50.52499176795221}, "policy_reward_mean": {"agent_policy": -32.748600705199536, "adversary_policy": -16.374300352599768}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.8087342623751, -85.21916545827224, 19.790008889572697, -102.44763928848408, -84.46253143898312, -2.6056747936638445, -113.29482817339539, -85.89222216958393, -102.72059329150835, -122.60143854314859, -51.83997039716854, -2.299057067159943, -96.90352662702486, 52.08094155986676, -56.18635146813677, -24.68937769482897, 44.947248186238596, -102.01506642308078, -87.1140528010778, -40.51322760908114, -108.4195685688114, -67.67628797907108, -43.99290187361306, -114.62441823843685, -139.8032568714764, -82.3723848122452, -74.47649942319848, -124.93926877403035, -50.65064798291152, -57.73538124979358, -115.42242351445452, -96.21356153475452, -110.19311828733748, -10.964801856745758, -135.26051489670743, 57.32445628197837, -27.38649302027595, 36.243801851036615, -137.03924709970966, -8.887971726956849, -4.501498723477926, -87.32677983508444, -19.60448029770817, -21.213889935620458, -102.06283642542945, -61.65115241497797, 1.4062237331629959, 26.262595014132096, -25.457373753419937, -109.60924619619561, -64.1720060437408, -104.87820315085031, -134.6764355775315, -9.090570654509548, 3.7221698229828846, -99.92533500872588, -103.46095692992694, 92.14574275689324, -115.33137429999144, 22.374526100688684, -113.17573961323504, -42.50810030194914, -66.36917899153272, -94.17060077461193, -66.10232031402084, -123.59760881492144, -88.02536918981582, -99.43914756196574, -56.15196675121463, -70.76751919259235, -143.89440065387274, -107.0805796310035, -69.76879945575945, -48.74364179357839, -84.5024524793404, -121.6469320960183, -33.30761848720619, -41.680200923815775, 12.867289662302124, 41.13281357032436, -58.79685592303866, -78.15734093609237, -65.6495838302769, -111.26675165650812, -107.68370653399529, -71.68617119961166, -75.85983984191067, -79.3569685504394, -126.33333493440986, -37.2321471212731, -47.12684041783844, -130.6555113443186, -147.0151167623693, -120.44210161930509, -99.04526228025006, -96.94791162145296, -41.9194464926539, -86.45288429683592, -63.16191759972297, -69.66174401563438], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 68, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 56, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 17, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-22.404367131187556, -42.609582729136164, 9.895004444786373, -51.22381964424213, -42.23126571949154, -1.302837396831933, -56.64741408669768, -42.946111084792044, -51.36029664575418, -61.300719271574394, -25.919985198584257, -1.1495285335799714, -48.45176331351237, 26.040470779933372, -28.093175734068385, -12.344688847414485, 22.47362409311932, -51.007533211540405, -43.55702640053894, -20.256613804540567, -54.20978428440575, -33.83814398953558, -21.996450936806514, -57.31220911921838, -69.90162843573813, -41.186192406122586, -37.23824971159922, -62.46963438701515, -25.32532399145576, -28.867690624896788, -57.711211757227275, -48.106780767377316, -55.096559143668756, -5.4824009283728685, -67.63025744835366, 28.66222814098917, -13.693246510137975, 18.121900925518304, -68.5196235498548, -4.443985863478424, -2.250749361738963, -43.663389917542254, -9.80224014885409, -10.606944967810229, -51.03141821271473, -30.825576207489014, 0.7031118665814979, 13.131297507066058, -12.728686876709972, -54.80462309809782, -32.086003021870354, -52.43910157542519, -67.33821778876572, -4.545285327254774, 1.8610849114914352, -49.962667504362955, -51.730478464963504, 46.07287137844662, -57.66568714999571, 11.187263050344342, -56.58786980661744, -21.25405015097457, -33.184589495766375, -47.085300387305914, -33.051160157010436, -61.79880440746073, -44.01268459490787, -49.71957378098288, -28.075983375607308, -35.383759596296144, -71.9472003269363, -53.54028981550189, -34.88439972787977, -24.371820896789185, -42.25122623967019, -60.823466048009195, -16.65380924360307, -20.840100461907888, 6.433644831151067, 20.56640678516217, -29.398427961519353, -39.07867046804618, -32.82479191513845, -55.63337582825405, -53.84185326699769, -35.843085599805846, -37.929919920955356, -39.678484275219695, -63.1666674672049, -18.61607356063655, -23.56342020891922, -65.32775567215934, -73.50755838118475, -60.22105080965249, -49.522631140125, -48.47395581072648, -20.959723246326938, -43.22644214841802, -31.580958799861456, -34.83087200781718], "policy_adversary_policy_reward": [-8.434049565358773, -13.970317565828783, -14.326864617014902, -28.282718112121266, 23.790094540073767, -13.895090095287403, -38.04764835111298, -13.17617129312913, -16.106907505717466, -26.124358213774077, 0.6729763256873937, -1.9758137225193249, -24.49363004660841, -32.153784040089235, -22.570195504316455, -20.375915580475592, -32.41932818775092, -18.940968458003265, -27.432045829143256, -33.86867344243119, -0.37311573783029317, -25.54686946075396, 9.821767848216162, -10.971296381796133, -31.976151130581215, -16.47561218293115, 36.37470895739112, -10.334238177457738, -28.1802551143529, 0.08707938028451423, -1.5441668606303622, -10.800521986784123, 0.8312075319120478, 21.642416561207277, -27.61438470694769, -23.393148504592723, -13.38398483672264, -30.173041563816298, -36.983518073307124, 16.726904268766546, -25.365366083752708, -28.84441820065304, -23.784903003009518, -10.053240986526063, -7.3454884990508305, -14.650962437755693, -43.638001314472184, -13.674207804746203, -36.92829578653244, -32.97333264920572, -19.52755237123981, -21.65864003488278, -20.04891834769249, -17.18933136390674, -17.58048531510547, -44.88914907190967, -5.896345346635421, -19.428978644820344, -3.2103191553990627, -25.657371469497726, -35.67330903770145, -22.037902719525835, -29.878075699750408, -18.228705067626915, -22.742959186259274, -32.35359995740949, -5.982803247730306, 0.5004023193574376, -30.661138318596343, -36.969119129757296, 13.140268132935422, 15.52196000805375, -2.337525032589639, -11.355721477548336, 5.370411032195843, 12.751489893322454, -26.841776690777266, -41.67784685907753, 6.045245803917133, -10.489231667395558, -5.905874167500302, 3.6551248057613392, -10.483604078794514, -33.17978583874774, -2.000667790706693, -7.801572358147395, -11.71382631196363, 1.1068813441534004, -19.40448093220584, -31.626937280508898, -16.406987586484703, -14.418588621004313, 6.817190022914495, -6.114078156332997, 11.811048374641885, 1.3202491324241734, -10.09366876281613, -2.635018113893823, -34.29071188327002, -20.513911214827807, -20.805207210811577, -11.280795811058773, -18.603624689072607, -33.83547688635258, -37.108442630456025, -30.229775158309707, -4.561698551803211, 0.01641322454844385, -5.30598385617621, 7.167068767667644, -40.24142220495573, -9.721245299407222, -25.901686231892512, -25.82879223307099, 50.52499176795221, -4.452120389505575, -34.848998660308, -22.816688489687714, 1.1362977807921055, 10.050965269552236, -19.4122588180675, -37.17561098854994, -7.127854912798057, -14.126195238176514, -14.99653729026834, -18.188052205498035, -22.96246663889173, -24.12283374841418, -39.58225967380559, 6.531099516795159, -49.68921425678727, -12.109590150673469, -9.449741336885083, -34.562943258022784, -31.845778464540807, -17.87379531644207, -18.907364196759097, -9.16861917884821, -16.955971434903688, -18.427788161392456, -33.096677130852946, -38.850523196083344, -17.203675012902, -36.33661480259989, -21.381171133066786, -13.503228594812978, -11.19882052250533, -13.173000374283854, -17.534428305327083, -24.716797934343106, -22.929395533315425, -37.89407051469377, -2.1733473111875057, -14.480461932415565, -13.021239359952745, -7.818861101955143, -12.628213402004638, 19.061858233155704, 6.848200066335437, 13.718206718826734, -24.230028431270522, -5.168399530248827, -3.5455064529794633, -35.533164015066724, -0.5555300111679884, -32.26926190397045, -24.476564293990954, -31.156811534263095, -31.93910028064763, -21.902752986350052, -11.613699866277429, -24.229385733528417, -18.794942950243573, -19.134976970711783, -12.139684796963156, -27.538799478256536, -34.69806030804918, -28.468607159155756, -10.991978522553566, -7.624095038082984, -8.249687597126766, -15.313732611792453, -28.319668284594652, -37.008087387564665, -28.653609574662987, -44.85394880652177, -25.404954256547384, -34.816096553105105, -43.33711646987495, -6.185514670250058, -14.718091933181618, -33.755863877544876, 12.44871411501898, -33.408437361345925, -18.378822853915366, -24.847619294502657, -5.821224876374124, -25.75973392348733, -6.303241485035178, -28.52763052278199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3925015198019823, "mean_inference_ms": 0.975147424589287, "mean_action_processing_ms": 0.16717172525104843, "mean_env_wait_ms": 0.058346789499917937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039893388748168945, "StateBufferConnector_ms": 0.0025600194931030273, "ViewRequirementAgentConnector_ms": 0.06486201286315918}, "num_episodes": 18, "episode_return_max": 92.14574275689324, "episode_return_min": -147.0151167623693, "episode_return_mean": -65.49720141039906}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 488.1514167599948, "num_env_steps_trained_throughput_per_sec": 488.1514167599948, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 8254.013, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8253.979, "sample_time_ms": 739.586, "learn_time_ms": 7502.202, "learn_throughput": 533.177, "synch_weights_time_ms": 11.803}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "training_iteration": 35, "trial_id": "eaa30_00000", "date": "2024-08-09_17-44-51", "timestamp": 1723239891, "time_this_iter_s": 8.199923038482666, "time_total_s": 283.4623427391052, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf24c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 283.4623427391052, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 23.01666666666667, "ram_util_percent": 79.79166666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.47146590777806, "cur_kl_coeff": 17.299511718750004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.237206827143512, "policy_loss": 0.007224515410110591, "vf_loss": 5.984401405677594, "vf_explained_var": 0.07749304219528481, "kl": 0.014195829754074414, "entropy": 1.4927414153618788, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.053376206507284, "cur_kl_coeff": 131.36816711425783, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.216630262136459, "policy_loss": 0.011031389975687488, "vf_loss": 7.829832798242569, "vf_explained_var": -0.013292054521540801, "kl": 0.018084793417559315, "entropy": 1.3462525717914104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 92.14574275689324, "episode_reward_min": -155.61619707465437, "episode_reward_mean": -72.49579725360829, "episode_len_mean": 192.87, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 19287, "policy_reward_min": {"agent_policy": -77.80809853732723, "adversary_policy": -49.68921425678727}, "policy_reward_max": {"agent_policy": 46.07287137844662, "adversary_policy": 50.52499176795221}, "policy_reward_mean": {"agent_policy": -36.24789862680415, "adversary_policy": -18.12394931340207}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139.8032568714764, -82.3723848122452, -74.47649942319848, -124.93926877403035, -50.65064798291152, -57.73538124979358, -115.42242351445452, -96.21356153475452, -110.19311828733748, -10.964801856745758, -135.26051489670743, 57.32445628197837, -27.38649302027595, 36.243801851036615, -137.03924709970966, -8.887971726956849, -4.501498723477926, -87.32677983508444, -19.60448029770817, -21.213889935620458, -102.06283642542945, -61.65115241497797, 1.4062237331629959, 26.262595014132096, -25.457373753419937, -109.60924619619561, -64.1720060437408, -104.87820315085031, -134.6764355775315, -9.090570654509548, 3.7221698229828846, -99.92533500872588, -103.46095692992694, 92.14574275689324, -115.33137429999144, 22.374526100688684, -113.17573961323504, -42.50810030194914, -66.36917899153272, -94.17060077461193, -66.10232031402084, -123.59760881492144, -88.02536918981582, -99.43914756196574, -56.15196675121463, -70.76751919259235, -143.89440065387274, -107.0805796310035, -69.76879945575945, -48.74364179357839, -84.5024524793404, -121.6469320960183, -33.30761848720619, -41.680200923815775, 12.867289662302124, 41.13281357032436, -58.79685592303866, -78.15734093609237, -65.6495838302769, -111.26675165650812, -107.68370653399529, -71.68617119961166, -75.85983984191067, -79.3569685504394, -126.33333493440986, -37.2321471212731, -47.12684041783844, -130.6555113443186, -147.0151167623693, -120.44210161930509, -99.04526228025006, -96.94791162145296, -41.9194464926539, -86.45288429683592, -63.16191759972297, -69.66174401563438, -11.634991617648865, -66.39974395176444, -144.9234058593854, 8.21134347500048, -132.06365238156928, -119.76161133324604, -128.69321564046544, -155.61619707465437, -121.26053831555467, 8.71868498216256, -87.52590251426489, -97.49160616390267, -94.77814256597358, -126.98699017780157, -115.34964009006137, -80.39745908324272, -94.18724221736244, -62.823676323073364, -69.39956947406809, -41.87506461622467, -134.93060117850274, -122.83647491551582, -51.64183585792927, -79.72048695710026], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 56, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 17, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-69.90162843573813, -41.186192406122586, -37.23824971159922, -62.46963438701515, -25.32532399145576, -28.867690624896788, -57.711211757227275, -48.106780767377316, -55.096559143668756, -5.4824009283728685, -67.63025744835366, 28.66222814098917, -13.693246510137975, 18.121900925518304, -68.5196235498548, -4.443985863478424, -2.250749361738963, -43.663389917542254, -9.80224014885409, -10.606944967810229, -51.03141821271473, -30.825576207489014, 0.7031118665814979, 13.131297507066058, -12.728686876709972, -54.80462309809782, -32.086003021870354, -52.43910157542519, -67.33821778876572, -4.545285327254774, 1.8610849114914352, -49.962667504362955, -51.730478464963504, 46.07287137844662, -57.66568714999571, 11.187263050344342, -56.58786980661744, -21.25405015097457, -33.184589495766375, -47.085300387305914, -33.051160157010436, -61.79880440746073, -44.01268459490787, -49.71957378098288, -28.075983375607308, -35.383759596296144, -71.9472003269363, -53.54028981550189, -34.88439972787977, -24.371820896789185, -42.25122623967019, -60.823466048009195, -16.65380924360307, -20.840100461907888, 6.433644831151067, 20.56640678516217, -29.398427961519353, -39.07867046804618, -32.82479191513845, -55.63337582825405, -53.84185326699769, -35.843085599805846, -37.929919920955356, -39.678484275219695, -63.1666674672049, -18.61607356063655, -23.56342020891922, -65.32775567215934, -73.50755838118475, -60.22105080965249, -49.522631140125, -48.47395581072648, -20.959723246326938, -43.22644214841802, -31.580958799861456, -34.83087200781718, -5.8174958088244395, -33.19987197588221, -72.46170292969288, 4.10567173750024, -66.03182619078459, -59.88080566662313, -64.34660782023272, -77.80809853732723, -60.630269157777285, 4.359342491081282, -43.7629512571324, -48.74580308195128, -47.38907128298681, -63.49349508890075, -57.67482004503075, -40.19872954162133, -47.09362110868126, -31.411838161536693, -34.699784737033994, -20.937532308112324, -67.4653005892514, -61.418237457757954, -25.820917928964626, -39.86024347855009], "policy_adversary_policy_reward": [-36.92829578653244, -32.97333264920572, -19.52755237123981, -21.65864003488278, -20.04891834769249, -17.18933136390674, -17.58048531510547, -44.88914907190967, -5.896345346635421, -19.428978644820344, -3.2103191553990627, -25.657371469497726, -35.67330903770145, -22.037902719525835, -29.878075699750408, -18.228705067626915, -22.742959186259274, -32.35359995740949, -5.982803247730306, 0.5004023193574376, -30.661138318596343, -36.969119129757296, 13.140268132935422, 15.52196000805375, -2.337525032589639, -11.355721477548336, 5.370411032195843, 12.751489893322454, -26.841776690777266, -41.67784685907753, 6.045245803917133, -10.489231667395558, -5.905874167500302, 3.6551248057613392, -10.483604078794514, -33.17978583874774, -2.000667790706693, -7.801572358147395, -11.71382631196363, 1.1068813441534004, -19.40448093220584, -31.626937280508898, -16.406987586484703, -14.418588621004313, 6.817190022914495, -6.114078156332997, 11.811048374641885, 1.3202491324241734, -10.09366876281613, -2.635018113893823, -34.29071188327002, -20.513911214827807, -20.805207210811577, -11.280795811058773, -18.603624689072607, -33.83547688635258, -37.108442630456025, -30.229775158309707, -4.561698551803211, 0.01641322454844385, -5.30598385617621, 7.167068767667644, -40.24142220495573, -9.721245299407222, -25.901686231892512, -25.82879223307099, 50.52499176795221, -4.452120389505575, -34.848998660308, -22.816688489687714, 1.1362977807921055, 10.050965269552236, -19.4122588180675, -37.17561098854994, -7.127854912798057, -14.126195238176514, -14.99653729026834, -18.188052205498035, -22.96246663889173, -24.12283374841418, -39.58225967380559, 6.531099516795159, -49.68921425678727, -12.109590150673469, -9.449741336885083, -34.562943258022784, -31.845778464540807, -17.87379531644207, -18.907364196759097, -9.16861917884821, -16.955971434903688, -18.427788161392456, -33.096677130852946, -38.850523196083344, -17.203675012902, -36.33661480259989, -21.381171133066786, -13.503228594812978, -11.19882052250533, -13.173000374283854, -17.534428305327083, -24.716797934343106, -22.929395533315425, -37.89407051469377, -2.1733473111875057, -14.480461932415565, -13.021239359952745, -7.818861101955143, -12.628213402004638, 19.061858233155704, 6.848200066335437, 13.718206718826734, -24.230028431270522, -5.168399530248827, -3.5455064529794633, -35.533164015066724, -0.5555300111679884, -32.26926190397045, -24.476564293990954, -31.156811534263095, -31.93910028064763, -21.902752986350052, -11.613699866277429, -24.229385733528417, -18.794942950243573, -19.134976970711783, -12.139684796963156, -27.538799478256536, -34.69806030804918, -28.468607159155756, -10.991978522553566, -7.624095038082984, -8.249687597126766, -15.313732611792453, -28.319668284594652, -37.008087387564665, -28.653609574662987, -44.85394880652177, -25.404954256547384, -34.816096553105105, -43.33711646987495, -6.185514670250058, -14.718091933181618, -33.755863877544876, 12.44871411501898, -33.408437361345925, -18.378822853915366, -24.847619294502657, -5.821224876374124, -25.75973392348733, -6.303241485035178, -28.52763052278199, 6.252447522572211, -12.06994333139665, 5.194374560371315, -38.394246536253526, -33.722238711623724, -38.739464218069074, 2.270074581061164, 1.835597156439075, -37.70898236221949, -28.322843828565087, -34.87421380701627, -25.00659185960683, -24.407289406918423, -39.9393184133143, -35.80273002027137, -42.00536851705576, -19.150638616319803, -41.47963054145749, -4.941418282259005, 9.300760773340288, -25.256231857161474, -18.506719399970926, -23.122010394216503, -25.623792687734806, -26.342828421200682, -21.04624286178613, -40.399969473021685, -23.093525615879127, -20.59317501218085, -37.081645032849906, -4.652581437995842, -35.54614810362549, -23.796051133476187, -23.29756997520507, -4.8972172421831885, -26.5146209193535, -29.18352733334348, -5.51625740369051, -13.583626986024463, -7.353905322087861, -29.533884837275018, -37.931415751976395, -38.4495435773527, -22.96869388040525, 4.092843598088798, -29.913761527053413, 4.467708209642176, -44.327951688192265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3919883186880142, "mean_inference_ms": 0.9734779806619239, "mean_action_processing_ms": 0.16698707949883165, "mean_env_wait_ms": 0.05824323380017136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003499627113342285, "StateBufferConnector_ms": 0.0024683475494384766, "ViewRequirementAgentConnector_ms": 0.06476366519927979}, "num_episodes": 24, "episode_return_max": 92.14574275689324, "episode_return_min": -155.61619707465437, "episode_return_mean": -72.49579725360829}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.7673916544305, "num_env_steps_trained_throughput_per_sec": 491.7673916544305, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 8230.944, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8230.91, "sample_time_ms": 733.403, "learn_time_ms": 7485.345, "learn_throughput": 534.378, "synch_weights_time_ms": 11.738}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 36, "trial_id": "eaa30_00000", "date": "2024-08-09_17-45-00", "timestamp": 1723239900, "time_this_iter_s": 8.138667106628418, "time_total_s": 291.60100984573364, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf2790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 291.60100984573364, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 24.19090909090909, "ram_util_percent": 79.86363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.173649344116292, "cur_kl_coeff": 17.299511718750004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.443967293936109, "policy_loss": 0.011899102880082354, "vf_loss": 6.032880585786526, "vf_explained_var": 0.15734494388418854, "kl": 0.02307508003173603, "entropy": 1.5052295069845896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.62084605321288, "cur_kl_coeff": 131.36816711425783, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.407501764098804, "policy_loss": -0.005538267518083255, "vf_loss": 7.405662875870863, "vf_explained_var": 0.025145247206091882, "kl": 0.015280545070224132, "entropy": 1.2698848371704419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "env_runners": {"episode_reward_max": 92.14574275689324, "episode_reward_min": -166.51093971801004, "episode_reward_mean": -79.66096615392502, "episode_len_mean": 192.87, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19287, "policy_reward_min": {"agent_policy": -83.25546985900502, "adversary_policy": -49.97516696555495}, "policy_reward_max": {"agent_policy": 46.07287137844662, "adversary_policy": 50.52499176795221}, "policy_reward_mean": {"agent_policy": -39.830483076962516, "adversary_policy": -19.915241538481254}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.06283642542945, -61.65115241497797, 1.4062237331629959, 26.262595014132096, -25.457373753419937, -109.60924619619561, -64.1720060437408, -104.87820315085031, -134.6764355775315, -9.090570654509548, 3.7221698229828846, -99.92533500872588, -103.46095692992694, 92.14574275689324, -115.33137429999144, 22.374526100688684, -113.17573961323504, -42.50810030194914, -66.36917899153272, -94.17060077461193, -66.10232031402084, -123.59760881492144, -88.02536918981582, -99.43914756196574, -56.15196675121463, -70.76751919259235, -143.89440065387274, -107.0805796310035, -69.76879945575945, -48.74364179357839, -84.5024524793404, -121.6469320960183, -33.30761848720619, -41.680200923815775, 12.867289662302124, 41.13281357032436, -58.79685592303866, -78.15734093609237, -65.6495838302769, -111.26675165650812, -107.68370653399529, -71.68617119961166, -75.85983984191067, -79.3569685504394, -126.33333493440986, -37.2321471212731, -47.12684041783844, -130.6555113443186, -147.0151167623693, -120.44210161930509, -99.04526228025006, -96.94791162145296, -41.9194464926539, -86.45288429683592, -63.16191759972297, -69.66174401563438, -11.634991617648865, -66.39974395176444, -144.9234058593854, 8.21134347500048, -132.06365238156928, -119.76161133324604, -128.69321564046544, -155.61619707465437, -121.26053831555467, 8.71868498216256, -87.52590251426489, -97.49160616390267, -94.77814256597358, -126.98699017780157, -115.34964009006137, -80.39745908324272, -94.18724221736244, -62.823676323073364, -69.39956947406809, -41.87506461622467, -134.93060117850274, -122.83647491551582, -51.64183585792927, -79.72048695710026, -42.13578731536218, -138.6404464697208, -32.51442458904527, 35.47599784956198, -127.42072908707638, -114.42491728152001, -146.12584871023478, -166.51093971801004, -145.46713544030564, -43.5867456131289, -110.17335365225364, -77.23220231018627, -99.84861609805805, -42.71832072490135, -129.49785262983215, -99.1365315386866, -111.97988874850591, -93.94120693945949, -134.1914750013418, -106.87042772308129], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 56, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 17, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-51.03141821271473, -30.825576207489014, 0.7031118665814979, 13.131297507066058, -12.728686876709972, -54.80462309809782, -32.086003021870354, -52.43910157542519, -67.33821778876572, -4.545285327254774, 1.8610849114914352, -49.962667504362955, -51.730478464963504, 46.07287137844662, -57.66568714999571, 11.187263050344342, -56.58786980661744, -21.25405015097457, -33.184589495766375, -47.085300387305914, -33.051160157010436, -61.79880440746073, -44.01268459490787, -49.71957378098288, -28.075983375607308, -35.383759596296144, -71.9472003269363, -53.54028981550189, -34.88439972787977, -24.371820896789185, -42.25122623967019, -60.823466048009195, -16.65380924360307, -20.840100461907888, 6.433644831151067, 20.56640678516217, -29.398427961519353, -39.07867046804618, -32.82479191513845, -55.63337582825405, -53.84185326699769, -35.843085599805846, -37.929919920955356, -39.678484275219695, -63.1666674672049, -18.61607356063655, -23.56342020891922, -65.32775567215934, -73.50755838118475, -60.22105080965249, -49.522631140125, -48.47395581072648, -20.959723246326938, -43.22644214841802, -31.580958799861456, -34.83087200781718, -5.8174958088244395, -33.19987197588221, -72.46170292969288, 4.10567173750024, -66.03182619078459, -59.88080566662313, -64.34660782023272, -77.80809853732723, -60.630269157777285, 4.359342491081282, -43.7629512571324, -48.74580308195128, -47.38907128298681, -63.49349508890075, -57.67482004503075, -40.19872954162133, -47.09362110868126, -31.411838161536693, -34.699784737033994, -20.937532308112324, -67.4653005892514, -61.418237457757954, -25.820917928964626, -39.86024347855009, -21.06789365768109, -69.3202232348604, -16.25721229452263, 17.737998924780943, -63.71036454353814, -57.21245864075999, -73.06292435511736, -83.25546985900502, -72.73356772015279, -21.79337280656445, -55.08667682612677, -38.61610115509316, -49.924308049029044, -21.359160362450677, -64.74892631491616, -49.568265769343284, -55.98994437425288, -46.970603469729745, -67.09573750067085, -53.435213861540625], "policy_adversary_policy_reward": [-19.40448093220584, -31.626937280508898, -16.406987586484703, -14.418588621004313, 6.817190022914495, -6.114078156332997, 11.811048374641885, 1.3202491324241734, -10.09366876281613, -2.635018113893823, -34.29071188327002, -20.513911214827807, -20.805207210811577, -11.280795811058773, -18.603624689072607, -33.83547688635258, -37.108442630456025, -30.229775158309707, -4.561698551803211, 0.01641322454844385, -5.30598385617621, 7.167068767667644, -40.24142220495573, -9.721245299407222, -25.901686231892512, -25.82879223307099, 50.52499176795221, -4.452120389505575, -34.848998660308, -22.816688489687714, 1.1362977807921055, 10.050965269552236, -19.4122588180675, -37.17561098854994, -7.127854912798057, -14.126195238176514, -14.99653729026834, -18.188052205498035, -22.96246663889173, -24.12283374841418, -39.58225967380559, 6.531099516795159, -49.68921425678727, -12.109590150673469, -9.449741336885083, -34.562943258022784, -31.845778464540807, -17.87379531644207, -18.907364196759097, -9.16861917884821, -16.955971434903688, -18.427788161392456, -33.096677130852946, -38.850523196083344, -17.203675012902, -36.33661480259989, -21.381171133066786, -13.503228594812978, -11.19882052250533, -13.173000374283854, -17.534428305327083, -24.716797934343106, -22.929395533315425, -37.89407051469377, -2.1733473111875057, -14.480461932415565, -13.021239359952745, -7.818861101955143, -12.628213402004638, 19.061858233155704, 6.848200066335437, 13.718206718826734, -24.230028431270522, -5.168399530248827, -3.5455064529794633, -35.533164015066724, -0.5555300111679884, -32.26926190397045, -24.476564293990954, -31.156811534263095, -31.93910028064763, -21.902752986350052, -11.613699866277429, -24.229385733528417, -18.794942950243573, -19.134976970711783, -12.139684796963156, -27.538799478256536, -34.69806030804918, -28.468607159155756, -10.991978522553566, -7.624095038082984, -8.249687597126766, -15.313732611792453, -28.319668284594652, -37.008087387564665, -28.653609574662987, -44.85394880652177, -25.404954256547384, -34.816096553105105, -43.33711646987495, -6.185514670250058, -14.718091933181618, -33.755863877544876, 12.44871411501898, -33.408437361345925, -18.378822853915366, -24.847619294502657, -5.821224876374124, -25.75973392348733, -6.303241485035178, -28.52763052278199, 6.252447522572211, -12.06994333139665, 5.194374560371315, -38.394246536253526, -33.722238711623724, -38.739464218069074, 2.270074581061164, 1.835597156439075, -37.70898236221949, -28.322843828565087, -34.87421380701627, -25.00659185960683, -24.407289406918423, -39.9393184133143, -35.80273002027137, -42.00536851705576, -19.150638616319803, -41.47963054145749, -4.941418282259005, 9.300760773340288, -25.256231857161474, -18.506719399970926, -23.122010394216503, -25.623792687734806, -26.342828421200682, -21.04624286178613, -40.399969473021685, -23.093525615879127, -20.59317501218085, -37.081645032849906, -4.652581437995842, -35.54614810362549, -23.796051133476187, -23.29756997520507, -4.8972172421831885, -26.5146209193535, -29.18352733334348, -5.51625740369051, -13.583626986024463, -7.353905322087861, -29.533884837275018, -37.931415751976395, -38.4495435773527, -22.96869388040525, 4.092843598088798, -29.913761527053413, 4.467708209642176, -44.327951688192265, -11.559510003200238, -9.508383654480852, -45.69146820373362, -23.628755031126754, -27.34639389059626, 11.08918159607363, 16.035820242391804, 1.7021786823891318, -36.30834921185448, -27.402015331683657, -24.525630150644783, -32.686828490115204, -40.93520523014642, -32.127719124971, -49.97516696555495, -33.28030289345011, -35.87586224421879, -36.85770547593398, -2.8800838637133666, -18.913288942851082, -21.172435118829064, -33.9142417072977, -20.595863836993487, -18.020237318099674, -29.436892207827775, -20.487415841201265, -1.9475180182879086, -19.411642344162768, -41.457364823539315, -23.291561491376818, -7.575494148930957, -41.99277162041233, -25.013145956459482, -30.976798417793397, -21.434832377768892, -25.535771091960857, -35.97215308720604, -31.12358441346479, -41.69939091425771, -11.735822947282905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3917533186014485, "mean_inference_ms": 0.9723999782597457, "mean_action_processing_ms": 0.1667571770923187, "mean_env_wait_ms": 0.058162360996442716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034623146057128906, "StateBufferConnector_ms": 0.0025262832641601562, "ViewRequirementAgentConnector_ms": 0.06599020957946777}, "num_episodes": 20, "episode_return_max": 92.14574275689324, "episode_return_min": -166.51093971801004, "episode_return_mean": -79.66096615392502}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.31040128263544, "num_env_steps_trained_throughput_per_sec": 485.31040128263544, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 444000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 8242.9, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8242.866, "sample_time_ms": 734.393, "learn_time_ms": 7496.293, "learn_throughput": 533.597, "synch_weights_time_ms": 11.707}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "training_iteration": 37, "trial_id": "eaa30_00000", "date": "2024-08-09_17-45-08", "timestamp": 1723239908, "time_this_iter_s": 8.247562885284424, "time_total_s": 299.84857273101807, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf29d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 299.84857273101807, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 22.416666666666668, "ram_util_percent": 79.84166666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.908021453574852, "cur_kl_coeff": 25.949267578124992, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.222745026734771, "policy_loss": 0.0006087780155231634, "vf_loss": 5.854538038798741, "vf_explained_var": 0.23123859971288652, "kl": 0.014166033342382107, "entropy": 1.5210706672340475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.95980979949236, "cur_kl_coeff": 131.36816711425783, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.686456075807412, "policy_loss": -0.004071391015895642, "vf_loss": 6.763682187596957, "vf_explained_var": 0.10321177368362745, "kl": 0.014667520983493887, "entropy": 1.2267094215999046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "env_runners": {"episode_reward_max": 41.13281357032436, "episode_reward_min": -166.51093971801004, "episode_reward_mean": -84.82508054902792, "episode_len_mean": 190.56, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19056, "policy_reward_min": {"agent_policy": -83.25546985900502, "adversary_policy": -49.97516696555495}, "policy_reward_max": {"agent_policy": 20.56640678516217, "adversary_policy": 19.061858233155704}, "policy_reward_mean": {"agent_policy": -42.41254027451396, "adversary_policy": -21.20627013725698}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88.02536918981582, -99.43914756196574, -56.15196675121463, -70.76751919259235, -143.89440065387274, -107.0805796310035, -69.76879945575945, -48.74364179357839, -84.5024524793404, -121.6469320960183, -33.30761848720619, -41.680200923815775, 12.867289662302124, 41.13281357032436, -58.79685592303866, -78.15734093609237, -65.6495838302769, -111.26675165650812, -107.68370653399529, -71.68617119961166, -75.85983984191067, -79.3569685504394, -126.33333493440986, -37.2321471212731, -47.12684041783844, -130.6555113443186, -147.0151167623693, -120.44210161930509, -99.04526228025006, -96.94791162145296, -41.9194464926539, -86.45288429683592, -63.16191759972297, -69.66174401563438, -11.634991617648865, -66.39974395176444, -144.9234058593854, 8.21134347500048, -132.06365238156928, -119.76161133324604, -128.69321564046544, -155.61619707465437, -121.26053831555467, 8.71868498216256, -87.52590251426489, -97.49160616390267, -94.77814256597358, -126.98699017780157, -115.34964009006137, -80.39745908324272, -94.18724221736244, -62.823676323073364, -69.39956947406809, -41.87506461622467, -134.93060117850274, -122.83647491551582, -51.64183585792927, -79.72048695710026, -42.13578731536218, -138.6404464697208, -32.51442458904527, 35.47599784956198, -127.42072908707638, -114.42491728152001, -146.12584871023478, -166.51093971801004, -145.46713544030564, -43.5867456131289, -110.17335365225364, -77.23220231018627, -99.84861609805805, -42.71832072490135, -129.49785262983215, -99.1365315386866, -111.97988874850591, -93.94120693945949, -134.1914750013418, -106.87042772308129, -141.9711498280404, -82.30610784920295, -57.37501915322376, -67.47986527981496, -70.94618814907585, -92.46915398153612, -110.28623785230374, -100.99312507350228, -109.11255876570536, -71.25425158871579, -101.35320179527929, -71.22382816437198, -58.801900030345365, -138.89568458907684, -91.7117739111319, -133.50864937284976, 10.214929204454668, 4.427656880982402, -112.10692504910281, -57.17946721183604, -81.19256896524288, -71.2141508230779], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 17, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 6, 19, 200, 200, 200, 200], "policy_agent_policy_reward": [-44.01268459490787, -49.71957378098288, -28.075983375607308, -35.383759596296144, -71.9472003269363, -53.54028981550189, -34.88439972787977, -24.371820896789185, -42.25122623967019, -60.823466048009195, -16.65380924360307, -20.840100461907888, 6.433644831151067, 20.56640678516217, -29.398427961519353, -39.07867046804618, -32.82479191513845, -55.63337582825405, -53.84185326699769, -35.843085599805846, -37.929919920955356, -39.678484275219695, -63.1666674672049, -18.61607356063655, -23.56342020891922, -65.32775567215934, -73.50755838118475, -60.22105080965249, -49.522631140125, -48.47395581072648, -20.959723246326938, -43.22644214841802, -31.580958799861456, -34.83087200781718, -5.8174958088244395, -33.19987197588221, -72.46170292969288, 4.10567173750024, -66.03182619078459, -59.88080566662313, -64.34660782023272, -77.80809853732723, -60.630269157777285, 4.359342491081282, -43.7629512571324, -48.74580308195128, -47.38907128298681, -63.49349508890075, -57.67482004503075, -40.19872954162133, -47.09362110868126, -31.411838161536693, -34.699784737033994, -20.937532308112324, -67.4653005892514, -61.418237457757954, -25.820917928964626, -39.86024347855009, -21.06789365768109, -69.3202232348604, -16.25721229452263, 17.737998924780943, -63.71036454353814, -57.21245864075999, -73.06292435511736, -83.25546985900502, -72.73356772015279, -21.79337280656445, -55.08667682612677, -38.61610115509316, -49.924308049029044, -21.359160362450677, -64.74892631491616, -49.568265769343284, -55.98994437425288, -46.970603469729745, -67.09573750067085, -53.435213861540625, -70.98557491402033, -41.15305392460155, -28.687509576611895, -33.739932639907536, -35.47309407453797, -46.23457699076807, -55.14311892615191, -50.49656253675108, -54.55627938285277, -35.62712579435788, -50.67660089763976, -35.611914082186004, -29.4009500151727, -69.44784229453836, -45.85588695556593, -66.7543246864249, 5.107464602227333, 2.213828440491201, -56.05346252455133, -28.589733605918013, -40.59628448262144, -35.60707541153892], "policy_adversary_policy_reward": [-9.449741336885083, -34.562943258022784, -31.845778464540807, -17.87379531644207, -18.907364196759097, -9.16861917884821, -16.955971434903688, -18.427788161392456, -33.096677130852946, -38.850523196083344, -17.203675012902, -36.33661480259989, -21.381171133066786, -13.503228594812978, -11.19882052250533, -13.173000374283854, -17.534428305327083, -24.716797934343106, -22.929395533315425, -37.89407051469377, -2.1733473111875057, -14.480461932415565, -13.021239359952745, -7.818861101955143, -12.628213402004638, 19.061858233155704, 6.848200066335437, 13.718206718826734, -24.230028431270522, -5.168399530248827, -3.5455064529794633, -35.533164015066724, -0.5555300111679884, -32.26926190397045, -24.476564293990954, -31.156811534263095, -31.93910028064763, -21.902752986350052, -11.613699866277429, -24.229385733528417, -18.794942950243573, -19.134976970711783, -12.139684796963156, -27.538799478256536, -34.69806030804918, -28.468607159155756, -10.991978522553566, -7.624095038082984, -8.249687597126766, -15.313732611792453, -28.319668284594652, -37.008087387564665, -28.653609574662987, -44.85394880652177, -25.404954256547384, -34.816096553105105, -43.33711646987495, -6.185514670250058, -14.718091933181618, -33.755863877544876, 12.44871411501898, -33.408437361345925, -18.378822853915366, -24.847619294502657, -5.821224876374124, -25.75973392348733, -6.303241485035178, -28.52763052278199, 6.252447522572211, -12.06994333139665, 5.194374560371315, -38.394246536253526, -33.722238711623724, -38.739464218069074, 2.270074581061164, 1.835597156439075, -37.70898236221949, -28.322843828565087, -34.87421380701627, -25.00659185960683, -24.407289406918423, -39.9393184133143, -35.80273002027137, -42.00536851705576, -19.150638616319803, -41.47963054145749, -4.941418282259005, 9.300760773340288, -25.256231857161474, -18.506719399970926, -23.122010394216503, -25.623792687734806, -26.342828421200682, -21.04624286178613, -40.399969473021685, -23.093525615879127, -20.59317501218085, -37.081645032849906, -4.652581437995842, -35.54614810362549, -23.796051133476187, -23.29756997520507, -4.8972172421831885, -26.5146209193535, -29.18352733334348, -5.51625740369051, -13.583626986024463, -7.353905322087861, -29.533884837275018, -37.931415751976395, -38.4495435773527, -22.96869388040525, 4.092843598088798, -29.913761527053413, 4.467708209642176, -44.327951688192265, -11.559510003200238, -9.508383654480852, -45.69146820373362, -23.628755031126754, -27.34639389059626, 11.08918159607363, 16.035820242391804, 1.7021786823891318, -36.30834921185448, -27.402015331683657, -24.525630150644783, -32.686828490115204, -40.93520523014642, -32.127719124971, -49.97516696555495, -33.28030289345011, -35.87586224421879, -36.85770547593398, -2.8800838637133666, -18.913288942851082, -21.172435118829064, -33.9142417072977, -20.595863836993487, -18.020237318099674, -29.436892207827775, -20.487415841201265, -1.9475180182879086, -19.411642344162768, -41.457364823539315, -23.291561491376818, -7.575494148930957, -41.99277162041233, -25.013145956459482, -30.976798417793397, -21.434832377768892, -25.535771091960857, -35.97215308720604, -31.12358441346479, -41.69939091425771, -11.735822947282905, -36.13172397040319, -34.85385094361711, -10.225251757559612, -30.927802167041932, -18.031459320013802, -10.656050256598093, -24.112408218916098, -9.627524420991438, -16.58095681153062, -18.89213726300735, -16.53526733490216, -29.69930965586592, -24.744037289071464, -30.39908163708044, -28.85559716356004, -21.640965373191037, -25.402032820274815, -29.154246562577953, -37.19472972175449, 1.5676039273966111, -31.204104909718644, -19.472495987921107, -0.6600468356121993, -34.9518672465738, -22.64580948354319, -6.755140531629497, -39.898483333456625, -29.54935896108176, -22.85476509213236, -23.001121863433568, -26.730170541840703, -40.02415414458421, 4.559751145218355, 0.5477134570089781, -12.623284791301634, 14.837113231792832, -29.3607022420421, -26.692760282509226, -16.08759618014011, -12.502137425777903, -17.155741698627537, -23.440542783993887, -9.911493957850062, -25.69558145368886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3914133755606894, "mean_inference_ms": 0.9718096899325656, "mean_action_processing_ms": 0.16665398950270535, "mean_env_wait_ms": 0.05805550270514567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033338069915771484, "StateBufferConnector_ms": 0.0024886131286621094, "ViewRequirementAgentConnector_ms": 0.06639993190765381}, "num_episodes": 22, "episode_return_max": 41.13281357032436, "episode_return_min": -166.51093971801004, "episode_return_mean": -84.82508054902792}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 473.0221278577265, "num_env_steps_trained_throughput_per_sec": 473.0221278577265, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 8261.315, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8261.282, "sample_time_ms": 734.338, "learn_time_ms": 7514.639, "learn_throughput": 532.294, "synch_weights_time_ms": 11.762}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "training_iteration": 38, "trial_id": "eaa30_00000", "date": "2024-08-09_17-45-16", "timestamp": 1723239916, "time_this_iter_s": 8.461832761764526, "time_total_s": 308.3104054927826, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fca00d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 308.3104054927826, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 25.791666666666668, "ram_util_percent": 80.05833333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.743944163044924, "cur_kl_coeff": 25.949267578124992, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.367392465298769, "policy_loss": -0.0027314562845738633, "vf_loss": 6.1919631455941175, "vf_explained_var": 0.29667858686396686, "kl": 0.006865733866358087, "entropy": 1.5258634201433292, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.788024575511614, "cur_kl_coeff": 131.36816711425783, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.325905655821165, "policy_loss": -0.007682069779548328, "vf_loss": 7.687130804359913, "vf_explained_var": 0.00278016384691, "kl": 0.012533150165594028, "entropy": 1.1400121373434862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "env_runners": {"episode_reward_max": 35.47599784956198, "episode_reward_min": -166.51093971801004, "episode_reward_mean": -90.26583812825518, "episode_len_mean": 190.4, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19040, "policy_reward_min": {"agent_policy": -83.25546985900502, "adversary_policy": -49.97516696555495}, "policy_reward_max": {"agent_policy": 17.737998924780943, "adversary_policy": 16.035820242391804}, "policy_reward_mean": {"agent_policy": -45.13291906412759, "adversary_policy": -22.566459532063792}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-75.85983984191067, -79.3569685504394, -126.33333493440986, -37.2321471212731, -47.12684041783844, -130.6555113443186, -147.0151167623693, -120.44210161930509, -99.04526228025006, -96.94791162145296, -41.9194464926539, -86.45288429683592, -63.16191759972297, -69.66174401563438, -11.634991617648865, -66.39974395176444, -144.9234058593854, 8.21134347500048, -132.06365238156928, -119.76161133324604, -128.69321564046544, -155.61619707465437, -121.26053831555467, 8.71868498216256, -87.52590251426489, -97.49160616390267, -94.77814256597358, -126.98699017780157, -115.34964009006137, -80.39745908324272, -94.18724221736244, -62.823676323073364, -69.39956947406809, -41.87506461622467, -134.93060117850274, -122.83647491551582, -51.64183585792927, -79.72048695710026, -42.13578731536218, -138.6404464697208, -32.51442458904527, 35.47599784956198, -127.42072908707638, -114.42491728152001, -146.12584871023478, -166.51093971801004, -145.46713544030564, -43.5867456131289, -110.17335365225364, -77.23220231018627, -99.84861609805805, -42.71832072490135, -129.49785262983215, -99.1365315386866, -111.97988874850591, -93.94120693945949, -134.1914750013418, -106.87042772308129, -141.9711498280404, -82.30610784920295, -57.37501915322376, -67.47986527981496, -70.94618814907585, -92.46915398153612, -110.28623785230374, -100.99312507350228, -109.11255876570536, -71.25425158871579, -101.35320179527929, -71.22382816437198, -58.801900030345365, -138.89568458907684, -91.7117739111319, -133.50864937284976, 10.214929204454668, 4.427656880982402, -112.10692504910281, -57.17946721183604, -81.19256896524288, -71.2141508230779, -122.11998942620326, -161.14180557745505, -136.87077765163076, -131.01829883206494, -96.11010028397033, -128.0345738556079, -148.33885513828704, -112.15221640607028, -86.7596787560565, -125.74745468873073, -56.930393655903316, 4.776071930831533, -79.10745712314447, -119.1522069990148, -81.13316435805706, -87.81957276710773, -76.36643290029423, -124.34262557020905, -19.808242321711617, -60.14691860511829], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 6, 19, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-37.929919920955356, -39.678484275219695, -63.1666674672049, -18.61607356063655, -23.56342020891922, -65.32775567215934, -73.50755838118475, -60.22105080965249, -49.522631140125, -48.47395581072648, -20.959723246326938, -43.22644214841802, -31.580958799861456, -34.83087200781718, -5.8174958088244395, -33.19987197588221, -72.46170292969288, 4.10567173750024, -66.03182619078459, -59.88080566662313, -64.34660782023272, -77.80809853732723, -60.630269157777285, 4.359342491081282, -43.7629512571324, -48.74580308195128, -47.38907128298681, -63.49349508890075, -57.67482004503075, -40.19872954162133, -47.09362110868126, -31.411838161536693, -34.699784737033994, -20.937532308112324, -67.4653005892514, -61.418237457757954, -25.820917928964626, -39.86024347855009, -21.06789365768109, -69.3202232348604, -16.25721229452263, 17.737998924780943, -63.71036454353814, -57.21245864075999, -73.06292435511736, -83.25546985900502, -72.73356772015279, -21.79337280656445, -55.08667682612677, -38.61610115509316, -49.924308049029044, -21.359160362450677, -64.74892631491616, -49.568265769343284, -55.98994437425288, -46.970603469729745, -67.09573750067085, -53.435213861540625, -70.98557491402033, -41.15305392460155, -28.687509576611895, -33.739932639907536, -35.47309407453797, -46.23457699076807, -55.14311892615191, -50.49656253675108, -54.55627938285277, -35.62712579435788, -50.67660089763976, -35.611914082186004, -29.4009500151727, -69.44784229453836, -45.85588695556593, -66.7543246864249, 5.107464602227333, 2.213828440491201, -56.05346252455133, -28.589733605918013, -40.59628448262144, -35.60707541153892, -61.05999471310163, -80.57090278872745, -68.43538882581534, -65.50914941603247, -48.05505014198519, -64.0172869278041, -74.1694275691435, -56.076108203035076, -43.379839378028166, -62.873727344365314, -28.465196827951708, 2.3880359654157663, -39.553728561572264, -59.5761034995075, -40.56658217902843, -43.909786383553886, -38.18321645014711, -62.17131278510451, -9.904121160855809, -30.073459302559115], "policy_adversary_policy_reward": [-18.794942950243573, -19.134976970711783, -12.139684796963156, -27.538799478256536, -34.69806030804918, -28.468607159155756, -10.991978522553566, -7.624095038082984, -8.249687597126766, -15.313732611792453, -28.319668284594652, -37.008087387564665, -28.653609574662987, -44.85394880652177, -25.404954256547384, -34.816096553105105, -43.33711646987495, -6.185514670250058, -14.718091933181618, -33.755863877544876, 12.44871411501898, -33.408437361345925, -18.378822853915366, -24.847619294502657, -5.821224876374124, -25.75973392348733, -6.303241485035178, -28.52763052278199, 6.252447522572211, -12.06994333139665, 5.194374560371315, -38.394246536253526, -33.722238711623724, -38.739464218069074, 2.270074581061164, 1.835597156439075, -37.70898236221949, -28.322843828565087, -34.87421380701627, -25.00659185960683, -24.407289406918423, -39.9393184133143, -35.80273002027137, -42.00536851705576, -19.150638616319803, -41.47963054145749, -4.941418282259005, 9.300760773340288, -25.256231857161474, -18.506719399970926, -23.122010394216503, -25.623792687734806, -26.342828421200682, -21.04624286178613, -40.399969473021685, -23.093525615879127, -20.59317501218085, -37.081645032849906, -4.652581437995842, -35.54614810362549, -23.796051133476187, -23.29756997520507, -4.8972172421831885, -26.5146209193535, -29.18352733334348, -5.51625740369051, -13.583626986024463, -7.353905322087861, -29.533884837275018, -37.931415751976395, -38.4495435773527, -22.96869388040525, 4.092843598088798, -29.913761527053413, 4.467708209642176, -44.327951688192265, -11.559510003200238, -9.508383654480852, -45.69146820373362, -23.628755031126754, -27.34639389059626, 11.08918159607363, 16.035820242391804, 1.7021786823891318, -36.30834921185448, -27.402015331683657, -24.525630150644783, -32.686828490115204, -40.93520523014642, -32.127719124971, -49.97516696555495, -33.28030289345011, -35.87586224421879, -36.85770547593398, -2.8800838637133666, -18.913288942851082, -21.172435118829064, -33.9142417072977, -20.595863836993487, -18.020237318099674, -29.436892207827775, -20.487415841201265, -1.9475180182879086, -19.411642344162768, -41.457364823539315, -23.291561491376818, -7.575494148930957, -41.99277162041233, -25.013145956459482, -30.976798417793397, -21.434832377768892, -25.535771091960857, -35.97215308720604, -31.12358441346479, -41.69939091425771, -11.735822947282905, -36.13172397040319, -34.85385094361711, -10.225251757559612, -30.927802167041932, -18.031459320013802, -10.656050256598093, -24.112408218916098, -9.627524420991438, -16.58095681153062, -18.89213726300735, -16.53526733490216, -29.69930965586592, -24.744037289071464, -30.39908163708044, -28.85559716356004, -21.640965373191037, -25.402032820274815, -29.154246562577953, -37.19472972175449, 1.5676039273966111, -31.204104909718644, -19.472495987921107, -0.6600468356121993, -34.9518672465738, -22.64580948354319, -6.755140531629497, -39.898483333456625, -29.54935896108176, -22.85476509213236, -23.001121863433568, -26.730170541840703, -40.02415414458421, 4.559751145218355, 0.5477134570089781, -12.623284791301634, 14.837113231792832, -29.3607022420421, -26.692760282509226, -16.08759618014011, -12.502137425777903, -17.155741698627537, -23.440542783993887, -9.911493957850062, -25.69558145368886, -46.630313417032916, -14.429681296068715, -36.99474842019734, -43.57615436853013, -45.8799828993038, -22.55540592651157, -31.265497386267754, -34.243652029764746, -31.16581389697683, -16.889236245008362, -18.976095825563334, -45.04119110224074, -43.95400030063439, -30.21542726850906, -35.10672225776268, -20.969385945272403, -30.44847473070788, -12.931364647320287, -29.78135905950028, -33.09236828486508, -17.77492270421827, -10.690274123733438, 0.3883728138669713, 1.9996631515487948, -21.598968950256545, -17.95475961131573, -19.46767361531336, -40.10842988419416, -18.59820245078918, -21.96837972823925, -1.380158078962907, -42.52962830459097, 2.8183332593510926, -41.0015497094982, -31.575279580513754, -30.59603320459076, -8.76192951011658, -1.1421916507392282, -8.951566368104473, -21.121892934454646]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3911764039368037, "mean_inference_ms": 0.9710275283732421, "mean_action_processing_ms": 0.16650649947806298, "mean_env_wait_ms": 0.0579925745822169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003229379653930664, "StateBufferConnector_ms": 0.002496004104614258, "ViewRequirementAgentConnector_ms": 0.06509792804718018}, "num_episodes": 20, "episode_return_max": 35.47599784956198, "episode_return_min": -166.51093971801004, "episode_return_mean": -90.26583812825518}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 475.6382754123069, "num_env_steps_trained_throughput_per_sec": 475.6382754123069, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 468000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 8284.557, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8284.523, "sample_time_ms": 737.497, "learn_time_ms": 7534.718, "learn_throughput": 530.876, "synch_weights_time_ms": 11.761}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "training_iteration": 39, "trial_id": "eaa30_00000", "date": "2024-08-09_17-45-25", "timestamp": 1723239925, "time_this_iter_s": 8.414925813674927, "time_total_s": 316.7253313064575, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf2a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 316.7253313064575, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 28.38461538461538, "ram_util_percent": 80.67692307692309}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.123983886506823, "cur_kl_coeff": 25.949267578124992, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.353611885555207, "policy_loss": -0.002250501999592103, "vf_loss": 6.1529768873144075, "vf_explained_var": 0.06366347020896024, "kl": 0.00781854430100235, "entropy": 1.5325832369466308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.887128860255082, "cur_kl_coeff": 131.36816711425783, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.499723792572816, "policy_loss": 0.0026816817682023004, "vf_loss": 7.63489053795735, "vf_explained_var": 0.1727678680792451, "kl": 0.0065628653634727625, "entropy": 1.0475913895914952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 72.94900242863238, "episode_reward_min": -166.51093971801004, "episode_reward_mean": -88.90342291200652, "episode_len_mean": 188.87, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18887, "policy_reward_min": {"agent_policy": -83.25546985900502, "adversary_policy": -51.269662067891474}, "policy_reward_max": {"agent_policy": 36.474501214316184, "adversary_policy": 34.20488676885205}, "policy_reward_mean": {"agent_policy": -44.45171145600326, "adversary_policy": -22.225855728001626}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.71868498216256, -87.52590251426489, -97.49160616390267, -94.77814256597358, -126.98699017780157, -115.34964009006137, -80.39745908324272, -94.18724221736244, -62.823676323073364, -69.39956947406809, -41.87506461622467, -134.93060117850274, -122.83647491551582, -51.64183585792927, -79.72048695710026, -42.13578731536218, -138.6404464697208, -32.51442458904527, 35.47599784956198, -127.42072908707638, -114.42491728152001, -146.12584871023478, -166.51093971801004, -145.46713544030564, -43.5867456131289, -110.17335365225364, -77.23220231018627, -99.84861609805805, -42.71832072490135, -129.49785262983215, -99.1365315386866, -111.97988874850591, -93.94120693945949, -134.1914750013418, -106.87042772308129, -141.9711498280404, -82.30610784920295, -57.37501915322376, -67.47986527981496, -70.94618814907585, -92.46915398153612, -110.28623785230374, -100.99312507350228, -109.11255876570536, -71.25425158871579, -101.35320179527929, -71.22382816437198, -58.801900030345365, -138.89568458907684, -91.7117739111319, -133.50864937284976, 10.214929204454668, 4.427656880982402, -112.10692504910281, -57.17946721183604, -81.19256896524288, -71.2141508230779, -122.11998942620326, -161.14180557745505, -136.87077765163076, -131.01829883206494, -96.11010028397033, -128.0345738556079, -148.33885513828704, -112.15221640607028, -86.7596787560565, -125.74745468873073, -56.930393655903316, 4.776071930831533, -79.10745712314447, -119.1522069990148, -81.13316435805706, -87.81957276710773, -76.36643290029423, -124.34262557020905, -19.808242321711617, -60.14691860511829, -50.54570797163059, -68.14250116191869, -83.97229972963902, -136.8706616694583, 72.94900242863238, -17.520385894902176, -136.85763711995247, -77.56169010861467, -64.33435006540498, -149.55102181597852, -117.73858219830012, -121.18467412893418, -42.15386402910403, -145.56543620906473, 21.905466790599288, -94.43928615429357, -62.41055573059929, -114.82997475486704, -139.36513196895976, -128.0727998374066, -32.50496702322113, -120.01223571981808, -148.33222390000014], "episode_lengths": [11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 6, 19, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4.359342491081282, -43.7629512571324, -48.74580308195128, -47.38907128298681, -63.49349508890075, -57.67482004503075, -40.19872954162133, -47.09362110868126, -31.411838161536693, -34.699784737033994, -20.937532308112324, -67.4653005892514, -61.418237457757954, -25.820917928964626, -39.86024347855009, -21.06789365768109, -69.3202232348604, -16.25721229452263, 17.737998924780943, -63.71036454353814, -57.21245864075999, -73.06292435511736, -83.25546985900502, -72.73356772015279, -21.79337280656445, -55.08667682612677, -38.61610115509316, -49.924308049029044, -21.359160362450677, -64.74892631491616, -49.568265769343284, -55.98994437425288, -46.970603469729745, -67.09573750067085, -53.435213861540625, -70.98557491402033, -41.15305392460155, -28.687509576611895, -33.739932639907536, -35.47309407453797, -46.23457699076807, -55.14311892615191, -50.49656253675108, -54.55627938285277, -35.62712579435788, -50.67660089763976, -35.611914082186004, -29.4009500151727, -69.44784229453836, -45.85588695556593, -66.7543246864249, 5.107464602227333, 2.213828440491201, -56.05346252455133, -28.589733605918013, -40.59628448262144, -35.60707541153892, -61.05999471310163, -80.57090278872745, -68.43538882581534, -65.50914941603247, -48.05505014198519, -64.0172869278041, -74.1694275691435, -56.076108203035076, -43.379839378028166, -62.873727344365314, -28.465196827951708, 2.3880359654157663, -39.553728561572264, -59.5761034995075, -40.56658217902843, -43.909786383553886, -38.18321645014711, -62.17131278510451, -9.904121160855809, -30.073459302559115, -25.272853985815306, -34.07125058095933, -41.986149864819474, -68.43533083472917, 36.474501214316184, -8.760192947451088, -68.42881855997629, -38.780845054307306, -32.16717503270249, -74.7755109079892, -58.86929109915007, -60.59233706446714, -21.076932014551986, -72.7827181045323, 10.952733395299642, -47.219643077146834, -31.205277865299646, -57.41498737743348, -69.68256598447977, -64.03639991870335, -16.252483511610563, -60.006117859909, -74.16611195000007], "policy_adversary_policy_reward": [-4.941418282259005, 9.300760773340288, -25.256231857161474, -18.506719399970926, -23.122010394216503, -25.623792687734806, -26.342828421200682, -21.04624286178613, -40.399969473021685, -23.093525615879127, -20.59317501218085, -37.081645032849906, -4.652581437995842, -35.54614810362549, -23.796051133476187, -23.29756997520507, -4.8972172421831885, -26.5146209193535, -29.18352733334348, -5.51625740369051, -13.583626986024463, -7.353905322087861, -29.533884837275018, -37.931415751976395, -38.4495435773527, -22.96869388040525, 4.092843598088798, -29.913761527053413, 4.467708209642176, -44.327951688192265, -11.559510003200238, -9.508383654480852, -45.69146820373362, -23.628755031126754, -27.34639389059626, 11.08918159607363, 16.035820242391804, 1.7021786823891318, -36.30834921185448, -27.402015331683657, -24.525630150644783, -32.686828490115204, -40.93520523014642, -32.127719124971, -49.97516696555495, -33.28030289345011, -35.87586224421879, -36.85770547593398, -2.8800838637133666, -18.913288942851082, -21.172435118829064, -33.9142417072977, -20.595863836993487, -18.020237318099674, -29.436892207827775, -20.487415841201265, -1.9475180182879086, -19.411642344162768, -41.457364823539315, -23.291561491376818, -7.575494148930957, -41.99277162041233, -25.013145956459482, -30.976798417793397, -21.434832377768892, -25.535771091960857, -35.97215308720604, -31.12358441346479, -41.69939091425771, -11.735822947282905, -36.13172397040319, -34.85385094361711, -10.225251757559612, -30.927802167041932, -18.031459320013802, -10.656050256598093, -24.112408218916098, -9.627524420991438, -16.58095681153062, -18.89213726300735, -16.53526733490216, -29.69930965586592, -24.744037289071464, -30.39908163708044, -28.85559716356004, -21.640965373191037, -25.402032820274815, -29.154246562577953, -37.19472972175449, 1.5676039273966111, -31.204104909718644, -19.472495987921107, -0.6600468356121993, -34.9518672465738, -22.64580948354319, -6.755140531629497, -39.898483333456625, -29.54935896108176, -22.85476509213236, -23.001121863433568, -26.730170541840703, -40.02415414458421, 4.559751145218355, 0.5477134570089781, -12.623284791301634, 14.837113231792832, -29.3607022420421, -26.692760282509226, -16.08759618014011, -12.502137425777903, -17.155741698627537, -23.440542783993887, -9.911493957850062, -25.69558145368886, -46.630313417032916, -14.429681296068715, -36.99474842019734, -43.57615436853013, -45.8799828993038, -22.55540592651157, -31.265497386267754, -34.243652029764746, -31.16581389697683, -16.889236245008362, -18.976095825563334, -45.04119110224074, -43.95400030063439, -30.21542726850906, -35.10672225776268, -20.969385945272403, -30.44847473070788, -12.931364647320287, -29.78135905950028, -33.09236828486508, -17.77492270421827, -10.690274123733438, 0.3883728138669713, 1.9996631515487948, -21.598968950256545, -17.95475961131573, -19.46767361531336, -40.10842988419416, -18.59820245078918, -21.96837972823925, -1.380158078962907, -42.52962830459097, 2.8183332593510926, -41.0015497094982, -31.575279580513754, -30.59603320459076, -8.76192951011658, -1.1421916507392282, -8.951566368104473, -21.121892934454646, 14.881191851514664, -40.15404583732997, -38.977183583960056, 4.905933003000726, -21.50472991012061, -20.481419954698865, -25.936112126852137, -42.49921870787704, 2.269614445464148, 34.20488676885205, -1.54879769081073, -7.211395256640358, -23.70087311429841, -44.72794544567788, -11.24038943899873, -27.54045561530859, 1.0332777840250742, -33.20045281672756, -43.726678619779484, -31.04883228820976, -23.105720820622658, -35.76357027852741, -35.54174840674701, -25.050588657720116, -18.440197400815723, -2.636734613736266, -40.40030155112186, -32.38241655341042, 16.15477651718953, -5.202043121889886, -25.449617901164935, -21.77002517598187, -18.811395144707657, -12.393882720591993, -29.849316253554814, -27.565671123878662, -36.03924872632024, -33.643317258159534, -33.58951303886471, -30.44688687983864, -8.840557264161113, -7.4119262474494505, -34.454497997372705, -25.551619862536317, -22.89644988210859, -51.269662067891474]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39091678351809306, "mean_inference_ms": 0.9712311928584891, "mean_action_processing_ms": 0.1662311481474786, "mean_env_wait_ms": 0.05787956700620214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032242536544799805, "StateBufferConnector_ms": 0.0025788545608520508, "ViewRequirementAgentConnector_ms": 0.064217209815979}, "num_episodes": 23, "episode_return_max": 72.94900242863238, "episode_return_min": -166.51093971801004, "episode_return_mean": -88.90342291200652}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 466.44900809339913, "num_env_steps_trained_throughput_per_sec": 466.44900809339913, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 8336.791, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8336.757, "sample_time_ms": 739.145, "learn_time_ms": 7585.267, "learn_throughput": 527.338, "synch_weights_time_ms": 11.798}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 40, "trial_id": "eaa30_00000", "date": "2024-08-09_17-45-34", "timestamp": 1723239934, "time_this_iter_s": 8.581517696380615, "time_total_s": 325.30684900283813, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf2c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 325.30684900283813, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 23.60833333333333, "ram_util_percent": 80.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.591211544899713, "cur_kl_coeff": 25.949267578124992, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.288028254080071, "policy_loss": 0.0009070702589476708, "vf_loss": 6.170491134552728, "vf_explained_var": 0.2683940842984215, "kl": 0.004494541109707108, "entropy": 1.5390508736252153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.937757936368387, "cur_kl_coeff": 131.36816711425783, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.465582523743311, "policy_loss": -0.003692905299006573, "vf_loss": 7.686197230219841, "vf_explained_var": -0.004447911245127519, "kl": 0.005960943336928418, "entropy": 0.9509584215780099, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "env_runners": {"episode_reward_max": 72.94900242863238, "episode_reward_min": -166.51093971801004, "episode_reward_mean": -92.70982491934467, "episode_len_mean": 190.76, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19076, "policy_reward_min": {"agent_policy": -83.25546985900502, "adversary_policy": -61.78138459370105}, "policy_reward_max": {"agent_policy": 36.474501214316184, "adversary_policy": 34.20488676885205}, "policy_reward_mean": {"agent_policy": -46.354912459672335, "adversary_policy": -23.17745622983617}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114.42491728152001, -146.12584871023478, -166.51093971801004, -145.46713544030564, -43.5867456131289, -110.17335365225364, -77.23220231018627, -99.84861609805805, -42.71832072490135, -129.49785262983215, -99.1365315386866, -111.97988874850591, -93.94120693945949, -134.1914750013418, -106.87042772308129, -141.9711498280404, -82.30610784920295, -57.37501915322376, -67.47986527981496, -70.94618814907585, -92.46915398153612, -110.28623785230374, -100.99312507350228, -109.11255876570536, -71.25425158871579, -101.35320179527929, -71.22382816437198, -58.801900030345365, -138.89568458907684, -91.7117739111319, -133.50864937284976, 10.214929204454668, 4.427656880982402, -112.10692504910281, -57.17946721183604, -81.19256896524288, -71.2141508230779, -122.11998942620326, -161.14180557745505, -136.87077765163076, -131.01829883206494, -96.11010028397033, -128.0345738556079, -148.33885513828704, -112.15221640607028, -86.7596787560565, -125.74745468873073, -56.930393655903316, 4.776071930831533, -79.10745712314447, -119.1522069990148, -81.13316435805706, -87.81957276710773, -76.36643290029423, -124.34262557020905, -19.808242321711617, -60.14691860511829, -50.54570797163059, -68.14250116191869, -83.97229972963902, -136.8706616694583, 72.94900242863238, -17.520385894902176, -136.85763711995247, -77.56169010861467, -64.33435006540498, -149.55102181597852, -117.73858219830012, -121.18467412893418, -42.15386402910403, -145.56543620906473, 21.905466790599288, -94.43928615429357, -62.41055573059929, -114.82997475486704, -139.36513196895976, -128.0727998374066, -32.50496702322113, -120.01223571981808, -148.33222390000014, -55.61336990119102, 13.718582865130571, -107.54261997394752, -144.35457022553538, -72.26594375397073, -106.45504429004413, -110.55135327425606, -75.17553691517386, -154.462254540711, -91.46303081877537, -94.81258369950602, -110.32097232676134, -133.8788430246392, -123.83942379887014, -56.13836981375218, -107.69014007782451, -143.30763983542494, -146.57477322682178, -20.465879340753332, -95.90783152549383], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 6, 19, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-57.21245864075999, -73.06292435511736, -83.25546985900502, -72.73356772015279, -21.79337280656445, -55.08667682612677, -38.61610115509316, -49.924308049029044, -21.359160362450677, -64.74892631491616, -49.568265769343284, -55.98994437425288, -46.970603469729745, -67.09573750067085, -53.435213861540625, -70.98557491402033, -41.15305392460155, -28.687509576611895, -33.739932639907536, -35.47309407453797, -46.23457699076807, -55.14311892615191, -50.49656253675108, -54.55627938285277, -35.62712579435788, -50.67660089763976, -35.611914082186004, -29.4009500151727, -69.44784229453836, -45.85588695556593, -66.7543246864249, 5.107464602227333, 2.213828440491201, -56.05346252455133, -28.589733605918013, -40.59628448262144, -35.60707541153892, -61.05999471310163, -80.57090278872745, -68.43538882581534, -65.50914941603247, -48.05505014198519, -64.0172869278041, -74.1694275691435, -56.076108203035076, -43.379839378028166, -62.873727344365314, -28.465196827951708, 2.3880359654157663, -39.553728561572264, -59.5761034995075, -40.56658217902843, -43.909786383553886, -38.18321645014711, -62.17131278510451, -9.904121160855809, -30.073459302559115, -25.272853985815306, -34.07125058095933, -41.986149864819474, -68.43533083472917, 36.474501214316184, -8.760192947451088, -68.42881855997629, -38.780845054307306, -32.16717503270249, -74.7755109079892, -58.86929109915007, -60.59233706446714, -21.076932014551986, -72.7827181045323, 10.952733395299642, -47.219643077146834, -31.205277865299646, -57.41498737743348, -69.68256598447977, -64.03639991870335, -16.252483511610563, -60.006117859909, -74.16611195000007, -27.806684950595486, 6.859291432565286, -53.77130998697386, -72.17728511276772, -36.13297187698535, -53.22752214502206, -55.27567663712802, -37.58776845758696, -77.23112727035561, -45.73151540938771, -47.406291849753025, -55.1604861633806, -66.93942151231963, -61.919711899435015, -28.06918490687609, -53.84507003891226, -71.65381991771238, -73.28738661341089, -10.232939670376666, -47.95391576274695], "policy_adversary_policy_reward": [-24.525630150644783, -32.686828490115204, -40.93520523014642, -32.127719124971, -49.97516696555495, -33.28030289345011, -35.87586224421879, -36.85770547593398, -2.8800838637133666, -18.913288942851082, -21.172435118829064, -33.9142417072977, -20.595863836993487, -18.020237318099674, -29.436892207827775, -20.487415841201265, -1.9475180182879086, -19.411642344162768, -41.457364823539315, -23.291561491376818, -7.575494148930957, -41.99277162041233, -25.013145956459482, -30.976798417793397, -21.434832377768892, -25.535771091960857, -35.97215308720604, -31.12358441346479, -41.69939091425771, -11.735822947282905, -36.13172397040319, -34.85385094361711, -10.225251757559612, -30.927802167041932, -18.031459320013802, -10.656050256598093, -24.112408218916098, -9.627524420991438, -16.58095681153062, -18.89213726300735, -16.53526733490216, -29.69930965586592, -24.744037289071464, -30.39908163708044, -28.85559716356004, -21.640965373191037, -25.402032820274815, -29.154246562577953, -37.19472972175449, 1.5676039273966111, -31.204104909718644, -19.472495987921107, -0.6600468356121993, -34.9518672465738, -22.64580948354319, -6.755140531629497, -39.898483333456625, -29.54935896108176, -22.85476509213236, -23.001121863433568, -26.730170541840703, -40.02415414458421, 4.559751145218355, 0.5477134570089781, -12.623284791301634, 14.837113231792832, -29.3607022420421, -26.692760282509226, -16.08759618014011, -12.502137425777903, -17.155741698627537, -23.440542783993887, -9.911493957850062, -25.69558145368886, -46.630313417032916, -14.429681296068715, -36.99474842019734, -43.57615436853013, -45.8799828993038, -22.55540592651157, -31.265497386267754, -34.243652029764746, -31.16581389697683, -16.889236245008362, -18.976095825563334, -45.04119110224074, -43.95400030063439, -30.21542726850906, -35.10672225776268, -20.969385945272403, -30.44847473070788, -12.931364647320287, -29.78135905950028, -33.09236828486508, -17.77492270421827, -10.690274123733438, 0.3883728138669713, 1.9996631515487948, -21.598968950256545, -17.95475961131573, -19.46767361531336, -40.10842988419416, -18.59820245078918, -21.96837972823925, -1.380158078962907, -42.52962830459097, 2.8183332593510926, -41.0015497094982, -31.575279580513754, -30.59603320459076, -8.76192951011658, -1.1421916507392282, -8.951566368104473, -21.121892934454646, 14.881191851514664, -40.15404583732997, -38.977183583960056, 4.905933003000726, -21.50472991012061, -20.481419954698865, -25.936112126852137, -42.49921870787704, 2.269614445464148, 34.20488676885205, -1.54879769081073, -7.211395256640358, -23.70087311429841, -44.72794544567788, -11.24038943899873, -27.54045561530859, 1.0332777840250742, -33.20045281672756, -43.726678619779484, -31.04883228820976, -23.105720820622658, -35.76357027852741, -35.54174840674701, -25.050588657720116, -18.440197400815723, -2.636734613736266, -40.40030155112186, -32.38241655341042, 16.15477651718953, -5.202043121889886, -25.449617901164935, -21.77002517598187, -18.811395144707657, -12.393882720591993, -29.849316253554814, -27.565671123878662, -36.03924872632024, -33.643317258159534, -33.58951303886471, -30.44688687983864, -8.840557264161113, -7.4119262474494505, -34.454497997372705, -25.551619862536317, -22.89644988210859, -51.269662067891474, 5.272004004302563, -33.07868895489804, 1.0330189550710358, 5.82627247749425, -43.2794210177531, -10.49188896922075, -61.78138459370105, -10.395900519066672, -26.878965140550207, -9.254006736435148, -38.09910342790536, -15.128418717116695, -27.026229717981813, -28.24944691914621, -0.7875990133447424, -36.80016944424222, -54.411351193284574, -22.819776077071026, -16.729322905479904, -29.002192503907803, -20.053100011308473, -27.353191838444552, -13.539387450633592, -41.62109871274699, -22.410670672983354, -44.52875083933625, -24.775673256691913, -37.144038642743105, 1.710630898776209, -29.779815805652298, -22.4470204865733, -31.398049552338957, -52.90781285552162, -18.746007062190742, -24.328440873286503, -48.958945740124385, -9.608767738666707, -0.6241719317099594, -24.72097541682301, -23.232940345923943]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3905532329901311, "mean_inference_ms": 0.9697411080550559, "mean_action_processing_ms": 0.16610784366257367, "mean_env_wait_ms": 0.057806056248939655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034291744232177734, "StateBufferConnector_ms": 0.0026091337203979492, "ViewRequirementAgentConnector_ms": 0.06498992443084717}, "num_episodes": 20, "episode_return_max": 72.94900242863238, "episode_return_min": -166.51093971801004, "episode_return_mean": -92.70982491934467}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 474.07789194175444, "num_env_steps_trained_throughput_per_sec": 474.07789194175444, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 492000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 8324.056, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8324.022, "sample_time_ms": 733.784, "learn_time_ms": 7577.928, "learn_throughput": 527.849, "synch_weights_time_ms": 11.757}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "training_iteration": 41, "trial_id": "eaa30_00000", "date": "2024-08-09_17-45-42", "timestamp": 1723239942, "time_this_iter_s": 8.443142890930176, "time_total_s": 333.7499918937683, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf2dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 333.7499918937683, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 26.041666666666668, "ram_util_percent": 81.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.018848267812578, "cur_kl_coeff": 12.974633789062496, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.4225785313459935, "policy_loss": 0.0009520245819456048, "vf_loss": 6.356197436650594, "vf_explained_var": 0.2644150588878248, "kl": 0.0050428448965595596, "entropy": 1.5447835119313034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.397177102416755, "cur_kl_coeff": 131.36816711425783, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.666820000608762, "policy_loss": -0.005182361820576868, "vf_loss": 7.788008198142052, "vf_explained_var": 0.053762504768868284, "kl": 0.006729135325440438, "entropy": 0.911422333555917, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "env_runners": {"episode_reward_max": 72.94900242863238, "episode_reward_min": -181.73931469505715, "episode_reward_mean": -93.86247275546968, "episode_len_mean": 190.76, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19076, "policy_reward_min": {"agent_policy": -90.86965734752852, "adversary_policy": -61.78138459370105}, "policy_reward_max": {"agent_policy": 36.474501214316184, "adversary_policy": 34.20488676885205}, "policy_reward_mean": {"agent_policy": -46.93123637773484, "adversary_policy": -23.46561818886742}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-92.46915398153612, -110.28623785230374, -100.99312507350228, -109.11255876570536, -71.25425158871579, -101.35320179527929, -71.22382816437198, -58.801900030345365, -138.89568458907684, -91.7117739111319, -133.50864937284976, 10.214929204454668, 4.427656880982402, -112.10692504910281, -57.17946721183604, -81.19256896524288, -71.2141508230779, -122.11998942620326, -161.14180557745505, -136.87077765163076, -131.01829883206494, -96.11010028397033, -128.0345738556079, -148.33885513828704, -112.15221640607028, -86.7596787560565, -125.74745468873073, -56.930393655903316, 4.776071930831533, -79.10745712314447, -119.1522069990148, -81.13316435805706, -87.81957276710773, -76.36643290029423, -124.34262557020905, -19.808242321711617, -60.14691860511829, -50.54570797163059, -68.14250116191869, -83.97229972963902, -136.8706616694583, 72.94900242863238, -17.520385894902176, -136.85763711995247, -77.56169010861467, -64.33435006540498, -149.55102181597852, -117.73858219830012, -121.18467412893418, -42.15386402910403, -145.56543620906473, 21.905466790599288, -94.43928615429357, -62.41055573059929, -114.82997475486704, -139.36513196895976, -128.0727998374066, -32.50496702322113, -120.01223571981808, -148.33222390000014, -55.61336990119102, 13.718582865130571, -107.54261997394752, -144.35457022553538, -72.26594375397073, -106.45504429004413, -110.55135327425606, -75.17553691517386, -154.462254540711, -91.46303081877537, -94.81258369950602, -110.32097232676134, -133.8788430246392, -123.83942379887014, -56.13836981375218, -107.69014007782451, -143.30763983542494, -146.57477322682178, -20.465879340753332, -95.90783152549383, -157.51683339352934, -55.65228111761608, -95.5703254280772, -111.68187572170032, -100.15864561962411, -14.385669988078053, -170.14506409041297, -114.50798503418096, -69.73017559307291, -154.69012126127654, -117.37211148462784, -50.53392547641151, -99.82927883573942, -105.41244161099054, -168.53521911873707, -181.73931469505715, -36.7794537704948, -131.393297568309, -49.54230112382734, -171.87225506960064], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 6, 19, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-46.23457699076807, -55.14311892615191, -50.49656253675108, -54.55627938285277, -35.62712579435788, -50.67660089763976, -35.611914082186004, -29.4009500151727, -69.44784229453836, -45.85588695556593, -66.7543246864249, 5.107464602227333, 2.213828440491201, -56.05346252455133, -28.589733605918013, -40.59628448262144, -35.60707541153892, -61.05999471310163, -80.57090278872745, -68.43538882581534, -65.50914941603247, -48.05505014198519, -64.0172869278041, -74.1694275691435, -56.076108203035076, -43.379839378028166, -62.873727344365314, -28.465196827951708, 2.3880359654157663, -39.553728561572264, -59.5761034995075, -40.56658217902843, -43.909786383553886, -38.18321645014711, -62.17131278510451, -9.904121160855809, -30.073459302559115, -25.272853985815306, -34.07125058095933, -41.986149864819474, -68.43533083472917, 36.474501214316184, -8.760192947451088, -68.42881855997629, -38.780845054307306, -32.16717503270249, -74.7755109079892, -58.86929109915007, -60.59233706446714, -21.076932014551986, -72.7827181045323, 10.952733395299642, -47.219643077146834, -31.205277865299646, -57.41498737743348, -69.68256598447977, -64.03639991870335, -16.252483511610563, -60.006117859909, -74.16611195000007, -27.806684950595486, 6.859291432565286, -53.77130998697386, -72.17728511276772, -36.13297187698535, -53.22752214502206, -55.27567663712802, -37.58776845758696, -77.23112727035561, -45.73151540938771, -47.406291849753025, -55.1604861633806, -66.93942151231963, -61.919711899435015, -28.06918490687609, -53.84507003891226, -71.65381991771238, -73.28738661341089, -10.232939670376666, -47.95391576274695, -78.75841669676478, -27.826140558808014, -47.785162714038655, -55.84093786085024, -50.079322809812076, -7.192834994039025, -85.07253204520646, -57.253992517090445, -34.86508779653647, -77.34506063063822, -58.68605574231401, -25.266962738205756, -49.91463941786974, -52.70622080549528, -84.26760955936854, -90.86965734752852, -18.389726885247395, -65.69664878415449, -24.77115056191366, -85.93612753480024], "policy_adversary_policy_reward": [-16.53526733490216, -29.69930965586592, -24.744037289071464, -30.39908163708044, -28.85559716356004, -21.640965373191037, -25.402032820274815, -29.154246562577953, -37.19472972175449, 1.5676039273966111, -31.204104909718644, -19.472495987921107, -0.6600468356121993, -34.9518672465738, -22.64580948354319, -6.755140531629497, -39.898483333456625, -29.54935896108176, -22.85476509213236, -23.001121863433568, -26.730170541840703, -40.02415414458421, 4.559751145218355, 0.5477134570089781, -12.623284791301634, 14.837113231792832, -29.3607022420421, -26.692760282509226, -16.08759618014011, -12.502137425777903, -17.155741698627537, -23.440542783993887, -9.911493957850062, -25.69558145368886, -46.630313417032916, -14.429681296068715, -36.99474842019734, -43.57615436853013, -45.8799828993038, -22.55540592651157, -31.265497386267754, -34.243652029764746, -31.16581389697683, -16.889236245008362, -18.976095825563334, -45.04119110224074, -43.95400030063439, -30.21542726850906, -35.10672225776268, -20.969385945272403, -30.44847473070788, -12.931364647320287, -29.78135905950028, -33.09236828486508, -17.77492270421827, -10.690274123733438, 0.3883728138669713, 1.9996631515487948, -21.598968950256545, -17.95475961131573, -19.46767361531336, -40.10842988419416, -18.59820245078918, -21.96837972823925, -1.380158078962907, -42.52962830459097, 2.8183332593510926, -41.0015497094982, -31.575279580513754, -30.59603320459076, -8.76192951011658, -1.1421916507392282, -8.951566368104473, -21.121892934454646, 14.881191851514664, -40.15404583732997, -38.977183583960056, 4.905933003000726, -21.50472991012061, -20.481419954698865, -25.936112126852137, -42.49921870787704, 2.269614445464148, 34.20488676885205, -1.54879769081073, -7.211395256640358, -23.70087311429841, -44.72794544567788, -11.24038943899873, -27.54045561530859, 1.0332777840250742, -33.20045281672756, -43.726678619779484, -31.04883228820976, -23.105720820622658, -35.76357027852741, -35.54174840674701, -25.050588657720116, -18.440197400815723, -2.636734613736266, -40.40030155112186, -32.38241655341042, 16.15477651718953, -5.202043121889886, -25.449617901164935, -21.77002517598187, -18.811395144707657, -12.393882720591993, -29.849316253554814, -27.565671123878662, -36.03924872632024, -33.643317258159534, -33.58951303886471, -30.44688687983864, -8.840557264161113, -7.4119262474494505, -34.454497997372705, -25.551619862536317, -22.89644988210859, -51.269662067891474, 5.272004004302563, -33.07868895489804, 1.0330189550710358, 5.82627247749425, -43.2794210177531, -10.49188896922075, -61.78138459370105, -10.395900519066672, -26.878965140550207, -9.254006736435148, -38.09910342790536, -15.128418717116695, -27.026229717981813, -28.24944691914621, -0.7875990133447424, -36.80016944424222, -54.411351193284574, -22.819776077071026, -16.729322905479904, -29.002192503907803, -20.053100011308473, -27.353191838444552, -13.539387450633592, -41.62109871274699, -22.410670672983354, -44.52875083933625, -24.775673256691913, -37.144038642743105, 1.710630898776209, -29.779815805652298, -22.4470204865733, -31.398049552338957, -52.90781285552162, -18.746007062190742, -24.328440873286503, -48.958945740124385, -9.608767738666707, -0.6241719317099594, -24.72097541682301, -23.232940345923943, -31.742823449856843, -47.01559324690787, -16.681320313081045, -11.14482024572698, -25.276681698745964, -22.508481015292695, -15.631706245699561, -40.20923161515068, -23.460513770363228, -26.61880903944885, 4.823714077840094, -12.016549071879119, -44.62673853576521, -40.445793509441216, -32.680607146626365, -24.57338537046408, -5.835622567274704, -29.02946522926177, -38.560266362303935, -38.78479426833433, -40.27387609127693, -18.41217965103706, 4.015245647013181, -29.282208385218937, -39.59896950626112, -10.315669911608623, -42.95610196796727, -9.750118837528, -47.49744177276039, -36.77016778660815, -43.180626626541404, -47.68903072098716, -23.59395500382196, 5.204228118574566, -34.5019963225407, -31.194652461613792, -16.90024793826214, -7.870902623651521, -48.500804670621314, -37.43532286417904]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39033850729015257, "mean_inference_ms": 0.9692170960617287, "mean_action_processing_ms": 0.1660315531694004, "mean_env_wait_ms": 0.0577031145225051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003610372543334961, "StateBufferConnector_ms": 0.0026639699935913086, "ViewRequirementAgentConnector_ms": 0.06575167179107666}, "num_episodes": 20, "episode_return_max": 72.94900242863238, "episode_return_min": -181.73931469505715, "episode_return_mean": -93.86247275546968}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 452.56748150963153, "num_env_steps_trained_throughput_per_sec": 452.56748150963153, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 8384.505, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8384.472, "sample_time_ms": 731.473, "learn_time_ms": 7640.854, "learn_throughput": 523.502, "synch_weights_time_ms": 11.589}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "training_iteration": 42, "trial_id": "eaa30_00000", "date": "2024-08-09_17-45-51", "timestamp": 1723239951, "time_this_iter_s": 8.844717025756836, "time_total_s": 342.59470891952515, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf2f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 342.59470891952515, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 33.06923076923077, "ram_util_percent": 80.89230769230768}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.217879111741586, "cur_kl_coeff": 12.974633789062496, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.405967685154506, "policy_loss": -0.0018915164759924646, "vf_loss": 6.34468706978692, "vf_explained_var": 0.09285004372319217, "kl": 0.004868895890161632, "entropy": 1.5475374523294034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.06253702789545, "cur_kl_coeff": 131.36816711425783, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.798726532856623, "policy_loss": 0.0145113413813912, "vf_loss": 7.296056720117728, "vf_explained_var": 0.08455758641163508, "kl": 0.003715957158904833, "entropy": 0.8755094829325875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "env_runners": {"episode_reward_max": 100.23631932011267, "episode_reward_min": -184.42211994746867, "episode_reward_mean": -95.3137104748765, "episode_len_mean": 194.51, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19451, "policy_reward_min": {"agent_policy": -92.21105997373436, "adversary_policy": -61.78138459370105}, "policy_reward_max": {"agent_policy": 50.11815966005626, "adversary_policy": 50.01051981643725}, "policy_reward_mean": {"agent_policy": -47.656855237438236, "adversary_policy": -23.828427618719125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-131.01829883206494, -96.11010028397033, -128.0345738556079, -148.33885513828704, -112.15221640607028, -86.7596787560565, -125.74745468873073, -56.930393655903316, 4.776071930831533, -79.10745712314447, -119.1522069990148, -81.13316435805706, -87.81957276710773, -76.36643290029423, -124.34262557020905, -19.808242321711617, -60.14691860511829, -50.54570797163059, -68.14250116191869, -83.97229972963902, -136.8706616694583, 72.94900242863238, -17.520385894902176, -136.85763711995247, -77.56169010861467, -64.33435006540498, -149.55102181597852, -117.73858219830012, -121.18467412893418, -42.15386402910403, -145.56543620906473, 21.905466790599288, -94.43928615429357, -62.41055573059929, -114.82997475486704, -139.36513196895976, -128.0727998374066, -32.50496702322113, -120.01223571981808, -148.33222390000014, -55.61336990119102, 13.718582865130571, -107.54261997394752, -144.35457022553538, -72.26594375397073, -106.45504429004413, -110.55135327425606, -75.17553691517386, -154.462254540711, -91.46303081877537, -94.81258369950602, -110.32097232676134, -133.8788430246392, -123.83942379887014, -56.13836981375218, -107.69014007782451, -143.30763983542494, -146.57477322682178, -20.465879340753332, -95.90783152549383, -157.51683339352934, -55.65228111761608, -95.5703254280772, -111.68187572170032, -100.15864561962411, -14.385669988078053, -170.14506409041297, -114.50798503418096, -69.73017559307291, -154.69012126127654, -117.37211148462784, -50.53392547641151, -99.82927883573942, -105.41244161099054, -168.53521911873707, -181.73931469505715, -36.7794537704948, -131.393297568309, -49.54230112382734, -171.87225506960064, -107.32899662464283, -109.30300745945192, -84.19974785022467, -145.11632329047208, -94.46573924075422, -119.89209936713243, 100.23631932011267, -116.31707257987937, -134.75105204075328, -116.98080250791023, -32.30398193429705, -146.16942797037692, -140.9832936001344, -100.61942099825103, -64.95937739182648, -134.31669609641483, -184.42211994746867, -13.68300996572043, -58.659044614436965, -147.68234152457535], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-65.50914941603247, -48.05505014198519, -64.0172869278041, -74.1694275691435, -56.076108203035076, -43.379839378028166, -62.873727344365314, -28.465196827951708, 2.3880359654157663, -39.553728561572264, -59.5761034995075, -40.56658217902843, -43.909786383553886, -38.18321645014711, -62.17131278510451, -9.904121160855809, -30.073459302559115, -25.272853985815306, -34.07125058095933, -41.986149864819474, -68.43533083472917, 36.474501214316184, -8.760192947451088, -68.42881855997629, -38.780845054307306, -32.16717503270249, -74.7755109079892, -58.86929109915007, -60.59233706446714, -21.076932014551986, -72.7827181045323, 10.952733395299642, -47.219643077146834, -31.205277865299646, -57.41498737743348, -69.68256598447977, -64.03639991870335, -16.252483511610563, -60.006117859909, -74.16611195000007, -27.806684950595486, 6.859291432565286, -53.77130998697386, -72.17728511276772, -36.13297187698535, -53.22752214502206, -55.27567663712802, -37.58776845758696, -77.23112727035561, -45.73151540938771, -47.406291849753025, -55.1604861633806, -66.93942151231963, -61.919711899435015, -28.06918490687609, -53.84507003891226, -71.65381991771238, -73.28738661341089, -10.232939670376666, -47.95391576274695, -78.75841669676478, -27.826140558808014, -47.785162714038655, -55.84093786085024, -50.079322809812076, -7.192834994039025, -85.07253204520646, -57.253992517090445, -34.86508779653647, -77.34506063063822, -58.68605574231401, -25.266962738205756, -49.91463941786974, -52.70622080549528, -84.26760955936854, -90.86965734752852, -18.389726885247395, -65.69664878415449, -24.77115056191366, -85.93612753480024, -53.66449831232135, -54.65150372972608, -42.09987392511242, -72.55816164523605, -47.23286962037708, -59.94604968356625, 50.11815966005626, -58.15853628993963, -67.3755260203767, -58.49040125395506, -16.151990967148514, -73.08471398518842, -70.49164680006727, -50.30971049912546, -32.47968869591324, -67.15834804820742, -92.21105997373436, -6.841504982860194, -29.32952230721846, -73.84117076228766], "policy_adversary_policy_reward": [-31.265497386267754, -34.243652029764746, -31.16581389697683, -16.889236245008362, -18.976095825563334, -45.04119110224074, -43.95400030063439, -30.21542726850906, -35.10672225776268, -20.969385945272403, -30.44847473070788, -12.931364647320287, -29.78135905950028, -33.09236828486508, -17.77492270421827, -10.690274123733438, 0.3883728138669713, 1.9996631515487948, -21.598968950256545, -17.95475961131573, -19.46767361531336, -40.10842988419416, -18.59820245078918, -21.96837972823925, -1.380158078962907, -42.52962830459097, 2.8183332593510926, -41.0015497094982, -31.575279580513754, -30.59603320459076, -8.76192951011658, -1.1421916507392282, -8.951566368104473, -21.121892934454646, 14.881191851514664, -40.15404583732997, -38.977183583960056, 4.905933003000726, -21.50472991012061, -20.481419954698865, -25.936112126852137, -42.49921870787704, 2.269614445464148, 34.20488676885205, -1.54879769081073, -7.211395256640358, -23.70087311429841, -44.72794544567788, -11.24038943899873, -27.54045561530859, 1.0332777840250742, -33.20045281672756, -43.726678619779484, -31.04883228820976, -23.105720820622658, -35.76357027852741, -35.54174840674701, -25.050588657720116, -18.440197400815723, -2.636734613736266, -40.40030155112186, -32.38241655341042, 16.15477651718953, -5.202043121889886, -25.449617901164935, -21.77002517598187, -18.811395144707657, -12.393882720591993, -29.849316253554814, -27.565671123878662, -36.03924872632024, -33.643317258159534, -33.58951303886471, -30.44688687983864, -8.840557264161113, -7.4119262474494505, -34.454497997372705, -25.551619862536317, -22.89644988210859, -51.269662067891474, 5.272004004302563, -33.07868895489804, 1.0330189550710358, 5.82627247749425, -43.2794210177531, -10.49188896922075, -61.78138459370105, -10.395900519066672, -26.878965140550207, -9.254006736435148, -38.09910342790536, -15.128418717116695, -27.026229717981813, -28.24944691914621, -0.7875990133447424, -36.80016944424222, -54.411351193284574, -22.819776077071026, -16.729322905479904, -29.002192503907803, -20.053100011308473, -27.353191838444552, -13.539387450633592, -41.62109871274699, -22.410670672983354, -44.52875083933625, -24.775673256691913, -37.144038642743105, 1.710630898776209, -29.779815805652298, -22.4470204865733, -31.398049552338957, -52.90781285552162, -18.746007062190742, -24.328440873286503, -48.958945740124385, -9.608767738666707, -0.6241719317099594, -24.72097541682301, -23.232940345923943, -31.742823449856843, -47.01559324690787, -16.681320313081045, -11.14482024572698, -25.276681698745964, -22.508481015292695, -15.631706245699561, -40.20923161515068, -23.460513770363228, -26.61880903944885, 4.823714077840094, -12.016549071879119, -44.62673853576521, -40.445793509441216, -32.680607146626365, -24.57338537046408, -5.835622567274704, -29.02946522926177, -38.560266362303935, -38.78479426833433, -40.27387609127693, -18.41217965103706, 4.015245647013181, -29.282208385218937, -39.59896950626112, -10.315669911608623, -42.95610196796727, -9.750118837528, -47.49744177276039, -36.77016778660815, -43.180626626541404, -47.68903072098716, -23.59395500382196, 5.204228118574566, -34.5019963225407, -31.194652461613792, -16.90024793826214, -7.870902623651521, -48.500804670621314, -37.43532286417904, -40.55278584697106, -13.111712465350287, -27.99257810498618, -26.658925624739872, -22.26593550221753, -19.83393842289489, -36.96866886695232, -35.58949277828378, -21.482141363199087, -25.750728257177997, -21.533301864262384, -38.412747819303874, 50.01051981643725, 0.10763984361905798, -45.489753451219265, -12.668782838720368, -18.99353628640043, -48.38198973397628, -28.774898275112207, -29.715502978842856, -12.345994765658006, -3.805996201490508, -36.90530124549661, -36.17941273969182, -33.33903250707973, -37.152614292987536, -27.971580511700616, -22.338129987424843, -13.331485633415205, -19.148203062498034, -40.30657293733195, -26.85177511087545, -36.67173700877391, -55.539322964960405, 4.009138296673463, -10.850643279533656, -26.329964286572203, -2.999558020646253, -43.86909161924336, -29.97207914304429]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39021806501634404, "mean_inference_ms": 0.9683885066421744, "mean_action_processing_ms": 0.16579444401963214, "mean_env_wait_ms": 0.05771781010182859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036559104919433594, "StateBufferConnector_ms": 0.0026465654373168945, "ViewRequirementAgentConnector_ms": 0.06516969203948975}, "num_episodes": 20, "episode_return_max": 100.23631932011267, "episode_return_min": -184.42211994746867, "episode_return_mean": -95.3137104748765}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 472.2313950769223, "num_env_steps_trained_throughput_per_sec": 472.2313950769223, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 516000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 8409.146, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8409.113, "sample_time_ms": 746.864, "learn_time_ms": 7650.144, "learn_throughput": 522.866, "synch_weights_time_ms": 11.545}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "training_iteration": 43, "trial_id": "eaa30_00000", "date": "2024-08-09_17-46-00", "timestamp": 1723239960, "time_this_iter_s": 8.476096868515015, "time_total_s": 351.07080578804016, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf7280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 351.07080578804016, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 24.733333333333334, "ram_util_percent": 81.52499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.743896131477658, "cur_kl_coeff": 6.487316894531248, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.668060660488391, "policy_loss": -0.0008902088414986061, "vf_loss": 5.6468700118796535, "vf_explained_var": 0.16057432025828688, "kl": 0.0034036973459897414, "entropy": 1.5540748225318062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.963374412804843, "cur_kl_coeff": 65.68408355712891, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.362491456667582, "policy_loss": -0.00019216941388246293, "vf_loss": 7.0520221884051955, "vf_explained_var": 0.14825134879599014, "kl": 0.004729630833511086, "entropy": 0.817951204503576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 100.23631932011267, "episode_reward_min": -184.42211994746867, "episode_reward_mean": -96.91751915664858, "episode_len_mean": 196.5, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19650, "policy_reward_min": {"agent_policy": -92.21105997373436, "adversary_policy": -61.78138459370105}, "policy_reward_max": {"agent_policy": 50.11815966005626, "adversary_policy": 50.01051981643725}, "policy_reward_mean": {"agent_policy": -48.4587595783243, "adversary_policy": -24.22937978916215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-83.97229972963902, -136.8706616694583, 72.94900242863238, -17.520385894902176, -136.85763711995247, -77.56169010861467, -64.33435006540498, -149.55102181597852, -117.73858219830012, -121.18467412893418, -42.15386402910403, -145.56543620906473, 21.905466790599288, -94.43928615429357, -62.41055573059929, -114.82997475486704, -139.36513196895976, -128.0727998374066, -32.50496702322113, -120.01223571981808, -148.33222390000014, -55.61336990119102, 13.718582865130571, -107.54261997394752, -144.35457022553538, -72.26594375397073, -106.45504429004413, -110.55135327425606, -75.17553691517386, -154.462254540711, -91.46303081877537, -94.81258369950602, -110.32097232676134, -133.8788430246392, -123.83942379887014, -56.13836981375218, -107.69014007782451, -143.30763983542494, -146.57477322682178, -20.465879340753332, -95.90783152549383, -157.51683339352934, -55.65228111761608, -95.5703254280772, -111.68187572170032, -100.15864561962411, -14.385669988078053, -170.14506409041297, -114.50798503418096, -69.73017559307291, -154.69012126127654, -117.37211148462784, -50.53392547641151, -99.82927883573942, -105.41244161099054, -168.53521911873707, -181.73931469505715, -36.7794537704948, -131.393297568309, -49.54230112382734, -171.87225506960064, -107.32899662464283, -109.30300745945192, -84.19974785022467, -145.11632329047208, -94.46573924075422, -119.89209936713243, 100.23631932011267, -116.31707257987937, -134.75105204075328, -116.98080250791023, -32.30398193429705, -146.16942797037692, -140.9832936001344, -100.61942099825103, -64.95937739182648, -134.31669609641483, -184.42211994746867, -13.68300996572043, -58.659044614436965, -147.68234152457535, -156.43873597235435, -48.11428921410854, -74.33339224664252, -149.2517133109676, -0.8550726181170774, -153.50639766281068, -175.54540797364507, -39.93084032655053, -71.96510239585922, -72.21997323146982, -58.13849106306462, -74.79203536785997, -60.1081941615078, -128.34910674158766, -71.6403603710119, -146.92313233334366, -98.65071414494236, -138.92419840620852, -87.574040099223], "episode_lengths": [200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-41.986149864819474, -68.43533083472917, 36.474501214316184, -8.760192947451088, -68.42881855997629, -38.780845054307306, -32.16717503270249, -74.7755109079892, -58.86929109915007, -60.59233706446714, -21.076932014551986, -72.7827181045323, 10.952733395299642, -47.219643077146834, -31.205277865299646, -57.41498737743348, -69.68256598447977, -64.03639991870335, -16.252483511610563, -60.006117859909, -74.16611195000007, -27.806684950595486, 6.859291432565286, -53.77130998697386, -72.17728511276772, -36.13297187698535, -53.22752214502206, -55.27567663712802, -37.58776845758696, -77.23112727035561, -45.73151540938771, -47.406291849753025, -55.1604861633806, -66.93942151231963, -61.919711899435015, -28.06918490687609, -53.84507003891226, -71.65381991771238, -73.28738661341089, -10.232939670376666, -47.95391576274695, -78.75841669676478, -27.826140558808014, -47.785162714038655, -55.84093786085024, -50.079322809812076, -7.192834994039025, -85.07253204520646, -57.253992517090445, -34.86508779653647, -77.34506063063822, -58.68605574231401, -25.266962738205756, -49.91463941786974, -52.70622080549528, -84.26760955936854, -90.86965734752852, -18.389726885247395, -65.69664878415449, -24.77115056191366, -85.93612753480024, -53.66449831232135, -54.65150372972608, -42.09987392511242, -72.55816164523605, -47.23286962037708, -59.94604968356625, 50.11815966005626, -58.15853628993963, -67.3755260203767, -58.49040125395506, -16.151990967148514, -73.08471398518842, -70.49164680006727, -50.30971049912546, -32.47968869591324, -67.15834804820742, -92.21105997373436, -6.841504982860194, -29.32952230721846, -73.84117076228766, -78.21936798617716, -24.057144607054283, -37.166696123321266, -74.62585665548373, -0.4275363090585387, -76.75319883140554, -87.77270398682245, -19.965420163275265, -35.982551197929624, -36.1099866157349, -29.069245531532303, -37.396017683929934, -30.05409708075387, -64.17455337079383, -35.82018018550596, -73.4615661666719, -49.32535707247119, -69.46209920310412, -43.78702004961151], "policy_adversary_policy_reward": [-21.50472991012061, -20.481419954698865, -25.936112126852137, -42.49921870787704, 2.269614445464148, 34.20488676885205, -1.54879769081073, -7.211395256640358, -23.70087311429841, -44.72794544567788, -11.24038943899873, -27.54045561530859, 1.0332777840250742, -33.20045281672756, -43.726678619779484, -31.04883228820976, -23.105720820622658, -35.76357027852741, -35.54174840674701, -25.050588657720116, -18.440197400815723, -2.636734613736266, -40.40030155112186, -32.38241655341042, 16.15477651718953, -5.202043121889886, -25.449617901164935, -21.77002517598187, -18.811395144707657, -12.393882720591993, -29.849316253554814, -27.565671123878662, -36.03924872632024, -33.643317258159534, -33.58951303886471, -30.44688687983864, -8.840557264161113, -7.4119262474494505, -34.454497997372705, -25.551619862536317, -22.89644988210859, -51.269662067891474, 5.272004004302563, -33.07868895489804, 1.0330189550710358, 5.82627247749425, -43.2794210177531, -10.49188896922075, -61.78138459370105, -10.395900519066672, -26.878965140550207, -9.254006736435148, -38.09910342790536, -15.128418717116695, -27.026229717981813, -28.24944691914621, -0.7875990133447424, -36.80016944424222, -54.411351193284574, -22.819776077071026, -16.729322905479904, -29.002192503907803, -20.053100011308473, -27.353191838444552, -13.539387450633592, -41.62109871274699, -22.410670672983354, -44.52875083933625, -24.775673256691913, -37.144038642743105, 1.710630898776209, -29.779815805652298, -22.4470204865733, -31.398049552338957, -52.90781285552162, -18.746007062190742, -24.328440873286503, -48.958945740124385, -9.608767738666707, -0.6241719317099594, -24.72097541682301, -23.232940345923943, -31.742823449856843, -47.01559324690787, -16.681320313081045, -11.14482024572698, -25.276681698745964, -22.508481015292695, -15.631706245699561, -40.20923161515068, -23.460513770363228, -26.61880903944885, 4.823714077840094, -12.016549071879119, -44.62673853576521, -40.445793509441216, -32.680607146626365, -24.57338537046408, -5.835622567274704, -29.02946522926177, -38.560266362303935, -38.78479426833433, -40.27387609127693, -18.41217965103706, 4.015245647013181, -29.282208385218937, -39.59896950626112, -10.315669911608623, -42.95610196796727, -9.750118837528, -47.49744177276039, -36.77016778660815, -43.180626626541404, -47.68903072098716, -23.59395500382196, 5.204228118574566, -34.5019963225407, -31.194652461613792, -16.90024793826214, -7.870902623651521, -48.500804670621314, -37.43532286417904, -40.55278584697106, -13.111712465350287, -27.99257810498618, -26.658925624739872, -22.26593550221753, -19.83393842289489, -36.96866886695232, -35.58949277828378, -21.482141363199087, -25.750728257177997, -21.533301864262384, -38.412747819303874, 50.01051981643725, 0.10763984361905798, -45.489753451219265, -12.668782838720368, -18.99353628640043, -48.38198973397628, -28.774898275112207, -29.715502978842856, -12.345994765658006, -3.805996201490508, -36.90530124549661, -36.17941273969182, -33.33903250707973, -37.152614292987536, -27.971580511700616, -22.338129987424843, -13.331485633415205, -19.148203062498034, -40.30657293733195, -26.85177511087545, -36.67173700877391, -55.539322964960405, 4.009138296673463, -10.850643279533656, -26.329964286572203, -2.999558020646253, -43.86909161924336, -29.97207914304429, -40.659717075673704, -37.55965091050344, -12.17127398065631, -11.885870626397988, -2.671866236737486, -34.49482988658379, -44.90760443016956, -29.71825222531416, -9.063735111811958, 8.63619880275342, -45.61110613278137, -31.142092698624054, -48.60436405026531, -39.16833993655718, -21.362153845497584, 1.3967336822223189, -41.68885651156189, 5.706305313632264, -32.61250716435707, -3.4974794513778455, -18.08099887861004, -10.988246652922264, -13.444440661666953, -23.951577022262985, -24.671914887672433, -5.382182193081436, -45.12652090149163, -19.0480324693022, -23.514066984333745, -12.306113201172217, -29.07450768990042, -44.38705847677146, -23.885729330778624, -25.439627741692565, -32.90478782787611, -36.55731137522799, -31.582834878222208, -12.204185171389305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3901216907679627, "mean_inference_ms": 0.968143633138295, "mean_action_processing_ms": 0.16577103609404656, "mean_env_wait_ms": 0.057709229807003715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036641359329223633, "StateBufferConnector_ms": 0.002581357955932617, "ViewRequirementAgentConnector_ms": 0.06441545486450195}, "num_episodes": 19, "episode_return_max": 100.23631932011267, "episode_return_min": -184.42211994746867, "episode_return_mean": -96.91751915664858}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 475.5975692988075, "num_env_steps_trained_throughput_per_sec": 475.5975692988075, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 8416.855, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8416.822, "sample_time_ms": 743.825, "learn_time_ms": 7660.739, "learn_throughput": 522.143, "synch_weights_time_ms": 11.659}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 44, "trial_id": "eaa30_00000", "date": "2024-08-09_17-46-09", "timestamp": 1723239969, "time_this_iter_s": 8.415964841842651, "time_total_s": 359.4867706298828, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf7430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 359.4867706298828, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 23.158333333333335, "ram_util_percent": 81.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.640836506798154, "cur_kl_coeff": 3.243658447265624, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.6449605669294085, "policy_loss": -0.0028389115745162284, "vf_loss": 5.638988212555174, "vf_explained_var": 0.23603639943259103, "kl": 0.0027164536001648577, "entropy": 1.558756597079928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.412594119583567, "cur_kl_coeff": 32.84204177856446, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.135203963518142, "policy_loss": 7.073075879209985e-05, "vf_loss": 7.078902340928713, "vf_explained_var": 0.29826969125618535, "kl": 0.0017121618852494673, "entropy": 0.7970993137607972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "env_runners": {"episode_reward_max": 100.23631932011267, "episode_reward_min": -184.42211994746867, "episode_reward_mean": -96.66981999081939, "episode_len_mean": 196.4, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19640, "policy_reward_min": {"agent_policy": -92.21105997373436, "adversary_policy": -61.78138459370105}, "policy_reward_max": {"agent_policy": 50.11815966005626, "adversary_policy": 50.01051981643725}, "policy_reward_mean": {"agent_policy": -48.334909995409696, "adversary_policy": -24.167454997704844}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.718582865130571, -107.54261997394752, -144.35457022553538, -72.26594375397073, -106.45504429004413, -110.55135327425606, -75.17553691517386, -154.462254540711, -91.46303081877537, -94.81258369950602, -110.32097232676134, -133.8788430246392, -123.83942379887014, -56.13836981375218, -107.69014007782451, -143.30763983542494, -146.57477322682178, -20.465879340753332, -95.90783152549383, -157.51683339352934, -55.65228111761608, -95.5703254280772, -111.68187572170032, -100.15864561962411, -14.385669988078053, -170.14506409041297, -114.50798503418096, -69.73017559307291, -154.69012126127654, -117.37211148462784, -50.53392547641151, -99.82927883573942, -105.41244161099054, -168.53521911873707, -181.73931469505715, -36.7794537704948, -131.393297568309, -49.54230112382734, -171.87225506960064, -107.32899662464283, -109.30300745945192, -84.19974785022467, -145.11632329047208, -94.46573924075422, -119.89209936713243, 100.23631932011267, -116.31707257987937, -134.75105204075328, -116.98080250791023, -32.30398193429705, -146.16942797037692, -140.9832936001344, -100.61942099825103, -64.95937739182648, -134.31669609641483, -184.42211994746867, -13.68300996572043, -58.659044614436965, -147.68234152457535, -156.43873597235435, -48.11428921410854, -74.33339224664252, -149.2517133109676, -0.8550726181170774, -153.50639766281068, -175.54540797364507, -39.93084032655053, -71.96510239585922, -72.21997323146982, -58.13849106306462, -74.79203536785997, -60.1081941615078, -128.34910674158766, -71.6403603710119, -146.92313233334366, -98.65071414494236, -138.92419840620852, -87.574040099223, -83.74757608643358, -86.72166194907435, -133.40240012860284, -7.998987783783839, -105.92254808916724, -93.59315934668098, 50.00029091312166, -101.91573354802424, -105.54551936881165, -143.59372136392432, -103.40828443575501, -20.727567308200058, -70.35199653195184, -135.53073464972067, 16.505712410721287, -133.41383151249778, -95.83928889385459, -143.34084770466887, -100.50197305500672, -155.14800373586462, -104.58162233204848, -10.48730765733059], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6.859291432565286, -53.77130998697386, -72.17728511276772, -36.13297187698535, -53.22752214502206, -55.27567663712802, -37.58776845758696, -77.23112727035561, -45.73151540938771, -47.406291849753025, -55.1604861633806, -66.93942151231963, -61.919711899435015, -28.06918490687609, -53.84507003891226, -71.65381991771238, -73.28738661341089, -10.232939670376666, -47.95391576274695, -78.75841669676478, -27.826140558808014, -47.785162714038655, -55.84093786085024, -50.079322809812076, -7.192834994039025, -85.07253204520646, -57.253992517090445, -34.86508779653647, -77.34506063063822, -58.68605574231401, -25.266962738205756, -49.91463941786974, -52.70622080549528, -84.26760955936854, -90.86965734752852, -18.389726885247395, -65.69664878415449, -24.77115056191366, -85.93612753480024, -53.66449831232135, -54.65150372972608, -42.09987392511242, -72.55816164523605, -47.23286962037708, -59.94604968356625, 50.11815966005626, -58.15853628993963, -67.3755260203767, -58.49040125395506, -16.151990967148514, -73.08471398518842, -70.49164680006727, -50.30971049912546, -32.47968869591324, -67.15834804820742, -92.21105997373436, -6.841504982860194, -29.32952230721846, -73.84117076228766, -78.21936798617716, -24.057144607054283, -37.166696123321266, -74.62585665548373, -0.4275363090585387, -76.75319883140554, -87.77270398682245, -19.965420163275265, -35.982551197929624, -36.1099866157349, -29.069245531532303, -37.396017683929934, -30.05409708075387, -64.17455337079383, -35.82018018550596, -73.4615661666719, -49.32535707247119, -69.46209920310412, -43.78702004961151, -41.873788043216734, -43.360830974537215, -66.70120006430152, -3.999493891891902, -52.96127404458359, -46.79657967334042, 25.00014545656082, -50.957866774012146, -52.7727596844058, -71.7968606819621, -51.70414221787745, -10.363783654100029, -35.17599826597596, -67.7653673248603, 8.252856205360644, -66.70691575624882, -47.91964444692729, -71.67042385233451, -50.25098652750336, -77.57400186793234, -52.290811166024206, -5.243653828665295], "policy_adversary_policy_reward": [1.0330189550710358, 5.82627247749425, -43.2794210177531, -10.49188896922075, -61.78138459370105, -10.395900519066672, -26.878965140550207, -9.254006736435148, -38.09910342790536, -15.128418717116695, -27.026229717981813, -28.24944691914621, -0.7875990133447424, -36.80016944424222, -54.411351193284574, -22.819776077071026, -16.729322905479904, -29.002192503907803, -20.053100011308473, -27.353191838444552, -13.539387450633592, -41.62109871274699, -22.410670672983354, -44.52875083933625, -24.775673256691913, -37.144038642743105, 1.710630898776209, -29.779815805652298, -22.4470204865733, -31.398049552338957, -52.90781285552162, -18.746007062190742, -24.328440873286503, -48.958945740124385, -9.608767738666707, -0.6241719317099594, -24.72097541682301, -23.232940345923943, -31.742823449856843, -47.01559324690787, -16.681320313081045, -11.14482024572698, -25.276681698745964, -22.508481015292695, -15.631706245699561, -40.20923161515068, -23.460513770363228, -26.61880903944885, 4.823714077840094, -12.016549071879119, -44.62673853576521, -40.445793509441216, -32.680607146626365, -24.57338537046408, -5.835622567274704, -29.02946522926177, -38.560266362303935, -38.78479426833433, -40.27387609127693, -18.41217965103706, 4.015245647013181, -29.282208385218937, -39.59896950626112, -10.315669911608623, -42.95610196796727, -9.750118837528, -47.49744177276039, -36.77016778660815, -43.180626626541404, -47.68903072098716, -23.59395500382196, 5.204228118574566, -34.5019963225407, -31.194652461613792, -16.90024793826214, -7.870902623651521, -48.500804670621314, -37.43532286417904, -40.55278584697106, -13.111712465350287, -27.99257810498618, -26.658925624739872, -22.26593550221753, -19.83393842289489, -36.96866886695232, -35.58949277828378, -21.482141363199087, -25.750728257177997, -21.533301864262384, -38.412747819303874, 50.01051981643725, 0.10763984361905798, -45.489753451219265, -12.668782838720368, -18.99353628640043, -48.38198973397628, -28.774898275112207, -29.715502978842856, -12.345994765658006, -3.805996201490508, -36.90530124549661, -36.17941273969182, -33.33903250707973, -37.152614292987536, -27.971580511700616, -22.338129987424843, -13.331485633415205, -19.148203062498034, -40.30657293733195, -26.85177511087545, -36.67173700877391, -55.539322964960405, 4.009138296673463, -10.850643279533656, -26.329964286572203, -2.999558020646253, -43.86909161924336, -29.97207914304429, -40.659717075673704, -37.55965091050344, -12.17127398065631, -11.885870626397988, -2.671866236737486, -34.49482988658379, -44.90760443016956, -29.71825222531416, -9.063735111811958, 8.63619880275342, -45.61110613278137, -31.142092698624054, -48.60436405026531, -39.16833993655718, -21.362153845497584, 1.3967336822223189, -41.68885651156189, 5.706305313632264, -32.61250716435707, -3.4974794513778455, -18.08099887861004, -10.988246652922264, -13.444440661666953, -23.951577022262985, -24.671914887672433, -5.382182193081436, -45.12652090149163, -19.0480324693022, -23.514066984333745, -12.306113201172217, -29.07450768990042, -44.38705847677146, -23.885729330778624, -25.439627741692565, -32.90478782787611, -36.55731137522799, -31.582834878222208, -12.204185171389305, -31.798423434128097, -10.075364609088638, -31.24867956213783, -12.112151412399374, -34.493336972153, -32.20786309214851, -1.700334342248624, -2.2991595496433064, -23.20761203695435, -29.75366200762924, -26.919019881944237, -19.877559791396184, -3.0374315483614396, 28.03757700492226, -27.01290962941353, -23.94495714459861, -42.88515982871727, -9.887599855688535, -30.259339767278227, -41.53752091468393, -25.202798896139406, -26.50134332173804, -7.409369591521049, -2.95441406257898, 9.966177682473543, -45.14217594844952, -39.71471166523523, -28.050655659625107, 11.908004149416815, -3.6551479440561714, -37.02476000726533, -29.682155748983497, -20.455248912776764, -27.464395534150512, -33.631207599207805, -38.039216253126746, -30.833816076801895, -19.417170450701466, -37.14210094419532, -40.43190092373695, -28.151992779557215, -24.138818386466983, 23.704173692394185, -28.94782752105948]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38989706862715545, "mean_inference_ms": 0.9672208024806079, "mean_action_processing_ms": 0.1656513822718268, "mean_env_wait_ms": 0.05766209471608508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036798715591430664, "StateBufferConnector_ms": 0.003354310989379883, "ViewRequirementAgentConnector_ms": 0.06441617012023926}, "num_episodes": 22, "episode_return_max": 100.23631932011267, "episode_return_min": -184.42211994746867, "episode_return_mean": -96.66981999081939}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 466.2907946732973, "num_env_steps_trained_throughput_per_sec": 466.2907946732973, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 540000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 8455.271, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8455.238, "sample_time_ms": 739.314, "learn_time_ms": 7703.612, "learn_throughput": 519.237, "synch_weights_time_ms": 11.708}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "training_iteration": 45, "trial_id": "eaa30_00000", "date": "2024-08-09_17-46-17", "timestamp": 1723239977, "time_this_iter_s": 8.58495807647705, "time_total_s": 368.07172870635986, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf74c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 368.07172870635986, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 26.775000000000002, "ram_util_percent": 80.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.167521514085235, "cur_kl_coeff": 1.621829223632812, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.049212636644878, "policy_loss": -0.0016077735924492121, "vf_loss": 6.0442693130049125, "vf_explained_var": 0.15104735373819947, "kl": 0.004039328839758007, "entropy": 1.5641606826000112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.918752940806249, "cur_kl_coeff": 16.42102088928223, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.803250245253245, "policy_loss": -0.0053046422506061695, "vf_loss": 6.782400900125504, "vf_explained_var": 0.281768272879223, "kl": 0.0015927147410062996, "entropy": 0.7867441998173793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "env_runners": {"episode_reward_max": 100.23631932011267, "episode_reward_min": -195.3596332985884, "episode_reward_mean": -91.90614529486784, "episode_len_mean": 194.45, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19445, "policy_reward_min": {"agent_policy": -97.6798166492942, "adversary_policy": -55.539322964960405}, "policy_reward_max": {"agent_policy": 50.11815966005626, "adversary_policy": 50.01051981643725}, "policy_reward_mean": {"agent_policy": -45.95307264743392, "adversary_policy": -22.97653632371696}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-111.68187572170032, -100.15864561962411, -14.385669988078053, -170.14506409041297, -114.50798503418096, -69.73017559307291, -154.69012126127654, -117.37211148462784, -50.53392547641151, -99.82927883573942, -105.41244161099054, -168.53521911873707, -181.73931469505715, -36.7794537704948, -131.393297568309, -49.54230112382734, -171.87225506960064, -107.32899662464283, -109.30300745945192, -84.19974785022467, -145.11632329047208, -94.46573924075422, -119.89209936713243, 100.23631932011267, -116.31707257987937, -134.75105204075328, -116.98080250791023, -32.30398193429705, -146.16942797037692, -140.9832936001344, -100.61942099825103, -64.95937739182648, -134.31669609641483, -184.42211994746867, -13.68300996572043, -58.659044614436965, -147.68234152457535, -156.43873597235435, -48.11428921410854, -74.33339224664252, -149.2517133109676, -0.8550726181170774, -153.50639766281068, -175.54540797364507, -39.93084032655053, -71.96510239585922, -72.21997323146982, -58.13849106306462, -74.79203536785997, -60.1081941615078, -128.34910674158766, -71.6403603710119, -146.92313233334366, -98.65071414494236, -138.92419840620852, -87.574040099223, -83.74757608643358, -86.72166194907435, -133.40240012860284, -7.998987783783839, -105.92254808916724, -93.59315934668098, 50.00029091312166, -101.91573354802424, -105.54551936881165, -143.59372136392432, -103.40828443575501, -20.727567308200058, -70.35199653195184, -135.53073464972067, 16.505712410721287, -133.41383151249778, -95.83928889385459, -143.34084770466887, -100.50197305500672, -155.14800373586462, -104.58162233204848, -10.48730765733059, -95.27451680989672, -85.16878307248439, -84.78276133759903, -84.68228620454104, -78.61126153048161, -73.37245263653577, 11.062276381240316, -34.56360214277498, -127.77415101229255, -0.30875900122743327, 0.115525337332258, -8.350588676485557, -54.75255838790555, -139.4932540861686, -76.65228320953062, -114.64621106129664, -124.7158584478615, -74.05228920949911, -78.07948763839393, -195.3596332985884, -17.800182128193782, -176.5970797680132], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-55.84093786085024, -50.079322809812076, -7.192834994039025, -85.07253204520646, -57.253992517090445, -34.86508779653647, -77.34506063063822, -58.68605574231401, -25.266962738205756, -49.91463941786974, -52.70622080549528, -84.26760955936854, -90.86965734752852, -18.389726885247395, -65.69664878415449, -24.77115056191366, -85.93612753480024, -53.66449831232135, -54.65150372972608, -42.09987392511242, -72.55816164523605, -47.23286962037708, -59.94604968356625, 50.11815966005626, -58.15853628993963, -67.3755260203767, -58.49040125395506, -16.151990967148514, -73.08471398518842, -70.49164680006727, -50.30971049912546, -32.47968869591324, -67.15834804820742, -92.21105997373436, -6.841504982860194, -29.32952230721846, -73.84117076228766, -78.21936798617716, -24.057144607054283, -37.166696123321266, -74.62585665548373, -0.4275363090585387, -76.75319883140554, -87.77270398682245, -19.965420163275265, -35.982551197929624, -36.1099866157349, -29.069245531532303, -37.396017683929934, -30.05409708075387, -64.17455337079383, -35.82018018550596, -73.4615661666719, -49.32535707247119, -69.46209920310412, -43.78702004961151, -41.873788043216734, -43.360830974537215, -66.70120006430152, -3.999493891891902, -52.96127404458359, -46.79657967334042, 25.00014545656082, -50.957866774012146, -52.7727596844058, -71.7968606819621, -51.70414221787745, -10.363783654100029, -35.17599826597596, -67.7653673248603, 8.252856205360644, -66.70691575624882, -47.91964444692729, -71.67042385233451, -50.25098652750336, -77.57400186793234, -52.290811166024206, -5.243653828665295, -47.63725840494832, -42.58439153624219, -42.39138066879949, -42.34114310227053, -39.3056307652408, -36.686226318267835, 5.531138190620169, -17.281801071387477, -63.88707550614626, -0.15437950061371664, 0.05776266866612545, -4.175294338242782, -27.376279193952776, -69.74662704308425, -38.32614160476527, -57.32310553064826, -62.357929223930874, -37.02614460474953, -39.03974381919688, -97.6798166492942, -8.900091064096891, -88.29853988400663], "policy_adversary_policy_reward": [-15.631706245699561, -40.20923161515068, -23.460513770363228, -26.61880903944885, 4.823714077840094, -12.016549071879119, -44.62673853576521, -40.445793509441216, -32.680607146626365, -24.57338537046408, -5.835622567274704, -29.02946522926177, -38.560266362303935, -38.78479426833433, -40.27387609127693, -18.41217965103706, 4.015245647013181, -29.282208385218937, -39.59896950626112, -10.315669911608623, -42.95610196796727, -9.750118837528, -47.49744177276039, -36.77016778660815, -43.180626626541404, -47.68903072098716, -23.59395500382196, 5.204228118574566, -34.5019963225407, -31.194652461613792, -16.90024793826214, -7.870902623651521, -48.500804670621314, -37.43532286417904, -40.55278584697106, -13.111712465350287, -27.99257810498618, -26.658925624739872, -22.26593550221753, -19.83393842289489, -36.96866886695232, -35.58949277828378, -21.482141363199087, -25.750728257177997, -21.533301864262384, -38.412747819303874, 50.01051981643725, 0.10763984361905798, -45.489753451219265, -12.668782838720368, -18.99353628640043, -48.38198973397628, -28.774898275112207, -29.715502978842856, -12.345994765658006, -3.805996201490508, -36.90530124549661, -36.17941273969182, -33.33903250707973, -37.152614292987536, -27.971580511700616, -22.338129987424843, -13.331485633415205, -19.148203062498034, -40.30657293733195, -26.85177511087545, -36.67173700877391, -55.539322964960405, 4.009138296673463, -10.850643279533656, -26.329964286572203, -2.999558020646253, -43.86909161924336, -29.97207914304429, -40.659717075673704, -37.55965091050344, -12.17127398065631, -11.885870626397988, -2.671866236737486, -34.49482988658379, -44.90760443016956, -29.71825222531416, -9.063735111811958, 8.63619880275342, -45.61110613278137, -31.142092698624054, -48.60436405026531, -39.16833993655718, -21.362153845497584, 1.3967336822223189, -41.68885651156189, 5.706305313632264, -32.61250716435707, -3.4974794513778455, -18.08099887861004, -10.988246652922264, -13.444440661666953, -23.951577022262985, -24.671914887672433, -5.382182193081436, -45.12652090149163, -19.0480324693022, -23.514066984333745, -12.306113201172217, -29.07450768990042, -44.38705847677146, -23.885729330778624, -25.439627741692565, -32.90478782787611, -36.55731137522799, -31.582834878222208, -12.204185171389305, -31.798423434128097, -10.075364609088638, -31.24867956213783, -12.112151412399374, -34.493336972153, -32.20786309214851, -1.700334342248624, -2.2991595496433064, -23.20761203695435, -29.75366200762924, -26.919019881944237, -19.877559791396184, -3.0374315483614396, 28.03757700492226, -27.01290962941353, -23.94495714459861, -42.88515982871727, -9.887599855688535, -30.259339767278227, -41.53752091468393, -25.202798896139406, -26.50134332173804, -7.409369591521049, -2.95441406257898, 9.966177682473543, -45.14217594844952, -39.71471166523523, -28.050655659625107, 11.908004149416815, -3.6551479440561714, -37.02476000726533, -29.682155748983497, -20.455248912776764, -27.464395534150512, -33.631207599207805, -38.039216253126746, -30.833816076801895, -19.417170450701466, -37.14210094419532, -40.43190092373695, -28.151992779557215, -24.138818386466983, 23.704173692394185, -28.94782752105948, -4.626441956326975, -43.010816448621355, -25.14876830314909, -17.435623233093093, -24.567554892173018, -17.823825776626528, -4.204478843824088, -38.13666425844644, -28.13103750951211, -11.174593255728688, -4.231503175888605, -32.45472314237923, 8.48222097757634, -2.951082786956171, -17.001859211099493, -0.27994186028798396, -43.59156297930823, -20.295512526838056, 4.022609522230652, -4.176989022844369, 8.398298498068531, -8.340535829402434, 11.981624747650162, -16.15691908589294, -3.470148299621748, -23.90613089433103, -37.07078864682707, -32.67583839625723, -4.026166530043014, -34.299975074722255, -30.044342554278664, -27.2787629763696, -26.82723600985947, -35.53069321407141, -13.420215168479082, -23.605929436270443, -11.62339963097439, -27.41634418822249, -53.62909005755817, -44.050726591736066, -4.069764285391564, -4.830326778705327, -53.32281474375039, -34.975725140256145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3896953256581638, "mean_inference_ms": 0.9670072858897967, "mean_action_processing_ms": 0.16555954212783125, "mean_env_wait_ms": 0.057645647679894586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003440380096435547, "StateBufferConnector_ms": 0.003350973129272461, "ViewRequirementAgentConnector_ms": 0.06506061553955078}, "num_episodes": 22, "episode_return_max": 100.23631932011267, "episode_return_min": -195.3596332985884, "episode_return_mean": -91.90614529486784}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 481.0187684071101, "num_env_steps_trained_throughput_per_sec": 481.0187684071101, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 8473.448, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8473.413, "sample_time_ms": 737.745, "learn_time_ms": 7723.417, "learn_throughput": 517.905, "synch_weights_time_ms": 11.689}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "training_iteration": 46, "trial_id": "eaa30_00000", "date": "2024-08-09_17-46-26", "timestamp": 1723239986, "time_this_iter_s": 8.321499109268188, "time_total_s": 376.39322781562805, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf2dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 376.39322781562805, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 22.724999999999998, "ram_util_percent": 80.78333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.266587854693175, "cur_kl_coeff": 0.810914611816406, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.15405583810554, "policy_loss": -0.008481165428187639, "vf_loss": 6.155723472877785, "vf_explained_var": 0.2841872109307183, "kl": 0.008402274723938376, "entropy": 1.5542349954130787, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.538967670376102, "cur_kl_coeff": 8.210510444641114, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.268743163347244, "policy_loss": 0.00041440630278278455, "vf_loss": 7.258893155058225, "vf_explained_var": 0.2586496372396747, "kl": 0.0011492137329393397, "entropy": 0.7903399971003334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "env_runners": {"episode_reward_max": 100.23631932011267, "episode_reward_min": -195.3596332985884, "episode_reward_mean": -78.93661665494751, "episode_len_mean": 192.89, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19289, "policy_reward_min": {"agent_policy": -97.6798166492942, "adversary_policy": -55.539322964960405}, "policy_reward_max": {"agent_policy": 50.11815966005626, "adversary_policy": 50.01051981643725}, "policy_reward_mean": {"agent_policy": -39.46830832747376, "adversary_policy": -19.73415416373688}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-145.11632329047208, -94.46573924075422, -119.89209936713243, 100.23631932011267, -116.31707257987937, -134.75105204075328, -116.98080250791023, -32.30398193429705, -146.16942797037692, -140.9832936001344, -100.61942099825103, -64.95937739182648, -134.31669609641483, -184.42211994746867, -13.68300996572043, -58.659044614436965, -147.68234152457535, -156.43873597235435, -48.11428921410854, -74.33339224664252, -149.2517133109676, -0.8550726181170774, -153.50639766281068, -175.54540797364507, -39.93084032655053, -71.96510239585922, -72.21997323146982, -58.13849106306462, -74.79203536785997, -60.1081941615078, -128.34910674158766, -71.6403603710119, -146.92313233334366, -98.65071414494236, -138.92419840620852, -87.574040099223, -83.74757608643358, -86.72166194907435, -133.40240012860284, -7.998987783783839, -105.92254808916724, -93.59315934668098, 50.00029091312166, -101.91573354802424, -105.54551936881165, -143.59372136392432, -103.40828443575501, -20.727567308200058, -70.35199653195184, -135.53073464972067, 16.505712410721287, -133.41383151249778, -95.83928889385459, -143.34084770466887, -100.50197305500672, -155.14800373586462, -104.58162233204848, -10.48730765733059, -95.27451680989672, -85.16878307248439, -84.78276133759903, -84.68228620454104, -78.61126153048161, -73.37245263653577, 11.062276381240316, -34.56360214277498, -127.77415101229255, -0.30875900122743327, 0.115525337332258, -8.350588676485557, -54.75255838790555, -139.4932540861686, -76.65228320953062, -114.64621106129664, -124.7158584478615, -74.05228920949911, -78.07948763839393, -195.3596332985884, -17.800182128193782, -176.5970797680132, -92.49503593545438, 47.01868226335962, -134.03627677515144, 72.59252086260888, 56.33511835982855, -60.38993698695092, -25.323277851705285, -78.58042844308622, -84.81913060209857, -130.68483387700945, -158.57619994149155, -43.821876387450075, -85.73419652736919, 33.85724508508602, 89.7602444748516, -131.6328660998374, 3.8151947236297516, -18.06014586338165, -122.28527879114444, 10.872454308337097], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 44, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-72.55816164523605, -47.23286962037708, -59.94604968356625, 50.11815966005626, -58.15853628993963, -67.3755260203767, -58.49040125395506, -16.151990967148514, -73.08471398518842, -70.49164680006727, -50.30971049912546, -32.47968869591324, -67.15834804820742, -92.21105997373436, -6.841504982860194, -29.32952230721846, -73.84117076228766, -78.21936798617716, -24.057144607054283, -37.166696123321266, -74.62585665548373, -0.4275363090585387, -76.75319883140554, -87.77270398682245, -19.965420163275265, -35.982551197929624, -36.1099866157349, -29.069245531532303, -37.396017683929934, -30.05409708075387, -64.17455337079383, -35.82018018550596, -73.4615661666719, -49.32535707247119, -69.46209920310412, -43.78702004961151, -41.873788043216734, -43.360830974537215, -66.70120006430152, -3.999493891891902, -52.96127404458359, -46.79657967334042, 25.00014545656082, -50.957866774012146, -52.7727596844058, -71.7968606819621, -51.70414221787745, -10.363783654100029, -35.17599826597596, -67.7653673248603, 8.252856205360644, -66.70691575624882, -47.91964444692729, -71.67042385233451, -50.25098652750336, -77.57400186793234, -52.290811166024206, -5.243653828665295, -47.63725840494832, -42.58439153624219, -42.39138066879949, -42.34114310227053, -39.3056307652408, -36.686226318267835, 5.531138190620169, -17.281801071387477, -63.88707550614626, -0.15437950061371664, 0.05776266866612545, -4.175294338242782, -27.376279193952776, -69.74662704308425, -38.32614160476527, -57.32310553064826, -62.357929223930874, -37.02614460474953, -39.03974381919688, -97.6798166492942, -8.900091064096891, -88.29853988400663, -46.247517967727255, 23.509341131679804, -67.01813838757572, 36.296260431304475, 28.1675591799143, -30.19496849347546, -12.661638925852646, -39.29021422154311, -42.40956530104932, -65.34241693850473, -79.2880999707457, -21.91093819372502, -42.86709826368464, 16.928622542543007, 44.880122237425724, -65.8164330499187, 1.9075973618148243, -9.030072931690809, -61.142639395572346, 5.436227154168549], "policy_adversary_policy_reward": [-36.96866886695232, -35.58949277828378, -21.482141363199087, -25.750728257177997, -21.533301864262384, -38.412747819303874, 50.01051981643725, 0.10763984361905798, -45.489753451219265, -12.668782838720368, -18.99353628640043, -48.38198973397628, -28.774898275112207, -29.715502978842856, -12.345994765658006, -3.805996201490508, -36.90530124549661, -36.17941273969182, -33.33903250707973, -37.152614292987536, -27.971580511700616, -22.338129987424843, -13.331485633415205, -19.148203062498034, -40.30657293733195, -26.85177511087545, -36.67173700877391, -55.539322964960405, 4.009138296673463, -10.850643279533656, -26.329964286572203, -2.999558020646253, -43.86909161924336, -29.97207914304429, -40.659717075673704, -37.55965091050344, -12.17127398065631, -11.885870626397988, -2.671866236737486, -34.49482988658379, -44.90760443016956, -29.71825222531416, -9.063735111811958, 8.63619880275342, -45.61110613278137, -31.142092698624054, -48.60436405026531, -39.16833993655718, -21.362153845497584, 1.3967336822223189, -41.68885651156189, 5.706305313632264, -32.61250716435707, -3.4974794513778455, -18.08099887861004, -10.988246652922264, -13.444440661666953, -23.951577022262985, -24.671914887672433, -5.382182193081436, -45.12652090149163, -19.0480324693022, -23.514066984333745, -12.306113201172217, -29.07450768990042, -44.38705847677146, -23.885729330778624, -25.439627741692565, -32.90478782787611, -36.55731137522799, -31.582834878222208, -12.204185171389305, -31.798423434128097, -10.075364609088638, -31.24867956213783, -12.112151412399374, -34.493336972153, -32.20786309214851, -1.700334342248624, -2.2991595496433064, -23.20761203695435, -29.75366200762924, -26.919019881944237, -19.877559791396184, -3.0374315483614396, 28.03757700492226, -27.01290962941353, -23.94495714459861, -42.88515982871727, -9.887599855688535, -30.259339767278227, -41.53752091468393, -25.202798896139406, -26.50134332173804, -7.409369591521049, -2.95441406257898, 9.966177682473543, -45.14217594844952, -39.71471166523523, -28.050655659625107, 11.908004149416815, -3.6551479440561714, -37.02476000726533, -29.682155748983497, -20.455248912776764, -27.464395534150512, -33.631207599207805, -38.039216253126746, -30.833816076801895, -19.417170450701466, -37.14210094419532, -40.43190092373695, -28.151992779557215, -24.138818386466983, 23.704173692394185, -28.94782752105948, -4.626441956326975, -43.010816448621355, -25.14876830314909, -17.435623233093093, -24.567554892173018, -17.823825776626528, -4.204478843824088, -38.13666425844644, -28.13103750951211, -11.174593255728688, -4.231503175888605, -32.45472314237923, 8.48222097757634, -2.951082786956171, -17.001859211099493, -0.27994186028798396, -43.59156297930823, -20.295512526838056, 4.022609522230652, -4.176989022844369, 8.398298498068531, -8.340535829402434, 11.981624747650162, -16.15691908589294, -3.470148299621748, -23.90613089433103, -37.07078864682707, -32.67583839625723, -4.026166530043014, -34.299975074722255, -30.044342554278664, -27.2787629763696, -26.82723600985947, -35.53069321407141, -13.420215168479082, -23.605929436270443, -11.62339963097439, -27.41634418822249, -53.62909005755817, -44.050726591736066, -4.069764285391564, -4.830326778705327, -53.32281474375039, -34.975725140256145, -19.994789275674275, -26.252728692052976, 16.66837848944676, 6.840962642233038, -42.02116513067143, -24.996973256904276, 0.4839945670543493, 35.812265864250136, 47.08420935111114, -18.916650171196853, -25.047961168406648, -5.147007325068813, -19.965105970247553, 7.303467044394907, -9.686856443323293, -29.603357778219817, -13.030591055799729, -29.37897424524959, -35.733573905002196, -29.60884303350251, -47.10652275770758, -32.18157721303818, 9.497827687334535, -31.40876588105956, -27.043473627711695, -15.823624635972948, 29.977821672205398, -13.049199129662393, 19.433773807474168, 25.44634842995156, -43.06341457082688, -22.75301847909182, -9.667020581649558, 11.574617943464375, -3.6097908489886397, -5.420282082702187, -19.349314159593543, -41.793325235978784, -0.532283586841622, 5.968510741010171]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3894502628165982, "mean_inference_ms": 0.966638271331307, "mean_action_processing_ms": 0.16550994434743377, "mean_env_wait_ms": 0.05760501705261412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033491849899291992, "StateBufferConnector_ms": 0.0032368898391723633, "ViewRequirementAgentConnector_ms": 0.06311023235321045}, "num_episodes": 20, "episode_return_max": 100.23631932011267, "episode_return_min": -195.3596332985884, "episode_return_mean": -78.93661665494751}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 470.3718738455157, "num_env_steps_trained_throughput_per_sec": 470.3718738455157, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 564000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 8499.624, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8499.59, "sample_time_ms": 738.769, "learn_time_ms": 7748.435, "learn_throughput": 516.233, "synch_weights_time_ms": 11.871}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "training_iteration": 47, "trial_id": "eaa30_00000", "date": "2024-08-09_17-46-34", "timestamp": 1723239994, "time_this_iter_s": 8.509184837341309, "time_total_s": 384.90241265296936, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf7670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 384.90241265296936, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 22.75, "ram_util_percent": 80.67500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.9908361115152875, "cur_kl_coeff": 0.810914611816406, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.126648206307144, "policy_loss": -0.009118583502504166, "vf_loss": 6.127984338084226, "vf_explained_var": 0.34343086594627015, "kl": 0.009597120214273374, "entropy": 1.559543827475694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.006174820599457, "cur_kl_coeff": 4.105255222320557, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.615619553625583, "policy_loss": 0.005430386485143875, "vf_loss": 7.606268768509229, "vf_explained_var": 0.24102212078869342, "kl": 0.0009549694630247056, "entropy": 0.7638082432871064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 89.80283410456914, "episode_reward_min": -195.3596332985884, "episode_reward_mean": -71.01692050523195, "episode_len_mean": 189.05, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18905, "policy_reward_min": {"agent_policy": -97.6798166492942, "adversary_policy": -53.62909005755817}, "policy_reward_max": {"agent_policy": 44.901417052284515, "adversary_policy": 47.08420935111114}, "policy_reward_mean": {"agent_policy": -35.508460252615976, "adversary_policy": -17.754230126307984}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153.50639766281068, -175.54540797364507, -39.93084032655053, -71.96510239585922, -72.21997323146982, -58.13849106306462, -74.79203536785997, -60.1081941615078, -128.34910674158766, -71.6403603710119, -146.92313233334366, -98.65071414494236, -138.92419840620852, -87.574040099223, -83.74757608643358, -86.72166194907435, -133.40240012860284, -7.998987783783839, -105.92254808916724, -93.59315934668098, 50.00029091312166, -101.91573354802424, -105.54551936881165, -143.59372136392432, -103.40828443575501, -20.727567308200058, -70.35199653195184, -135.53073464972067, 16.505712410721287, -133.41383151249778, -95.83928889385459, -143.34084770466887, -100.50197305500672, -155.14800373586462, -104.58162233204848, -10.48730765733059, -95.27451680989672, -85.16878307248439, -84.78276133759903, -84.68228620454104, -78.61126153048161, -73.37245263653577, 11.062276381240316, -34.56360214277498, -127.77415101229255, -0.30875900122743327, 0.115525337332258, -8.350588676485557, -54.75255838790555, -139.4932540861686, -76.65228320953062, -114.64621106129664, -124.7158584478615, -74.05228920949911, -78.07948763839393, -195.3596332985884, -17.800182128193782, -176.5970797680132, -92.49503593545438, 47.01868226335962, -134.03627677515144, 72.59252086260888, 56.33511835982855, -60.38993698695092, -25.323277851705285, -78.58042844308622, -84.81913060209857, -130.68483387700945, -158.57619994149155, -43.821876387450075, -85.73419652736919, 33.85724508508602, 89.7602444748516, -131.6328660998374, 3.8151947236297516, -18.06014586338165, -122.28527879114444, 10.872454308337097, -117.56191991718148, -27.744550330594954, -177.59360451598445, -72.13289967226834, -7.02427095286378, -85.00450084718369, -11.278679932150329, -43.18999017992775, -60.12327314150883, -140.92737703839856, -51.60844027454727, -105.6286956551262, -106.17471863035658, 6.757502754453402, -47.746375206186215, 15.304506718151242, -64.79126881924601, -123.60848469583593, 89.80283410456914, 2.917429606122306, -42.88992884709586, -117.86236666776364], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 44, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 3, 200, 200], "policy_agent_policy_reward": [-76.75319883140554, -87.77270398682245, -19.965420163275265, -35.982551197929624, -36.1099866157349, -29.069245531532303, -37.396017683929934, -30.05409708075387, -64.17455337079383, -35.82018018550596, -73.4615661666719, -49.32535707247119, -69.46209920310412, -43.78702004961151, -41.873788043216734, -43.360830974537215, -66.70120006430152, -3.999493891891902, -52.96127404458359, -46.79657967334042, 25.00014545656082, -50.957866774012146, -52.7727596844058, -71.7968606819621, -51.70414221787745, -10.363783654100029, -35.17599826597596, -67.7653673248603, 8.252856205360644, -66.70691575624882, -47.91964444692729, -71.67042385233451, -50.25098652750336, -77.57400186793234, -52.290811166024206, -5.243653828665295, -47.63725840494832, -42.58439153624219, -42.39138066879949, -42.34114310227053, -39.3056307652408, -36.686226318267835, 5.531138190620169, -17.281801071387477, -63.88707550614626, -0.15437950061371664, 0.05776266866612545, -4.175294338242782, -27.376279193952776, -69.74662704308425, -38.32614160476527, -57.32310553064826, -62.357929223930874, -37.02614460474953, -39.03974381919688, -97.6798166492942, -8.900091064096891, -88.29853988400663, -46.247517967727255, 23.509341131679804, -67.01813838757572, 36.296260431304475, 28.1675591799143, -30.19496849347546, -12.661638925852646, -39.29021422154311, -42.40956530104932, -65.34241693850473, -79.2880999707457, -21.91093819372502, -42.86709826368464, 16.928622542543007, 44.880122237425724, -65.8164330499187, 1.9075973618148243, -9.030072931690809, -61.142639395572346, 5.436227154168549, -58.78095995859075, -13.872275165297477, -88.79680225799224, -36.066449836134154, -3.51213547643189, -42.50225042359185, -5.639339966075164, -21.594995089963874, -30.061636570754402, -70.46368851919918, -25.80422013727364, -52.814347827563, -53.08735931517835, 3.378751377226701, -23.873187603093108, 7.652253359075619, -32.395634409623014, -61.804242347917935, 44.901417052284515, 1.458714803061153, -21.444964423547937, -58.93118333388179], "policy_adversary_policy_reward": [-45.61110613278137, -31.142092698624054, -48.60436405026531, -39.16833993655718, -21.362153845497584, 1.3967336822223189, -41.68885651156189, 5.706305313632264, -32.61250716435707, -3.4974794513778455, -18.08099887861004, -10.988246652922264, -13.444440661666953, -23.951577022262985, -24.671914887672433, -5.382182193081436, -45.12652090149163, -19.0480324693022, -23.514066984333745, -12.306113201172217, -29.07450768990042, -44.38705847677146, -23.885729330778624, -25.439627741692565, -32.90478782787611, -36.55731137522799, -31.582834878222208, -12.204185171389305, -31.798423434128097, -10.075364609088638, -31.24867956213783, -12.112151412399374, -34.493336972153, -32.20786309214851, -1.700334342248624, -2.2991595496433064, -23.20761203695435, -29.75366200762924, -26.919019881944237, -19.877559791396184, -3.0374315483614396, 28.03757700492226, -27.01290962941353, -23.94495714459861, -42.88515982871727, -9.887599855688535, -30.259339767278227, -41.53752091468393, -25.202798896139406, -26.50134332173804, -7.409369591521049, -2.95441406257898, 9.966177682473543, -45.14217594844952, -39.71471166523523, -28.050655659625107, 11.908004149416815, -3.6551479440561714, -37.02476000726533, -29.682155748983497, -20.455248912776764, -27.464395534150512, -33.631207599207805, -38.039216253126746, -30.833816076801895, -19.417170450701466, -37.14210094419532, -40.43190092373695, -28.151992779557215, -24.138818386466983, 23.704173692394185, -28.94782752105948, -4.626441956326975, -43.010816448621355, -25.14876830314909, -17.435623233093093, -24.567554892173018, -17.823825776626528, -4.204478843824088, -38.13666425844644, -28.13103750951211, -11.174593255728688, -4.231503175888605, -32.45472314237923, 8.48222097757634, -2.951082786956171, -17.001859211099493, -0.27994186028798396, -43.59156297930823, -20.295512526838056, 4.022609522230652, -4.176989022844369, 8.398298498068531, -8.340535829402434, 11.981624747650162, -16.15691908589294, -3.470148299621748, -23.90613089433103, -37.07078864682707, -32.67583839625723, -4.026166530043014, -34.299975074722255, -30.044342554278664, -27.2787629763696, -26.82723600985947, -35.53069321407141, -13.420215168479082, -23.605929436270443, -11.62339963097439, -27.41634418822249, -53.62909005755817, -44.050726591736066, -4.069764285391564, -4.830326778705327, -53.32281474375039, -34.975725140256145, -19.994789275674275, -26.252728692052976, 16.66837848944676, 6.840962642233038, -42.02116513067143, -24.996973256904276, 0.4839945670543493, 35.812265864250136, 47.08420935111114, -18.916650171196853, -25.047961168406648, -5.147007325068813, -19.965105970247553, 7.303467044394907, -9.686856443323293, -29.603357778219817, -13.030591055799729, -29.37897424524959, -35.733573905002196, -29.60884303350251, -47.10652275770758, -32.18157721303818, 9.497827687334535, -31.40876588105956, -27.043473627711695, -15.823624635972948, 29.977821672205398, -13.049199129662393, 19.433773807474168, 25.44634842995156, -43.06341457082688, -22.75301847909182, -9.667020581649558, 11.574617943464375, -3.6097908489886397, -5.420282082702187, -19.349314159593543, -41.793325235978784, -0.532283586841622, 5.968510741010171, -19.84398316194271, -38.936976796648004, -0.5841487326061738, -13.288126432691303, -53.53725372302388, -35.25954853496843, -9.068097484535457, -26.998352351598697, 9.819813887287616, -13.331949363719506, -11.501726012035622, -31.000524411556228, -15.212396322953758, 9.573056356878595, 7.144970527266921, -28.739965617230794, -14.902150603049797, -15.159485967704605, -33.956830770707995, -36.50685774849115, -18.879391650333186, -6.924828486940452, -25.974976304551912, -26.839371523011074, -17.64315298941092, -35.44420632576738, -18.520889917651644, 21.899641294878347, -13.238558572854629, -10.634629030238479, -6.383405312427698, 14.035658671503318, -23.011660615210662, -9.383973794412352, -38.65667197322206, -23.147570374695874, 18.5713620408187, 26.33005501146583, 1.3882868345685366, 0.07042796849261634, -38.23159898694167, 16.786634563393736, -22.080767316627295, -36.85041601725449]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38914067204842495, "mean_inference_ms": 0.9661413959370466, "mean_action_processing_ms": 0.16536891359990094, "mean_env_wait_ms": 0.057507179304071114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033549070358276367, "StateBufferConnector_ms": 0.0032864809036254883, "ViewRequirementAgentConnector_ms": 0.06407654285430908}, "num_episodes": 22, "episode_return_max": 89.80283410456914, "episode_return_min": -195.3596332985884, "episode_return_mean": -71.01692050523195}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 492.6181632675952, "num_env_steps_trained_throughput_per_sec": 492.6181632675952, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 8465.985, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8465.951, "sample_time_ms": 740.565, "learn_time_ms": 7713.149, "learn_throughput": 518.595, "synch_weights_time_ms": 11.791}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 48, "trial_id": "eaa30_00000", "date": "2024-08-09_17-46-43", "timestamp": 1723240003, "time_this_iter_s": 8.125826835632324, "time_total_s": 393.0282394886017, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf7940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 393.0282394886017, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 22.46666666666667, "ram_util_percent": 80.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.291547334383404, "cur_kl_coeff": 0.810914611816406, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.829399428796516, "policy_loss": -0.003920688397970504, "vf_loss": 5.827415491538073, "vf_explained_var": 0.458102622517833, "kl": 0.007281437918553671, "entropy": 1.5522141286305018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.560358289132516, "cur_kl_coeff": 2.0526276111602786, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.7272745847702025, "policy_loss": -0.0017264908410046095, "vf_loss": 7.727509585519631, "vf_explained_var": 0.2772826811298728, "kl": 0.0007266129465885266, "entropy": 0.7718915128459533, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "env_runners": {"episode_reward_max": 126.18842866613448, "episode_reward_min": -195.3596332985884, "episode_reward_mean": -52.450991790538936, "episode_len_mean": 186.96, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18696, "policy_reward_min": {"agent_policy": -97.6798166492942, "adversary_policy": -53.62909005755817}, "policy_reward_max": {"agent_policy": 63.09421433306724, "adversary_policy": 47.08420935111114}, "policy_reward_mean": {"agent_policy": -26.225495895269468, "adversary_policy": -13.112747947634734}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105.54551936881165, -143.59372136392432, -103.40828443575501, -20.727567308200058, -70.35199653195184, -135.53073464972067, 16.505712410721287, -133.41383151249778, -95.83928889385459, -143.34084770466887, -100.50197305500672, -155.14800373586462, -104.58162233204848, -10.48730765733059, -95.27451680989672, -85.16878307248439, -84.78276133759903, -84.68228620454104, -78.61126153048161, -73.37245263653577, 11.062276381240316, -34.56360214277498, -127.77415101229255, -0.30875900122743327, 0.115525337332258, -8.350588676485557, -54.75255838790555, -139.4932540861686, -76.65228320953062, -114.64621106129664, -124.7158584478615, -74.05228920949911, -78.07948763839393, -195.3596332985884, -17.800182128193782, -176.5970797680132, -92.49503593545438, 47.01868226335962, -134.03627677515144, 72.59252086260888, 56.33511835982855, -60.38993698695092, -25.323277851705285, -78.58042844308622, -84.81913060209857, -130.68483387700945, -158.57619994149155, -43.821876387450075, -85.73419652736919, 33.85724508508602, 89.7602444748516, -131.6328660998374, 3.8151947236297516, -18.06014586338165, -122.28527879114444, 10.872454308337097, -117.56191991718148, -27.744550330594954, -177.59360451598445, -72.13289967226834, -7.02427095286378, -85.00450084718369, -11.278679932150329, -43.18999017992775, -60.12327314150883, -140.92737703839856, -51.60844027454727, -105.6286956551262, -106.17471863035658, 6.757502754453402, -47.746375206186215, 15.304506718151242, -64.79126881924601, -123.60848469583593, 89.80283410456914, 2.917429606122306, -42.88992884709586, -117.86236666776364, 39.18538389109307, 66.14495808361124, 21.859674147573365, 47.51178906698263, -45.95271714550152, -68.07085839027366, -13.878981478335774, -46.337407411137065, -28.85722490931535, -10.168451733866881, -40.98181896098945, -43.624749830185394, -58.184841240993734, -20.82942512359371, 65.87219551943997, 17.358906406358866, -63.64119119496025, 126.18842866613448, -42.80919883932157, 17.727048436475577, -25.81945439549129, 22.331037607868133], "episode_lengths": [200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 44, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 3, 200, 200, 200, 200, 12, 163, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 199, 178, 200, 141, 200, 145, 182, 200], "policy_agent_policy_reward": [-52.7727596844058, -71.7968606819621, -51.70414221787745, -10.363783654100029, -35.17599826597596, -67.7653673248603, 8.252856205360644, -66.70691575624882, -47.91964444692729, -71.67042385233451, -50.25098652750336, -77.57400186793234, -52.290811166024206, -5.243653828665295, -47.63725840494832, -42.58439153624219, -42.39138066879949, -42.34114310227053, -39.3056307652408, -36.686226318267835, 5.531138190620169, -17.281801071387477, -63.88707550614626, -0.15437950061371664, 0.05776266866612545, -4.175294338242782, -27.376279193952776, -69.74662704308425, -38.32614160476527, -57.32310553064826, -62.357929223930874, -37.02614460474953, -39.03974381919688, -97.6798166492942, -8.900091064096891, -88.29853988400663, -46.247517967727255, 23.509341131679804, -67.01813838757572, 36.296260431304475, 28.1675591799143, -30.19496849347546, -12.661638925852646, -39.29021422154311, -42.40956530104932, -65.34241693850473, -79.2880999707457, -21.91093819372502, -42.86709826368464, 16.928622542543007, 44.880122237425724, -65.8164330499187, 1.9075973618148243, -9.030072931690809, -61.142639395572346, 5.436227154168549, -58.78095995859075, -13.872275165297477, -88.79680225799224, -36.066449836134154, -3.51213547643189, -42.50225042359185, -5.639339966075164, -21.594995089963874, -30.061636570754402, -70.46368851919918, -25.80422013727364, -52.814347827563, -53.08735931517835, 3.378751377226701, -23.873187603093108, 7.652253359075619, -32.395634409623014, -61.804242347917935, 44.901417052284515, 1.458714803061153, -21.444964423547937, -58.93118333388179, 19.592691945546537, 33.07247904180557, 10.929837073786684, 23.755894533491354, -22.976358572750783, -34.035429195136835, -6.939490739167871, -23.168703705568547, -14.428612454657685, -5.084225866933442, -20.49090948049472, -21.812374915092736, -29.092420620496874, -10.41471256179686, 32.93609775971994, 8.679453203179435, -31.820595597480114, 63.09421433306724, -21.40459941966087, 8.863524218237789, -12.909727197745656, 11.165518803934072], "policy_adversary_policy_reward": [-42.88515982871727, -9.887599855688535, -30.259339767278227, -41.53752091468393, -25.202798896139406, -26.50134332173804, -7.409369591521049, -2.95441406257898, 9.966177682473543, -45.14217594844952, -39.71471166523523, -28.050655659625107, 11.908004149416815, -3.6551479440561714, -37.02476000726533, -29.682155748983497, -20.455248912776764, -27.464395534150512, -33.631207599207805, -38.039216253126746, -30.833816076801895, -19.417170450701466, -37.14210094419532, -40.43190092373695, -28.151992779557215, -24.138818386466983, 23.704173692394185, -28.94782752105948, -4.626441956326975, -43.010816448621355, -25.14876830314909, -17.435623233093093, -24.567554892173018, -17.823825776626528, -4.204478843824088, -38.13666425844644, -28.13103750951211, -11.174593255728688, -4.231503175888605, -32.45472314237923, 8.48222097757634, -2.951082786956171, -17.001859211099493, -0.27994186028798396, -43.59156297930823, -20.295512526838056, 4.022609522230652, -4.176989022844369, 8.398298498068531, -8.340535829402434, 11.981624747650162, -16.15691908589294, -3.470148299621748, -23.90613089433103, -37.07078864682707, -32.67583839625723, -4.026166530043014, -34.299975074722255, -30.044342554278664, -27.2787629763696, -26.82723600985947, -35.53069321407141, -13.420215168479082, -23.605929436270443, -11.62339963097439, -27.41634418822249, -53.62909005755817, -44.050726591736066, -4.069764285391564, -4.830326778705327, -53.32281474375039, -34.975725140256145, -19.994789275674275, -26.252728692052976, 16.66837848944676, 6.840962642233038, -42.02116513067143, -24.996973256904276, 0.4839945670543493, 35.812265864250136, 47.08420935111114, -18.916650171196853, -25.047961168406648, -5.147007325068813, -19.965105970247553, 7.303467044394907, -9.686856443323293, -29.603357778219817, -13.030591055799729, -29.37897424524959, -35.733573905002196, -29.60884303350251, -47.10652275770758, -32.18157721303818, 9.497827687334535, -31.40876588105956, -27.043473627711695, -15.823624635972948, 29.977821672205398, -13.049199129662393, 19.433773807474168, 25.44634842995156, -43.06341457082688, -22.75301847909182, -9.667020581649558, 11.574617943464375, -3.6097908489886397, -5.420282082702187, -19.349314159593543, -41.793325235978784, -0.532283586841622, 5.968510741010171, -19.84398316194271, -38.936976796648004, -0.5841487326061738, -13.288126432691303, -53.53725372302388, -35.25954853496843, -9.068097484535457, -26.998352351598697, 9.819813887287616, -13.331949363719506, -11.501726012035622, -31.000524411556228, -15.212396322953758, 9.573056356878595, 7.144970527266921, -28.739965617230794, -14.902150603049797, -15.159485967704605, -33.956830770707995, -36.50685774849115, -18.879391650333186, -6.924828486940452, -25.974976304551912, -26.839371523011074, -17.64315298941092, -35.44420632576738, -18.520889917651644, 21.899641294878347, -13.238558572854629, -10.634629030238479, -6.383405312427698, 14.035658671503318, -23.011660615210662, -9.383973794412352, -38.65667197322206, -23.147570374695874, 18.5713620408187, 26.33005501146583, 1.3882868345685366, 0.07042796849261634, -38.23159898694167, 16.786634563393736, -22.080767316627295, -36.85041601725449, 11.820127167068957, 7.77256477847758, 13.69770469236309, 19.374774349442482, 3.348378522246364, 7.581458551540321, 20.65143316843086, 3.104461365060473, -13.490204142092889, -9.486154430657894, -12.408065410273423, -21.627363784863412, -3.321463432238261, -3.618027306929619, -12.017442823554568, -11.151260882013979, -35.802732897830445, 21.374120443172753, 0.2050548233469982, -5.289280690280441, -17.31813280497324, -3.172776675521483, -41.85751324265889, 20.045138327566136, -24.59781064254113, -4.494609977955747, -7.1669022834121705, -3.24781027838469, 11.902434058427392, 21.03366370129257, 22.627905144770587, -13.948451941591152, -12.23175976523305, -19.588835832247057, 32.90571177039284, 30.18850256267439, -19.615795732337396, -1.7888036873234725, 19.86101723015298, -10.997493011915193, -17.095949011594914, 4.186221813849251, -21.368844816122706, 32.534363620056766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38896518764664634, "mean_inference_ms": 0.966104232841753, "mean_action_processing_ms": 0.16517972927624297, "mean_env_wait_ms": 0.05740258465220102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003355264663696289, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.0652933120727539}, "num_episodes": 22, "episode_return_max": 126.18842866613448, "episode_return_min": -195.3596332985884, "episode_return_mean": -52.450991790538936}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 471.15700820808576, "num_env_steps_trained_throughput_per_sec": 471.15700820808576, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 588000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 8473.984, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8473.95, "sample_time_ms": 739.355, "learn_time_ms": 7722.436, "learn_throughput": 517.971, "synch_weights_time_ms": 11.707}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "training_iteration": 49, "trial_id": "eaa30_00000", "date": "2024-08-09_17-46-51", "timestamp": 1723240011, "time_this_iter_s": 8.494969844818115, "time_total_s": 401.5232093334198, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf79d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 401.5232093334198, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 22.433333333333334, "ram_util_percent": 79.94166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.373707009560217, "cur_kl_coeff": 0.810914611816406, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.087317853251462, "policy_loss": -0.0068363384269769225, "vf_loss": 6.088557931859658, "vf_explained_var": 0.2972862671922754, "kl": 0.006901169886625318, "entropy": 1.5425342149204677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.154976367515822, "cur_kl_coeff": 1.0263138055801393, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.666324440141519, "policy_loss": -0.0004498445263986165, "vf_loss": 7.665321369965871, "vf_explained_var": 0.3958823829268416, "kl": 0.0014156805130066156, "entropy": 0.7729576744139195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 126.18842866613448, "episode_reward_min": -195.3596332985884, "episode_reward_mean": -34.078536911847586, "episode_len_mean": 186.51, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 18651, "policy_reward_min": {"agent_policy": -97.6798166492942, "adversary_policy": -53.62909005755817}, "policy_reward_max": {"agent_policy": 63.09421433306724, "adversary_policy": 47.08420935111114}, "policy_reward_mean": {"agent_policy": -17.039268455923793, "adversary_policy": -8.519634227961895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.115525337332258, -8.350588676485557, -54.75255838790555, -139.4932540861686, -76.65228320953062, -114.64621106129664, -124.7158584478615, -74.05228920949911, -78.07948763839393, -195.3596332985884, -17.800182128193782, -176.5970797680132, -92.49503593545438, 47.01868226335962, -134.03627677515144, 72.59252086260888, 56.33511835982855, -60.38993698695092, -25.323277851705285, -78.58042844308622, -84.81913060209857, -130.68483387700945, -158.57619994149155, -43.821876387450075, -85.73419652736919, 33.85724508508602, 89.7602444748516, -131.6328660998374, 3.8151947236297516, -18.06014586338165, -122.28527879114444, 10.872454308337097, -117.56191991718148, -27.744550330594954, -177.59360451598445, -72.13289967226834, -7.02427095286378, -85.00450084718369, -11.278679932150329, -43.18999017992775, -60.12327314150883, -140.92737703839856, -51.60844027454727, -105.6286956551262, -106.17471863035658, 6.757502754453402, -47.746375206186215, 15.304506718151242, -64.79126881924601, -123.60848469583593, 89.80283410456914, 2.917429606122306, -42.88992884709586, -117.86236666776364, 39.18538389109307, 66.14495808361124, 21.859674147573365, 47.51178906698263, -45.95271714550152, -68.07085839027366, -13.878981478335774, -46.337407411137065, -28.85722490931535, -10.168451733866881, -40.98181896098945, -43.624749830185394, -58.184841240993734, -20.82942512359371, 65.87219551943997, 17.358906406358866, -63.64119119496025, 126.18842866613448, -42.80919883932157, 17.727048436475577, -25.81945439549129, 22.331037607868133, 6.007047244548591, -75.86093290244527, 8.780386954416027, 17.840371205124697, 106.42083552821677, 14.748272431671268, -34.377620471243745, 59.835602680122605, -55.43344232501917, 6.947014721783896, 18.4144668022251, -11.141198295733533, -100.69143410994471, -34.56102741919959, -82.40983434992668, 59.63904104755595, -7.649913929750408, 62.200303506256446, 114.01447693322957, -71.22546221079716, -3.3031991703024755, -0.9765956064778454, -47.44437006684693, -71.96858383383562], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 44, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 3, 200, 200, 200, 200, 12, 163, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 199, 178, 200, 141, 200, 145, 182, 200, 200, 200, 200, 91, 200, 39, 200, 174, 200, 187, 200, 200, 200, 200, 200, 200, 200, 150, 200, 200, 130, 200, 200, 200], "policy_agent_policy_reward": [0.05776266866612545, -4.175294338242782, -27.376279193952776, -69.74662704308425, -38.32614160476527, -57.32310553064826, -62.357929223930874, -37.02614460474953, -39.03974381919688, -97.6798166492942, -8.900091064096891, -88.29853988400663, -46.247517967727255, 23.509341131679804, -67.01813838757572, 36.296260431304475, 28.1675591799143, -30.19496849347546, -12.661638925852646, -39.29021422154311, -42.40956530104932, -65.34241693850473, -79.2880999707457, -21.91093819372502, -42.86709826368464, 16.928622542543007, 44.880122237425724, -65.8164330499187, 1.9075973618148243, -9.030072931690809, -61.142639395572346, 5.436227154168549, -58.78095995859075, -13.872275165297477, -88.79680225799224, -36.066449836134154, -3.51213547643189, -42.50225042359185, -5.639339966075164, -21.594995089963874, -30.061636570754402, -70.46368851919918, -25.80422013727364, -52.814347827563, -53.08735931517835, 3.378751377226701, -23.873187603093108, 7.652253359075619, -32.395634409623014, -61.804242347917935, 44.901417052284515, 1.458714803061153, -21.444964423547937, -58.93118333388179, 19.592691945546537, 33.07247904180557, 10.929837073786684, 23.755894533491354, -22.976358572750783, -34.035429195136835, -6.939490739167871, -23.168703705568547, -14.428612454657685, -5.084225866933442, -20.49090948049472, -21.812374915092736, -29.092420620496874, -10.41471256179686, 32.93609775971994, 8.679453203179435, -31.820595597480114, 63.09421433306724, -21.40459941966087, 8.863524218237789, -12.909727197745656, 11.165518803934072, 3.003523622274276, -37.93046645122264, 4.390193477208015, 8.92018560256235, 53.2104177641084, 7.37413621583563, -17.188810235621894, 29.91780134006131, -27.71672116250958, 3.473507360891947, 9.207233401112552, -5.570599147866748, -50.345717054972326, -17.280513709599795, -41.204917174963256, 29.819520523777953, -3.824956964875204, 31.100151753128245, 57.007238466614744, -35.61273110539858, -1.6515995851512182, -0.488297803238928, -23.722185033423465, -35.98429191691787], "policy_adversary_policy_reward": [8.398298498068531, -8.340535829402434, 11.981624747650162, -16.15691908589294, -3.470148299621748, -23.90613089433103, -37.07078864682707, -32.67583839625723, -4.026166530043014, -34.299975074722255, -30.044342554278664, -27.2787629763696, -26.82723600985947, -35.53069321407141, -13.420215168479082, -23.605929436270443, -11.62339963097439, -27.41634418822249, -53.62909005755817, -44.050726591736066, -4.069764285391564, -4.830326778705327, -53.32281474375039, -34.975725140256145, -19.994789275674275, -26.252728692052976, 16.66837848944676, 6.840962642233038, -42.02116513067143, -24.996973256904276, 0.4839945670543493, 35.812265864250136, 47.08420935111114, -18.916650171196853, -25.047961168406648, -5.147007325068813, -19.965105970247553, 7.303467044394907, -9.686856443323293, -29.603357778219817, -13.030591055799729, -29.37897424524959, -35.733573905002196, -29.60884303350251, -47.10652275770758, -32.18157721303818, 9.497827687334535, -31.40876588105956, -27.043473627711695, -15.823624635972948, 29.977821672205398, -13.049199129662393, 19.433773807474168, 25.44634842995156, -43.06341457082688, -22.75301847909182, -9.667020581649558, 11.574617943464375, -3.6097908489886397, -5.420282082702187, -19.349314159593543, -41.793325235978784, -0.532283586841622, 5.968510741010171, -19.84398316194271, -38.936976796648004, -0.5841487326061738, -13.288126432691303, -53.53725372302388, -35.25954853496843, -9.068097484535457, -26.998352351598697, 9.819813887287616, -13.331949363719506, -11.501726012035622, -31.000524411556228, -15.212396322953758, 9.573056356878595, 7.144970527266921, -28.739965617230794, -14.902150603049797, -15.159485967704605, -33.956830770707995, -36.50685774849115, -18.879391650333186, -6.924828486940452, -25.974976304551912, -26.839371523011074, -17.64315298941092, -35.44420632576738, -18.520889917651644, 21.899641294878347, -13.238558572854629, -10.634629030238479, -6.383405312427698, 14.035658671503318, -23.011660615210662, -9.383973794412352, -38.65667197322206, -23.147570374695874, 18.5713620408187, 26.33005501146583, 1.3882868345685366, 0.07042796849261634, -38.23159898694167, 16.786634563393736, -22.080767316627295, -36.85041601725449, 11.820127167068957, 7.77256477847758, 13.69770469236309, 19.374774349442482, 3.348378522246364, 7.581458551540321, 20.65143316843086, 3.104461365060473, -13.490204142092889, -9.486154430657894, -12.408065410273423, -21.627363784863412, -3.321463432238261, -3.618027306929619, -12.017442823554568, -11.151260882013979, -35.802732897830445, 21.374120443172753, 0.2050548233469982, -5.289280690280441, -17.31813280497324, -3.172776675521483, -41.85751324265889, 20.045138327566136, -24.59781064254113, -4.494609977955747, -7.1669022834121705, -3.24781027838469, 11.902434058427392, 21.03366370129257, 22.627905144770587, -13.948451941591152, -12.23175976523305, -19.588835832247057, 32.90571177039284, 30.18850256267439, -19.615795732337396, -1.7888036873234725, 19.86101723015298, -10.997493011915193, -17.095949011594914, 4.186221813849251, -21.368844816122706, 32.534363620056766, -8.773411107545499, 11.776934729819775, -26.752405610664823, -11.178060840557816, -14.793444234753675, 19.183637711961687, -17.0346285449084, 25.95481414747074, 30.873649671394077, 22.336768092714326, -2.8472640898359316, 10.221400305671564, -16.75647659674243, -0.43233363887946297, 11.099835670641498, 18.817965669419813, -32.87264467829508, 5.155923515785503, 10.117341934527467, -6.6438345736355195, 5.346193626997131, 3.861039774115415, -11.522713245027884, 5.952114097161102, -22.013878780806735, -28.331838274165584, -9.417015452316825, -7.86349825728297, -18.806834393607623, -22.39808278135562, 7.022434841932521, 22.797085681845445, 7.2963280928319865, -11.12128505770719, -14.202767645571846, 45.30291939870009, 40.721598562606225, 16.285639904008526, -20.579750711242973, -15.032980394155608, 8.912477812079349, -10.564077397230571, -12.283363878431533, 11.795066075192613, -8.778409185731853, -14.943775847691612, -23.90922845501472, -12.075063461903149]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.388655940358494, "mean_inference_ms": 0.9646910886129203, "mean_action_processing_ms": 0.1651853386543906, "mean_env_wait_ms": 0.057297412996799954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033081769943237305, "StateBufferConnector_ms": 0.0024144649505615234, "ViewRequirementAgentConnector_ms": 0.06449639797210693}, "num_episodes": 24, "episode_return_max": 126.18842866613448, "episode_return_min": -195.3596332985884, "episode_return_mean": -34.078536911847586}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 468.6381562246368, "num_env_steps_trained_throughput_per_sec": 468.6381562246368, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 8469.978, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8469.942, "sample_time_ms": 742.578, "learn_time_ms": 7712.876, "learn_throughput": 518.613, "synch_weights_time_ms": 13.973}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 50, "trial_id": "eaa30_00000", "date": "2024-08-09_17-47-00", "timestamp": 1723240020, "time_this_iter_s": 8.546101093292236, "time_total_s": 410.06931042671204, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf7ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 410.06931042671204, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 24.692307692307693, "ram_util_percent": 80.14615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.020987500589361, "cur_kl_coeff": 0.810914611816406, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.149175494562381, "policy_loss": -0.00823972711916126, "vf_loss": 6.1521610504735715, "vf_explained_var": 0.22182032267252605, "kl": 0.006479321577384201, "entropy": 1.5392453476865455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.527355910403033, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.692330834269524, "policy_loss": -0.0030152869095521357, "vf_loss": 7.694023827711741, "vf_explained_var": 0.2702301101759076, "kl": 0.002576826933788349, "entropy": 0.7603623445456227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "env_runners": {"episode_reward_max": 134.05509497005374, "episode_reward_min": -177.59360451598445, "episode_reward_mean": -17.745874374161588, "episode_len_mean": 181.51, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18151, "policy_reward_min": {"agent_policy": -88.79680225799224, "adversary_policy": -53.53725372302388}, "policy_reward_max": {"agent_policy": 67.02754748502684, "adversary_policy": 45.30291939870009}, "policy_reward_mean": {"agent_policy": -8.872937187080796, "adversary_policy": -4.436468593540398}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-130.68483387700945, -158.57619994149155, -43.821876387450075, -85.73419652736919, 33.85724508508602, 89.7602444748516, -131.6328660998374, 3.8151947236297516, -18.06014586338165, -122.28527879114444, 10.872454308337097, -117.56191991718148, -27.744550330594954, -177.59360451598445, -72.13289967226834, -7.02427095286378, -85.00450084718369, -11.278679932150329, -43.18999017992775, -60.12327314150883, -140.92737703839856, -51.60844027454727, -105.6286956551262, -106.17471863035658, 6.757502754453402, -47.746375206186215, 15.304506718151242, -64.79126881924601, -123.60848469583593, 89.80283410456914, 2.917429606122306, -42.88992884709586, -117.86236666776364, 39.18538389109307, 66.14495808361124, 21.859674147573365, 47.51178906698263, -45.95271714550152, -68.07085839027366, -13.878981478335774, -46.337407411137065, -28.85722490931535, -10.168451733866881, -40.98181896098945, -43.624749830185394, -58.184841240993734, -20.82942512359371, 65.87219551943997, 17.358906406358866, -63.64119119496025, 126.18842866613448, -42.80919883932157, 17.727048436475577, -25.81945439549129, 22.331037607868133, 6.007047244548591, -75.86093290244527, 8.780386954416027, 17.840371205124697, 106.42083552821677, 14.748272431671268, -34.377620471243745, 59.835602680122605, -55.43344232501917, 6.947014721783896, 18.4144668022251, -11.141198295733533, -100.69143410994471, -34.56102741919959, -82.40983434992668, 59.63904104755595, -7.649913929750408, 62.200303506256446, 114.01447693322957, -71.22546221079716, -3.3031991703024755, -0.9765956064778454, -47.44437006684693, -71.96858383383562, 134.05509497005374, 59.555937037670446, -51.535898706225666, -55.627653832486054, 1.6332492132269145, 28.178256689462273, 59.74540212094591, 15.274960110864185, -20.610307631331366, 33.27733361968296, -38.434621242251474, 31.353202978838716, 46.46600613877938, -22.545711132994, -20.283133778005656, -54.71668695809291, -1.101000750021834, -5.177787269951029, 60.1381552301731, 48.756258106398604, 24.783533170608607], "episode_lengths": [200, 200, 200, 200, 44, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 3, 200, 200, 200, 200, 12, 163, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 199, 178, 200, 141, 200, 145, 182, 200, 200, 200, 200, 91, 200, 39, 200, 174, 200, 187, 200, 200, 200, 200, 200, 200, 200, 150, 200, 200, 130, 200, 200, 200, 200, 200, 200, 200, 200, 101, 103, 200, 200, 200, 200, 200, 189, 200, 200, 200, 22, 200, 200, 85, 200], "policy_agent_policy_reward": [-65.34241693850473, -79.2880999707457, -21.91093819372502, -42.86709826368464, 16.928622542543007, 44.880122237425724, -65.8164330499187, 1.9075973618148243, -9.030072931690809, -61.142639395572346, 5.436227154168549, -58.78095995859075, -13.872275165297477, -88.79680225799224, -36.066449836134154, -3.51213547643189, -42.50225042359185, -5.639339966075164, -21.594995089963874, -30.061636570754402, -70.46368851919918, -25.80422013727364, -52.814347827563, -53.08735931517835, 3.378751377226701, -23.873187603093108, 7.652253359075619, -32.395634409623014, -61.804242347917935, 44.901417052284515, 1.458714803061153, -21.444964423547937, -58.93118333388179, 19.592691945546537, 33.07247904180557, 10.929837073786684, 23.755894533491354, -22.976358572750783, -34.035429195136835, -6.939490739167871, -23.168703705568547, -14.428612454657685, -5.084225866933442, -20.49090948049472, -21.812374915092736, -29.092420620496874, -10.41471256179686, 32.93609775971994, 8.679453203179435, -31.820595597480114, 63.09421433306724, -21.40459941966087, 8.863524218237789, -12.909727197745656, 11.165518803934072, 3.003523622274276, -37.93046645122264, 4.390193477208015, 8.92018560256235, 53.2104177641084, 7.37413621583563, -17.188810235621894, 29.91780134006131, -27.71672116250958, 3.473507360891947, 9.207233401112552, -5.570599147866748, -50.345717054972326, -17.280513709599795, -41.204917174963256, 29.819520523777953, -3.824956964875204, 31.100151753128245, 57.007238466614744, -35.61273110539858, -1.6515995851512182, -0.488297803238928, -23.722185033423465, -35.98429191691787, 67.02754748502684, 29.777968518835237, -25.767949353112826, -27.813826916243045, 0.8166246066134732, 14.089128344731176, 29.872701060472938, 7.637480055432093, -10.305153815665683, 16.63866680984146, -19.217310621125737, 15.676601489419312, 23.233003069389696, -11.27285556649699, -10.141566889002824, -27.35834347904645, -0.550500375010915, -2.5888936349755163, 30.069077615086545, 24.37812905319931, 12.391766585304303], "policy_adversary_policy_reward": [-35.733573905002196, -29.60884303350251, -47.10652275770758, -32.18157721303818, 9.497827687334535, -31.40876588105956, -27.043473627711695, -15.823624635972948, 29.977821672205398, -13.049199129662393, 19.433773807474168, 25.44634842995156, -43.06341457082688, -22.75301847909182, -9.667020581649558, 11.574617943464375, -3.6097908489886397, -5.420282082702187, -19.349314159593543, -41.793325235978784, -0.532283586841622, 5.968510741010171, -19.84398316194271, -38.936976796648004, -0.5841487326061738, -13.288126432691303, -53.53725372302388, -35.25954853496843, -9.068097484535457, -26.998352351598697, 9.819813887287616, -13.331949363719506, -11.501726012035622, -31.000524411556228, -15.212396322953758, 9.573056356878595, 7.144970527266921, -28.739965617230794, -14.902150603049797, -15.159485967704605, -33.956830770707995, -36.50685774849115, -18.879391650333186, -6.924828486940452, -25.974976304551912, -26.839371523011074, -17.64315298941092, -35.44420632576738, -18.520889917651644, 21.899641294878347, -13.238558572854629, -10.634629030238479, -6.383405312427698, 14.035658671503318, -23.011660615210662, -9.383973794412352, -38.65667197322206, -23.147570374695874, 18.5713620408187, 26.33005501146583, 1.3882868345685366, 0.07042796849261634, -38.23159898694167, 16.786634563393736, -22.080767316627295, -36.85041601725449, 11.820127167068957, 7.77256477847758, 13.69770469236309, 19.374774349442482, 3.348378522246364, 7.581458551540321, 20.65143316843086, 3.104461365060473, -13.490204142092889, -9.486154430657894, -12.408065410273423, -21.627363784863412, -3.321463432238261, -3.618027306929619, -12.017442823554568, -11.151260882013979, -35.802732897830445, 21.374120443172753, 0.2050548233469982, -5.289280690280441, -17.31813280497324, -3.172776675521483, -41.85751324265889, 20.045138327566136, -24.59781064254113, -4.494609977955747, -7.1669022834121705, -3.24781027838469, 11.902434058427392, 21.03366370129257, 22.627905144770587, -13.948451941591152, -12.23175976523305, -19.588835832247057, 32.90571177039284, 30.18850256267439, -19.615795732337396, -1.7888036873234725, 19.86101723015298, -10.997493011915193, -17.095949011594914, 4.186221813849251, -21.368844816122706, 32.534363620056766, -8.773411107545499, 11.776934729819775, -26.752405610664823, -11.178060840557816, -14.793444234753675, 19.183637711961687, -17.0346285449084, 25.95481414747074, 30.873649671394077, 22.336768092714326, -2.8472640898359316, 10.221400305671564, -16.75647659674243, -0.43233363887946297, 11.099835670641498, 18.817965669419813, -32.87264467829508, 5.155923515785503, 10.117341934527467, -6.6438345736355195, 5.346193626997131, 3.861039774115415, -11.522713245027884, 5.952114097161102, -22.013878780806735, -28.331838274165584, -9.417015452316825, -7.86349825728297, -18.806834393607623, -22.39808278135562, 7.022434841932521, 22.797085681845445, 7.2963280928319865, -11.12128505770719, -14.202767645571846, 45.30291939870009, 40.721598562606225, 16.285639904008526, -20.579750711242973, -15.032980394155608, 8.912477812079349, -10.564077397230571, -12.283363878431533, 11.795066075192613, -8.778409185731853, -14.943775847691612, -23.90922845501472, -12.075063461903149, 34.339369699303525, 32.688177785723354, 25.973716128153562, 3.8042523906816648, -9.028229980894316, -16.73971937221851, -12.002683346063456, -15.811143570179588, 15.42836097999388, -14.61173637338042, 12.35499436865404, 1.7341339760771355, 14.146808335284144, 15.7258927251888, 2.849204886546005, 4.788275168886088, 11.376874353116229, -21.682028168781912, 2.4847556980638945, 14.15391111177756, 7.271088788048825, -26.488399409174566, 10.130971167713447, 5.545630321705865, -10.786012376506838, 34.01901544589654, -12.717792947031825, 1.4449373805348351, -4.312155139632559, -5.829411749370262, -18.637578222323935, -8.720765256722515, -1.4369990148711054, 0.8864986398601902, -6.53098797484763, 3.9420943398721136, 33.14782591888098, -3.078748303794443, 35.004851821243165, -10.626722768043841, 19.157153618418114, -6.765387033113811]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3888854982633345, "mean_inference_ms": 0.9650566056438558, "mean_action_processing_ms": 0.16543413627874012, "mean_env_wait_ms": 0.057328632026622514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033369064331054688, "StateBufferConnector_ms": 0.002939462661743164, "ViewRequirementAgentConnector_ms": 0.0711745023727417}, "num_episodes": 21, "episode_return_max": 134.05509497005374, "episode_return_min": -177.59360451598445, "episode_return_mean": -17.745874374161588}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.03972496635936, "num_env_steps_trained_throughput_per_sec": 446.03972496635936, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 612000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 8523.017, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8522.98, "sample_time_ms": 769.653, "learn_time_ms": 7738.671, "learn_throughput": 516.885, "synch_weights_time_ms": 14.083}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "training_iteration": 51, "trial_id": "eaa30_00000", "date": "2024-08-09_17-47-09", "timestamp": 1723240029, "time_this_iter_s": 8.9737069606781, "time_total_s": 419.04301738739014, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf7e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 419.04301738739014, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 28.069230769230764, "ram_util_percent": 80.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.026912293547675, "cur_kl_coeff": 0.810914611816406, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.299634656451997, "policy_loss": -0.0059762531218843324, "vf_loss": 6.300536548019086, "vf_explained_var": 0.2406044062167879, "kl": 0.006257600776811756, "entropy": 1.5263221981664183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.115326380357146, "cur_kl_coeff": 0.2565784513950348, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.726476433873176, "policy_loss": -0.0032371229254446613, "vf_loss": 7.728509130577247, "vf_explained_var": 0.4617453902959824, "kl": 0.0046941791439166995, "entropy": 0.7833402814964453, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 134.05509497005374, "episode_reward_min": -123.60848469583593, "episode_reward_mean": -0.7284150461512598, "episode_len_mean": 172.72, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 17272, "policy_reward_min": {"agent_policy": -61.804242347917935, "adversary_policy": -41.85751324265889}, "policy_reward_max": {"agent_policy": 67.02754748502684, "adversary_policy": 45.30291939870009}, "policy_reward_mean": {"agent_policy": -0.36420752307562987, "adversary_policy": -0.18210376153781524}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-47.746375206186215, 15.304506718151242, -64.79126881924601, -123.60848469583593, 89.80283410456914, 2.917429606122306, -42.88992884709586, -117.86236666776364, 39.18538389109307, 66.14495808361124, 21.859674147573365, 47.51178906698263, -45.95271714550152, -68.07085839027366, -13.878981478335774, -46.337407411137065, -28.85722490931535, -10.168451733866881, -40.98181896098945, -43.624749830185394, -58.184841240993734, -20.82942512359371, 65.87219551943997, 17.358906406358866, -63.64119119496025, 126.18842866613448, -42.80919883932157, 17.727048436475577, -25.81945439549129, 22.331037607868133, 6.007047244548591, -75.86093290244527, 8.780386954416027, 17.840371205124697, 106.42083552821677, 14.748272431671268, -34.377620471243745, 59.835602680122605, -55.43344232501917, 6.947014721783896, 18.4144668022251, -11.141198295733533, -100.69143410994471, -34.56102741919959, -82.40983434992668, 59.63904104755595, -7.649913929750408, 62.200303506256446, 114.01447693322957, -71.22546221079716, -3.3031991703024755, -0.9765956064778454, -47.44437006684693, -71.96858383383562, 134.05509497005374, 59.555937037670446, -51.535898706225666, -55.627653832486054, 1.6332492132269145, 28.178256689462273, 59.74540212094591, 15.274960110864185, -20.610307631331366, 33.27733361968296, -38.434621242251474, 31.353202978838716, 46.46600613877938, -22.545711132994, -20.283133778005656, -54.71668695809291, -1.101000750021834, -5.177787269951029, 60.1381552301731, 48.756258106398604, 24.783533170608607, -13.103134428668888, 35.73281256658011, -82.41924604150822, 109.7208022838194, 2.4173659309897517, 121.54690617577243, 52.075129268884126, 60.98161721084742, 66.17604509561816, 10.063866982878217, 29.32753868911082, 25.866834959818085, -56.49570919628198, 13.332931199454823, 92.88053334126904, -61.107803188476524, 17.02214663528582, 46.901665950358904, 7.373933344051876, -102.34586202108358, -77.739439562521, -30.578908969956544, -84.51958276155815, 7.184147359960114, -40.27433525302956], "episode_lengths": [200, 13, 200, 200, 200, 3, 200, 200, 200, 200, 12, 163, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 199, 178, 200, 141, 200, 145, 182, 200, 200, 200, 200, 91, 200, 39, 200, 174, 200, 187, 200, 200, 200, 200, 200, 200, 200, 150, 200, 200, 130, 200, 200, 200, 200, 200, 200, 200, 200, 101, 103, 200, 200, 200, 200, 200, 189, 200, 200, 200, 22, 200, 200, 85, 200, 200, 200, 200, 154, 2, 122, 156, 23, 92, 52, 176, 200, 200, 200, 96, 200, 200, 200, 92, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-23.873187603093108, 7.652253359075619, -32.395634409623014, -61.804242347917935, 44.901417052284515, 1.458714803061153, -21.444964423547937, -58.93118333388179, 19.592691945546537, 33.07247904180557, 10.929837073786684, 23.755894533491354, -22.976358572750783, -34.035429195136835, -6.939490739167871, -23.168703705568547, -14.428612454657685, -5.084225866933442, -20.49090948049472, -21.812374915092736, -29.092420620496874, -10.41471256179686, 32.93609775971994, 8.679453203179435, -31.820595597480114, 63.09421433306724, -21.40459941966087, 8.863524218237789, -12.909727197745656, 11.165518803934072, 3.003523622274276, -37.93046645122264, 4.390193477208015, 8.92018560256235, 53.2104177641084, 7.37413621583563, -17.188810235621894, 29.91780134006131, -27.71672116250958, 3.473507360891947, 9.207233401112552, -5.570599147866748, -50.345717054972326, -17.280513709599795, -41.204917174963256, 29.819520523777953, -3.824956964875204, 31.100151753128245, 57.007238466614744, -35.61273110539858, -1.6515995851512182, -0.488297803238928, -23.722185033423465, -35.98429191691787, 67.02754748502684, 29.777968518835237, -25.767949353112826, -27.813826916243045, 0.8166246066134732, 14.089128344731176, 29.872701060472938, 7.637480055432093, -10.305153815665683, 16.63866680984146, -19.217310621125737, 15.676601489419312, 23.233003069389696, -11.27285556649699, -10.141566889002824, -27.35834347904645, -0.550500375010915, -2.5888936349755163, 30.069077615086545, 24.37812905319931, 12.391766585304303, -6.551567214334408, 17.86640628329006, -41.209623020754094, 54.860401141909676, 1.208682965494876, 60.7734530878863, 26.037564634442063, 30.4908086054237, 33.08802254780908, 5.0319334914391085, 14.663769344555412, 12.933417479909043, -28.247854598141007, 6.666465599727401, 46.44026667063457, -30.55390159423824, 8.51107331764289, 23.450832975179466, 3.6869666720259353, -51.172931010541745, -38.86971978126049, -15.289454484978272, -42.259791380779085, 3.5920736799800395, -20.13716762651478], "policy_adversary_policy_reward": [-13.238558572854629, -10.634629030238479, -6.383405312427698, 14.035658671503318, -23.011660615210662, -9.383973794412352, -38.65667197322206, -23.147570374695874, 18.5713620408187, 26.33005501146583, 1.3882868345685366, 0.07042796849261634, -38.23159898694167, 16.786634563393736, -22.080767316627295, -36.85041601725449, 11.820127167068957, 7.77256477847758, 13.69770469236309, 19.374774349442482, 3.348378522246364, 7.581458551540321, 20.65143316843086, 3.104461365060473, -13.490204142092889, -9.486154430657894, -12.408065410273423, -21.627363784863412, -3.321463432238261, -3.618027306929619, -12.017442823554568, -11.151260882013979, -35.802732897830445, 21.374120443172753, 0.2050548233469982, -5.289280690280441, -17.31813280497324, -3.172776675521483, -41.85751324265889, 20.045138327566136, -24.59781064254113, -4.494609977955747, -7.1669022834121705, -3.24781027838469, 11.902434058427392, 21.03366370129257, 22.627905144770587, -13.948451941591152, -12.23175976523305, -19.588835832247057, 32.90571177039284, 30.18850256267439, -19.615795732337396, -1.7888036873234725, 19.86101723015298, -10.997493011915193, -17.095949011594914, 4.186221813849251, -21.368844816122706, 32.534363620056766, -8.773411107545499, 11.776934729819775, -26.752405610664823, -11.178060840557816, -14.793444234753675, 19.183637711961687, -17.0346285449084, 25.95481414747074, 30.873649671394077, 22.336768092714326, -2.8472640898359316, 10.221400305671564, -16.75647659674243, -0.43233363887946297, 11.099835670641498, 18.817965669419813, -32.87264467829508, 5.155923515785503, 10.117341934527467, -6.6438345736355195, 5.346193626997131, 3.861039774115415, -11.522713245027884, 5.952114097161102, -22.013878780806735, -28.331838274165584, -9.417015452316825, -7.86349825728297, -18.806834393607623, -22.39808278135562, 7.022434841932521, 22.797085681845445, 7.2963280928319865, -11.12128505770719, -14.202767645571846, 45.30291939870009, 40.721598562606225, 16.285639904008526, -20.579750711242973, -15.032980394155608, 8.912477812079349, -10.564077397230571, -12.283363878431533, 11.795066075192613, -8.778409185731853, -14.943775847691612, -23.90922845501472, -12.075063461903149, 34.339369699303525, 32.688177785723354, 25.973716128153562, 3.8042523906816648, -9.028229980894316, -16.73971937221851, -12.002683346063456, -15.811143570179588, 15.42836097999388, -14.61173637338042, 12.35499436865404, 1.7341339760771355, 14.146808335284144, 15.7258927251888, 2.849204886546005, 4.788275168886088, 11.376874353116229, -21.682028168781912, 2.4847556980638945, 14.15391111177756, 7.271088788048825, -26.488399409174566, 10.130971167713447, 5.545630321705865, -10.786012376506838, 34.01901544589654, -12.717792947031825, 1.4449373805348351, -4.312155139632559, -5.829411749370262, -18.637578222323935, -8.720765256722515, -1.4369990148711054, 0.8864986398601902, -6.53098797484763, 3.9420943398721136, 33.14782591888098, -3.078748303794443, 35.004851821243165, -10.626722768043841, 19.157153618418114, -6.765387033113811, -11.93835327419491, 5.386786059860537, 6.732466837246482, 11.133939446043577, -14.037347199519505, -27.172275821234603, 35.22852130455124, 19.631879837358433, 1.208682965494876, 0.0, 36.324462208906326, 24.448990878979973, 17.300823832119274, 8.736740802322792, 17.16011396639218, 13.33069463903152, 15.644962221436355, 17.443060326372716, 16.248514077805282, -11.21658058636617, 20.081915220207378, -5.41814587565197, 3.358303003861142, 9.5751144760479, -5.465671777493186, -22.782182820647822, 8.842154767166758, -2.175689167439357, 21.122156455098196, 25.318110215536358, -12.328998495003702, -18.224903099234538, 3.8053825004860187, 4.705690817156874, 15.364246945587382, 8.086586029592084, -1.8720378469714447, 5.55900451899738, -22.998542602727653, -28.174388407814092, -15.310336416707813, -23.559383364552684, -3.4997758842090576, -11.789678600769214, -25.75268747481774, -16.507103905961344, 1.9439373373353845, 1.648136342644655, -21.538576582172396, 1.40140895565761]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38903459462650825, "mean_inference_ms": 0.9646515072891572, "mean_action_processing_ms": 0.16561333535110023, "mean_env_wait_ms": 0.05742097483363235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003222942352294922, "StateBufferConnector_ms": 0.002911210060119629, "ViewRequirementAgentConnector_ms": 0.0702887773513794}, "num_episodes": 25, "episode_return_max": 134.05509497005374, "episode_return_min": -123.60848469583593, "episode_return_mean": -0.7284150461512598}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 473.73118579090163, "num_env_steps_trained_throughput_per_sec": 473.73118579090163, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 8483.531, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8483.494, "sample_time_ms": 772.403, "learn_time_ms": 7696.542, "learn_throughput": 519.714, "synch_weights_time_ms": 13.978}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 52, "trial_id": "eaa30_00000", "date": "2024-08-09_17-47-18", "timestamp": 1723240038, "time_this_iter_s": 8.449525833129883, "time_total_s": 427.49254322052, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf7ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 427.49254322052, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 22.441666666666663, "ram_util_percent": 80.69166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.716845238461065, "cur_kl_coeff": 0.810914611816406, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.911322103227888, "policy_loss": -0.006274393110082697, "vf_loss": 5.9122798208206415, "vf_explained_var": 0.24469319604061268, "kl": 0.0065563909460608135, "entropy": 1.5169968813184709, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.536404318362475, "cur_kl_coeff": 0.1282892256975174, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.602799885471662, "policy_loss": -0.004649361592115989, "vf_loss": 7.606355282167594, "vf_explained_var": 0.48970703861365716, "kl": 0.008527441261321655, "entropy": 0.8093049460401137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "env_runners": {"episode_reward_max": 165.66658880860686, "episode_reward_min": -102.34586202108358, "episode_reward_mean": 6.514905694212976, "episode_len_mean": 169.08, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 16908, "policy_reward_min": {"agent_policy": -51.172931010541745, "adversary_policy": -32.87264467829508}, "policy_reward_max": {"agent_policy": 82.83329440430339, "adversary_policy": 45.30291939870009}, "policy_reward_mean": {"agent_policy": 3.2574528471064887, "adversary_policy": 1.628726423553245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-42.80919883932157, 17.727048436475577, -25.81945439549129, 22.331037607868133, 6.007047244548591, -75.86093290244527, 8.780386954416027, 17.840371205124697, 106.42083552821677, 14.748272431671268, -34.377620471243745, 59.835602680122605, -55.43344232501917, 6.947014721783896, 18.4144668022251, -11.141198295733533, -100.69143410994471, -34.56102741919959, -82.40983434992668, 59.63904104755595, -7.649913929750408, 62.200303506256446, 114.01447693322957, -71.22546221079716, -3.3031991703024755, -0.9765956064778454, -47.44437006684693, -71.96858383383562, 134.05509497005374, 59.555937037670446, -51.535898706225666, -55.627653832486054, 1.6332492132269145, 28.178256689462273, 59.74540212094591, 15.274960110864185, -20.610307631331366, 33.27733361968296, -38.434621242251474, 31.353202978838716, 46.46600613877938, -22.545711132994, -20.283133778005656, -54.71668695809291, -1.101000750021834, -5.177787269951029, 60.1381552301731, 48.756258106398604, 24.783533170608607, -13.103134428668888, 35.73281256658011, -82.41924604150822, 109.7208022838194, 2.4173659309897517, 121.54690617577243, 52.075129268884126, 60.98161721084742, 66.17604509561816, 10.063866982878217, 29.32753868911082, 25.866834959818085, -56.49570919628198, 13.332931199454823, 92.88053334126904, -61.107803188476524, 17.02214663528582, 46.901665950358904, 7.373933344051876, -102.34586202108358, -77.739439562521, -30.578908969956544, -84.51958276155815, 7.184147359960114, -40.27433525302956, 165.66658880860686, -9.749223390190153, -5.900419345706766, 23.182187296906566, 33.180014413887505, 14.055981553457533, 36.613879398450365, -8.453640621224075, 46.43978150483939, -24.77191562330762, -37.44033960761631, 42.56210212689096, -68.63392291283932, -27.10347225584083, 85.92820902235076, 18.484979407996104, -10.224970325918068, -3.1064378670259636, -3.0312158194838332, 115.7706235062314, 88.4610684892217, -12.25284237486973, 76.39676200375366, -69.49483619376434, -96.11643125244174, 8.58957864881543], "episode_lengths": [200, 145, 182, 200, 200, 200, 200, 91, 200, 39, 200, 174, 200, 187, 200, 200, 200, 200, 200, 200, 200, 150, 200, 200, 130, 200, 200, 200, 200, 200, 200, 200, 200, 101, 103, 200, 200, 200, 200, 200, 189, 200, 200, 200, 22, 200, 200, 85, 200, 200, 200, 200, 154, 2, 122, 156, 23, 92, 52, 176, 200, 200, 200, 96, 200, 200, 200, 92, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 57, 200, 91, 200, 200, 47, 200, 200, 200, 146, 200, 81, 200, 153, 189, 63, 141, 200, 200, 143], "policy_agent_policy_reward": [-21.40459941966087, 8.863524218237789, -12.909727197745656, 11.165518803934072, 3.003523622274276, -37.93046645122264, 4.390193477208015, 8.92018560256235, 53.2104177641084, 7.37413621583563, -17.188810235621894, 29.91780134006131, -27.71672116250958, 3.473507360891947, 9.207233401112552, -5.570599147866748, -50.345717054972326, -17.280513709599795, -41.204917174963256, 29.819520523777953, -3.824956964875204, 31.100151753128245, 57.007238466614744, -35.61273110539858, -1.6515995851512182, -0.488297803238928, -23.722185033423465, -35.98429191691787, 67.02754748502684, 29.777968518835237, -25.767949353112826, -27.813826916243045, 0.8166246066134732, 14.089128344731176, 29.872701060472938, 7.637480055432093, -10.305153815665683, 16.63866680984146, -19.217310621125737, 15.676601489419312, 23.233003069389696, -11.27285556649699, -10.141566889002824, -27.35834347904645, -0.550500375010915, -2.5888936349755163, 30.069077615086545, 24.37812905319931, 12.391766585304303, -6.551567214334408, 17.86640628329006, -41.209623020754094, 54.860401141909676, 1.208682965494876, 60.7734530878863, 26.037564634442063, 30.4908086054237, 33.08802254780908, 5.0319334914391085, 14.663769344555412, 12.933417479909043, -28.247854598141007, 6.666465599727401, 46.44026667063457, -30.55390159423824, 8.51107331764289, 23.450832975179466, 3.6869666720259353, -51.172931010541745, -38.86971978126049, -15.289454484978272, -42.259791380779085, 3.5920736799800395, -20.13716762651478, 82.83329440430339, -4.874611695095076, -2.950209672853383, 11.591093648453281, 16.590007206943753, 7.027990776728767, 18.30693969922518, -4.22682031061203, 23.219890752419694, -12.385957811653821, -18.720169803808183, 21.281051063445478, -34.31696145641969, -13.551736127920435, 42.964104511175336, 9.242489703998064, -5.112485162959031, -1.5532189335129658, -1.5156079097419166, 57.88531175311576, 44.23053424461085, -6.126421187434863, 38.19838100187685, -34.74741809688216, -48.05821562622083, 4.2947893244077235], "policy_adversary_policy_reward": [-19.615795732337396, -1.7888036873234725, 19.86101723015298, -10.997493011915193, -17.095949011594914, 4.186221813849251, -21.368844816122706, 32.534363620056766, -8.773411107545499, 11.776934729819775, -26.752405610664823, -11.178060840557816, -14.793444234753675, 19.183637711961687, -17.0346285449084, 25.95481414747074, 30.873649671394077, 22.336768092714326, -2.8472640898359316, 10.221400305671564, -16.75647659674243, -0.43233363887946297, 11.099835670641498, 18.817965669419813, -32.87264467829508, 5.155923515785503, 10.117341934527467, -6.6438345736355195, 5.346193626997131, 3.861039774115415, -11.522713245027884, 5.952114097161102, -22.013878780806735, -28.331838274165584, -9.417015452316825, -7.86349825728297, -18.806834393607623, -22.39808278135562, 7.022434841932521, 22.797085681845445, 7.2963280928319865, -11.12128505770719, -14.202767645571846, 45.30291939870009, 40.721598562606225, 16.285639904008526, -20.579750711242973, -15.032980394155608, 8.912477812079349, -10.564077397230571, -12.283363878431533, 11.795066075192613, -8.778409185731853, -14.943775847691612, -23.90922845501472, -12.075063461903149, 34.339369699303525, 32.688177785723354, 25.973716128153562, 3.8042523906816648, -9.028229980894316, -16.73971937221851, -12.002683346063456, -15.811143570179588, 15.42836097999388, -14.61173637338042, 12.35499436865404, 1.7341339760771355, 14.146808335284144, 15.7258927251888, 2.849204886546005, 4.788275168886088, 11.376874353116229, -21.682028168781912, 2.4847556980638945, 14.15391111177756, 7.271088788048825, -26.488399409174566, 10.130971167713447, 5.545630321705865, -10.786012376506838, 34.01901544589654, -12.717792947031825, 1.4449373805348351, -4.312155139632559, -5.829411749370262, -18.637578222323935, -8.720765256722515, -1.4369990148711054, 0.8864986398601902, -6.53098797484763, 3.9420943398721136, 33.14782591888098, -3.078748303794443, 35.004851821243165, -10.626722768043841, 19.157153618418114, -6.765387033113811, -11.93835327419491, 5.386786059860537, 6.732466837246482, 11.133939446043577, -14.037347199519505, -27.172275821234603, 35.22852130455124, 19.631879837358433, 1.208682965494876, 0.0, 36.324462208906326, 24.448990878979973, 17.300823832119274, 8.736740802322792, 17.16011396639218, 13.33069463903152, 15.644962221436355, 17.443060326372716, 16.248514077805282, -11.21658058636617, 20.081915220207378, -5.41814587565197, 3.358303003861142, 9.5751144760479, -5.465671777493186, -22.782182820647822, 8.842154767166758, -2.175689167439357, 21.122156455098196, 25.318110215536358, -12.328998495003702, -18.224903099234538, 3.8053825004860187, 4.705690817156874, 15.364246945587382, 8.086586029592084, -1.8720378469714447, 5.55900451899738, -22.998542602727653, -28.174388407814092, -15.310336416707813, -23.559383364552684, -3.4997758842090576, -11.789678600769214, -25.75268747481774, -16.507103905961344, 1.9439373373353845, 1.648136342644655, -21.538576582172396, 1.40140895565761, 42.82348798464939, 40.00980641965404, -1.5033930223348655, -3.371218672760211, -3.7672928840262827, 0.8170832111728998, 8.334665513249135, 3.256428135204146, 6.776851450439274, 9.813155756504479, 19.951111745872087, -12.92312096914332, 3.0577671655262293, 15.24917253369895, -0.9079383509169521, -3.3188819596950836, 17.933186002776825, 5.286704749642869, -10.229853162876406, -2.156104648777415, -26.205083955813762, 7.4849141520055795, 20.126995280152837, 1.1540557832926481, -19.267699841775826, -15.049261614643857, -15.247629384061788, 1.6958932561413533, 9.31110875956016, 33.652995751615194, 16.84772234023129, -7.605232636233229, -0.3622052831558289, -4.750279879803202, -15.598359304247428, 14.045140370734467, -1.5384243388679764, 0.022816429126059745, 28.619275987045878, 29.26603576606987, 25.237702006959623, 18.99283223765122, -25.66331852695046, 19.536897339515594, 26.66304448576914, 11.535336516107703, -8.433554052960801, -26.313864043921356, -23.047332981483287, -25.010882644737546, -8.111408809652861, 12.406198134060585]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.389323822313669, "mean_inference_ms": 0.9654828013575654, "mean_action_processing_ms": 0.1658522866248603, "mean_env_wait_ms": 0.0574634033972026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031992197036743164, "StateBufferConnector_ms": 0.002883315086364746, "ViewRequirementAgentConnector_ms": 0.07059979438781738}, "num_episodes": 26, "episode_return_max": 165.66658880860686, "episode_return_min": -102.34586202108358, "episode_return_mean": 6.514905694212976}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 464.4438702987775, "num_env_steps_trained_throughput_per_sec": 464.4438702987775, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 636000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 8497.734, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8497.697, "sample_time_ms": 759.057, "learn_time_ms": 7724.04, "learn_throughput": 517.864, "synch_weights_time_ms": 14.023}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "training_iteration": 53, "trial_id": "eaa30_00000", "date": "2024-08-09_17-47-26", "timestamp": 1723240046, "time_this_iter_s": 8.619976043701172, "time_total_s": 436.1125192642212, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fca09d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 436.1125192642212, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 24.525000000000002, "ram_util_percent": 80.85833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.206122219436383, "cur_kl_coeff": 0.810914611816406, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.507535797956759, "policy_loss": -0.004067906721251174, "vf_loss": 6.5078043942729, "vf_explained_var": 0.20756661519802436, "kl": 0.004685219747344495, "entropy": 1.5066158745023939, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.46369749760876, "cur_kl_coeff": 0.1282892256975174, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.763969032466411, "policy_loss": 0.0020830027785753674, "vf_loss": 7.760945135851701, "vf_explained_var": 0.33953680731356145, "kl": 0.007334010626315527, "entropy": 0.787599666789174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "env_runners": {"episode_reward_max": 165.66658880860686, "episode_reward_min": -102.34586202108358, "episode_reward_mean": 13.489833288942064, "episode_len_mean": 167.24, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 16724, "policy_reward_min": {"agent_policy": -51.172931010541745, "adversary_policy": -28.174388407814092}, "policy_reward_max": {"agent_policy": 82.83329440430339, "adversary_policy": 42.82348798464939}, "policy_reward_mean": {"agent_policy": 6.744916644471034, "adversary_policy": 3.372458322235518}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-71.22546221079716, -3.3031991703024755, -0.9765956064778454, -47.44437006684693, -71.96858383383562, 134.05509497005374, 59.555937037670446, -51.535898706225666, -55.627653832486054, 1.6332492132269145, 28.178256689462273, 59.74540212094591, 15.274960110864185, -20.610307631331366, 33.27733361968296, -38.434621242251474, 31.353202978838716, 46.46600613877938, -22.545711132994, -20.283133778005656, -54.71668695809291, -1.101000750021834, -5.177787269951029, 60.1381552301731, 48.756258106398604, 24.783533170608607, -13.103134428668888, 35.73281256658011, -82.41924604150822, 109.7208022838194, 2.4173659309897517, 121.54690617577243, 52.075129268884126, 60.98161721084742, 66.17604509561816, 10.063866982878217, 29.32753868911082, 25.866834959818085, -56.49570919628198, 13.332931199454823, 92.88053334126904, -61.107803188476524, 17.02214663528582, 46.901665950358904, 7.373933344051876, -102.34586202108358, -77.739439562521, -30.578908969956544, -84.51958276155815, 7.184147359960114, -40.27433525302956, 165.66658880860686, -9.749223390190153, -5.900419345706766, 23.182187296906566, 33.180014413887505, 14.055981553457533, 36.613879398450365, -8.453640621224075, 46.43978150483939, -24.77191562330762, -37.44033960761631, 42.56210212689096, -68.63392291283932, -27.10347225584083, 85.92820902235076, 18.484979407996104, -10.224970325918068, -3.1064378670259636, -3.0312158194838332, 115.7706235062314, 88.4610684892217, -12.25284237486973, 76.39676200375366, -69.49483619376434, -96.11643125244174, 8.58957864881543, 59.30976006607294, 40.801020286395655, 143.88889135776117, 43.595032220046264, 45.976746692217304, -10.704482767346775, -44.8034356115745, 118.49787929826653, -24.897739024577135, 51.16970775818246, 74.92784188108013, 6.438282797679049, 45.436317676675245, 47.75926073185853, -20.529989644103573, 135.98351234273986, 112.08386444300959, -26.706602865730154, 27.3591188592968, -42.47506603822174, 40.60412734620157, -64.07989701412873, -17.989543257472995], "episode_lengths": [200, 130, 200, 200, 200, 200, 200, 200, 200, 200, 101, 103, 200, 200, 200, 200, 200, 189, 200, 200, 200, 22, 200, 200, 85, 200, 200, 200, 200, 154, 2, 122, 156, 23, 92, 52, 176, 200, 200, 200, 96, 200, 200, 200, 92, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 57, 200, 91, 200, 200, 47, 200, 200, 200, 146, 200, 81, 200, 153, 189, 63, 141, 200, 200, 143, 159, 92, 200, 200, 200, 200, 200, 162, 200, 24, 200, 200, 200, 200, 200, 200, 96, 200, 51, 200, 200, 200, 200], "policy_agent_policy_reward": [-35.61273110539858, -1.6515995851512182, -0.488297803238928, -23.722185033423465, -35.98429191691787, 67.02754748502684, 29.777968518835237, -25.767949353112826, -27.813826916243045, 0.8166246066134732, 14.089128344731176, 29.872701060472938, 7.637480055432093, -10.305153815665683, 16.63866680984146, -19.217310621125737, 15.676601489419312, 23.233003069389696, -11.27285556649699, -10.141566889002824, -27.35834347904645, -0.550500375010915, -2.5888936349755163, 30.069077615086545, 24.37812905319931, 12.391766585304303, -6.551567214334408, 17.86640628329006, -41.209623020754094, 54.860401141909676, 1.208682965494876, 60.7734530878863, 26.037564634442063, 30.4908086054237, 33.08802254780908, 5.0319334914391085, 14.663769344555412, 12.933417479909043, -28.247854598141007, 6.666465599727401, 46.44026667063457, -30.55390159423824, 8.51107331764289, 23.450832975179466, 3.6869666720259353, -51.172931010541745, -38.86971978126049, -15.289454484978272, -42.259791380779085, 3.5920736799800395, -20.13716762651478, 82.83329440430339, -4.874611695095076, -2.950209672853383, 11.591093648453281, 16.590007206943753, 7.027990776728767, 18.30693969922518, -4.22682031061203, 23.219890752419694, -12.385957811653821, -18.720169803808183, 21.281051063445478, -34.31696145641969, -13.551736127920435, 42.964104511175336, 9.242489703998064, -5.112485162959031, -1.5532189335129658, -1.5156079097419166, 57.88531175311576, 44.23053424461085, -6.126421187434863, 38.19838100187685, -34.74741809688216, -48.05821562622083, 4.2947893244077235, 29.654880033036484, 20.400510143197828, 71.94444567888056, 21.797516110023093, 22.98837334610866, -5.3522413836733875, -22.401717805787243, 59.24893964913332, -12.448869512288574, 25.584853879091238, 37.463920940540085, 3.219141398839481, 22.718158838337615, 23.87963036592927, -10.264994822051786, 67.99175617137, 56.041932221504815, -13.35330143286508, 13.679559429648405, -21.237533019110877, 20.302063673100804, -32.03994850706435, -8.994771628736498], "policy_adversary_policy_reward": [-20.579750711242973, -15.032980394155608, 8.912477812079349, -10.564077397230571, -12.283363878431533, 11.795066075192613, -8.778409185731853, -14.943775847691612, -23.90922845501472, -12.075063461903149, 34.339369699303525, 32.688177785723354, 25.973716128153562, 3.8042523906816648, -9.028229980894316, -16.73971937221851, -12.002683346063456, -15.811143570179588, 15.42836097999388, -14.61173637338042, 12.35499436865404, 1.7341339760771355, 14.146808335284144, 15.7258927251888, 2.849204886546005, 4.788275168886088, 11.376874353116229, -21.682028168781912, 2.4847556980638945, 14.15391111177756, 7.271088788048825, -26.488399409174566, 10.130971167713447, 5.545630321705865, -10.786012376506838, 34.01901544589654, -12.717792947031825, 1.4449373805348351, -4.312155139632559, -5.829411749370262, -18.637578222323935, -8.720765256722515, -1.4369990148711054, 0.8864986398601902, -6.53098797484763, 3.9420943398721136, 33.14782591888098, -3.078748303794443, 35.004851821243165, -10.626722768043841, 19.157153618418114, -6.765387033113811, -11.93835327419491, 5.386786059860537, 6.732466837246482, 11.133939446043577, -14.037347199519505, -27.172275821234603, 35.22852130455124, 19.631879837358433, 1.208682965494876, 0.0, 36.324462208906326, 24.448990878979973, 17.300823832119274, 8.736740802322792, 17.16011396639218, 13.33069463903152, 15.644962221436355, 17.443060326372716, 16.248514077805282, -11.21658058636617, 20.081915220207378, -5.41814587565197, 3.358303003861142, 9.5751144760479, -5.465671777493186, -22.782182820647822, 8.842154767166758, -2.175689167439357, 21.122156455098196, 25.318110215536358, -12.328998495003702, -18.224903099234538, 3.8053825004860187, 4.705690817156874, 15.364246945587382, 8.086586029592084, -1.8720378469714447, 5.55900451899738, -22.998542602727653, -28.174388407814092, -15.310336416707813, -23.559383364552684, -3.4997758842090576, -11.789678600769214, -25.75268747481774, -16.507103905961344, 1.9439373373353845, 1.648136342644655, -21.538576582172396, 1.40140895565761, 42.82348798464939, 40.00980641965404, -1.5033930223348655, -3.371218672760211, -3.7672928840262827, 0.8170832111728998, 8.334665513249135, 3.256428135204146, 6.776851450439274, 9.813155756504479, 19.951111745872087, -12.92312096914332, 3.0577671655262293, 15.24917253369895, -0.9079383509169521, -3.3188819596950836, 17.933186002776825, 5.286704749642869, -10.229853162876406, -2.156104648777415, -26.205083955813762, 7.4849141520055795, 20.126995280152837, 1.1540557832926481, -19.267699841775826, -15.049261614643857, -15.247629384061788, 1.6958932561413533, 9.31110875956016, 33.652995751615194, 16.84772234023129, -7.605232636233229, -0.3622052831558289, -4.750279879803202, -15.598359304247428, 14.045140370734467, -1.5384243388679764, 0.022816429126059745, 28.619275987045878, 29.26603576606987, 25.237702006959623, 18.99283223765122, -25.66331852695046, 19.536897339515594, 26.66304448576914, 11.535336516107703, -8.433554052960801, -26.313864043921356, -23.047332981483287, -25.010882644737546, -8.111408809652861, 12.406198134060585, 26.097445809249137, 3.5574342237873573, 10.819691418907224, 9.580818724290605, 37.46549359205531, 34.47895208682526, 29.019284343762305, -7.221768233739182, 5.4862241895368875, 17.502149156571775, -8.46439309744136, 3.1121517137679717, -4.907685387866202, -17.49403241792104, 16.737820239017452, 42.51111941011585, -6.032772594958423, -6.416096917330151, 9.22250116594184, 16.362352713149395, 8.093955352690314, 29.369965587849748, 10.531290891655503, -7.312149492816019, 4.298888505354448, 18.419270332983167, 22.263922154256605, 1.615708211672656, -12.899111618094715, 2.6341167960429317, 30.29024019892181, 37.7015159724481, 27.496011832408712, 28.545920389096118, 5.480040959988099, -18.83334239285318, 14.43576639323625, -0.7562069635878439, 1.893880946705706, -23.13141396581658, -0.21416521858270343, 20.5162288916835, -19.181069020362568, -12.858879486701788, -1.071426128164557, -7.923345500571941]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38976738078072243, "mean_inference_ms": 0.9671404014013945, "mean_action_processing_ms": 0.16608127943737702, "mean_env_wait_ms": 0.057525406317187916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032237768173217773, "StateBufferConnector_ms": 0.002848505973815918, "ViewRequirementAgentConnector_ms": 0.07077574729919434}, "num_episodes": 23, "episode_return_max": 165.66658880860686, "episode_return_min": -102.34586202108358, "episode_return_mean": 13.489833288942064}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.39548864590387, "num_env_steps_trained_throughput_per_sec": 446.39548864590387, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 8552.753, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8552.716, "sample_time_ms": 764.253, "learn_time_ms": 7773.87, "learn_throughput": 514.544, "synch_weights_time_ms": 14.007}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "training_iteration": 54, "trial_id": "eaa30_00000", "date": "2024-08-09_17-47-36", "timestamp": 1723240056, "time_this_iter_s": 8.973074913024902, "time_total_s": 445.0855941772461, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a28880d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 445.0855941772461, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 26.853846153846153, "ram_util_percent": 81.56153846153848}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.120457223357347, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.943086565108526, "policy_loss": -0.00893093253209911, "vf_loss": 5.947802986922087, "vf_explained_var": 0.15012721353107028, "kl": 0.010394435764349523, "entropy": 1.493326175465155, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.347105992150805, "cur_kl_coeff": 0.1282892256975174, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.3003832052151365, "policy_loss": -0.004545611509820446, "vf_loss": 7.302767007052898, "vf_explained_var": 0.3336252924675743, "kl": 0.01685113056373666, "entropy": 0.6695249360675614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "env_runners": {"episode_reward_max": 165.66658880860686, "episode_reward_min": -102.34586202108358, "episode_reward_mean": 16.003620230816253, "episode_len_mean": 164.64, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 16464, "policy_reward_min": {"agent_policy": -51.172931010541745, "adversary_policy": -28.174388407814092}, "policy_reward_max": {"agent_policy": 82.83329440430339, "adversary_policy": 42.82348798464939}, "policy_reward_mean": {"agent_policy": 8.001810115408128, "adversary_policy": 4.000905057704065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.71668695809291, -1.101000750021834, -5.177787269951029, 60.1381552301731, 48.756258106398604, 24.783533170608607, -13.103134428668888, 35.73281256658011, -82.41924604150822, 109.7208022838194, 2.4173659309897517, 121.54690617577243, 52.075129268884126, 60.98161721084742, 66.17604509561816, 10.063866982878217, 29.32753868911082, 25.866834959818085, -56.49570919628198, 13.332931199454823, 92.88053334126904, -61.107803188476524, 17.02214663528582, 46.901665950358904, 7.373933344051876, -102.34586202108358, -77.739439562521, -30.578908969956544, -84.51958276155815, 7.184147359960114, -40.27433525302956, 165.66658880860686, -9.749223390190153, -5.900419345706766, 23.182187296906566, 33.180014413887505, 14.055981553457533, 36.613879398450365, -8.453640621224075, 46.43978150483939, -24.77191562330762, -37.44033960761631, 42.56210212689096, -68.63392291283932, -27.10347225584083, 85.92820902235076, 18.484979407996104, -10.224970325918068, -3.1064378670259636, -3.0312158194838332, 115.7706235062314, 88.4610684892217, -12.25284237486973, 76.39676200375366, -69.49483619376434, -96.11643125244174, 8.58957864881543, 59.30976006607294, 40.801020286395655, 143.88889135776117, 43.595032220046264, 45.976746692217304, -10.704482767346775, -44.8034356115745, 118.49787929826653, -24.897739024577135, 51.16970775818246, 74.92784188108013, 6.438282797679049, 45.436317676675245, 47.75926073185853, -20.529989644103573, 135.98351234273986, 112.08386444300959, -26.706602865730154, 27.3591188592968, -42.47506603822174, 40.60412734620157, -64.07989701412873, -17.989543257472995, -56.774405037327284, 131.72601812010757, 50.11429295417335, 80.0272220547989, -2.799647658353095, 23.22357034326528, 47.42633828488694, -1.3722869974636325, 46.69200446220266, -54.02734742257542, -1.316746191205148, -4.1770409766706, -13.429900542906097, -43.479923898349725, 71.32043483345424, 57.78332648672776, -21.621830140576428, 26.155309184807535, -30.305845849105907, -48.20094215450164], "episode_lengths": [200, 22, 200, 200, 85, 200, 200, 200, 200, 154, 2, 122, 156, 23, 92, 52, 176, 200, 200, 200, 96, 200, 200, 200, 92, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 57, 200, 91, 200, 200, 47, 200, 200, 200, 146, 200, 81, 200, 153, 189, 63, 141, 200, 200, 143, 159, 92, 200, 200, 200, 200, 200, 162, 200, 24, 200, 200, 200, 200, 200, 200, 96, 200, 51, 200, 200, 200, 200, 200, 96, 135, 200, 200, 200, 200, 200, 126, 200, 200, 200, 200, 200, 113, 83, 200, 110, 200, 200], "policy_agent_policy_reward": [-27.35834347904645, -0.550500375010915, -2.5888936349755163, 30.069077615086545, 24.37812905319931, 12.391766585304303, -6.551567214334408, 17.86640628329006, -41.209623020754094, 54.860401141909676, 1.208682965494876, 60.7734530878863, 26.037564634442063, 30.4908086054237, 33.08802254780908, 5.0319334914391085, 14.663769344555412, 12.933417479909043, -28.247854598141007, 6.666465599727401, 46.44026667063457, -30.55390159423824, 8.51107331764289, 23.450832975179466, 3.6869666720259353, -51.172931010541745, -38.86971978126049, -15.289454484978272, -42.259791380779085, 3.5920736799800395, -20.13716762651478, 82.83329440430339, -4.874611695095076, -2.950209672853383, 11.591093648453281, 16.590007206943753, 7.027990776728767, 18.30693969922518, -4.22682031061203, 23.219890752419694, -12.385957811653821, -18.720169803808183, 21.281051063445478, -34.31696145641969, -13.551736127920435, 42.964104511175336, 9.242489703998064, -5.112485162959031, -1.5532189335129658, -1.5156079097419166, 57.88531175311576, 44.23053424461085, -6.126421187434863, 38.19838100187685, -34.74741809688216, -48.05821562622083, 4.2947893244077235, 29.654880033036484, 20.400510143197828, 71.94444567888056, 21.797516110023093, 22.98837334610866, -5.3522413836733875, -22.401717805787243, 59.24893964913332, -12.448869512288574, 25.584853879091238, 37.463920940540085, 3.219141398839481, 22.718158838337615, 23.87963036592927, -10.264994822051786, 67.99175617137, 56.041932221504815, -13.35330143286508, 13.679559429648405, -21.237533019110877, 20.302063673100804, -32.03994850706435, -8.994771628736498, -28.38720251866362, 65.86300906005384, 25.057146477086707, 40.0136110273994, -1.3998238291765936, 11.61178517163263, 23.71316914244348, -0.6861434987318162, 23.346002231101323, -27.013673711287723, -0.658373095602574, -2.088520488335295, -6.714950271453045, -21.739961949174862, 35.66021741672711, 28.891663243363897, -10.810915070288221, 13.077654592403768, -15.152922924552954, -24.10047107725082], "policy_adversary_policy_reward": [-18.637578222323935, -8.720765256722515, -1.4369990148711054, 0.8864986398601902, -6.53098797484763, 3.9420943398721136, 33.14782591888098, -3.078748303794443, 35.004851821243165, -10.626722768043841, 19.157153618418114, -6.765387033113811, -11.93835327419491, 5.386786059860537, 6.732466837246482, 11.133939446043577, -14.037347199519505, -27.172275821234603, 35.22852130455124, 19.631879837358433, 1.208682965494876, 0.0, 36.324462208906326, 24.448990878979973, 17.300823832119274, 8.736740802322792, 17.16011396639218, 13.33069463903152, 15.644962221436355, 17.443060326372716, 16.248514077805282, -11.21658058636617, 20.081915220207378, -5.41814587565197, 3.358303003861142, 9.5751144760479, -5.465671777493186, -22.782182820647822, 8.842154767166758, -2.175689167439357, 21.122156455098196, 25.318110215536358, -12.328998495003702, -18.224903099234538, 3.8053825004860187, 4.705690817156874, 15.364246945587382, 8.086586029592084, -1.8720378469714447, 5.55900451899738, -22.998542602727653, -28.174388407814092, -15.310336416707813, -23.559383364552684, -3.4997758842090576, -11.789678600769214, -25.75268747481774, -16.507103905961344, 1.9439373373353845, 1.648136342644655, -21.538576582172396, 1.40140895565761, 42.82348798464939, 40.00980641965404, -1.5033930223348655, -3.371218672760211, -3.7672928840262827, 0.8170832111728998, 8.334665513249135, 3.256428135204146, 6.776851450439274, 9.813155756504479, 19.951111745872087, -12.92312096914332, 3.0577671655262293, 15.24917253369895, -0.9079383509169521, -3.3188819596950836, 17.933186002776825, 5.286704749642869, -10.229853162876406, -2.156104648777415, -26.205083955813762, 7.4849141520055795, 20.126995280152837, 1.1540557832926481, -19.267699841775826, -15.049261614643857, -15.247629384061788, 1.6958932561413533, 9.31110875956016, 33.652995751615194, 16.84772234023129, -7.605232636233229, -0.3622052831558289, -4.750279879803202, -15.598359304247428, 14.045140370734467, -1.5384243388679764, 0.022816429126059745, 28.619275987045878, 29.26603576606987, 25.237702006959623, 18.99283223765122, -25.66331852695046, 19.536897339515594, 26.66304448576914, 11.535336516107703, -8.433554052960801, -26.313864043921356, -23.047332981483287, -25.010882644737546, -8.111408809652861, 12.406198134060585, 26.097445809249137, 3.5574342237873573, 10.819691418907224, 9.580818724290605, 37.46549359205531, 34.47895208682526, 29.019284343762305, -7.221768233739182, 5.4862241895368875, 17.502149156571775, -8.46439309744136, 3.1121517137679717, -4.907685387866202, -17.49403241792104, 16.737820239017452, 42.51111941011585, -6.032772594958423, -6.416096917330151, 9.22250116594184, 16.362352713149395, 8.093955352690314, 29.369965587849748, 10.531290891655503, -7.312149492816019, 4.298888505354448, 18.419270332983167, 22.263922154256605, 1.615708211672656, -12.899111618094715, 2.6341167960429317, 30.29024019892181, 37.7015159724481, 27.496011832408712, 28.545920389096118, 5.480040959988099, -18.83334239285318, 14.43576639323625, -0.7562069635878439, 1.893880946705706, -23.13141396581658, -0.21416521858270343, 20.5162288916835, -19.181069020362568, -12.858879486701788, -1.071426128164557, -7.923345500571941, -6.135571534957364, -22.251630983706235, 37.81896508057039, 28.04404397948344, 20.94715663322372, 4.109989843862994, 34.27739822703855, 5.736212800360848, -0.5009273285848721, -0.8988965005917109, 13.978761842724339, -2.3669766710917095, 7.488727492277789, 16.224441650165698, -2.377376440453588, 1.691232941721772, 8.18333854056397, 15.162663690537364, -10.535970406993755, -16.477703304293968, -5.222895433025265, 4.564522337422691, 7.802932016858037, -9.891452505193332, 0.3782675509387836, -7.0932178223918285, -5.749785798065119, -15.990176151109743, 12.648427995469465, 23.01178942125763, -6.985737088201187, 35.877400331565084, -14.946736713317044, 4.135821643028827, 14.127859710815047, -1.0502051184112755, -11.743286519191606, -3.409636405361347, -6.1618564216599125, -17.938614655590907]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38980472291333307, "mean_inference_ms": 0.967602736813115, "mean_action_processing_ms": 0.16605414312128985, "mean_env_wait_ms": 0.05750900739821578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003219008445739746, "StateBufferConnector_ms": 0.002859950065612793, "ViewRequirementAgentConnector_ms": 0.06697511672973633}, "num_episodes": 20, "episode_return_max": 165.66658880860686, "episode_return_min": -102.34586202108358, "episode_return_mean": 16.003620230816253}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 473.339336542926, "num_env_steps_trained_throughput_per_sec": 473.339336542926, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 660000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 8539.979, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8539.942, "sample_time_ms": 764.982, "learn_time_ms": 7760.201, "learn_throughput": 515.451, "synch_weights_time_ms": 14.179}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "training_iteration": 55, "trial_id": "eaa30_00000", "date": "2024-08-09_17-47-44", "timestamp": 1723240064, "time_this_iter_s": 8.455941200256348, "time_total_s": 453.54153537750244, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2888280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 453.54153537750244, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 23.466666666666665, "ram_util_percent": 81.30833333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.232705820048297, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.6566346632740485, "policy_loss": -0.003863206333431499, "vf_loss": 5.6564098269851115, "vf_explained_var": 0.12229395644374626, "kl": 0.01008253417017244, "entropy": 1.4649625557440298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.388184714565675, "cur_kl_coeff": 0.1282892256975174, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.374369904895624, "policy_loss": 0.000855349453437763, "vf_loss": 7.372763379911581, "vf_explained_var": 0.21782319750636817, "kl": 0.005855465601295388, "entropy": 0.6421068467820684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 165.66658880860686, "episode_reward_min": -102.34586202108358, "episode_reward_mean": 18.096438418101517, "episode_len_mean": 172.0, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 17200, "policy_reward_min": {"agent_policy": -51.172931010541745, "adversary_policy": -28.174388407814092}, "policy_reward_max": {"agent_policy": 82.83329440430339, "adversary_policy": 42.82348798464939}, "policy_reward_mean": {"agent_policy": 9.04821920905076, "adversary_policy": 4.52410960452538}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.373933344051876, -102.34586202108358, -77.739439562521, -30.578908969956544, -84.51958276155815, 7.184147359960114, -40.27433525302956, 165.66658880860686, -9.749223390190153, -5.900419345706766, 23.182187296906566, 33.180014413887505, 14.055981553457533, 36.613879398450365, -8.453640621224075, 46.43978150483939, -24.77191562330762, -37.44033960761631, 42.56210212689096, -68.63392291283932, -27.10347225584083, 85.92820902235076, 18.484979407996104, -10.224970325918068, -3.1064378670259636, -3.0312158194838332, 115.7706235062314, 88.4610684892217, -12.25284237486973, 76.39676200375366, -69.49483619376434, -96.11643125244174, 8.58957864881543, 59.30976006607294, 40.801020286395655, 143.88889135776117, 43.595032220046264, 45.976746692217304, -10.704482767346775, -44.8034356115745, 118.49787929826653, -24.897739024577135, 51.16970775818246, 74.92784188108013, 6.438282797679049, 45.436317676675245, 47.75926073185853, -20.529989644103573, 135.98351234273986, 112.08386444300959, -26.706602865730154, 27.3591188592968, -42.47506603822174, 40.60412734620157, -64.07989701412873, -17.989543257472995, -56.774405037327284, 131.72601812010757, 50.11429295417335, 80.0272220547989, -2.799647658353095, 23.22357034326528, 47.42633828488694, -1.3722869974636325, 46.69200446220266, -54.02734742257542, -1.316746191205148, -4.1770409766706, -13.429900542906097, -43.479923898349725, 71.32043483345424, 57.78332648672776, -21.621830140576428, 26.155309184807535, -30.305845849105907, -48.20094215450164, 1.013672254473434, -19.070528139099977, 2.796486038785641, 30.81852481772129, 34.094986651635395, 31.3486371674839, 52.53606046794927, 68.3390334152021, 15.930651953908622, 56.736218951967835, -13.164532743174487, 73.42870748771203, 74.144647368794, 68.8167765605484, 30.10970668238275, -4.8356138464838665, 62.6356458667979, 17.50224038890382, 29.382441091437002, 55.85211659225328, 17.640173313427468, 37.08733548989722, -14.257165764025086, 43.99837162489459], "episode_lengths": [92, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 57, 200, 91, 200, 200, 47, 200, 200, 200, 146, 200, 81, 200, 153, 189, 63, 141, 200, 200, 143, 159, 92, 200, 200, 200, 200, 200, 162, 200, 24, 200, 200, 200, 200, 200, 200, 96, 200, 51, 200, 200, 200, 200, 200, 96, 135, 200, 200, 200, 200, 200, 126, 200, 200, 200, 200, 200, 113, 83, 200, 110, 200, 200, 200, 200, 6, 150, 200, 200, 156, 200, 200, 200, 200, 192, 110, 200, 200, 200, 200, 200, 200, 200, 200, 102, 200, 200], "policy_agent_policy_reward": [3.6869666720259353, -51.172931010541745, -38.86971978126049, -15.289454484978272, -42.259791380779085, 3.5920736799800395, -20.13716762651478, 82.83329440430339, -4.874611695095076, -2.950209672853383, 11.591093648453281, 16.590007206943753, 7.027990776728767, 18.30693969922518, -4.22682031061203, 23.219890752419694, -12.385957811653821, -18.720169803808183, 21.281051063445478, -34.31696145641969, -13.551736127920435, 42.964104511175336, 9.242489703998064, -5.112485162959031, -1.5532189335129658, -1.5156079097419166, 57.88531175311576, 44.23053424461085, -6.126421187434863, 38.19838100187685, -34.74741809688216, -48.05821562622083, 4.2947893244077235, 29.654880033036484, 20.400510143197828, 71.94444567888056, 21.797516110023093, 22.98837334610866, -5.3522413836733875, -22.401717805787243, 59.24893964913332, -12.448869512288574, 25.584853879091238, 37.463920940540085, 3.219141398839481, 22.718158838337615, 23.87963036592927, -10.264994822051786, 67.99175617137, 56.041932221504815, -13.35330143286508, 13.679559429648405, -21.237533019110877, 20.302063673100804, -32.03994850706435, -8.994771628736498, -28.38720251866362, 65.86300906005384, 25.057146477086707, 40.0136110273994, -1.3998238291765936, 11.61178517163263, 23.71316914244348, -0.6861434987318162, 23.346002231101323, -27.013673711287723, -0.658373095602574, -2.088520488335295, -6.714950271453045, -21.739961949174862, 35.66021741672711, 28.891663243363897, -10.810915070288221, 13.077654592403768, -15.152922924552954, -24.10047107725082, 0.506836127236717, -9.535264069550045, 1.3982430193928206, 15.409262408860641, 17.047493325817694, 15.674318583741952, 26.268030233974617, 34.169516707601, 7.965325976954313, 28.368109475983925, -6.582266371587235, 36.71435374385602, 37.072323684396984, 34.408388280274195, 15.054853341191375, -2.417806923241912, 31.31782293339896, 8.751120194451914, 14.691220545718505, 27.92605829612664, 8.820086656713734, 18.543667744948607, -7.128582882012546, 21.99918581244729], "policy_adversary_policy_reward": [-1.8720378469714447, 5.55900451899738, -22.998542602727653, -28.174388407814092, -15.310336416707813, -23.559383364552684, -3.4997758842090576, -11.789678600769214, -25.75268747481774, -16.507103905961344, 1.9439373373353845, 1.648136342644655, -21.538576582172396, 1.40140895565761, 42.82348798464939, 40.00980641965404, -1.5033930223348655, -3.371218672760211, -3.7672928840262827, 0.8170832111728998, 8.334665513249135, 3.256428135204146, 6.776851450439274, 9.813155756504479, 19.951111745872087, -12.92312096914332, 3.0577671655262293, 15.24917253369895, -0.9079383509169521, -3.3188819596950836, 17.933186002776825, 5.286704749642869, -10.229853162876406, -2.156104648777415, -26.205083955813762, 7.4849141520055795, 20.126995280152837, 1.1540557832926481, -19.267699841775826, -15.049261614643857, -15.247629384061788, 1.6958932561413533, 9.31110875956016, 33.652995751615194, 16.84772234023129, -7.605232636233229, -0.3622052831558289, -4.750279879803202, -15.598359304247428, 14.045140370734467, -1.5384243388679764, 0.022816429126059745, 28.619275987045878, 29.26603576606987, 25.237702006959623, 18.99283223765122, -25.66331852695046, 19.536897339515594, 26.66304448576914, 11.535336516107703, -8.433554052960801, -26.313864043921356, -23.047332981483287, -25.010882644737546, -8.111408809652861, 12.406198134060585, 26.097445809249137, 3.5574342237873573, 10.819691418907224, 9.580818724290605, 37.46549359205531, 34.47895208682526, 29.019284343762305, -7.221768233739182, 5.4862241895368875, 17.502149156571775, -8.46439309744136, 3.1121517137679717, -4.907685387866202, -17.49403241792104, 16.737820239017452, 42.51111941011585, -6.032772594958423, -6.416096917330151, 9.22250116594184, 16.362352713149395, 8.093955352690314, 29.369965587849748, 10.531290891655503, -7.312149492816019, 4.298888505354448, 18.419270332983167, 22.263922154256605, 1.615708211672656, -12.899111618094715, 2.6341167960429317, 30.29024019892181, 37.7015159724481, 27.496011832408712, 28.545920389096118, 5.480040959988099, -18.83334239285318, 14.43576639323625, -0.7562069635878439, 1.893880946705706, -23.13141396581658, -0.21416521858270343, 20.5162288916835, -19.181069020362568, -12.858879486701788, -1.071426128164557, -7.923345500571941, -6.135571534957364, -22.251630983706235, 37.81896508057039, 28.04404397948344, 20.94715663322372, 4.109989843862994, 34.27739822703855, 5.736212800360848, -0.5009273285848721, -0.8988965005917109, 13.978761842724339, -2.3669766710917095, 7.488727492277789, 16.224441650165698, -2.377376440453588, 1.691232941721772, 8.18333854056397, 15.162663690537364, -10.535970406993755, -16.477703304293968, -5.222895433025265, 4.564522337422691, 7.802932016858037, -9.891452505193332, 0.3782675509387836, -7.0932178223918285, -5.749785798065119, -15.990176151109743, 12.648427995469465, 23.01178942125763, -6.985737088201187, 35.877400331565084, -14.946736713317044, 4.135821643028827, 14.127859710815047, -1.0502051184112755, -11.743286519191606, -3.409636405361347, -6.1618564216599125, -17.938614655590907, 4.377323537688952, -3.8704874104522347, -7.540077056864185, -1.9951870126858573, -1.3770894828744886, 2.775332502267309, 10.886009345020785, 4.523253063839867, 16.31512821819173, 0.7323651076259639, 17.099031075349387, -1.4247124916074343, 20.323303129222793, 5.944727104751827, 5.432677120043939, 28.736839587557036, -5.833403442200504, 13.798729419154819, 12.194937466749597, 16.173172009234314, -1.026096471146909, -5.556169900440324, 0.4833860947152644, 36.23096764914078, 17.028989011368054, 20.043334673028934, 1.0044896250735178, 33.40389865520067, 11.865410826070407, 3.1894425151209678, -3.667144147221716, 1.2493372239798042, 25.188735956293375, 6.129086977105587, -1.1653570767885775, 9.916477271240488, 19.864624210638407, -5.173403664919903, 4.6905010913770795, 23.23555720474956, 3.870210365217414, 4.94987629149632, 4.556425303066824, 13.987242441881783, -3.225670036810822, -3.9029128452017208, 18.372756136600568, 3.6264296758467225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3899733219507307, "mean_inference_ms": 0.9684841706040401, "mean_action_processing_ms": 0.16605097715149694, "mean_env_wait_ms": 0.057401798360645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003602266311645508, "StateBufferConnector_ms": 0.002479076385498047, "ViewRequirementAgentConnector_ms": 0.06533181667327881}, "num_episodes": 24, "episode_return_max": 165.66658880860686, "episode_return_min": -102.34586202108358, "episode_return_mean": 18.096438418101517}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 476.83142675692727, "num_env_steps_trained_throughput_per_sec": 476.83142675692727, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 8547.281, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8547.243, "sample_time_ms": 767.872, "learn_time_ms": 7764.392, "learn_throughput": 515.172, "synch_weights_time_ms": 14.311}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 56, "trial_id": "eaa30_00000", "date": "2024-08-09_17-47-53", "timestamp": 1723240073, "time_this_iter_s": 8.411668062210083, "time_total_s": 461.9532034397125, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a28884c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 461.9532034397125, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 26.141666666666666, "ram_util_percent": 81.38333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.786765504514099, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.050964046912219, "policy_loss": 0.0010107876870919157, "vf_loss": 6.045915286250846, "vf_explained_var": 0.023793372401484738, "kl": 0.009959062965458664, "entropy": 1.4528571331311786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.544685376559695, "cur_kl_coeff": 0.1282892256975174, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.38997068554163, "policy_loss": -0.001039599128610765, "vf_loss": 7.390546128153801, "vf_explained_var": 0.1490930532415708, "kl": 0.0036179855920636327, "entropy": 0.6943647183477879, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "env_runners": {"episode_reward_max": 143.88889135776117, "episode_reward_min": -96.11643125244174, "episode_reward_mean": 28.867660528014923, "episode_len_mean": 167.95, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 16795, "policy_reward_min": {"agent_policy": -48.05821562622083, "adversary_policy": -26.313864043921356}, "policy_reward_max": {"agent_policy": 71.94444567888056, "adversary_policy": 42.51111941011585}, "policy_reward_mean": {"agent_policy": 14.433830264007458, "adversary_policy": 7.216915132003729}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.25284237486973, 76.39676200375366, -69.49483619376434, -96.11643125244174, 8.58957864881543, 59.30976006607294, 40.801020286395655, 143.88889135776117, 43.595032220046264, 45.976746692217304, -10.704482767346775, -44.8034356115745, 118.49787929826653, -24.897739024577135, 51.16970775818246, 74.92784188108013, 6.438282797679049, 45.436317676675245, 47.75926073185853, -20.529989644103573, 135.98351234273986, 112.08386444300959, -26.706602865730154, 27.3591188592968, -42.47506603822174, 40.60412734620157, -64.07989701412873, -17.989543257472995, -56.774405037327284, 131.72601812010757, 50.11429295417335, 80.0272220547989, -2.799647658353095, 23.22357034326528, 47.42633828488694, -1.3722869974636325, 46.69200446220266, -54.02734742257542, -1.316746191205148, -4.1770409766706, -13.429900542906097, -43.479923898349725, 71.32043483345424, 57.78332648672776, -21.621830140576428, 26.155309184807535, -30.305845849105907, -48.20094215450164, 1.013672254473434, -19.070528139099977, 2.796486038785641, 30.81852481772129, 34.094986651635395, 31.3486371674839, 52.53606046794927, 68.3390334152021, 15.930651953908622, 56.736218951967835, -13.164532743174487, 73.42870748771203, 74.144647368794, 68.8167765605484, 30.10970668238275, -4.8356138464838665, 62.6356458667979, 17.50224038890382, 29.382441091437002, 55.85211659225328, 17.640173313427468, 37.08733548989722, -14.257165764025086, 43.99837162489459, 33.00447592436305, 54.57449645771065, 33.840718204862874, 1.4091039477186942, 16.042059546063392, 74.42533647784724, 47.70265919021644, 59.06121251031426, 34.990476677297295, 6.865548886183618, 63.024180804176, 27.11205476170126, 3.547453833121054, 60.65312358802795, 36.271876207804894, 38.14655807145171, 30.69772419488581, 91.79190199960831, 20.382427228734606, 21.570598971228925, 32.08703229171047, 120.81432132718412, 88.85884598563112, 55.28483846788793, 18.397511611745024, 19.782882544675243, 39.38457287227984, 98.4280283024573], "episode_lengths": [63, 141, 200, 200, 143, 159, 92, 200, 200, 200, 200, 200, 162, 200, 24, 200, 200, 200, 200, 200, 200, 96, 200, 51, 200, 200, 200, 200, 200, 96, 135, 200, 200, 200, 200, 200, 126, 200, 200, 200, 200, 200, 113, 83, 200, 110, 200, 200, 200, 200, 6, 150, 200, 200, 156, 200, 200, 200, 200, 192, 110, 200, 200, 200, 200, 200, 200, 200, 200, 102, 200, 200, 45, 98, 133, 46, 200, 200, 200, 162, 200, 200, 200, 57, 200, 188, 159, 200, 152, 165, 66, 73, 200, 182, 200, 159, 200, 159, 200, 41], "policy_agent_policy_reward": [-6.126421187434863, 38.19838100187685, -34.74741809688216, -48.05821562622083, 4.2947893244077235, 29.654880033036484, 20.400510143197828, 71.94444567888056, 21.797516110023093, 22.98837334610866, -5.3522413836733875, -22.401717805787243, 59.24893964913332, -12.448869512288574, 25.584853879091238, 37.463920940540085, 3.219141398839481, 22.718158838337615, 23.87963036592927, -10.264994822051786, 67.99175617137, 56.041932221504815, -13.35330143286508, 13.679559429648405, -21.237533019110877, 20.302063673100804, -32.03994850706435, -8.994771628736498, -28.38720251866362, 65.86300906005384, 25.057146477086707, 40.0136110273994, -1.3998238291765936, 11.61178517163263, 23.71316914244348, -0.6861434987318162, 23.346002231101323, -27.013673711287723, -0.658373095602574, -2.088520488335295, -6.714950271453045, -21.739961949174862, 35.66021741672711, 28.891663243363897, -10.810915070288221, 13.077654592403768, -15.152922924552954, -24.10047107725082, 0.506836127236717, -9.535264069550045, 1.3982430193928206, 15.409262408860641, 17.047493325817694, 15.674318583741952, 26.268030233974617, 34.169516707601, 7.965325976954313, 28.368109475983925, -6.582266371587235, 36.71435374385602, 37.072323684396984, 34.408388280274195, 15.054853341191375, -2.417806923241912, 31.31782293339896, 8.751120194451914, 14.691220545718505, 27.92605829612664, 8.820086656713734, 18.543667744948607, -7.128582882012546, 21.99918581244729, 16.502237962181525, 27.287248228855315, 16.92035910243144, 0.7045519738593469, 8.021029773031678, 37.21266823892362, 23.851329595108226, 29.53060625515715, 17.495238338648655, 3.432774443091809, 31.512090402087992, 13.55602738085062, 1.773726916560527, 30.32656179401395, 18.135938103902436, 19.073279035725836, 15.348862097442895, 45.89595099980417, 10.191213614367312, 10.78529948561446, 16.043516145855243, 60.40716066359205, 44.42942299281559, 27.64241923394397, 9.198755805872512, 9.891441272337623, 19.692286436139916, 49.21401415122863], "policy_adversary_policy_reward": [-25.66331852695046, 19.536897339515594, 26.66304448576914, 11.535336516107703, -8.433554052960801, -26.313864043921356, -23.047332981483287, -25.010882644737546, -8.111408809652861, 12.406198134060585, 26.097445809249137, 3.5574342237873573, 10.819691418907224, 9.580818724290605, 37.46549359205531, 34.47895208682526, 29.019284343762305, -7.221768233739182, 5.4862241895368875, 17.502149156571775, -8.46439309744136, 3.1121517137679717, -4.907685387866202, -17.49403241792104, 16.737820239017452, 42.51111941011585, -6.032772594958423, -6.416096917330151, 9.22250116594184, 16.362352713149395, 8.093955352690314, 29.369965587849748, 10.531290891655503, -7.312149492816019, 4.298888505354448, 18.419270332983167, 22.263922154256605, 1.615708211672656, -12.899111618094715, 2.6341167960429317, 30.29024019892181, 37.7015159724481, 27.496011832408712, 28.545920389096118, 5.480040959988099, -18.83334239285318, 14.43576639323625, -0.7562069635878439, 1.893880946705706, -23.13141396581658, -0.21416521858270343, 20.5162288916835, -19.181069020362568, -12.858879486701788, -1.071426128164557, -7.923345500571941, -6.135571534957364, -22.251630983706235, 37.81896508057039, 28.04404397948344, 20.94715663322372, 4.109989843862994, 34.27739822703855, 5.736212800360848, -0.5009273285848721, -0.8988965005917109, 13.978761842724339, -2.3669766710917095, 7.488727492277789, 16.224441650165698, -2.377376440453588, 1.691232941721772, 8.18333854056397, 15.162663690537364, -10.535970406993755, -16.477703304293968, -5.222895433025265, 4.564522337422691, 7.802932016858037, -9.891452505193332, 0.3782675509387836, -7.0932178223918285, -5.749785798065119, -15.990176151109743, 12.648427995469465, 23.01178942125763, -6.985737088201187, 35.877400331565084, -14.946736713317044, 4.135821643028827, 14.127859710815047, -1.0502051184112755, -11.743286519191606, -3.409636405361347, -6.1618564216599125, -17.938614655590907, 4.377323537688952, -3.8704874104522347, -7.540077056864185, -1.9951870126858573, -1.3770894828744886, 2.775332502267309, 10.886009345020785, 4.523253063839867, 16.31512821819173, 0.7323651076259639, 17.099031075349387, -1.4247124916074343, 20.323303129222793, 5.944727104751827, 5.432677120043939, 28.736839587557036, -5.833403442200504, 13.798729419154819, 12.194937466749597, 16.173172009234314, -1.026096471146909, -5.556169900440324, 0.4833860947152644, 36.23096764914078, 17.028989011368054, 20.043334673028934, 1.0044896250735178, 33.40389865520067, 11.865410826070407, 3.1894425151209678, -3.667144147221716, 1.2493372239798042, 25.188735956293375, 6.129086977105587, -1.1653570767885775, 9.916477271240488, 19.864624210638407, -5.173403664919903, 4.6905010913770795, 23.23555720474956, 3.870210365217414, 4.94987629149632, 4.556425303066824, 13.987242441881783, -3.225670036810822, -3.9029128452017208, 18.372756136600568, 3.6264296758467225, 9.240586996767512, 7.261650965414013, 20.79148206955885, 6.4957661592964655, 8.83820930939734, 8.082149793034098, -5.638641709666853, 6.343193683526199, 8.264923235993237, -0.24389346296155523, 11.94162965828519, 25.271038580638432, 16.06798306969177, 7.783346525416455, 13.37431518450773, 16.156291070649424, -1.1285255574294943, 18.62376389607815, 11.39112453276364, -7.958350089671832, 26.267519737339313, 5.244570664748679, -1.7716409154427168, 15.327668296293336, 8.116013914007993, -6.3422869974474665, 19.04146985051508, 11.285091943498891, 15.390544515158927, 2.7453935887435144, 0.7846848039099292, 18.28859423181591, 9.316972257648494, 6.03188983979441, 16.68659467175023, 29.209356328053943, 10.825343759701424, -0.634130145334117, 13.983752624122452, -3.1984531385079933, 16.223305548115988, -0.1797894022607398, 26.072145093558873, 34.3350155700332, 18.013511010883477, 26.41591198193212, 10.661479059290222, 16.980940174653746, 4.187920863976281, 5.010834941896231, 12.672412678359946, -2.7809714060223207, 4.413954146792255, 15.27833228934766, 30.014766014556965, 19.199248136671667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38985335993754533, "mean_inference_ms": 0.9681101829331067, "mean_action_processing_ms": 0.1657760835619971, "mean_env_wait_ms": 0.057374063518941164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036916732788085938, "StateBufferConnector_ms": 0.0025256872177124023, "ViewRequirementAgentConnector_ms": 0.06575477123260498}, "num_episodes": 28, "episode_return_max": 143.88889135776117, "episode_return_min": -96.11643125244174, "episode_return_mean": 28.867660528014923}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 479.93309343376336, "num_env_steps_trained_throughput_per_sec": 479.93309343376336, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 684000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 8530.34, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8530.302, "sample_time_ms": 768.772, "learn_time_ms": 7746.64, "learn_throughput": 516.353, "synch_weights_time_ms": 14.221}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "training_iteration": 57, "trial_id": "eaa30_00000", "date": "2024-08-09_17-48-01", "timestamp": 1723240081, "time_this_iter_s": 8.339846134185791, "time_total_s": 470.2930495738983, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2888700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 470.2930495738983, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 22.783333333333335, "ram_util_percent": 81.49166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.158561555986052, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.2116636906982095, "policy_loss": -0.0003102184653962179, "vf_loss": 6.207337681957023, "vf_explained_var": -0.0063044135848050395, "kl": 0.011434553686539253, "entropy": 1.4446254389626638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.633745574206113, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.445015053451061, "policy_loss": -0.00024139462281406546, "vf_loss": 7.444465501109759, "vf_explained_var": -0.11019602629045645, "kl": 0.012330212390709978, "entropy": 0.7016205130765836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "env_runners": {"episode_reward_max": 131.72601812010757, "episode_reward_min": -64.07989701412873, "episode_reward_mean": 31.68618737908521, "episode_len_mean": 165.65, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 16565, "policy_reward_min": {"agent_policy": -32.03994850706435, "adversary_policy": -22.251630983706235}, "policy_reward_max": {"agent_policy": 65.86300906005384, "adversary_policy": 43.91408475461883}, "policy_reward_mean": {"agent_policy": 15.843093689542606, "adversary_policy": 7.921546844771303}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.60412734620157, -64.07989701412873, -17.989543257472995, -56.774405037327284, 131.72601812010757, 50.11429295417335, 80.0272220547989, -2.799647658353095, 23.22357034326528, 47.42633828488694, -1.3722869974636325, 46.69200446220266, -54.02734742257542, -1.316746191205148, -4.1770409766706, -13.429900542906097, -43.479923898349725, 71.32043483345424, 57.78332648672776, -21.621830140576428, 26.155309184807535, -30.305845849105907, -48.20094215450164, 1.013672254473434, -19.070528139099977, 2.796486038785641, 30.81852481772129, 34.094986651635395, 31.3486371674839, 52.53606046794927, 68.3390334152021, 15.930651953908622, 56.736218951967835, -13.164532743174487, 73.42870748771203, 74.144647368794, 68.8167765605484, 30.10970668238275, -4.8356138464838665, 62.6356458667979, 17.50224038890382, 29.382441091437002, 55.85211659225328, 17.640173313427468, 37.08733548989722, -14.257165764025086, 43.99837162489459, 33.00447592436305, 54.57449645771065, 33.840718204862874, 1.4091039477186942, 16.042059546063392, 74.42533647784724, 47.70265919021644, 59.06121251031426, 34.990476677297295, 6.865548886183618, 63.024180804176, 27.11205476170126, 3.547453833121054, 60.65312358802795, 36.271876207804894, 38.14655807145171, 30.69772419488581, 91.79190199960831, 20.382427228734606, 21.570598971228925, 32.08703229171047, 120.81432132718412, 88.85884598563112, 55.28483846788793, 18.397511611745024, 19.782882544675243, 39.38457287227984, 98.4280283024573, 31.440713306629505, 50.66821249740944, 25.38762497127719, 17.86170661361779, 35.358121424583274, -14.812245274491078, 118.60568550842567, 62.560431071638945, -1.4463215913283136, 18.620274905414117, 59.77321062372339, 64.41254083188079, 17.52683656692679, 41.67535142326501, 40.327696534617516, 22.710879020237464, 79.1042170558481, 45.87470465034642, 26.581554423377526, 40.92368830516979, 78.80230966422053, 5.291030349730439, 30.865307269935784, 50.68576204122935, 23.285544204565134], "episode_lengths": [200, 200, 200, 200, 96, 135, 200, 200, 200, 200, 200, 126, 200, 200, 200, 200, 200, 113, 83, 200, 110, 200, 200, 200, 200, 6, 150, 200, 200, 156, 200, 200, 200, 200, 192, 110, 200, 200, 200, 200, 200, 200, 200, 200, 102, 200, 200, 45, 98, 133, 46, 200, 200, 200, 162, 200, 200, 200, 57, 200, 188, 159, 200, 152, 165, 66, 73, 200, 182, 200, 159, 200, 159, 200, 41, 178, 171, 200, 200, 101, 115, 200, 87, 104, 25, 200, 200, 133, 200, 138, 200, 200, 154, 200, 200, 200, 5, 174, 200, 116], "policy_agent_policy_reward": [20.302063673100804, -32.03994850706435, -8.994771628736498, -28.38720251866362, 65.86300906005384, 25.057146477086707, 40.0136110273994, -1.3998238291765936, 11.61178517163263, 23.71316914244348, -0.6861434987318162, 23.346002231101323, -27.013673711287723, -0.658373095602574, -2.088520488335295, -6.714950271453045, -21.739961949174862, 35.66021741672711, 28.891663243363897, -10.810915070288221, 13.077654592403768, -15.152922924552954, -24.10047107725082, 0.506836127236717, -9.535264069550045, 1.3982430193928206, 15.409262408860641, 17.047493325817694, 15.674318583741952, 26.268030233974617, 34.169516707601, 7.965325976954313, 28.368109475983925, -6.582266371587235, 36.71435374385602, 37.072323684396984, 34.408388280274195, 15.054853341191375, -2.417806923241912, 31.31782293339896, 8.751120194451914, 14.691220545718505, 27.92605829612664, 8.820086656713734, 18.543667744948607, -7.128582882012546, 21.99918581244729, 16.502237962181525, 27.287248228855315, 16.92035910243144, 0.7045519738593469, 8.021029773031678, 37.21266823892362, 23.851329595108226, 29.53060625515715, 17.495238338648655, 3.432774443091809, 31.512090402087992, 13.55602738085062, 1.773726916560527, 30.32656179401395, 18.135938103902436, 19.073279035725836, 15.348862097442895, 45.89595099980417, 10.191213614367312, 10.78529948561446, 16.043516145855243, 60.40716066359205, 44.42942299281559, 27.64241923394397, 9.198755805872512, 9.891441272337623, 19.692286436139916, 49.21401415122863, 15.72035665331475, 25.3341062487047, 12.693812485638606, 8.930853306808888, 17.679060712291626, -7.40612263724555, 59.30284275421294, 31.28021553581947, -0.7231607956641621, 9.31013745270706, 29.886605311861693, 32.206270415940395, 8.763418283463382, 20.837675711632507, 20.16384826730877, 11.355439510118714, 39.55210852792412, 22.93735232517322, 13.290777211688727, 20.461844152584902, 39.401154832110244, 2.6455151748652197, 15.432653634967902, 25.342881020614673, 11.642772102282567], "policy_adversary_policy_reward": [-0.21416521858270343, 20.5162288916835, -19.181069020362568, -12.858879486701788, -1.071426128164557, -7.923345500571941, -6.135571534957364, -22.251630983706235, 37.81896508057039, 28.04404397948344, 20.94715663322372, 4.109989843862994, 34.27739822703855, 5.736212800360848, -0.5009273285848721, -0.8988965005917109, 13.978761842724339, -2.3669766710917095, 7.488727492277789, 16.224441650165698, -2.377376440453588, 1.691232941721772, 8.18333854056397, 15.162663690537364, -10.535970406993755, -16.477703304293968, -5.222895433025265, 4.564522337422691, 7.802932016858037, -9.891452505193332, 0.3782675509387836, -7.0932178223918285, -5.749785798065119, -15.990176151109743, 12.648427995469465, 23.01178942125763, -6.985737088201187, 35.877400331565084, -14.946736713317044, 4.135821643028827, 14.127859710815047, -1.0502051184112755, -11.743286519191606, -3.409636405361347, -6.1618564216599125, -17.938614655590907, 4.377323537688952, -3.8704874104522347, -7.540077056864185, -1.9951870126858573, -1.3770894828744886, 2.775332502267309, 10.886009345020785, 4.523253063839867, 16.31512821819173, 0.7323651076259639, 17.099031075349387, -1.4247124916074343, 20.323303129222793, 5.944727104751827, 5.432677120043939, 28.736839587557036, -5.833403442200504, 13.798729419154819, 12.194937466749597, 16.173172009234314, -1.026096471146909, -5.556169900440324, 0.4833860947152644, 36.23096764914078, 17.028989011368054, 20.043334673028934, 1.0044896250735178, 33.40389865520067, 11.865410826070407, 3.1894425151209678, -3.667144147221716, 1.2493372239798042, 25.188735956293375, 6.129086977105587, -1.1653570767885775, 9.916477271240488, 19.864624210638407, -5.173403664919903, 4.6905010913770795, 23.23555720474956, 3.870210365217414, 4.94987629149632, 4.556425303066824, 13.987242441881783, -3.225670036810822, -3.9029128452017208, 18.372756136600568, 3.6264296758467225, 9.240586996767512, 7.261650965414013, 20.79148206955885, 6.4957661592964655, 8.83820930939734, 8.082149793034098, -5.638641709666853, 6.343193683526199, 8.264923235993237, -0.24389346296155523, 11.94162965828519, 25.271038580638432, 16.06798306969177, 7.783346525416455, 13.37431518450773, 16.156291070649424, -1.1285255574294943, 18.62376389607815, 11.39112453276364, -7.958350089671832, 26.267519737339313, 5.244570664748679, -1.7716409154427168, 15.327668296293336, 8.116013914007993, -6.3422869974474665, 19.04146985051508, 11.285091943498891, 15.390544515158927, 2.7453935887435144, 0.7846848039099292, 18.28859423181591, 9.316972257648494, 6.03188983979441, 16.68659467175023, 29.209356328053943, 10.825343759701424, -0.634130145334117, 13.983752624122452, -3.1984531385079933, 16.223305548115988, -0.1797894022607398, 26.072145093558873, 34.3350155700332, 18.013511010883477, 26.41591198193212, 10.661479059290222, 16.980940174653746, 4.187920863976281, 5.010834941896231, 12.672412678359946, -2.7809714060223207, 4.413954146792255, 15.27833228934766, 30.014766014556965, 19.199248136671667, 7.522039831896439, 8.19831682141831, 17.359156201035937, 7.974950047668765, 13.61953229825896, -0.9257198126203505, -4.785168823265554, 13.716022130074442, 8.840064333164428, 8.838996379127199, -18.043959378445358, 10.637836741199802, 43.91408475461883, 15.388757999594123, 14.59268886991217, 16.6875266659073, 10.802222929764206, -11.525383725428359, -7.30385246255867, 16.61398991526573, 25.33294631850026, 4.553658993361427, 17.186113246250635, 15.020157169689767, 1.956030749590294, 6.8073875338730705, 14.438712263879987, 6.3989634477525215, 6.402770283336366, 13.761077983972399, 7.509918881478704, 3.84552062864001, 32.521091331379864, 7.031017196544237, 2.6001251225454567, 20.337227202627755, 11.495163982393223, 1.7956132292955047, 14.28026115850954, 6.181582994075363, 5.6495482029623645, 33.75160662914789, 0.487780209070531, 2.1577349657946883, 8.829866583221367, 6.602787051746493, 12.603223807416377, 12.739657213198296, 11.305224490758963, 0.33754761152360047]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38972224184805143, "mean_inference_ms": 0.9671884971014054, "mean_action_processing_ms": 0.16574589851631022, "mean_env_wait_ms": 0.05734712099973697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003632783889770508, "StateBufferConnector_ms": 0.0025022029876708984, "ViewRequirementAgentConnector_ms": 0.06466066837310791}, "num_episodes": 25, "episode_return_max": 131.72601812010757, "episode_return_min": -64.07989701412873, "episode_return_mean": 31.68618737908521}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 481.2060163372172, "num_env_steps_trained_throughput_per_sec": 481.2060163372172, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 8549.596, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8549.558, "sample_time_ms": 767.325, "learn_time_ms": 7767.419, "learn_throughput": 514.972, "synch_weights_time_ms": 14.148}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "training_iteration": 58, "trial_id": "eaa30_00000", "date": "2024-08-09_17-48-10", "timestamp": 1723240090, "time_this_iter_s": 8.318376779556274, "time_total_s": 478.6114263534546, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2888940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 478.6114263534546, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 22.450000000000003, "ram_util_percent": 81.35833333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8747058153467835, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.825419914407074, "policy_loss": -0.0020166768754029244, "vf_loss": 5.822439357969496, "vf_explained_var": -0.07175475330579849, "kl": 0.012324975898597764, "entropy": 1.4393139800697408, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.055245065658043, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.886240521570047, "policy_loss": -0.001505189185506121, "vf_loss": 6.886695491770904, "vf_explained_var": -0.05685674380511045, "kl": 0.016373036139217825, "entropy": 0.7184960435455044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "env_runners": {"episode_reward_max": 120.81432132718412, "episode_reward_min": -49.35805511662511, "episode_reward_mean": 36.45022197760948, "episode_len_mean": 165.68, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 16568, "policy_reward_min": {"agent_policy": -24.679027558312555, "adversary_policy": -18.043959378445358}, "policy_reward_max": {"agent_policy": 60.40716066359205, "adversary_policy": 43.91408475461883}, "policy_reward_mean": {"agent_policy": 18.225110988804737, "adversary_policy": 9.112555494402368}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.305845849105907, -48.20094215450164, 1.013672254473434, -19.070528139099977, 2.796486038785641, 30.81852481772129, 34.094986651635395, 31.3486371674839, 52.53606046794927, 68.3390334152021, 15.930651953908622, 56.736218951967835, -13.164532743174487, 73.42870748771203, 74.144647368794, 68.8167765605484, 30.10970668238275, -4.8356138464838665, 62.6356458667979, 17.50224038890382, 29.382441091437002, 55.85211659225328, 17.640173313427468, 37.08733548989722, -14.257165764025086, 43.99837162489459, 33.00447592436305, 54.57449645771065, 33.840718204862874, 1.4091039477186942, 16.042059546063392, 74.42533647784724, 47.70265919021644, 59.06121251031426, 34.990476677297295, 6.865548886183618, 63.024180804176, 27.11205476170126, 3.547453833121054, 60.65312358802795, 36.271876207804894, 38.14655807145171, 30.69772419488581, 91.79190199960831, 20.382427228734606, 21.570598971228925, 32.08703229171047, 120.81432132718412, 88.85884598563112, 55.28483846788793, 18.397511611745024, 19.782882544675243, 39.38457287227984, 98.4280283024573, 31.440713306629505, 50.66821249740944, 25.38762497127719, 17.86170661361779, 35.358121424583274, -14.812245274491078, 118.60568550842567, 62.560431071638945, -1.4463215913283136, 18.620274905414117, 59.77321062372339, 64.41254083188079, 17.52683656692679, 41.67535142326501, 40.327696534617516, 22.710879020237464, 79.1042170558481, 45.87470465034642, 26.581554423377526, 40.92368830516979, 78.80230966422053, 5.291030349730439, 30.865307269935784, 50.68576204122935, 23.285544204565134, 52.05247107060413, 58.63705085143751, 42.24087689152552, 74.08674656644055, 39.331856228616886, -18.665276357056236, 45.41235838395801, 22.160226210496894, 45.17806182590404, 95.87592250052158, 50.769516174273974, 25.713831584801696, -49.35805511662511, 37.4151724028837, 69.68784460548935, 22.347429107845564, 20.143225532800848, 48.79569869911417, 11.753533008885022, 26.760289216169056, 50.068755397936144], "episode_lengths": [200, 200, 200, 200, 6, 150, 200, 200, 156, 200, 200, 200, 200, 192, 110, 200, 200, 200, 200, 200, 200, 200, 200, 102, 200, 200, 45, 98, 133, 46, 200, 200, 200, 162, 200, 200, 200, 57, 200, 188, 159, 200, 152, 165, 66, 73, 200, 182, 200, 159, 200, 159, 200, 41, 178, 171, 200, 200, 101, 115, 200, 87, 104, 25, 200, 200, 133, 200, 138, 200, 200, 154, 200, 200, 200, 5, 174, 200, 116, 200, 200, 200, 200, 200, 200, 58, 118, 56, 145, 200, 200, 200, 103, 200, 186, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-15.152922924552954, -24.10047107725082, 0.506836127236717, -9.535264069550045, 1.3982430193928206, 15.409262408860641, 17.047493325817694, 15.674318583741952, 26.268030233974617, 34.169516707601, 7.965325976954313, 28.368109475983925, -6.582266371587235, 36.71435374385602, 37.072323684396984, 34.408388280274195, 15.054853341191375, -2.417806923241912, 31.31782293339896, 8.751120194451914, 14.691220545718505, 27.92605829612664, 8.820086656713734, 18.543667744948607, -7.128582882012546, 21.99918581244729, 16.502237962181525, 27.287248228855315, 16.92035910243144, 0.7045519738593469, 8.021029773031678, 37.21266823892362, 23.851329595108226, 29.53060625515715, 17.495238338648655, 3.432774443091809, 31.512090402087992, 13.55602738085062, 1.773726916560527, 30.32656179401395, 18.135938103902436, 19.073279035725836, 15.348862097442895, 45.89595099980417, 10.191213614367312, 10.78529948561446, 16.043516145855243, 60.40716066359205, 44.42942299281559, 27.64241923394397, 9.198755805872512, 9.891441272337623, 19.692286436139916, 49.21401415122863, 15.72035665331475, 25.3341062487047, 12.693812485638606, 8.930853306808888, 17.679060712291626, -7.40612263724555, 59.30284275421294, 31.28021553581947, -0.7231607956641621, 9.31013745270706, 29.886605311861693, 32.206270415940395, 8.763418283463382, 20.837675711632507, 20.16384826730877, 11.355439510118714, 39.55210852792412, 22.93735232517322, 13.290777211688727, 20.461844152584902, 39.401154832110244, 2.6455151748652197, 15.432653634967902, 25.342881020614673, 11.642772102282567, 26.026235535302064, 29.318525425718768, 21.120438445762787, 37.043373283220205, 19.665928114308443, -9.332638178528114, 22.706179191979004, 11.080113105248452, 22.58903091295201, 47.93796125026076, 25.384758087136987, 12.856915792400851, -24.679027558312555, 18.70758620144185, 34.84392230274467, 11.173714553922752, 10.071612766400433, 24.397849349557085, 5.876766504442511, 13.380144608084528, 25.034377698968072], "policy_adversary_policy_reward": [-11.743286519191606, -3.409636405361347, -6.1618564216599125, -17.938614655590907, 4.377323537688952, -3.8704874104522347, -7.540077056864185, -1.9951870126858573, -1.3770894828744886, 2.775332502267309, 10.886009345020785, 4.523253063839867, 16.31512821819173, 0.7323651076259639, 17.099031075349387, -1.4247124916074343, 20.323303129222793, 5.944727104751827, 5.432677120043939, 28.736839587557036, -5.833403442200504, 13.798729419154819, 12.194937466749597, 16.173172009234314, -1.026096471146909, -5.556169900440324, 0.4833860947152644, 36.23096764914078, 17.028989011368054, 20.043334673028934, 1.0044896250735178, 33.40389865520067, 11.865410826070407, 3.1894425151209678, -3.667144147221716, 1.2493372239798042, 25.188735956293375, 6.129086977105587, -1.1653570767885775, 9.916477271240488, 19.864624210638407, -5.173403664919903, 4.6905010913770795, 23.23555720474956, 3.870210365217414, 4.94987629149632, 4.556425303066824, 13.987242441881783, -3.225670036810822, -3.9029128452017208, 18.372756136600568, 3.6264296758467225, 9.240586996767512, 7.261650965414013, 20.79148206955885, 6.4957661592964655, 8.83820930939734, 8.082149793034098, -5.638641709666853, 6.343193683526199, 8.264923235993237, -0.24389346296155523, 11.94162965828519, 25.271038580638432, 16.06798306969177, 7.783346525416455, 13.37431518450773, 16.156291070649424, -1.1285255574294943, 18.62376389607815, 11.39112453276364, -7.958350089671832, 26.267519737339313, 5.244570664748679, -1.7716409154427168, 15.327668296293336, 8.116013914007993, -6.3422869974474665, 19.04146985051508, 11.285091943498891, 15.390544515158927, 2.7453935887435144, 0.7846848039099292, 18.28859423181591, 9.316972257648494, 6.03188983979441, 16.68659467175023, 29.209356328053943, 10.825343759701424, -0.634130145334117, 13.983752624122452, -3.1984531385079933, 16.223305548115988, -0.1797894022607398, 26.072145093558873, 34.3350155700332, 18.013511010883477, 26.41591198193212, 10.661479059290222, 16.980940174653746, 4.187920863976281, 5.010834941896231, 12.672412678359946, -2.7809714060223207, 4.413954146792255, 15.27833228934766, 30.014766014556965, 19.199248136671667, 7.522039831896439, 8.19831682141831, 17.359156201035937, 7.974950047668765, 13.61953229825896, -0.9257198126203505, -4.785168823265554, 13.716022130074442, 8.840064333164428, 8.838996379127199, -18.043959378445358, 10.637836741199802, 43.91408475461883, 15.388757999594123, 14.59268886991217, 16.6875266659073, 10.802222929764206, -11.525383725428359, -7.30385246255867, 16.61398991526573, 25.33294631850026, 4.553658993361427, 17.186113246250635, 15.020157169689767, 1.956030749590294, 6.8073875338730705, 14.438712263879987, 6.3989634477525215, 6.402770283336366, 13.761077983972399, 7.509918881478704, 3.84552062864001, 32.521091331379864, 7.031017196544237, 2.6001251225454567, 20.337227202627755, 11.495163982393223, 1.7956132292955047, 14.28026115850954, 6.181582994075363, 5.6495482029623645, 33.75160662914789, 0.487780209070531, 2.1577349657946883, 8.829866583221367, 6.602787051746493, 12.603223807416377, 12.739657213198296, 11.305224490758963, 0.33754761152360047, 15.687233556534794, 10.339001978767271, 11.54513293559512, 17.773392490123637, 14.552499439244464, 6.567939006518317, 20.21392233661814, 16.829450946602037, -1.7994939269312322, 21.465422041239677, -3.9345718046894653, -5.398066373838649, 36.672680825184415, -13.966501633205421, 0.8286146663286935, 10.251498438919759, 22.237650809167242, 0.35138010378476014, 25.761523427249, 22.176437823011767, 17.48565191284941, 7.899106174287578, 3.2298411561148725, 9.627074636285979, -14.77516413206493, -9.903863426247625, 19.31038419673699, -0.6027979952951377, 11.562567237115825, 23.281355065628837, -0.6618003767642708, 11.835514930687022, 19.005759490514453, -8.934146724114024, 22.81849442319192, 1.5793549263651663, 16.98763494123706, -11.11086843679455, 6.668035451238097, 6.712109156846434, 17.94408318502142, 7.090294513946645]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38954408718845956, "mean_inference_ms": 0.9667985219483011, "mean_action_processing_ms": 0.16558741240604044, "mean_env_wait_ms": 0.05732017914364574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003652811050415039, "StateBufferConnector_ms": 0.002491474151611328, "ViewRequirementAgentConnector_ms": 0.06368517875671387}, "num_episodes": 21, "episode_return_max": 120.81432132718412, "episode_return_min": -49.35805511662511, "episode_return_mean": 36.45022197760948}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 480.8281245723452, "num_env_steps_trained_throughput_per_sec": 480.8281245723452, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 708000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 8532.521, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8532.483, "sample_time_ms": 765.286, "learn_time_ms": 7752.418, "learn_throughput": 515.968, "synch_weights_time_ms": 14.059}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "training_iteration": 59, "trial_id": "eaa30_00000", "date": "2024-08-09_17-48-18", "timestamp": 1723240098, "time_this_iter_s": 8.324373960494995, "time_total_s": 486.9358003139496, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2888d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 486.9358003139496, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 23.525000000000002, "ram_util_percent": 81.26666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.268707769320756, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.205870940697887, "policy_loss": 0.009055460868871441, "vf_loss": 6.189639685141347, "vf_explained_var": -0.017046824775675616, "kl": 0.017698022299421527, "entropy": 1.4746064120499545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.300742834123472, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.389537692566713, "policy_loss": 0.006363947351201204, "vf_loss": 7.381972762445609, "vf_explained_var": 0.019094233773648737, "kl": 0.018723014155208755, "entropy": 0.700813263344268, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 143.05730325771208, "episode_reward_min": -49.35805511662511, "episode_reward_mean": 42.969841304320326, "episode_len_mean": 161.81, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 16181, "policy_reward_min": {"agent_policy": -24.679027558312555, "adversary_policy": -21.5518914394745}, "policy_reward_max": {"agent_policy": 71.52865162885612, "adversary_policy": 50.05714982050456}, "policy_reward_mean": {"agent_policy": 21.484920652160163, "adversary_policy": 10.742460326080076}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.00447592436305, 54.57449645771065, 33.840718204862874, 1.4091039477186942, 16.042059546063392, 74.42533647784724, 47.70265919021644, 59.06121251031426, 34.990476677297295, 6.865548886183618, 63.024180804176, 27.11205476170126, 3.547453833121054, 60.65312358802795, 36.271876207804894, 38.14655807145171, 30.69772419488581, 91.79190199960831, 20.382427228734606, 21.570598971228925, 32.08703229171047, 120.81432132718412, 88.85884598563112, 55.28483846788793, 18.397511611745024, 19.782882544675243, 39.38457287227984, 98.4280283024573, 31.440713306629505, 50.66821249740944, 25.38762497127719, 17.86170661361779, 35.358121424583274, -14.812245274491078, 118.60568550842567, 62.560431071638945, -1.4463215913283136, 18.620274905414117, 59.77321062372339, 64.41254083188079, 17.52683656692679, 41.67535142326501, 40.327696534617516, 22.710879020237464, 79.1042170558481, 45.87470465034642, 26.581554423377526, 40.92368830516979, 78.80230966422053, 5.291030349730439, 30.865307269935784, 50.68576204122935, 23.285544204565134, 52.05247107060413, 58.63705085143751, 42.24087689152552, 74.08674656644055, 39.331856228616886, -18.665276357056236, 45.41235838395801, 22.160226210496894, 45.17806182590404, 95.87592250052158, 50.769516174273974, 25.713831584801696, -49.35805511662511, 37.4151724028837, 69.68784460548935, 22.347429107845564, 20.143225532800848, 48.79569869911417, 11.753533008885022, 26.760289216169056, 50.068755397936144, 57.94267838467677, 43.84906138452611, 30.46294859007444, 98.27935637082368, 27.704565899818036, 98.28336104645808, 39.07762672389852, 42.801957728627656, 124.31191705377185, 40.49633965015252, 13.461158932096232, 48.98326606963755, 107.34544345715926, 11.586021424215367, 36.29811573333555, 143.05730325771208, -18.22605001318634, 89.97733758299623, 102.20885377809775, 11.990981760766829, 65.876375739897, 51.62676668840374, 11.478787319218611, 4.526639679776601, 43.19361176337284, -0.25468764545909295], "episode_lengths": [45, 98, 133, 46, 200, 200, 200, 162, 200, 200, 200, 57, 200, 188, 159, 200, 152, 165, 66, 73, 200, 182, 200, 159, 200, 159, 200, 41, 178, 171, 200, 200, 101, 115, 200, 87, 104, 25, 200, 200, 133, 200, 138, 200, 200, 154, 200, 200, 200, 5, 174, 200, 116, 200, 200, 200, 200, 200, 200, 58, 118, 56, 145, 200, 200, 200, 103, 200, 186, 200, 200, 200, 200, 200, 192, 200, 200, 200, 200, 200, 14, 200, 195, 200, 96, 200, 200, 122, 200, 190, 173, 200, 172, 11, 141, 200, 200, 200, 200, 23], "policy_agent_policy_reward": [16.502237962181525, 27.287248228855315, 16.92035910243144, 0.7045519738593469, 8.021029773031678, 37.21266823892362, 23.851329595108226, 29.53060625515715, 17.495238338648655, 3.432774443091809, 31.512090402087992, 13.55602738085062, 1.773726916560527, 30.32656179401395, 18.135938103902436, 19.073279035725836, 15.348862097442895, 45.89595099980417, 10.191213614367312, 10.78529948561446, 16.043516145855243, 60.40716066359205, 44.42942299281559, 27.64241923394397, 9.198755805872512, 9.891441272337623, 19.692286436139916, 49.21401415122863, 15.72035665331475, 25.3341062487047, 12.693812485638606, 8.930853306808888, 17.679060712291626, -7.40612263724555, 59.30284275421294, 31.28021553581947, -0.7231607956641621, 9.31013745270706, 29.886605311861693, 32.206270415940395, 8.763418283463382, 20.837675711632507, 20.16384826730877, 11.355439510118714, 39.55210852792412, 22.93735232517322, 13.290777211688727, 20.461844152584902, 39.401154832110244, 2.6455151748652197, 15.432653634967902, 25.342881020614673, 11.642772102282567, 26.026235535302064, 29.318525425718768, 21.120438445762787, 37.043373283220205, 19.665928114308443, -9.332638178528114, 22.706179191979004, 11.080113105248452, 22.58903091295201, 47.93796125026076, 25.384758087136987, 12.856915792400851, -24.679027558312555, 18.70758620144185, 34.84392230274467, 11.173714553922752, 10.071612766400433, 24.397849349557085, 5.876766504442511, 13.380144608084528, 25.034377698968072, 28.971339192338398, 21.924530692263076, 15.231474295037223, 49.139678185411874, 13.852282949909018, 49.14168052322903, 19.538813361949266, 21.400978864313878, 62.15595852688589, 20.248169825076264, 6.73057946604812, 24.491633034818776, 53.672721728579575, 5.793010712107684, 18.149057866667764, 71.52865162885612, -9.113025006593144, 44.98866879149816, 51.10442688904883, 5.9954908803834135, 32.93818786994853, 25.813383344201895, 5.739393659609306, 2.2633198398883074, 21.59680588168643, -0.12734382272954736], "policy_adversary_policy_reward": [9.240586996767512, 7.261650965414013, 20.79148206955885, 6.4957661592964655, 8.83820930939734, 8.082149793034098, -5.638641709666853, 6.343193683526199, 8.264923235993237, -0.24389346296155523, 11.94162965828519, 25.271038580638432, 16.06798306969177, 7.783346525416455, 13.37431518450773, 16.156291070649424, -1.1285255574294943, 18.62376389607815, 11.39112453276364, -7.958350089671832, 26.267519737339313, 5.244570664748679, -1.7716409154427168, 15.327668296293336, 8.116013914007993, -6.3422869974474665, 19.04146985051508, 11.285091943498891, 15.390544515158927, 2.7453935887435144, 0.7846848039099292, 18.28859423181591, 9.316972257648494, 6.03188983979441, 16.68659467175023, 29.209356328053943, 10.825343759701424, -0.634130145334117, 13.983752624122452, -3.1984531385079933, 16.223305548115988, -0.1797894022607398, 26.072145093558873, 34.3350155700332, 18.013511010883477, 26.41591198193212, 10.661479059290222, 16.980940174653746, 4.187920863976281, 5.010834941896231, 12.672412678359946, -2.7809714060223207, 4.413954146792255, 15.27833228934766, 30.014766014556965, 19.199248136671667, 7.522039831896439, 8.19831682141831, 17.359156201035937, 7.974950047668765, 13.61953229825896, -0.9257198126203505, -4.785168823265554, 13.716022130074442, 8.840064333164428, 8.838996379127199, -18.043959378445358, 10.637836741199802, 43.91408475461883, 15.388757999594123, 14.59268886991217, 16.6875266659073, 10.802222929764206, -11.525383725428359, -7.30385246255867, 16.61398991526573, 25.33294631850026, 4.553658993361427, 17.186113246250635, 15.020157169689767, 1.956030749590294, 6.8073875338730705, 14.438712263879987, 6.3989634477525215, 6.402770283336366, 13.761077983972399, 7.509918881478704, 3.84552062864001, 32.521091331379864, 7.031017196544237, 2.6001251225454567, 20.337227202627755, 11.495163982393223, 1.7956132292955047, 14.28026115850954, 6.181582994075363, 5.6495482029623645, 33.75160662914789, 0.487780209070531, 2.1577349657946883, 8.829866583221367, 6.602787051746493, 12.603223807416377, 12.739657213198296, 11.305224490758963, 0.33754761152360047, 15.687233556534794, 10.339001978767271, 11.54513293559512, 17.773392490123637, 14.552499439244464, 6.567939006518317, 20.21392233661814, 16.829450946602037, -1.7994939269312322, 21.465422041239677, -3.9345718046894653, -5.398066373838649, 36.672680825184415, -13.966501633205421, 0.8286146663286935, 10.251498438919759, 22.237650809167242, 0.35138010378476014, 25.761523427249, 22.176437823011767, 17.48565191284941, 7.899106174287578, 3.2298411561148725, 9.627074636285979, -14.77516413206493, -9.903863426247625, 19.31038419673699, -0.6027979952951377, 11.562567237115825, 23.281355065628837, -0.6618003767642708, 11.835514930687022, 19.005759490514453, -8.934146724114024, 22.81849442319192, 1.5793549263651663, 16.98763494123706, -11.11086843679455, 6.668035451238097, 6.712109156846434, 17.94408318502142, 7.090294513946645, 10.042590900760498, 18.928748291577907, 9.825977046938219, 12.098553645324856, 36.78336573451169, -21.5518914394745, 15.60150598063558, 33.53817220477624, -0.7465098196370477, 14.598792769546066, 32.88758905140595, 16.254091471823088, 10.096151623559095, 9.442661738390168, 11.244420502065825, 10.156558362248049, 37.94931647308241, 24.206642053803463, 2.7503521754661904, 17.497817649610074, -1.1989517185800693, 7.929531184628191, 10.890988641431578, 13.6006443933872, 33.86120865242947, 19.811513076150085, -8.542156496153765, 14.33516720826145, 5.861512547016044, 12.28754531965172, 49.03490119499986, 22.493750433856253, 6.048947215686669, -15.161972222279783, 32.291375581021526, 12.697293210476658, 50.05714982050456, 1.0472770685442647, -2.0304721940213692, 8.025963074404784, 21.399832855686004, 11.538355014262521, 18.80986175516057, 7.0035215890413225, -1.706429128031484, 7.44582278764079, 5.019795422270789, -2.756475582382482, 29.063874317990738, -7.467068436304313, -2.1594169408814317, 2.0320731181518847]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3891874881642528, "mean_inference_ms": 0.965971862826855, "mean_action_processing_ms": 0.16554883954271066, "mean_env_wait_ms": 0.057299648037570684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032666921615600586, "StateBufferConnector_ms": 0.002366304397583008, "ViewRequirementAgentConnector_ms": 0.06294465065002441}, "num_episodes": 26, "episode_return_max": 143.05730325771208, "episode_return_min": -49.35805511662511, "episode_return_mean": 42.969841304320326}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 480.4160325797883, "num_env_steps_trained_throughput_per_sec": 480.4160325797883, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 8511.595, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8511.56, "sample_time_ms": 766.482, "learn_time_ms": 7732.688, "learn_throughput": 517.285, "synch_weights_time_ms": 11.731}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 60, "trial_id": "eaa30_00000", "date": "2024-08-09_17-48-27", "timestamp": 1723240107, "time_this_iter_s": 8.331665992736816, "time_total_s": 495.2674663066864, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc1ddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 495.2674663066864, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 24.683333333333334, "ram_util_percent": 81.24166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.062902347877543, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.017913789597769, "policy_loss": 0.0057515612196068835, "vf_loss": 6.00468290545953, "vf_explained_var": 0.0018592959358578636, "kl": 0.018446648800893434, "entropy": 1.4584209643343768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.394831706148882, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.75914409061273, "policy_loss": 0.0029145485862197046, "vf_loss": 7.755196462571621, "vf_explained_var": -0.054986945477624734, "kl": 0.016105394183735675, "entropy": 0.6436291474848985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "env_runners": {"episode_reward_max": 143.05730325771208, "episode_reward_min": -49.35805511662511, "episode_reward_mean": 46.1267158125098, "episode_len_mean": 162.4, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 16240, "policy_reward_min": {"agent_policy": -24.679027558312555, "adversary_policy": -21.5518914394745}, "policy_reward_max": {"agent_policy": 71.52865162885612, "adversary_policy": 50.05714982050456}, "policy_reward_mean": {"agent_policy": 23.0633579062549, "adversary_policy": 11.531678953127448}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.38457287227984, 98.4280283024573, 31.440713306629505, 50.66821249740944, 25.38762497127719, 17.86170661361779, 35.358121424583274, -14.812245274491078, 118.60568550842567, 62.560431071638945, -1.4463215913283136, 18.620274905414117, 59.77321062372339, 64.41254083188079, 17.52683656692679, 41.67535142326501, 40.327696534617516, 22.710879020237464, 79.1042170558481, 45.87470465034642, 26.581554423377526, 40.92368830516979, 78.80230966422053, 5.291030349730439, 30.865307269935784, 50.68576204122935, 23.285544204565134, 52.05247107060413, 58.63705085143751, 42.24087689152552, 74.08674656644055, 39.331856228616886, -18.665276357056236, 45.41235838395801, 22.160226210496894, 45.17806182590404, 95.87592250052158, 50.769516174273974, 25.713831584801696, -49.35805511662511, 37.4151724028837, 69.68784460548935, 22.347429107845564, 20.143225532800848, 48.79569869911417, 11.753533008885022, 26.760289216169056, 50.068755397936144, 57.94267838467677, 43.84906138452611, 30.46294859007444, 98.27935637082368, 27.704565899818036, 98.28336104645808, 39.07762672389852, 42.801957728627656, 124.31191705377185, 40.49633965015252, 13.461158932096232, 48.98326606963755, 107.34544345715926, 11.586021424215367, 36.29811573333555, 143.05730325771208, -18.22605001318634, 89.97733758299623, 102.20885377809775, 11.990981760766829, 65.876375739897, 51.62676668840374, 11.478787319218611, 4.526639679776601, 43.19361176337284, -0.25468764545909295, 100.47874097804842, 103.00280631869774, 12.369941074012013, 69.6263644980699, 78.04101911438202, 43.97744517077101, 78.72124542971851, 14.865995633658791, 21.289790154703866, 89.8013440097564, 40.68163042260779, 21.33580130823133, 77.00074684789743, 34.69165400695246, 66.34278909996107, -6.185147540398821, 38.17998297626427, 66.94334442329459, 15.33965746719544, 46.301865289451456, 15.430037828718321, 72.53793069104228, 56.985812522511154, 89.58400170399614, 101.78445778473247, 56.897613316824305], "episode_lengths": [200, 41, 178, 171, 200, 200, 101, 115, 200, 87, 104, 25, 200, 200, 133, 200, 138, 200, 200, 154, 200, 200, 200, 5, 174, 200, 116, 200, 200, 200, 200, 200, 200, 58, 118, 56, 145, 200, 200, 200, 103, 200, 186, 200, 200, 200, 200, 200, 192, 200, 200, 200, 200, 200, 14, 200, 195, 200, 96, 200, 200, 122, 200, 190, 173, 200, 172, 11, 141, 200, 200, 200, 200, 23, 200, 147, 15, 93, 200, 46, 200, 158, 200, 143, 102, 200, 200, 200, 200, 200, 90, 200, 46, 200, 117, 200, 199, 200, 200, 147], "policy_agent_policy_reward": [19.692286436139916, 49.21401415122863, 15.72035665331475, 25.3341062487047, 12.693812485638606, 8.930853306808888, 17.679060712291626, -7.40612263724555, 59.30284275421294, 31.28021553581947, -0.7231607956641621, 9.31013745270706, 29.886605311861693, 32.206270415940395, 8.763418283463382, 20.837675711632507, 20.16384826730877, 11.355439510118714, 39.55210852792412, 22.93735232517322, 13.290777211688727, 20.461844152584902, 39.401154832110244, 2.6455151748652197, 15.432653634967902, 25.342881020614673, 11.642772102282567, 26.026235535302064, 29.318525425718768, 21.120438445762787, 37.043373283220205, 19.665928114308443, -9.332638178528114, 22.706179191979004, 11.080113105248452, 22.58903091295201, 47.93796125026076, 25.384758087136987, 12.856915792400851, -24.679027558312555, 18.70758620144185, 34.84392230274467, 11.173714553922752, 10.071612766400433, 24.397849349557085, 5.876766504442511, 13.380144608084528, 25.034377698968072, 28.971339192338398, 21.924530692263076, 15.231474295037223, 49.139678185411874, 13.852282949909018, 49.14168052322903, 19.538813361949266, 21.400978864313878, 62.15595852688589, 20.248169825076264, 6.73057946604812, 24.491633034818776, 53.672721728579575, 5.793010712107684, 18.149057866667764, 71.52865162885612, -9.113025006593144, 44.98866879149816, 51.10442688904883, 5.9954908803834135, 32.93818786994853, 25.813383344201895, 5.739393659609306, 2.2633198398883074, 21.59680588168643, -0.12734382272954736, 50.239370489024225, 51.50140315934887, 6.184970537006006, 34.81318224903495, 39.02050955719102, 21.988722585385503, 39.36062271485924, 7.43299781682941, 10.644895077351938, 44.90067200487826, 20.340815211303898, 10.66790065411566, 38.50037342394873, 17.34582700347622, 33.17139454998051, -3.092573770199375, 19.08999148813214, 33.47167221164729, 7.669828733597719, 23.150932644725753, 7.715018914359165, 36.26896534552111, 28.492906261255584, 44.79200085199804, 50.892228892366205, 28.448806658412174], "policy_adversary_policy_reward": [4.413954146792255, 15.27833228934766, 30.014766014556965, 19.199248136671667, 7.522039831896439, 8.19831682141831, 17.359156201035937, 7.974950047668765, 13.61953229825896, -0.9257198126203505, -4.785168823265554, 13.716022130074442, 8.840064333164428, 8.838996379127199, -18.043959378445358, 10.637836741199802, 43.91408475461883, 15.388757999594123, 14.59268886991217, 16.6875266659073, 10.802222929764206, -11.525383725428359, -7.30385246255867, 16.61398991526573, 25.33294631850026, 4.553658993361427, 17.186113246250635, 15.020157169689767, 1.956030749590294, 6.8073875338730705, 14.438712263879987, 6.3989634477525215, 6.402770283336366, 13.761077983972399, 7.509918881478704, 3.84552062864001, 32.521091331379864, 7.031017196544237, 2.6001251225454567, 20.337227202627755, 11.495163982393223, 1.7956132292955047, 14.28026115850954, 6.181582994075363, 5.6495482029623645, 33.75160662914789, 0.487780209070531, 2.1577349657946883, 8.829866583221367, 6.602787051746493, 12.603223807416377, 12.739657213198296, 11.305224490758963, 0.33754761152360047, 15.687233556534794, 10.339001978767271, 11.54513293559512, 17.773392490123637, 14.552499439244464, 6.567939006518317, 20.21392233661814, 16.829450946602037, -1.7994939269312322, 21.465422041239677, -3.9345718046894653, -5.398066373838649, 36.672680825184415, -13.966501633205421, 0.8286146663286935, 10.251498438919759, 22.237650809167242, 0.35138010378476014, 25.761523427249, 22.176437823011767, 17.48565191284941, 7.899106174287578, 3.2298411561148725, 9.627074636285979, -14.77516413206493, -9.903863426247625, 19.31038419673699, -0.6027979952951377, 11.562567237115825, 23.281355065628837, -0.6618003767642708, 11.835514930687022, 19.005759490514453, -8.934146724114024, 22.81849442319192, 1.5793549263651663, 16.98763494123706, -11.11086843679455, 6.668035451238097, 6.712109156846434, 17.94408318502142, 7.090294513946645, 10.042590900760498, 18.928748291577907, 9.825977046938219, 12.098553645324856, 36.78336573451169, -21.5518914394745, 15.60150598063558, 33.53817220477624, -0.7465098196370477, 14.598792769546066, 32.88758905140595, 16.254091471823088, 10.096151623559095, 9.442661738390168, 11.244420502065825, 10.156558362248049, 37.94931647308241, 24.206642053803463, 2.7503521754661904, 17.497817649610074, -1.1989517185800693, 7.929531184628191, 10.890988641431578, 13.6006443933872, 33.86120865242947, 19.811513076150085, -8.542156496153765, 14.33516720826145, 5.861512547016044, 12.28754531965172, 49.03490119499986, 22.493750433856253, 6.048947215686669, -15.161972222279783, 32.291375581021526, 12.697293210476658, 50.05714982050456, 1.0472770685442647, -2.0304721940213692, 8.025963074404784, 21.399832855686004, 11.538355014262521, 18.80986175516057, 7.0035215890413225, -1.706429128031484, 7.44582278764079, 5.019795422270789, -2.756475582382482, 29.063874317990738, -7.467068436304313, -2.1594169408814317, 2.0320731181518847, 31.27539569022595, 18.963974798798247, 18.89829380963218, 32.60310934971669, 1.5314896138100629, 4.653480923195943, 32.230298273648316, 2.582883975386622, -0.4958781215524972, 39.51638767874353, -5.929819749509079, 27.918542334894592, 13.930588417648643, 25.430034297210607, 4.261392203832946, 3.1716056129964585, 10.552839142900769, 0.09205593445116378, 39.211369948078094, 5.689302056800152, 13.698349427594335, 6.642465783709573, 13.260728600956337, -2.5928279468406767, 21.450525954839552, 17.04984746910918, 3.764804985204183, 13.581022018272035, 20.43868004228635, 12.732714507694155, 0.286807878409193, -3.379381648608579, 4.29203963773293, 14.797951850399208, 17.724902800258313, 15.746769411388975, -19.240522632575978, 26.910351366173696, 16.19634984224884, 6.954582802476908, 5.221969210931228, 2.493049703427939, 26.295678720560275, 9.973286624960846, 5.730569035569189, 22.762337225686395, 32.13948235640667, 12.652518495591387, 29.521663565510757, 21.370565326855466, 18.04029025334036, 10.408516405071815]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38904193167275336, "mean_inference_ms": 0.9651789010275243, "mean_action_processing_ms": 0.1654619917122457, "mean_env_wait_ms": 0.05725230600194793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031718015670776367, "StateBufferConnector_ms": 0.002360224723815918, "ViewRequirementAgentConnector_ms": 0.062447309494018555}, "num_episodes": 26, "episode_return_max": 143.05730325771208, "episode_return_min": -49.35805511662511, "episode_return_mean": 46.1267158125098}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.98162244340085, "num_env_steps_trained_throughput_per_sec": 485.98162244340085, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 732000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 8437.89, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8437.855, "sample_time_ms": 741.614, "learn_time_ms": 7684.069, "learn_throughput": 520.558, "synch_weights_time_ms": 11.535}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "training_iteration": 61, "trial_id": "eaa30_00000", "date": "2024-08-09_17-48-35", "timestamp": 1723240115, "time_this_iter_s": 8.23670506477356, "time_total_s": 503.50417137145996, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2888dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 503.50417137145996, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 22.675, "ram_util_percent": 81.28333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8826143482690134, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.149000994616715, "policy_loss": 0.002093210650075759, "vf_loss": 6.13954178694064, "vf_explained_var": -0.016202666614421463, "kl": 0.018167189968424657, "entropy": 1.4677663267604888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.632804840399573, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.644102065761884, "policy_loss": 0.0003455525535779695, "vf_loss": 7.642683850228787, "vf_explained_var": -0.02121354149033626, "kl": 0.016722499495760226, "entropy": 0.6099100785329938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "env_runners": {"episode_reward_max": 143.05730325771208, "episode_reward_min": -49.35805511662511, "episode_reward_mean": 46.33252410403056, "episode_len_mean": 162.13, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 16213, "policy_reward_min": {"agent_policy": -24.679027558312555, "adversary_policy": -21.5518914394745}, "policy_reward_max": {"agent_policy": 71.52865162885612, "adversary_policy": 50.05714982050456}, "policy_reward_mean": {"agent_policy": 23.16626205201528, "adversary_policy": 11.58313102600764}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.285544204565134, 52.05247107060413, 58.63705085143751, 42.24087689152552, 74.08674656644055, 39.331856228616886, -18.665276357056236, 45.41235838395801, 22.160226210496894, 45.17806182590404, 95.87592250052158, 50.769516174273974, 25.713831584801696, -49.35805511662511, 37.4151724028837, 69.68784460548935, 22.347429107845564, 20.143225532800848, 48.79569869911417, 11.753533008885022, 26.760289216169056, 50.068755397936144, 57.94267838467677, 43.84906138452611, 30.46294859007444, 98.27935637082368, 27.704565899818036, 98.28336104645808, 39.07762672389852, 42.801957728627656, 124.31191705377185, 40.49633965015252, 13.461158932096232, 48.98326606963755, 107.34544345715926, 11.586021424215367, 36.29811573333555, 143.05730325771208, -18.22605001318634, 89.97733758299623, 102.20885377809775, 11.990981760766829, 65.876375739897, 51.62676668840374, 11.478787319218611, 4.526639679776601, 43.19361176337284, -0.25468764545909295, 100.47874097804842, 103.00280631869774, 12.369941074012013, 69.6263644980699, 78.04101911438202, 43.97744517077101, 78.72124542971851, 14.865995633658791, 21.289790154703866, 89.8013440097564, 40.68163042260779, 21.33580130823133, 77.00074684789743, 34.69165400695246, 66.34278909996107, -6.185147540398821, 38.17998297626427, 66.94334442329459, 15.33965746719544, 46.301865289451456, 15.430037828718321, 72.53793069104228, 56.985812522511154, 89.58400170399614, 101.78445778473247, 56.897613316824305, 61.95582248848913, 21.61414740713255, 29.41186560806841, 11.364641765799234, 71.57180162897822, 69.96214202097988, -9.684765239525444, -10.236950503117306, 22.276904961298598, 36.91302769052158, 44.31282080819391, 46.936767395410925, 39.99657911909735, 75.89505845932504, 66.79965522580191, 75.05500668734753, 38.81068800386029, 58.104134103667434, 30.478949176901658, 141.8096264896672, 111.17323047638324, 44.88801868938907, 5.81884614888806, -9.976172825394777, 4.8147387700882724, 27.126137963247743], "episode_lengths": [116, 200, 200, 200, 200, 200, 200, 58, 118, 56, 145, 200, 200, 200, 103, 200, 186, 200, 200, 200, 200, 200, 192, 200, 200, 200, 200, 200, 14, 200, 195, 200, 96, 200, 200, 122, 200, 190, 173, 200, 172, 11, 141, 200, 200, 200, 200, 23, 200, 147, 15, 93, 200, 46, 200, 158, 200, 143, 102, 200, 200, 200, 200, 200, 90, 200, 46, 200, 117, 200, 199, 200, 200, 147, 200, 113, 200, 45, 200, 200, 13, 200, 200, 200, 200, 200, 200, 32, 200, 200, 200, 175, 97, 109, 179, 200, 28, 200, 8, 200], "policy_agent_policy_reward": [11.642772102282567, 26.026235535302064, 29.318525425718768, 21.120438445762787, 37.043373283220205, 19.665928114308443, -9.332638178528114, 22.706179191979004, 11.080113105248452, 22.58903091295201, 47.93796125026076, 25.384758087136987, 12.856915792400851, -24.679027558312555, 18.70758620144185, 34.84392230274467, 11.173714553922752, 10.071612766400433, 24.397849349557085, 5.876766504442511, 13.380144608084528, 25.034377698968072, 28.971339192338398, 21.924530692263076, 15.231474295037223, 49.139678185411874, 13.852282949909018, 49.14168052322903, 19.538813361949266, 21.400978864313878, 62.15595852688589, 20.248169825076264, 6.73057946604812, 24.491633034818776, 53.672721728579575, 5.793010712107684, 18.149057866667764, 71.52865162885612, -9.113025006593144, 44.98866879149816, 51.10442688904883, 5.9954908803834135, 32.93818786994853, 25.813383344201895, 5.739393659609306, 2.2633198398883074, 21.59680588168643, -0.12734382272954736, 50.239370489024225, 51.50140315934887, 6.184970537006006, 34.81318224903495, 39.02050955719102, 21.988722585385503, 39.36062271485924, 7.43299781682941, 10.644895077351938, 44.90067200487826, 20.340815211303898, 10.66790065411566, 38.50037342394873, 17.34582700347622, 33.17139454998051, -3.092573770199375, 19.08999148813214, 33.47167221164729, 7.669828733597719, 23.150932644725753, 7.715018914359165, 36.26896534552111, 28.492906261255584, 44.79200085199804, 50.892228892366205, 28.448806658412174, 30.977911244244577, 10.807073703566282, 14.705932804034198, 5.6823208828996155, 35.78590081448912, 34.98107101048994, -4.842382619762722, -5.1184752515586505, 11.138452480649299, 18.456513845260783, 22.15641040409695, 23.46838369770546, 19.998289559548674, 37.94752922966249, 33.39982761290099, 37.52750334367376, 19.405344001930164, 29.052067051833713, 15.239474588450824, 70.90481324483365, 55.58661523819161, 22.444009344694514, 2.90942307444403, -4.988086412697394, 2.4073693850441362, 13.563068981623871], "policy_adversary_policy_reward": [11.305224490758963, 0.33754761152360047, 15.687233556534794, 10.339001978767271, 11.54513293559512, 17.773392490123637, 14.552499439244464, 6.567939006518317, 20.21392233661814, 16.829450946602037, -1.7994939269312322, 21.465422041239677, -3.9345718046894653, -5.398066373838649, 36.672680825184415, -13.966501633205421, 0.8286146663286935, 10.251498438919759, 22.237650809167242, 0.35138010378476014, 25.761523427249, 22.176437823011767, 17.48565191284941, 7.899106174287578, 3.2298411561148725, 9.627074636285979, -14.77516413206493, -9.903863426247625, 19.31038419673699, -0.6027979952951377, 11.562567237115825, 23.281355065628837, -0.6618003767642708, 11.835514930687022, 19.005759490514453, -8.934146724114024, 22.81849442319192, 1.5793549263651663, 16.98763494123706, -11.11086843679455, 6.668035451238097, 6.712109156846434, 17.94408318502142, 7.090294513946645, 10.042590900760498, 18.928748291577907, 9.825977046938219, 12.098553645324856, 36.78336573451169, -21.5518914394745, 15.60150598063558, 33.53817220477624, -0.7465098196370477, 14.598792769546066, 32.88758905140595, 16.254091471823088, 10.096151623559095, 9.442661738390168, 11.244420502065825, 10.156558362248049, 37.94931647308241, 24.206642053803463, 2.7503521754661904, 17.497817649610074, -1.1989517185800693, 7.929531184628191, 10.890988641431578, 13.6006443933872, 33.86120865242947, 19.811513076150085, -8.542156496153765, 14.33516720826145, 5.861512547016044, 12.28754531965172, 49.03490119499986, 22.493750433856253, 6.048947215686669, -15.161972222279783, 32.291375581021526, 12.697293210476658, 50.05714982050456, 1.0472770685442647, -2.0304721940213692, 8.025963074404784, 21.399832855686004, 11.538355014262521, 18.80986175516057, 7.0035215890413225, -1.706429128031484, 7.44582278764079, 5.019795422270789, -2.756475582382482, 29.063874317990738, -7.467068436304313, -2.1594169408814317, 2.0320731181518847, 31.27539569022595, 18.963974798798247, 18.89829380963218, 32.60310934971669, 1.5314896138100629, 4.653480923195943, 32.230298273648316, 2.582883975386622, -0.4958781215524972, 39.51638767874353, -5.929819749509079, 27.918542334894592, 13.930588417648643, 25.430034297210607, 4.261392203832946, 3.1716056129964585, 10.552839142900769, 0.09205593445116378, 39.211369948078094, 5.689302056800152, 13.698349427594335, 6.642465783709573, 13.260728600956337, -2.5928279468406767, 21.450525954839552, 17.04984746910918, 3.764804985204183, 13.581022018272035, 20.43868004228635, 12.732714507694155, 0.286807878409193, -3.379381648608579, 4.29203963773293, 14.797951850399208, 17.724902800258313, 15.746769411388975, -19.240522632575978, 26.910351366173696, 16.19634984224884, 6.954582802476908, 5.221969210931228, 2.493049703427939, 26.295678720560275, 9.973286624960846, 5.730569035569189, 22.762337225686395, 32.13948235640667, 12.652518495591387, 29.521663565510757, 21.370565326855466, 18.04029025334036, 10.408516405071815, 23.247150426858745, 7.730760817385818, 1.5986668771251225, 9.208406826441157, 5.004748499911546, 9.701184304122652, 2.535088987082702, 3.1472318958169136, 22.18020881815879, 13.605691996330332, 11.428380668496674, 23.552690341993255, -12.93097558716364, 8.088592967400919, -11.890220702229765, 6.77174545067111, 7.554689968068061, 3.583762512581238, 11.647457674536852, 6.809056170723927, 2.6640769636024473, 19.49233344049451, 7.708856848586549, 15.75952684911891, 17.198158438917922, 2.800131120630761, 23.18243135784994, 14.765097871812571, 25.825619031607623, 7.5742085812933375, 13.52803993973199, 23.999463403941743, 11.099675799689003, 8.305668202241161, 22.029431900700285, 7.022635151133429, 8.348129984407167, 6.89134460404366, 37.88375720389107, 33.021056040942604, 26.461950724197383, 29.124664513994226, 3.340521997009585, 19.10348734768493, -11.399171575788287, 14.308594650232319, -2.20133958705496, -2.786746825642431, 2.0192613981503573, 0.3881079868937789, 2.315413945148407, 11.247655036475464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38890065618766206, "mean_inference_ms": 0.9651142071569937, "mean_action_processing_ms": 0.1653243786857031, "mean_env_wait_ms": 0.05713782880299397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032845735549926758, "StateBufferConnector_ms": 0.0023986101150512695, "ViewRequirementAgentConnector_ms": 0.06355071067810059}, "num_episodes": 26, "episode_return_max": 143.05730325771208, "episode_return_min": -49.35805511662511, "episode_return_mean": 46.33252410403056}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.0534587182956, "num_env_steps_trained_throughput_per_sec": 496.0534587182956, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 8399.894, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8399.859, "sample_time_ms": 740.182, "learn_time_ms": 7647.448, "learn_throughput": 523.05, "synch_weights_time_ms": 11.59}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "training_iteration": 62, "trial_id": "eaa30_00000", "date": "2024-08-09_17-48-43", "timestamp": 1723240123, "time_this_iter_s": 8.068960905075073, "time_total_s": 511.57313227653503, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbfc1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 511.57313227653503, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 22.024999999999995, "ram_util_percent": 81.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.97557317668168, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.540999493523249, "policy_loss": -0.0057141487157741, "vf_loss": 6.540105607017638, "vf_explained_var": -0.1602036750505841, "kl": 0.016297781969563514, "entropy": 1.439808090843221, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.83147878870368, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.89682096093893, "policy_loss": 0.0018571885681012644, "vf_loss": 7.893065599103768, "vf_explained_var": -0.002467581008871396, "kl": 0.02959240508886675, "entropy": 0.7278231979658206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "env_runners": {"episode_reward_max": 173.28662488649275, "episode_reward_min": -18.22605001318634, "episode_reward_mean": 52.17530519547491, "episode_len_mean": 155.43, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 15543, "policy_reward_min": {"agent_policy": -9.113025006593144, "adversary_policy": -19.240522632575978}, "policy_reward_max": {"agent_policy": 86.64331244324644, "adversary_policy": 50.05714982050456}, "policy_reward_mean": {"agent_policy": 26.08765259773746, "adversary_policy": 13.04382629886873}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.704565899818036, 98.28336104645808, 39.07762672389852, 42.801957728627656, 124.31191705377185, 40.49633965015252, 13.461158932096232, 48.98326606963755, 107.34544345715926, 11.586021424215367, 36.29811573333555, 143.05730325771208, -18.22605001318634, 89.97733758299623, 102.20885377809775, 11.990981760766829, 65.876375739897, 51.62676668840374, 11.478787319218611, 4.526639679776601, 43.19361176337284, -0.25468764545909295, 100.47874097804842, 103.00280631869774, 12.369941074012013, 69.6263644980699, 78.04101911438202, 43.97744517077101, 78.72124542971851, 14.865995633658791, 21.289790154703866, 89.8013440097564, 40.68163042260779, 21.33580130823133, 77.00074684789743, 34.69165400695246, 66.34278909996107, -6.185147540398821, 38.17998297626427, 66.94334442329459, 15.33965746719544, 46.301865289451456, 15.430037828718321, 72.53793069104228, 56.985812522511154, 89.58400170399614, 101.78445778473247, 56.897613316824305, 61.95582248848913, 21.61414740713255, 29.41186560806841, 11.364641765799234, 71.57180162897822, 69.96214202097988, -9.684765239525444, -10.236950503117306, 22.276904961298598, 36.91302769052158, 44.31282080819391, 46.936767395410925, 39.99657911909735, 75.89505845932504, 66.79965522580191, 75.05500668734753, 38.81068800386029, 58.104134103667434, 30.478949176901658, 141.8096264896672, 111.17323047638324, 44.88801868938907, 5.81884614888806, -9.976172825394777, 4.8147387700882724, 27.126137963247743, 34.128365888796246, -1.2201194792688526, 60.02984229450094, -4.75016973593771, -2.1017970925938414, 114.89531771752486, 70.8193820082601, 98.49151935688235, 156.72351092956947, 59.86265593007674, 51.656841522064916, 145.76372373121276, 35.7922758096167, 53.3785696743856, 173.28662488649275, 12.707655856506406, 18.054362457169667, 49.072783304389816, 83.17235760191514, 84.07411221608493, 6.761175205759946, 143.16134884502844, 65.83868779699998, 25.174858148248, 29.861347912031526, 43.8700000794076], "episode_lengths": [200, 200, 14, 200, 195, 200, 96, 200, 200, 122, 200, 190, 173, 200, 172, 11, 141, 200, 200, 200, 200, 23, 200, 147, 15, 93, 200, 46, 200, 158, 200, 143, 102, 200, 200, 200, 200, 200, 90, 200, 46, 200, 117, 200, 199, 200, 200, 147, 200, 113, 200, 45, 200, 200, 13, 200, 200, 200, 200, 200, 200, 32, 200, 200, 200, 175, 97, 109, 179, 200, 28, 200, 8, 200, 108, 200, 200, 200, 200, 160, 200, 72, 200, 162, 49, 200, 85, 140, 200, 50, 36, 200, 163, 161, 14, 200, 200, 200, 200, 104], "policy_agent_policy_reward": [13.852282949909018, 49.14168052322903, 19.538813361949266, 21.400978864313878, 62.15595852688589, 20.248169825076264, 6.73057946604812, 24.491633034818776, 53.672721728579575, 5.793010712107684, 18.149057866667764, 71.52865162885612, -9.113025006593144, 44.98866879149816, 51.10442688904883, 5.9954908803834135, 32.93818786994853, 25.813383344201895, 5.739393659609306, 2.2633198398883074, 21.59680588168643, -0.12734382272954736, 50.239370489024225, 51.50140315934887, 6.184970537006006, 34.81318224903495, 39.02050955719102, 21.988722585385503, 39.36062271485924, 7.43299781682941, 10.644895077351938, 44.90067200487826, 20.340815211303898, 10.66790065411566, 38.50037342394873, 17.34582700347622, 33.17139454998051, -3.092573770199375, 19.08999148813214, 33.47167221164729, 7.669828733597719, 23.150932644725753, 7.715018914359165, 36.26896534552111, 28.492906261255584, 44.79200085199804, 50.892228892366205, 28.448806658412174, 30.977911244244577, 10.807073703566282, 14.705932804034198, 5.6823208828996155, 35.78590081448912, 34.98107101048994, -4.842382619762722, -5.1184752515586505, 11.138452480649299, 18.456513845260783, 22.15641040409695, 23.46838369770546, 19.998289559548674, 37.94752922966249, 33.39982761290099, 37.52750334367376, 19.405344001930164, 29.052067051833713, 15.239474588450824, 70.90481324483365, 55.58661523819161, 22.444009344694514, 2.90942307444403, -4.988086412697394, 2.4073693850441362, 13.563068981623871, 17.064182944398134, -0.6100597396344263, 30.014921147250455, -2.3750848679688534, -1.0508985462969136, 57.44765885876243, 35.409691004130046, 49.2457596784412, 78.36175546478475, 29.93132796503836, 25.828420761032465, 72.8818618656064, 17.896137904808338, 26.6892848371928, 86.64331244324644, 6.353827928253207, 9.02718122858483, 24.5363916521949, 41.58617880095757, 42.037056108042435, 3.380587602879973, 71.58067442251419, 32.91934389849999, 12.58742907412398, 14.930673956015749, 21.935000039703798], "policy_adversary_policy_reward": [-0.7465098196370477, 14.598792769546066, 32.88758905140595, 16.254091471823088, 10.096151623559095, 9.442661738390168, 11.244420502065825, 10.156558362248049, 37.94931647308241, 24.206642053803463, 2.7503521754661904, 17.497817649610074, -1.1989517185800693, 7.929531184628191, 10.890988641431578, 13.6006443933872, 33.86120865242947, 19.811513076150085, -8.542156496153765, 14.33516720826145, 5.861512547016044, 12.28754531965172, 49.03490119499986, 22.493750433856253, 6.048947215686669, -15.161972222279783, 32.291375581021526, 12.697293210476658, 50.05714982050456, 1.0472770685442647, -2.0304721940213692, 8.025963074404784, 21.399832855686004, 11.538355014262521, 18.80986175516057, 7.0035215890413225, -1.706429128031484, 7.44582278764079, 5.019795422270789, -2.756475582382482, 29.063874317990738, -7.467068436304313, -2.1594169408814317, 2.0320731181518847, 31.27539569022595, 18.963974798798247, 18.89829380963218, 32.60310934971669, 1.5314896138100629, 4.653480923195943, 32.230298273648316, 2.582883975386622, -0.4958781215524972, 39.51638767874353, -5.929819749509079, 27.918542334894592, 13.930588417648643, 25.430034297210607, 4.261392203832946, 3.1716056129964585, 10.552839142900769, 0.09205593445116378, 39.211369948078094, 5.689302056800152, 13.698349427594335, 6.642465783709573, 13.260728600956337, -2.5928279468406767, 21.450525954839552, 17.04984746910918, 3.764804985204183, 13.581022018272035, 20.43868004228635, 12.732714507694155, 0.286807878409193, -3.379381648608579, 4.29203963773293, 14.797951850399208, 17.724902800258313, 15.746769411388975, -19.240522632575978, 26.910351366173696, 16.19634984224884, 6.954582802476908, 5.221969210931228, 2.493049703427939, 26.295678720560275, 9.973286624960846, 5.730569035569189, 22.762337225686395, 32.13948235640667, 12.652518495591387, 29.521663565510757, 21.370565326855466, 18.04029025334036, 10.408516405071815, 23.247150426858745, 7.730760817385818, 1.5986668771251225, 9.208406826441157, 5.004748499911546, 9.701184304122652, 2.535088987082702, 3.1472318958169136, 22.18020881815879, 13.605691996330332, 11.428380668496674, 23.552690341993255, -12.93097558716364, 8.088592967400919, -11.890220702229765, 6.77174545067111, 7.554689968068061, 3.583762512581238, 11.647457674536852, 6.809056170723927, 2.6640769636024473, 19.49233344049451, 7.708856848586549, 15.75952684911891, 17.198158438917922, 2.800131120630761, 23.18243135784994, 14.765097871812571, 25.825619031607623, 7.5742085812933375, 13.52803993973199, 23.999463403941743, 11.099675799689003, 8.305668202241161, 22.029431900700285, 7.022635151133429, 8.348129984407167, 6.89134460404366, 37.88375720389107, 33.021056040942604, 26.461950724197383, 29.124664513994226, 3.340521997009585, 19.10348734768493, -11.399171575788287, 14.308594650232319, -2.20133958705496, -2.786746825642431, 2.0192613981503573, 0.3881079868937789, 2.315413945148407, 11.247655036475464, 4.46047179691103, 12.603711147487104, 2.008536959961674, -2.6185966995961003, 23.27559369797421, 6.739327449276242, 11.11613312793996, -13.491217995908812, 4.790712025159213, -5.84161057145613, 23.998561613103725, 33.449097245658706, 15.143795183480425, 20.265895820649625, 15.714316616663824, 33.53144306177738, 31.915863946572884, 46.44589151821184, 1.0560592420925872, 28.875268722945773, 19.43548746767266, 6.392933293359803, 29.281823743773273, 43.60003812183313, 22.018459126723172, -4.122321221914829, 16.452721934036866, 10.236562903155933, 43.72328959845832, 42.920022844788114, 12.072184423798134, -5.718356495544928, -15.512540098302976, 24.539721326887808, 16.17696844071436, 8.359423211480545, 35.0336262033112, 6.552552597646365, 24.094121838782673, 17.942934269259766, -6.454256911127495, 9.834844514007468, 33.48425857034346, 38.09641585217073, 30.269632640983065, 2.649711257516909, 6.852327540001911, 5.735101534122077, 16.592533928019765, -1.661859972004013, 2.8335546305655797, 19.10144540913822]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38853630946487, "mean_inference_ms": 0.9643274078939197, "mean_action_processing_ms": 0.16517824986506924, "mean_env_wait_ms": 0.05706830811105343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032416582107543945, "StateBufferConnector_ms": 0.002378702163696289, "ViewRequirementAgentConnector_ms": 0.06326556205749512}, "num_episodes": 26, "episode_return_max": 173.28662488649275, "episode_return_min": -18.22605001318634, "episode_return_mean": 52.17530519547491}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.50089314929863, "num_env_steps_trained_throughput_per_sec": 487.50089314929863, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 756000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 8359.16, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8359.125, "sample_time_ms": 741.21, "learn_time_ms": 7605.838, "learn_throughput": 525.912, "synch_weights_time_ms": 11.447}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "training_iteration": 63, "trial_id": "eaa30_00000", "date": "2024-08-09_17-48-51", "timestamp": 1723240131, "time_this_iter_s": 8.210585117340088, "time_total_s": 519.7837173938751, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbfc430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 519.7837173938751, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 23.018181818181816, "ram_util_percent": 80.78181818181817}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7211129355682897, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.733626421671065, "policy_loss": -0.0007685524852522625, "vf_loss": 6.729915149880465, "vf_explained_var": -0.214204818893362, "kl": 0.011048771311139698, "entropy": 1.3988781343692194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6120777668741844, "cur_kl_coeff": 0.09621691927313807, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.028926585117976, "policy_loss": 0.03369500613577354, "vf_loss": 7.989792108039061, "vf_explained_var": -0.004970601387321949, "kl": 0.05653307093889452, "entropy": 0.7075707105298837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 176.72049746310395, "episode_reward_min": -10.236950503117306, "episode_reward_mean": 56.79446542621577, "episode_len_mean": 150.24, "episode_media": {}, "episodes_this_iter": 29, "episodes_timesteps_total": 15024, "policy_reward_min": {"agent_policy": -5.1184752515586505, "adversary_policy": -19.240522632575978}, "policy_reward_max": {"agent_policy": 88.36024873155209, "adversary_policy": 47.21600765708064}, "policy_reward_mean": {"agent_policy": 28.397232713107886, "adversary_policy": 14.198616356553943}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.865995633658791, 21.289790154703866, 89.8013440097564, 40.68163042260779, 21.33580130823133, 77.00074684789743, 34.69165400695246, 66.34278909996107, -6.185147540398821, 38.17998297626427, 66.94334442329459, 15.33965746719544, 46.301865289451456, 15.430037828718321, 72.53793069104228, 56.985812522511154, 89.58400170399614, 101.78445778473247, 56.897613316824305, 61.95582248848913, 21.61414740713255, 29.41186560806841, 11.364641765799234, 71.57180162897822, 69.96214202097988, -9.684765239525444, -10.236950503117306, 22.276904961298598, 36.91302769052158, 44.31282080819391, 46.936767395410925, 39.99657911909735, 75.89505845932504, 66.79965522580191, 75.05500668734753, 38.81068800386029, 58.104134103667434, 30.478949176901658, 141.8096264896672, 111.17323047638324, 44.88801868938907, 5.81884614888806, -9.976172825394777, 4.8147387700882724, 27.126137963247743, 34.128365888796246, -1.2201194792688526, 60.02984229450094, -4.75016973593771, -2.1017970925938414, 114.89531771752486, 70.8193820082601, 98.49151935688235, 156.72351092956947, 59.86265593007674, 51.656841522064916, 145.76372373121276, 35.7922758096167, 53.3785696743856, 173.28662488649275, 12.707655856506406, 18.054362457169667, 49.072783304389816, 83.17235760191514, 84.07411221608493, 6.761175205759946, 143.16134884502844, 65.83868779699998, 25.174858148248, 29.861347912031526, 43.8700000794076, 107.08415886556514, 46.493054194212746, 93.64081474244145, 44.281574170023504, 141.7222250163014, 12.727452063455635, 34.222762421745315, 19.674886082734215, 50.835943713730316, 57.38282524753999, 176.72049746310395, 100.68090236507891, 92.54413869554372, 4.312129122016627, 97.83003314369324, 30.296952607689875, 89.18502489154514, 84.78311507008468, 43.251147599718394, 141.68502864049893, 6.447440745280414, 115.09861592034595, 99.71165873767043, 53.414680424973824, 71.9675566984982, 44.66776200451355, 51.27186494023135, 23.049727696964048, 108.95530600335162], "episode_lengths": [158, 200, 143, 102, 200, 200, 200, 200, 200, 90, 200, 46, 200, 117, 200, 199, 200, 200, 147, 200, 113, 200, 45, 200, 200, 13, 200, 200, 200, 200, 200, 200, 32, 200, 200, 200, 175, 97, 109, 179, 200, 28, 200, 8, 200, 108, 200, 200, 200, 200, 160, 200, 72, 200, 162, 49, 200, 85, 140, 200, 50, 36, 200, 163, 161, 14, 200, 200, 200, 200, 104, 173, 184, 85, 200, 56, 93, 200, 35, 78, 88, 161, 200, 90, 7, 200, 133, 183, 180, 71, 200, 200, 154, 200, 200, 200, 78, 66, 80, 124], "policy_agent_policy_reward": [7.43299781682941, 10.644895077351938, 44.90067200487826, 20.340815211303898, 10.66790065411566, 38.50037342394873, 17.34582700347622, 33.17139454998051, -3.092573770199375, 19.08999148813214, 33.47167221164729, 7.669828733597719, 23.150932644725753, 7.715018914359165, 36.26896534552111, 28.492906261255584, 44.79200085199804, 50.892228892366205, 28.448806658412174, 30.977911244244577, 10.807073703566282, 14.705932804034198, 5.6823208828996155, 35.78590081448912, 34.98107101048994, -4.842382619762722, -5.1184752515586505, 11.138452480649299, 18.456513845260783, 22.15641040409695, 23.46838369770546, 19.998289559548674, 37.94752922966249, 33.39982761290099, 37.52750334367376, 19.405344001930164, 29.052067051833713, 15.239474588450824, 70.90481324483365, 55.58661523819161, 22.444009344694514, 2.90942307444403, -4.988086412697394, 2.4073693850441362, 13.563068981623871, 17.064182944398134, -0.6100597396344263, 30.014921147250455, -2.3750848679688534, -1.0508985462969136, 57.44765885876243, 35.409691004130046, 49.2457596784412, 78.36175546478475, 29.93132796503836, 25.828420761032465, 72.8818618656064, 17.896137904808338, 26.6892848371928, 86.64331244324644, 6.353827928253207, 9.02718122858483, 24.5363916521949, 41.58617880095757, 42.037056108042435, 3.380587602879973, 71.58067442251419, 32.91934389849999, 12.58742907412398, 14.930673956015749, 21.935000039703798, 53.542079432782586, 23.246527097106387, 46.82040737122075, 22.140787085011745, 70.86111250815071, 6.36372603172781, 17.111381210872636, 9.837443041367107, 25.417971856865154, 28.691412623769992, 88.36024873155209, 50.34045118253944, 46.272069347771804, 2.156064561008314, 48.91501657184662, 15.148476303844939, 44.59251244577257, 42.39155753504235, 21.625573799859204, 70.84251432024942, 3.2237203726402086, 57.54930796017297, 49.85582936883519, 26.70734021248693, 35.9837783492491, 22.33388100225677, 25.635932470115684, 11.524863848482026, 54.47765300167579], "policy_adversary_policy_reward": [4.261392203832946, 3.1716056129964585, 10.552839142900769, 0.09205593445116378, 39.211369948078094, 5.689302056800152, 13.698349427594335, 6.642465783709573, 13.260728600956337, -2.5928279468406767, 21.450525954839552, 17.04984746910918, 3.764804985204183, 13.581022018272035, 20.43868004228635, 12.732714507694155, 0.286807878409193, -3.379381648608579, 4.29203963773293, 14.797951850399208, 17.724902800258313, 15.746769411388975, -19.240522632575978, 26.910351366173696, 16.19634984224884, 6.954582802476908, 5.221969210931228, 2.493049703427939, 26.295678720560275, 9.973286624960846, 5.730569035569189, 22.762337225686395, 32.13948235640667, 12.652518495591387, 29.521663565510757, 21.370565326855466, 18.04029025334036, 10.408516405071815, 23.247150426858745, 7.730760817385818, 1.5986668771251225, 9.208406826441157, 5.004748499911546, 9.701184304122652, 2.535088987082702, 3.1472318958169136, 22.18020881815879, 13.605691996330332, 11.428380668496674, 23.552690341993255, -12.93097558716364, 8.088592967400919, -11.890220702229765, 6.77174545067111, 7.554689968068061, 3.583762512581238, 11.647457674536852, 6.809056170723927, 2.6640769636024473, 19.49233344049451, 7.708856848586549, 15.75952684911891, 17.198158438917922, 2.800131120630761, 23.18243135784994, 14.765097871812571, 25.825619031607623, 7.5742085812933375, 13.52803993973199, 23.999463403941743, 11.099675799689003, 8.305668202241161, 22.029431900700285, 7.022635151133429, 8.348129984407167, 6.89134460404366, 37.88375720389107, 33.021056040942604, 26.461950724197383, 29.124664513994226, 3.340521997009585, 19.10348734768493, -11.399171575788287, 14.308594650232319, -2.20133958705496, -2.786746825642431, 2.0192613981503573, 0.3881079868937789, 2.315413945148407, 11.247655036475464, 4.46047179691103, 12.603711147487104, 2.008536959961674, -2.6185966995961003, 23.27559369797421, 6.739327449276242, 11.11613312793996, -13.491217995908812, 4.790712025159213, -5.84161057145613, 23.998561613103725, 33.449097245658706, 15.143795183480425, 20.265895820649625, 15.714316616663824, 33.53144306177738, 31.915863946572884, 46.44589151821184, 1.0560592420925872, 28.875268722945773, 19.43548746767266, 6.392933293359803, 29.281823743773273, 43.60003812183313, 22.018459126723172, -4.122321221914829, 16.452721934036866, 10.236562903155933, 43.72328959845832, 42.920022844788114, 12.072184423798134, -5.718356495544928, -15.512540098302976, 24.539721326887808, 16.17696844071436, 8.359423211480545, 35.0336262033112, 6.552552597646365, 24.094121838782673, 17.942934269259766, -6.454256911127495, 9.834844514007468, 33.48425857034346, 38.09641585217073, 30.269632640983065, 2.649711257516909, 6.852327540001911, 5.735101534122077, 16.592533928019765, -1.661859972004013, 2.8335546305655797, 19.10144540913822, 23.16602197407228, 30.3760574587103, 1.5766925238361331, 21.66983457327025, 23.901234480944943, 22.9191728902758, 16.396987477563822, 5.7437996074479205, 37.17731427155548, 33.68379823659523, 17.395749859442017, -11.032023827714207, 16.34897530851977, 0.7624059023528709, 12.080307778957248, -2.242864737590139, 13.404496324278334, 12.01347553258682, 15.182318459839106, 13.509094163930886, 47.21600765708064, 41.1442410744714, 25.397226204541134, 24.943224977998295, 29.59799220755971, 16.67407714021212, 3.1511311769931893, -0.9950666159848756, 26.224540507813913, 22.6904760640327, 19.94878281353612, -4.800306509691179, 32.07802976049733, 12.51448268527525, 26.503245931514876, 15.888311603527487, 25.990630005168995, -4.365056205309779, 37.50269398288026, 33.339820337369154, 0.032853405297744054, 3.1908669673424654, 37.057408944965815, 20.491899015207174, 26.365819507440964, 23.490009861394228, 12.691367712910942, 14.015972499575984, 20.94071610317114, 15.043062246077955, 9.64572178409384, 12.688159218162927, 10.731264121980473, 14.90466834813521, 26.626403538490216, -15.101539690008199, 9.259613987687105, 45.218039013988694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3885189804008277, "mean_inference_ms": 0.9633295047388927, "mean_action_processing_ms": 0.1652043191292083, "mean_env_wait_ms": 0.05709460946798454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003664851188659668, "StateBufferConnector_ms": 0.0025593042373657227, "ViewRequirementAgentConnector_ms": 0.06830453872680664}, "num_episodes": 29, "episode_return_max": 176.72049746310395, "episode_return_min": -10.236950503117306, "episode_return_mean": 56.79446542621577}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.2549861651294, "num_env_steps_trained_throughput_per_sec": 491.2549861651294, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 8277.335, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8277.3, "sample_time_ms": 750.526, "learn_time_ms": 7514.772, "learn_throughput": 532.285, "synch_weights_time_ms": 11.412}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 64, "trial_id": "eaa30_00000", "date": "2024-08-09_17-49-00", "timestamp": 1723240140, "time_this_iter_s": 8.147790908813477, "time_total_s": 527.9315083026886, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbfc670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 527.9315083026886, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 24.341666666666665, "ram_util_percent": 79.30833333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.013453275848318, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.2361784311829425, "policy_loss": 0.00039322314187687223, "vf_loss": 7.231969096673229, "vf_explained_var": 0.03540386639574848, "kl": 0.009411921988798196, "entropy": 1.3925034955695823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.420563340218117, "cur_kl_coeff": 0.14432537890970704, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.550411978363991, "policy_loss": 0.022900531302487554, "vf_loss": 8.52214442739884, "vf_explained_var": 0.007304991222918033, "kl": 0.037187258148333055, "entropy": 0.6796286271264156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "env_runners": {"episode_reward_max": 176.72049746310395, "episode_reward_min": -9.976172825394777, "episode_reward_mean": 70.96960538934209, "episode_len_mean": 145.77, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 14577, "policy_reward_min": {"agent_policy": -4.988086412697394, "adversary_policy": -18.680073044422617}, "policy_reward_max": {"agent_policy": 88.36024873155209, "adversary_policy": 48.78081281300088}, "policy_reward_mean": {"agent_policy": 35.48480269467105, "adversary_policy": 17.742401347335523}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.276904961298598, 36.91302769052158, 44.31282080819391, 46.936767395410925, 39.99657911909735, 75.89505845932504, 66.79965522580191, 75.05500668734753, 38.81068800386029, 58.104134103667434, 30.478949176901658, 141.8096264896672, 111.17323047638324, 44.88801868938907, 5.81884614888806, -9.976172825394777, 4.8147387700882724, 27.126137963247743, 34.128365888796246, -1.2201194792688526, 60.02984229450094, -4.75016973593771, -2.1017970925938414, 114.89531771752486, 70.8193820082601, 98.49151935688235, 156.72351092956947, 59.86265593007674, 51.656841522064916, 145.76372373121276, 35.7922758096167, 53.3785696743856, 173.28662488649275, 12.707655856506406, 18.054362457169667, 49.072783304389816, 83.17235760191514, 84.07411221608493, 6.761175205759946, 143.16134884502844, 65.83868779699998, 25.174858148248, 29.861347912031526, 43.8700000794076, 107.08415886556514, 46.493054194212746, 93.64081474244145, 44.281574170023504, 141.7222250163014, 12.727452063455635, 34.222762421745315, 19.674886082734215, 50.835943713730316, 57.38282524753999, 176.72049746310395, 100.68090236507891, 92.54413869554372, 4.312129122016627, 97.83003314369324, 30.296952607689875, 89.18502489154514, 84.78311507008468, 43.251147599718394, 141.68502864049893, 6.447440745280414, 115.09861592034595, 99.71165873767043, 53.414680424973824, 71.9675566984982, 44.66776200451355, 51.27186494023135, 23.049727696964048, 108.95530600335162, 17.51610201083825, 7.584234441722806, 57.14921155404771, 80.01691441390066, 78.28645234377986, 98.13492124456167, 171.22113228304255, 77.55423267443086, 97.60500226217889, 102.24350395967511, 91.41765268738001, 85.86196790853532, 102.1653864825525, 91.79384476738869, 153.44327095965107, 107.53238005843292, 110.04903124859902, 111.6175345503226, 150.97747108415712, 70.78857717019514, 119.3426451757666, 175.07663821936637, 20.50891736106509, 120.46258471260464, 95.18793160596044, 156.43644451063457, 33.308023746046985], "episode_lengths": [200, 200, 200, 200, 200, 32, 200, 200, 200, 175, 97, 109, 179, 200, 28, 200, 8, 200, 108, 200, 200, 200, 200, 160, 200, 72, 200, 162, 49, 200, 85, 140, 200, 50, 36, 200, 163, 161, 14, 200, 200, 200, 200, 104, 173, 184, 85, 200, 56, 93, 200, 35, 78, 88, 161, 200, 90, 7, 200, 133, 183, 180, 71, 200, 200, 154, 200, 200, 200, 78, 66, 80, 124, 34, 97, 168, 191, 89, 105, 192, 174, 179, 189, 123, 171, 164, 105, 93, 119, 119, 200, 147, 124, 164, 173, 120, 200, 200, 200, 86], "policy_agent_policy_reward": [11.138452480649299, 18.456513845260783, 22.15641040409695, 23.46838369770546, 19.998289559548674, 37.94752922966249, 33.39982761290099, 37.52750334367376, 19.405344001930164, 29.052067051833713, 15.239474588450824, 70.90481324483365, 55.58661523819161, 22.444009344694514, 2.90942307444403, -4.988086412697394, 2.4073693850441362, 13.563068981623871, 17.064182944398134, -0.6100597396344263, 30.014921147250455, -2.3750848679688534, -1.0508985462969136, 57.44765885876243, 35.409691004130046, 49.2457596784412, 78.36175546478475, 29.93132796503836, 25.828420761032465, 72.8818618656064, 17.896137904808338, 26.6892848371928, 86.64331244324644, 6.353827928253207, 9.02718122858483, 24.5363916521949, 41.58617880095757, 42.037056108042435, 3.380587602879973, 71.58067442251419, 32.91934389849999, 12.58742907412398, 14.930673956015749, 21.935000039703798, 53.542079432782586, 23.246527097106387, 46.82040737122075, 22.140787085011745, 70.86111250815071, 6.36372603172781, 17.111381210872636, 9.837443041367107, 25.417971856865154, 28.691412623769992, 88.36024873155209, 50.34045118253944, 46.272069347771804, 2.156064561008314, 48.91501657184662, 15.148476303844939, 44.59251244577257, 42.39155753504235, 21.625573799859204, 70.84251432024942, 3.2237203726402086, 57.54930796017297, 49.85582936883519, 26.70734021248693, 35.9837783492491, 22.33388100225677, 25.635932470115684, 11.524863848482026, 54.47765300167579, 8.758051005419123, 3.7921172208613996, 28.574605777023848, 40.00845720695034, 39.143226171889935, 49.06746062228086, 85.61056614152128, 38.77711633721541, 48.80250113108945, 51.12175197983754, 45.70882634369004, 42.930983954267674, 51.08269324127628, 45.89692238369434, 76.72163547982554, 53.76619002921642, 55.02451562429953, 55.808767275161266, 75.4887355420786, 35.39428858509755, 59.67132258788334, 87.5383191096832, 10.254458680532538, 60.23129235630232, 47.59396580298022, 78.21822225531736, 16.65401187302349], "policy_adversary_policy_reward": [7.554689968068061, 3.583762512581238, 11.647457674536852, 6.809056170723927, 2.6640769636024473, 19.49233344049451, 7.708856848586549, 15.75952684911891, 17.198158438917922, 2.800131120630761, 23.18243135784994, 14.765097871812571, 25.825619031607623, 7.5742085812933375, 13.52803993973199, 23.999463403941743, 11.099675799689003, 8.305668202241161, 22.029431900700285, 7.022635151133429, 8.348129984407167, 6.89134460404366, 37.88375720389107, 33.021056040942604, 26.461950724197383, 29.124664513994226, 3.340521997009585, 19.10348734768493, -11.399171575788287, 14.308594650232319, -2.20133958705496, -2.786746825642431, 2.0192613981503573, 0.3881079868937789, 2.315413945148407, 11.247655036475464, 4.46047179691103, 12.603711147487104, 2.008536959961674, -2.6185966995961003, 23.27559369797421, 6.739327449276242, 11.11613312793996, -13.491217995908812, 4.790712025159213, -5.84161057145613, 23.998561613103725, 33.449097245658706, 15.143795183480425, 20.265895820649625, 15.714316616663824, 33.53144306177738, 31.915863946572884, 46.44589151821184, 1.0560592420925872, 28.875268722945773, 19.43548746767266, 6.392933293359803, 29.281823743773273, 43.60003812183313, 22.018459126723172, -4.122321221914829, 16.452721934036866, 10.236562903155933, 43.72328959845832, 42.920022844788114, 12.072184423798134, -5.718356495544928, -15.512540098302976, 24.539721326887808, 16.17696844071436, 8.359423211480545, 35.0336262033112, 6.552552597646365, 24.094121838782673, 17.942934269259766, -6.454256911127495, 9.834844514007468, 33.48425857034346, 38.09641585217073, 30.269632640983065, 2.649711257516909, 6.852327540001911, 5.735101534122077, 16.592533928019765, -1.661859972004013, 2.8335546305655797, 19.10144540913822, 23.16602197407228, 30.3760574587103, 1.5766925238361331, 21.66983457327025, 23.901234480944943, 22.9191728902758, 16.396987477563822, 5.7437996074479205, 37.17731427155548, 33.68379823659523, 17.395749859442017, -11.032023827714207, 16.34897530851977, 0.7624059023528709, 12.080307778957248, -2.242864737590139, 13.404496324278334, 12.01347553258682, 15.182318459839106, 13.509094163930886, 47.21600765708064, 41.1442410744714, 25.397226204541134, 24.943224977998295, 29.59799220755971, 16.67407714021212, 3.1511311769931893, -0.9950666159848756, 26.224540507813913, 22.6904760640327, 19.94878281353612, -4.800306509691179, 32.07802976049733, 12.51448268527525, 26.503245931514876, 15.888311603527487, 25.990630005168995, -4.365056205309779, 37.50269398288026, 33.339820337369154, 0.032853405297744054, 3.1908669673424654, 37.057408944965815, 20.491899015207174, 26.365819507440964, 23.490009861394228, 12.691367712910942, 14.015972499575984, 20.94071610317114, 15.043062246077955, 9.64572178409384, 12.688159218162927, 10.731264121980473, 14.90466834813521, 26.626403538490216, -15.101539690008199, 9.259613987687105, 45.218039013988694, 27.438124049841743, -18.680073044422617, -7.022310967821959, 10.814428188683358, 31.94536167522874, -3.370755898204896, 19.87055801938301, 20.137899187567328, 15.476757004913722, 23.666469166976206, 17.18736482783924, 31.880095794441615, 38.43740633882148, 47.173159802699786, 15.81148913314924, 22.965627204066173, 33.546408711741435, 15.256092419348004, 18.165437607852887, 32.95631437198465, 25.750891132006288, 19.95793521168375, 17.57028666114119, 25.36069729312647, 35.34628776866315, 15.736405472613114, 23.728938538417516, 22.167983845276822, 46.05291963774104, 30.668715842084495, 18.678206340265216, 35.08798368895121, 18.865744745245095, 36.15877087905444, 24.737885995699145, 31.0708812794621, 34.741900218965085, 40.74683532311351, 13.798356830050981, 21.59593175504657, 25.164117132274555, 34.5072054556088, 38.75750629668234, 48.78081281300088, 0.4741382026842942, 9.780320477848244, 35.78039608671245, 24.450896269589883, 22.89518241978815, 24.69878338319208, 30.963857213340965, 47.254365041976385, 7.70376808862815, 8.95024378439534]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3886430836402511, "mean_inference_ms": 0.9644106793754063, "mean_action_processing_ms": 0.16519922138244755, "mean_env_wait_ms": 0.05704974489716445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037549734115600586, "StateBufferConnector_ms": 0.0025882720947265625, "ViewRequirementAgentConnector_ms": 0.06989872455596924}, "num_episodes": 27, "episode_return_max": 176.72049746310395, "episode_return_min": -9.976172825394777, "episode_return_mean": 70.96960538934209}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 492.1046914980058, "num_env_steps_trained_throughput_per_sec": 492.1046914980058, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 780000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 8245.11, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8245.076, "sample_time_ms": 751.195, "learn_time_ms": 7482.075, "learn_throughput": 534.611, "synch_weights_time_ms": 11.213}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "training_iteration": 65, "trial_id": "eaa30_00000", "date": "2024-08-09_17-49-08", "timestamp": 1723240148, "time_this_iter_s": 8.133841037750244, "time_total_s": 536.0653493404388, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc1da60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 536.0653493404388, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 22.575000000000003, "ram_util_percent": 79.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.844351920185897, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.585407820706645, "policy_loss": 0.0005950675281898055, "vf_loss": 7.580926644612872, "vf_explained_var": -0.1320347638041885, "kl": 0.009584501090523586, "entropy": 1.381468544813691, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.340001294389367, "cur_kl_coeff": 0.21648806836456067, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.740422347187996, "policy_loss": 0.018342316570730568, "vf_loss": 8.712509927153587, "vf_explained_var": 0.0014162077258030573, "kl": 0.044205941665374365, "entropy": 0.6675275690232714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "env_runners": {"episode_reward_max": 176.72049746310395, "episode_reward_min": 1.4253374291510383, "episode_reward_mean": 76.54038607289647, "episode_len_mean": 135.7, "episode_media": {}, "episodes_this_iter": 33, "episodes_timesteps_total": 13570, "policy_reward_min": {"agent_policy": 0.7126687145755192, "adversary_policy": -18.680073044422617}, "policy_reward_max": {"agent_policy": 88.36024873155209, "adversary_policy": 53.002139340980804}, "policy_reward_mean": {"agent_policy": 38.270193036448234, "adversary_policy": 19.135096518224117}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.707655856506406, 18.054362457169667, 49.072783304389816, 83.17235760191514, 84.07411221608493, 6.761175205759946, 143.16134884502844, 65.83868779699998, 25.174858148248, 29.861347912031526, 43.8700000794076, 107.08415886556514, 46.493054194212746, 93.64081474244145, 44.281574170023504, 141.7222250163014, 12.727452063455635, 34.222762421745315, 19.674886082734215, 50.835943713730316, 57.38282524753999, 176.72049746310395, 100.68090236507891, 92.54413869554372, 4.312129122016627, 97.83003314369324, 30.296952607689875, 89.18502489154514, 84.78311507008468, 43.251147599718394, 141.68502864049893, 6.447440745280414, 115.09861592034595, 99.71165873767043, 53.414680424973824, 71.9675566984982, 44.66776200451355, 51.27186494023135, 23.049727696964048, 108.95530600335162, 17.51610201083825, 7.584234441722806, 57.14921155404771, 80.01691441390066, 78.28645234377986, 98.13492124456167, 171.22113228304255, 77.55423267443086, 97.60500226217889, 102.24350395967511, 91.41765268738001, 85.86196790853532, 102.1653864825525, 91.79384476738869, 153.44327095965107, 107.53238005843292, 110.04903124859902, 111.6175345503226, 150.97747108415712, 70.78857717019514, 119.3426451757666, 175.07663821936637, 20.50891736106509, 120.46258471260464, 95.18793160596044, 156.43644451063457, 33.308023746046985, 108.66034383603571, 47.50202521057493, 100.54406443674648, 32.48845477992324, 30.197876450464488, 1.4253374291510383, 23.961463630268177, 46.385816693380306, 102.71425103920035, 159.2313747246688, 88.52134073940275, 108.08230603226087, 3.582426488136793, 88.7363876614051, 136.47038143920017, 3.337133491387843, 120.80579696008776, 77.49500991523335, 81.58750837306974, 45.66184437798711, 66.7123043289101, 126.44439345255142, 72.4050788623424, 39.01158894068368, 32.5126229087003, 71.0232937373707, 49.158561898619375, 84.6800301169001, 77.15387406734051, 55.9334821806263, 156.8540647986493, 141.1078232627195, 84.6803668767162], "episode_lengths": [50, 36, 200, 163, 161, 14, 200, 200, 200, 200, 104, 173, 184, 85, 200, 56, 93, 200, 35, 78, 88, 161, 200, 90, 7, 200, 133, 183, 180, 71, 200, 200, 154, 200, 200, 200, 78, 66, 80, 124, 34, 97, 168, 191, 89, 105, 192, 174, 179, 189, 123, 171, 164, 105, 93, 119, 119, 200, 147, 124, 164, 173, 120, 200, 200, 200, 86, 200, 107, 200, 104, 141, 2, 31, 44, 173, 194, 119, 181, 79, 174, 190, 101, 89, 152, 130, 142, 79, 152, 127, 99, 109, 38, 192, 168, 95, 125, 151, 200, 109], "policy_agent_policy_reward": [6.353827928253207, 9.02718122858483, 24.5363916521949, 41.58617880095757, 42.037056108042435, 3.380587602879973, 71.58067442251419, 32.91934389849999, 12.58742907412398, 14.930673956015749, 21.935000039703798, 53.542079432782586, 23.246527097106387, 46.82040737122075, 22.140787085011745, 70.86111250815071, 6.36372603172781, 17.111381210872636, 9.837443041367107, 25.417971856865154, 28.691412623769992, 88.36024873155209, 50.34045118253944, 46.272069347771804, 2.156064561008314, 48.91501657184662, 15.148476303844939, 44.59251244577257, 42.39155753504235, 21.625573799859204, 70.84251432024942, 3.2237203726402086, 57.54930796017297, 49.85582936883519, 26.70734021248693, 35.9837783492491, 22.33388100225677, 25.635932470115684, 11.524863848482026, 54.47765300167579, 8.758051005419123, 3.7921172208613996, 28.574605777023848, 40.00845720695034, 39.143226171889935, 49.06746062228086, 85.61056614152128, 38.77711633721541, 48.80250113108945, 51.12175197983754, 45.70882634369004, 42.930983954267674, 51.08269324127628, 45.89692238369434, 76.72163547982554, 53.76619002921642, 55.02451562429953, 55.808767275161266, 75.4887355420786, 35.39428858509755, 59.67132258788334, 87.5383191096832, 10.254458680532538, 60.23129235630232, 47.59396580298022, 78.21822225531736, 16.65401187302349, 54.330171918017875, 23.75101260528747, 50.272032218373226, 16.244227389961623, 15.098938225232232, 0.7126687145755192, 11.980731815134087, 23.192908346690178, 51.357125519600125, 79.61568736233433, 44.26067036970136, 54.04115301613039, 1.7912132440684054, 44.368193830702594, 68.2351907196001, 1.6685667456939224, 60.40289848004389, 38.7475049576167, 40.793754186534855, 22.83092218899355, 33.356152164455054, 63.2221967262757, 36.2025394311712, 19.50579447034183, 16.256311454350143, 35.51164686868533, 24.5792809493097, 42.34001505845005, 38.57693703367026, 27.966741090313153, 78.42703239932466, 70.55391163135978, 42.340183438358125], "policy_adversary_policy_reward": [12.072184423798134, -5.718356495544928, -15.512540098302976, 24.539721326887808, 16.17696844071436, 8.359423211480545, 35.0336262033112, 6.552552597646365, 24.094121838782673, 17.942934269259766, -6.454256911127495, 9.834844514007468, 33.48425857034346, 38.09641585217073, 30.269632640983065, 2.649711257516909, 6.852327540001911, 5.735101534122077, 16.592533928019765, -1.661859972004013, 2.8335546305655797, 19.10144540913822, 23.16602197407228, 30.3760574587103, 1.5766925238361331, 21.66983457327025, 23.901234480944943, 22.9191728902758, 16.396987477563822, 5.7437996074479205, 37.17731427155548, 33.68379823659523, 17.395749859442017, -11.032023827714207, 16.34897530851977, 0.7624059023528709, 12.080307778957248, -2.242864737590139, 13.404496324278334, 12.01347553258682, 15.182318459839106, 13.509094163930886, 47.21600765708064, 41.1442410744714, 25.397226204541134, 24.943224977998295, 29.59799220755971, 16.67407714021212, 3.1511311769931893, -0.9950666159848756, 26.224540507813913, 22.6904760640327, 19.94878281353612, -4.800306509691179, 32.07802976049733, 12.51448268527525, 26.503245931514876, 15.888311603527487, 25.990630005168995, -4.365056205309779, 37.50269398288026, 33.339820337369154, 0.032853405297744054, 3.1908669673424654, 37.057408944965815, 20.491899015207174, 26.365819507440964, 23.490009861394228, 12.691367712910942, 14.015972499575984, 20.94071610317114, 15.043062246077955, 9.64572178409384, 12.688159218162927, 10.731264121980473, 14.90466834813521, 26.626403538490216, -15.101539690008199, 9.259613987687105, 45.218039013988694, 27.438124049841743, -18.680073044422617, -7.022310967821959, 10.814428188683358, 31.94536167522874, -3.370755898204896, 19.87055801938301, 20.137899187567328, 15.476757004913722, 23.666469166976206, 17.18736482783924, 31.880095794441615, 38.43740633882148, 47.173159802699786, 15.81148913314924, 22.965627204066173, 33.546408711741435, 15.256092419348004, 18.165437607852887, 32.95631437198465, 25.750891132006288, 19.95793521168375, 17.57028666114119, 25.36069729312647, 35.34628776866315, 15.736405472613114, 23.728938538417516, 22.167983845276822, 46.05291963774104, 30.668715842084495, 18.678206340265216, 35.08798368895121, 18.865744745245095, 36.15877087905444, 24.737885995699145, 31.0708812794621, 34.741900218965085, 40.74683532311351, 13.798356830050981, 21.59593175504657, 25.164117132274555, 34.5072054556088, 38.75750629668234, 48.78081281300088, 0.4741382026842942, 9.780320477848244, 35.78039608671245, 24.450896269589883, 22.89518241978815, 24.69878338319208, 30.963857213340965, 47.254365041976385, 7.70376808862815, 8.95024378439534, 31.81683422144871, 22.513337696569153, 26.422466308710863, -2.671453703423392, 30.643624447278334, 19.628407771094892, 18.535119349121718, -2.2908919591600956, 11.25211266924095, 3.8468255559912974, 0.0, 0.7126687145755192, 6.557842949032633, 5.422888866101453, 35.17738174489836, -11.984473398208188, 22.45256788994713, 28.90455762965302, 40.025731980421064, 39.58995538191333, -5.5975405510143155, 49.858210920715685, 1.0390136751495826, 53.002139340980804, -0.6967095265399852, 2.4879227706083906, -1.9932308556125236, 46.361424686315125, 29.73838029546421, 38.49681042413587, 7.596767215593237, -5.928200469899316, 19.084374756175524, 41.31852372386836, 11.32257229653143, 27.424932661085258, 29.882632102913185, 10.911122083621681, 5.023195466759166, 17.807726722234385, 27.515707075496415, 5.840445088958652, 33.40974427316758, 29.81245245310811, 17.365574151515865, 18.83696527965535, 16.535867408785386, 2.9699270615564544, 11.772411506625929, 4.483899947724215, 29.30505141921816, 6.206595449467168, 9.962466831078983, 14.616814118230723, 7.951180296721571, 34.38883476172848, 15.480984363526716, 23.095952670143543, 27.171704359883915, 0.7950367304292421, 39.33337788657722, 39.093654512747435, 34.264531880822446, 36.28937975053732, 12.403975733904176, 29.93620770445393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3890103792095552, "mean_inference_ms": 0.9635731421627457, "mean_action_processing_ms": 0.16543559073252406, "mean_env_wait_ms": 0.0570632236030004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037039518356323242, "StateBufferConnector_ms": 0.0025719404220581055, "ViewRequirementAgentConnector_ms": 0.06837952136993408}, "num_episodes": 33, "episode_return_max": 176.72049746310395, "episode_return_min": 1.4253374291510383, "episode_return_mean": 76.54038607289647}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 465.17011193661546, "num_env_steps_trained_throughput_per_sec": 465.17011193661546, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 8266.14, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8266.106, "sample_time_ms": 748.516, "learn_time_ms": 7505.807, "learn_throughput": 532.921, "synch_weights_time_ms": 11.229}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "training_iteration": 66, "trial_id": "eaa30_00000", "date": "2024-08-09_17-49-17", "timestamp": 1723240157, "time_this_iter_s": 8.605348110198975, "time_total_s": 544.6706974506378, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbfc8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 544.6706974506378, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 27.416666666666668, "ram_util_percent": 79.50833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.671352805441649, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.044390837351481, "policy_loss": -0.0005570128291510243, "vf_loss": 7.041409268959489, "vf_explained_var": -0.10670714454045371, "kl": 0.008727405903979189, "entropy": 1.3773472251084746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3770831534639, "cur_kl_coeff": 0.32473210254684093, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.614917642374833, "policy_loss": 0.02212320775676441, "vf_loss": 8.584281103809674, "vf_explained_var": 0.006531768913070361, "kl": 0.026216568757081404, "entropy": 0.6560774960244695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "env_runners": {"episode_reward_max": 178.2888181417111, "episode_reward_min": 0.9120584601603419, "episode_reward_mean": 82.88783735127936, "episode_len_mean": 135.96, "episode_media": {}, "episodes_this_iter": 30, "episodes_timesteps_total": 13596, "policy_reward_min": {"agent_policy": 0.45602923008017093, "adversary_policy": -18.680073044422617}, "policy_reward_max": {"agent_policy": 89.14440907085557, "adversary_policy": 53.002139340980804}, "policy_reward_mean": {"agent_policy": 41.44391867563967, "adversary_policy": 20.721959337819836}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.68502864049893, 6.447440745280414, 115.09861592034595, 99.71165873767043, 53.414680424973824, 71.9675566984982, 44.66776200451355, 51.27186494023135, 23.049727696964048, 108.95530600335162, 17.51610201083825, 7.584234441722806, 57.14921155404771, 80.01691441390066, 78.28645234377986, 98.13492124456167, 171.22113228304255, 77.55423267443086, 97.60500226217889, 102.24350395967511, 91.41765268738001, 85.86196790853532, 102.1653864825525, 91.79384476738869, 153.44327095965107, 107.53238005843292, 110.04903124859902, 111.6175345503226, 150.97747108415712, 70.78857717019514, 119.3426451757666, 175.07663821936637, 20.50891736106509, 120.46258471260464, 95.18793160596044, 156.43644451063457, 33.308023746046985, 108.66034383603571, 47.50202521057493, 100.54406443674648, 32.48845477992324, 30.197876450464488, 1.4253374291510383, 23.961463630268177, 46.385816693380306, 102.71425103920035, 159.2313747246688, 88.52134073940275, 108.08230603226087, 3.582426488136793, 88.7363876614051, 136.47038143920017, 3.337133491387843, 120.80579696008776, 77.49500991523335, 81.58750837306974, 45.66184437798711, 66.7123043289101, 126.44439345255142, 72.4050788623424, 39.01158894068368, 32.5126229087003, 71.0232937373707, 49.158561898619375, 84.6800301169001, 77.15387406734051, 55.9334821806263, 156.8540647986493, 141.1078232627195, 84.6803668767162, 93.40580653953822, 124.85490062929404, 178.2888181417111, 50.22549839935036, 61.57911727872484, 89.63945047627536, 72.41503896918981, 44.382534216653085, 66.2163852873316, 176.82033304112633, 18.492790554784047, 85.12682829528347, 158.43004362575923, 74.76420036915314, 86.4046869440572, 0.9120584601603419, 72.95809100891196, 46.86278032427698, 67.93463941468444, 115.07451595198532, 14.64253264883668, 96.42003955887418, 109.20535103097097, 105.47789132562434, 167.81474483172258, 147.91447740941564, 17.97380683823497, 94.30067273568883, 44.10762722480335, 41.51779320563182], "episode_lengths": [200, 200, 154, 200, 200, 200, 78, 66, 80, 124, 34, 97, 168, 191, 89, 105, 192, 174, 179, 189, 123, 171, 164, 105, 93, 119, 119, 200, 147, 124, 164, 173, 120, 200, 200, 200, 86, 200, 107, 200, 104, 141, 2, 31, 44, 173, 194, 119, 181, 79, 174, 190, 101, 89, 152, 130, 142, 79, 152, 127, 99, 109, 38, 192, 168, 95, 125, 151, 200, 109, 111, 200, 125, 165, 128, 79, 146, 94, 160, 179, 35, 181, 186, 111, 52, 5, 183, 92, 164, 134, 104, 200, 102, 167, 167, 112, 87, 157, 197, 148], "policy_agent_policy_reward": [70.84251432024942, 3.2237203726402086, 57.54930796017297, 49.85582936883519, 26.70734021248693, 35.9837783492491, 22.33388100225677, 25.635932470115684, 11.524863848482026, 54.47765300167579, 8.758051005419123, 3.7921172208613996, 28.574605777023848, 40.00845720695034, 39.143226171889935, 49.06746062228086, 85.61056614152128, 38.77711633721541, 48.80250113108945, 51.12175197983754, 45.70882634369004, 42.930983954267674, 51.08269324127628, 45.89692238369434, 76.72163547982554, 53.76619002921642, 55.02451562429953, 55.808767275161266, 75.4887355420786, 35.39428858509755, 59.67132258788334, 87.5383191096832, 10.254458680532538, 60.23129235630232, 47.59396580298022, 78.21822225531736, 16.65401187302349, 54.330171918017875, 23.75101260528747, 50.272032218373226, 16.244227389961623, 15.098938225232232, 0.7126687145755192, 11.980731815134087, 23.192908346690178, 51.357125519600125, 79.61568736233433, 44.26067036970136, 54.04115301613039, 1.7912132440684054, 44.368193830702594, 68.2351907196001, 1.6685667456939224, 60.40289848004389, 38.7475049576167, 40.793754186534855, 22.83092218899355, 33.356152164455054, 63.2221967262757, 36.2025394311712, 19.50579447034183, 16.256311454350143, 35.51164686868533, 24.5792809493097, 42.34001505845005, 38.57693703367026, 27.966741090313153, 78.42703239932466, 70.55391163135978, 42.340183438358125, 46.70290326976909, 62.42745031464702, 89.14440907085557, 25.112749199675168, 30.78955863936243, 44.81972523813769, 36.20751948459491, 22.191267108326542, 33.1081926436658, 88.41016652056314, 9.246395277392024, 42.56341414764171, 79.21502181287958, 37.38210018457658, 43.20234347202857, 0.45602923008017093, 36.47904550445598, 23.431390162138495, 33.96731970734222, 57.537257975992645, 7.321266324418319, 48.2100197794371, 54.602675515485416, 52.73894566281214, 83.90737241586127, 73.9572387047078, 8.986903419117485, 47.150336367844446, 22.053813612401672, 20.758896602815913], "policy_adversary_policy_reward": [37.50269398288026, 33.339820337369154, 0.032853405297744054, 3.1908669673424654, 37.057408944965815, 20.491899015207174, 26.365819507440964, 23.490009861394228, 12.691367712910942, 14.015972499575984, 20.94071610317114, 15.043062246077955, 9.64572178409384, 12.688159218162927, 10.731264121980473, 14.90466834813521, 26.626403538490216, -15.101539690008199, 9.259613987687105, 45.218039013988694, 27.438124049841743, -18.680073044422617, -7.022310967821959, 10.814428188683358, 31.94536167522874, -3.370755898204896, 19.87055801938301, 20.137899187567328, 15.476757004913722, 23.666469166976206, 17.18736482783924, 31.880095794441615, 38.43740633882148, 47.173159802699786, 15.81148913314924, 22.965627204066173, 33.546408711741435, 15.256092419348004, 18.165437607852887, 32.95631437198465, 25.750891132006288, 19.95793521168375, 17.57028666114119, 25.36069729312647, 35.34628776866315, 15.736405472613114, 23.728938538417516, 22.167983845276822, 46.05291963774104, 30.668715842084495, 18.678206340265216, 35.08798368895121, 18.865744745245095, 36.15877087905444, 24.737885995699145, 31.0708812794621, 34.741900218965085, 40.74683532311351, 13.798356830050981, 21.59593175504657, 25.164117132274555, 34.5072054556088, 38.75750629668234, 48.78081281300088, 0.4741382026842942, 9.780320477848244, 35.78039608671245, 24.450896269589883, 22.89518241978815, 24.69878338319208, 30.963857213340965, 47.254365041976385, 7.70376808862815, 8.95024378439534, 31.81683422144871, 22.513337696569153, 26.422466308710863, -2.671453703423392, 30.643624447278334, 19.628407771094892, 18.535119349121718, -2.2908919591600956, 11.25211266924095, 3.8468255559912974, 0.0, 0.7126687145755192, 6.557842949032633, 5.422888866101453, 35.17738174489836, -11.984473398208188, 22.45256788994713, 28.90455762965302, 40.025731980421064, 39.58995538191333, -5.5975405510143155, 49.858210920715685, 1.0390136751495826, 53.002139340980804, -0.6967095265399852, 2.4879227706083906, -1.9932308556125236, 46.361424686315125, 29.73838029546421, 38.49681042413587, 7.596767215593237, -5.928200469899316, 19.084374756175524, 41.31852372386836, 11.32257229653143, 27.424932661085258, 29.882632102913185, 10.911122083621681, 5.023195466759166, 17.807726722234385, 27.515707075496415, 5.840445088958652, 33.40974427316758, 29.81245245310811, 17.365574151515865, 18.83696527965535, 16.535867408785386, 2.9699270615564544, 11.772411506625929, 4.483899947724215, 29.30505141921816, 6.206595449467168, 9.962466831078983, 14.616814118230723, 7.951180296721571, 34.38883476172848, 15.480984363526716, 23.095952670143543, 27.171704359883915, 0.7950367304292421, 39.33337788657722, 39.093654512747435, 34.264531880822446, 36.28937975053732, 12.403975733904176, 29.93620770445393, 26.421043003674395, 20.281860266094704, 34.73726564527811, 27.690184669368918, 44.53404102256613, 44.61036804828943, 22.36853392571281, 2.7442152739623715, 12.127588808634155, 18.66196983072827, 35.41880194997299, 9.400923288164705, 22.126793064011952, 14.080726420582952, 12.686020790456642, 9.5052463178699, 29.212894933377562, 3.8952977102882365, 39.49388996295697, 48.91627655760615, 4.37410050868969, 4.872294768702334, 18.436147098706424, 24.127267048935295, 42.87023294671802, 36.344788866161565, 8.1150624759946, 29.26703770858198, 7.610463001897775, 35.5918804701308, -4.471988929643807, 4.928018159723978, 25.20494671009406, 11.274098794361922, 9.622719132849433, 13.808671029289062, 7.254131235894018, 26.713188471448213, 37.55628348397643, 19.980974492016223, 9.973652180161805, -2.652385855743475, 31.71241816560169, 16.497601613835403, 42.3705229931709, 12.232152522314525, 21.610298597480462, 31.12864706533169, 50.457997548055864, 33.44937486780541, 32.918546648866446, 41.038692055841366, 7.835840933081582, 1.1510624860359044, 27.692814246337868, 19.457522121506585, 11.09257138892009, 10.961242223481584, 8.68264515691467, 12.076251445901242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38891727793390646, "mean_inference_ms": 0.964240822664749, "mean_action_processing_ms": 0.16539122900664374, "mean_env_wait_ms": 0.056990318210725706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036323070526123047, "StateBufferConnector_ms": 0.0024826526641845703, "ViewRequirementAgentConnector_ms": 0.0662224292755127}, "num_episodes": 30, "episode_return_max": 178.2888181417111, "episode_return_min": 0.9120584601603419, "episode_return_mean": 82.88783735127936}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 489.6347293731148, "num_env_steps_trained_throughput_per_sec": 489.6347293731148, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 804000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 8249.626, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8249.591, "sample_time_ms": 745.721, "learn_time_ms": 7492.061, "learn_throughput": 533.899, "synch_weights_time_ms": 11.246}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "training_iteration": 67, "trial_id": "eaa30_00000", "date": "2024-08-09_17-49-25", "timestamp": 1723240165, "time_this_iter_s": 8.17899489402771, "time_total_s": 552.8496923446655, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbfc940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 552.8496923446655, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 23.183333333333334, "ram_util_percent": 79.84166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.244001868351427, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.210375131879534, "policy_loss": 0.0012965256501008908, "vf_loss": 7.202171809332711, "vf_explained_var": -0.14892157707264814, "kl": 0.01703453938668919, "entropy": 1.3288875640384734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5058984539161124, "cur_kl_coeff": 0.4870981538202612, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.3948460166653, "policy_loss": 0.013461091774418794, "vf_loss": 8.365121565262477, "vf_explained_var": 0.010217784717679024, "kl": 0.033388249451915424, "entropy": 0.6641532974938552, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 178.2888181417111, "episode_reward_min": 0.9120584601603419, "episode_reward_mean": 84.58456306537236, "episode_len_mean": 120.8, "episode_media": {}, "episodes_this_iter": 39, "episodes_timesteps_total": 12080, "policy_reward_min": {"agent_policy": 0.45602923008017093, "adversary_policy": -11.984473398208188}, "policy_reward_max": {"agent_policy": 89.14440907085557, "adversary_policy": 56.40956250818224}, "policy_reward_mean": {"agent_policy": 42.29228153268618, "adversary_policy": 21.14614076634309}, "custom_metrics": {}, "hist_stats": {"episode_reward": [100.54406443674648, 32.48845477992324, 30.197876450464488, 1.4253374291510383, 23.961463630268177, 46.385816693380306, 102.71425103920035, 159.2313747246688, 88.52134073940275, 108.08230603226087, 3.582426488136793, 88.7363876614051, 136.47038143920017, 3.337133491387843, 120.80579696008776, 77.49500991523335, 81.58750837306974, 45.66184437798711, 66.7123043289101, 126.44439345255142, 72.4050788623424, 39.01158894068368, 32.5126229087003, 71.0232937373707, 49.158561898619375, 84.6800301169001, 77.15387406734051, 55.9334821806263, 156.8540647986493, 141.1078232627195, 84.6803668767162, 93.40580653953822, 124.85490062929404, 178.2888181417111, 50.22549839935036, 61.57911727872484, 89.63945047627536, 72.41503896918981, 44.382534216653085, 66.2163852873316, 176.82033304112633, 18.492790554784047, 85.12682829528347, 158.43004362575923, 74.76420036915314, 86.4046869440572, 0.9120584601603419, 72.95809100891196, 46.86278032427698, 67.93463941468444, 115.07451595198532, 14.64253264883668, 96.42003955887418, 109.20535103097097, 105.47789132562434, 167.81474483172258, 147.91447740941564, 17.97380683823497, 94.30067273568883, 44.10762722480335, 41.51779320563182, 135.01172450737803, 59.566249584597216, 58.166357661144104, 41.656921736680005, 89.6259829630565, 142.60161174896928, 177.11498797651018, 20.207514569869293, 39.30958917715019, 172.59433832802267, 152.24539839062484, 122.66807060951535, 141.19723690221338, 84.63686793561484, 109.46179701187415, 151.61378516028657, 71.73962461002935, 22.162747328413733, 91.71811769994613, 78.75527912911578, 115.94534165572351, 117.05267968415299, 109.89692360438497, 91.4524440060235, 69.14687619794167, 67.14814484098389, 62.438757285999785, 64.36418073012831, 80.37964033598111, 46.02008022062733, 114.45547305992716, 74.37285016374437, 64.97703695989449, 70.2495135007517, 77.24316261529249, 36.73751932737268, 103.82694606273591, 140.4045833930165, 157.22023502938416], "episode_lengths": [200, 104, 141, 2, 31, 44, 173, 194, 119, 181, 79, 174, 190, 101, 89, 152, 130, 142, 79, 152, 127, 99, 109, 38, 192, 168, 95, 125, 151, 200, 109, 111, 200, 125, 165, 128, 79, 146, 94, 160, 179, 35, 181, 186, 111, 52, 5, 183, 92, 164, 134, 104, 200, 102, 167, 167, 112, 87, 157, 197, 148, 51, 114, 48, 101, 111, 185, 140, 36, 36, 134, 146, 102, 146, 75, 200, 137, 112, 26, 68, 112, 130, 126, 148, 106, 137, 87, 71, 95, 97, 110, 153, 87, 100, 107, 123, 21, 134, 177, 130], "policy_agent_policy_reward": [50.272032218373226, 16.244227389961623, 15.098938225232232, 0.7126687145755192, 11.980731815134087, 23.192908346690178, 51.357125519600125, 79.61568736233433, 44.26067036970136, 54.04115301613039, 1.7912132440684054, 44.368193830702594, 68.2351907196001, 1.6685667456939224, 60.40289848004389, 38.7475049576167, 40.793754186534855, 22.83092218899355, 33.356152164455054, 63.2221967262757, 36.2025394311712, 19.50579447034183, 16.256311454350143, 35.51164686868533, 24.5792809493097, 42.34001505845005, 38.57693703367026, 27.966741090313153, 78.42703239932466, 70.55391163135978, 42.340183438358125, 46.70290326976909, 62.42745031464702, 89.14440907085557, 25.112749199675168, 30.78955863936243, 44.81972523813769, 36.20751948459491, 22.191267108326542, 33.1081926436658, 88.41016652056314, 9.246395277392024, 42.56341414764171, 79.21502181287958, 37.38210018457658, 43.20234347202857, 0.45602923008017093, 36.47904550445598, 23.431390162138495, 33.96731970734222, 57.537257975992645, 7.321266324418319, 48.2100197794371, 54.602675515485416, 52.73894566281214, 83.90737241586127, 73.9572387047078, 8.986903419117485, 47.150336367844446, 22.053813612401672, 20.758896602815913, 67.50586225368899, 29.783124792298604, 29.08317883057203, 20.828460868340013, 44.81299148152825, 71.30080587448464, 88.55749398825515, 10.103757284934645, 19.654794588575097, 86.29716916401134, 76.12269919531253, 61.33403530475768, 70.59861845110666, 42.31843396780742, 54.73089850593706, 75.80689258014327, 35.869812305014676, 11.081373664206867, 45.85905884997308, 39.37763956455789, 57.97267082786177, 58.5263398420765, 54.94846180219248, 45.72622200301174, 34.573438098970826, 33.574072420491945, 31.2193786429999, 32.182090365064155, 40.189820167990554, 23.010040110313653, 57.22773652996361, 37.18642508187219, 32.488518479947246, 35.12475675037585, 38.62158130764624, 18.36875966368634, 51.91347303136798, 70.20229169650824, 78.6101175146921], "policy_adversary_policy_reward": [30.643624447278334, 19.628407771094892, 18.535119349121718, -2.2908919591600956, 11.25211266924095, 3.8468255559912974, 0.0, 0.7126687145755192, 6.557842949032633, 5.422888866101453, 35.17738174489836, -11.984473398208188, 22.45256788994713, 28.90455762965302, 40.025731980421064, 39.58995538191333, -5.5975405510143155, 49.858210920715685, 1.0390136751495826, 53.002139340980804, -0.6967095265399852, 2.4879227706083906, -1.9932308556125236, 46.361424686315125, 29.73838029546421, 38.49681042413587, 7.596767215593237, -5.928200469899316, 19.084374756175524, 41.31852372386836, 11.32257229653143, 27.424932661085258, 29.882632102913185, 10.911122083621681, 5.023195466759166, 17.807726722234385, 27.515707075496415, 5.840445088958652, 33.40974427316758, 29.81245245310811, 17.365574151515865, 18.83696527965535, 16.535867408785386, 2.9699270615564544, 11.772411506625929, 4.483899947724215, 29.30505141921816, 6.206595449467168, 9.962466831078983, 14.616814118230723, 7.951180296721571, 34.38883476172848, 15.480984363526716, 23.095952670143543, 27.171704359883915, 0.7950367304292421, 39.33337788657722, 39.093654512747435, 34.264531880822446, 36.28937975053732, 12.403975733904176, 29.93620770445393, 26.421043003674395, 20.281860266094704, 34.73726564527811, 27.690184669368918, 44.53404102256613, 44.61036804828943, 22.36853392571281, 2.7442152739623715, 12.127588808634155, 18.66196983072827, 35.41880194997299, 9.400923288164705, 22.126793064011952, 14.080726420582952, 12.686020790456642, 9.5052463178699, 29.212894933377562, 3.8952977102882365, 39.49388996295697, 48.91627655760615, 4.37410050868969, 4.872294768702334, 18.436147098706424, 24.127267048935295, 42.87023294671802, 36.344788866161565, 8.1150624759946, 29.26703770858198, 7.610463001897775, 35.5918804701308, -4.471988929643807, 4.928018159723978, 25.20494671009406, 11.274098794361922, 9.622719132849433, 13.808671029289062, 7.254131235894018, 26.713188471448213, 37.55628348397643, 19.980974492016223, 9.973652180161805, -2.652385855743475, 31.71241816560169, 16.497601613835403, 42.3705229931709, 12.232152522314525, 21.610298597480462, 31.12864706533169, 50.457997548055864, 33.44937486780541, 32.918546648866446, 41.038692055841366, 7.835840933081582, 1.1510624860359044, 27.692814246337868, 19.457522121506585, 11.09257138892009, 10.961242223481584, 8.68264515691467, 12.076251445901242, 39.29886841558815, 28.20699383810086, 6.020834773290002, 23.762290019008606, 28.075503324182566, 1.0076755063894733, 5.693595012595818, 15.134865855744192, 29.030424356065616, 15.782567125462634, 34.136573086996684, 37.164232787487954, 56.40956250818224, 32.14793148007288, -4.685182018055926, 14.78893930299057, 6.744019973110747, 12.910774615464348, 43.20659244330043, 43.09057672071091, 43.07549519128025, 33.04720400403226, 28.714563048130657, 32.61947225662701, 35.90572513457814, 34.69289331652853, 13.550471001569754, 28.767962966237675, 19.53161374886604, 35.19928475707103, 31.480826434455118, 44.32606614568814, 29.208743951775006, 6.661068353239671, 15.547394607729869, -4.466020943522999, 22.591018223521946, 23.268040626451146, 14.829674258106486, 24.547965306451406, 32.37702928454975, 25.595641543312006, 34.66051997344719, 23.865819868629316, 25.773221399681752, 29.175240402510727, 21.56402530787493, 24.162196695136803, 16.088617640664623, 18.484820458306203, 2.399438127731268, 31.174634292760675, 18.511211081176626, 12.708167561823274, 24.14100927527914, 8.04108108978501, 18.96551744825109, 21.224302719739462, 1.491524510751784, 21.51851559956188, 19.47287596630619, 37.7548605636574, 19.98513068411973, 17.201294397752463, 15.25532755204102, 17.233190927906232, 27.348916724049126, 7.775840026326721, 28.06795708566709, 10.553624221979156, 10.039827328440218, 8.328932335246122, 24.22192516375449, 27.691547867613487, 28.890794016326222, 41.311497680182, 50.8775345954831, 27.732582919208998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3885691216166277, "mean_inference_ms": 0.9624457186209219, "mean_action_processing_ms": 0.16533891373473936, "mean_env_wait_ms": 0.057012102931464026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035496950149536133, "StateBufferConnector_ms": 0.002467513084411621, "ViewRequirementAgentConnector_ms": 0.06471097469329834}, "num_episodes": 39, "episode_return_max": 178.2888181417111, "episode_return_min": 0.9120584601603419, "episode_return_mean": 84.58456306537236}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 483.0172826235726, "num_env_steps_trained_throughput_per_sec": 483.0172826235726, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 8246.509, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8246.474, "sample_time_ms": 748.054, "learn_time_ms": 7486.551, "learn_throughput": 534.291, "synch_weights_time_ms": 11.305}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 68, "trial_id": "eaa30_00000", "date": "2024-08-09_17-49-33", "timestamp": 1723240173, "time_this_iter_s": 8.287179946899414, "time_total_s": 561.1368722915649, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbfcb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 561.1368722915649, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 23.400000000000002, "ram_util_percent": 79.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.2671246685679, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.325708376667487, "policy_loss": -0.004366206004907668, "vf_loss": 7.324743296103502, "vf_explained_var": -0.09777278625775897, "kl": 0.013148836840298914, "entropy": 1.3091848153285879, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4486751385188352, "cur_kl_coeff": 0.7306472307303923, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.436967590947946, "policy_loss": 0.018221669445726243, "vf_loss": 8.392840842902661, "vf_explained_var": 0.009038846132655938, "kl": 0.03545493081328459, "entropy": 0.6540057776495815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "env_runners": {"episode_reward_max": 177.11498797651018, "episode_reward_min": -2.0876684856743637, "episode_reward_mean": 86.71431443635771, "episode_len_mean": 114.15, "episode_media": {}, "episodes_this_iter": 36, "episodes_timesteps_total": 11415, "policy_reward_min": {"agent_policy": -1.0438342428371818, "adversary_policy": -12.68210417456693}, "policy_reward_max": {"agent_policy": 88.55749398825515, "adversary_policy": 56.40956250818224}, "policy_reward_mean": {"agent_policy": 43.357157218178855, "adversary_policy": 21.67857860908943}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.63945047627536, 72.41503896918981, 44.382534216653085, 66.2163852873316, 176.82033304112633, 18.492790554784047, 85.12682829528347, 158.43004362575923, 74.76420036915314, 86.4046869440572, 0.9120584601603419, 72.95809100891196, 46.86278032427698, 67.93463941468444, 115.07451595198532, 14.64253264883668, 96.42003955887418, 109.20535103097097, 105.47789132562434, 167.81474483172258, 147.91447740941564, 17.97380683823497, 94.30067273568883, 44.10762722480335, 41.51779320563182, 135.01172450737803, 59.566249584597216, 58.166357661144104, 41.656921736680005, 89.6259829630565, 142.60161174896928, 177.11498797651018, 20.207514569869293, 39.30958917715019, 172.59433832802267, 152.24539839062484, 122.66807060951535, 141.19723690221338, 84.63686793561484, 109.46179701187415, 151.61378516028657, 71.73962461002935, 22.162747328413733, 91.71811769994613, 78.75527912911578, 115.94534165572351, 117.05267968415299, 109.89692360438497, 91.4524440060235, 69.14687619794167, 67.14814484098389, 62.438757285999785, 64.36418073012831, 80.37964033598111, 46.02008022062733, 114.45547305992716, 74.37285016374437, 64.97703695989449, 70.2495135007517, 77.24316261529249, 36.73751932737268, 103.82694606273591, 140.4045833930165, 157.22023502938416, 126.51052953064931, 57.626930329138816, 144.7013435462016, 89.97201067253025, 103.45052045085585, 117.7352744150547, 59.67320124137832, 116.94110056831215, 142.99094999205198, 49.62332347561305, -2.0876684856743637, 41.272832561008144, 99.0232211461605, 20.76262308230391, 68.4860926645589, 37.658840401611, 95.85812555754868, 68.53625452364612, 70.95554276340502, 24.127110974311258, 124.77887786554223, 50.45913155196187, 96.28579972067686, 53.0734109048647, 128.75493791195728, 125.82725565193368, 78.09539470584974, 85.27784663698992, 14.73843035523744, 129.423160273774, 78.74819586164415, 111.87230691443474, 161.66258153124508, 142.86881237475677, 85.89815963844802, 28.65307687127723], "episode_lengths": [79, 146, 94, 160, 179, 35, 181, 186, 111, 52, 5, 183, 92, 164, 134, 104, 200, 102, 167, 167, 112, 87, 157, 197, 148, 51, 114, 48, 101, 111, 185, 140, 36, 36, 134, 146, 102, 146, 75, 200, 137, 112, 26, 68, 112, 130, 126, 148, 106, 137, 87, 71, 95, 97, 110, 153, 87, 100, 107, 123, 21, 134, 177, 130, 121, 140, 90, 127, 158, 96, 90, 99, 200, 52, 50, 95, 139, 85, 49, 58, 176, 122, 61, 144, 81, 200, 62, 165, 142, 118, 41, 135, 76, 124, 111, 82, 165, 111, 89, 100], "policy_agent_policy_reward": [44.81972523813769, 36.20751948459491, 22.191267108326542, 33.1081926436658, 88.41016652056314, 9.246395277392024, 42.56341414764171, 79.21502181287958, 37.38210018457658, 43.20234347202857, 0.45602923008017093, 36.47904550445598, 23.431390162138495, 33.96731970734222, 57.537257975992645, 7.321266324418319, 48.2100197794371, 54.602675515485416, 52.73894566281214, 83.90737241586127, 73.9572387047078, 8.986903419117485, 47.150336367844446, 22.053813612401672, 20.758896602815913, 67.50586225368899, 29.783124792298604, 29.08317883057203, 20.828460868340013, 44.81299148152825, 71.30080587448464, 88.55749398825515, 10.103757284934645, 19.654794588575097, 86.29716916401134, 76.12269919531253, 61.33403530475768, 70.59861845110666, 42.31843396780742, 54.73089850593706, 75.80689258014327, 35.869812305014676, 11.081373664206867, 45.85905884997308, 39.37763956455789, 57.97267082786177, 58.5263398420765, 54.94846180219248, 45.72622200301174, 34.573438098970826, 33.574072420491945, 31.2193786429999, 32.182090365064155, 40.189820167990554, 23.010040110313653, 57.22773652996361, 37.18642508187219, 32.488518479947246, 35.12475675037585, 38.62158130764624, 18.36875966368634, 51.91347303136798, 70.20229169650824, 78.6101175146921, 63.25526476532467, 28.813465164569397, 72.3506717731008, 44.986005336265094, 51.72526022542793, 58.867637207527345, 29.83660062068917, 58.470550284156026, 71.49547499602599, 24.81166173780651, -1.0438342428371818, 20.636416280504072, 49.51161057308026, 10.381311541151957, 34.24304633227945, 18.829420200805494, 47.92906277877432, 34.268127261823054, 35.477771381702524, 12.063555487155632, 62.38943893277114, 25.229565775980948, 48.14289986033843, 26.536705452432358, 64.37746895597866, 62.913627825966834, 39.047697352924885, 42.63892331849496, 7.369215177618717, 64.71158013688694, 39.374097930822074, 55.93615345721737, 80.83129076562255, 71.43440618737841, 42.949079819224, 14.326538435638614], "policy_adversary_policy_reward": [35.41880194997299, 9.400923288164705, 22.126793064011952, 14.080726420582952, 12.686020790456642, 9.5052463178699, 29.212894933377562, 3.8952977102882365, 39.49388996295697, 48.91627655760615, 4.37410050868969, 4.872294768702334, 18.436147098706424, 24.127267048935295, 42.87023294671802, 36.344788866161565, 8.1150624759946, 29.26703770858198, 7.610463001897775, 35.5918804701308, -4.471988929643807, 4.928018159723978, 25.20494671009406, 11.274098794361922, 9.622719132849433, 13.808671029289062, 7.254131235894018, 26.713188471448213, 37.55628348397643, 19.980974492016223, 9.973652180161805, -2.652385855743475, 31.71241816560169, 16.497601613835403, 42.3705229931709, 12.232152522314525, 21.610298597480462, 31.12864706533169, 50.457997548055864, 33.44937486780541, 32.918546648866446, 41.038692055841366, 7.835840933081582, 1.1510624860359044, 27.692814246337868, 19.457522121506585, 11.09257138892009, 10.961242223481584, 8.68264515691467, 12.076251445901242, 39.29886841558815, 28.20699383810086, 6.020834773290002, 23.762290019008606, 28.075503324182566, 1.0076755063894733, 5.693595012595818, 15.134865855744192, 29.030424356065616, 15.782567125462634, 34.136573086996684, 37.164232787487954, 56.40956250818224, 32.14793148007288, -4.685182018055926, 14.78893930299057, 6.744019973110747, 12.910774615464348, 43.20659244330043, 43.09057672071091, 43.07549519128025, 33.04720400403226, 28.714563048130657, 32.61947225662701, 35.90572513457814, 34.69289331652853, 13.550471001569754, 28.767962966237675, 19.53161374886604, 35.19928475707103, 31.480826434455118, 44.32606614568814, 29.208743951775006, 6.661068353239671, 15.547394607729869, -4.466020943522999, 22.591018223521946, 23.268040626451146, 14.829674258106486, 24.547965306451406, 32.37702928454975, 25.595641543312006, 34.66051997344719, 23.865819868629316, 25.773221399681752, 29.175240402510727, 21.56402530787493, 24.162196695136803, 16.088617640664623, 18.484820458306203, 2.399438127731268, 31.174634292760675, 18.511211081176626, 12.708167561823274, 24.14100927527914, 8.04108108978501, 18.96551744825109, 21.224302719739462, 1.491524510751784, 21.51851559956188, 19.47287596630619, 37.7548605636574, 19.98513068411973, 17.201294397752463, 15.25532755204102, 17.233190927906232, 27.348916724049126, 7.775840026326721, 28.06795708566709, 10.553624221979156, 10.039827328440218, 8.328932335246122, 24.22192516375449, 27.691547867613487, 28.890794016326222, 41.311497680182, 50.8775345954831, 27.732582919208998, 35.01945089276305, 28.235813872561614, 8.721019010422111, 20.092446154147286, 41.12938943240831, 31.221282340692476, 25.29208262855, 19.69392270771509, 36.92388555954365, 14.801374665884278, 43.224737424591495, 15.642899782935846, 16.04490891702132, 13.791691703667848, 18.7931028466216, 39.67744743753443, 35.3470397923047, 36.148435203721306, 33.93682430708582, -9.125162569279311, 11.638269931729754, -12.68210417456693, 11.393802607011526, 9.242613673492547, 30.087638458564406, 19.423972114515852, 2.847398076556292, 7.533913464595667, 14.076066437016815, 20.166979895262635, 13.235534368623743, 5.593885832181752, 16.694606273278858, 31.234456505495473, 31.692228757862175, 2.575898503960868, 14.865005118194409, 20.61276626350812, 14.855089967058742, -2.791534479903108, 37.752736239338844, 24.636702693432284, 21.289672476659703, 3.9398932993212448, 22.44063090534437, 25.702268954994068, 10.104924382481315, 16.431781069951043, 22.171463530360246, 42.2060054256184, 39.83582112574485, 23.077806700221963, 12.944341037555809, 26.103356315369084, 21.569450528618454, 21.06947278987651, 10.294589918365716, -2.925374740747001, 36.56865379432751, 28.142926342559463, 28.52558793754159, 10.848509993280487, 29.33121952933061, 26.604933927886762, 34.168010754925966, 46.663280010696596, 36.07362556231568, 35.36078062506275, 19.51273660448225, 23.436343214741747, 7.812726842556831, 6.513811593081782]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38810354701912175, "mean_inference_ms": 0.9617668147794027, "mean_action_processing_ms": 0.1651892659056636, "mean_env_wait_ms": 0.05698412711316538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003478527069091797, "StateBufferConnector_ms": 0.0024682283401489258, "ViewRequirementAgentConnector_ms": 0.066200852394104}, "num_episodes": 36, "episode_return_max": 177.11498797651018, "episode_return_min": -2.0876684856743637, "episode_return_mean": 86.71431443635771}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.1268251587301, "num_env_steps_trained_throughput_per_sec": 491.1268251587301, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 828000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 8229.064, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8229.03, "sample_time_ms": 748.759, "learn_time_ms": 7468.528, "learn_throughput": 535.581, "synch_weights_time_ms": 11.241}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "training_iteration": 69, "trial_id": "eaa30_00000", "date": "2024-08-09_17-49-42", "timestamp": 1723240182, "time_this_iter_s": 8.150105953216553, "time_total_s": 569.2869782447815, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbfcdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 569.2869782447815, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 27.645454545454548, "ram_util_percent": 79.86363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.4266617076106805, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.272786972510121, "policy_loss": -0.002798455691694346, "vf_loss": 7.2709424528495346, "vf_explained_var": -0.05728064324489977, "kl": 0.011451201142112493, "entropy": 1.3000577803011293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.43943404359743, "cur_kl_coeff": 1.095970846095588, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.62577192535003, "policy_loss": 0.021848044072976337, "vf_loss": 8.567416991293431, "vf_explained_var": 0.002186000409225623, "kl": 0.03331010345718823, "entropy": 0.6834617427860697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 168.4004557156487, "episode_reward_min": -2.0876684856743637, "episode_reward_mean": 81.81064590885372, "episode_len_mean": 112.15, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 11215, "policy_reward_min": {"agent_policy": -1.0438342428371818, "adversary_policy": -12.68210417456693}, "policy_reward_max": {"agent_policy": 84.20022785782436, "adversary_policy": 50.8775345954831}, "policy_reward_mean": {"agent_policy": 40.90532295442686, "adversary_policy": 20.452661477213432}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.19723690221338, 84.63686793561484, 109.46179701187415, 151.61378516028657, 71.73962461002935, 22.162747328413733, 91.71811769994613, 78.75527912911578, 115.94534165572351, 117.05267968415299, 109.89692360438497, 91.4524440060235, 69.14687619794167, 67.14814484098389, 62.438757285999785, 64.36418073012831, 80.37964033598111, 46.02008022062733, 114.45547305992716, 74.37285016374437, 64.97703695989449, 70.2495135007517, 77.24316261529249, 36.73751932737268, 103.82694606273591, 140.4045833930165, 157.22023502938416, 126.51052953064931, 57.626930329138816, 144.7013435462016, 89.97201067253025, 103.45052045085585, 117.7352744150547, 59.67320124137832, 116.94110056831215, 142.99094999205198, 49.62332347561305, -2.0876684856743637, 41.272832561008144, 99.0232211461605, 20.76262308230391, 68.4860926645589, 37.658840401611, 95.85812555754868, 68.53625452364612, 70.95554276340502, 24.127110974311258, 124.77887786554223, 50.45913155196187, 96.28579972067686, 53.0734109048647, 128.75493791195728, 125.82725565193368, 78.09539470584974, 85.27784663698992, 14.73843035523744, 129.423160273774, 78.74819586164415, 111.87230691443474, 161.66258153124508, 142.86881237475677, 85.89815963844802, 28.65307687127723, 62.26396737582195, 100.5823775932809, 54.63676548267129, 118.28604599080009, 168.4004557156487, 68.4686519840363, 56.62797973925443, 88.11833252575718, 125.17038112094212, 13.760397757221789, 58.63067227275209, 27.83231351053202, 41.35940820957431, 28.78244730749432, 80.62150088964769, 51.62256720256556, 80.67257040912433, 55.714415829299455, 72.7050262806936, 74.81744825455817, 5.249651004881842, 112.4926463286814, 146.37061846111962, 56.59426306410356, 35.70784449760291, 73.95735336387486, 56.02659695339611, 139.91021229338054, 85.99627955487986, 35.53356167244455, 23.232314901125307, 129.6306118017494, 129.85480294159694, 72.47633250318205, 34.32838316120825, 48.138801528860625, 121.63720876878975], "episode_lengths": [146, 75, 200, 137, 112, 26, 68, 112, 130, 126, 148, 106, 137, 87, 71, 95, 97, 110, 153, 87, 100, 107, 123, 21, 134, 177, 130, 121, 140, 90, 127, 158, 96, 90, 99, 200, 52, 50, 95, 139, 85, 49, 58, 176, 122, 61, 144, 81, 200, 62, 165, 142, 118, 41, 135, 76, 124, 111, 82, 165, 111, 89, 100, 144, 117, 133, 143, 171, 118, 102, 27, 140, 44, 152, 101, 145, 83, 143, 54, 177, 56, 63, 94, 16, 139, 196, 45, 34, 98, 90, 197, 196, 80, 137, 143, 200, 125, 102, 79, 162], "policy_agent_policy_reward": [70.59861845110666, 42.31843396780742, 54.73089850593706, 75.80689258014327, 35.869812305014676, 11.081373664206867, 45.85905884997308, 39.37763956455789, 57.97267082786177, 58.5263398420765, 54.94846180219248, 45.72622200301174, 34.573438098970826, 33.574072420491945, 31.2193786429999, 32.182090365064155, 40.189820167990554, 23.010040110313653, 57.22773652996361, 37.18642508187219, 32.488518479947246, 35.12475675037585, 38.62158130764624, 18.36875966368634, 51.91347303136798, 70.20229169650824, 78.6101175146921, 63.25526476532467, 28.813465164569397, 72.3506717731008, 44.986005336265094, 51.72526022542793, 58.867637207527345, 29.83660062068917, 58.470550284156026, 71.49547499602599, 24.81166173780651, -1.0438342428371818, 20.636416280504072, 49.51161057308026, 10.381311541151957, 34.24304633227945, 18.829420200805494, 47.92906277877432, 34.268127261823054, 35.477771381702524, 12.063555487155632, 62.38943893277114, 25.229565775980948, 48.14289986033843, 26.536705452432358, 64.37746895597866, 62.913627825966834, 39.047697352924885, 42.63892331849496, 7.369215177618717, 64.71158013688694, 39.374097930822074, 55.93615345721737, 80.83129076562255, 71.43440618737841, 42.949079819224, 14.326538435638614, 31.131983687910967, 50.2911887966404, 27.318382741335657, 59.14302299540008, 84.20022785782436, 34.23432599201815, 28.313989869627214, 44.059166262878605, 62.585190560471034, 6.880198878610887, 29.315336136376033, 13.916156755266012, 20.679704104787128, 14.391223653747161, 40.31075044482384, 25.81128360128279, 40.336285204562174, 27.85720791464971, 36.35251314034677, 37.408724127279086, 2.624825502440921, 56.246323164340716, 73.18530923055982, 28.29713153205177, 17.853922248801457, 36.97867668193745, 28.01329847669806, 69.9551061466903, 42.99813977743992, 17.76678083622227, 11.61615745056266, 64.81530590087472, 64.92740147079844, 36.238166251591025, 17.164191580604136, 24.0694007644303, 60.81860438439486], "policy_adversary_policy_reward": [35.90572513457814, 34.69289331652853, 13.550471001569754, 28.767962966237675, 19.53161374886604, 35.19928475707103, 31.480826434455118, 44.32606614568814, 29.208743951775006, 6.661068353239671, 15.547394607729869, -4.466020943522999, 22.591018223521946, 23.268040626451146, 14.829674258106486, 24.547965306451406, 32.37702928454975, 25.595641543312006, 34.66051997344719, 23.865819868629316, 25.773221399681752, 29.175240402510727, 21.56402530787493, 24.162196695136803, 16.088617640664623, 18.484820458306203, 2.399438127731268, 31.174634292760675, 18.511211081176626, 12.708167561823274, 24.14100927527914, 8.04108108978501, 18.96551744825109, 21.224302719739462, 1.491524510751784, 21.51851559956188, 19.47287596630619, 37.7548605636574, 19.98513068411973, 17.201294397752463, 15.25532755204102, 17.233190927906232, 27.348916724049126, 7.775840026326721, 28.06795708566709, 10.553624221979156, 10.039827328440218, 8.328932335246122, 24.22192516375449, 27.691547867613487, 28.890794016326222, 41.311497680182, 50.8775345954831, 27.732582919208998, 35.01945089276305, 28.235813872561614, 8.721019010422111, 20.092446154147286, 41.12938943240831, 31.221282340692476, 25.29208262855, 19.69392270771509, 36.92388555954365, 14.801374665884278, 43.224737424591495, 15.642899782935846, 16.04490891702132, 13.791691703667848, 18.7931028466216, 39.67744743753443, 35.3470397923047, 36.148435203721306, 33.93682430708582, -9.125162569279311, 11.638269931729754, -12.68210417456693, 11.393802607011526, 9.242613673492547, 30.087638458564406, 19.423972114515852, 2.847398076556292, 7.533913464595667, 14.076066437016815, 20.166979895262635, 13.235534368623743, 5.593885832181752, 16.694606273278858, 31.234456505495473, 31.692228757862175, 2.575898503960868, 14.865005118194409, 20.61276626350812, 14.855089967058742, -2.791534479903108, 37.752736239338844, 24.636702693432284, 21.289672476659703, 3.9398932993212448, 22.44063090534437, 25.702268954994068, 10.104924382481315, 16.431781069951043, 22.171463530360246, 42.2060054256184, 39.83582112574485, 23.077806700221963, 12.944341037555809, 26.103356315369084, 21.569450528618454, 21.06947278987651, 10.294589918365716, -2.925374740747001, 36.56865379432751, 28.142926342559463, 28.52558793754159, 10.848509993280487, 29.33121952933061, 26.604933927886762, 34.168010754925966, 46.663280010696596, 36.07362556231568, 35.36078062506275, 19.51273660448225, 23.436343214741747, 7.812726842556831, 6.513811593081782, 9.330774985704846, 21.801208702206118, 26.02483072982256, 24.26635806681786, 1.0177009421180756, 26.300681799217582, 14.664366823082727, 44.478656172317336, 40.45210096254252, 43.74812689528183, 18.506418561199673, 15.727907430818476, 36.654144512682755, -8.340154643055547, 18.701713203659473, 25.357453059219125, 21.399009867835744, 41.18618069263529, 5.8727808207194165, 1.0074180578914724, 22.48413432664524, 6.831201809730793, 5.609673848333884, 8.306482906932128, 7.4712642405136656, 13.208439864273466, 26.16551149406373, -11.774287840316568, 7.853744577098876, 32.45700586772497, 14.778790856958453, 11.032492744324333, 23.985781070936746, 16.350504133625424, 36.062228056381315, -8.205020141731605, 5.8017195971154365, 30.550793543231368, 23.3049230821205, 14.103801045158573, 9.98108881849043, -7.35626331604951, 28.763049724753905, 27.483273439586796, 46.75482467627904, 26.430484554280774, -0.19096430812326304, 28.488095840175035, 13.779973687268672, 4.073948561532788, 26.403803196852515, 10.574873485084932, 7.720782822324388, 20.292515654373673, 45.71640665097347, 24.238699495716823, 24.911244507522625, 18.086895269917292, 8.425308154965599, 9.341472681256676, 10.61145080926314, 1.0047066412995171, 46.131721608212885, 18.683584292661827, 48.048745117766856, 16.878656353031584, 29.067113697958288, 7.171052553632737, 1.1663824699497916, 15.997809110654348, 16.844938887169796, 7.224461877260506, 24.314092820913135, 36.50451156348173]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38776575887988324, "mean_inference_ms": 0.9617561920132723, "mean_action_processing_ms": 0.16491655144833292, "mean_env_wait_ms": 0.056923485979069134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003548145294189453, "StateBufferConnector_ms": 0.0024384260177612305, "ViewRequirementAgentConnector_ms": 0.0687631368637085}, "num_episodes": 37, "episode_return_max": 168.4004557156487, "episode_return_min": -2.0876684856743637, "episode_return_mean": 81.81064590885372}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.32628132455073, "num_env_steps_trained_throughput_per_sec": 487.32628132455073, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 8217.258, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8217.223, "sample_time_ms": 745.595, "learn_time_ms": 7459.987, "learn_throughput": 536.194, "synch_weights_time_ms": 11.138}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 70, "trial_id": "eaa30_00000", "date": "2024-08-09_17-49-50", "timestamp": 1723240190, "time_this_iter_s": 8.213450908660889, "time_total_s": 577.5004291534424, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2896040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 577.5004291534424, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 26.875000000000004, "ram_util_percent": 79.64166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.048577294920487, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.410819623836134, "policy_loss": 0.002171276526762143, "vf_loss": 7.404898970467704, "vf_explained_var": -0.043427682049059994, "kl": 0.009247296728765366, "entropy": 1.2991635921770934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7129894607312357, "cur_kl_coeff": 1.6439562691433816, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.254234534502029, "policy_loss": 0.010168561340105953, "vf_loss": 8.21625971744458, "vf_explained_var": 0.00023011304438114166, "kl": 0.01691421897169979, "entropy": 0.6959426139791807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "env_runners": {"episode_reward_max": 168.4004557156487, "episode_reward_min": -2.0876684856743637, "episode_reward_mean": 78.83587002340231, "episode_len_mean": 115.64, "episode_media": {}, "episodes_this_iter": 29, "episodes_timesteps_total": 11564, "policy_reward_min": {"agent_policy": -1.0438342428371818, "adversary_policy": -12.68210417456693}, "policy_reward_max": {"agent_policy": 84.20022785782436, "adversary_policy": 53.6480956977646}, "policy_reward_mean": {"agent_policy": 39.417935011701154, "adversary_policy": 19.708967505850577}, "custom_metrics": {}, "hist_stats": {"episode_reward": [144.7013435462016, 89.97201067253025, 103.45052045085585, 117.7352744150547, 59.67320124137832, 116.94110056831215, 142.99094999205198, 49.62332347561305, -2.0876684856743637, 41.272832561008144, 99.0232211461605, 20.76262308230391, 68.4860926645589, 37.658840401611, 95.85812555754868, 68.53625452364612, 70.95554276340502, 24.127110974311258, 124.77887786554223, 50.45913155196187, 96.28579972067686, 53.0734109048647, 128.75493791195728, 125.82725565193368, 78.09539470584974, 85.27784663698992, 14.73843035523744, 129.423160273774, 78.74819586164415, 111.87230691443474, 161.66258153124508, 142.86881237475677, 85.89815963844802, 28.65307687127723, 62.26396737582195, 100.5823775932809, 54.63676548267129, 118.28604599080009, 168.4004557156487, 68.4686519840363, 56.62797973925443, 88.11833252575718, 125.17038112094212, 13.760397757221789, 58.63067227275209, 27.83231351053202, 41.35940820957431, 28.78244730749432, 80.62150088964769, 51.62256720256556, 80.67257040912433, 55.714415829299455, 72.7050262806936, 74.81744825455817, 5.249651004881842, 112.4926463286814, 146.37061846111962, 56.59426306410356, 35.70784449760291, 73.95735336387486, 56.02659695339611, 139.91021229338054, 85.99627955487986, 35.53356167244455, 23.232314901125307, 129.6306118017494, 129.85480294159694, 72.47633250318205, 34.32838316120825, 48.138801528860625, 121.63720876878975, 115.65920524872593, 25.141111782827327, 139.8898564044932, 136.807106546563, 105.51314557897777, 75.74070108286523, 136.0187919859357, 116.98069797231379, 67.83067083873155, 160.3637109100399, 39.82045751577685, 47.933250065951626, 22.114924747062155, 156.38716432008746, 98.5685754034835, 113.64291510976574, 80.28889391212246, 51.65213606791548, 54.423083421216646, 17.76910597124327, 39.612933239830014, 53.64629754298373, 25.838700149738745, 36.09865399258217, 108.03110841590329, 93.94483977362337, 44.892711460511315, 72.66374037306221, 64.0032259318738], "episode_lengths": [90, 127, 158, 96, 90, 99, 200, 52, 50, 95, 139, 85, 49, 58, 176, 122, 61, 144, 81, 200, 62, 165, 142, 118, 41, 135, 76, 124, 111, 82, 165, 111, 89, 100, 144, 117, 133, 143, 171, 118, 102, 27, 140, 44, 152, 101, 145, 83, 143, 54, 177, 56, 63, 94, 16, 139, 196, 45, 34, 98, 90, 197, 196, 80, 137, 143, 200, 125, 102, 79, 162, 200, 109, 81, 128, 88, 135, 48, 200, 106, 143, 84, 68, 200, 175, 200, 106, 181, 116, 82, 15, 56, 124, 78, 43, 192, 190, 200, 77, 200], "policy_agent_policy_reward": [72.3506717731008, 44.986005336265094, 51.72526022542793, 58.867637207527345, 29.83660062068917, 58.470550284156026, 71.49547499602599, 24.81166173780651, -1.0438342428371818, 20.636416280504072, 49.51161057308026, 10.381311541151957, 34.24304633227945, 18.829420200805494, 47.92906277877432, 34.268127261823054, 35.477771381702524, 12.063555487155632, 62.38943893277114, 25.229565775980948, 48.14289986033843, 26.536705452432358, 64.37746895597866, 62.913627825966834, 39.047697352924885, 42.63892331849496, 7.369215177618717, 64.71158013688694, 39.374097930822074, 55.93615345721737, 80.83129076562255, 71.43440618737841, 42.949079819224, 14.326538435638614, 31.131983687910967, 50.2911887966404, 27.318382741335657, 59.14302299540008, 84.20022785782436, 34.23432599201815, 28.313989869627214, 44.059166262878605, 62.585190560471034, 6.880198878610887, 29.315336136376033, 13.916156755266012, 20.679704104787128, 14.391223653747161, 40.31075044482384, 25.81128360128279, 40.336285204562174, 27.85720791464971, 36.35251314034677, 37.408724127279086, 2.624825502440921, 56.246323164340716, 73.18530923055982, 28.29713153205177, 17.853922248801457, 36.97867668193745, 28.01329847669806, 69.9551061466903, 42.99813977743992, 17.76678083622227, 11.61615745056266, 64.81530590087472, 64.92740147079844, 36.238166251591025, 17.164191580604136, 24.0694007644303, 60.81860438439486, 57.82960262436294, 12.57055589141368, 69.94492820224659, 68.40355327328155, 52.756572789488864, 37.870350541432614, 68.00939599296788, 58.490348986156896, 33.91533541936578, 80.18185545501991, 19.91022875788843, 23.966625032975816, 11.057462373531077, 78.19358216004377, 49.28428770174175, 56.82145755488284, 40.14444695606123, 25.826068033957718, 27.211541710608323, 8.884552985621635, 19.80646661991501, 26.823148771491873, 12.91935007486937, 18.049326996291086, 54.01555420795164, 46.97241988681168, 22.446355730255657, 36.3318701865311, 32.0016129659369], "policy_adversary_policy_reward": [41.12938943240831, 31.221282340692476, 25.29208262855, 19.69392270771509, 36.92388555954365, 14.801374665884278, 43.224737424591495, 15.642899782935846, 16.04490891702132, 13.791691703667848, 18.7931028466216, 39.67744743753443, 35.3470397923047, 36.148435203721306, 33.93682430708582, -9.125162569279311, 11.638269931729754, -12.68210417456693, 11.393802607011526, 9.242613673492547, 30.087638458564406, 19.423972114515852, 2.847398076556292, 7.533913464595667, 14.076066437016815, 20.166979895262635, 13.235534368623743, 5.593885832181752, 16.694606273278858, 31.234456505495473, 31.692228757862175, 2.575898503960868, 14.865005118194409, 20.61276626350812, 14.855089967058742, -2.791534479903108, 37.752736239338844, 24.636702693432284, 21.289672476659703, 3.9398932993212448, 22.44063090534437, 25.702268954994068, 10.104924382481315, 16.431781069951043, 22.171463530360246, 42.2060054256184, 39.83582112574485, 23.077806700221963, 12.944341037555809, 26.103356315369084, 21.569450528618454, 21.06947278987651, 10.294589918365716, -2.925374740747001, 36.56865379432751, 28.142926342559463, 28.52558793754159, 10.848509993280487, 29.33121952933061, 26.604933927886762, 34.168010754925966, 46.663280010696596, 36.07362556231568, 35.36078062506275, 19.51273660448225, 23.436343214741747, 7.812726842556831, 6.513811593081782, 9.330774985704846, 21.801208702206118, 26.02483072982256, 24.26635806681786, 1.0177009421180756, 26.300681799217582, 14.664366823082727, 44.478656172317336, 40.45210096254252, 43.74812689528183, 18.506418561199673, 15.727907430818476, 36.654144512682755, -8.340154643055547, 18.701713203659473, 25.357453059219125, 21.399009867835744, 41.18618069263529, 5.8727808207194165, 1.0074180578914724, 22.48413432664524, 6.831201809730793, 5.609673848333884, 8.306482906932128, 7.4712642405136656, 13.208439864273466, 26.16551149406373, -11.774287840316568, 7.853744577098876, 32.45700586772497, 14.778790856958453, 11.032492744324333, 23.985781070936746, 16.350504133625424, 36.062228056381315, -8.205020141731605, 5.8017195971154365, 30.550793543231368, 23.3049230821205, 14.103801045158573, 9.98108881849043, -7.35626331604951, 28.763049724753905, 27.483273439586796, 46.75482467627904, 26.430484554280774, -0.19096430812326304, 28.488095840175035, 13.779973687268672, 4.073948561532788, 26.403803196852515, 10.574873485084932, 7.720782822324388, 20.292515654373673, 45.71640665097347, 24.238699495716823, 24.911244507522625, 18.086895269917292, 8.425308154965599, 9.341472681256676, 10.61145080926314, 1.0047066412995171, 46.131721608212885, 18.683584292661827, 48.048745117766856, 16.878656353031584, 29.067113697958288, 7.171052553632737, 1.1663824699497916, 15.997809110654348, 16.844938887169796, 7.224461877260506, 24.314092820913135, 36.50451156348173, 34.736086667859404, 23.09351595650355, 7.0676978297561135, 5.502858061657559, 23.86431657997053, 46.080611622276066, 14.75545757551693, 53.6480956977646, 25.829251714884695, 26.927321074604173, 18.015477385619334, 19.85487315581328, 36.25618224062564, 31.75321375234223, 9.235740263481967, 49.25460872267493, 6.9625616388677045, 26.952773780498074, 40.38152108352396, 39.800334371495985, 9.1477711346556, 10.762457623232834, 13.647277391215116, 10.3193476417607, -2.6027819140833035, 13.660244287614383, 46.71119310183668, 31.482389058207097, 24.942937781316367, 24.34134992042539, 24.492021266444603, 32.329436288438245, 16.84433447506818, 23.30011248099305, 5.938677877843885, 19.887390156113838, 15.574047543744896, 11.637494166863426, 2.3269285437078864, 6.557624441913749, 21.347425478936675, -1.5409588590216643, 14.200948345255735, 12.622200426236141, 3.4251988730165657, 9.494151201852805, 3.891991049353944, 14.157335946937142, 32.652408698891335, 21.363145509060292, 25.301079181850326, 21.67134070496135, 25.67178180457919, -3.2254260743235363, 18.311386128830755, 18.020484057700344, 19.989307964111976, 12.012305001824924]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38787445770512735, "mean_inference_ms": 0.9604836565179906, "mean_action_processing_ms": 0.16488323270473113, "mean_env_wait_ms": 0.05691648136964009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035834312438964844, "StateBufferConnector_ms": 0.0024623870849609375, "ViewRequirementAgentConnector_ms": 0.06905198097229004}, "num_episodes": 29, "episode_return_max": 168.4004557156487, "episode_return_min": -2.0876684856743637, "episode_return_mean": 78.83587002340231}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.38352895644357, "num_env_steps_trained_throughput_per_sec": 505.38352895644357, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 852000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 8185.66, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8185.625, "sample_time_ms": 742.339, "learn_time_ms": 7431.511, "learn_throughput": 538.249, "synch_weights_time_ms": 11.317}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "training_iteration": 71, "trial_id": "eaa30_00000", "date": "2024-08-09_17-49-58", "timestamp": 1723240198, "time_this_iter_s": 7.920108079910278, "time_total_s": 585.4205372333527, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc1dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 585.4205372333527, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 24.066666666666666, "ram_util_percent": 79.59166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.119944228634002, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.997486691500144, "policy_loss": 0.0009149522843361689, "vf_loss": 6.993175855515495, "vf_explained_var": 0.055319311032219536, "kl": 0.00837542593957137, "entropy": 1.2604584838347461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.121938885934651, "cur_kl_coeff": 1.6439562691433816, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.16486961344878, "policy_loss": 0.0060700376028156216, "vf_loss": 8.136174546182156, "vf_explained_var": 0.010778827903171381, "kl": 0.013762569172831718, "entropy": 0.6920758731663227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 175.34584670083015, "episode_reward_min": 5.249651004881842, "episode_reward_mean": 75.9957879135853, "episode_len_mean": 125.12, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 12512, "policy_reward_min": {"agent_policy": 2.624825502440921, "adversary_policy": -16.282637594872636}, "policy_reward_max": {"agent_policy": 87.67292335041508, "adversary_policy": 53.6480956977646}, "policy_reward_mean": {"agent_policy": 37.99789395679265, "adversary_policy": 18.998946978396326}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.74819586164415, 111.87230691443474, 161.66258153124508, 142.86881237475677, 85.89815963844802, 28.65307687127723, 62.26396737582195, 100.5823775932809, 54.63676548267129, 118.28604599080009, 168.4004557156487, 68.4686519840363, 56.62797973925443, 88.11833252575718, 125.17038112094212, 13.760397757221789, 58.63067227275209, 27.83231351053202, 41.35940820957431, 28.78244730749432, 80.62150088964769, 51.62256720256556, 80.67257040912433, 55.714415829299455, 72.7050262806936, 74.81744825455817, 5.249651004881842, 112.4926463286814, 146.37061846111962, 56.59426306410356, 35.70784449760291, 73.95735336387486, 56.02659695339611, 139.91021229338054, 85.99627955487986, 35.53356167244455, 23.232314901125307, 129.6306118017494, 129.85480294159694, 72.47633250318205, 34.32838316120825, 48.138801528860625, 121.63720876878975, 115.65920524872593, 25.141111782827327, 139.8898564044932, 136.807106546563, 105.51314557897777, 75.74070108286523, 136.0187919859357, 116.98069797231379, 67.83067083873155, 160.3637109100399, 39.82045751577685, 47.933250065951626, 22.114924747062155, 156.38716432008746, 98.5685754034835, 113.64291510976574, 80.28889391212246, 51.65213606791548, 54.423083421216646, 17.76910597124327, 39.612933239830014, 53.64629754298373, 25.838700149738745, 36.09865399258217, 108.03110841590329, 93.94483977362337, 44.892711460511315, 72.66374037306221, 64.0032259318738, 47.97488962817481, 61.276201896155385, 81.92763783315455, 175.34584670083015, 64.6995292512579, 137.72912317318966, 87.68838930769617, 75.81959223711394, 73.79870057009488, 120.16523375998887, 106.70167270437494, 34.22416437478442, 30.266565417132483, 51.722466728099405, 8.787404078533928, 33.180817428650286, 120.35379027908769, 94.509521534324, 55.273519287004, 72.22152115683176, 62.420520861025196, 9.912523935844737, 10.963291497091383, 5.280232253772593, 147.31624598506244, 92.23362389466455, 11.938322951449017, 78.65538542257453], "episode_lengths": [111, 82, 165, 111, 89, 100, 144, 117, 133, 143, 171, 118, 102, 27, 140, 44, 152, 101, 145, 83, 143, 54, 177, 56, 63, 94, 16, 139, 196, 45, 34, 98, 90, 197, 196, 80, 137, 143, 200, 125, 102, 79, 162, 200, 109, 81, 128, 88, 135, 48, 200, 106, 143, 84, 68, 200, 175, 200, 106, 181, 116, 82, 15, 56, 124, 78, 43, 192, 190, 200, 77, 200, 200, 200, 198, 194, 137, 132, 140, 180, 191, 114, 200, 200, 47, 78, 9, 200, 94, 200, 79, 115, 92, 11, 200, 85, 195, 195, 200, 97], "policy_agent_policy_reward": [39.374097930822074, 55.93615345721737, 80.83129076562255, 71.43440618737841, 42.949079819224, 14.326538435638614, 31.131983687910967, 50.2911887966404, 27.318382741335657, 59.14302299540008, 84.20022785782436, 34.23432599201815, 28.313989869627214, 44.059166262878605, 62.585190560471034, 6.880198878610887, 29.315336136376033, 13.916156755266012, 20.679704104787128, 14.391223653747161, 40.31075044482384, 25.81128360128279, 40.336285204562174, 27.85720791464971, 36.35251314034677, 37.408724127279086, 2.624825502440921, 56.246323164340716, 73.18530923055982, 28.29713153205177, 17.853922248801457, 36.97867668193745, 28.01329847669806, 69.9551061466903, 42.99813977743992, 17.76678083622227, 11.61615745056266, 64.81530590087472, 64.92740147079844, 36.238166251591025, 17.164191580604136, 24.0694007644303, 60.81860438439486, 57.82960262436294, 12.57055589141368, 69.94492820224659, 68.40355327328155, 52.756572789488864, 37.870350541432614, 68.00939599296788, 58.490348986156896, 33.91533541936578, 80.18185545501991, 19.91022875788843, 23.966625032975816, 11.057462373531077, 78.19358216004377, 49.28428770174175, 56.82145755488284, 40.14444695606123, 25.826068033957718, 27.211541710608323, 8.884552985621635, 19.80646661991501, 26.823148771491873, 12.91935007486937, 18.049326996291086, 54.01555420795164, 46.97241988681168, 22.446355730255657, 36.3318701865311, 32.0016129659369, 23.9874448140874, 30.6381009480777, 40.96381891657726, 87.67292335041508, 32.349764625628964, 68.86456158659483, 43.8441946538481, 37.909796118556976, 36.89935028504745, 60.08261687999446, 53.35083635218747, 17.112082187392215, 15.13328270856624, 25.8612333640497, 4.393702039266965, 16.590408714325147, 60.17689513954388, 47.254760767162, 27.636759643502003, 36.11076057841585, 31.210260430512605, 4.9562619679223685, 5.481645748545695, 2.6401161268863094, 73.65812299253118, 46.11681194733228, 5.969161475724508, 39.327692711287256], "policy_adversary_policy_reward": [28.52558793754159, 10.848509993280487, 29.33121952933061, 26.604933927886762, 34.168010754925966, 46.663280010696596, 36.07362556231568, 35.36078062506275, 19.51273660448225, 23.436343214741747, 7.812726842556831, 6.513811593081782, 9.330774985704846, 21.801208702206118, 26.02483072982256, 24.26635806681786, 1.0177009421180756, 26.300681799217582, 14.664366823082727, 44.478656172317336, 40.45210096254252, 43.74812689528183, 18.506418561199673, 15.727907430818476, 36.654144512682755, -8.340154643055547, 18.701713203659473, 25.357453059219125, 21.399009867835744, 41.18618069263529, 5.8727808207194165, 1.0074180578914724, 22.48413432664524, 6.831201809730793, 5.609673848333884, 8.306482906932128, 7.4712642405136656, 13.208439864273466, 26.16551149406373, -11.774287840316568, 7.853744577098876, 32.45700586772497, 14.778790856958453, 11.032492744324333, 23.985781070936746, 16.350504133625424, 36.062228056381315, -8.205020141731605, 5.8017195971154365, 30.550793543231368, 23.3049230821205, 14.103801045158573, 9.98108881849043, -7.35626331604951, 28.763049724753905, 27.483273439586796, 46.75482467627904, 26.430484554280774, -0.19096430812326304, 28.488095840175035, 13.779973687268672, 4.073948561532788, 26.403803196852515, 10.574873485084932, 7.720782822324388, 20.292515654373673, 45.71640665097347, 24.238699495716823, 24.911244507522625, 18.086895269917292, 8.425308154965599, 9.341472681256676, 10.61145080926314, 1.0047066412995171, 46.131721608212885, 18.683584292661827, 48.048745117766856, 16.878656353031584, 29.067113697958288, 7.171052553632737, 1.1663824699497916, 15.997809110654348, 16.844938887169796, 7.224461877260506, 24.314092820913135, 36.50451156348173, 34.736086667859404, 23.09351595650355, 7.0676978297561135, 5.502858061657559, 23.86431657997053, 46.080611622276066, 14.75545757551693, 53.6480956977646, 25.829251714884695, 26.927321074604173, 18.015477385619334, 19.85487315581328, 36.25618224062564, 31.75321375234223, 9.235740263481967, 49.25460872267493, 6.9625616388677045, 26.952773780498074, 40.38152108352396, 39.800334371495985, 9.1477711346556, 10.762457623232834, 13.647277391215116, 10.3193476417607, -2.6027819140833035, 13.660244287614383, 46.71119310183668, 31.482389058207097, 24.942937781316367, 24.34134992042539, 24.492021266444603, 32.329436288438245, 16.84433447506818, 23.30011248099305, 5.938677877843885, 19.887390156113838, 15.574047543744896, 11.637494166863426, 2.3269285437078864, 6.557624441913749, 21.347425478936675, -1.5409588590216643, 14.200948345255735, 12.622200426236141, 3.4251988730165657, 9.494151201852805, 3.891991049353944, 14.157335946937142, 32.652408698891335, 21.363145509060292, 25.301079181850326, 21.67134070496135, 25.67178180457919, -3.2254260743235363, 18.311386128830755, 18.020484057700344, 19.989307964111976, 12.012305001824924, 10.849987006167222, 13.137457807920178, 30.843668967374995, -0.20556801929730106, 26.96425014322515, 13.999568773352102, 38.388444593229615, 49.28447875718546, 16.26478362238892, 16.084981003240042, 23.450691814829053, 45.413869771765775, 21.172813957381607, 22.671380696466496, 24.404633666467316, 13.50516245208966, 8.02595181057676, 28.8733984744707, 32.45306224417071, 27.629554635823776, 21.63043397441818, 31.72040237776929, 2.4937387686111983, 14.618343418781016, 31.415920303438874, -16.282637594872636, 14.161453200442061, 11.699780163607638, 1.369058826003073, 3.0246432132638916, 10.691659855223815, 5.898748859101332, 28.054652189129733, 32.122242950414126, 19.381297820570573, 27.873462946591424, 18.308259506381606, 9.328500137120397, 18.290164004668213, 17.820596573747636, 25.739407114872325, 5.470853315640282, 6.963755234820612, -2.007493266898244, 0.770516787490223, 4.711128961055472, 7.479904612237262, -4.8397884853509545, 36.95287303946159, 36.7052499530696, 18.649927233978243, 27.466884713354034, -6.760450384254458, 12.729611859978966, 25.132767820572095, 14.19492489071516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.387847936429798, "mean_inference_ms": 0.9613264133919834, "mean_action_processing_ms": 0.16476037433197419, "mean_env_wait_ms": 0.05680790183158815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003606557846069336, "StateBufferConnector_ms": 0.0024895668029785156, "ViewRequirementAgentConnector_ms": 0.06824564933776855}, "num_episodes": 28, "episode_return_max": 175.34584670083015, "episode_return_min": 5.249651004881842, "episode_return_mean": 75.9957879135853}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.4579475933445, "num_env_steps_trained_throughput_per_sec": 499.4579475933445, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 8180.163, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8180.129, "sample_time_ms": 742.333, "learn_time_ms": 7425.888, "learn_throughput": 538.656, "synch_weights_time_ms": 11.452}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 72, "trial_id": "eaa30_00000", "date": "2024-08-09_17-50-06", "timestamp": 1723240206, "time_this_iter_s": 8.01377010345459, "time_total_s": 593.4343073368073, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2896430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 593.4343073368073, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 23.872727272727275, "ram_util_percent": 79.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.476845627423947, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.300882966934688, "policy_loss": 0.0024003345442925967, "vf_loss": 6.295355671928043, "vf_explained_var": 0.028428275749166176, "kl": 0.007712151704937535, "entropy": 1.2098371721449352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.435701120489587, "cur_kl_coeff": 1.6439562691433816, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.525820310413837, "policy_loss": 0.009084044583626867, "vf_loss": 7.502835483849049, "vf_explained_var": -0.002243607056637605, "kl": 0.008455686054367107, "entropy": 0.6800752878809969, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "env_runners": {"episode_reward_max": 175.34584670083015, "episode_reward_min": 2.190422034065695, "episode_reward_mean": 72.22313859053638, "episode_len_mean": 132.84, "episode_media": {}, "episodes_this_iter": 33, "episodes_timesteps_total": 13284, "policy_reward_min": {"agent_policy": 1.0952110170328475, "adversary_policy": -16.282637594872636}, "policy_reward_max": {"agent_policy": 87.67292335041508, "adversary_policy": 53.6480956977646}, "policy_reward_mean": {"agent_policy": 36.11156929526819, "adversary_policy": 18.055784647634095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.91021229338054, 85.99627955487986, 35.53356167244455, 23.232314901125307, 129.6306118017494, 129.85480294159694, 72.47633250318205, 34.32838316120825, 48.138801528860625, 121.63720876878975, 115.65920524872593, 25.141111782827327, 139.8898564044932, 136.807106546563, 105.51314557897777, 75.74070108286523, 136.0187919859357, 116.98069797231379, 67.83067083873155, 160.3637109100399, 39.82045751577685, 47.933250065951626, 22.114924747062155, 156.38716432008746, 98.5685754034835, 113.64291510976574, 80.28889391212246, 51.65213606791548, 54.423083421216646, 17.76910597124327, 39.612933239830014, 53.64629754298373, 25.838700149738745, 36.09865399258217, 108.03110841590329, 93.94483977362337, 44.892711460511315, 72.66374037306221, 64.0032259318738, 47.97488962817481, 61.276201896155385, 81.92763783315455, 175.34584670083015, 64.6995292512579, 137.72912317318966, 87.68838930769617, 75.81959223711394, 73.79870057009488, 120.16523375998887, 106.70167270437494, 34.22416437478442, 30.266565417132483, 51.722466728099405, 8.787404078533928, 33.180817428650286, 120.35379027908769, 94.509521534324, 55.273519287004, 72.22152115683176, 62.420520861025196, 9.912523935844737, 10.963291497091383, 5.280232253772593, 147.31624598506244, 92.23362389466455, 11.938322951449017, 78.65538542257453, 104.80627869893371, 106.48893552240571, 21.90673057402072, 87.23166934290977, 2.190422034065695, 48.77625906141985, 29.69668249806218, 59.89344296093488, 50.96612860438725, 83.04025506391376, 100.7224258824067, 34.81815252998781, 59.62903767002098, 50.9330606470498, 60.562156599095516, 50.56065768598498, 112.44938828847768, 65.63630055219735, 86.64232705723374, 22.238213862690287, 72.33820538016512, 65.67792147138113, 108.1035599213188, 22.985115845891414, 40.40014004524649, 105.30638189411474, 64.4573152633228, 64.60601009405876, 19.30837071721779, 73.45941510287905, 166.1679310846752, 19.943201055010608, 85.96880700076943], "episode_lengths": [197, 196, 80, 137, 143, 200, 125, 102, 79, 162, 200, 109, 81, 128, 88, 135, 48, 200, 106, 143, 84, 68, 200, 175, 200, 106, 181, 116, 82, 15, 56, 124, 78, 43, 192, 190, 200, 77, 200, 200, 200, 198, 194, 137, 132, 140, 180, 191, 114, 200, 200, 47, 78, 9, 200, 94, 200, 79, 115, 92, 11, 200, 85, 195, 195, 200, 97, 200, 109, 200, 53, 1, 86, 77, 72, 200, 200, 58, 20, 81, 200, 200, 200, 200, 200, 75, 200, 128, 88, 119, 14, 40, 200, 112, 92, 200, 82, 148, 200, 200], "policy_agent_policy_reward": [69.9551061466903, 42.99813977743992, 17.76678083622227, 11.61615745056266, 64.81530590087472, 64.92740147079844, 36.238166251591025, 17.164191580604136, 24.0694007644303, 60.81860438439486, 57.82960262436294, 12.57055589141368, 69.94492820224659, 68.40355327328155, 52.756572789488864, 37.870350541432614, 68.00939599296788, 58.490348986156896, 33.91533541936578, 80.18185545501991, 19.91022875788843, 23.966625032975816, 11.057462373531077, 78.19358216004377, 49.28428770174175, 56.82145755488284, 40.14444695606123, 25.826068033957718, 27.211541710608323, 8.884552985621635, 19.80646661991501, 26.823148771491873, 12.91935007486937, 18.049326996291086, 54.01555420795164, 46.97241988681168, 22.446355730255657, 36.3318701865311, 32.0016129659369, 23.9874448140874, 30.6381009480777, 40.96381891657726, 87.67292335041508, 32.349764625628964, 68.86456158659483, 43.8441946538481, 37.909796118556976, 36.89935028504745, 60.08261687999446, 53.35083635218747, 17.112082187392215, 15.13328270856624, 25.8612333640497, 4.393702039266965, 16.590408714325147, 60.17689513954388, 47.254760767162, 27.636759643502003, 36.11076057841585, 31.210260430512605, 4.9562619679223685, 5.481645748545695, 2.6401161268863094, 73.65812299253118, 46.11681194733228, 5.969161475724508, 39.327692711287256, 52.403139349466855, 53.244467761202856, 10.953365287010364, 43.61583467145489, 1.0952110170328475, 24.3881295307099, 14.848341249031092, 29.946721480467435, 25.483064302193632, 41.520127531956895, 50.36121294120336, 17.40907626499391, 29.81451883501049, 25.466530323524882, 30.281078299547758, 25.28032884299249, 56.22469414423884, 32.81815027609868, 43.32116352861686, 11.119106931345144, 36.16910269008255, 32.83896073569058, 54.051779960659395, 11.492557922945707, 20.20007002262324, 52.65319094705736, 32.228657631661406, 32.30300504702939, 9.654185358608895, 36.72970755143953, 83.08396554233762, 9.971600527505295, 42.98440350038471], "policy_adversary_policy_reward": [45.71640665097347, 24.238699495716823, 24.911244507522625, 18.086895269917292, 8.425308154965599, 9.341472681256676, 10.61145080926314, 1.0047066412995171, 46.131721608212885, 18.683584292661827, 48.048745117766856, 16.878656353031584, 29.067113697958288, 7.171052553632737, 1.1663824699497916, 15.997809110654348, 16.844938887169796, 7.224461877260506, 24.314092820913135, 36.50451156348173, 34.736086667859404, 23.09351595650355, 7.0676978297561135, 5.502858061657559, 23.86431657997053, 46.080611622276066, 14.75545757551693, 53.6480956977646, 25.829251714884695, 26.927321074604173, 18.015477385619334, 19.85487315581328, 36.25618224062564, 31.75321375234223, 9.235740263481967, 49.25460872267493, 6.9625616388677045, 26.952773780498074, 40.38152108352396, 39.800334371495985, 9.1477711346556, 10.762457623232834, 13.647277391215116, 10.3193476417607, -2.6027819140833035, 13.660244287614383, 46.71119310183668, 31.482389058207097, 24.942937781316367, 24.34134992042539, 24.492021266444603, 32.329436288438245, 16.84433447506818, 23.30011248099305, 5.938677877843885, 19.887390156113838, 15.574047543744896, 11.637494166863426, 2.3269285437078864, 6.557624441913749, 21.347425478936675, -1.5409588590216643, 14.200948345255735, 12.622200426236141, 3.4251988730165657, 9.494151201852805, 3.891991049353944, 14.157335946937142, 32.652408698891335, 21.363145509060292, 25.301079181850326, 21.67134070496135, 25.67178180457919, -3.2254260743235363, 18.311386128830755, 18.020484057700344, 19.989307964111976, 12.012305001824924, 10.849987006167222, 13.137457807920178, 30.843668967374995, -0.20556801929730106, 26.96425014322515, 13.999568773352102, 38.388444593229615, 49.28447875718546, 16.26478362238892, 16.084981003240042, 23.450691814829053, 45.413869771765775, 21.172813957381607, 22.671380696466496, 24.404633666467316, 13.50516245208966, 8.02595181057676, 28.8733984744707, 32.45306224417071, 27.629554635823776, 21.63043397441818, 31.72040237776929, 2.4937387686111983, 14.618343418781016, 31.415920303438874, -16.282637594872636, 14.161453200442061, 11.699780163607638, 1.369058826003073, 3.0246432132638916, 10.691659855223815, 5.898748859101332, 28.054652189129733, 32.122242950414126, 19.381297820570573, 27.873462946591424, 18.308259506381606, 9.328500137120397, 18.290164004668213, 17.820596573747636, 25.739407114872325, 5.470853315640282, 6.963755234820612, -2.007493266898244, 0.770516787490223, 4.711128961055472, 7.479904612237262, -4.8397884853509545, 36.95287303946159, 36.7052499530696, 18.649927233978243, 27.466884713354034, -6.760450384254458, 12.729611859978966, 25.132767820572095, 14.19492489071516, 25.746963238290995, 26.656176111175867, 23.72354013419349, 29.520927627009367, 8.25921126523601, 2.694154021774354, 14.378318626864846, 29.237516044590034, 0.25713377816661875, 0.8380772388662288, 14.014529035518102, 10.373600495191804, 9.844509878074094, 5.003831370957002, 9.620068576855022, 20.326652903612413, 3.432409921258106, 22.050654380935526, 23.308864622245572, 18.211262909711323, 17.72996458132116, 32.63124835988221, 7.752174587193199, 9.656901677800711, 19.736241939780022, 10.078276895230475, 7.378448070015153, 18.088082253509732, 30.167224632957158, 0.11385366659060026, 7.546191549347462, 17.734137293645027, 25.12860888927932, 31.09608525495952, 22.79170454154504, 10.026445734553636, 27.495985269720222, 15.825178258896667, -6.982398534236275, 18.10150546558142, 27.94653562945098, 8.222567060631569, 25.769482075229774, 7.069478660460807, 22.392499700980018, 31.659280259679377, 2.635359122968797, 8.85719879997691, 11.360502911845678, 8.839567110777562, 25.998293556071467, 26.654897390985894, 19.633194906707246, 12.595462724954158, 12.193752181312654, 20.109252865716734, 12.92482576477805, -3.2706404061691536, 11.62795823613983, 25.101749315299696, 38.82075247151389, 44.2632130708237, -1.5297758290602488, 11.501376356565537, 34.551751994457284, 8.43265150592743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38782455263163, "mean_inference_ms": 0.9600867450657671, "mean_action_processing_ms": 0.1650796844291651, "mean_env_wait_ms": 0.05676700922741088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003744840621948242, "StateBufferConnector_ms": 0.0026433467864990234, "ViewRequirementAgentConnector_ms": 0.06666147708892822}, "num_episodes": 33, "episode_return_max": 175.34584670083015, "episode_return_min": 2.190422034065695, "episode_return_mean": 72.22313859053638}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 463.7875259596867, "num_env_steps_trained_throughput_per_sec": 463.7875259596867, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 876000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 8222.116, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8222.081, "sample_time_ms": 738.505, "learn_time_ms": 7471.604, "learn_throughput": 535.36, "synch_weights_time_ms": 11.457}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "training_iteration": 73, "trial_id": "eaa30_00000", "date": "2024-08-09_17-50-15", "timestamp": 1723240215, "time_this_iter_s": 8.629103899002075, "time_total_s": 602.0634112358093, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2896670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 602.0634112358093, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 29.230769230769226, "ram_util_percent": 79.3923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.2655047543780515, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.153477873373284, "policy_loss": 0.002370503964888119, "vf_loss": 6.148456852776664, "vf_explained_var": -0.03274511581375485, "kl": 0.006537082679840741, "entropy": 1.1407719103116838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.180267030714701, "cur_kl_coeff": 1.6439562691433816, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.386823057631651, "policy_loss": 0.005506607037871921, "vf_loss": 7.36769079665343, "vf_explained_var": 0.05136461288978656, "kl": 0.008288338091612482, "entropy": 0.6575152965262532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "env_runners": {"episode_reward_max": 175.34584670083015, "episode_reward_min": -38.27510517165932, "episode_reward_mean": 67.20413541264526, "episode_len_mean": 132.23, "episode_media": {}, "episodes_this_iter": 30, "episodes_timesteps_total": 13223, "policy_reward_min": {"agent_policy": -19.137552585829653, "adversary_policy": -16.282637594872636}, "policy_reward_max": {"agent_policy": 87.67292335041508, "adversary_policy": 49.28447875718546}, "policy_reward_mean": {"agent_policy": 33.60206770632263, "adversary_policy": 16.801033853161314}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.612933239830014, 53.64629754298373, 25.838700149738745, 36.09865399258217, 108.03110841590329, 93.94483977362337, 44.892711460511315, 72.66374037306221, 64.0032259318738, 47.97488962817481, 61.276201896155385, 81.92763783315455, 175.34584670083015, 64.6995292512579, 137.72912317318966, 87.68838930769617, 75.81959223711394, 73.79870057009488, 120.16523375998887, 106.70167270437494, 34.22416437478442, 30.266565417132483, 51.722466728099405, 8.787404078533928, 33.180817428650286, 120.35379027908769, 94.509521534324, 55.273519287004, 72.22152115683176, 62.420520861025196, 9.912523935844737, 10.963291497091383, 5.280232253772593, 147.31624598506244, 92.23362389466455, 11.938322951449017, 78.65538542257453, 104.80627869893371, 106.48893552240571, 21.90673057402072, 87.23166934290977, 2.190422034065695, 48.77625906141985, 29.69668249806218, 59.89344296093488, 50.96612860438725, 83.04025506391376, 100.7224258824067, 34.81815252998781, 59.62903767002098, 50.9330606470498, 60.562156599095516, 50.56065768598498, 112.44938828847768, 65.63630055219735, 86.64232705723374, 22.238213862690287, 72.33820538016512, 65.67792147138113, 108.1035599213188, 22.985115845891414, 40.40014004524649, 105.30638189411474, 64.4573152633228, 64.60601009405876, 19.30837071721779, 73.45941510287905, 166.1679310846752, 19.943201055010608, 85.96880700076943, 63.666923978717875, 128.7930259947069, 66.98638589073576, 53.688929917623625, 114.13021705398899, 4.023814673557499, 20.042237646746266, 61.987016382197694, 53.46429246542194, 50.95524600599413, 64.82269967414553, 48.686155775180225, 54.62982214692937, 86.04244312209563, 73.35819721516526, 77.52709764737543, 153.6544684980783, -38.27510517165932, 172.2423596429806, 68.66055886526016, 69.59524157090188, 100.82535195218277, 81.55500542838203, 86.37601945960655, -0.8027218700723395, 46.440946235098195, 105.19287761227665, 40.861608556311836, 55.777749152942675, 116.4748307013321], "episode_lengths": [56, 124, 78, 43, 192, 190, 200, 77, 200, 200, 200, 198, 194, 137, 132, 140, 180, 191, 114, 200, 200, 47, 78, 9, 200, 94, 200, 79, 115, 92, 11, 200, 85, 195, 195, 200, 97, 200, 109, 200, 53, 1, 86, 77, 72, 200, 200, 58, 20, 81, 200, 200, 200, 200, 200, 75, 200, 128, 88, 119, 14, 40, 200, 112, 92, 200, 82, 148, 200, 200, 19, 100, 200, 51, 200, 23, 39, 188, 200, 51, 200, 200, 74, 76, 200, 76, 112, 200, 119, 83, 200, 55, 146, 200, 200, 200, 89, 49, 183, 92], "policy_agent_policy_reward": [19.80646661991501, 26.823148771491873, 12.91935007486937, 18.049326996291086, 54.01555420795164, 46.97241988681168, 22.446355730255657, 36.3318701865311, 32.0016129659369, 23.9874448140874, 30.6381009480777, 40.96381891657726, 87.67292335041508, 32.349764625628964, 68.86456158659483, 43.8441946538481, 37.909796118556976, 36.89935028504745, 60.08261687999446, 53.35083635218747, 17.112082187392215, 15.13328270856624, 25.8612333640497, 4.393702039266965, 16.590408714325147, 60.17689513954388, 47.254760767162, 27.636759643502003, 36.11076057841585, 31.210260430512605, 4.9562619679223685, 5.481645748545695, 2.6401161268863094, 73.65812299253118, 46.11681194733228, 5.969161475724508, 39.327692711287256, 52.403139349466855, 53.244467761202856, 10.953365287010364, 43.61583467145489, 1.0952110170328475, 24.3881295307099, 14.848341249031092, 29.946721480467435, 25.483064302193632, 41.520127531956895, 50.36121294120336, 17.40907626499391, 29.81451883501049, 25.466530323524882, 30.281078299547758, 25.28032884299249, 56.22469414423884, 32.81815027609868, 43.32116352861686, 11.119106931345144, 36.16910269008255, 32.83896073569058, 54.051779960659395, 11.492557922945707, 20.20007002262324, 52.65319094705736, 32.228657631661406, 32.30300504702939, 9.654185358608895, 36.72970755143953, 83.08396554233762, 9.971600527505295, 42.98440350038471, 31.833461989358952, 64.39651299735344, 33.49319294536788, 26.844464958811812, 57.06510852699451, 2.0119073367787497, 10.021118823373133, 30.993508191098847, 26.73214623271096, 25.47762300299706, 32.41134983707276, 24.34307788759012, 27.314911073464692, 43.02122156104779, 36.67909860758264, 38.7635488236877, 76.8272342490391, -19.137552585829653, 86.12117982149034, 34.33027943263006, 34.79762078545094, 50.41267597609137, 40.77750271419103, 43.18800972980328, -0.40136093503616976, 23.220473117549098, 52.59643880613832, 20.430804278155918, 27.888874576471338, 58.23741535066606], "policy_adversary_policy_reward": [21.347425478936675, -1.5409588590216643, 14.200948345255735, 12.622200426236141, 3.4251988730165657, 9.494151201852805, 3.891991049353944, 14.157335946937142, 32.652408698891335, 21.363145509060292, 25.301079181850326, 21.67134070496135, 25.67178180457919, -3.2254260743235363, 18.311386128830755, 18.020484057700344, 19.989307964111976, 12.012305001824924, 10.849987006167222, 13.137457807920178, 30.843668967374995, -0.20556801929730106, 26.96425014322515, 13.999568773352102, 38.388444593229615, 49.28447875718546, 16.26478362238892, 16.084981003240042, 23.450691814829053, 45.413869771765775, 21.172813957381607, 22.671380696466496, 24.404633666467316, 13.50516245208966, 8.02595181057676, 28.8733984744707, 32.45306224417071, 27.629554635823776, 21.63043397441818, 31.72040237776929, 2.4937387686111983, 14.618343418781016, 31.415920303438874, -16.282637594872636, 14.161453200442061, 11.699780163607638, 1.369058826003073, 3.0246432132638916, 10.691659855223815, 5.898748859101332, 28.054652189129733, 32.122242950414126, 19.381297820570573, 27.873462946591424, 18.308259506381606, 9.328500137120397, 18.290164004668213, 17.820596573747636, 25.739407114872325, 5.470853315640282, 6.963755234820612, -2.007493266898244, 0.770516787490223, 4.711128961055472, 7.479904612237262, -4.8397884853509545, 36.95287303946159, 36.7052499530696, 18.649927233978243, 27.466884713354034, -6.760450384254458, 12.729611859978966, 25.132767820572095, 14.19492489071516, 25.746963238290995, 26.656176111175867, 23.72354013419349, 29.520927627009367, 8.25921126523601, 2.694154021774354, 14.378318626864846, 29.237516044590034, 0.25713377816661875, 0.8380772388662288, 14.014529035518102, 10.373600495191804, 9.844509878074094, 5.003831370957002, 9.620068576855022, 20.326652903612413, 3.432409921258106, 22.050654380935526, 23.308864622245572, 18.211262909711323, 17.72996458132116, 32.63124835988221, 7.752174587193199, 9.656901677800711, 19.736241939780022, 10.078276895230475, 7.378448070015153, 18.088082253509732, 30.167224632957158, 0.11385366659060026, 7.546191549347462, 17.734137293645027, 25.12860888927932, 31.09608525495952, 22.79170454154504, 10.026445734553636, 27.495985269720222, 15.825178258896667, -6.982398534236275, 18.10150546558142, 27.94653562945098, 8.222567060631569, 25.769482075229774, 7.069478660460807, 22.392499700980018, 31.659280259679377, 2.635359122968797, 8.85719879997691, 11.360502911845678, 8.839567110777562, 25.998293556071467, 26.654897390985894, 19.633194906707246, 12.595462724954158, 12.193752181312654, 20.109252865716734, 12.92482576477805, -3.2706404061691536, 11.62795823613983, 25.101749315299696, 38.82075247151389, 44.2632130708237, -1.5297758290602488, 11.501376356565537, 34.551751994457284, 8.43265150592743, 19.081065828253646, 12.752396161105295, 31.76173135810219, 32.63478163925125, 18.73537508580736, 14.757817859560522, 13.843640194979393, 13.000824763832423, 35.51302461920125, 21.552083907793254, 13.943473088778918, -11.931565752000168, -0.6092220073874834, 10.630340830760616, 23.874398236905844, 7.119109954193004, 5.624965279003051, 21.10718095370791, 15.943816652190957, 9.533806350806103, 17.587767334226683, 14.82358250284608, 30.051572464555036, -5.708494576964917, 27.74346669567759, -0.4285556222129081, 8.557771881454713, 34.46344967959309, 9.9757159242473, 26.703382683335334, 22.21258715495096, 16.550961668736733, 37.79129989921603, 39.03593434982311, -9.680543520978063, -9.45700906485159, 47.11220429328069, 39.00897552820966, 24.627305160652057, 9.702974271978007, 19.311334351979234, 15.486286433471705, 9.36041720873726, 41.05225876735409, 33.61839341871152, 7.159109295479519, 32.003766050450686, 11.18424367935259, -9.424694205096628, 9.023333270060458, 2.351519243569328, 20.86895387397977, 25.45288019749846, 27.143558608639864, -7.648274833993344, 28.07907911214926, 15.471076264957915, 12.417798311513423, 32.69386143809054, 25.543553912575515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3876718343531943, "mean_inference_ms": 0.9595511751084809, "mean_action_processing_ms": 0.1649097671286954, "mean_env_wait_ms": 0.0567397217042242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036835670471191406, "StateBufferConnector_ms": 0.0025948286056518555, "ViewRequirementAgentConnector_ms": 0.06488752365112305}, "num_episodes": 30, "episode_return_max": 175.34584670083015, "episode_return_min": -38.27510517165932, "episode_return_mean": 67.20413541264526}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.99137840386646, "num_env_steps_trained_throughput_per_sec": 494.99137840386646, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 8215.97, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8215.934, "sample_time_ms": 723.311, "learn_time_ms": 7480.376, "learn_throughput": 534.732, "synch_weights_time_ms": 11.706}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "training_iteration": 74, "trial_id": "eaa30_00000", "date": "2024-08-09_17-50-23", "timestamp": 1723240223, "time_this_iter_s": 8.097424983978271, "time_total_s": 610.1608362197876, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2896700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 610.1608362197876, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 23.754545454545454, "ram_util_percent": 79.69090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.816589767655367, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.836771452616132, "policy_loss": -0.0010181716586606054, "vf_loss": 5.834541507751223, "vf_explained_var": 0.02658239133143551, "kl": 0.008010968288761518, "entropy": 1.1039810942594337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.122595540247858, "cur_kl_coeff": 1.6439562691433816, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.2786368901530905, "policy_loss": -0.00016835555822278063, "vf_loss": 7.272484829028447, "vf_explained_var": 0.036704362742602824, "kl": 0.003844627703316898, "entropy": 0.6696263043830792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "env_runners": {"episode_reward_max": 172.2423596429806, "episode_reward_min": -46.9607618431898, "episode_reward_mean": 62.11740463412536, "episode_len_mean": 132.24, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 13224, "policy_reward_min": {"agent_policy": -23.480380921594914, "adversary_policy": -27.6724836858544}, "policy_reward_max": {"agent_policy": 86.12117982149034, "adversary_policy": 47.11220429328069}, "policy_reward_mean": {"agent_policy": 31.05870231706268, "adversary_policy": 15.52935115853134}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.509521534324, 55.273519287004, 72.22152115683176, 62.420520861025196, 9.912523935844737, 10.963291497091383, 5.280232253772593, 147.31624598506244, 92.23362389466455, 11.938322951449017, 78.65538542257453, 104.80627869893371, 106.48893552240571, 21.90673057402072, 87.23166934290977, 2.190422034065695, 48.77625906141985, 29.69668249806218, 59.89344296093488, 50.96612860438725, 83.04025506391376, 100.7224258824067, 34.81815252998781, 59.62903767002098, 50.9330606470498, 60.562156599095516, 50.56065768598498, 112.44938828847768, 65.63630055219735, 86.64232705723374, 22.238213862690287, 72.33820538016512, 65.67792147138113, 108.1035599213188, 22.985115845891414, 40.40014004524649, 105.30638189411474, 64.4573152633228, 64.60601009405876, 19.30837071721779, 73.45941510287905, 166.1679310846752, 19.943201055010608, 85.96880700076943, 63.666923978717875, 128.7930259947069, 66.98638589073576, 53.688929917623625, 114.13021705398899, 4.023814673557499, 20.042237646746266, 61.987016382197694, 53.46429246542194, 50.95524600599413, 64.82269967414553, 48.686155775180225, 54.62982214692937, 86.04244312209563, 73.35819721516526, 77.52709764737543, 153.6544684980783, -38.27510517165932, 172.2423596429806, 68.66055886526016, 69.59524157090188, 100.82535195218277, 81.55500542838203, 86.37601945960655, -0.8027218700723395, 46.440946235098195, 105.19287761227665, 40.861608556311836, 55.777749152942675, 116.4748307013321, 112.69204626506053, 53.75251551044501, 23.488277965231532, 19.44774317038858, 75.13649346889854, 61.23199394446954, -46.9607618431898, -21.21367235027388, 44.67844853526661, 75.25177635499487, 160.56988178612977, 73.94120690206861, 111.40444699371062, 21.929138495912625, -37.26384001648978, -4.96556163176254, 138.46318230659892, 6.22106158033302, 24.971905683023046, 63.58531789023064, 41.99841681770265, 121.67609944536994, 103.82684804021548, 34.34963586952988, 70.79839287734146, 12.710164335231955], "episode_lengths": [200, 79, 115, 92, 11, 200, 85, 195, 195, 200, 97, 200, 109, 200, 53, 1, 86, 77, 72, 200, 200, 58, 20, 81, 200, 200, 200, 200, 200, 75, 200, 128, 88, 119, 14, 40, 200, 112, 92, 200, 82, 148, 200, 200, 19, 100, 200, 51, 200, 23, 39, 188, 200, 51, 200, 200, 74, 76, 200, 76, 112, 200, 119, 83, 200, 55, 146, 200, 200, 200, 89, 49, 183, 92, 97, 102, 200, 154, 182, 101, 200, 200, 200, 195, 88, 57, 200, 58, 200, 51, 88, 16, 200, 88, 200, 92, 106, 200, 200, 200], "policy_agent_policy_reward": [47.254760767162, 27.636759643502003, 36.11076057841585, 31.210260430512605, 4.9562619679223685, 5.481645748545695, 2.6401161268863094, 73.65812299253118, 46.11681194733228, 5.969161475724508, 39.327692711287256, 52.403139349466855, 53.244467761202856, 10.953365287010364, 43.61583467145489, 1.0952110170328475, 24.3881295307099, 14.848341249031092, 29.946721480467435, 25.483064302193632, 41.520127531956895, 50.36121294120336, 17.40907626499391, 29.81451883501049, 25.466530323524882, 30.281078299547758, 25.28032884299249, 56.22469414423884, 32.81815027609868, 43.32116352861686, 11.119106931345144, 36.16910269008255, 32.83896073569058, 54.051779960659395, 11.492557922945707, 20.20007002262324, 52.65319094705736, 32.228657631661406, 32.30300504702939, 9.654185358608895, 36.72970755143953, 83.08396554233762, 9.971600527505295, 42.98440350038471, 31.833461989358952, 64.39651299735344, 33.49319294536788, 26.844464958811812, 57.06510852699451, 2.0119073367787497, 10.021118823373133, 30.993508191098847, 26.73214623271096, 25.47762300299706, 32.41134983707276, 24.34307788759012, 27.314911073464692, 43.02122156104779, 36.67909860758264, 38.7635488236877, 76.8272342490391, -19.137552585829653, 86.12117982149034, 34.33027943263006, 34.79762078545094, 50.41267597609137, 40.77750271419103, 43.18800972980328, -0.40136093503616976, 23.220473117549098, 52.59643880613832, 20.430804278155918, 27.888874576471338, 58.23741535066606, 56.34602313253027, 26.876257755222507, 11.744138982615766, 9.72387158519428, 37.56824673444926, 30.61599697223476, -23.480380921594914, -10.606836175136948, 22.339224267633305, 37.62588817749743, 80.28494089306487, 36.97060345103429, 55.70222349685534, 10.964569247956312, -18.63192000824489, -2.4827808158812696, 69.23159115329948, 3.1105307901665102, 12.485952841511523, 31.79265894511532, 20.999208408851324, 60.83804972268496, 51.91342402010772, 17.17481793476494, 35.39919643867073, 6.355082167615977], "policy_adversary_policy_reward": [19.381297820570573, 27.873462946591424, 18.308259506381606, 9.328500137120397, 18.290164004668213, 17.820596573747636, 25.739407114872325, 5.470853315640282, 6.963755234820612, -2.007493266898244, 0.770516787490223, 4.711128961055472, 7.479904612237262, -4.8397884853509545, 36.95287303946159, 36.7052499530696, 18.649927233978243, 27.466884713354034, -6.760450384254458, 12.729611859978966, 25.132767820572095, 14.19492489071516, 25.746963238290995, 26.656176111175867, 23.72354013419349, 29.520927627009367, 8.25921126523601, 2.694154021774354, 14.378318626864846, 29.237516044590034, 0.25713377816661875, 0.8380772388662288, 14.014529035518102, 10.373600495191804, 9.844509878074094, 5.003831370957002, 9.620068576855022, 20.326652903612413, 3.432409921258106, 22.050654380935526, 23.308864622245572, 18.211262909711323, 17.72996458132116, 32.63124835988221, 7.752174587193199, 9.656901677800711, 19.736241939780022, 10.078276895230475, 7.378448070015153, 18.088082253509732, 30.167224632957158, 0.11385366659060026, 7.546191549347462, 17.734137293645027, 25.12860888927932, 31.09608525495952, 22.79170454154504, 10.026445734553636, 27.495985269720222, 15.825178258896667, -6.982398534236275, 18.10150546558142, 27.94653562945098, 8.222567060631569, 25.769482075229774, 7.069478660460807, 22.392499700980018, 31.659280259679377, 2.635359122968797, 8.85719879997691, 11.360502911845678, 8.839567110777562, 25.998293556071467, 26.654897390985894, 19.633194906707246, 12.595462724954158, 12.193752181312654, 20.109252865716734, 12.92482576477805, -3.2706404061691536, 11.62795823613983, 25.101749315299696, 38.82075247151389, 44.2632130708237, -1.5297758290602488, 11.501376356565537, 34.551751994457284, 8.43265150592743, 19.081065828253646, 12.752396161105295, 31.76173135810219, 32.63478163925125, 18.73537508580736, 14.757817859560522, 13.843640194979393, 13.000824763832423, 35.51302461920125, 21.552083907793254, 13.943473088778918, -11.931565752000168, -0.6092220073874834, 10.630340830760616, 23.874398236905844, 7.119109954193004, 5.624965279003051, 21.10718095370791, 15.943816652190957, 9.533806350806103, 17.587767334226683, 14.82358250284608, 30.051572464555036, -5.708494576964917, 27.74346669567759, -0.4285556222129081, 8.557771881454713, 34.46344967959309, 9.9757159242473, 26.703382683335334, 22.21258715495096, 16.550961668736733, 37.79129989921603, 39.03593434982311, -9.680543520978063, -9.45700906485159, 47.11220429328069, 39.00897552820966, 24.627305160652057, 9.702974271978007, 19.311334351979234, 15.486286433471705, 9.36041720873726, 41.05225876735409, 33.61839341871152, 7.159109295479519, 32.003766050450686, 11.18424367935259, -9.424694205096628, 9.023333270060458, 2.351519243569328, 20.86895387397977, 25.45288019749846, 27.143558608639864, -7.648274833993344, 28.07907911214926, 15.471076264957915, 12.417798311513423, 32.69386143809054, 25.543553912575515, 25.724860354105783, 30.621162778424484, 17.19854159025139, 9.677716164971114, 18.061895640273534, -6.3177566576577675, 4.9933570391246, 4.730514546069681, 27.444898023296346, 10.123348711152916, 13.328740764685028, 17.287256207549735, -20.57247252789154, -2.907908393703373, -5.786565021999682, -4.820271153137266, 16.30288945649639, 6.036334811136912, 20.135080531581504, 17.49080764591593, 34.631324187950824, 45.65361670511405, 20.34852130443462, 16.6220821465997, 22.20540821018996, 33.49681528666538, 14.185587083659918, -3.2210178357036057, -5.518316676662547, -13.113603331582347, -27.6724836858544, 25.189702869973125, 39.42175337377077, 29.809837779528706, 8.106709515267763, -4.996178725101252, 13.619315303444147, -1.1333624619326237, 1.2358595653691893, 30.556799379746124, -4.0325930746937875, 25.03180148354511, 24.96431452014735, 35.87373520253763, 33.7145251603746, 18.198898859733124, 13.596582481515206, 3.5782354532497322, 20.690140874577594, 14.709055564093138, 7.6310891423569345, -1.276006974740957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3876628780061236, "mean_inference_ms": 0.9592095762338136, "mean_action_processing_ms": 0.16480756302612423, "mean_env_wait_ms": 0.05670384385428898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035326480865478516, "StateBufferConnector_ms": 0.0025343894958496094, "ViewRequirementAgentConnector_ms": 0.06527197360992432}, "num_episodes": 26, "episode_return_max": 172.2423596429806, "episode_return_min": -46.9607618431898, "episode_return_mean": 62.11740463412536}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 507.8189398316613, "num_env_steps_trained_throughput_per_sec": 507.8189398316613, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 900000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 8190.817, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8190.781, "sample_time_ms": 725.107, "learn_time_ms": 7453.518, "learn_throughput": 536.659, "synch_weights_time_ms": 11.614}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "training_iteration": 75, "trial_id": "eaa30_00000", "date": "2024-08-09_17-50-31", "timestamp": 1723240231, "time_this_iter_s": 7.881211996078491, "time_total_s": 618.0420482158661, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2896af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 618.0420482158661, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 29.0, "ram_util_percent": 80.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.844066127393612, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.060657414935884, "policy_loss": 0.0038017874943319136, "vf_loss": 6.0511882423723815, "vf_explained_var": -0.010555547633499064, "kl": 0.013977751976480244, "entropy": 1.050166719804996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.370465428444247, "cur_kl_coeff": 0.8219781345716908, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.447187509636084, "policy_loss": 0.004662781584435531, "vf_loss": 7.439818538725376, "vf_explained_var": 0.02153992516299089, "kl": 0.003292323161804234, "entropy": 0.6828827697162827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 172.2423596429806, "episode_reward_min": -46.9607618431898, "episode_reward_mean": 64.13480361207615, "episode_len_mean": 136.8, "episode_media": {}, "episodes_this_iter": 29, "episodes_timesteps_total": 13680, "policy_reward_min": {"agent_policy": -23.480380921594914, "adversary_policy": -27.6724836858544}, "policy_reward_max": {"agent_policy": 86.12117982149034, "adversary_policy": 47.11220429328069}, "policy_reward_mean": {"agent_policy": 32.06740180603808, "adversary_policy": 16.033700903019035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.64232705723374, 22.238213862690287, 72.33820538016512, 65.67792147138113, 108.1035599213188, 22.985115845891414, 40.40014004524649, 105.30638189411474, 64.4573152633228, 64.60601009405876, 19.30837071721779, 73.45941510287905, 166.1679310846752, 19.943201055010608, 85.96880700076943, 63.666923978717875, 128.7930259947069, 66.98638589073576, 53.688929917623625, 114.13021705398899, 4.023814673557499, 20.042237646746266, 61.987016382197694, 53.46429246542194, 50.95524600599413, 64.82269967414553, 48.686155775180225, 54.62982214692937, 86.04244312209563, 73.35819721516526, 77.52709764737543, 153.6544684980783, -38.27510517165932, 172.2423596429806, 68.66055886526016, 69.59524157090188, 100.82535195218277, 81.55500542838203, 86.37601945960655, -0.8027218700723395, 46.440946235098195, 105.19287761227665, 40.861608556311836, 55.777749152942675, 116.4748307013321, 112.69204626506053, 53.75251551044501, 23.488277965231532, 19.44774317038858, 75.13649346889854, 61.23199394446954, -46.9607618431898, -21.21367235027388, 44.67844853526661, 75.25177635499487, 160.56988178612977, 73.94120690206861, 111.40444699371062, 21.929138495912625, -37.26384001648978, -4.96556163176254, 138.46318230659892, 6.22106158033302, 24.971905683023046, 63.58531789023064, 41.99841681770265, 121.67609944536994, 103.82684804021548, 34.34963586952988, 70.79839287734146, 12.710164335231955, 26.58139568860993, -24.85198207147704, 54.31710079296833, 99.04987411806785, 145.08520543764118, 44.82949219591909, 118.15942316027744, 121.61937805423608, 98.05014973463338, 61.02483617082548, 105.01831668682769, 123.19952425203533, 72.20329609549856, 46.305216455354866, 146.94310017998816, 132.00383839272737, 37.036847934169714, 51.51018892823454, 21.131799100412714, 100.956295838052, 69.5222864057142, 40.65651603189471, -8.618667283583612, 49.57561596554339, 12.158476596761014, 92.44104053773546, 81.08431762270047, 0.27699827077191586, 55.50270949845614], "episode_lengths": [75, 200, 128, 88, 119, 14, 40, 200, 112, 92, 200, 82, 148, 200, 200, 19, 100, 200, 51, 200, 23, 39, 188, 200, 51, 200, 200, 74, 76, 200, 76, 112, 200, 119, 83, 200, 55, 146, 200, 200, 200, 89, 49, 183, 92, 97, 102, 200, 154, 182, 101, 200, 200, 200, 195, 88, 57, 200, 58, 200, 51, 88, 16, 200, 88, 200, 92, 106, 200, 200, 200, 200, 200, 85, 187, 102, 200, 122, 200, 79, 155, 68, 193, 85, 200, 124, 200, 200, 200, 53, 200, 69, 200, 200, 200, 49, 200, 102, 9, 200], "policy_agent_policy_reward": [43.32116352861686, 11.119106931345144, 36.16910269008255, 32.83896073569058, 54.051779960659395, 11.492557922945707, 20.20007002262324, 52.65319094705736, 32.228657631661406, 32.30300504702939, 9.654185358608895, 36.72970755143953, 83.08396554233762, 9.971600527505295, 42.98440350038471, 31.833461989358952, 64.39651299735344, 33.49319294536788, 26.844464958811812, 57.06510852699451, 2.0119073367787497, 10.021118823373133, 30.993508191098847, 26.73214623271096, 25.47762300299706, 32.41134983707276, 24.34307788759012, 27.314911073464692, 43.02122156104779, 36.67909860758264, 38.7635488236877, 76.8272342490391, -19.137552585829653, 86.12117982149034, 34.33027943263006, 34.79762078545094, 50.41267597609137, 40.77750271419103, 43.18800972980328, -0.40136093503616976, 23.220473117549098, 52.59643880613832, 20.430804278155918, 27.888874576471338, 58.23741535066606, 56.34602313253027, 26.876257755222507, 11.744138982615766, 9.72387158519428, 37.56824673444926, 30.61599697223476, -23.480380921594914, -10.606836175136948, 22.339224267633305, 37.62588817749743, 80.28494089306487, 36.97060345103429, 55.70222349685534, 10.964569247956312, -18.63192000824489, -2.4827808158812696, 69.23159115329948, 3.1105307901665102, 12.485952841511523, 31.79265894511532, 20.999208408851324, 60.83804972268496, 51.91342402010772, 17.17481793476494, 35.39919643867073, 6.355082167615977, 13.290697844304965, -12.42599103573852, 27.158550396484173, 49.524937059033945, 72.54260271882059, 22.414746097959544, 59.07971158013873, 60.80968902711804, 49.025074867316725, 30.51241808541274, 52.509158343413844, 61.59976212601765, 36.101648047749265, 23.152608227677433, 73.47155008999408, 66.00191919636369, 18.51842396708486, 25.75509446411727, 10.565899550206353, 50.478147919026, 34.76114320285711, 20.328258015947352, -4.309333641791806, 24.78780798277169, 6.079238298380507, 46.22052026886773, 40.542158811350255, 0.13849913538595793, 27.751354749228078], "policy_adversary_policy_reward": [27.495985269720222, 15.825178258896667, -6.982398534236275, 18.10150546558142, 27.94653562945098, 8.222567060631569, 25.769482075229774, 7.069478660460807, 22.392499700980018, 31.659280259679377, 2.635359122968797, 8.85719879997691, 11.360502911845678, 8.839567110777562, 25.998293556071467, 26.654897390985894, 19.633194906707246, 12.595462724954158, 12.193752181312654, 20.109252865716734, 12.92482576477805, -3.2706404061691536, 11.62795823613983, 25.101749315299696, 38.82075247151389, 44.2632130708237, -1.5297758290602488, 11.501376356565537, 34.551751994457284, 8.43265150592743, 19.081065828253646, 12.752396161105295, 31.76173135810219, 32.63478163925125, 18.73537508580736, 14.757817859560522, 13.843640194979393, 13.000824763832423, 35.51302461920125, 21.552083907793254, 13.943473088778918, -11.931565752000168, -0.6092220073874834, 10.630340830760616, 23.874398236905844, 7.119109954193004, 5.624965279003051, 21.10718095370791, 15.943816652190957, 9.533806350806103, 17.587767334226683, 14.82358250284608, 30.051572464555036, -5.708494576964917, 27.74346669567759, -0.4285556222129081, 8.557771881454713, 34.46344967959309, 9.9757159242473, 26.703382683335334, 22.21258715495096, 16.550961668736733, 37.79129989921603, 39.03593434982311, -9.680543520978063, -9.45700906485159, 47.11220429328069, 39.00897552820966, 24.627305160652057, 9.702974271978007, 19.311334351979234, 15.486286433471705, 9.36041720873726, 41.05225876735409, 33.61839341871152, 7.159109295479519, 32.003766050450686, 11.18424367935259, -9.424694205096628, 9.023333270060458, 2.351519243569328, 20.86895387397977, 25.45288019749846, 27.143558608639864, -7.648274833993344, 28.07907911214926, 15.471076264957915, 12.417798311513423, 32.69386143809054, 25.543553912575515, 25.724860354105783, 30.621162778424484, 17.19854159025139, 9.677716164971114, 18.061895640273534, -6.3177566576577675, 4.9933570391246, 4.730514546069681, 27.444898023296346, 10.123348711152916, 13.328740764685028, 17.287256207549735, -20.57247252789154, -2.907908393703373, -5.786565021999682, -4.820271153137266, 16.30288945649639, 6.036334811136912, 20.135080531581504, 17.49080764591593, 34.631324187950824, 45.65361670511405, 20.34852130443462, 16.6220821465997, 22.20540821018996, 33.49681528666538, 14.185587083659918, -3.2210178357036057, -5.518316676662547, -13.113603331582347, -27.6724836858544, 25.189702869973125, 39.42175337377077, 29.809837779528706, 8.106709515267763, -4.996178725101252, 13.619315303444147, -1.1333624619326237, 1.2358595653691893, 30.556799379746124, -4.0325930746937875, 25.03180148354511, 24.96431452014735, 35.87373520253763, 33.7145251603746, 18.198898859733124, 13.596582481515206, 3.5782354532497322, 20.690140874577594, 14.709055564093138, 7.6310891423569345, -1.276006974740957, 20.32724513728356, -7.036547292978593, -19.412737600308756, 6.986746564570236, 6.027029070386792, 21.131521326097374, 23.769755038125574, 25.75518202090835, 41.61413318744618, 30.928469531374425, 5.931618009480545, 16.483128088479, 26.000015641896752, 33.07969593824198, 29.680859919285595, 31.12882910783248, 33.3913425019672, 15.633732365349516, 28.682530733577803, 1.8298873518349374, 25.61376947381458, 26.895388869599255, 33.259735176970054, 28.340026949047598, 3.4524408447899138, 32.64920720295937, 11.034271063508232, 12.118337164169201, 43.31623537894656, 30.155314711047517, 30.15378887581919, 35.848130320544506, 5.77681544832039, 12.741608518764473, 3.266573869969502, 22.488520594147772, -8.762073297163083, 19.327972847369438, 25.040493962684764, 25.437653956341236, 10.690289653350835, 24.07085354950627, 24.059535080702076, -3.7312770647547246, 3.372402713129528, -7.681736354921334, 8.013923036531732, 16.77388494623995, 15.4689105867666, -9.389672288386095, 22.16400093476642, 24.05651933410131, 4.8784674093915354, 35.66369140195872, 2.7614964803801128, -2.622997344994155, 15.648819647212079, 12.102535102015995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3873305157667503, "mean_inference_ms": 0.9596221415520847, "mean_action_processing_ms": 0.164455889095065, "mean_env_wait_ms": 0.056648548993231455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034044981002807617, "StateBufferConnector_ms": 0.0024591684341430664, "ViewRequirementAgentConnector_ms": 0.06362771987915039}, "num_episodes": 29, "episode_return_max": 172.2423596429806, "episode_return_min": -46.9607618431898, "episode_return_mean": 64.13480361207615}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 516.0988181313883, "num_env_steps_trained_throughput_per_sec": 516.0988181313883, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 8105.962, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8105.927, "sample_time_ms": 724.892, "learn_time_ms": 7369.004, "learn_throughput": 542.814, "synch_weights_time_ms": 11.534}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 76, "trial_id": "eaa30_00000", "date": "2024-08-09_17-50-39", "timestamp": 1723240239, "time_this_iter_s": 7.755080938339233, "time_total_s": 625.7971291542053, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2896d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 625.7971291542053, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 23.681818181818183, "ram_util_percent": 80.88181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.862544563728035, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.628900857703395, "policy_loss": 0.02170632125738338, "vf_loss": 5.598893447149368, "vf_explained_var": 0.027739106473468597, "kl": 0.020473372601662522, "entropy": 1.0301575412825932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.314810417033732, "cur_kl_coeff": 0.4109890672858454, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.2724436044692995, "policy_loss": 0.00446915643842658, "vf_loss": 7.265161841114362, "vf_explained_var": -0.0014067480340600013, "kl": 0.0068435025408689395, "entropy": 0.7059924618030587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "env_runners": {"episode_reward_max": 183.4608532986345, "episode_reward_min": -46.9607618431898, "episode_reward_mean": 65.07943031192221, "episode_len_mean": 139.34, "episode_media": {}, "episodes_this_iter": 31, "episodes_timesteps_total": 13934, "policy_reward_min": {"agent_policy": -23.480380921594914, "adversary_policy": -27.6724836858544}, "policy_reward_max": {"agent_policy": 91.73042664931721, "adversary_policy": 52.75222235976899}, "policy_reward_mean": {"agent_policy": 32.53971515596112, "adversary_policy": 16.269857577980556}, "custom_metrics": {}, "hist_stats": {"episode_reward": [153.6544684980783, -38.27510517165932, 172.2423596429806, 68.66055886526016, 69.59524157090188, 100.82535195218277, 81.55500542838203, 86.37601945960655, -0.8027218700723395, 46.440946235098195, 105.19287761227665, 40.861608556311836, 55.777749152942675, 116.4748307013321, 112.69204626506053, 53.75251551044501, 23.488277965231532, 19.44774317038858, 75.13649346889854, 61.23199394446954, -46.9607618431898, -21.21367235027388, 44.67844853526661, 75.25177635499487, 160.56988178612977, 73.94120690206861, 111.40444699371062, 21.929138495912625, -37.26384001648978, -4.96556163176254, 138.46318230659892, 6.22106158033302, 24.971905683023046, 63.58531789023064, 41.99841681770265, 121.67609944536994, 103.82684804021548, 34.34963586952988, 70.79839287734146, 12.710164335231955, 26.58139568860993, -24.85198207147704, 54.31710079296833, 99.04987411806785, 145.08520543764118, 44.82949219591909, 118.15942316027744, 121.61937805423608, 98.05014973463338, 61.02483617082548, 105.01831668682769, 123.19952425203533, 72.20329609549856, 46.305216455354866, 146.94310017998816, 132.00383839272737, 37.036847934169714, 51.51018892823454, 21.131799100412714, 100.956295838052, 69.5222864057142, 40.65651603189471, -8.618667283583612, 49.57561596554339, 12.158476596761014, 92.44104053773546, 81.08431762270047, 0.27699827077191586, 55.50270949845614, 70.4031164177876, 11.568860843616225, 56.25094985306001, 156.83035274166815, 62.615951225567656, 37.48113681952454, -23.294741107674042, 56.558977982385954, 21.69360974663127, 124.71140093580499, 110.65209371743849, 132.59017082066356, 45.94441531994279, 96.7413841642622, 19.077635877806852, -39.52720103751287, 183.4608532986345, 42.091475994305576, 44.409495227863545, 62.30623240045955, 128.9294121044603, 90.05943342732735, 38.27413373114676, -31.738506368061337, 40.60810822283569, 38.439504158421116, 74.495710983885, 141.7870360666038, 130.41858214886105, 50.66547740799845, 160.36502824545107], "episode_lengths": [112, 200, 119, 83, 200, 55, 146, 200, 200, 200, 89, 49, 183, 92, 97, 102, 200, 154, 182, 101, 200, 200, 200, 195, 88, 57, 200, 58, 200, 51, 88, 16, 200, 88, 200, 92, 106, 200, 200, 200, 200, 200, 85, 187, 102, 200, 122, 200, 79, 155, 68, 193, 85, 200, 124, 200, 200, 200, 53, 200, 69, 200, 200, 200, 49, 200, 102, 9, 200, 200, 19, 200, 90, 200, 200, 200, 200, 39, 83, 66, 54, 200, 115, 60, 200, 122, 200, 200, 34, 82, 200, 200, 200, 47, 78, 80, 87, 79, 200, 114], "policy_agent_policy_reward": [76.8272342490391, -19.137552585829653, 86.12117982149034, 34.33027943263006, 34.79762078545094, 50.41267597609137, 40.77750271419103, 43.18800972980328, -0.40136093503616976, 23.220473117549098, 52.59643880613832, 20.430804278155918, 27.888874576471338, 58.23741535066606, 56.34602313253027, 26.876257755222507, 11.744138982615766, 9.72387158519428, 37.56824673444926, 30.61599697223476, -23.480380921594914, -10.606836175136948, 22.339224267633305, 37.62588817749743, 80.28494089306487, 36.97060345103429, 55.70222349685534, 10.964569247956312, -18.63192000824489, -2.4827808158812696, 69.23159115329948, 3.1105307901665102, 12.485952841511523, 31.79265894511532, 20.999208408851324, 60.83804972268496, 51.91342402010772, 17.17481793476494, 35.39919643867073, 6.355082167615977, 13.290697844304965, -12.42599103573852, 27.158550396484173, 49.524937059033945, 72.54260271882059, 22.414746097959544, 59.07971158013873, 60.80968902711804, 49.025074867316725, 30.51241808541274, 52.509158343413844, 61.59976212601765, 36.101648047749265, 23.152608227677433, 73.47155008999408, 66.00191919636369, 18.51842396708486, 25.75509446411727, 10.565899550206353, 50.478147919026, 34.76114320285711, 20.328258015947352, -4.309333641791806, 24.78780798277169, 6.079238298380507, 46.22052026886773, 40.542158811350255, 0.13849913538595793, 27.751354749228078, 35.2015582088938, 5.784430421808113, 28.12547492653, 78.41517637083408, 31.30797561278382, 18.740568409762304, -11.647370553836947, 28.27948899119299, 10.846804873315635, 62.35570046790251, 55.32604685871926, 66.29508541033181, 22.972207659971392, 48.370692082131086, 9.538817938903426, -19.763600518756434, 91.73042664931721, 21.045737997152788, 22.204747613931772, 31.153116200229775, 64.46470605223016, 45.0297167136637, 19.137066865573395, -15.869253184030676, 20.304054111417837, 19.21975207921057, 37.247855491942495, 70.89351803330193, 65.20929107443055, 25.332738703999226, 80.18251412272554], "policy_adversary_policy_reward": [37.79129989921603, 39.03593434982311, -9.680543520978063, -9.45700906485159, 47.11220429328069, 39.00897552820966, 24.627305160652057, 9.702974271978007, 19.311334351979234, 15.486286433471705, 9.36041720873726, 41.05225876735409, 33.61839341871152, 7.159109295479519, 32.003766050450686, 11.18424367935259, -9.424694205096628, 9.023333270060458, 2.351519243569328, 20.86895387397977, 25.45288019749846, 27.143558608639864, -7.648274833993344, 28.07907911214926, 15.471076264957915, 12.417798311513423, 32.69386143809054, 25.543553912575515, 25.724860354105783, 30.621162778424484, 17.19854159025139, 9.677716164971114, 18.061895640273534, -6.3177566576577675, 4.9933570391246, 4.730514546069681, 27.444898023296346, 10.123348711152916, 13.328740764685028, 17.287256207549735, -20.57247252789154, -2.907908393703373, -5.786565021999682, -4.820271153137266, 16.30288945649639, 6.036334811136912, 20.135080531581504, 17.49080764591593, 34.631324187950824, 45.65361670511405, 20.34852130443462, 16.6220821465997, 22.20540821018996, 33.49681528666538, 14.185587083659918, -3.2210178357036057, -5.518316676662547, -13.113603331582347, -27.6724836858544, 25.189702869973125, 39.42175337377077, 29.809837779528706, 8.106709515267763, -4.996178725101252, 13.619315303444147, -1.1333624619326237, 1.2358595653691893, 30.556799379746124, -4.0325930746937875, 25.03180148354511, 24.96431452014735, 35.87373520253763, 33.7145251603746, 18.198898859733124, 13.596582481515206, 3.5782354532497322, 20.690140874577594, 14.709055564093138, 7.6310891423569345, -1.276006974740957, 20.32724513728356, -7.036547292978593, -19.412737600308756, 6.986746564570236, 6.027029070386792, 21.131521326097374, 23.769755038125574, 25.75518202090835, 41.61413318744618, 30.928469531374425, 5.931618009480545, 16.483128088479, 26.000015641896752, 33.07969593824198, 29.680859919285595, 31.12882910783248, 33.3913425019672, 15.633732365349516, 28.682530733577803, 1.8298873518349374, 25.61376947381458, 26.895388869599255, 33.259735176970054, 28.340026949047598, 3.4524408447899138, 32.64920720295937, 11.034271063508232, 12.118337164169201, 43.31623537894656, 30.155314711047517, 30.15378887581919, 35.848130320544506, 5.77681544832039, 12.741608518764473, 3.266573869969502, 22.488520594147772, -8.762073297163083, 19.327972847369438, 25.040493962684764, 25.437653956341236, 10.690289653350835, 24.07085354950627, 24.059535080702076, -3.7312770647547246, 3.372402713129528, -7.681736354921334, 8.013923036531732, 16.77388494623995, 15.4689105867666, -9.389672288386095, 22.16400093476642, 24.05651933410131, 4.8784674093915354, 35.66369140195872, 2.7614964803801128, -2.622997344994155, 15.648819647212079, 12.102535102015995, 28.777724198259037, 6.42383401063476, -3.890935650794411, 9.675366072602523, 19.113089867094697, 9.012385059435303, 50.22145222692895, 28.193724143905108, 21.40537972950164, 9.902595883282185, 7.672488456161002, 11.068079953601302, -2.699102958500088, -8.948267595336844, 29.377120587134776, -1.097631595941781, -2.63938947311415, 13.486194346429786, 30.874773557918665, 31.480926909983854, 27.470565217253075, 27.85548164146618, 24.062389540627194, 42.23269586970458, -3.493739853397596, 26.46594751336899, 27.955476096677984, 20.415215985453088, -3.2111968505376236, 12.75001478944105, -10.971825793226145, -8.791774725530288, 52.75222235976899, 38.97820428954823, 6.841768916284369, 14.203969080868418, 9.987667363648235, 12.217080250283537, 18.871593717062517, 12.281522483167258, 35.46967553579831, 28.995030516431864, 34.870508178149876, 10.15920853551383, 7.763138854040209, 11.373928011533184, -1.4280632318194755, -14.4411899522112, 16.948349324857766, 3.3557047865600804, 1.4257378914923464, 17.79401418771822, 5.259092881317102, 31.988762610625393, 50.05631558145381, 20.8372024518481, 31.288211694849384, 33.92107937958115, 8.547083881352185, 16.785654822647043, 40.48265281143736, 39.699861311288174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3871068123926502, "mean_inference_ms": 0.9584390710083812, "mean_action_processing_ms": 0.16428864308953714, "mean_env_wait_ms": 0.056645413216857544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003403782844543457, "StateBufferConnector_ms": 0.0024254322052001953, "ViewRequirementAgentConnector_ms": 0.0648798942565918}, "num_episodes": 31, "episode_return_max": 183.4608532986345, "episode_return_min": -46.9607618431898, "episode_return_mean": 65.07943031192221}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 507.96932664123574, "num_env_steps_trained_throughput_per_sec": 507.96932664123574, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 924000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 8076.476, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8076.441, "sample_time_ms": 723.837, "learn_time_ms": 7340.781, "learn_throughput": 544.901, "synch_weights_time_ms": 11.289}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "training_iteration": 77, "trial_id": "eaa30_00000", "date": "2024-08-09_17-50-47", "timestamp": 1723240247, "time_this_iter_s": 7.879104852676392, "time_total_s": 633.6762340068817, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbfc040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 633.6762340068817, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 22.518181818181823, "ram_util_percent": 80.48181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.1448941736624985, "cur_kl_coeff": 0.6081859588623046, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.026076203931576, "policy_loss": -0.001099082810814103, "vf_loss": 5.024660079315226, "vf_explained_var": -0.023894722278786716, "kl": 0.0041355710574573585, "entropy": 1.030222555600777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.31090610018, "cur_kl_coeff": 0.4109890672858454, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.3498220975200335, "policy_loss": 0.004390870927697203, "vf_loss": 6.34194091061751, "vf_explained_var": -0.011260554504891237, "kl": 0.008492481950816, "entropy": 0.7091202941412728, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "env_runners": {"episode_reward_max": 183.4608532986345, "episode_reward_min": -39.52720103751287, "episode_reward_mean": 67.0323225628121, "episode_len_mean": 141.44, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 14144, "policy_reward_min": {"agent_policy": -19.763600518756434, "adversary_policy": -27.6724836858544}, "policy_reward_max": {"agent_policy": 91.73042664931721, "adversary_policy": 52.75222235976899}, "policy_reward_mean": {"agent_policy": 33.516161281406056, "adversary_policy": 16.758080640703028}, "custom_metrics": {}, "hist_stats": {"episode_reward": [160.56988178612977, 73.94120690206861, 111.40444699371062, 21.929138495912625, -37.26384001648978, -4.96556163176254, 138.46318230659892, 6.22106158033302, 24.971905683023046, 63.58531789023064, 41.99841681770265, 121.67609944536994, 103.82684804021548, 34.34963586952988, 70.79839287734146, 12.710164335231955, 26.58139568860993, -24.85198207147704, 54.31710079296833, 99.04987411806785, 145.08520543764118, 44.82949219591909, 118.15942316027744, 121.61937805423608, 98.05014973463338, 61.02483617082548, 105.01831668682769, 123.19952425203533, 72.20329609549856, 46.305216455354866, 146.94310017998816, 132.00383839272737, 37.036847934169714, 51.51018892823454, 21.131799100412714, 100.956295838052, 69.5222864057142, 40.65651603189471, -8.618667283583612, 49.57561596554339, 12.158476596761014, 92.44104053773546, 81.08431762270047, 0.27699827077191586, 55.50270949845614, 70.4031164177876, 11.568860843616225, 56.25094985306001, 156.83035274166815, 62.615951225567656, 37.48113681952454, -23.294741107674042, 56.558977982385954, 21.69360974663127, 124.71140093580499, 110.65209371743849, 132.59017082066356, 45.94441531994279, 96.7413841642622, 19.077635877806852, -39.52720103751287, 183.4608532986345, 42.091475994305576, 44.409495227863545, 62.30623240045955, 128.9294121044603, 90.05943342732735, 38.27413373114676, -31.738506368061337, 40.60810822283569, 38.439504158421116, 74.495710983885, 141.7870360666038, 130.41858214886105, 50.66547740799845, 160.36502824545107, 77.91239539929104, 118.20824757172917, 19.482293959390013, 63.48199474795035, 151.70175344632568, 20.200177266630668, 74.67757578930811, 61.88046133746481, -11.584849583542503, 133.1857901313876, 68.96939492383842, 54.90998740252823, 30.747631654889624, 105.42950009537614, 57.22690893293215, 96.50753354238856, 24.28543224903177, 65.38630021349552, -4.523150238720675, 82.03800406365475, 111.10644836090881, 132.4502985109754, 23.27729415644698, 94.41585281022076], "episode_lengths": [88, 57, 200, 58, 200, 51, 88, 16, 200, 88, 200, 92, 106, 200, 200, 200, 200, 200, 85, 187, 102, 200, 122, 200, 79, 155, 68, 193, 85, 200, 124, 200, 200, 200, 53, 200, 69, 200, 200, 200, 49, 200, 102, 9, 200, 200, 19, 200, 90, 200, 200, 200, 200, 39, 83, 66, 54, 200, 115, 60, 200, 122, 200, 200, 34, 82, 200, 200, 200, 47, 78, 80, 87, 79, 200, 114, 200, 200, 200, 200, 61, 200, 200, 200, 25, 77, 86, 200, 30, 200, 111, 194, 200, 200, 200, 64, 200, 200, 200, 121], "policy_agent_policy_reward": [80.28494089306487, 36.97060345103429, 55.70222349685534, 10.964569247956312, -18.63192000824489, -2.4827808158812696, 69.23159115329948, 3.1105307901665102, 12.485952841511523, 31.79265894511532, 20.999208408851324, 60.83804972268496, 51.91342402010772, 17.17481793476494, 35.39919643867073, 6.355082167615977, 13.290697844304965, -12.42599103573852, 27.158550396484173, 49.524937059033945, 72.54260271882059, 22.414746097959544, 59.07971158013873, 60.80968902711804, 49.025074867316725, 30.51241808541274, 52.509158343413844, 61.59976212601765, 36.101648047749265, 23.152608227677433, 73.47155008999408, 66.00191919636369, 18.51842396708486, 25.75509446411727, 10.565899550206353, 50.478147919026, 34.76114320285711, 20.328258015947352, -4.309333641791806, 24.78780798277169, 6.079238298380507, 46.22052026886773, 40.542158811350255, 0.13849913538595793, 27.751354749228078, 35.2015582088938, 5.784430421808113, 28.12547492653, 78.41517637083408, 31.30797561278382, 18.740568409762304, -11.647370553836947, 28.27948899119299, 10.846804873315635, 62.35570046790251, 55.32604685871926, 66.29508541033181, 22.972207659971392, 48.370692082131086, 9.538817938903426, -19.763600518756434, 91.73042664931721, 21.045737997152788, 22.204747613931772, 31.153116200229775, 64.46470605223016, 45.0297167136637, 19.137066865573395, -15.869253184030676, 20.304054111417837, 19.21975207921057, 37.247855491942495, 70.89351803330193, 65.20929107443055, 25.332738703999226, 80.18251412272554, 38.95619769964554, 59.10412378586457, 9.741146979695007, 31.740997373975173, 75.85087672316283, 10.100088633315327, 37.33878789465406, 30.940230668732404, -5.792424791771252, 66.59289506569381, 34.48469746191919, 27.454993701264115, 15.373815827444808, 52.71475004768807, 28.613454466466067, 48.25376677119428, 12.14271612451589, 32.69315010674777, -2.2615751193603373, 41.019002031827384, 55.55322418045438, 66.22514925548771, 11.638647078223492, 47.20792640511037], "policy_adversary_policy_reward": [34.631324187950824, 45.65361670511405, 20.34852130443462, 16.6220821465997, 22.20540821018996, 33.49681528666538, 14.185587083659918, -3.2210178357036057, -5.518316676662547, -13.113603331582347, -27.6724836858544, 25.189702869973125, 39.42175337377077, 29.809837779528706, 8.106709515267763, -4.996178725101252, 13.619315303444147, -1.1333624619326237, 1.2358595653691893, 30.556799379746124, -4.0325930746937875, 25.03180148354511, 24.96431452014735, 35.87373520253763, 33.7145251603746, 18.198898859733124, 13.596582481515206, 3.5782354532497322, 20.690140874577594, 14.709055564093138, 7.6310891423569345, -1.276006974740957, 20.32724513728356, -7.036547292978593, -19.412737600308756, 6.986746564570236, 6.027029070386792, 21.131521326097374, 23.769755038125574, 25.75518202090835, 41.61413318744618, 30.928469531374425, 5.931618009480545, 16.483128088479, 26.000015641896752, 33.07969593824198, 29.680859919285595, 31.12882910783248, 33.3913425019672, 15.633732365349516, 28.682530733577803, 1.8298873518349374, 25.61376947381458, 26.895388869599255, 33.259735176970054, 28.340026949047598, 3.4524408447899138, 32.64920720295937, 11.034271063508232, 12.118337164169201, 43.31623537894656, 30.155314711047517, 30.15378887581919, 35.848130320544506, 5.77681544832039, 12.741608518764473, 3.266573869969502, 22.488520594147772, -8.762073297163083, 19.327972847369438, 25.040493962684764, 25.437653956341236, 10.690289653350835, 24.07085354950627, 24.059535080702076, -3.7312770647547246, 3.372402713129528, -7.681736354921334, 8.013923036531732, 16.77388494623995, 15.4689105867666, -9.389672288386095, 22.16400093476642, 24.05651933410131, 4.8784674093915354, 35.66369140195872, 2.7614964803801128, -2.622997344994155, 15.648819647212079, 12.102535102015995, 28.777724198259037, 6.42383401063476, -3.890935650794411, 9.675366072602523, 19.113089867094697, 9.012385059435303, 50.22145222692895, 28.193724143905108, 21.40537972950164, 9.902595883282185, 7.672488456161002, 11.068079953601302, -2.699102958500088, -8.948267595336844, 29.377120587134776, -1.097631595941781, -2.63938947311415, 13.486194346429786, 30.874773557918665, 31.480926909983854, 27.470565217253075, 27.85548164146618, 24.062389540627194, 42.23269586970458, -3.493739853397596, 26.46594751336899, 27.955476096677984, 20.415215985453088, -3.2111968505376236, 12.75001478944105, -10.971825793226145, -8.791774725530288, 52.75222235976899, 38.97820428954823, 6.841768916284369, 14.203969080868418, 9.987667363648235, 12.217080250283537, 18.871593717062517, 12.281522483167258, 35.46967553579831, 28.995030516431864, 34.870508178149876, 10.15920853551383, 7.763138854040209, 11.373928011533184, -1.4280632318194755, -14.4411899522112, 16.948349324857766, 3.3557047865600804, 1.4257378914923464, 17.79401418771822, 5.259092881317102, 31.988762610625393, 50.05631558145381, 20.8372024518481, 31.288211694849384, 33.92107937958115, 8.547083881352185, 16.785654822647043, 40.48265281143736, 39.699861311288174, 20.89556837289301, 18.06062932675253, 23.439080373289862, 35.66504341257471, 6.043658192012067, 3.697488787682939, 31.399636337542987, 0.3413610364321862, 31.888286492575613, 43.9625902305872, 8.48030251693637, 1.6197861163789646, 15.875565257360023, 21.46322263729403, 22.587207817829853, 8.353022850902551, -8.793047949900739, 3.0006231581294878, 33.25451964550378, 33.338375420190026, 16.88071113493194, 17.603986326987247, 22.951408934178403, 4.503584767085709, 20.25251699787077, -4.878701170425963, 14.611857405822626, 38.10289264186544, 8.119360614536287, 20.494093851929776, 21.03104907836335, 27.22271769283093, -0.29242710470459876, 12.43514322922049, 12.82106518407383, 19.87208492267394, -3.926657723760492, 1.6650826044001512, 26.723408605184055, 14.295593426643322, 44.021364727464956, 11.531859452989416, 23.07136044197709, 43.153788813510616, 17.940145966397626, -6.301498888174132, 28.556293791695257, 18.651632613415114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38689548664591966, "mean_inference_ms": 0.9579492026371537, "mean_action_processing_ms": 0.16415899308890897, "mean_env_wait_ms": 0.05659474912048844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003553152084350586, "StateBufferConnector_ms": 0.002542853355407715, "ViewRequirementAgentConnector_ms": 0.06641578674316406}, "num_episodes": 24, "episode_return_max": 183.4608532986345, "episode_return_min": -39.52720103751287, "episode_return_mean": 67.0323225628121}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 517.7956675655729, "num_env_steps_trained_throughput_per_sec": 517.7956675655729, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 8020.853, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8020.819, "sample_time_ms": 718.877, "learn_time_ms": 7290.32, "learn_throughput": 548.673, "synch_weights_time_ms": 11.089}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "training_iteration": 78, "trial_id": "eaa30_00000", "date": "2024-08-09_17-50-55", "timestamp": 1723240255, "time_this_iter_s": 7.729128837585449, "time_total_s": 641.4053628444672, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2896f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 641.4053628444672, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 22.07272727272727, "ram_util_percent": 80.3090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.467388048468443, "cur_kl_coeff": 0.3040929794311523, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.907203545898357, "policy_loss": -0.0014256559481115017, "vf_loss": 5.905278439244265, "vf_explained_var": 0.03778185387137075, "kl": 0.011018850966036399, "entropy": 0.988148623957205, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.371465560048819, "cur_kl_coeff": 0.4109890672858454, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.27708308349053, "policy_loss": 0.014435611196919733, "vf_loss": 7.254152694841226, "vf_explained_var": 0.023053520483275254, "kl": 0.0206690998893464, "entropy": 0.7520156284173329, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "env_runners": {"episode_reward_max": 183.4608532986345, "episode_reward_min": -39.52720103751287, "episode_reward_mean": 65.33686190802032, "episode_len_mean": 137.61, "episode_media": {}, "episodes_this_iter": 31, "episodes_timesteps_total": 13761, "policy_reward_min": {"agent_policy": -19.763600518756434, "adversary_policy": -20.732730574373083}, "policy_reward_max": {"agent_policy": 91.73042664931721, "adversary_policy": 52.75222235976899}, "policy_reward_mean": {"agent_policy": 32.66843095401016, "adversary_policy": 16.33421547700508}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.00383839272737, 37.036847934169714, 51.51018892823454, 21.131799100412714, 100.956295838052, 69.5222864057142, 40.65651603189471, -8.618667283583612, 49.57561596554339, 12.158476596761014, 92.44104053773546, 81.08431762270047, 0.27699827077191586, 55.50270949845614, 70.4031164177876, 11.568860843616225, 56.25094985306001, 156.83035274166815, 62.615951225567656, 37.48113681952454, -23.294741107674042, 56.558977982385954, 21.69360974663127, 124.71140093580499, 110.65209371743849, 132.59017082066356, 45.94441531994279, 96.7413841642622, 19.077635877806852, -39.52720103751287, 183.4608532986345, 42.091475994305576, 44.409495227863545, 62.30623240045955, 128.9294121044603, 90.05943342732735, 38.27413373114676, -31.738506368061337, 40.60810822283569, 38.439504158421116, 74.495710983885, 141.7870360666038, 130.41858214886105, 50.66547740799845, 160.36502824545107, 77.91239539929104, 118.20824757172917, 19.482293959390013, 63.48199474795035, 151.70175344632568, 20.200177266630668, 74.67757578930811, 61.88046133746481, -11.584849583542503, 133.1857901313876, 68.96939492383842, 54.90998740252823, 30.747631654889624, 105.42950009537614, 57.22690893293215, 96.50753354238856, 24.28543224903177, 65.38630021349552, -4.523150238720675, 82.03800406365475, 111.10644836090881, 132.4502985109754, 23.27729415644698, 94.41585281022076, 78.07345763007294, 112.85097797011187, 79.65025974261017, 34.56617318123635, 15.502581356236576, 96.29518508944523, 21.61289718618861, 42.76197224785277, -16.738042251222822, 113.77392145140806, 84.51753641095338, 29.05922587756718, 22.68660781835178, 135.0974982737886, 105.30581832812331, 81.99903858968977, 65.28857865761502, 66.19649740189612, 8.33337996546676, 95.37805753484187, 32.905019827469914, 54.329861768544845, 91.65973174629238, 39.63630604311764, 133.87936111313525, 77.97663537953024, 43.898085684646354, 131.76363645812472, 48.70388571736156, 29.009875537191853, 56.23053710972765], "episode_lengths": [200, 200, 200, 53, 200, 69, 200, 200, 200, 49, 200, 102, 9, 200, 200, 19, 200, 90, 200, 200, 200, 200, 39, 83, 66, 54, 200, 115, 60, 200, 122, 200, 200, 34, 82, 200, 200, 200, 47, 78, 80, 87, 79, 200, 114, 200, 200, 200, 200, 61, 200, 200, 200, 25, 77, 86, 200, 30, 200, 111, 194, 200, 200, 200, 64, 200, 200, 200, 121, 159, 110, 200, 13, 200, 200, 200, 200, 200, 200, 200, 200, 39, 87, 144, 93, 40, 79, 20, 95, 42, 200, 45, 88, 200, 200, 31, 55, 62, 93, 166], "policy_agent_policy_reward": [66.00191919636369, 18.51842396708486, 25.75509446411727, 10.565899550206353, 50.478147919026, 34.76114320285711, 20.328258015947352, -4.309333641791806, 24.78780798277169, 6.079238298380507, 46.22052026886773, 40.542158811350255, 0.13849913538595793, 27.751354749228078, 35.2015582088938, 5.784430421808113, 28.12547492653, 78.41517637083408, 31.30797561278382, 18.740568409762304, -11.647370553836947, 28.27948899119299, 10.846804873315635, 62.35570046790251, 55.32604685871926, 66.29508541033181, 22.972207659971392, 48.370692082131086, 9.538817938903426, -19.763600518756434, 91.73042664931721, 21.045737997152788, 22.204747613931772, 31.153116200229775, 64.46470605223016, 45.0297167136637, 19.137066865573395, -15.869253184030676, 20.304054111417837, 19.21975207921057, 37.247855491942495, 70.89351803330193, 65.20929107443055, 25.332738703999226, 80.18251412272554, 38.95619769964554, 59.10412378586457, 9.741146979695007, 31.740997373975173, 75.85087672316283, 10.100088633315327, 37.33878789465406, 30.940230668732404, -5.792424791771252, 66.59289506569381, 34.48469746191919, 27.454993701264115, 15.373815827444808, 52.71475004768807, 28.613454466466067, 48.25376677119428, 12.14271612451589, 32.69315010674777, -2.2615751193603373, 41.019002031827384, 55.55322418045438, 66.22514925548771, 11.638647078223492, 47.20792640511037, 39.03672881503646, 56.42548898505594, 39.82512987130509, 17.283086590618176, 7.751290678118288, 48.14759254472261, 10.806448593094316, 21.380986123926384, -8.369021125611408, 56.88696072570403, 42.2587682054767, 14.529612938783583, 11.343303909175892, 67.54874913689426, 52.65290916406167, 40.9995192948449, 32.644289328807524, 33.098248700948076, 4.166689982733381, 47.68902876742094, 16.45250991373496, 27.16493088427242, 45.82986587314617, 19.81815302155882, 66.93968055656761, 38.988317689765125, 21.949042842323177, 65.88181822906243, 24.35194285868077, 14.504937768595921, 28.115268554863828], "policy_adversary_policy_reward": [30.15378887581919, 35.848130320544506, 5.77681544832039, 12.741608518764473, 3.266573869969502, 22.488520594147772, -8.762073297163083, 19.327972847369438, 25.040493962684764, 25.437653956341236, 10.690289653350835, 24.07085354950627, 24.059535080702076, -3.7312770647547246, 3.372402713129528, -7.681736354921334, 8.013923036531732, 16.77388494623995, 15.4689105867666, -9.389672288386095, 22.16400093476642, 24.05651933410131, 4.8784674093915354, 35.66369140195872, 2.7614964803801128, -2.622997344994155, 15.648819647212079, 12.102535102015995, 28.777724198259037, 6.42383401063476, -3.890935650794411, 9.675366072602523, 19.113089867094697, 9.012385059435303, 50.22145222692895, 28.193724143905108, 21.40537972950164, 9.902595883282185, 7.672488456161002, 11.068079953601302, -2.699102958500088, -8.948267595336844, 29.377120587134776, -1.097631595941781, -2.63938947311415, 13.486194346429786, 30.874773557918665, 31.480926909983854, 27.470565217253075, 27.85548164146618, 24.062389540627194, 42.23269586970458, -3.493739853397596, 26.46594751336899, 27.955476096677984, 20.415215985453088, -3.2111968505376236, 12.75001478944105, -10.971825793226145, -8.791774725530288, 52.75222235976899, 38.97820428954823, 6.841768916284369, 14.203969080868418, 9.987667363648235, 12.217080250283537, 18.871593717062517, 12.281522483167258, 35.46967553579831, 28.995030516431864, 34.870508178149876, 10.15920853551383, 7.763138854040209, 11.373928011533184, -1.4280632318194755, -14.4411899522112, 16.948349324857766, 3.3557047865600804, 1.4257378914923464, 17.79401418771822, 5.259092881317102, 31.988762610625393, 50.05631558145381, 20.8372024518481, 31.288211694849384, 33.92107937958115, 8.547083881352185, 16.785654822647043, 40.48265281143736, 39.699861311288174, 20.89556837289301, 18.06062932675253, 23.439080373289862, 35.66504341257471, 6.043658192012067, 3.697488787682939, 31.399636337542987, 0.3413610364321862, 31.888286492575613, 43.9625902305872, 8.48030251693637, 1.6197861163789646, 15.875565257360023, 21.46322263729403, 22.587207817829853, 8.353022850902551, -8.793047949900739, 3.0006231581294878, 33.25451964550378, 33.338375420190026, 16.88071113493194, 17.603986326987247, 22.951408934178403, 4.503584767085709, 20.25251699787077, -4.878701170425963, 14.611857405822626, 38.10289264186544, 8.119360614536287, 20.494093851929776, 21.03104907836335, 27.22271769283093, -0.29242710470459876, 12.43514322922049, 12.82106518407383, 19.87208492267394, -3.926657723760492, 1.6650826044001512, 26.723408605184055, 14.295593426643322, 44.021364727464956, 11.531859452989416, 23.07136044197709, 43.153788813510616, 17.940145966397626, -6.301498888174132, 28.556293791695257, 18.651632613415114, 21.32368972724639, 17.71303908779007, 14.34467682490428, 42.08081216015166, 16.01612583493277, 23.80900403637232, 9.66876471156403, 7.614321879054145, -7.674980062521286, 15.426270740639573, 11.271720710816183, 36.875871833906444, 9.50828742628779, 1.2981611668065263, 7.29795462292325, 14.083031501003134, -2.1604518788828315, -6.208569246728576, 29.87910581711074, 27.007854908593288, 36.278631876370554, 5.980136329106147, 1.5002841372914126, 13.02932880149217, 32.07603448354897, -20.732730574373083, 32.692271801876736, 34.85647733501754, 23.057128311396493, 29.595780852665193, 34.37334007357685, 6.6261792212680515, 17.37005471148578, 15.274234617321742, 22.870162470685873, 10.228086230262196, -1.8377782410633507, 6.0044682237967315, 35.65201783058715, 12.037010936833799, 26.06596833217773, -9.613458418442766, 19.357826689563296, 7.807104194709122, 17.202481732340047, 28.627384140806136, 3.6484177958891326, 16.169735225669687, 34.80937359310778, 32.13030696345981, 18.308552098956582, 20.679765590808536, 13.500635873148664, 8.448406969174513, 28.4156665495832, 37.466151679479196, 33.9414362248353, -9.589493366154535, 4.318159273066843, 10.186778495529078, 12.632811498283218, 15.482457056580612]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3867987374652913, "mean_inference_ms": 0.9570344890202428, "mean_action_processing_ms": 0.16406212108806792, "mean_env_wait_ms": 0.056522107256260765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003825068473815918, "StateBufferConnector_ms": 0.0025290250778198242, "ViewRequirementAgentConnector_ms": 0.0659036636352539}, "num_episodes": 31, "episode_return_max": 183.4608532986345, "episode_return_min": -39.52720103751287, "episode_return_mean": 65.33686190802032}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 516.0551782211462, "num_env_steps_trained_throughput_per_sec": 516.0551782211462, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 948000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 7981.51, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7981.476, "sample_time_ms": 717.238, "learn_time_ms": 7252.668, "learn_throughput": 551.521, "synch_weights_time_ms": 11.033}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "training_iteration": 79, "trial_id": "eaa30_00000", "date": "2024-08-09_17-51-03", "timestamp": 1723240263, "time_this_iter_s": 7.755816221237183, "time_total_s": 649.1611790657043, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a28901f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 649.1611790657043, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 22.19090909090909, "ram_util_percent": 80.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8410175628289975, "cur_kl_coeff": 0.3040929794311523, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.356273220455836, "policy_loss": 0.0025322857522282493, "vf_loss": 6.351736129276336, "vf_explained_var": 0.038229716801769516, "kl": 0.006592748933668844, "entropy": 0.9570381222263215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.269945469684899, "cur_kl_coeff": 0.6164836009287684, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.725352821747462, "policy_loss": 0.014446929457092968, "vf_loss": 7.696909517049789, "vf_explained_var": 0.07085997344305119, "kl": 0.02270357125380542, "entropy": 0.7565398218731085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 183.4608532986345, "episode_reward_min": -39.52720103751287, "episode_reward_mean": 70.84312977371934, "episode_len_mean": 139.94, "episode_media": {}, "episodes_this_iter": 29, "episodes_timesteps_total": 13994, "policy_reward_min": {"agent_policy": -19.763600518756434, "adversary_policy": -20.732730574373083}, "policy_reward_max": {"agent_policy": 91.73042664931721, "adversary_policy": 52.75222235976899}, "policy_reward_mean": {"agent_policy": 35.42156488685967, "adversary_policy": 17.710782443429835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.52720103751287, 183.4608532986345, 42.091475994305576, 44.409495227863545, 62.30623240045955, 128.9294121044603, 90.05943342732735, 38.27413373114676, -31.738506368061337, 40.60810822283569, 38.439504158421116, 74.495710983885, 141.7870360666038, 130.41858214886105, 50.66547740799845, 160.36502824545107, 77.91239539929104, 118.20824757172917, 19.482293959390013, 63.48199474795035, 151.70175344632568, 20.200177266630668, 74.67757578930811, 61.88046133746481, -11.584849583542503, 133.1857901313876, 68.96939492383842, 54.90998740252823, 30.747631654889624, 105.42950009537614, 57.22690893293215, 96.50753354238856, 24.28543224903177, 65.38630021349552, -4.523150238720675, 82.03800406365475, 111.10644836090881, 132.4502985109754, 23.27729415644698, 94.41585281022076, 78.07345763007294, 112.85097797011187, 79.65025974261017, 34.56617318123635, 15.502581356236576, 96.29518508944523, 21.61289718618861, 42.76197224785277, -16.738042251222822, 113.77392145140806, 84.51753641095338, 29.05922587756718, 22.68660781835178, 135.0974982737886, 105.30581832812331, 81.99903858968977, 65.28857865761502, 66.19649740189612, 8.33337996546676, 95.37805753484187, 32.905019827469914, 54.329861768544845, 91.65973174629238, 39.63630604311764, 133.87936111313525, 77.97663537953024, 43.898085684646354, 131.76363645812472, 48.70388571736156, 29.009875537191853, 56.23053710972765, 142.5019438418867, 52.81620257256725, 125.20085576767278, 75.074719715281, 101.64008284696239, 54.210862016977615, 51.377959840963584, 78.34010565305249, 82.86252817740176, 37.85637503557424, 67.38645262831082, 68.74516992359617, 75.59848109007012, 49.138117035138784, 123.88639127857425, 8.961227854700631, 68.72982193173436, 84.43858947582842, 96.42148408103711, 88.010313140313, 83.65367042862151, 54.02268187730839, 76.94265569340237, 94.96163355746911, 122.82083109862324, 106.77607615914016, 22.963225021878102, 60.463171693700986, 109.88873633019038], "episode_lengths": [200, 122, 200, 200, 34, 82, 200, 200, 200, 47, 78, 80, 87, 79, 200, 114, 200, 200, 200, 200, 61, 200, 200, 200, 25, 77, 86, 200, 30, 200, 111, 194, 200, 200, 200, 64, 200, 200, 200, 121, 159, 110, 200, 13, 200, 200, 200, 200, 200, 200, 200, 200, 39, 87, 144, 93, 40, 79, 20, 95, 42, 200, 45, 88, 200, 200, 31, 55, 62, 93, 166, 200, 200, 200, 200, 93, 200, 200, 200, 181, 143, 156, 71, 164, 53, 56, 14, 200, 200, 76, 200, 32, 200, 72, 200, 200, 73, 200, 57, 200], "policy_agent_policy_reward": [-19.763600518756434, 91.73042664931721, 21.045737997152788, 22.204747613931772, 31.153116200229775, 64.46470605223016, 45.0297167136637, 19.137066865573395, -15.869253184030676, 20.304054111417837, 19.21975207921057, 37.247855491942495, 70.89351803330193, 65.20929107443055, 25.332738703999226, 80.18251412272554, 38.95619769964554, 59.10412378586457, 9.741146979695007, 31.740997373975173, 75.85087672316283, 10.100088633315327, 37.33878789465406, 30.940230668732404, -5.792424791771252, 66.59289506569381, 34.48469746191919, 27.454993701264115, 15.373815827444808, 52.71475004768807, 28.613454466466067, 48.25376677119428, 12.14271612451589, 32.69315010674777, -2.2615751193603373, 41.019002031827384, 55.55322418045438, 66.22514925548771, 11.638647078223492, 47.20792640511037, 39.03672881503646, 56.42548898505594, 39.82512987130509, 17.283086590618176, 7.751290678118288, 48.14759254472261, 10.806448593094316, 21.380986123926384, -8.369021125611408, 56.88696072570403, 42.2587682054767, 14.529612938783583, 11.343303909175892, 67.54874913689426, 52.65290916406167, 40.9995192948449, 32.644289328807524, 33.098248700948076, 4.166689982733381, 47.68902876742094, 16.45250991373496, 27.16493088427242, 45.82986587314617, 19.81815302155882, 66.93968055656761, 38.988317689765125, 21.949042842323177, 65.88181822906243, 24.35194285868077, 14.504937768595921, 28.115268554863828, 71.25097192094336, 26.408101286283628, 62.60042788383637, 37.53735985764048, 50.820041423481186, 27.1054310084888, 25.688979920481792, 39.170052826526245, 41.43126408870088, 18.92818751778712, 33.693226314155396, 34.37258496179809, 37.79924054503506, 24.569058517569392, 61.94319563928714, 4.4806139273503165, 34.36491096586718, 42.21929473791421, 48.210742040518554, 44.0051565701565, 41.82683521431076, 27.011340938654193, 38.47132784670119, 47.48081677873458, 61.41041554931162, 53.38803807957003, 11.481612510939069, 30.23158584685049, 54.944368165095185], "policy_adversary_policy_reward": [-10.971825793226145, -8.791774725530288, 52.75222235976899, 38.97820428954823, 6.841768916284369, 14.203969080868418, 9.987667363648235, 12.217080250283537, 18.871593717062517, 12.281522483167258, 35.46967553579831, 28.995030516431864, 34.870508178149876, 10.15920853551383, 7.763138854040209, 11.373928011533184, -1.4280632318194755, -14.4411899522112, 16.948349324857766, 3.3557047865600804, 1.4257378914923464, 17.79401418771822, 5.259092881317102, 31.988762610625393, 50.05631558145381, 20.8372024518481, 31.288211694849384, 33.92107937958115, 8.547083881352185, 16.785654822647043, 40.48265281143736, 39.699861311288174, 20.89556837289301, 18.06062932675253, 23.439080373289862, 35.66504341257471, 6.043658192012067, 3.697488787682939, 31.399636337542987, 0.3413610364321862, 31.888286492575613, 43.9625902305872, 8.48030251693637, 1.6197861163789646, 15.875565257360023, 21.46322263729403, 22.587207817829853, 8.353022850902551, -8.793047949900739, 3.0006231581294878, 33.25451964550378, 33.338375420190026, 16.88071113493194, 17.603986326987247, 22.951408934178403, 4.503584767085709, 20.25251699787077, -4.878701170425963, 14.611857405822626, 38.10289264186544, 8.119360614536287, 20.494093851929776, 21.03104907836335, 27.22271769283093, -0.29242710470459876, 12.43514322922049, 12.82106518407383, 19.87208492267394, -3.926657723760492, 1.6650826044001512, 26.723408605184055, 14.295593426643322, 44.021364727464956, 11.531859452989416, 23.07136044197709, 43.153788813510616, 17.940145966397626, -6.301498888174132, 28.556293791695257, 18.651632613415114, 21.32368972724639, 17.71303908779007, 14.34467682490428, 42.08081216015166, 16.01612583493277, 23.80900403637232, 9.66876471156403, 7.614321879054145, -7.674980062521286, 15.426270740639573, 11.271720710816183, 36.875871833906444, 9.50828742628779, 1.2981611668065263, 7.29795462292325, 14.083031501003134, -2.1604518788828315, -6.208569246728576, 29.87910581711074, 27.007854908593288, 36.278631876370554, 5.980136329106147, 1.5002841372914126, 13.02932880149217, 32.07603448354897, -20.732730574373083, 32.692271801876736, 34.85647733501754, 23.057128311396493, 29.595780852665193, 34.37334007357685, 6.6261792212680515, 17.37005471148578, 15.274234617321742, 22.870162470685873, 10.228086230262196, -1.8377782410633507, 6.0044682237967315, 35.65201783058715, 12.037010936833799, 26.06596833217773, -9.613458418442766, 19.357826689563296, 7.807104194709122, 17.202481732340047, 28.627384140806136, 3.6484177958891326, 16.169735225669687, 34.80937359310778, 32.13030696345981, 18.308552098956582, 20.679765590808536, 13.500635873148664, 8.448406969174513, 28.4156665495832, 37.466151679479196, 33.9414362248353, -9.589493366154535, 4.318159273066843, 10.186778495529078, 12.632811498283218, 15.482457056580612, 45.448980115243515, 25.801991805699853, 16.60933708928183, 9.798764197001798, 30.15650831244696, 32.443919571389415, 20.865486754002816, 16.671873103637665, 22.31542052420648, 28.504620899274705, -2.0867031613151497, 29.19213416980395, 13.124165897618216, 12.564814022863576, 14.106303115347199, 25.06374971117905, 31.87623180818722, 9.555032280513657, 9.759061935215907, 9.169125582571212, 29.836064408985767, 3.8571619051696278, 16.244296364092975, 18.12828859770511, 22.712352490566378, 15.086888054468687, 28.328107258631704, -3.759048741062312, 39.520035492371534, 22.423160146915595, 6.9858246118583205, -2.505210684508004, 6.292479527402982, 28.0724314384642, 18.52111556650312, 23.69817917141109, 30.97360630422503, 17.237135736293514, 10.575404638339627, 33.42975193181687, 15.293914095370539, 26.532921118940216, 20.673271529556686, 6.338069409097509, 18.466873477197048, 20.004454369504145, 24.474485847808396, 23.006330930926183, 27.916849141053888, 33.493566408257735, 37.36666528488439, 16.021372794685643, 12.698810410940215, -1.2171979000011461, 18.44596560771206, 11.785620239138426, 22.610496613554417, 32.33387155154077]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38665057798222335, "mean_inference_ms": 0.9571436807756792, "mean_action_processing_ms": 0.1637815839466346, "mean_env_wait_ms": 0.05637080598537786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003735065460205078, "StateBufferConnector_ms": 0.002510547637939453, "ViewRequirementAgentConnector_ms": 0.06497478485107422}, "num_episodes": 29, "episode_return_max": 183.4608532986345, "episode_return_min": -39.52720103751287, "episode_return_mean": 70.84312977371934}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 515.4827967167207, "num_env_steps_trained_throughput_per_sec": 515.4827967167207, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 7936.677, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7936.642, "sample_time_ms": 715.744, "learn_time_ms": 7209.4, "learn_throughput": 554.831, "synch_weights_time_ms": 10.962}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 80, "trial_id": "eaa30_00000", "date": "2024-08-09_17-51-11", "timestamp": 1723240271, "time_this_iter_s": 7.764500141143799, "time_total_s": 656.9256792068481, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2890430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 656.9256792068481, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 22.316666666666666, "ram_util_percent": 80.00833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.329055722191851, "cur_kl_coeff": 0.3040929794311523, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.774433701631254, "policy_loss": 0.00015665377655298148, "vf_loss": 7.772662115601635, "vf_explained_var": -0.002381610050403252, "kl": 0.005310623977387512, "entropy": 0.9586718221505482, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.169358915866663, "cur_kl_coeff": 0.9247254013931522, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.495168240865071, "policy_loss": 0.018236274640851965, "vf_loss": 8.451896398266156, "vf_explained_var": 0.042782095695535344, "kl": 0.027073484587405498, "entropy": 0.7428807867070039, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "env_runners": {"episode_reward_max": 142.5019438418867, "episode_reward_min": -16.738042251222822, "episode_reward_mean": 78.22650281154432, "episode_len_mean": 135.13, "episode_media": {}, "episodes_this_iter": 33, "episodes_timesteps_total": 13513, "policy_reward_min": {"agent_policy": -8.369021125611408, "adversary_policy": -20.732730574373083}, "policy_reward_max": {"agent_policy": 71.25097192094336, "adversary_policy": 45.448980115243515}, "policy_reward_mean": {"agent_policy": 39.11325140577216, "adversary_policy": 19.55662570288608}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.38630021349552, -4.523150238720675, 82.03800406365475, 111.10644836090881, 132.4502985109754, 23.27729415644698, 94.41585281022076, 78.07345763007294, 112.85097797011187, 79.65025974261017, 34.56617318123635, 15.502581356236576, 96.29518508944523, 21.61289718618861, 42.76197224785277, -16.738042251222822, 113.77392145140806, 84.51753641095338, 29.05922587756718, 22.68660781835178, 135.0974982737886, 105.30581832812331, 81.99903858968977, 65.28857865761502, 66.19649740189612, 8.33337996546676, 95.37805753484187, 32.905019827469914, 54.329861768544845, 91.65973174629238, 39.63630604311764, 133.87936111313525, 77.97663537953024, 43.898085684646354, 131.76363645812472, 48.70388571736156, 29.009875537191853, 56.23053710972765, 142.5019438418867, 52.81620257256725, 125.20085576767278, 75.074719715281, 101.64008284696239, 54.210862016977615, 51.377959840963584, 78.34010565305249, 82.86252817740176, 37.85637503557424, 67.38645262831082, 68.74516992359617, 75.59848109007012, 49.138117035138784, 123.88639127857425, 8.961227854700631, 68.72982193173436, 84.43858947582842, 96.42148408103711, 88.010313140313, 83.65367042862151, 54.02268187730839, 76.94265569340237, 94.96163355746911, 122.82083109862324, 106.77607615914016, 22.963225021878102, 60.463171693700986, 109.88873633019038, 91.66414044618546, 48.1962551576362, 107.88629025122012, 89.54340613351641, 130.20263846602, 91.2339966978082, 104.58386536927333, 114.83764591870224, 47.70635105184394, 111.91807990495754, 79.34198578196668, 131.74679070505914, 120.57110037039243, 72.10673678845886, 133.37341604440056, 50.56261749081218, 94.31376541000145, 135.98229692697421, 48.34058118273458, 91.10305147000645, 125.71793880037578, 73.33558896758018, 62.92967704202103, 69.44262252995402, 119.54828928250018, 28.9964680891146, 58.47391585938492, 134.58933422632109, 98.83074654464875, 73.48145751878651, 46.96644153635673, 115.35356120850467, 137.72325548857853], "episode_lengths": [200, 200, 64, 200, 200, 200, 121, 159, 110, 200, 13, 200, 200, 200, 200, 200, 200, 200, 200, 39, 87, 144, 93, 40, 79, 20, 95, 42, 200, 45, 88, 200, 200, 31, 55, 62, 93, 166, 200, 200, 200, 200, 93, 200, 200, 200, 181, 143, 156, 71, 164, 53, 56, 14, 200, 200, 76, 200, 32, 200, 72, 200, 200, 73, 200, 57, 200, 184, 32, 98, 99, 80, 200, 190, 132, 190, 200, 102, 101, 100, 200, 175, 66, 74, 104, 90, 200, 200, 176, 44, 101, 66, 53, 195, 200, 77, 154, 56, 136, 151], "policy_agent_policy_reward": [32.69315010674777, -2.2615751193603373, 41.019002031827384, 55.55322418045438, 66.22514925548771, 11.638647078223492, 47.20792640511037, 39.03672881503646, 56.42548898505594, 39.82512987130509, 17.283086590618176, 7.751290678118288, 48.14759254472261, 10.806448593094316, 21.380986123926384, -8.369021125611408, 56.88696072570403, 42.2587682054767, 14.529612938783583, 11.343303909175892, 67.54874913689426, 52.65290916406167, 40.9995192948449, 32.644289328807524, 33.098248700948076, 4.166689982733381, 47.68902876742094, 16.45250991373496, 27.16493088427242, 45.82986587314617, 19.81815302155882, 66.93968055656761, 38.988317689765125, 21.949042842323177, 65.88181822906243, 24.35194285868077, 14.504937768595921, 28.115268554863828, 71.25097192094336, 26.408101286283628, 62.60042788383637, 37.53735985764048, 50.820041423481186, 27.1054310084888, 25.688979920481792, 39.170052826526245, 41.43126408870088, 18.92818751778712, 33.693226314155396, 34.37258496179809, 37.79924054503506, 24.569058517569392, 61.94319563928714, 4.4806139273503165, 34.36491096586718, 42.21929473791421, 48.210742040518554, 44.0051565701565, 41.82683521431076, 27.011340938654193, 38.47132784670119, 47.48081677873458, 61.41041554931162, 53.38803807957003, 11.481612510939069, 30.23158584685049, 54.944368165095185, 45.83207022309273, 24.09812757881809, 53.943145125610066, 44.77170306675818, 65.10131923301002, 45.61699834890409, 52.29193268463666, 57.41882295935116, 23.85317552592197, 55.959039952478776, 39.67099289098334, 65.8733953525296, 60.285550185196215, 36.05336839422943, 66.68670802220032, 25.281308745406093, 47.15688270500075, 67.99114846348711, 24.170290591367284, 45.55152573500321, 62.85896940018789, 36.66779448379009, 31.464838521010506, 34.72131126497701, 59.774144641250096, 14.498234044557297, 29.23695792969247, 67.29466711316054, 49.415373272324366, 36.74072875939326, 23.483220768178363, 57.676780604252336, 68.86162774428925], "policy_adversary_policy_reward": [12.82106518407383, 19.87208492267394, -3.926657723760492, 1.6650826044001512, 26.723408605184055, 14.295593426643322, 44.021364727464956, 11.531859452989416, 23.07136044197709, 43.153788813510616, 17.940145966397626, -6.301498888174132, 28.556293791695257, 18.651632613415114, 21.32368972724639, 17.71303908779007, 14.34467682490428, 42.08081216015166, 16.01612583493277, 23.80900403637232, 9.66876471156403, 7.614321879054145, -7.674980062521286, 15.426270740639573, 11.271720710816183, 36.875871833906444, 9.50828742628779, 1.2981611668065263, 7.29795462292325, 14.083031501003134, -2.1604518788828315, -6.208569246728576, 29.87910581711074, 27.007854908593288, 36.278631876370554, 5.980136329106147, 1.5002841372914126, 13.02932880149217, 32.07603448354897, -20.732730574373083, 32.692271801876736, 34.85647733501754, 23.057128311396493, 29.595780852665193, 34.37334007357685, 6.6261792212680515, 17.37005471148578, 15.274234617321742, 22.870162470685873, 10.228086230262196, -1.8377782410633507, 6.0044682237967315, 35.65201783058715, 12.037010936833799, 26.06596833217773, -9.613458418442766, 19.357826689563296, 7.807104194709122, 17.202481732340047, 28.627384140806136, 3.6484177958891326, 16.169735225669687, 34.80937359310778, 32.13030696345981, 18.308552098956582, 20.679765590808536, 13.500635873148664, 8.448406969174513, 28.4156665495832, 37.466151679479196, 33.9414362248353, -9.589493366154535, 4.318159273066843, 10.186778495529078, 12.632811498283218, 15.482457056580612, 45.448980115243515, 25.801991805699853, 16.60933708928183, 9.798764197001798, 30.15650831244696, 32.443919571389415, 20.865486754002816, 16.671873103637665, 22.31542052420648, 28.504620899274705, -2.0867031613151497, 29.19213416980395, 13.124165897618216, 12.564814022863576, 14.106303115347199, 25.06374971117905, 31.87623180818722, 9.555032280513657, 9.759061935215907, 9.169125582571212, 29.836064408985767, 3.8571619051696278, 16.244296364092975, 18.12828859770511, 22.712352490566378, 15.086888054468687, 28.328107258631704, -3.759048741062312, 39.520035492371534, 22.423160146915595, 6.9858246118583205, -2.505210684508004, 6.292479527402982, 28.0724314384642, 18.52111556650312, 23.69817917141109, 30.97360630422503, 17.237135736293514, 10.575404638339627, 33.42975193181687, 15.293914095370539, 26.532921118940216, 20.673271529556686, 6.338069409097509, 18.466873477197048, 20.004454369504145, 24.474485847808396, 23.006330930926183, 27.916849141053888, 33.493566408257735, 37.36666528488439, 16.021372794685643, 12.698810410940215, -1.2171979000011461, 18.44596560771206, 11.785620239138426, 22.610496613554417, 32.33387155154077, 21.048926158164665, 24.78314406492806, 1.6269576388521472, 22.471169939965943, 32.94537095281757, 20.99777417279251, 26.895340826807434, 17.87636223995076, 40.26538947351517, 24.835929759494853, 19.801689038237765, 25.81530931066633, 30.165643275253707, 22.126289409382963, 22.629207325135596, 34.78961563421557, 17.111893445357566, 6.741282080564403, 32.461946466855274, 23.4970934856235, 18.88564032578509, 20.785352565198252, 35.548301918264244, 30.325093434265334, 25.355152448058945, 34.93039773713726, 37.95009992107112, -1.896731526841684, 34.10252456074275, 32.584183461457556, 21.623148087048055, 3.658160658358037, 6.522166075793981, 40.63471662920675, 28.317345297139294, 39.6738031663478, 17.47693761862646, 6.693352972740822, 33.168346388532925, 12.383179346470289, 27.83152013637362, 35.02744926381427, 16.384785505359826, 20.28300897843026, 16.13418244413505, 15.330656076875457, 19.945164635666366, 14.776146629310645, 27.53600947820359, 32.23813516304651, 23.218592262852443, -8.720358218295146, 9.233972826352876, 20.00298510333959, 37.35397861142907, 29.940688501731465, 22.194638209844335, 27.220735062480028, 4.385443919341434, 32.355284840051816, 6.120000927558722, 17.363219840619642, 17.5735418071391, 40.10323879711323, 30.636375813450822, 38.22525193083845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3865589883781634, "mean_inference_ms": 0.9562166777745367, "mean_action_processing_ms": 0.1638641669559289, "mean_env_wait_ms": 0.056369618623348196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003539443016052246, "StateBufferConnector_ms": 0.002423524856567383, "ViewRequirementAgentConnector_ms": 0.06397628784179688}, "num_episodes": 33, "episode_return_max": 142.5019438418867, "episode_return_min": -16.738042251222822, "episode_return_mean": 78.22650281154432}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 488.945976376435, "num_env_steps_trained_throughput_per_sec": 488.945976376435, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 972000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 7963.285, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7963.249, "sample_time_ms": 718.267, "learn_time_ms": 7233.4, "learn_throughput": 552.99, "synch_weights_time_ms": 11.04}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "training_iteration": 81, "trial_id": "eaa30_00000", "date": "2024-08-09_17-51-19", "timestamp": 1723240279, "time_this_iter_s": 8.185565948486328, "time_total_s": 665.1112451553345, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2890670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 665.1112451553345, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 26.818181818181817, "ram_util_percent": 79.87272727272726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.425128356426481, "cur_kl_coeff": 0.3040929794311523, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.141271835155588, "policy_loss": -0.000615709576085604, "vf_loss": 6.140470918019613, "vf_explained_var": 0.039455389755743524, "kl": 0.004658499105880284, "entropy": 0.9596262312755383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.265815831099947, "cur_kl_coeff": 1.3870881020897283, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.006374810139338, "policy_loss": 0.02006524790194817, "vf_loss": 7.956670742730299, "vf_explained_var": -0.0037090927983323735, "kl": 0.0213676508613086, "entropy": 0.7520208798969785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "env_runners": {"episode_reward_max": 163.37863191107354, "episode_reward_min": -37.093403555529875, "episode_reward_mean": 75.50521309419544, "episode_len_mean": 136.29, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 13629, "policy_reward_min": {"agent_policy": -18.54670177776495, "adversary_policy": -15.066275508245162}, "policy_reward_max": {"agent_policy": 81.68931595553687, "adversary_policy": 45.448980115243515}, "policy_reward_mean": {"agent_policy": 37.75260654709773, "adversary_policy": 18.87630327354886}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.33337996546676, 95.37805753484187, 32.905019827469914, 54.329861768544845, 91.65973174629238, 39.63630604311764, 133.87936111313525, 77.97663537953024, 43.898085684646354, 131.76363645812472, 48.70388571736156, 29.009875537191853, 56.23053710972765, 142.5019438418867, 52.81620257256725, 125.20085576767278, 75.074719715281, 101.64008284696239, 54.210862016977615, 51.377959840963584, 78.34010565305249, 82.86252817740176, 37.85637503557424, 67.38645262831082, 68.74516992359617, 75.59848109007012, 49.138117035138784, 123.88639127857425, 8.961227854700631, 68.72982193173436, 84.43858947582842, 96.42148408103711, 88.010313140313, 83.65367042862151, 54.02268187730839, 76.94265569340237, 94.96163355746911, 122.82083109862324, 106.77607615914016, 22.963225021878102, 60.463171693700986, 109.88873633019038, 91.66414044618546, 48.1962551576362, 107.88629025122012, 89.54340613351641, 130.20263846602, 91.2339966978082, 104.58386536927333, 114.83764591870224, 47.70635105184394, 111.91807990495754, 79.34198578196668, 131.74679070505914, 120.57110037039243, 72.10673678845886, 133.37341604440056, 50.56261749081218, 94.31376541000145, 135.98229692697421, 48.34058118273458, 91.10305147000645, 125.71793880037578, 73.33558896758018, 62.92967704202103, 69.44262252995402, 119.54828928250018, 28.9964680891146, 58.47391585938492, 134.58933422632109, 98.83074654464875, 73.48145751878651, 46.96644153635673, 115.35356120850467, 137.72325548857853, 60.73702720154815, 25.77575675523652, 17.918538482737972, -37.093403555529875, 30.480098725315827, 79.69104691323793, 111.37019012319485, 45.6278261996389, 20.027737425468064, 52.92093934050912, -9.668202726301203, -10.360967839717688, 107.58958295001028, 84.52950260905078, 105.17563593826218, 163.37863191107354, 49.588130540369754, 102.1255171379849, -11.13465249110537, 80.95470261401724, 83.80618322660668, 72.06626478074385, 9.572624072034783, 18.54443127881941, 146.89911949081178], "episode_lengths": [20, 95, 42, 200, 45, 88, 200, 200, 31, 55, 62, 93, 166, 200, 200, 200, 200, 93, 200, 200, 200, 181, 143, 156, 71, 164, 53, 56, 14, 200, 200, 76, 200, 32, 200, 72, 200, 200, 73, 200, 57, 200, 184, 32, 98, 99, 80, 200, 190, 132, 190, 200, 102, 101, 100, 200, 175, 66, 74, 104, 90, 200, 200, 176, 44, 101, 66, 53, 195, 200, 77, 154, 56, 136, 151, 200, 20, 200, 200, 200, 200, 200, 200, 15, 49, 200, 200, 200, 200, 200, 86, 200, 79, 200, 170, 200, 134, 37, 200, 75], "policy_agent_policy_reward": [4.166689982733381, 47.68902876742094, 16.45250991373496, 27.16493088427242, 45.82986587314617, 19.81815302155882, 66.93968055656761, 38.988317689765125, 21.949042842323177, 65.88181822906243, 24.35194285868077, 14.504937768595921, 28.115268554863828, 71.25097192094336, 26.408101286283628, 62.60042788383637, 37.53735985764048, 50.820041423481186, 27.1054310084888, 25.688979920481792, 39.170052826526245, 41.43126408870088, 18.92818751778712, 33.693226314155396, 34.37258496179809, 37.79924054503506, 24.569058517569392, 61.94319563928714, 4.4806139273503165, 34.36491096586718, 42.21929473791421, 48.210742040518554, 44.0051565701565, 41.82683521431076, 27.011340938654193, 38.47132784670119, 47.48081677873458, 61.41041554931162, 53.38803807957003, 11.481612510939069, 30.23158584685049, 54.944368165095185, 45.83207022309273, 24.09812757881809, 53.943145125610066, 44.77170306675818, 65.10131923301002, 45.61699834890409, 52.29193268463666, 57.41882295935116, 23.85317552592197, 55.959039952478776, 39.67099289098334, 65.8733953525296, 60.285550185196215, 36.05336839422943, 66.68670802220032, 25.281308745406093, 47.15688270500075, 67.99114846348711, 24.170290591367284, 45.55152573500321, 62.85896940018789, 36.66779448379009, 31.464838521010506, 34.72131126497701, 59.774144641250096, 14.498234044557297, 29.23695792969247, 67.29466711316054, 49.415373272324366, 36.74072875939326, 23.483220768178363, 57.676780604252336, 68.86162774428925, 30.368513600774087, 12.88787837761826, 8.959269241368993, -18.54670177776495, 15.240049362657917, 39.84552345661896, 55.68509506159742, 22.813913099819445, 10.013868712734027, 26.46046967025457, -4.834101363150591, -5.180483919858858, 53.794791475005155, 42.26475130452539, 52.58781796913108, 81.68931595553687, 24.794065270184877, 51.062758568992464, -5.567326245552685, 40.47735130700861, 41.903091613303346, 36.03313239037192, 4.786312036017392, 9.272215639409737, 73.4495597454059], "policy_adversary_policy_reward": [-1.8377782410633507, 6.0044682237967315, 35.65201783058715, 12.037010936833799, 26.06596833217773, -9.613458418442766, 19.357826689563296, 7.807104194709122, 17.202481732340047, 28.627384140806136, 3.6484177958891326, 16.169735225669687, 34.80937359310778, 32.13030696345981, 18.308552098956582, 20.679765590808536, 13.500635873148664, 8.448406969174513, 28.4156665495832, 37.466151679479196, 33.9414362248353, -9.589493366154535, 4.318159273066843, 10.186778495529078, 12.632811498283218, 15.482457056580612, 45.448980115243515, 25.801991805699853, 16.60933708928183, 9.798764197001798, 30.15650831244696, 32.443919571389415, 20.865486754002816, 16.671873103637665, 22.31542052420648, 28.504620899274705, -2.0867031613151497, 29.19213416980395, 13.124165897618216, 12.564814022863576, 14.106303115347199, 25.06374971117905, 31.87623180818722, 9.555032280513657, 9.759061935215907, 9.169125582571212, 29.836064408985767, 3.8571619051696278, 16.244296364092975, 18.12828859770511, 22.712352490566378, 15.086888054468687, 28.328107258631704, -3.759048741062312, 39.520035492371534, 22.423160146915595, 6.9858246118583205, -2.505210684508004, 6.292479527402982, 28.0724314384642, 18.52111556650312, 23.69817917141109, 30.97360630422503, 17.237135736293514, 10.575404638339627, 33.42975193181687, 15.293914095370539, 26.532921118940216, 20.673271529556686, 6.338069409097509, 18.466873477197048, 20.004454369504145, 24.474485847808396, 23.006330930926183, 27.916849141053888, 33.493566408257735, 37.36666528488439, 16.021372794685643, 12.698810410940215, -1.2171979000011461, 18.44596560771206, 11.785620239138426, 22.610496613554417, 32.33387155154077, 21.048926158164665, 24.78314406492806, 1.6269576388521472, 22.471169939965943, 32.94537095281757, 20.99777417279251, 26.895340826807434, 17.87636223995076, 40.26538947351517, 24.835929759494853, 19.801689038237765, 25.81530931066633, 30.165643275253707, 22.126289409382963, 22.629207325135596, 34.78961563421557, 17.111893445357566, 6.741282080564403, 32.461946466855274, 23.4970934856235, 18.88564032578509, 20.785352565198252, 35.548301918264244, 30.325093434265334, 25.355152448058945, 34.93039773713726, 37.95009992107112, -1.896731526841684, 34.10252456074275, 32.584183461457556, 21.623148087048055, 3.658160658358037, 6.522166075793981, 40.63471662920675, 28.317345297139294, 39.6738031663478, 17.47693761862646, 6.693352972740822, 33.168346388532925, 12.383179346470289, 27.83152013637362, 35.02744926381427, 16.384785505359826, 20.28300897843026, 16.13418244413505, 15.330656076875457, 19.945164635666366, 14.776146629310645, 27.53600947820359, 32.23813516304651, 23.218592262852443, -8.720358218295146, 9.233972826352876, 20.00298510333959, 37.35397861142907, 29.940688501731465, 22.194638209844335, 27.220735062480028, 4.385443919341434, 32.355284840051816, 6.120000927558722, 17.363219840619642, 17.5735418071391, 40.10323879711323, 30.636375813450822, 38.22525193083845, 11.8850979504921, 18.483415650281984, 4.2871225811651925, 8.600755796453068, -1.470180593547319, 10.429449834916309, -10.413749155934156, -8.132952621830793, 21.11743963255107, -5.877390269893148, 15.157517332084907, 24.688006124534056, 29.942619121063085, 25.742475940534337, 5.338466294042149, 17.475446805777295, 7.212133266779748, 2.8017354459542787, 2.0289258391694602, 24.43154383108511, 10.232174145094568, -15.066275508245162, 0.22148655189570476, -5.401970471754563, 33.60610679677011, 20.188684678235038, 11.569964335875987, 30.694786968649403, 36.43749583256355, 16.150322136567524, 43.33334892195726, 38.355967033579574, 5.135777282535301, 19.658287987649576, 28.64937388393585, 22.4133846850566, -9.212954913882328, 3.6456286683296426, 16.989741423008933, 23.48760988399968, 18.383443385497785, 23.519648227805554, 28.729890355834975, 7.303242034536948, -5.950123964779923, 10.736436000797315, 7.791507222459959, 1.4807084169497742, 36.95664336573487, 36.49291637967105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38637954032932553, "mean_inference_ms": 0.9583773276406445, "mean_action_processing_ms": 0.16394160031870292, "mean_env_wait_ms": 0.05635892159374707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034072399139404297, "StateBufferConnector_ms": 0.0024857521057128906, "ViewRequirementAgentConnector_ms": 0.0656052827835083}, "num_episodes": 25, "episode_return_max": 163.37863191107354, "episode_return_min": -37.093403555529875, "episode_return_mean": 75.50521309419544}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.5631970004696, "num_env_steps_trained_throughput_per_sec": 485.5631970004696, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 7986.203, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7986.166, "sample_time_ms": 754.141, "learn_time_ms": 7220.576, "learn_throughput": 553.972, "synch_weights_time_ms": 10.905}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "training_iteration": 82, "trial_id": "eaa30_00000", "date": "2024-08-09_17-51-28", "timestamp": 1723240288, "time_this_iter_s": 8.24198603630066, "time_total_s": 673.3532311916351, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2888ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 673.3532311916351, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 25.683333333333334, "ram_util_percent": 78.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.023639679585815, "cur_kl_coeff": 0.15204648971557616, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.215996316879514, "policy_loss": -0.00022088221505915046, "vf_loss": 6.215381331418557, "vf_explained_var": 0.04371172826756876, "kl": 0.005497552762571821, "entropy": 0.9359548355536486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.044642738625408, "cur_kl_coeff": 2.0806321531345935, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.2960700790087385, "policy_loss": 0.01716006862455591, "vf_loss": 7.24620218227307, "vf_explained_var": 0.03865164419015248, "kl": 0.015720138428150676, "entropy": 0.6809090860188007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "env_runners": {"episode_reward_max": 163.37863191107354, "episode_reward_min": -37.093403555529875, "episode_reward_mean": 75.22709257843741, "episode_len_mean": 140.69, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 14069, "policy_reward_min": {"agent_policy": -18.54670177776495, "adversary_policy": -15.066275508245162}, "policy_reward_max": {"agent_policy": 81.68931595553687, "adversary_policy": 47.28608466961061}, "policy_reward_mean": {"agent_policy": 37.61354628921871, "adversary_policy": 18.806773144609355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [123.88639127857425, 8.961227854700631, 68.72982193173436, 84.43858947582842, 96.42148408103711, 88.010313140313, 83.65367042862151, 54.02268187730839, 76.94265569340237, 94.96163355746911, 122.82083109862324, 106.77607615914016, 22.963225021878102, 60.463171693700986, 109.88873633019038, 91.66414044618546, 48.1962551576362, 107.88629025122012, 89.54340613351641, 130.20263846602, 91.2339966978082, 104.58386536927333, 114.83764591870224, 47.70635105184394, 111.91807990495754, 79.34198578196668, 131.74679070505914, 120.57110037039243, 72.10673678845886, 133.37341604440056, 50.56261749081218, 94.31376541000145, 135.98229692697421, 48.34058118273458, 91.10305147000645, 125.71793880037578, 73.33558896758018, 62.92967704202103, 69.44262252995402, 119.54828928250018, 28.9964680891146, 58.47391585938492, 134.58933422632109, 98.83074654464875, 73.48145751878651, 46.96644153635673, 115.35356120850467, 137.72325548857853, 60.73702720154815, 25.77575675523652, 17.918538482737972, -37.093403555529875, 30.480098725315827, 79.69104691323793, 111.37019012319485, 45.6278261996389, 20.027737425468064, 52.92093934050912, -9.668202726301203, -10.360967839717688, 107.58958295001028, 84.52950260905078, 105.17563593826218, 163.37863191107354, 49.588130540369754, 102.1255171379849, -11.13465249110537, 80.95470261401724, 83.80618322660668, 72.06626478074385, 9.572624072034783, 18.54443127881941, 146.89911949081178, 67.01964596338715, 43.677851057409256, -12.389425565399662, 65.08249861771371, 115.63807517302828, 46.669433840607915, 85.46331512003168, 117.21345741064982, -16.36583676225476, 92.63637334609516, 99.4098204220194, 97.79741933177817, 116.63079717440375, 78.22416128109867, 89.0262783891452, 68.40587934720986, 97.76297366982325, 7.994657318211026, 65.83324752521808, 31.847405904647175, 99.94137955343034, 135.05684176138996, 132.26731250630422, 104.01891326505297, -6.708702548708388, 4.456922207846324, 52.03148314496475], "episode_lengths": [56, 14, 200, 200, 76, 200, 32, 200, 72, 200, 200, 73, 200, 57, 200, 184, 32, 98, 99, 80, 200, 190, 132, 190, 200, 102, 101, 100, 200, 175, 66, 74, 104, 90, 200, 200, 176, 44, 101, 66, 53, 195, 200, 77, 154, 56, 136, 151, 200, 20, 200, 200, 200, 200, 200, 200, 15, 49, 200, 200, 200, 200, 200, 86, 200, 79, 200, 170, 200, 134, 37, 200, 75, 98, 130, 200, 200, 188, 94, 96, 159, 200, 200, 165, 142, 200, 174, 200, 200, 77, 200, 200, 84, 180, 89, 82, 200, 200, 18, 22], "policy_agent_policy_reward": [61.94319563928714, 4.4806139273503165, 34.36491096586718, 42.21929473791421, 48.210742040518554, 44.0051565701565, 41.82683521431076, 27.011340938654193, 38.47132784670119, 47.48081677873458, 61.41041554931162, 53.38803807957003, 11.481612510939069, 30.23158584685049, 54.944368165095185, 45.83207022309273, 24.09812757881809, 53.943145125610066, 44.77170306675818, 65.10131923301002, 45.61699834890409, 52.29193268463666, 57.41882295935116, 23.85317552592197, 55.959039952478776, 39.67099289098334, 65.8733953525296, 60.285550185196215, 36.05336839422943, 66.68670802220032, 25.281308745406093, 47.15688270500075, 67.99114846348711, 24.170290591367284, 45.55152573500321, 62.85896940018789, 36.66779448379009, 31.464838521010506, 34.72131126497701, 59.774144641250096, 14.498234044557297, 29.23695792969247, 67.29466711316054, 49.415373272324366, 36.74072875939326, 23.483220768178363, 57.676780604252336, 68.86162774428925, 30.368513600774087, 12.88787837761826, 8.959269241368993, -18.54670177776495, 15.240049362657917, 39.84552345661896, 55.68509506159742, 22.813913099819445, 10.013868712734027, 26.46046967025457, -4.834101363150591, -5.180483919858858, 53.794791475005155, 42.26475130452539, 52.58781796913108, 81.68931595553687, 24.794065270184877, 51.062758568992464, -5.567326245552685, 40.47735130700861, 41.903091613303346, 36.03313239037192, 4.786312036017392, 9.272215639409737, 73.4495597454059, 33.50982298169359, 21.838925528704625, -6.194712782699856, 32.54124930885686, 57.81903758651413, 23.33471692030396, 42.731657560015826, 58.60672870532491, -8.182918381127372, 46.318186673047585, 49.70491021100973, 48.8987096658891, 58.31539858720187, 39.11208064054934, 44.5131391945726, 34.202939673604924, 48.881486834911705, 3.9973286591055555, 32.916623762609035, 15.923702952323579, 49.97068977671518, 67.52842088069495, 66.13365625315207, 52.00945663252649, -3.3543512743541655, 2.2284611039231628, 26.015741572482355], "policy_adversary_policy_reward": [39.520035492371534, 22.423160146915595, 6.9858246118583205, -2.505210684508004, 6.292479527402982, 28.0724314384642, 18.52111556650312, 23.69817917141109, 30.97360630422503, 17.237135736293514, 10.575404638339627, 33.42975193181687, 15.293914095370539, 26.532921118940216, 20.673271529556686, 6.338069409097509, 18.466873477197048, 20.004454369504145, 24.474485847808396, 23.006330930926183, 27.916849141053888, 33.493566408257735, 37.36666528488439, 16.021372794685643, 12.698810410940215, -1.2171979000011461, 18.44596560771206, 11.785620239138426, 22.610496613554417, 32.33387155154077, 21.048926158164665, 24.78314406492806, 1.6269576388521472, 22.471169939965943, 32.94537095281757, 20.99777417279251, 26.895340826807434, 17.87636223995076, 40.26538947351517, 24.835929759494853, 19.801689038237765, 25.81530931066633, 30.165643275253707, 22.126289409382963, 22.629207325135596, 34.78961563421557, 17.111893445357566, 6.741282080564403, 32.461946466855274, 23.4970934856235, 18.88564032578509, 20.785352565198252, 35.548301918264244, 30.325093434265334, 25.355152448058945, 34.93039773713726, 37.95009992107112, -1.896731526841684, 34.10252456074275, 32.584183461457556, 21.623148087048055, 3.658160658358037, 6.522166075793981, 40.63471662920675, 28.317345297139294, 39.6738031663478, 17.47693761862646, 6.693352972740822, 33.168346388532925, 12.383179346470289, 27.83152013637362, 35.02744926381427, 16.384785505359826, 20.28300897843026, 16.13418244413505, 15.330656076875457, 19.945164635666366, 14.776146629310645, 27.53600947820359, 32.23813516304651, 23.218592262852443, -8.720358218295146, 9.233972826352876, 20.00298510333959, 37.35397861142907, 29.940688501731465, 22.194638209844335, 27.220735062480028, 4.385443919341434, 32.355284840051816, 6.120000927558722, 17.363219840619642, 17.5735418071391, 40.10323879711323, 30.636375813450822, 38.22525193083845, 11.8850979504921, 18.483415650281984, 4.2871225811651925, 8.600755796453068, -1.470180593547319, 10.429449834916309, -10.413749155934156, -8.132952621830793, 21.11743963255107, -5.877390269893148, 15.157517332084907, 24.688006124534056, 29.942619121063085, 25.742475940534337, 5.338466294042149, 17.475446805777295, 7.212133266779748, 2.8017354459542787, 2.0289258391694602, 24.43154383108511, 10.232174145094568, -15.066275508245162, 0.22148655189570476, -5.401970471754563, 33.60610679677011, 20.188684678235038, 11.569964335875987, 30.694786968649403, 36.43749583256355, 16.150322136567524, 43.33334892195726, 38.355967033579574, 5.135777282535301, 19.658287987649576, 28.64937388393585, 22.4133846850566, -9.212954913882328, 3.6456286683296426, 16.989741423008933, 23.48760988399968, 18.383443385497785, 23.519648227805554, 28.729890355834975, 7.303242034536948, -5.950123964779923, 10.736436000797315, 7.791507222459959, 1.4807084169497742, 36.95664336573487, 36.49291637967105, 31.90794307466594, 1.601879907027648, 16.44817273550793, 5.390752793196693, -10.564012169486205, 4.3692993867863485, 23.41819624826337, 9.123053060593488, 28.083799423086194, 29.735238163427933, 22.542456987670285, 0.7922599326336766, 40.34554344619485, 2.386114113820966, 35.26826472503631, 23.33846398028861, -13.017515799462895, 4.83459741833553, 31.543396415189658, 14.774790257857926, 43.758746093282284, 5.946164117727452, 16.35437869648057, 32.54433096940853, 25.410260750507874, 32.905137836693996, 14.462795244989191, 24.64928539556014, 16.720071986504358, 27.793067208068244, 26.984934112924087, 7.218005560680844, 31.10685265271023, 17.774634182201474, -1.9635702915888231, 5.960898950694379, 21.283675079342856, 11.632948683266179, 10.785458882027617, 5.138244070295961, 12.040460028710601, 37.93022974800458, 47.28608466961061, 20.24233621108433, 40.81163138553177, 25.32202486762032, 12.563429346717495, 39.446027285808995, -9.004722259137594, 5.650370984783432, 1.300823374190994, 0.9276377297321683, 8.249700456749473, 17.76604111573289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38635420545103955, "mean_inference_ms": 0.9599027069257652, "mean_action_processing_ms": 0.1639357343084462, "mean_env_wait_ms": 0.05637567346255782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003280043601989746, "StateBufferConnector_ms": 0.0023969411849975586, "ViewRequirementAgentConnector_ms": 0.06309175491333008}, "num_episodes": 27, "episode_return_max": 163.37863191107354, "episode_return_min": -37.093403555529875, "episode_return_mean": 75.22709257843741}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 510.78462626570706, "num_env_steps_trained_throughput_per_sec": 510.78462626570706, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 996000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 7906.848, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7906.811, "sample_time_ms": 755.264, "learn_time_ms": 7140.168, "learn_throughput": 560.211, "synch_weights_time_ms": 10.893}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "training_iteration": 83, "trial_id": "eaa30_00000", "date": "2024-08-09_17-51-36", "timestamp": 1723240296, "time_this_iter_s": 7.835622787475586, "time_total_s": 681.1888539791107, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2890700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 681.1888539791107, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 22.454545454545453, "ram_util_percent": 78.73636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7372651582830168, "cur_kl_coeff": 0.15204648971557616, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.346448961010686, "policy_loss": -0.0012562950714565223, "vf_loss": 5.346274311075765, "vf_explained_var": 0.043472961395505876, "kl": 0.009411294709782672, "entropy": 0.8837605377984425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.975354692246765, "cur_kl_coeff": 2.0806321531345935, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.025670704742272, "policy_loss": 0.00894350779344677, "vf_loss": 6.995941005150477, "vf_explained_var": 0.009938381922741732, "kl": 0.009990327461370423, "entropy": 0.6416919054463506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 163.37863191107354, "episode_reward_min": -69.83646151870835, "episode_reward_mean": 64.98195243431829, "episode_len_mean": 141.41, "episode_media": {}, "episodes_this_iter": 29, "episodes_timesteps_total": 14141, "policy_reward_min": {"agent_policy": -34.91823075935417, "adversary_policy": -25.056482421102466}, "policy_reward_max": {"agent_policy": 81.68931595553687, "adversary_policy": 47.28608466961061}, "policy_reward_mean": {"agent_policy": 32.490976217159144, "adversary_policy": 16.245488108579575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [133.37341604440056, 50.56261749081218, 94.31376541000145, 135.98229692697421, 48.34058118273458, 91.10305147000645, 125.71793880037578, 73.33558896758018, 62.92967704202103, 69.44262252995402, 119.54828928250018, 28.9964680891146, 58.47391585938492, 134.58933422632109, 98.83074654464875, 73.48145751878651, 46.96644153635673, 115.35356120850467, 137.72325548857853, 60.73702720154815, 25.77575675523652, 17.918538482737972, -37.093403555529875, 30.480098725315827, 79.69104691323793, 111.37019012319485, 45.6278261996389, 20.027737425468064, 52.92093934050912, -9.668202726301203, -10.360967839717688, 107.58958295001028, 84.52950260905078, 105.17563593826218, 163.37863191107354, 49.588130540369754, 102.1255171379849, -11.13465249110537, 80.95470261401724, 83.80618322660668, 72.06626478074385, 9.572624072034783, 18.54443127881941, 146.89911949081178, 67.01964596338715, 43.677851057409256, -12.389425565399662, 65.08249861771371, 115.63807517302828, 46.669433840607915, 85.46331512003168, 117.21345741064982, -16.36583676225476, 92.63637334609516, 99.4098204220194, 97.79741933177817, 116.63079717440375, 78.22416128109867, 89.0262783891452, 68.40587934720986, 97.76297366982325, 7.994657318211026, 65.83324752521808, 31.847405904647175, 99.94137955343034, 135.05684176138996, 132.26731250630422, 104.01891326505297, -6.708702548708388, 4.456922207846324, 52.03148314496475, 101.61198363911672, 36.428845850271145, 72.85900243729338, 125.61727003148485, 52.656039622004066, 17.507779085831935, -26.93715171325867, 19.092113775464895, 107.84498870047342, -69.83646151870835, 62.06273426607916, 79.92010332589011, 109.41468649449283, 62.15489359716166, -49.70939667119906, 104.908886858886, 120.59039369314117, 89.05688124218756, -8.155601761042519, -30.420299128239066, 24.192048356215885, 18.640521543935527, 39.27442217730742, 95.21866641650428, 99.25522183204151, 41.557199618515625, 49.203660563236, 97.38092637879564, 78.57541953976929], "episode_lengths": [175, 66, 74, 104, 90, 200, 200, 176, 44, 101, 66, 53, 195, 200, 77, 154, 56, 136, 151, 200, 20, 200, 200, 200, 200, 200, 200, 15, 49, 200, 200, 200, 200, 200, 86, 200, 79, 200, 170, 200, 134, 37, 200, 75, 98, 130, 200, 200, 188, 94, 96, 159, 200, 200, 165, 142, 200, 174, 200, 200, 77, 200, 200, 84, 180, 89, 82, 200, 200, 18, 22, 100, 200, 56, 41, 69, 200, 200, 200, 93, 200, 98, 44, 58, 42, 200, 200, 35, 62, 200, 200, 200, 200, 200, 45, 200, 159, 127, 200, 131], "policy_agent_policy_reward": [66.68670802220032, 25.281308745406093, 47.15688270500075, 67.99114846348711, 24.170290591367284, 45.55152573500321, 62.85896940018789, 36.66779448379009, 31.464838521010506, 34.72131126497701, 59.774144641250096, 14.498234044557297, 29.23695792969247, 67.29466711316054, 49.415373272324366, 36.74072875939326, 23.483220768178363, 57.676780604252336, 68.86162774428925, 30.368513600774087, 12.88787837761826, 8.959269241368993, -18.54670177776495, 15.240049362657917, 39.84552345661896, 55.68509506159742, 22.813913099819445, 10.013868712734027, 26.46046967025457, -4.834101363150591, -5.180483919858858, 53.794791475005155, 42.26475130452539, 52.58781796913108, 81.68931595553687, 24.794065270184877, 51.062758568992464, -5.567326245552685, 40.47735130700861, 41.903091613303346, 36.03313239037192, 4.786312036017392, 9.272215639409737, 73.4495597454059, 33.50982298169359, 21.838925528704625, -6.194712782699856, 32.54124930885686, 57.81903758651413, 23.33471692030396, 42.731657560015826, 58.60672870532491, -8.182918381127372, 46.318186673047585, 49.70491021100973, 48.8987096658891, 58.31539858720187, 39.11208064054934, 44.5131391945726, 34.202939673604924, 48.881486834911705, 3.9973286591055555, 32.916623762609035, 15.923702952323579, 49.97068977671518, 67.52842088069495, 66.13365625315207, 52.00945663252649, -3.3543512743541655, 2.2284611039231628, 26.015741572482355, 50.805991819558336, 18.214422925135572, 36.4295012186467, 62.80863501574241, 26.328019811002033, 8.753889542915967, -13.468575856629336, 9.546056887732448, 53.92249435023668, -34.91823075935417, 31.031367133039577, 39.96005166294505, 54.70734324724646, 31.077446798580816, -24.854698335599586, 52.454443429443, 60.295196846570555, 44.52844062109377, -4.077800880521295, -15.210149564119533, 12.09602417810791, 9.320260771967732, 19.637211088653725, 47.609333208252124, 49.62761091602078, 20.778599809257827, 24.60183028161804, 48.69046318939782, 39.287709769884636], "policy_adversary_policy_reward": [34.10252456074275, 32.584183461457556, 21.623148087048055, 3.658160658358037, 6.522166075793981, 40.63471662920675, 28.317345297139294, 39.6738031663478, 17.47693761862646, 6.693352972740822, 33.168346388532925, 12.383179346470289, 27.83152013637362, 35.02744926381427, 16.384785505359826, 20.28300897843026, 16.13418244413505, 15.330656076875457, 19.945164635666366, 14.776146629310645, 27.53600947820359, 32.23813516304651, 23.218592262852443, -8.720358218295146, 9.233972826352876, 20.00298510333959, 37.35397861142907, 29.940688501731465, 22.194638209844335, 27.220735062480028, 4.385443919341434, 32.355284840051816, 6.120000927558722, 17.363219840619642, 17.5735418071391, 40.10323879711323, 30.636375813450822, 38.22525193083845, 11.8850979504921, 18.483415650281984, 4.2871225811651925, 8.600755796453068, -1.470180593547319, 10.429449834916309, -10.413749155934156, -8.132952621830793, 21.11743963255107, -5.877390269893148, 15.157517332084907, 24.688006124534056, 29.942619121063085, 25.742475940534337, 5.338466294042149, 17.475446805777295, 7.212133266779748, 2.8017354459542787, 2.0289258391694602, 24.43154383108511, 10.232174145094568, -15.066275508245162, 0.22148655189570476, -5.401970471754563, 33.60610679677011, 20.188684678235038, 11.569964335875987, 30.694786968649403, 36.43749583256355, 16.150322136567524, 43.33334892195726, 38.355967033579574, 5.135777282535301, 19.658287987649576, 28.64937388393585, 22.4133846850566, -9.212954913882328, 3.6456286683296426, 16.989741423008933, 23.48760988399968, 18.383443385497785, 23.519648227805554, 28.729890355834975, 7.303242034536948, -5.950123964779923, 10.736436000797315, 7.791507222459959, 1.4807084169497742, 36.95664336573487, 36.49291637967105, 31.90794307466594, 1.601879907027648, 16.44817273550793, 5.390752793196693, -10.564012169486205, 4.3692993867863485, 23.41819624826337, 9.123053060593488, 28.083799423086194, 29.735238163427933, 22.542456987670285, 0.7922599326336766, 40.34554344619485, 2.386114113820966, 35.26826472503631, 23.33846398028861, -13.017515799462895, 4.83459741833553, 31.543396415189658, 14.774790257857926, 43.758746093282284, 5.946164117727452, 16.35437869648057, 32.54433096940853, 25.410260750507874, 32.905137836693996, 14.462795244989191, 24.64928539556014, 16.720071986504358, 27.793067208068244, 26.984934112924087, 7.218005560680844, 31.10685265271023, 17.774634182201474, -1.9635702915888231, 5.960898950694379, 21.283675079342856, 11.632948683266179, 10.785458882027617, 5.138244070295961, 12.040460028710601, 37.93022974800458, 47.28608466961061, 20.24233621108433, 40.81163138553177, 25.32202486762032, 12.563429346717495, 39.446027285808995, -9.004722259137594, 5.650370984783432, 1.300823374190994, 0.9276377297321683, 8.249700456749473, 17.76604111573289, 26.35730840806705, 24.448683411491302, 13.686519942712863, 4.5279029824227095, 23.305114469300094, 13.124386749346595, 32.358167706828446, 30.45046730891397, -5.174291688628088, 31.50231149963012, -5.336703455386871, 14.090592998302839, -14.72428835979467, 1.2557125031653342, -1.4649555811964632, 11.01101246892891, 30.35553550761544, 23.566958842621247, -18.788770964999962, -16.129459794354208, 16.17644236829242, 14.854924764747153, 19.985164551246235, 19.97488711169881, 30.395417177268527, 24.311926069977922, -0.2103328454086153, 31.28777964398943, 0.2017840855028865, -25.056482421102466, 22.622272364096958, 29.832171065346046, 30.746081363173527, 29.549115483397024, 27.984394271419795, 16.54404634967398, -14.775166968740315, 10.69736608821902, 1.197598833182326, -16.407748397301855, -3.027764371793058, 15.123788549900969, 1.6107223705690643, 7.709538401398671, 13.283443544001123, 6.353767544652598, 28.561581965831223, 19.047751242420908, 29.26105421115166, 20.366556704869094, 10.377880015282795, 10.400719793975032, 8.5645893316496, 16.03724094996844, 29.09045017616514, 19.600013013232676, 34.335095966110266, 4.952613803774374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38622234291916646, "mean_inference_ms": 0.9620471981813181, "mean_action_processing_ms": 0.16383056523968334, "mean_env_wait_ms": 0.05638947151564567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033631324768066406, "StateBufferConnector_ms": 0.0024373531341552734, "ViewRequirementAgentConnector_ms": 0.06448674201965332}, "num_episodes": 29, "episode_return_max": 163.37863191107354, "episode_return_min": -69.83646151870835, "episode_return_mean": 64.98195243431829}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 508.5335202994165, "num_env_steps_trained_throughput_per_sec": 508.5335202994165, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 7885.328, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7885.292, "sample_time_ms": 756.784, "learn_time_ms": 7117.718, "learn_throughput": 561.978, "synch_weights_time_ms": 10.333}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 84, "trial_id": "eaa30_00000", "date": "2024-08-09_17-51-44", "timestamp": 1723240304, "time_this_iter_s": 7.8709352016448975, "time_total_s": 689.0597891807556, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a28908b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 689.0597891807556, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 21.73333333333333, "ram_util_percent": 78.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.682244642544045, "cur_kl_coeff": 0.15204648971557616, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.988371509345121, "policy_loss": 0.004399326479397517, "vf_loss": 4.982118195326871, "vf_explained_var": 0.01847543407369543, "kl": 0.012193579981152817, "entropy": 0.8409729944019722, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.845818231565257, "cur_kl_coeff": 2.0806321531345935, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.441250993808111, "policy_loss": 0.010666484820346038, "vf_loss": 6.417822036147117, "vf_explained_var": 0.12206554642568032, "kl": 0.006133926654001698, "entropy": 0.6019575146958231, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "env_runners": {"episode_reward_max": 163.37863191107354, "episode_reward_min": -69.83646151870835, "episode_reward_mean": 58.32870076670978, "episode_len_mean": 144.23, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 14423, "policy_reward_min": {"agent_policy": -34.91823075935417, "adversary_policy": -25.056482421102466}, "policy_reward_max": {"agent_policy": 81.68931595553687, "adversary_policy": 47.28608466961061}, "policy_reward_mean": {"agent_policy": 29.164350383354886, "adversary_policy": 14.582175191677445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.6278261996389, 20.027737425468064, 52.92093934050912, -9.668202726301203, -10.360967839717688, 107.58958295001028, 84.52950260905078, 105.17563593826218, 163.37863191107354, 49.588130540369754, 102.1255171379849, -11.13465249110537, 80.95470261401724, 83.80618322660668, 72.06626478074385, 9.572624072034783, 18.54443127881941, 146.89911949081178, 67.01964596338715, 43.677851057409256, -12.389425565399662, 65.08249861771371, 115.63807517302828, 46.669433840607915, 85.46331512003168, 117.21345741064982, -16.36583676225476, 92.63637334609516, 99.4098204220194, 97.79741933177817, 116.63079717440375, 78.22416128109867, 89.0262783891452, 68.40587934720986, 97.76297366982325, 7.994657318211026, 65.83324752521808, 31.847405904647175, 99.94137955343034, 135.05684176138996, 132.26731250630422, 104.01891326505297, -6.708702548708388, 4.456922207846324, 52.03148314496475, 101.61198363911672, 36.428845850271145, 72.85900243729338, 125.61727003148485, 52.656039622004066, 17.507779085831935, -26.93715171325867, 19.092113775464895, 107.84498870047342, -69.83646151870835, 62.06273426607916, 79.92010332589011, 109.41468649449283, 62.15489359716166, -49.70939667119906, 104.908886858886, 120.59039369314117, 89.05688124218756, -8.155601761042519, -30.420299128239066, 24.192048356215885, 18.640521543935527, 39.27442217730742, 95.21866641650428, 99.25522183204151, 41.557199618515625, 49.203660563236, 97.38092637879564, 78.57541953976929, 80.78542757040708, 14.572361802813028, 91.28904772833364, 117.64016845193599, 29.788317941748037, 101.18897265151179, 36.849187339904645, 12.275440280745947, 73.34401641807042, 9.684667151313043, -45.712773970875936, 127.93643490235138, 15.098104790090254, 26.39653098017751, 61.98704974168555, 63.78696840085766, -17.56740011871058, 83.80244193143824, 127.8290857739969, 33.57392430368821, 38.923053179141455, 14.29658846286474, -23.339832141738086, 150.53362557146446, 151.23610656305752, -53.57840220232788], "episode_lengths": [200, 15, 49, 200, 200, 200, 200, 200, 86, 200, 79, 200, 170, 200, 134, 37, 200, 75, 98, 130, 200, 200, 188, 94, 96, 159, 200, 200, 165, 142, 200, 174, 200, 200, 77, 200, 200, 84, 180, 89, 82, 200, 200, 18, 22, 100, 200, 56, 41, 69, 200, 200, 200, 93, 200, 98, 44, 58, 42, 200, 200, 35, 62, 200, 200, 200, 200, 200, 45, 200, 159, 127, 200, 131, 200, 200, 200, 140, 43, 161, 200, 200, 108, 200, 200, 83, 200, 200, 51, 43, 200, 55, 56, 200, 200, 11, 200, 200, 69, 200], "policy_agent_policy_reward": [22.813913099819445, 10.013868712734027, 26.46046967025457, -4.834101363150591, -5.180483919858858, 53.794791475005155, 42.26475130452539, 52.58781796913108, 81.68931595553687, 24.794065270184877, 51.062758568992464, -5.567326245552685, 40.47735130700861, 41.903091613303346, 36.03313239037192, 4.786312036017392, 9.272215639409737, 73.4495597454059, 33.50982298169359, 21.838925528704625, -6.194712782699856, 32.54124930885686, 57.81903758651413, 23.33471692030396, 42.731657560015826, 58.60672870532491, -8.182918381127372, 46.318186673047585, 49.70491021100973, 48.8987096658891, 58.31539858720187, 39.11208064054934, 44.5131391945726, 34.202939673604924, 48.881486834911705, 3.9973286591055555, 32.916623762609035, 15.923702952323579, 49.97068977671518, 67.52842088069495, 66.13365625315207, 52.00945663252649, -3.3543512743541655, 2.2284611039231628, 26.015741572482355, 50.805991819558336, 18.214422925135572, 36.4295012186467, 62.80863501574241, 26.328019811002033, 8.753889542915967, -13.468575856629336, 9.546056887732448, 53.92249435023668, -34.91823075935417, 31.031367133039577, 39.96005166294505, 54.70734324724646, 31.077446798580816, -24.854698335599586, 52.454443429443, 60.295196846570555, 44.52844062109377, -4.077800880521295, -15.210149564119533, 12.09602417810791, 9.320260771967732, 19.637211088653725, 47.609333208252124, 49.62761091602078, 20.778599809257827, 24.60183028161804, 48.69046318939782, 39.287709769884636, 40.39271378520355, 7.286180901406524, 45.644523864166814, 58.82008422596799, 14.89415897087402, 50.59448632575595, 18.424593669952323, 6.1377201403729735, 36.672008209035226, 4.842333575656532, -22.856386985437958, 63.96821745117567, 7.549052395045127, 13.198265490088751, 30.99352487084277, 31.89348420042883, -8.783700059355347, 41.90122096571915, 63.91454288699846, 16.786962151844104, 19.461526589570727, 7.148294231432368, -11.66991607086906, 75.26681278573226, 75.61805328152877, -26.78920110116394], "policy_adversary_policy_reward": [5.338466294042149, 17.475446805777295, 7.212133266779748, 2.8017354459542787, 2.0289258391694602, 24.43154383108511, 10.232174145094568, -15.066275508245162, 0.22148655189570476, -5.401970471754563, 33.60610679677011, 20.188684678235038, 11.569964335875987, 30.694786968649403, 36.43749583256355, 16.150322136567524, 43.33334892195726, 38.355967033579574, 5.135777282535301, 19.658287987649576, 28.64937388393585, 22.4133846850566, -9.212954913882328, 3.6456286683296426, 16.989741423008933, 23.48760988399968, 18.383443385497785, 23.519648227805554, 28.729890355834975, 7.303242034536948, -5.950123964779923, 10.736436000797315, 7.791507222459959, 1.4807084169497742, 36.95664336573487, 36.49291637967105, 31.90794307466594, 1.601879907027648, 16.44817273550793, 5.390752793196693, -10.564012169486205, 4.3692993867863485, 23.41819624826337, 9.123053060593488, 28.083799423086194, 29.735238163427933, 22.542456987670285, 0.7922599326336766, 40.34554344619485, 2.386114113820966, 35.26826472503631, 23.33846398028861, -13.017515799462895, 4.83459741833553, 31.543396415189658, 14.774790257857926, 43.758746093282284, 5.946164117727452, 16.35437869648057, 32.54433096940853, 25.410260750507874, 32.905137836693996, 14.462795244989191, 24.64928539556014, 16.720071986504358, 27.793067208068244, 26.984934112924087, 7.218005560680844, 31.10685265271023, 17.774634182201474, -1.9635702915888231, 5.960898950694379, 21.283675079342856, 11.632948683266179, 10.785458882027617, 5.138244070295961, 12.040460028710601, 37.93022974800458, 47.28608466961061, 20.24233621108433, 40.81163138553177, 25.32202486762032, 12.563429346717495, 39.446027285808995, -9.004722259137594, 5.650370984783432, 1.300823374190994, 0.9276377297321683, 8.249700456749473, 17.76604111573289, 26.35730840806705, 24.448683411491302, 13.686519942712863, 4.5279029824227095, 23.305114469300094, 13.124386749346595, 32.358167706828446, 30.45046730891397, -5.174291688628088, 31.50231149963012, -5.336703455386871, 14.090592998302839, -14.72428835979467, 1.2557125031653342, -1.4649555811964632, 11.01101246892891, 30.35553550761544, 23.566958842621247, -18.788770964999962, -16.129459794354208, 16.17644236829242, 14.854924764747153, 19.985164551246235, 19.97488711169881, 30.395417177268527, 24.311926069977922, -0.2103328454086153, 31.28777964398943, 0.2017840855028865, -25.056482421102466, 22.622272364096958, 29.832171065346046, 30.746081363173527, 29.549115483397024, 27.984394271419795, 16.54404634967398, -14.775166968740315, 10.69736608821902, 1.197598833182326, -16.407748397301855, -3.027764371793058, 15.123788549900969, 1.6107223705690643, 7.709538401398671, 13.283443544001123, 6.353767544652598, 28.561581965831223, 19.047751242420908, 29.26105421115166, 20.366556704869094, 10.377880015282795, 10.400719793975032, 8.5645893316496, 16.03724094996844, 29.09045017616514, 19.600013013232676, 34.335095966110266, 4.952613803774374, 29.13336634084049, 11.259347444363065, 3.829298712196419, 3.4568821892101074, 17.54550686524642, 28.099016998920394, 34.37320508900761, 24.446879136960384, 25.77223831317512, -10.8780793423011, 24.641258695673944, 25.953227630082, 8.696934537060475, 9.727659132891848, 18.387199213227476, -12.249479072854506, 31.201711978949678, 5.470296230085546, -9.214963625556006, 14.057297201212538, -18.417337416177197, -4.43904956926076, 43.25346368871208, 20.71475376246359, -4.071540500509482, 11.620592895554609, -8.570363760207186, 21.768629250295938, 32.14070033438705, -1.1471754635442863, -5.3697972964475085, 37.26328149687633, -0.2559727670828025, -8.527727292272534, 42.26168861644615, -0.3604676507270099, 28.985360696482445, 34.929182190516016, 10.47396408135413, 6.312998070489975, 2.1612349136438986, 17.30029167592683, -6.371121593620153, 13.519415825052523, -2.201881140701847, -9.468034930167207, 38.51299408897183, 36.75381869676042, 34.31257216406224, 41.30548111746652, -6.245025713936428, -20.54417538722751]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.386028857161782, "mean_inference_ms": 0.962726970362351, "mean_action_processing_ms": 0.16382925641253127, "mean_env_wait_ms": 0.05641016576788391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003245234489440918, "StateBufferConnector_ms": 0.00238955020904541, "ViewRequirementAgentConnector_ms": 0.0634763240814209}, "num_episodes": 26, "episode_return_max": 163.37863191107354, "episode_return_min": -69.83646151870835, "episode_return_mean": 58.32870076670978}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 510.58018259222456, "num_env_steps_trained_throughput_per_sec": 510.58018259222456, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1020000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 7881.068, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7881.032, "sample_time_ms": 754.228, "learn_time_ms": 7115.97, "learn_throughput": 562.116, "synch_weights_time_ms": 10.338}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "training_iteration": 85, "trial_id": "eaa30_00000", "date": "2024-08-09_17-51-52", "timestamp": 1723240312, "time_this_iter_s": 7.8394248485565186, "time_total_s": 696.8992140293121, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2890ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 696.8992140293121, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 26.354545454545452, "ram_util_percent": 78.87272727272729}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.83752257294125, "cur_kl_coeff": 0.15204648971557616, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.337448784535524, "policy_loss": 0.0022575289880728752, "vf_loss": 5.333397020864739, "vf_explained_var": 0.09369047255743118, "kl": 0.011800606937083617, "entropy": 0.8150393219536575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.06805710370342, "cur_kl_coeff": 2.0806321531345935, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.091918207705021, "policy_loss": 0.0045037476302240975, "vf_loss": 7.080084518094858, "vf_explained_var": 0.09146032463759184, "kl": 0.0035229455292816662, "entropy": 0.5935381347934405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "env_runners": {"episode_reward_max": 151.23610656305752, "episode_reward_min": -79.08370529652748, "episode_reward_mean": 50.024272008287205, "episode_len_mean": 147.39, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 14739, "policy_reward_min": {"agent_policy": -39.541852648263706, "adversary_policy": -36.746949649574915}, "policy_reward_max": {"agent_policy": 75.61805328152877, "adversary_policy": 47.28608466961061}, "policy_reward_mean": {"agent_policy": 25.012136004143603, "adversary_policy": 12.506068002071801}, "custom_metrics": {}, "hist_stats": {"episode_reward": [115.63807517302828, 46.669433840607915, 85.46331512003168, 117.21345741064982, -16.36583676225476, 92.63637334609516, 99.4098204220194, 97.79741933177817, 116.63079717440375, 78.22416128109867, 89.0262783891452, 68.40587934720986, 97.76297366982325, 7.994657318211026, 65.83324752521808, 31.847405904647175, 99.94137955343034, 135.05684176138996, 132.26731250630422, 104.01891326505297, -6.708702548708388, 4.456922207846324, 52.03148314496475, 101.61198363911672, 36.428845850271145, 72.85900243729338, 125.61727003148485, 52.656039622004066, 17.507779085831935, -26.93715171325867, 19.092113775464895, 107.84498870047342, -69.83646151870835, 62.06273426607916, 79.92010332589011, 109.41468649449283, 62.15489359716166, -49.70939667119906, 104.908886858886, 120.59039369314117, 89.05688124218756, -8.155601761042519, -30.420299128239066, 24.192048356215885, 18.640521543935527, 39.27442217730742, 95.21866641650428, 99.25522183204151, 41.557199618515625, 49.203660563236, 97.38092637879564, 78.57541953976929, 80.78542757040708, 14.572361802813028, 91.28904772833364, 117.64016845193599, 29.788317941748037, 101.18897265151179, 36.849187339904645, 12.275440280745947, 73.34401641807042, 9.684667151313043, -45.712773970875936, 127.93643490235138, 15.098104790090254, 26.39653098017751, 61.98704974168555, 63.78696840085766, -17.56740011871058, 83.80244193143824, 127.8290857739969, 33.57392430368821, 38.923053179141455, 14.29658846286474, -23.339832141738086, 150.53362557146446, 151.23610656305752, -53.57840220232788, 30.0951145762737, 47.15199975722551, 104.34415605905178, -25.191197414918975, 1.3202869986672368, 87.04796205963385, 45.97388182839296, 6.678532473009259, -79.08370529652748, -54.975810048147906, 12.930942383161337, -53.20457316611035, -8.493518955736086, 111.99197383657193, -23.93600849985488, 76.06710203429093, -9.819526631748403, -0.999271764397804, 53.59758185018838, 10.78616079532074, 130.25361438189134, -17.94499656710623], "episode_lengths": [188, 94, 96, 159, 200, 200, 165, 142, 200, 174, 200, 200, 77, 200, 200, 84, 180, 89, 82, 200, 200, 18, 22, 100, 200, 56, 41, 69, 200, 200, 200, 93, 200, 98, 44, 58, 42, 200, 200, 35, 62, 200, 200, 200, 200, 200, 45, 200, 159, 127, 200, 131, 200, 200, 200, 140, 43, 161, 200, 200, 108, 200, 200, 83, 200, 200, 51, 43, 200, 55, 56, 200, 200, 11, 200, 200, 69, 200, 200, 56, 166, 200, 1, 151, 191, 200, 200, 200, 36, 200, 200, 144, 200, 44, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [57.81903758651413, 23.33471692030396, 42.731657560015826, 58.60672870532491, -8.182918381127372, 46.318186673047585, 49.70491021100973, 48.8987096658891, 58.31539858720187, 39.11208064054934, 44.5131391945726, 34.202939673604924, 48.881486834911705, 3.9973286591055555, 32.916623762609035, 15.923702952323579, 49.97068977671518, 67.52842088069495, 66.13365625315207, 52.00945663252649, -3.3543512743541655, 2.2284611039231628, 26.015741572482355, 50.805991819558336, 18.214422925135572, 36.4295012186467, 62.80863501574241, 26.328019811002033, 8.753889542915967, -13.468575856629336, 9.546056887732448, 53.92249435023668, -34.91823075935417, 31.031367133039577, 39.96005166294505, 54.70734324724646, 31.077446798580816, -24.854698335599586, 52.454443429443, 60.295196846570555, 44.52844062109377, -4.077800880521295, -15.210149564119533, 12.09602417810791, 9.320260771967732, 19.637211088653725, 47.609333208252124, 49.62761091602078, 20.778599809257827, 24.60183028161804, 48.69046318939782, 39.287709769884636, 40.39271378520355, 7.286180901406524, 45.644523864166814, 58.82008422596799, 14.89415897087402, 50.59448632575595, 18.424593669952323, 6.1377201403729735, 36.672008209035226, 4.842333575656532, -22.856386985437958, 63.96821745117567, 7.549052395045127, 13.198265490088751, 30.99352487084277, 31.89348420042883, -8.783700059355347, 41.90122096571915, 63.91454288699846, 16.786962151844104, 19.461526589570727, 7.148294231432368, -11.66991607086906, 75.26681278573226, 75.61805328152877, -26.78920110116394, 15.047557288136856, 23.57599987861276, 52.1720780295259, -12.59559870745948, 0.6601434993336184, 43.5239810298169, 22.986940914196488, 3.339266236504617, -39.541852648263706, -27.487905024073953, 6.465471191580669, -26.602286583055232, -4.246759477868043, 55.99598691828595, -11.968004249927457, 38.03355101714547, -4.90976331587418, -0.499635882198902, 26.79879092509418, 5.39308039766037, 65.1268071909457, -8.972498283553126], "policy_adversary_policy_reward": [28.083799423086194, 29.735238163427933, 22.542456987670285, 0.7922599326336766, 40.34554344619485, 2.386114113820966, 35.26826472503631, 23.33846398028861, -13.017515799462895, 4.83459741833553, 31.543396415189658, 14.774790257857926, 43.758746093282284, 5.946164117727452, 16.35437869648057, 32.54433096940853, 25.410260750507874, 32.905137836693996, 14.462795244989191, 24.64928539556014, 16.720071986504358, 27.793067208068244, 26.984934112924087, 7.218005560680844, 31.10685265271023, 17.774634182201474, -1.9635702915888231, 5.960898950694379, 21.283675079342856, 11.632948683266179, 10.785458882027617, 5.138244070295961, 12.040460028710601, 37.93022974800458, 47.28608466961061, 20.24233621108433, 40.81163138553177, 25.32202486762032, 12.563429346717495, 39.446027285808995, -9.004722259137594, 5.650370984783432, 1.300823374190994, 0.9276377297321683, 8.249700456749473, 17.76604111573289, 26.35730840806705, 24.448683411491302, 13.686519942712863, 4.5279029824227095, 23.305114469300094, 13.124386749346595, 32.358167706828446, 30.45046730891397, -5.174291688628088, 31.50231149963012, -5.336703455386871, 14.090592998302839, -14.72428835979467, 1.2557125031653342, -1.4649555811964632, 11.01101246892891, 30.35553550761544, 23.566958842621247, -18.788770964999962, -16.129459794354208, 16.17644236829242, 14.854924764747153, 19.985164551246235, 19.97488711169881, 30.395417177268527, 24.311926069977922, -0.2103328454086153, 31.28777964398943, 0.2017840855028865, -25.056482421102466, 22.622272364096958, 29.832171065346046, 30.746081363173527, 29.549115483397024, 27.984394271419795, 16.54404634967398, -14.775166968740315, 10.69736608821902, 1.197598833182326, -16.407748397301855, -3.027764371793058, 15.123788549900969, 1.6107223705690643, 7.709538401398671, 13.283443544001123, 6.353767544652598, 28.561581965831223, 19.047751242420908, 29.26105421115166, 20.366556704869094, 10.377880015282795, 10.400719793975032, 8.5645893316496, 16.03724094996844, 29.09045017616514, 19.600013013232676, 34.335095966110266, 4.952613803774374, 29.13336634084049, 11.259347444363065, 3.829298712196419, 3.4568821892101074, 17.54550686524642, 28.099016998920394, 34.37320508900761, 24.446879136960384, 25.77223831317512, -10.8780793423011, 24.641258695673944, 25.953227630082, 8.696934537060475, 9.727659132891848, 18.387199213227476, -12.249479072854506, 31.201711978949678, 5.470296230085546, -9.214963625556006, 14.057297201212538, -18.417337416177197, -4.43904956926076, 43.25346368871208, 20.71475376246359, -4.071540500509482, 11.620592895554609, -8.570363760207186, 21.768629250295938, 32.14070033438705, -1.1471754635442863, -5.3697972964475085, 37.26328149687633, -0.2559727670828025, -8.527727292272534, 42.26168861644615, -0.3604676507270099, 28.985360696482445, 34.929182190516016, 10.47396408135413, 6.312998070489975, 2.1612349136438986, 17.30029167592683, -6.371121593620153, 13.519415825052523, -2.201881140701847, -9.468034930167207, 38.51299408897183, 36.75381869676042, 34.31257216406224, 41.30548111746652, -6.245025713936428, -20.54417538722751, 9.819169523383708, 5.228387764753144, 9.61184859088305, 13.964151287729706, 29.468872876160077, 22.70320515336581, -16.93862403255639, 4.343025325096914, 0.6036582203944363, 0.05648527893918209, 35.49129163566039, 8.032689394156522, 7.982350058947419, 15.00459085524907, -4.153487820342356, 7.492754056846977, -36.746949649574915, -2.7949029986887908, -9.962902154932522, -17.525002869141435, -14.041173704310246, 20.50664489589091, -20.572905712927767, -6.029380870127472, 2.7858278447617124, -7.032587322629755, 31.746606796860974, 24.24938012142497, -9.436917553361493, -2.5310866965659855, 29.422105410485983, 8.61144560665948, -3.2590056472429403, -1.6507576686312468, -9.069004015164012, 8.56936813296511, 9.847171220375099, 16.951619704719082, -2.3991578427390294, 7.792238240399399, 30.252527035478685, 34.874280155467005, -9.056584843829688, 0.08408656027656392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38601371984839083, "mean_inference_ms": 0.9609850954168073, "mean_action_processing_ms": 0.1638333507666153, "mean_env_wait_ms": 0.05641579678084443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003161787986755371, "StateBufferConnector_ms": 0.002387523651123047, "ViewRequirementAgentConnector_ms": 0.06326150894165039}, "num_episodes": 22, "episode_return_max": 151.23610656305752, "episode_return_min": -79.08370529652748, "episode_return_mean": 50.024272008287205}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 512.4067134463509, "num_env_steps_trained_throughput_per_sec": 512.4067134463509, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 7886.653, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7886.617, "sample_time_ms": 754.072, "learn_time_ms": 7121.661, "learn_throughput": 561.667, "synch_weights_time_ms": 10.391}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "training_iteration": 86, "trial_id": "eaa30_00000", "date": "2024-08-09_17-52-00", "timestamp": 1723240320, "time_this_iter_s": 7.810760021209717, "time_total_s": 704.7099740505219, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2890ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 704.7099740505219, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 21.94545454545455, "ram_util_percent": 79.1909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.4867423299128415, "cur_kl_coeff": 0.15204648971557616, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.160938557241328, "policy_loss": 0.0005262577694362749, "vf_loss": 4.157296690486726, "vf_explained_var": 0.07454725147555114, "kl": 0.0204910999006301, "entropy": 0.6634400029346426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.039344624057412, "cur_kl_coeff": 1.0403160765672967, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.3590317557255425, "policy_loss": -0.0024620702271931803, "vf_loss": 6.357735681037108, "vf_explained_var": 0.19021813763926426, "kl": 0.0036125048782802574, "entropy": 0.5974863786871235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "env_runners": {"episode_reward_max": 151.23610656305752, "episode_reward_min": -92.92846023963273, "episode_reward_mean": 35.13919691515017, "episode_len_mean": 153.1, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 15310, "policy_reward_min": {"agent_policy": -46.46423011981639, "adversary_policy": -36.746949649574915}, "policy_reward_max": {"agent_policy": 75.61805328152877, "adversary_policy": 43.25346368871208}, "policy_reward_mean": {"agent_policy": 17.56959845757509, "adversary_policy": 8.784799228787541}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.85900243729338, 125.61727003148485, 52.656039622004066, 17.507779085831935, -26.93715171325867, 19.092113775464895, 107.84498870047342, -69.83646151870835, 62.06273426607916, 79.92010332589011, 109.41468649449283, 62.15489359716166, -49.70939667119906, 104.908886858886, 120.59039369314117, 89.05688124218756, -8.155601761042519, -30.420299128239066, 24.192048356215885, 18.640521543935527, 39.27442217730742, 95.21866641650428, 99.25522183204151, 41.557199618515625, 49.203660563236, 97.38092637879564, 78.57541953976929, 80.78542757040708, 14.572361802813028, 91.28904772833364, 117.64016845193599, 29.788317941748037, 101.18897265151179, 36.849187339904645, 12.275440280745947, 73.34401641807042, 9.684667151313043, -45.712773970875936, 127.93643490235138, 15.098104790090254, 26.39653098017751, 61.98704974168555, 63.78696840085766, -17.56740011871058, 83.80244193143824, 127.8290857739969, 33.57392430368821, 38.923053179141455, 14.29658846286474, -23.339832141738086, 150.53362557146446, 151.23610656305752, -53.57840220232788, 30.0951145762737, 47.15199975722551, 104.34415605905178, -25.191197414918975, 1.3202869986672368, 87.04796205963385, 45.97388182839296, 6.678532473009259, -79.08370529652748, -54.975810048147906, 12.930942383161337, -53.20457316611035, -8.493518955736086, 111.99197383657193, -23.93600849985488, 76.06710203429093, -9.819526631748403, -0.999271764397804, 53.59758185018838, 10.78616079532074, 130.25361438189134, -17.94499656710623, 19.269585089172992, 29.205270393285325, -14.823256943239855, -92.92846023963273, -17.770160247551303, 69.73511337412192, 70.36768875344733, 74.26642720523, 36.4704436164226, -57.2062813132534, 10.479646639209397, -13.007861024580688, -52.7964996374012, -43.36200414823751, 3.381318129999528, 59.79585309183116, 2.58332119560336, 131.28811512139316, 12.602123148231136, 41.329531951055166, 118.87923157003874, 5.133805558911654, 21.770211164006515, 23.396332846472923, -73.2745667368591], "episode_lengths": [56, 41, 69, 200, 200, 200, 93, 200, 98, 44, 58, 42, 200, 200, 35, 62, 200, 200, 200, 200, 200, 45, 200, 159, 127, 200, 131, 200, 200, 200, 140, 43, 161, 200, 200, 108, 200, 200, 83, 200, 200, 51, 43, 200, 55, 56, 200, 200, 11, 200, 200, 69, 200, 200, 56, 166, 200, 1, 151, 191, 200, 200, 200, 36, 200, 200, 144, 200, 44, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 6, 200, 200, 187, 200, 200, 33, 200, 200], "policy_agent_policy_reward": [36.4295012186467, 62.80863501574241, 26.328019811002033, 8.753889542915967, -13.468575856629336, 9.546056887732448, 53.92249435023668, -34.91823075935417, 31.031367133039577, 39.96005166294505, 54.70734324724646, 31.077446798580816, -24.854698335599586, 52.454443429443, 60.295196846570555, 44.52844062109377, -4.077800880521295, -15.210149564119533, 12.09602417810791, 9.320260771967732, 19.637211088653725, 47.609333208252124, 49.62761091602078, 20.778599809257827, 24.60183028161804, 48.69046318939782, 39.287709769884636, 40.39271378520355, 7.286180901406524, 45.644523864166814, 58.82008422596799, 14.89415897087402, 50.59448632575595, 18.424593669952323, 6.1377201403729735, 36.672008209035226, 4.842333575656532, -22.856386985437958, 63.96821745117567, 7.549052395045127, 13.198265490088751, 30.99352487084277, 31.89348420042883, -8.783700059355347, 41.90122096571915, 63.91454288699846, 16.786962151844104, 19.461526589570727, 7.148294231432368, -11.66991607086906, 75.26681278573226, 75.61805328152877, -26.78920110116394, 15.047557288136856, 23.57599987861276, 52.1720780295259, -12.59559870745948, 0.6601434993336184, 43.5239810298169, 22.986940914196488, 3.339266236504617, -39.541852648263706, -27.487905024073953, 6.465471191580669, -26.602286583055232, -4.246759477868043, 55.99598691828595, -11.968004249927457, 38.03355101714547, -4.90976331587418, -0.499635882198902, 26.79879092509418, 5.39308039766037, 65.1268071909457, -8.972498283553126, 9.634792544586496, 14.602635196642659, -7.411628471619927, -46.46423011981639, -8.885080123775637, 34.86755668706097, 35.183844376723656, 37.133213602615044, 18.235221808211303, -28.60314065662677, 5.2398233196046995, -6.503930512290353, -26.398249818700627, -21.681002074118744, 1.6906590649997568, 29.89792654591559, 1.29166059780168, 65.6440575606966, 6.3010615741155735, 20.664765975527594, 59.439615785019356, 2.566902779455827, 10.885105582003257, 11.698166423236461, -36.63728336842951], "policy_adversary_policy_reward": [23.305114469300094, 13.124386749346595, 32.358167706828446, 30.45046730891397, -5.174291688628088, 31.50231149963012, -5.336703455386871, 14.090592998302839, -14.72428835979467, 1.2557125031653342, -1.4649555811964632, 11.01101246892891, 30.35553550761544, 23.566958842621247, -18.788770964999962, -16.129459794354208, 16.17644236829242, 14.854924764747153, 19.985164551246235, 19.97488711169881, 30.395417177268527, 24.311926069977922, -0.2103328454086153, 31.28777964398943, 0.2017840855028865, -25.056482421102466, 22.622272364096958, 29.832171065346046, 30.746081363173527, 29.549115483397024, 27.984394271419795, 16.54404634967398, -14.775166968740315, 10.69736608821902, 1.197598833182326, -16.407748397301855, -3.027764371793058, 15.123788549900969, 1.6107223705690643, 7.709538401398671, 13.283443544001123, 6.353767544652598, 28.561581965831223, 19.047751242420908, 29.26105421115166, 20.366556704869094, 10.377880015282795, 10.400719793975032, 8.5645893316496, 16.03724094996844, 29.09045017616514, 19.600013013232676, 34.335095966110266, 4.952613803774374, 29.13336634084049, 11.259347444363065, 3.829298712196419, 3.4568821892101074, 17.54550686524642, 28.099016998920394, 34.37320508900761, 24.446879136960384, 25.77223831317512, -10.8780793423011, 24.641258695673944, 25.953227630082, 8.696934537060475, 9.727659132891848, 18.387199213227476, -12.249479072854506, 31.201711978949678, 5.470296230085546, -9.214963625556006, 14.057297201212538, -18.417337416177197, -4.43904956926076, 43.25346368871208, 20.71475376246359, -4.071540500509482, 11.620592895554609, -8.570363760207186, 21.768629250295938, 32.14070033438705, -1.1471754635442863, -5.3697972964475085, 37.26328149687633, -0.2559727670828025, -8.527727292272534, 42.26168861644615, -0.3604676507270099, 28.985360696482445, 34.929182190516016, 10.47396408135413, 6.312998070489975, 2.1612349136438986, 17.30029167592683, -6.371121593620153, 13.519415825052523, -2.201881140701847, -9.468034930167207, 38.51299408897183, 36.75381869676042, 34.31257216406224, 41.30548111746652, -6.245025713936428, -20.54417538722751, 9.819169523383708, 5.228387764753144, 9.61184859088305, 13.964151287729706, 29.468872876160077, 22.70320515336581, -16.93862403255639, 4.343025325096914, 0.6036582203944363, 0.05648527893918209, 35.49129163566039, 8.032689394156522, 7.982350058947419, 15.00459085524907, -4.153487820342356, 7.492754056846977, -36.746949649574915, -2.7949029986887908, -9.962902154932522, -17.525002869141435, -14.041173704310246, 20.50664489589091, -20.572905712927767, -6.029380870127472, 2.7858278447617124, -7.032587322629755, 31.746606796860974, 24.24938012142497, -9.436917553361493, -2.5310866965659855, 29.422105410485983, 8.61144560665948, -3.2590056472429403, -1.6507576686312468, -9.069004015164012, 8.56936813296511, 9.847171220375099, 16.951619704719082, -2.3991578427390294, 7.792238240399399, 30.252527035478685, 34.874280155467005, -9.056584843829688, 0.08408656027656392, 6.226926642358485, 3.4078659022280107, 9.863102300963586, 4.739532895679073, -5.291345634909668, -2.1202828367102597, -23.852058411327086, -22.612171708489306, -9.07192798785482, 0.18684786407918352, 27.438112643653152, 7.429444043407804, 23.264168876396685, 11.919675500326978, 17.581458829697922, 19.551754772917132, 17.16637072889946, 1.0688510793118446, -34.045277656313516, 5.442136999686767, 0.8385626291615331, 4.401260690443166, 0.32402802778001316, -6.827958540070366, -23.12551071788147, -3.2727391008191518, 3.682346645275203, -25.363348719393947, -0.7958773819109286, 2.4865364469106837, 28.028826652089315, 1.869099893826263, -5.743581219398266, 7.035241817199946, 30.697921364687808, 34.94613619600878, -8.783167595853973, 15.084229169969543, -9.036673279939574, 29.70143925546715, 31.861392074493335, 27.578223710526036, -1.3018102315626585, 3.8687130110184853, 20.640777767187807, -9.75567218518455, -4.4672964556029235, 16.165462878839385, -19.38460981433649, -17.252673554093022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38599215206183696, "mean_inference_ms": 0.9606934008657575, "mean_action_processing_ms": 0.16382581517144357, "mean_env_wait_ms": 0.05638381998972061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00325620174407959, "StateBufferConnector_ms": 0.002557516098022461, "ViewRequirementAgentConnector_ms": 0.06475961208343506}, "num_episodes": 25, "episode_return_max": 151.23610656305752, "episode_return_min": -92.92846023963273, "episode_return_mean": 35.13919691515017}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 518.3184134501417, "num_env_steps_trained_throughput_per_sec": 518.3184134501417, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1044000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 7870.93, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7870.894, "sample_time_ms": 757.003, "learn_time_ms": 7103.074, "learn_throughput": 563.136, "synch_weights_time_ms": 10.373}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "training_iteration": 87, "trial_id": "eaa30_00000", "date": "2024-08-09_17-52-07", "timestamp": 1723240327, "time_this_iter_s": 7.722870111465454, "time_total_s": 712.4328441619873, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fbf7ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 712.4328441619873, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 21.80909090909091, "ram_util_percent": 79.25454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.572648762458216, "cur_kl_coeff": 0.22806973457336432, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8143848088683274, "policy_loss": -0.003133158858067223, "vf_loss": 3.8155782688231694, "vf_explained_var": 0.1939937615836108, "kl": 0.008504850195262523, "entropy": 0.656309338473769, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.54934066918989, "cur_kl_coeff": 0.5201580382836484, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.760449053843816, "policy_loss": 0.002668744933907874, "vf_loss": 5.753286197781563, "vf_explained_var": 0.160651456626753, "kl": 0.008639855017827358, "entropy": 0.6359708089381456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 151.23610656305752, "episode_reward_min": -105.28997037789776, "episode_reward_mean": 27.425268306634052, "episode_len_mean": 163.73, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 16373, "policy_reward_min": {"agent_policy": -52.6449851889489, "adversary_policy": -45.00421046688238}, "policy_reward_max": {"agent_policy": 75.61805328152877, "adversary_policy": 47.43284132218002}, "policy_reward_mean": {"agent_policy": 13.712634153317026, "adversary_policy": 6.856317076658513}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.203660563236, 97.38092637879564, 78.57541953976929, 80.78542757040708, 14.572361802813028, 91.28904772833364, 117.64016845193599, 29.788317941748037, 101.18897265151179, 36.849187339904645, 12.275440280745947, 73.34401641807042, 9.684667151313043, -45.712773970875936, 127.93643490235138, 15.098104790090254, 26.39653098017751, 61.98704974168555, 63.78696840085766, -17.56740011871058, 83.80244193143824, 127.8290857739969, 33.57392430368821, 38.923053179141455, 14.29658846286474, -23.339832141738086, 150.53362557146446, 151.23610656305752, -53.57840220232788, 30.0951145762737, 47.15199975722551, 104.34415605905178, -25.191197414918975, 1.3202869986672368, 87.04796205963385, 45.97388182839296, 6.678532473009259, -79.08370529652748, -54.975810048147906, 12.930942383161337, -53.20457316611035, -8.493518955736086, 111.99197383657193, -23.93600849985488, 76.06710203429093, -9.819526631748403, -0.999271764397804, 53.59758185018838, 10.78616079532074, 130.25361438189134, -17.94499656710623, 19.269585089172992, 29.205270393285325, -14.823256943239855, -92.92846023963273, -17.770160247551303, 69.73511337412192, 70.36768875344733, 74.26642720523, 36.4704436164226, -57.2062813132534, 10.479646639209397, -13.007861024580688, -52.7964996374012, -43.36200414823751, 3.381318129999528, 59.79585309183116, 2.58332119560336, 131.28811512139316, 12.602123148231136, 41.329531951055166, 118.87923157003874, 5.133805558911654, 21.770211164006515, 23.396332846472923, -73.2745667368591, -30.474453596138076, 24.291238195970458, 119.22103821534674, 2.4385471208091545, -9.359573292593268, -19.321295478475022, -13.262573026585315, -105.28997037789776, 48.63138598009911, 53.84608811164149, 42.52972561570775, 66.23399645419589, 33.31415538722304, -60.424384096404765, 34.72465711834616, 124.23181840670804, 52.32715939169776, 57.94815736529927, 36.57063142531241, 5.064268094104165, -50.39399285769532, -17.738366768253215, 21.55360050653453, -31.289776464102218], "episode_lengths": [127, 200, 131, 200, 200, 200, 140, 43, 161, 200, 200, 108, 200, 200, 83, 200, 200, 51, 43, 200, 55, 56, 200, 200, 11, 200, 200, 69, 200, 200, 56, 166, 200, 1, 151, 191, 200, 200, 200, 36, 200, 200, 144, 200, 44, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 6, 200, 200, 187, 200, 200, 33, 200, 200, 200, 200, 59, 200, 200, 200, 200, 200, 200, 142, 200, 189, 200, 200, 10, 65, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [24.60183028161804, 48.69046318939782, 39.287709769884636, 40.39271378520355, 7.286180901406524, 45.644523864166814, 58.82008422596799, 14.89415897087402, 50.59448632575595, 18.424593669952323, 6.1377201403729735, 36.672008209035226, 4.842333575656532, -22.856386985437958, 63.96821745117567, 7.549052395045127, 13.198265490088751, 30.99352487084277, 31.89348420042883, -8.783700059355347, 41.90122096571915, 63.91454288699846, 16.786962151844104, 19.461526589570727, 7.148294231432368, -11.66991607086906, 75.26681278573226, 75.61805328152877, -26.78920110116394, 15.047557288136856, 23.57599987861276, 52.1720780295259, -12.59559870745948, 0.6601434993336184, 43.5239810298169, 22.986940914196488, 3.339266236504617, -39.541852648263706, -27.487905024073953, 6.465471191580669, -26.602286583055232, -4.246759477868043, 55.99598691828595, -11.968004249927457, 38.03355101714547, -4.90976331587418, -0.499635882198902, 26.79879092509418, 5.39308039766037, 65.1268071909457, -8.972498283553126, 9.634792544586496, 14.602635196642659, -7.411628471619927, -46.46423011981639, -8.885080123775637, 34.86755668706097, 35.183844376723656, 37.133213602615044, 18.235221808211303, -28.60314065662677, 5.2398233196046995, -6.503930512290353, -26.398249818700627, -21.681002074118744, 1.6906590649997568, 29.89792654591559, 1.29166059780168, 65.6440575606966, 6.3010615741155735, 20.664765975527594, 59.439615785019356, 2.566902779455827, 10.885105582003257, 11.698166423236461, -36.63728336842951, -15.237226798069006, 12.145619097985229, 59.610519107673326, 1.2192735604045772, -4.679786646296613, -9.660647739237525, -6.6312865132926575, -52.6449851889489, 24.31569299004956, 26.923044055820753, 21.264862807853874, 33.116998227097945, 16.657077693611523, -30.212192048202503, 17.36232855917308, 62.115909203354, 26.163579695848878, 28.974078682649633, 18.2853157126562, 2.5321340470520894, -25.196996428847577, -8.8691833841266, 10.776800253267265, -15.64488823205106], "policy_adversary_policy_reward": [8.5645893316496, 16.03724094996844, 29.09045017616514, 19.600013013232676, 34.335095966110266, 4.952613803774374, 29.13336634084049, 11.259347444363065, 3.829298712196419, 3.4568821892101074, 17.54550686524642, 28.099016998920394, 34.37320508900761, 24.446879136960384, 25.77223831317512, -10.8780793423011, 24.641258695673944, 25.953227630082, 8.696934537060475, 9.727659132891848, 18.387199213227476, -12.249479072854506, 31.201711978949678, 5.470296230085546, -9.214963625556006, 14.057297201212538, -18.417337416177197, -4.43904956926076, 43.25346368871208, 20.71475376246359, -4.071540500509482, 11.620592895554609, -8.570363760207186, 21.768629250295938, 32.14070033438705, -1.1471754635442863, -5.3697972964475085, 37.26328149687633, -0.2559727670828025, -8.527727292272534, 42.26168861644615, -0.3604676507270099, 28.985360696482445, 34.929182190516016, 10.47396408135413, 6.312998070489975, 2.1612349136438986, 17.30029167592683, -6.371121593620153, 13.519415825052523, -2.201881140701847, -9.468034930167207, 38.51299408897183, 36.75381869676042, 34.31257216406224, 41.30548111746652, -6.245025713936428, -20.54417538722751, 9.819169523383708, 5.228387764753144, 9.61184859088305, 13.964151287729706, 29.468872876160077, 22.70320515336581, -16.93862403255639, 4.343025325096914, 0.6036582203944363, 0.05648527893918209, 35.49129163566039, 8.032689394156522, 7.982350058947419, 15.00459085524907, -4.153487820342356, 7.492754056846977, -36.746949649574915, -2.7949029986887908, -9.962902154932522, -17.525002869141435, -14.041173704310246, 20.50664489589091, -20.572905712927767, -6.029380870127472, 2.7858278447617124, -7.032587322629755, 31.746606796860974, 24.24938012142497, -9.436917553361493, -2.5310866965659855, 29.422105410485983, 8.61144560665948, -3.2590056472429403, -1.6507576686312468, -9.069004015164012, 8.56936813296511, 9.847171220375099, 16.951619704719082, -2.3991578427390294, 7.792238240399399, 30.252527035478685, 34.874280155467005, -9.056584843829688, 0.08408656027656392, 6.226926642358485, 3.4078659022280107, 9.863102300963586, 4.739532895679073, -5.291345634909668, -2.1202828367102597, -23.852058411327086, -22.612171708489306, -9.07192798785482, 0.18684786407918352, 27.438112643653152, 7.429444043407804, 23.264168876396685, 11.919675500326978, 17.581458829697922, 19.551754772917132, 17.16637072889946, 1.0688510793118446, -34.045277656313516, 5.442136999686767, 0.8385626291615331, 4.401260690443166, 0.32402802778001316, -6.827958540070366, -23.12551071788147, -3.2727391008191518, 3.682346645275203, -25.363348719393947, -0.7958773819109286, 2.4865364469106837, 28.028826652089315, 1.869099893826263, -5.743581219398266, 7.035241817199946, 30.697921364687808, 34.94613619600878, -8.783167595853973, 15.084229169969543, -9.036673279939574, 29.70143925546715, 31.861392074493335, 27.578223710526036, -1.3018102315626585, 3.8687130110184853, 20.640777767187807, -9.75567218518455, -4.4672964556029235, 16.165462878839385, -19.38460981433649, -17.252673554093022, -10.248404671857148, -4.988822126211847, 0.11198280252514436, 12.033636295460084, 47.43284132218002, 12.177677785493309, 8.849360068920468, -7.630086508515891, -0.13797384994640893, -4.541812796350197, -16.090276327474438, 6.429628588236916, 5.938538420205376, -12.569824933498033, -45.00421046688238, -7.640774722066528, 11.57739246436661, 12.738300525682948, 6.489222610590396, 20.433821445230354, -1.1826964614725757, 22.44755926932645, 9.808145293915857, 23.308852933182088, 1.730654788948236, 14.92642290466328, 0.7023601548697087, -30.914552203072212, 5.322407580330179, 12.0399209788429, 18.190804341537905, 43.9251048618161, 13.742256132394745, 12.421323563454132, 11.304194254526394, 17.66988442812324, 16.106411507347485, 2.178904205308715, 11.72258868485605, -9.19045463780396, -6.064241798894145, -19.132754629953432, -0.8505554552495447, -8.018627928877052, 11.386643910121613, -0.6098436568543484, -3.3794559358727128, -12.265432296178346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3858645556859088, "mean_inference_ms": 0.9600540849219849, "mean_action_processing_ms": 0.16369020288910907, "mean_env_wait_ms": 0.056339356167766905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003203868865966797, "StateBufferConnector_ms": 0.0025320053100585938, "ViewRequirementAgentConnector_ms": 0.06426036357879639}, "num_episodes": 24, "episode_return_max": 151.23610656305752, "episode_return_min": -105.28997037789776, "episode_return_mean": 27.425268306634052}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.52687853207084, "num_env_steps_trained_throughput_per_sec": 500.52687853207084, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 7897.582, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7897.546, "sample_time_ms": 757.645, "learn_time_ms": 7128.955, "learn_throughput": 561.092, "synch_weights_time_ms": 10.454}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 88, "trial_id": "eaa30_00000", "date": "2024-08-09_17-52-16", "timestamp": 1723240336, "time_this_iter_s": 7.99614691734314, "time_total_s": 720.4289910793304, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2890f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 720.4289910793304, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 23.875000000000004, "ram_util_percent": 79.18333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.002409924401177, "cur_kl_coeff": 0.22806973457336432, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.881494402885437, "policy_loss": -0.0024924962105052103, "vf_loss": 3.8802012988499235, "vf_explained_var": 0.24236313520915925, "kl": 0.016598406564395027, "entropy": 0.7384487121824235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.583917106377582, "cur_kl_coeff": 0.5201580382836484, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.788495897750059, "policy_loss": 0.005766377689481791, "vf_loss": 5.780710215369861, "vf_explained_var": 0.19616659556825955, "kl": 0.0038820620902697556, "entropy": 0.5998190967366099, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "env_runners": {"episode_reward_max": 151.23610656305752, "episode_reward_min": -105.28997037789776, "episode_reward_mean": 17.910837889824524, "episode_len_mean": 170.73, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 17073, "policy_reward_min": {"agent_policy": -52.6449851889489, "adversary_policy": -45.00421046688238}, "policy_reward_max": {"agent_policy": 75.61805328152877, "adversary_policy": 47.43284132218002}, "policy_reward_mean": {"agent_policy": 8.95541894491226, "adversary_policy": 4.477709472456131}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.57392430368821, 38.923053179141455, 14.29658846286474, -23.339832141738086, 150.53362557146446, 151.23610656305752, -53.57840220232788, 30.0951145762737, 47.15199975722551, 104.34415605905178, -25.191197414918975, 1.3202869986672368, 87.04796205963385, 45.97388182839296, 6.678532473009259, -79.08370529652748, -54.975810048147906, 12.930942383161337, -53.20457316611035, -8.493518955736086, 111.99197383657193, -23.93600849985488, 76.06710203429093, -9.819526631748403, -0.999271764397804, 53.59758185018838, 10.78616079532074, 130.25361438189134, -17.94499656710623, 19.269585089172992, 29.205270393285325, -14.823256943239855, -92.92846023963273, -17.770160247551303, 69.73511337412192, 70.36768875344733, 74.26642720523, 36.4704436164226, -57.2062813132534, 10.479646639209397, -13.007861024580688, -52.7964996374012, -43.36200414823751, 3.381318129999528, 59.79585309183116, 2.58332119560336, 131.28811512139316, 12.602123148231136, 41.329531951055166, 118.87923157003874, 5.133805558911654, 21.770211164006515, 23.396332846472923, -73.2745667368591, -30.474453596138076, 24.291238195970458, 119.22103821534674, 2.4385471208091545, -9.359573292593268, -19.321295478475022, -13.262573026585315, -105.28997037789776, 48.63138598009911, 53.84608811164149, 42.52972561570775, 66.23399645419589, 33.31415538722304, -60.424384096404765, 34.72465711834616, 124.23181840670804, 52.32715939169776, 57.94815736529927, 36.57063142531241, 5.064268094104165, -50.39399285769532, -17.738366768253215, 21.55360050653453, -31.289776464102218, -82.85004175466528, -11.482166495818106, -22.797407039491688, 40.47198540017597, -47.276895610680235, -52.40593943604795, 75.08590174978228, 36.20353415178562, 113.43469271474265, 102.74819331238142, 77.00990147624773, -42.842945270217285, 56.99777810786421, -59.33969552099664, 46.52740031100521, 6.776812211876795, 65.20703801810757, -29.241834058467873, -42.43655177445897, 6.085906295217043, 1.8538399780168726, 46.96150780228356], "episode_lengths": [200, 200, 11, 200, 200, 69, 200, 200, 56, 166, 200, 1, 151, 191, 200, 200, 200, 36, 200, 200, 144, 200, 44, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 6, 200, 200, 187, 200, 200, 33, 200, 200, 200, 200, 59, 200, 200, 200, 200, 200, 200, 142, 200, 189, 200, 200, 10, 65, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 3, 200], "policy_agent_policy_reward": [16.786962151844104, 19.461526589570727, 7.148294231432368, -11.66991607086906, 75.26681278573226, 75.61805328152877, -26.78920110116394, 15.047557288136856, 23.57599987861276, 52.1720780295259, -12.59559870745948, 0.6601434993336184, 43.5239810298169, 22.986940914196488, 3.339266236504617, -39.541852648263706, -27.487905024073953, 6.465471191580669, -26.602286583055232, -4.246759477868043, 55.99598691828595, -11.968004249927457, 38.03355101714547, -4.90976331587418, -0.499635882198902, 26.79879092509418, 5.39308039766037, 65.1268071909457, -8.972498283553126, 9.634792544586496, 14.602635196642659, -7.411628471619927, -46.46423011981639, -8.885080123775637, 34.86755668706097, 35.183844376723656, 37.133213602615044, 18.235221808211303, -28.60314065662677, 5.2398233196046995, -6.503930512290353, -26.398249818700627, -21.681002074118744, 1.6906590649997568, 29.89792654591559, 1.29166059780168, 65.6440575606966, 6.3010615741155735, 20.664765975527594, 59.439615785019356, 2.566902779455827, 10.885105582003257, 11.698166423236461, -36.63728336842951, -15.237226798069006, 12.145619097985229, 59.610519107673326, 1.2192735604045772, -4.679786646296613, -9.660647739237525, -6.6312865132926575, -52.6449851889489, 24.31569299004956, 26.923044055820753, 21.264862807853874, 33.116998227097945, 16.657077693611523, -30.212192048202503, 17.36232855917308, 62.115909203354, 26.163579695848878, 28.974078682649633, 18.2853157126562, 2.5321340470520894, -25.196996428847577, -8.8691833841266, 10.776800253267265, -15.64488823205106, -41.425020877332656, -5.741083247909053, -11.39870351974588, 20.235992700087987, -23.638447805340128, -26.20296971802393, 37.54295087489113, 18.101767075892806, 56.717346357371355, 51.3740966561907, 38.50495073812388, -21.421472635108614, 28.498889053932096, -29.66984776049833, 23.2637001555026, 3.388406105938394, 32.603519009053784, -14.620917029233933, -21.218275887229485, 3.0429531476085216, 0.9269199890084362, 23.480753901141796], "policy_adversary_policy_reward": [10.47396408135413, 6.312998070489975, 2.1612349136438986, 17.30029167592683, -6.371121593620153, 13.519415825052523, -2.201881140701847, -9.468034930167207, 38.51299408897183, 36.75381869676042, 34.31257216406224, 41.30548111746652, -6.245025713936428, -20.54417538722751, 9.819169523383708, 5.228387764753144, 9.61184859088305, 13.964151287729706, 29.468872876160077, 22.70320515336581, -16.93862403255639, 4.343025325096914, 0.6036582203944363, 0.05648527893918209, 35.49129163566039, 8.032689394156522, 7.982350058947419, 15.00459085524907, -4.153487820342356, 7.492754056846977, -36.746949649574915, -2.7949029986887908, -9.962902154932522, -17.525002869141435, -14.041173704310246, 20.50664489589091, -20.572905712927767, -6.029380870127472, 2.7858278447617124, -7.032587322629755, 31.746606796860974, 24.24938012142497, -9.436917553361493, -2.5310866965659855, 29.422105410485983, 8.61144560665948, -3.2590056472429403, -1.6507576686312468, -9.069004015164012, 8.56936813296511, 9.847171220375099, 16.951619704719082, -2.3991578427390294, 7.792238240399399, 30.252527035478685, 34.874280155467005, -9.056584843829688, 0.08408656027656392, 6.226926642358485, 3.4078659022280107, 9.863102300963586, 4.739532895679073, -5.291345634909668, -2.1202828367102597, -23.852058411327086, -22.612171708489306, -9.07192798785482, 0.18684786407918352, 27.438112643653152, 7.429444043407804, 23.264168876396685, 11.919675500326978, 17.581458829697922, 19.551754772917132, 17.16637072889946, 1.0688510793118446, -34.045277656313516, 5.442136999686767, 0.8385626291615331, 4.401260690443166, 0.32402802778001316, -6.827958540070366, -23.12551071788147, -3.2727391008191518, 3.682346645275203, -25.363348719393947, -0.7958773819109286, 2.4865364469106837, 28.028826652089315, 1.869099893826263, -5.743581219398266, 7.035241817199946, 30.697921364687808, 34.94613619600878, -8.783167595853973, 15.084229169969543, -9.036673279939574, 29.70143925546715, 31.861392074493335, 27.578223710526036, -1.3018102315626585, 3.8687130110184853, 20.640777767187807, -9.75567218518455, -4.4672964556029235, 16.165462878839385, -19.38460981433649, -17.252673554093022, -10.248404671857148, -4.988822126211847, 0.11198280252514436, 12.033636295460084, 47.43284132218002, 12.177677785493309, 8.849360068920468, -7.630086508515891, -0.13797384994640893, -4.541812796350197, -16.090276327474438, 6.429628588236916, 5.938538420205376, -12.569824933498033, -45.00421046688238, -7.640774722066528, 11.57739246436661, 12.738300525682948, 6.489222610590396, 20.433821445230354, -1.1826964614725757, 22.44755926932645, 9.808145293915857, 23.308852933182088, 1.730654788948236, 14.92642290466328, 0.7023601548697087, -30.914552203072212, 5.322407580330179, 12.0399209788429, 18.190804341537905, 43.9251048618161, 13.742256132394745, 12.421323563454132, 11.304194254526394, 17.66988442812324, 16.106411507347485, 2.178904205308715, 11.72258868485605, -9.19045463780396, -6.064241798894145, -19.132754629953432, -0.8505554552495447, -8.018627928877052, 11.386643910121613, -0.6098436568543484, -3.3794559358727128, -12.265432296178346, -33.45313326047342, -7.9718876168592345, 3.3791694731570843, -9.120252721066137, -6.911138493871508, -4.48756502587435, -5.099028947295757, 25.33502164738375, -29.408201668484693, 5.769753863144565, 8.22758515231126, -34.4305548703352, 15.582150601257894, 21.96080027363323, -10.581240748890977, 28.683007824783783, 17.459896668049776, 39.25744968932159, 18.373027877133826, 33.001068779056894, 24.247634192346105, 14.257316545777805, -9.320531394505192, -12.10094124060345, -5.023436026192236, 33.52232508012433, -9.488294798201416, -20.181552962296912, 29.827696733960966, -6.563996578458363, 3.0510575421135115, 0.3373485638248841, 5.7239309247566315, 26.879588084297144, 5.090203167802379, -19.711120197036312, -5.291937565890208, -15.926338321339276, 9.33958675498426, -6.296633607375739, -1.4699416564141305, 2.396861645422567, 16.251530308858083, 7.229223592283713]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38567978873692693, "mean_inference_ms": 0.9601549611578604, "mean_action_processing_ms": 0.16362767504921705, "mean_env_wait_ms": 0.05629435265931205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003232598304748535, "StateBufferConnector_ms": 0.002585291862487793, "ViewRequirementAgentConnector_ms": 0.06481432914733887}, "num_episodes": 22, "episode_return_max": 151.23610656305752, "episode_return_min": -105.28997037789776, "episode_return_mean": 17.910837889824524}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.5898305970245, "num_env_steps_trained_throughput_per_sec": 502.5898305970245, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1068000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 7918.349, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7918.313, "sample_time_ms": 762.398, "learn_time_ms": 7144.725, "learn_throughput": 559.854, "synch_weights_time_ms": 10.697}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "training_iteration": 89, "trial_id": "eaa30_00000", "date": "2024-08-09_17-52-24", "timestamp": 1723240344, "time_this_iter_s": 7.963917970657349, "time_total_s": 728.3929090499878, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17809e1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 728.3929090499878, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 22.55454545454546, "ram_util_percent": 79.03636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.944357051420464, "cur_kl_coeff": 0.22806973457336432, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.226609812337886, "policy_loss": 0.0011874622342585728, "vf_loss": 4.222566716254703, "vf_explained_var": 0.10954871581345008, "kl": 0.01252086566706932, "entropy": 0.8250872599700141, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.042384202219546, "cur_kl_coeff": 0.2600790191418242, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.283885364234448, "policy_loss": -0.004045562152411245, "vf_loss": 6.28676276554664, "vf_explained_var": 0.03798053277035554, "kl": 0.004491572374657456, "entropy": 0.6026695205519597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 131.28811512139316, "episode_reward_min": -105.28997037789776, "episode_reward_mean": 11.956652071292472, "episode_len_mean": 174.07, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 17407, "policy_reward_min": {"agent_policy": -52.6449851889489, "adversary_policy": -45.00421046688238}, "policy_reward_max": {"agent_policy": 65.6440575606966, "adversary_policy": 47.43284132218002}, "policy_reward_mean": {"agent_policy": 5.978326035646239, "adversary_policy": 2.9891630178231186}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.999271764397804, 53.59758185018838, 10.78616079532074, 130.25361438189134, -17.94499656710623, 19.269585089172992, 29.205270393285325, -14.823256943239855, -92.92846023963273, -17.770160247551303, 69.73511337412192, 70.36768875344733, 74.26642720523, 36.4704436164226, -57.2062813132534, 10.479646639209397, -13.007861024580688, -52.7964996374012, -43.36200414823751, 3.381318129999528, 59.79585309183116, 2.58332119560336, 131.28811512139316, 12.602123148231136, 41.329531951055166, 118.87923157003874, 5.133805558911654, 21.770211164006515, 23.396332846472923, -73.2745667368591, -30.474453596138076, 24.291238195970458, 119.22103821534674, 2.4385471208091545, -9.359573292593268, -19.321295478475022, -13.262573026585315, -105.28997037789776, 48.63138598009911, 53.84608811164149, 42.52972561570775, 66.23399645419589, 33.31415538722304, -60.424384096404765, 34.72465711834616, 124.23181840670804, 52.32715939169776, 57.94815736529927, 36.57063142531241, 5.064268094104165, -50.39399285769532, -17.738366768253215, 21.55360050653453, -31.289776464102218, -82.85004175466528, -11.482166495818106, -22.797407039491688, 40.47198540017597, -47.276895610680235, -52.40593943604795, 75.08590174978228, 36.20353415178562, 113.43469271474265, 102.74819331238142, 77.00990147624773, -42.842945270217285, 56.99777810786421, -59.33969552099664, 46.52740031100521, 6.776812211876795, 65.20703801810757, -29.241834058467873, -42.43655177445897, 6.085906295217043, 1.8538399780168726, 46.96150780228356, 49.861298148646924, -45.364142849421654, 11.024304452661628, -26.63014901364646, 8.98919314874841, 29.371480747308635, -14.76367929743067, -32.85422466938221, -39.607182570580946, 1.507171964506412, 63.3935668867058, 5.81348710906671, 21.502518386727772, 127.02128719710689, 28.889717775512487, 5.746075811958804, -25.40975968485757, -38.96100373339041, -15.169886022890985, 27.30957041789972, -7.053449528063837, -82.60261634554095, -97.32882720474518, 30.43934274928045], "episode_lengths": [200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 6, 200, 200, 187, 200, 200, 33, 200, 200, 200, 200, 59, 200, 200, 200, 200, 200, 200, 142, 200, 189, 200, 200, 10, 65, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 3, 200, 180, 200, 10, 200, 200, 200, 200, 200, 200, 200, 165, 200, 8, 169, 200, 200, 200, 200, 200, 48, 200, 200, 200, 23], "policy_agent_policy_reward": [-0.499635882198902, 26.79879092509418, 5.39308039766037, 65.1268071909457, -8.972498283553126, 9.634792544586496, 14.602635196642659, -7.411628471619927, -46.46423011981639, -8.885080123775637, 34.86755668706097, 35.183844376723656, 37.133213602615044, 18.235221808211303, -28.60314065662677, 5.2398233196046995, -6.503930512290353, -26.398249818700627, -21.681002074118744, 1.6906590649997568, 29.89792654591559, 1.29166059780168, 65.6440575606966, 6.3010615741155735, 20.664765975527594, 59.439615785019356, 2.566902779455827, 10.885105582003257, 11.698166423236461, -36.63728336842951, -15.237226798069006, 12.145619097985229, 59.610519107673326, 1.2192735604045772, -4.679786646296613, -9.660647739237525, -6.6312865132926575, -52.6449851889489, 24.31569299004956, 26.923044055820753, 21.264862807853874, 33.116998227097945, 16.657077693611523, -30.212192048202503, 17.36232855917308, 62.115909203354, 26.163579695848878, 28.974078682649633, 18.2853157126562, 2.5321340470520894, -25.196996428847577, -8.8691833841266, 10.776800253267265, -15.64488823205106, -41.425020877332656, -5.741083247909053, -11.39870351974588, 20.235992700087987, -23.638447805340128, -26.20296971802393, 37.54295087489113, 18.101767075892806, 56.717346357371355, 51.3740966561907, 38.50495073812388, -21.421472635108614, 28.498889053932096, -29.66984776049833, 23.2637001555026, 3.388406105938394, 32.603519009053784, -14.620917029233933, -21.218275887229485, 3.0429531476085216, 0.9269199890084362, 23.480753901141796, 24.930649074323448, -22.68207142471087, 5.512152226330815, -13.31507450682323, 4.4945965743742065, 14.685740373654308, -7.381839648715324, -16.427112334691124, -19.80359128529046, 0.753585982253206, 31.696783443352864, 2.906743554533353, 10.751259193363886, 63.510643598553486, 14.444858887756238, 2.873037905979402, -12.704879842428785, -19.480501866695203, -7.5849430114454925, 13.654785208949868, -3.5267247640319326, -41.301308172770426, -48.664413602372534, 15.219671374640226], "policy_adversary_policy_reward": [-9.069004015164012, 8.56936813296511, 9.847171220375099, 16.951619704719082, -2.3991578427390294, 7.792238240399399, 30.252527035478685, 34.874280155467005, -9.056584843829688, 0.08408656027656392, 6.226926642358485, 3.4078659022280107, 9.863102300963586, 4.739532895679073, -5.291345634909668, -2.1202828367102597, -23.852058411327086, -22.612171708489306, -9.07192798785482, 0.18684786407918352, 27.438112643653152, 7.429444043407804, 23.264168876396685, 11.919675500326978, 17.581458829697922, 19.551754772917132, 17.16637072889946, 1.0688510793118446, -34.045277656313516, 5.442136999686767, 0.8385626291615331, 4.401260690443166, 0.32402802778001316, -6.827958540070366, -23.12551071788147, -3.2727391008191518, 3.682346645275203, -25.363348719393947, -0.7958773819109286, 2.4865364469106837, 28.028826652089315, 1.869099893826263, -5.743581219398266, 7.035241817199946, 30.697921364687808, 34.94613619600878, -8.783167595853973, 15.084229169969543, -9.036673279939574, 29.70143925546715, 31.861392074493335, 27.578223710526036, -1.3018102315626585, 3.8687130110184853, 20.640777767187807, -9.75567218518455, -4.4672964556029235, 16.165462878839385, -19.38460981433649, -17.252673554093022, -10.248404671857148, -4.988822126211847, 0.11198280252514436, 12.033636295460084, 47.43284132218002, 12.177677785493309, 8.849360068920468, -7.630086508515891, -0.13797384994640893, -4.541812796350197, -16.090276327474438, 6.429628588236916, 5.938538420205376, -12.569824933498033, -45.00421046688238, -7.640774722066528, 11.57739246436661, 12.738300525682948, 6.489222610590396, 20.433821445230354, -1.1826964614725757, 22.44755926932645, 9.808145293915857, 23.308852933182088, 1.730654788948236, 14.92642290466328, 0.7023601548697087, -30.914552203072212, 5.322407580330179, 12.0399209788429, 18.190804341537905, 43.9251048618161, 13.742256132394745, 12.421323563454132, 11.304194254526394, 17.66988442812324, 16.106411507347485, 2.178904205308715, 11.72258868485605, -9.19045463780396, -6.064241798894145, -19.132754629953432, -0.8505554552495447, -8.018627928877052, 11.386643910121613, -0.6098436568543484, -3.3794559358727128, -12.265432296178346, -33.45313326047342, -7.9718876168592345, 3.3791694731570843, -9.120252721066137, -6.911138493871508, -4.48756502587435, -5.099028947295757, 25.33502164738375, -29.408201668484693, 5.769753863144565, 8.22758515231126, -34.4305548703352, 15.582150601257894, 21.96080027363323, -10.581240748890977, 28.683007824783783, 17.459896668049776, 39.25744968932159, 18.373027877133826, 33.001068779056894, 24.247634192346105, 14.257316545777805, -9.320531394505192, -12.10094124060345, -5.023436026192236, 33.52232508012433, -9.488294798201416, -20.181552962296912, 29.827696733960966, -6.563996578458363, 3.0510575421135115, 0.3373485638248841, 5.7239309247566315, 26.879588084297144, 5.090203167802379, -19.711120197036312, -5.291937565890208, -15.926338321339276, 9.33958675498426, -6.296633607375739, -1.4699416564141305, 2.396861645422567, 16.251530308858083, 7.229223592283713, 22.5935110345399, 2.3371380397835466, -8.597757577975855, -14.08431384673501, 10.511102487648401, -4.998950261317587, -9.833869085664006, -3.481205421159224, 2.3321882570775614, 2.162408317296645, 2.5022634600059455, 12.183476913648363, -9.376836992889892, 1.9949973441745676, 6.593496961890445, -23.02060929658157, -1.1055618269116536, -18.6980294583788, 1.709273348811756, -0.9556873665585499, 33.10060094866233, -1.4038175053094637, 15.699879207038489, -12.79313565250514, 6.402544984812455, 4.348714208551431, 28.02292202444381, 35.48772157410967, 13.064289473433673, 1.380569414322565, -3.4151489435193128, 6.2881868494987145, -16.485089973381825, 3.780210130953037, -8.230339564839348, -11.250162301855855, -2.0738141945752364, -5.511128816870256, -24.560102562350856, 38.214887771300724, 3.8522643318632603, -7.378989095895193, -21.778488660962918, -19.52281951180751, -30.246755955865616, -18.417657646506907, 0.5756546115262466, 14.64401676311398]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3857111224780585, "mean_inference_ms": 0.9601722751404617, "mean_action_processing_ms": 0.16354757791372163, "mean_env_wait_ms": 0.0562859027215475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043277740478515625, "StateBufferConnector_ms": 0.002669811248779297, "ViewRequirementAgentConnector_ms": 0.06752800941467285}, "num_episodes": 24, "episode_return_max": 131.28811512139316, "episode_return_min": -105.28997037789776, "episode_return_mean": 11.956652071292472}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.52133647367475, "num_env_steps_trained_throughput_per_sec": 485.52133647367475, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 7966.234, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7966.198, "sample_time_ms": 777.03, "learn_time_ms": 7177.872, "learn_throughput": 557.268, "synch_weights_time_ms": 10.805}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 90, "trial_id": "eaa30_00000", "date": "2024-08-09_17-52-32", "timestamp": 1723240352, "time_this_iter_s": 8.243204116821289, "time_total_s": 736.6361131668091, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17809e5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 736.6361131668091, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 24.22500000000001, "ram_util_percent": 79.89166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.014975417669488, "cur_kl_coeff": 0.22806973457336432, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.214491023083843, "policy_loss": -0.0009623774764665142, "vf_loss": 4.213056536578628, "vf_explained_var": 0.17037462361905942, "kl": 0.010509347776936554, "entropy": 0.8387678047967335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.460361878573895, "cur_kl_coeff": 0.1300395095709121, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.6463967829942705, "policy_loss": -0.0014246599637165976, "vf_loss": 5.647104842960834, "vf_explained_var": 0.1234766874462366, "kl": 0.005510688501090044, "entropy": 0.6137819472700358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "env_runners": {"episode_reward_max": 127.02128719710689, "episode_reward_min": -105.28997037789776, "episode_reward_mean": 12.787993949986701, "episode_len_mean": 173.74, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 17374, "policy_reward_min": {"agent_policy": -52.6449851889489, "adversary_policy": -45.00421046688238}, "policy_reward_max": {"agent_policy": 63.510643598553486, "adversary_policy": 47.43284132218002}, "policy_reward_mean": {"agent_policy": 6.393996974993351, "adversary_policy": 3.196998487496677}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.602123148231136, 41.329531951055166, 118.87923157003874, 5.133805558911654, 21.770211164006515, 23.396332846472923, -73.2745667368591, -30.474453596138076, 24.291238195970458, 119.22103821534674, 2.4385471208091545, -9.359573292593268, -19.321295478475022, -13.262573026585315, -105.28997037789776, 48.63138598009911, 53.84608811164149, 42.52972561570775, 66.23399645419589, 33.31415538722304, -60.424384096404765, 34.72465711834616, 124.23181840670804, 52.32715939169776, 57.94815736529927, 36.57063142531241, 5.064268094104165, -50.39399285769532, -17.738366768253215, 21.55360050653453, -31.289776464102218, -82.85004175466528, -11.482166495818106, -22.797407039491688, 40.47198540017597, -47.276895610680235, -52.40593943604795, 75.08590174978228, 36.20353415178562, 113.43469271474265, 102.74819331238142, 77.00990147624773, -42.842945270217285, 56.99777810786421, -59.33969552099664, 46.52740031100521, 6.776812211876795, 65.20703801810757, -29.241834058467873, -42.43655177445897, 6.085906295217043, 1.8538399780168726, 46.96150780228356, 49.861298148646924, -45.364142849421654, 11.024304452661628, -26.63014901364646, 8.98919314874841, 29.371480747308635, -14.76367929743067, -32.85422466938221, -39.607182570580946, 1.507171964506412, 63.3935668867058, 5.81348710906671, 21.502518386727772, 127.02128719710689, 28.889717775512487, 5.746075811958804, -25.40975968485757, -38.96100373339041, -15.169886022890985, 27.30957041789972, -7.053449528063837, -82.60261634554095, -97.32882720474518, 30.43934274928045, -6.742209435275626, -5.910559328022441, -18.582804484481382, -68.55447927678216, -25.165671172980538, 58.19658100425025, 113.34375658530388, 103.64810367574407, 33.44471042181, 49.507797779649565, 59.96553903578288, 37.85612674940357, -84.96982353484708, -12.755708015542602, 63.04419430261166, -67.2465034736581, -17.43076157472096, 23.301969960066387, 65.89762503956624, 10.011049363604577, -28.224276104270885, 109.51810574406065, 81.62277235986775], "episode_lengths": [200, 187, 200, 200, 33, 200, 200, 200, 200, 59, 200, 200, 200, 200, 200, 200, 142, 200, 189, 200, 200, 10, 65, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 3, 200, 180, 200, 10, 200, 200, 200, 200, 200, 200, 200, 165, 200, 8, 169, 200, 200, 200, 200, 200, 48, 200, 200, 200, 23, 200, 16, 200, 200, 200, 197, 200, 83, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 175, 200, 83, 200], "policy_agent_policy_reward": [6.3010615741155735, 20.664765975527594, 59.439615785019356, 2.566902779455827, 10.885105582003257, 11.698166423236461, -36.63728336842951, -15.237226798069006, 12.145619097985229, 59.610519107673326, 1.2192735604045772, -4.679786646296613, -9.660647739237525, -6.6312865132926575, -52.6449851889489, 24.31569299004956, 26.923044055820753, 21.264862807853874, 33.116998227097945, 16.657077693611523, -30.212192048202503, 17.36232855917308, 62.115909203354, 26.163579695848878, 28.974078682649633, 18.2853157126562, 2.5321340470520894, -25.196996428847577, -8.8691833841266, 10.776800253267265, -15.64488823205106, -41.425020877332656, -5.741083247909053, -11.39870351974588, 20.235992700087987, -23.638447805340128, -26.20296971802393, 37.54295087489113, 18.101767075892806, 56.717346357371355, 51.3740966561907, 38.50495073812388, -21.421472635108614, 28.498889053932096, -29.66984776049833, 23.2637001555026, 3.388406105938394, 32.603519009053784, -14.620917029233933, -21.218275887229485, 3.0429531476085216, 0.9269199890084362, 23.480753901141796, 24.930649074323448, -22.68207142471087, 5.512152226330815, -13.31507450682323, 4.4945965743742065, 14.685740373654308, -7.381839648715324, -16.427112334691124, -19.80359128529046, 0.753585982253206, 31.696783443352864, 2.906743554533353, 10.751259193363886, 63.510643598553486, 14.444858887756238, 2.873037905979402, -12.704879842428785, -19.480501866695203, -7.5849430114454925, 13.654785208949868, -3.5267247640319326, -41.301308172770426, -48.664413602372534, 15.219671374640226, -3.37110471763782, -2.955279664011221, -9.291402242240718, -34.27723963839111, -12.582835586490276, 29.098290502125128, 56.67187829265197, 51.82405183787204, 16.722355210905, 24.753898889824782, 29.982769517891434, 18.928063374701793, -42.484911767423576, -6.37785400777131, 31.522097151305804, -33.62325173682903, -8.715380787360484, 11.650984980033193, 32.94881251978311, 5.005524681802289, -14.11213805213551, 54.759052872030274, 40.81138617993392], "policy_adversary_policy_reward": [-8.783167595853973, 15.084229169969543, -9.036673279939574, 29.70143925546715, 31.861392074493335, 27.578223710526036, -1.3018102315626585, 3.8687130110184853, 20.640777767187807, -9.75567218518455, -4.4672964556029235, 16.165462878839385, -19.38460981433649, -17.252673554093022, -10.248404671857148, -4.988822126211847, 0.11198280252514436, 12.033636295460084, 47.43284132218002, 12.177677785493309, 8.849360068920468, -7.630086508515891, -0.13797384994640893, -4.541812796350197, -16.090276327474438, 6.429628588236916, 5.938538420205376, -12.569824933498033, -45.00421046688238, -7.640774722066528, 11.57739246436661, 12.738300525682948, 6.489222610590396, 20.433821445230354, -1.1826964614725757, 22.44755926932645, 9.808145293915857, 23.308852933182088, 1.730654788948236, 14.92642290466328, 0.7023601548697087, -30.914552203072212, 5.322407580330179, 12.0399209788429, 18.190804341537905, 43.9251048618161, 13.742256132394745, 12.421323563454132, 11.304194254526394, 17.66988442812324, 16.106411507347485, 2.178904205308715, 11.72258868485605, -9.19045463780396, -6.064241798894145, -19.132754629953432, -0.8505554552495447, -8.018627928877052, 11.386643910121613, -0.6098436568543484, -3.3794559358727128, -12.265432296178346, -33.45313326047342, -7.9718876168592345, 3.3791694731570843, -9.120252721066137, -6.911138493871508, -4.48756502587435, -5.099028947295757, 25.33502164738375, -29.408201668484693, 5.769753863144565, 8.22758515231126, -34.4305548703352, 15.582150601257894, 21.96080027363323, -10.581240748890977, 28.683007824783783, 17.459896668049776, 39.25744968932159, 18.373027877133826, 33.001068779056894, 24.247634192346105, 14.257316545777805, -9.320531394505192, -12.10094124060345, -5.023436026192236, 33.52232508012433, -9.488294798201416, -20.181552962296912, 29.827696733960966, -6.563996578458363, 3.0510575421135115, 0.3373485638248841, 5.7239309247566315, 26.879588084297144, 5.090203167802379, -19.711120197036312, -5.291937565890208, -15.926338321339276, 9.33958675498426, -6.296633607375739, -1.4699416564141305, 2.396861645422567, 16.251530308858083, 7.229223592283713, 22.5935110345399, 2.3371380397835466, -8.597757577975855, -14.08431384673501, 10.511102487648401, -4.998950261317587, -9.833869085664006, -3.481205421159224, 2.3321882570775614, 2.162408317296645, 2.5022634600059455, 12.183476913648363, -9.376836992889892, 1.9949973441745676, 6.593496961890445, -23.02060929658157, -1.1055618269116536, -18.6980294583788, 1.709273348811756, -0.9556873665585499, 33.10060094866233, -1.4038175053094637, 15.699879207038489, -12.79313565250514, 6.402544984812455, 4.348714208551431, 28.02292202444381, 35.48772157410967, 13.064289473433673, 1.380569414322565, -3.4151489435193128, 6.2881868494987145, -16.485089973381825, 3.780210130953037, -8.230339564839348, -11.250162301855855, -2.0738141945752364, -5.511128816870256, -24.560102562350856, 38.214887771300724, 3.8522643318632603, -7.378989095895193, -21.778488660962918, -19.52281951180751, -30.246755955865616, -18.417657646506907, 0.5756546115262466, 14.64401676311398, 1.2719702922924583, -4.643075009930278, -15.215521539278589, 12.260241875267369, -15.710730896475546, 6.419328654234835, -5.663639288606561, -28.613600349784548, -16.17512676852123, 3.592291182030962, 20.676549479993174, 8.421741022131958, 32.10284358858974, 24.56903470406222, 33.66627363925175, 18.157778198620292, 8.874102129271698, 7.8482530816333025, 35.3378011071275, -10.583902217302697, 26.070764704257783, 3.9120048136336543, 20.964178235302324, -2.036114860600538, -35.379678671619494, -7.105233095804081, -4.384603200511412, -1.9932508072598871, 22.015098829587682, 9.506998321718125, -14.215142856557932, -19.408108880271087, -31.278739003550896, 22.563358216190416, 10.436999039404036, 1.2139859406291578, 31.47118307011558, 1.477629449667532, -14.492656742952583, 19.498181424754875, -1.3894281604699543, -12.722709891665552, 35.859572834497385, 18.899480037532904, 34.20375279081344, 6.6076333891204655]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3857316581538494, "mean_inference_ms": 0.9596505401672474, "mean_action_processing_ms": 0.16357880554546914, "mean_env_wait_ms": 0.056308959418713174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004347681999206543, "StateBufferConnector_ms": 0.002524256706237793, "ViewRequirementAgentConnector_ms": 0.06626546382904053}, "num_episodes": 23, "episode_return_max": 127.02128719710689, "episode_return_min": -105.28997037789776, "episode_return_mean": 12.787993949986701}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.5893045102793, "num_env_steps_trained_throughput_per_sec": 500.5893045102793, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1092000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 7947.206, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7947.171, "sample_time_ms": 776.615, "learn_time_ms": 7159.317, "learn_throughput": 558.712, "synch_weights_time_ms": 10.669}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "training_iteration": 91, "trial_id": "eaa30_00000", "date": "2024-08-09_17-52-40", "timestamp": 1723240360, "time_this_iter_s": 7.99488091468811, "time_total_s": 744.6309940814972, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17809e670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 744.6309940814972, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 22.558333333333334, "ram_util_percent": 79.83333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.236274265675318, "cur_kl_coeff": 0.22806973457336432, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.949965666336988, "policy_loss": 0.00044770042360242873, "vf_loss": 3.948364796714177, "vf_explained_var": 0.1928013664074045, "kl": 0.005056284238934202, "entropy": 0.807824925613151, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.28617795649916, "cur_kl_coeff": 0.1300395095709121, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.909956547617912, "policy_loss": -0.0006818376661006672, "vf_loss": 5.909384155770143, "vf_explained_var": 0.052584893194337685, "kl": 0.009644870377815095, "entropy": 0.6669848660628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 159.56563759970481, "episode_reward_min": -97.32882720474518, "episode_reward_mean": 10.865365609728178, "episode_len_mean": 172.26, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 17226, "policy_reward_min": {"agent_policy": -48.664413602372534, "adversary_policy": -35.379678671619494}, "policy_reward_max": {"agent_policy": 79.7828187998524, "adversary_policy": 45.97760000008551}, "policy_reward_mean": {"agent_policy": 5.432682804864092, "adversary_policy": 2.7163414024320462}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.32715939169776, 57.94815736529927, 36.57063142531241, 5.064268094104165, -50.39399285769532, -17.738366768253215, 21.55360050653453, -31.289776464102218, -82.85004175466528, -11.482166495818106, -22.797407039491688, 40.47198540017597, -47.276895610680235, -52.40593943604795, 75.08590174978228, 36.20353415178562, 113.43469271474265, 102.74819331238142, 77.00990147624773, -42.842945270217285, 56.99777810786421, -59.33969552099664, 46.52740031100521, 6.776812211876795, 65.20703801810757, -29.241834058467873, -42.43655177445897, 6.085906295217043, 1.8538399780168726, 46.96150780228356, 49.861298148646924, -45.364142849421654, 11.024304452661628, -26.63014901364646, 8.98919314874841, 29.371480747308635, -14.76367929743067, -32.85422466938221, -39.607182570580946, 1.507171964506412, 63.3935668867058, 5.81348710906671, 21.502518386727772, 127.02128719710689, 28.889717775512487, 5.746075811958804, -25.40975968485757, -38.96100373339041, -15.169886022890985, 27.30957041789972, -7.053449528063837, -82.60261634554095, -97.32882720474518, 30.43934274928045, -6.742209435275626, -5.910559328022441, -18.582804484481382, -68.55447927678216, -25.165671172980538, 58.19658100425025, 113.34375658530388, 103.64810367574407, 33.44471042181, 49.507797779649565, 59.96553903578288, 37.85612674940357, -84.96982353484708, -12.755708015542602, 63.04419430261166, -67.2465034736581, -17.43076157472096, 23.301969960066387, 65.89762503956624, 10.011049363604577, -28.224276104270885, 109.51810574406065, 81.62277235986775, -32.20199223244114, 32.028473084893555, 75.48649334928903, -77.78339164488068, 39.60031626369451, 0.0982470618840523, 159.56563759970481, 68.92606523891467, -41.00824718754615, 78.47454986193551, 1.2086189941469492, 3.1595914790122714, 15.031807604643404, 52.98706594637534, -14.608182999680068, -3.9316322701608186, 70.57269656640311, -75.8362213894107, -6.488091172770858, -54.603933176644375, -83.01488467294499, -17.51830616557674, 78.75955607511757], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 3, 200, 180, 200, 10, 200, 200, 200, 200, 200, 200, 200, 165, 200, 8, 169, 200, 200, 200, 200, 200, 48, 200, 200, 200, 23, 200, 16, 200, 200, 200, 197, 200, 83, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 175, 200, 83, 200, 200, 14, 200, 200, 200, 200, 51, 97, 200, 119, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 52], "policy_agent_policy_reward": [26.163579695848878, 28.974078682649633, 18.2853157126562, 2.5321340470520894, -25.196996428847577, -8.8691833841266, 10.776800253267265, -15.64488823205106, -41.425020877332656, -5.741083247909053, -11.39870351974588, 20.235992700087987, -23.638447805340128, -26.20296971802393, 37.54295087489113, 18.101767075892806, 56.717346357371355, 51.3740966561907, 38.50495073812388, -21.421472635108614, 28.498889053932096, -29.66984776049833, 23.2637001555026, 3.388406105938394, 32.603519009053784, -14.620917029233933, -21.218275887229485, 3.0429531476085216, 0.9269199890084362, 23.480753901141796, 24.930649074323448, -22.68207142471087, 5.512152226330815, -13.31507450682323, 4.4945965743742065, 14.685740373654308, -7.381839648715324, -16.427112334691124, -19.80359128529046, 0.753585982253206, 31.696783443352864, 2.906743554533353, 10.751259193363886, 63.510643598553486, 14.444858887756238, 2.873037905979402, -12.704879842428785, -19.480501866695203, -7.5849430114454925, 13.654785208949868, -3.5267247640319326, -41.301308172770426, -48.664413602372534, 15.219671374640226, -3.37110471763782, -2.955279664011221, -9.291402242240718, -34.27723963839111, -12.582835586490276, 29.098290502125128, 56.67187829265197, 51.82405183787204, 16.722355210905, 24.753898889824782, 29.982769517891434, 18.928063374701793, -42.484911767423576, -6.37785400777131, 31.522097151305804, -33.62325173682903, -8.715380787360484, 11.650984980033193, 32.94881251978311, 5.005524681802289, -14.11213805213551, 54.759052872030274, 40.81138617993392, -16.100996116220557, 16.01423654244678, 37.743246674644546, -38.8916958224403, 19.800158131847258, 0.049123530942019045, 79.7828187998524, 34.46303261945734, -20.504123593773066, 39.237274930967764, 0.6043094970734746, 1.5797957395061357, 7.515903802321684, 26.493532973187673, -7.3040914998400375, -1.9658161350804022, 35.28634828320155, -37.918110694705305, -3.244045586385429, -27.301966588322202, -41.507442336472494, -8.759153082788355, 39.37977803755878], "policy_adversary_policy_reward": [13.742256132394745, 12.421323563454132, 11.304194254526394, 17.66988442812324, 16.106411507347485, 2.178904205308715, 11.72258868485605, -9.19045463780396, -6.064241798894145, -19.132754629953432, -0.8505554552495447, -8.018627928877052, 11.386643910121613, -0.6098436568543484, -3.3794559358727128, -12.265432296178346, -33.45313326047342, -7.9718876168592345, 3.3791694731570843, -9.120252721066137, -6.911138493871508, -4.48756502587435, -5.099028947295757, 25.33502164738375, -29.408201668484693, 5.769753863144565, 8.22758515231126, -34.4305548703352, 15.582150601257894, 21.96080027363323, -10.581240748890977, 28.683007824783783, 17.459896668049776, 39.25744968932159, 18.373027877133826, 33.001068779056894, 24.247634192346105, 14.257316545777805, -9.320531394505192, -12.10094124060345, -5.023436026192236, 33.52232508012433, -9.488294798201416, -20.181552962296912, 29.827696733960966, -6.563996578458363, 3.0510575421135115, 0.3373485638248841, 5.7239309247566315, 26.879588084297144, 5.090203167802379, -19.711120197036312, -5.291937565890208, -15.926338321339276, 9.33958675498426, -6.296633607375739, -1.4699416564141305, 2.396861645422567, 16.251530308858083, 7.229223592283713, 22.5935110345399, 2.3371380397835466, -8.597757577975855, -14.08431384673501, 10.511102487648401, -4.998950261317587, -9.833869085664006, -3.481205421159224, 2.3321882570775614, 2.162408317296645, 2.5022634600059455, 12.183476913648363, -9.376836992889892, 1.9949973441745676, 6.593496961890445, -23.02060929658157, -1.1055618269116536, -18.6980294583788, 1.709273348811756, -0.9556873665585499, 33.10060094866233, -1.4038175053094637, 15.699879207038489, -12.79313565250514, 6.402544984812455, 4.348714208551431, 28.02292202444381, 35.48772157410967, 13.064289473433673, 1.380569414322565, -3.4151489435193128, 6.2881868494987145, -16.485089973381825, 3.780210130953037, -8.230339564839348, -11.250162301855855, -2.0738141945752364, -5.511128816870256, -24.560102562350856, 38.214887771300724, 3.8522643318632603, -7.378989095895193, -21.778488660962918, -19.52281951180751, -30.246755955865616, -18.417657646506907, 0.5756546115262466, 14.64401676311398, 1.2719702922924583, -4.643075009930278, -15.215521539278589, 12.260241875267369, -15.710730896475546, 6.419328654234835, -5.663639288606561, -28.613600349784548, -16.17512676852123, 3.592291182030962, 20.676549479993174, 8.421741022131958, 32.10284358858974, 24.56903470406222, 33.66627363925175, 18.157778198620292, 8.874102129271698, 7.8482530816333025, 35.3378011071275, -10.583902217302697, 26.070764704257783, 3.9120048136336543, 20.964178235302324, -2.036114860600538, -35.379678671619494, -7.105233095804081, -4.384603200511412, -1.9932508072598871, 22.015098829587682, 9.506998321718125, -14.215142856557932, -19.408108880271087, -31.278739003550896, 22.563358216190416, 10.436999039404036, 1.2139859406291578, 31.47118307011558, 1.477629449667532, -14.492656742952583, 19.498181424754875, -1.3894281604699543, -12.722709891665552, 35.859572834497385, 18.899480037532904, 34.20375279081344, 6.6076333891204655, -28.400041606417602, 12.299045490197045, 8.073988481689701, 7.940248060757078, 16.09048053003313, 21.652766144611384, -21.324258385565194, -17.567437436875085, 9.139706200682326, 10.66045193116493, -4.706352661367433, 4.755476192309452, 33.80521879976688, 45.97760000008551, 7.287944736023704, 27.175087883433637, -17.83499979502599, -2.669123798747073, 38.74931299962244, 0.4879619313453212, 9.33387876475226, -8.729569267678785, 1.0478490031537082, 0.5319467363524275, 9.560632030991705, -2.0447282286700244, 3.2837259451382756, 23.209807028049397, -7.9058499982023775, 0.601758498362333, -29.865494658208945, 27.899678523128543, 22.040442711709957, 13.245905571491583, -15.682689255505238, -22.235421439200064, -10.246741320861627, 7.002695734476198, -15.116531161566272, -12.18543542675593, -29.825210954514944, -11.682231381957582, -17.522406864996572, 8.763253782208217, 33.44055866385467, 5.939219373704108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3857836223252671, "mean_inference_ms": 0.9596996892963897, "mean_action_processing_ms": 0.16355280964302804, "mean_env_wait_ms": 0.056313323064442214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042574405670166016, "StateBufferConnector_ms": 0.002499818801879883, "ViewRequirementAgentConnector_ms": 0.06571102142333984}, "num_episodes": 23, "episode_return_max": 159.56563759970481, "episode_return_min": -97.32882720474518, "episode_return_mean": 10.865365609728178}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 510.54792678428606, "num_env_steps_trained_throughput_per_sec": 510.54792678428606, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 7906.892, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7906.858, "sample_time_ms": 740.596, "learn_time_ms": 7155.046, "learn_throughput": 559.046, "synch_weights_time_ms": 10.648}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 92, "trial_id": "eaa30_00000", "date": "2024-08-09_17-52-48", "timestamp": 1723240368, "time_this_iter_s": 7.839456081390381, "time_total_s": 752.4704501628876, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc921f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 752.4704501628876, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 21.98181818181818, "ram_util_percent": 79.62727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.518538097603611, "cur_kl_coeff": 0.22806973457336432, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.157992515866718, "policy_loss": -0.004133894352523226, "vf_loss": 4.160389160100745, "vf_explained_var": 0.2029403497302343, "kl": 0.0076170996507807145, "entropy": 0.7460538141626529, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.544922039844096, "cur_kl_coeff": 0.1300395095709121, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.778269850214323, "policy_loss": -0.0007443747395882383, "vf_loss": 6.773931888242562, "vf_explained_var": 0.22955568004399537, "kl": 0.03908287638187176, "entropy": 0.8163536367937922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "env_runners": {"episode_reward_max": 159.56563759970481, "episode_reward_min": -98.9611392705877, "episode_reward_mean": 7.540182954298362, "episode_len_mean": 172.64, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 17264, "policy_reward_min": {"agent_policy": -49.48056963529387, "adversary_policy": -35.379678671619494}, "policy_reward_max": {"agent_policy": 79.7828187998524, "adversary_policy": 45.97760000008551}, "policy_reward_mean": {"agent_policy": 3.7700914771491822, "adversary_policy": 1.8850457385745911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.20703801810757, -29.241834058467873, -42.43655177445897, 6.085906295217043, 1.8538399780168726, 46.96150780228356, 49.861298148646924, -45.364142849421654, 11.024304452661628, -26.63014901364646, 8.98919314874841, 29.371480747308635, -14.76367929743067, -32.85422466938221, -39.607182570580946, 1.507171964506412, 63.3935668867058, 5.81348710906671, 21.502518386727772, 127.02128719710689, 28.889717775512487, 5.746075811958804, -25.40975968485757, -38.96100373339041, -15.169886022890985, 27.30957041789972, -7.053449528063837, -82.60261634554095, -97.32882720474518, 30.43934274928045, -6.742209435275626, -5.910559328022441, -18.582804484481382, -68.55447927678216, -25.165671172980538, 58.19658100425025, 113.34375658530388, 103.64810367574407, 33.44471042181, 49.507797779649565, 59.96553903578288, 37.85612674940357, -84.96982353484708, -12.755708015542602, 63.04419430261166, -67.2465034736581, -17.43076157472096, 23.301969960066387, 65.89762503956624, 10.011049363604577, -28.224276104270885, 109.51810574406065, 81.62277235986775, -32.20199223244114, 32.028473084893555, 75.48649334928903, -77.78339164488068, 39.60031626369451, 0.0982470618840523, 159.56563759970481, 68.92606523891467, -41.00824718754615, 78.47454986193551, 1.2086189941469492, 3.1595914790122714, 15.031807604643404, 52.98706594637534, -14.608182999680068, -3.9316322701608186, 70.57269656640311, -75.8362213894107, -6.488091172770858, -54.603933176644375, -83.01488467294499, -17.51830616557674, 78.75955607511757, -15.326733703898476, -11.868028655117168, 54.011913195750836, 78.09178586101729, 6.935047863093693, -98.9611392705877, 54.18669752086326, -24.169910820638115, -56.49982638218127, -55.89275745245375, 25.986752749764705, -68.39025371490501, -17.990115117482404, -8.397693816879666, -98.34465963142529, -30.740934027727505, 44.022316036477605, 95.3296651999791, -26.54815063234485, 8.811751911325686, 94.0351830295945, -94.60670123578686, -27.631681367084553, 151.74199591850623], "episode_lengths": [200, 200, 200, 200, 3, 200, 180, 200, 10, 200, 200, 200, 200, 200, 200, 200, 165, 200, 8, 169, 200, 200, 200, 200, 200, 48, 200, 200, 200, 23, 200, 16, 200, 200, 200, 197, 200, 83, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 175, 200, 83, 200, 200, 14, 200, 200, 200, 200, 51, 97, 200, 119, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 52, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 80, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [32.603519009053784, -14.620917029233933, -21.218275887229485, 3.0429531476085216, 0.9269199890084362, 23.480753901141796, 24.930649074323448, -22.68207142471087, 5.512152226330815, -13.31507450682323, 4.4945965743742065, 14.685740373654308, -7.381839648715324, -16.427112334691124, -19.80359128529046, 0.753585982253206, 31.696783443352864, 2.906743554533353, 10.751259193363886, 63.510643598553486, 14.444858887756238, 2.873037905979402, -12.704879842428785, -19.480501866695203, -7.5849430114454925, 13.654785208949868, -3.5267247640319326, -41.301308172770426, -48.664413602372534, 15.219671374640226, -3.37110471763782, -2.955279664011221, -9.291402242240718, -34.27723963839111, -12.582835586490276, 29.098290502125128, 56.67187829265197, 51.82405183787204, 16.722355210905, 24.753898889824782, 29.982769517891434, 18.928063374701793, -42.484911767423576, -6.37785400777131, 31.522097151305804, -33.62325173682903, -8.715380787360484, 11.650984980033193, 32.94881251978311, 5.005524681802289, -14.11213805213551, 54.759052872030274, 40.81138617993392, -16.100996116220557, 16.01423654244678, 37.743246674644546, -38.8916958224403, 19.800158131847258, 0.049123530942019045, 79.7828187998524, 34.46303261945734, -20.504123593773066, 39.237274930967764, 0.6043094970734746, 1.5797957395061357, 7.515903802321684, 26.493532973187673, -7.3040914998400375, -1.9658161350804022, 35.28634828320155, -37.918110694705305, -3.244045586385429, -27.301966588322202, -41.507442336472494, -8.759153082788355, 39.37977803755878, -7.663366851949213, -5.934014327558572, 27.00595659787542, 39.04589293050865, 3.467523931546846, -49.48056963529387, 27.093348760431624, -12.084955410319072, -28.249913191090677, -27.94637872622686, 12.993376374882349, -34.195126857452514, -8.995057558741234, -4.198846908439833, -49.1723298157126, -15.370467013863749, 22.011158018238792, 47.664832599989545, -13.27407531617241, 4.40587595566285, 47.01759151479726, -47.30335061789341, -13.815840683542223, 75.87099795925313], "policy_adversary_policy_reward": [5.7239309247566315, 26.879588084297144, 5.090203167802379, -19.711120197036312, -5.291937565890208, -15.926338321339276, 9.33958675498426, -6.296633607375739, -1.4699416564141305, 2.396861645422567, 16.251530308858083, 7.229223592283713, 22.5935110345399, 2.3371380397835466, -8.597757577975855, -14.08431384673501, 10.511102487648401, -4.998950261317587, -9.833869085664006, -3.481205421159224, 2.3321882570775614, 2.162408317296645, 2.5022634600059455, 12.183476913648363, -9.376836992889892, 1.9949973441745676, 6.593496961890445, -23.02060929658157, -1.1055618269116536, -18.6980294583788, 1.709273348811756, -0.9556873665585499, 33.10060094866233, -1.4038175053094637, 15.699879207038489, -12.79313565250514, 6.402544984812455, 4.348714208551431, 28.02292202444381, 35.48772157410967, 13.064289473433673, 1.380569414322565, -3.4151489435193128, 6.2881868494987145, -16.485089973381825, 3.780210130953037, -8.230339564839348, -11.250162301855855, -2.0738141945752364, -5.511128816870256, -24.560102562350856, 38.214887771300724, 3.8522643318632603, -7.378989095895193, -21.778488660962918, -19.52281951180751, -30.246755955865616, -18.417657646506907, 0.5756546115262466, 14.64401676311398, 1.2719702922924583, -4.643075009930278, -15.215521539278589, 12.260241875267369, -15.710730896475546, 6.419328654234835, -5.663639288606561, -28.613600349784548, -16.17512676852123, 3.592291182030962, 20.676549479993174, 8.421741022131958, 32.10284358858974, 24.56903470406222, 33.66627363925175, 18.157778198620292, 8.874102129271698, 7.8482530816333025, 35.3378011071275, -10.583902217302697, 26.070764704257783, 3.9120048136336543, 20.964178235302324, -2.036114860600538, -35.379678671619494, -7.105233095804081, -4.384603200511412, -1.9932508072598871, 22.015098829587682, 9.506998321718125, -14.215142856557932, -19.408108880271087, -31.278739003550896, 22.563358216190416, 10.436999039404036, 1.2139859406291578, 31.47118307011558, 1.477629449667532, -14.492656742952583, 19.498181424754875, -1.3894281604699543, -12.722709891665552, 35.859572834497385, 18.899480037532904, 34.20375279081344, 6.6076333891204655, -28.400041606417602, 12.299045490197045, 8.073988481689701, 7.940248060757078, 16.09048053003313, 21.652766144611384, -21.324258385565194, -17.567437436875085, 9.139706200682326, 10.66045193116493, -4.706352661367433, 4.755476192309452, 33.80521879976688, 45.97760000008551, 7.287944736023704, 27.175087883433637, -17.83499979502599, -2.669123798747073, 38.74931299962244, 0.4879619313453212, 9.33387876475226, -8.729569267678785, 1.0478490031537082, 0.5319467363524275, 9.560632030991705, -2.0447282286700244, 3.2837259451382756, 23.209807028049397, -7.9058499982023775, 0.601758498362333, -29.865494658208945, 27.899678523128543, 22.040442711709957, 13.245905571491583, -15.682689255505238, -22.235421439200064, -10.246741320861627, 7.002695734476198, -15.116531161566272, -12.18543542675593, -29.825210954514944, -11.682231381957582, -17.522406864996572, 8.763253782208217, 33.44055866385467, 5.939219373704108, -6.245016733838995, -1.4183501181102223, -2.0973424042320588, -3.8366719233265165, 6.619349527576272, 20.38660707029915, 34.890684771595026, 4.155208158913636, 30.266814866690982, -26.799290935144143, -28.17435173938705, -21.306217895906812, 16.1050332776834, 10.988315482748224, 5.553476974187806, -17.638432384506878, -15.457329667590905, -12.792583523499772, -14.715602839960539, -13.230775886266315, 2.0805564917125743, 10.912819883169783, -11.022844725495002, -23.172282131957516, -1.7824623984313988, -7.212595160309817, -3.2538115030856787, -0.9450354053541545, -22.01429071352463, -27.158039102187963, -32.216741823011596, 16.84627480914785, 18.17066563387, 3.8404923843687833, 42.15852772700449, 5.5063048729850665, -0.6413823770143523, -12.632692939158058, -1.433739923721717, 5.839615879384567, 13.82848934238449, 33.189102172412774, -25.179314906666498, -22.1240357112269, 5.029033727002023, -18.84487441054425, 36.483038710019116, 39.38795924923399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38583013983338676, "mean_inference_ms": 0.9595732321930803, "mean_action_processing_ms": 0.16357318242264815, "mean_env_wait_ms": 0.05637246492038873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004204273223876953, "StateBufferConnector_ms": 0.002476811408996582, "ViewRequirementAgentConnector_ms": 0.06565618515014648}, "num_episodes": 24, "episode_return_max": 159.56563759970481, "episode_return_min": -98.9611392705877, "episode_return_mean": 7.540182954298362}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 507.81268397265495, "num_env_steps_trained_throughput_per_sec": 507.81268397265495, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 7911.475, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7911.44, "sample_time_ms": 736.182, "learn_time_ms": 7164.089, "learn_throughput": 558.34, "synch_weights_time_ms": 10.601}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "training_iteration": 93, "trial_id": "eaa30_00000", "date": "2024-08-09_17-52-56", "timestamp": 1723240376, "time_this_iter_s": 7.881759881973267, "time_total_s": 760.3522100448608, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17809e8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 760.3522100448608, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 21.92727272727273, "ram_util_percent": 79.64545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.880187389774928, "cur_kl_coeff": 0.22806973457336432, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.906269151950009, "policy_loss": -0.0008742947712855995, "vf_loss": 5.904861939899505, "vf_explained_var": 0.08730814258257548, "kl": 0.010003482808344184, "entropy": 0.8108944431814568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.969513909891248, "cur_kl_coeff": 0.19505926435636806, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.499030169844628, "policy_loss": 0.08627208305357878, "vf_loss": 6.375273024539153, "vf_explained_var": 0.3653750567386548, "kl": 0.19217269637156278, "entropy": 1.2374765793482463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "env_runners": {"episode_reward_max": 159.56563759970481, "episode_reward_min": -156.67113104980183, "episode_reward_mean": -2.0404616627346552, "episode_len_mean": 170.02, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 17002, "policy_reward_min": {"agent_policy": -78.33556552490086, "adversary_policy": -47.78018737619894}, "policy_reward_max": {"agent_policy": 79.7828187998524, "adversary_policy": 45.97760000008551}, "policy_reward_mean": {"agent_policy": -1.0202308313673272, "adversary_policy": -0.5101154156836639}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.169886022890985, 27.30957041789972, -7.053449528063837, -82.60261634554095, -97.32882720474518, 30.43934274928045, -6.742209435275626, -5.910559328022441, -18.582804484481382, -68.55447927678216, -25.165671172980538, 58.19658100425025, 113.34375658530388, 103.64810367574407, 33.44471042181, 49.507797779649565, 59.96553903578288, 37.85612674940357, -84.96982353484708, -12.755708015542602, 63.04419430261166, -67.2465034736581, -17.43076157472096, 23.301969960066387, 65.89762503956624, 10.011049363604577, -28.224276104270885, 109.51810574406065, 81.62277235986775, -32.20199223244114, 32.028473084893555, 75.48649334928903, -77.78339164488068, 39.60031626369451, 0.0982470618840523, 159.56563759970481, 68.92606523891467, -41.00824718754615, 78.47454986193551, 1.2086189941469492, 3.1595914790122714, 15.031807604643404, 52.98706594637534, -14.608182999680068, -3.9316322701608186, 70.57269656640311, -75.8362213894107, -6.488091172770858, -54.603933176644375, -83.01488467294499, -17.51830616557674, 78.75955607511757, -15.326733703898476, -11.868028655117168, 54.011913195750836, 78.09178586101729, 6.935047863093693, -98.9611392705877, 54.18669752086326, -24.169910820638115, -56.49982638218127, -55.89275745245375, 25.986752749764705, -68.39025371490501, -17.990115117482404, -8.397693816879666, -98.34465963142529, -30.740934027727505, 44.022316036477605, 95.3296651999791, -26.54815063234485, 8.811751911325686, 94.0351830295945, -94.60670123578686, -27.631681367084553, 151.74199591850623, 6.151861345410481, -109.21926469220054, 8.199894944401969, -134.05261337262692, -156.67113104980183, -120.20474560630657, 15.567311519103438, -56.16744504234795, -131.98158828363933, 149.51842183079893, 11.777384064134527, 4.212725897797069, -50.49827799844901, 15.406436103176784, -105.79126465396587, 21.488737768078103, -28.774398532083907, -110.5409666934516, -82.91681564018197, -43.342257434488346, -103.34459875227648, 34.42082675606735, 92.10320971276985, 94.55396217771886], "episode_lengths": [200, 48, 200, 200, 200, 23, 200, 16, 200, 200, 200, 197, 200, 83, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 175, 200, 83, 200, 200, 14, 200, 200, 200, 200, 51, 97, 200, 119, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 52, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 80, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 6, 11, 200, 19, 200, 200, 200, 200, 200, 200, 200, 33, 200, 200], "policy_agent_policy_reward": [-7.5849430114454925, 13.654785208949868, -3.5267247640319326, -41.301308172770426, -48.664413602372534, 15.219671374640226, -3.37110471763782, -2.955279664011221, -9.291402242240718, -34.27723963839111, -12.582835586490276, 29.098290502125128, 56.67187829265197, 51.82405183787204, 16.722355210905, 24.753898889824782, 29.982769517891434, 18.928063374701793, -42.484911767423576, -6.37785400777131, 31.522097151305804, -33.62325173682903, -8.715380787360484, 11.650984980033193, 32.94881251978311, 5.005524681802289, -14.11213805213551, 54.759052872030274, 40.81138617993392, -16.100996116220557, 16.01423654244678, 37.743246674644546, -38.8916958224403, 19.800158131847258, 0.049123530942019045, 79.7828187998524, 34.46303261945734, -20.504123593773066, 39.237274930967764, 0.6043094970734746, 1.5797957395061357, 7.515903802321684, 26.493532973187673, -7.3040914998400375, -1.9658161350804022, 35.28634828320155, -37.918110694705305, -3.244045586385429, -27.301966588322202, -41.507442336472494, -8.759153082788355, 39.37977803755878, -7.663366851949213, -5.934014327558572, 27.00595659787542, 39.04589293050865, 3.467523931546846, -49.48056963529387, 27.093348760431624, -12.084955410319072, -28.249913191090677, -27.94637872622686, 12.993376374882349, -34.195126857452514, -8.995057558741234, -4.198846908439833, -49.1723298157126, -15.370467013863749, 22.011158018238792, 47.664832599989545, -13.27407531617241, 4.40587595566285, 47.01759151479726, -47.30335061789341, -13.815840683542223, 75.87099795925313, 3.0759306727052227, -54.60963234610026, 4.09994747220099, -67.02630668631349, -78.33556552490086, -60.102372803153315, 7.783655759551719, -28.08372252117398, -65.99079414181969, 74.75921091539944, 5.888692032067263, 2.1063629488985347, -25.249138999224492, 7.7032180515883955, -52.895632326982934, 10.744368884039044, -14.387199266041954, -55.270483346725804, -41.458407820090954, -21.671128717244173, -51.67229937613823, 17.21041337803367, 46.05160485638491, 47.27698108885939], "policy_adversary_policy_reward": [-2.0738141945752364, -5.511128816870256, -24.560102562350856, 38.214887771300724, 3.8522643318632603, -7.378989095895193, -21.778488660962918, -19.52281951180751, -30.246755955865616, -18.417657646506907, 0.5756546115262466, 14.64401676311398, 1.2719702922924583, -4.643075009930278, -15.215521539278589, 12.260241875267369, -15.710730896475546, 6.419328654234835, -5.663639288606561, -28.613600349784548, -16.17512676852123, 3.592291182030962, 20.676549479993174, 8.421741022131958, 32.10284358858974, 24.56903470406222, 33.66627363925175, 18.157778198620292, 8.874102129271698, 7.8482530816333025, 35.3378011071275, -10.583902217302697, 26.070764704257783, 3.9120048136336543, 20.964178235302324, -2.036114860600538, -35.379678671619494, -7.105233095804081, -4.384603200511412, -1.9932508072598871, 22.015098829587682, 9.506998321718125, -14.215142856557932, -19.408108880271087, -31.278739003550896, 22.563358216190416, 10.436999039404036, 1.2139859406291578, 31.47118307011558, 1.477629449667532, -14.492656742952583, 19.498181424754875, -1.3894281604699543, -12.722709891665552, 35.859572834497385, 18.899480037532904, 34.20375279081344, 6.6076333891204655, -28.400041606417602, 12.299045490197045, 8.073988481689701, 7.940248060757078, 16.09048053003313, 21.652766144611384, -21.324258385565194, -17.567437436875085, 9.139706200682326, 10.66045193116493, -4.706352661367433, 4.755476192309452, 33.80521879976688, 45.97760000008551, 7.287944736023704, 27.175087883433637, -17.83499979502599, -2.669123798747073, 38.74931299962244, 0.4879619313453212, 9.33387876475226, -8.729569267678785, 1.0478490031537082, 0.5319467363524275, 9.560632030991705, -2.0447282286700244, 3.2837259451382756, 23.209807028049397, -7.9058499982023775, 0.601758498362333, -29.865494658208945, 27.899678523128543, 22.040442711709957, 13.245905571491583, -15.682689255505238, -22.235421439200064, -10.246741320861627, 7.002695734476198, -15.116531161566272, -12.18543542675593, -29.825210954514944, -11.682231381957582, -17.522406864996572, 8.763253782208217, 33.44055866385467, 5.939219373704108, -6.245016733838995, -1.4183501181102223, -2.0973424042320588, -3.8366719233265165, 6.619349527576272, 20.38660707029915, 34.890684771595026, 4.155208158913636, 30.266814866690982, -26.799290935144143, -28.17435173938705, -21.306217895906812, 16.1050332776834, 10.988315482748224, 5.553476974187806, -17.638432384506878, -15.457329667590905, -12.792583523499772, -14.715602839960539, -13.230775886266315, 2.0805564917125743, 10.912819883169783, -11.022844725495002, -23.172282131957516, -1.7824623984313988, -7.212595160309817, -3.2538115030856787, -0.9450354053541545, -22.01429071352463, -27.158039102187963, -32.216741823011596, 16.84627480914785, 18.17066563387, 3.8404923843687833, 42.15852772700449, 5.5063048729850665, -0.6413823770143523, -12.632692939158058, -1.433739923721717, 5.839615879384567, 13.82848934238449, 33.189102172412774, -25.179314906666498, -22.1240357112269, 5.029033727002023, -18.84487441054425, 36.483038710019116, 39.38795924923399, -2.186348384620537, 5.26227905732576, -6.829444969901324, -47.78018737619894, -1.0556734895747013, 5.155620961775686, -33.06832769098398, -33.95797899532948, -33.507150126025614, -44.82841539887527, -32.93888386924893, -27.163488933904446, 4.6946462278523855, 3.0890095316993325, -1.2606139829348137, -26.823108538239158, -40.12296855070036, -25.86782559111935, 39.76054751824638, 34.99866339715307, 7.279211451366782, -1.390519419299519, 11.012735641488451, -8.906372692589917, -17.564093229318708, -7.685045769905795, 0.038110871013897096, 7.665107180574498, -26.76508177554705, -26.130550551435885, 13.072014714353896, -2.32764583031485, -6.590330589369351, -7.796868676672602, -27.54844199818354, -27.722041348542263, -2.2548562911187204, -39.203551528972234, -4.694858746188025, -16.976269971056148, -20.95504114520804, -30.717258230930188, 23.006613805697807, -5.796200427664132, 27.090007664734106, 18.96159719165081, 19.348259049785558, 27.928722039073843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3856171871417582, "mean_inference_ms": 0.9590745918937515, "mean_action_processing_ms": 0.16357606283535892, "mean_env_wait_ms": 0.056359295745986776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004150390625, "StateBufferConnector_ms": 0.0024445056915283203, "ViewRequirementAgentConnector_ms": 0.06426799297332764}, "num_episodes": 24, "episode_return_max": 159.56563759970481, "episode_return_min": -156.67113104980183, "episode_return_mean": -2.0404616627346552}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 507.96109849828383, "num_env_steps_trained_throughput_per_sec": 507.96109849828383, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 7912.361, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7912.327, "sample_time_ms": 735.966, "learn_time_ms": 7165.014, "learn_throughput": 558.268, "synch_weights_time_ms": 10.781}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "training_iteration": 94, "trial_id": "eaa30_00000", "date": "2024-08-09_17-53-04", "timestamp": 1723240384, "time_this_iter_s": 7.879339933395386, "time_total_s": 768.2315499782562, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17809eca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 768.2315499782562, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 22.066666666666674, "ram_util_percent": 79.50833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.995786465980388, "cur_kl_coeff": 0.22806973457336432, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.469001777966818, "policy_loss": 0.0001369832650260635, "vf_loss": 4.467125636559945, "vf_explained_var": 0.07875864045329825, "kl": 0.007625535298286686, "entropy": 0.8444140522252945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.836276006077727, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.63743742108345, "policy_loss": 0.011023412504194615, "vf_loss": 6.610638214151065, "vf_explained_var": 0.24598121996968986, "kl": 0.05391801360140865, "entropy": 1.3122580456236999, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "env_runners": {"episode_reward_max": 159.56563759970481, "episode_reward_min": -156.67113104980183, "episode_reward_mean": -12.76328900313249, "episode_len_mean": 176.25, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 17625, "policy_reward_min": {"agent_policy": -78.33556552490086, "adversary_policy": -57.38261178111852}, "policy_reward_max": {"agent_policy": 79.7828187998524, "adversary_policy": 45.97760000008551}, "policy_reward_mean": {"agent_policy": -6.381644501566244, "adversary_policy": -3.1908222507831225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.04419430261166, -67.2465034736581, -17.43076157472096, 23.301969960066387, 65.89762503956624, 10.011049363604577, -28.224276104270885, 109.51810574406065, 81.62277235986775, -32.20199223244114, 32.028473084893555, 75.48649334928903, -77.78339164488068, 39.60031626369451, 0.0982470618840523, 159.56563759970481, 68.92606523891467, -41.00824718754615, 78.47454986193551, 1.2086189941469492, 3.1595914790122714, 15.031807604643404, 52.98706594637534, -14.608182999680068, -3.9316322701608186, 70.57269656640311, -75.8362213894107, -6.488091172770858, -54.603933176644375, -83.01488467294499, -17.51830616557674, 78.75955607511757, -15.326733703898476, -11.868028655117168, 54.011913195750836, 78.09178586101729, 6.935047863093693, -98.9611392705877, 54.18669752086326, -24.169910820638115, -56.49982638218127, -55.89275745245375, 25.986752749764705, -68.39025371490501, -17.990115117482404, -8.397693816879666, -98.34465963142529, -30.740934027727505, 44.022316036477605, 95.3296651999791, -26.54815063234485, 8.811751911325686, 94.0351830295945, -94.60670123578686, -27.631681367084553, 151.74199591850623, 6.151861345410481, -109.21926469220054, 8.199894944401969, -134.05261337262692, -156.67113104980183, -120.20474560630657, 15.567311519103438, -56.16744504234795, -131.98158828363933, 149.51842183079893, 11.777384064134527, 4.212725897797069, -50.49827799844901, 15.406436103176784, -105.79126465396587, 21.488737768078103, -28.774398532083907, -110.5409666934516, -82.91681564018197, -43.342257434488346, -103.34459875227648, 34.42082675606735, 92.10320971276985, 94.55396217771886, -107.08946281377558, -119.77555854697238, 17.370458088808448, -30.688004711915738, -137.73450847725138, -106.82989522866185, -5.8936846116156545, -58.89645049379885, 138.35068217470047, -124.41349437805985, -73.76961270197964, -21.767929848702366, 50.364068188556715, -107.58243444754955, -105.13395921091563, -55.066119043605944, -66.91347310086562, -78.27567155244733, 113.1342136152303, -102.7964028690105], "episode_lengths": [34, 200, 200, 200, 200, 175, 200, 83, 200, 200, 14, 200, 200, 200, 200, 51, 97, 200, 119, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 52, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 80, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 6, 11, 200, 19, 200, 200, 200, 200, 200, 200, 200, 33, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 190, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [31.522097151305804, -33.62325173682903, -8.715380787360484, 11.650984980033193, 32.94881251978311, 5.005524681802289, -14.11213805213551, 54.759052872030274, 40.81138617993392, -16.100996116220557, 16.01423654244678, 37.743246674644546, -38.8916958224403, 19.800158131847258, 0.049123530942019045, 79.7828187998524, 34.46303261945734, -20.504123593773066, 39.237274930967764, 0.6043094970734746, 1.5797957395061357, 7.515903802321684, 26.493532973187673, -7.3040914998400375, -1.9658161350804022, 35.28634828320155, -37.918110694705305, -3.244045586385429, -27.301966588322202, -41.507442336472494, -8.759153082788355, 39.37977803755878, -7.663366851949213, -5.934014327558572, 27.00595659787542, 39.04589293050865, 3.467523931546846, -49.48056963529387, 27.093348760431624, -12.084955410319072, -28.249913191090677, -27.94637872622686, 12.993376374882349, -34.195126857452514, -8.995057558741234, -4.198846908439833, -49.1723298157126, -15.370467013863749, 22.011158018238792, 47.664832599989545, -13.27407531617241, 4.40587595566285, 47.01759151479726, -47.30335061789341, -13.815840683542223, 75.87099795925313, 3.0759306727052227, -54.60963234610026, 4.09994747220099, -67.02630668631349, -78.33556552490086, -60.102372803153315, 7.783655759551719, -28.08372252117398, -65.99079414181969, 74.75921091539944, 5.888692032067263, 2.1063629488985347, -25.249138999224492, 7.7032180515883955, -52.895632326982934, 10.744368884039044, -14.387199266041954, -55.270483346725804, -41.458407820090954, -21.671128717244173, -51.67229937613823, 17.21041337803367, 46.05160485638491, 47.27698108885939, -53.544731406887855, -59.88777927348613, 8.685229044404217, -15.344002355957933, -68.86725423862566, -53.41494761433089, -2.9468423058078272, -29.44822524689939, 69.17534108735028, -62.20674718902993, -36.8848063509898, -10.883964924351204, 25.182034094278364, -53.791217223774666, -52.56697960545788, -27.533059521802997, -33.456736550432794, -39.137835776223696, 56.56710680761512, -51.398201434505204], "policy_adversary_policy_reward": [22.015098829587682, 9.506998321718125, -14.215142856557932, -19.408108880271087, -31.278739003550896, 22.563358216190416, 10.436999039404036, 1.2139859406291578, 31.47118307011558, 1.477629449667532, -14.492656742952583, 19.498181424754875, -1.3894281604699543, -12.722709891665552, 35.859572834497385, 18.899480037532904, 34.20375279081344, 6.6076333891204655, -28.400041606417602, 12.299045490197045, 8.073988481689701, 7.940248060757078, 16.09048053003313, 21.652766144611384, -21.324258385565194, -17.567437436875085, 9.139706200682326, 10.66045193116493, -4.706352661367433, 4.755476192309452, 33.80521879976688, 45.97760000008551, 7.287944736023704, 27.175087883433637, -17.83499979502599, -2.669123798747073, 38.74931299962244, 0.4879619313453212, 9.33387876475226, -8.729569267678785, 1.0478490031537082, 0.5319467363524275, 9.560632030991705, -2.0447282286700244, 3.2837259451382756, 23.209807028049397, -7.9058499982023775, 0.601758498362333, -29.865494658208945, 27.899678523128543, 22.040442711709957, 13.245905571491583, -15.682689255505238, -22.235421439200064, -10.246741320861627, 7.002695734476198, -15.116531161566272, -12.18543542675593, -29.825210954514944, -11.682231381957582, -17.522406864996572, 8.763253782208217, 33.44055866385467, 5.939219373704108, -6.245016733838995, -1.4183501181102223, -2.0973424042320588, -3.8366719233265165, 6.619349527576272, 20.38660707029915, 34.890684771595026, 4.155208158913636, 30.266814866690982, -26.799290935144143, -28.17435173938705, -21.306217895906812, 16.1050332776834, 10.988315482748224, 5.553476974187806, -17.638432384506878, -15.457329667590905, -12.792583523499772, -14.715602839960539, -13.230775886266315, 2.0805564917125743, 10.912819883169783, -11.022844725495002, -23.172282131957516, -1.7824623984313988, -7.212595160309817, -3.2538115030856787, -0.9450354053541545, -22.01429071352463, -27.158039102187963, -32.216741823011596, 16.84627480914785, 18.17066563387, 3.8404923843687833, 42.15852772700449, 5.5063048729850665, -0.6413823770143523, -12.632692939158058, -1.433739923721717, 5.839615879384567, 13.82848934238449, 33.189102172412774, -25.179314906666498, -22.1240357112269, 5.029033727002023, -18.84487441054425, 36.483038710019116, 39.38795924923399, -2.186348384620537, 5.26227905732576, -6.829444969901324, -47.78018737619894, -1.0556734895747013, 5.155620961775686, -33.06832769098398, -33.95797899532948, -33.507150126025614, -44.82841539887527, -32.93888386924893, -27.163488933904446, 4.6946462278523855, 3.0890095316993325, -1.2606139829348137, -26.823108538239158, -40.12296855070036, -25.86782559111935, 39.76054751824638, 34.99866339715307, 7.279211451366782, -1.390519419299519, 11.012735641488451, -8.906372692589917, -17.564093229318708, -7.685045769905795, 0.038110871013897096, 7.665107180574498, -26.76508177554705, -26.130550551435885, 13.072014714353896, -2.32764583031485, -6.590330589369351, -7.796868676672602, -27.54844199818354, -27.722041348542263, -2.2548562911187204, -39.203551528972234, -4.694858746188025, -16.976269971056148, -20.95504114520804, -30.717258230930188, 23.006613805697807, -5.796200427664132, 27.090007664734106, 18.96159719165081, 19.348259049785558, 27.928722039073843, -21.71460945372919, -31.830121953158663, -34.12612920014514, -25.761650073341034, -10.144123961387114, 18.82935300579134, -5.41378241379363, -9.930219942164307, -45.766207995879036, -23.101046242746612, -28.900367003927293, -24.51458061040359, 13.694352507644954, -16.64119481345278, -11.312929259035378, -18.13529598786401, 45.34897885184123, 23.826362235509034, -57.38261178111852, -4.824135407911413, -9.04003778487035, -27.84476856611945, 1.9653497854048076, -12.849314709755994, 16.593210209870094, 8.588823884408262, -32.74992264022329, -21.04129458355142, -10.802193533979228, -41.76478607147865, -25.45195957913767, -2.0810999426653254, -15.830462328056463, -17.62627422237633, -8.693145003205807, -30.444690773017886, 36.97872444274475, 19.588382364870395, -32.184292792908835, -19.213908641596372]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3854422051382011, "mean_inference_ms": 0.9585731976077124, "mean_action_processing_ms": 0.163440847598574, "mean_env_wait_ms": 0.05629145025575864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030492544174194336, "StateBufferConnector_ms": 0.0023888349533081055, "ViewRequirementAgentConnector_ms": 0.06170070171356201}, "num_episodes": 20, "episode_return_max": 159.56563759970481, "episode_return_min": -156.67113104980183, "episode_return_mean": -12.76328900313249}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 509.0327806882786, "num_env_steps_trained_throughput_per_sec": 509.0327806882786, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 7914.743, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7914.708, "sample_time_ms": 734.326, "learn_time_ms": 7169.003, "learn_throughput": 557.958, "synch_weights_time_ms": 10.851}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "training_iteration": 95, "trial_id": "eaa30_00000", "date": "2024-08-09_17-53-12", "timestamp": 1723240392, "time_this_iter_s": 7.862524032592773, "time_total_s": 776.094074010849, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17809ed30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 776.094074010849, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 22.372727272727275, "ram_util_percent": 79.53636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.885305230958121, "cur_kl_coeff": 0.22806973457336432, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.347566060288242, "policy_loss": 0.0020007684952505524, "vf_loss": 5.344158282355656, "vf_explained_var": 0.09296058454210795, "kl": 0.006169210252150026, "entropy": 0.8196308002900825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.814045584698518, "cur_kl_coeff": 0.43888334480182833, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.991472535828749, "policy_loss": 0.009976756739100286, "vf_loss": 6.963787093758583, "vf_explained_var": 0.2810735959559679, "kl": 0.04034945010401619, "entropy": 1.2450494445860385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 151.74199591850623, "episode_reward_min": -156.67113104980183, "episode_reward_mean": -31.6266676998188, "episode_len_mean": 182.69, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 18269, "policy_reward_min": {"agent_policy": -78.33556552490086, "adversary_policy": -57.38261178111852}, "policy_reward_max": {"agent_policy": 75.87099795925313, "adversary_policy": 45.34897885184123}, "policy_reward_mean": {"agent_policy": -15.813333849909398, "adversary_policy": -7.9066669249547}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.2086189941469492, 3.1595914790122714, 15.031807604643404, 52.98706594637534, -14.608182999680068, -3.9316322701608186, 70.57269656640311, -75.8362213894107, -6.488091172770858, -54.603933176644375, -83.01488467294499, -17.51830616557674, 78.75955607511757, -15.326733703898476, -11.868028655117168, 54.011913195750836, 78.09178586101729, 6.935047863093693, -98.9611392705877, 54.18669752086326, -24.169910820638115, -56.49982638218127, -55.89275745245375, 25.986752749764705, -68.39025371490501, -17.990115117482404, -8.397693816879666, -98.34465963142529, -30.740934027727505, 44.022316036477605, 95.3296651999791, -26.54815063234485, 8.811751911325686, 94.0351830295945, -94.60670123578686, -27.631681367084553, 151.74199591850623, 6.151861345410481, -109.21926469220054, 8.199894944401969, -134.05261337262692, -156.67113104980183, -120.20474560630657, 15.567311519103438, -56.16744504234795, -131.98158828363933, 149.51842183079893, 11.777384064134527, 4.212725897797069, -50.49827799844901, 15.406436103176784, -105.79126465396587, 21.488737768078103, -28.774398532083907, -110.5409666934516, -82.91681564018197, -43.342257434488346, -103.34459875227648, 34.42082675606735, 92.10320971276985, 94.55396217771886, -107.08946281377558, -119.77555854697238, 17.370458088808448, -30.688004711915738, -137.73450847725138, -106.82989522866185, -5.8936846116156545, -58.89645049379885, 138.35068217470047, -124.41349437805985, -73.76961270197964, -21.767929848702366, 50.364068188556715, -107.58243444754955, -105.13395921091563, -55.066119043605944, -66.91347310086562, -78.27567155244733, 113.1342136152303, -102.7964028690105, -116.04068669496456, 25.136897481836073, -123.20176495191615, 29.405323642069263, -117.89741140316971, -37.37174382085212, -97.50695533689635, -128.4168441751199, -88.9071584911126, 6.64689375677353, -88.81633994632745, -103.52666561435981, -111.33655159186503, -84.17941665065126, -36.3045569941132, -12.2098458565859, -40.60264725017879, -111.31945756256758, -106.20861119605388], "episode_lengths": [200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 52, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 80, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 6, 11, 200, 19, 200, 200, 200, 200, 200, 200, 200, 33, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 190, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 17, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [0.6043094970734746, 1.5797957395061357, 7.515903802321684, 26.493532973187673, -7.3040914998400375, -1.9658161350804022, 35.28634828320155, -37.918110694705305, -3.244045586385429, -27.301966588322202, -41.507442336472494, -8.759153082788355, 39.37977803755878, -7.663366851949213, -5.934014327558572, 27.00595659787542, 39.04589293050865, 3.467523931546846, -49.48056963529387, 27.093348760431624, -12.084955410319072, -28.249913191090677, -27.94637872622686, 12.993376374882349, -34.195126857452514, -8.995057558741234, -4.198846908439833, -49.1723298157126, -15.370467013863749, 22.011158018238792, 47.664832599989545, -13.27407531617241, 4.40587595566285, 47.01759151479726, -47.30335061789341, -13.815840683542223, 75.87099795925313, 3.0759306727052227, -54.60963234610026, 4.09994747220099, -67.02630668631349, -78.33556552490086, -60.102372803153315, 7.783655759551719, -28.08372252117398, -65.99079414181969, 74.75921091539944, 5.888692032067263, 2.1063629488985347, -25.249138999224492, 7.7032180515883955, -52.895632326982934, 10.744368884039044, -14.387199266041954, -55.270483346725804, -41.458407820090954, -21.671128717244173, -51.67229937613823, 17.21041337803367, 46.05160485638491, 47.27698108885939, -53.544731406887855, -59.88777927348613, 8.685229044404217, -15.344002355957933, -68.86725423862566, -53.41494761433089, -2.9468423058078272, -29.44822524689939, 69.17534108735028, -62.20674718902993, -36.8848063509898, -10.883964924351204, 25.182034094278364, -53.791217223774666, -52.56697960545788, -27.533059521802997, -33.456736550432794, -39.137835776223696, 56.56710680761512, -51.398201434505204, -58.02034334748228, 12.568448740918036, -61.6008824759581, 14.702661821034631, -58.94870570158481, -18.68587191042605, -48.75347766844814, -64.20842208755994, -44.453579245556284, 3.323446878386772, -44.408169973163744, -51.76333280717985, -55.66827579593245, -42.08970832532561, -18.1522784970566, -6.10492292829295, -20.301323625089406, -55.65972878128378, -53.10430559802691], "policy_adversary_policy_reward": [9.33387876475226, -8.729569267678785, 1.0478490031537082, 0.5319467363524275, 9.560632030991705, -2.0447282286700244, 3.2837259451382756, 23.209807028049397, -7.9058499982023775, 0.601758498362333, -29.865494658208945, 27.899678523128543, 22.040442711709957, 13.245905571491583, -15.682689255505238, -22.235421439200064, -10.246741320861627, 7.002695734476198, -15.116531161566272, -12.18543542675593, -29.825210954514944, -11.682231381957582, -17.522406864996572, 8.763253782208217, 33.44055866385467, 5.939219373704108, -6.245016733838995, -1.4183501181102223, -2.0973424042320588, -3.8366719233265165, 6.619349527576272, 20.38660707029915, 34.890684771595026, 4.155208158913636, 30.266814866690982, -26.799290935144143, -28.17435173938705, -21.306217895906812, 16.1050332776834, 10.988315482748224, 5.553476974187806, -17.638432384506878, -15.457329667590905, -12.792583523499772, -14.715602839960539, -13.230775886266315, 2.0805564917125743, 10.912819883169783, -11.022844725495002, -23.172282131957516, -1.7824623984313988, -7.212595160309817, -3.2538115030856787, -0.9450354053541545, -22.01429071352463, -27.158039102187963, -32.216741823011596, 16.84627480914785, 18.17066563387, 3.8404923843687833, 42.15852772700449, 5.5063048729850665, -0.6413823770143523, -12.632692939158058, -1.433739923721717, 5.839615879384567, 13.82848934238449, 33.189102172412774, -25.179314906666498, -22.1240357112269, 5.029033727002023, -18.84487441054425, 36.483038710019116, 39.38795924923399, -2.186348384620537, 5.26227905732576, -6.829444969901324, -47.78018737619894, -1.0556734895747013, 5.155620961775686, -33.06832769098398, -33.95797899532948, -33.507150126025614, -44.82841539887527, -32.93888386924893, -27.163488933904446, 4.6946462278523855, 3.0890095316993325, -1.2606139829348137, -26.823108538239158, -40.12296855070036, -25.86782559111935, 39.76054751824638, 34.99866339715307, 7.279211451366782, -1.390519419299519, 11.012735641488451, -8.906372692589917, -17.564093229318708, -7.685045769905795, 0.038110871013897096, 7.665107180574498, -26.76508177554705, -26.130550551435885, 13.072014714353896, -2.32764583031485, -6.590330589369351, -7.796868676672602, -27.54844199818354, -27.722041348542263, -2.2548562911187204, -39.203551528972234, -4.694858746188025, -16.976269971056148, -20.95504114520804, -30.717258230930188, 23.006613805697807, -5.796200427664132, 27.090007664734106, 18.96159719165081, 19.348259049785558, 27.928722039073843, -21.71460945372919, -31.830121953158663, -34.12612920014514, -25.761650073341034, -10.144123961387114, 18.82935300579134, -5.41378241379363, -9.930219942164307, -45.766207995879036, -23.101046242746612, -28.900367003927293, -24.51458061040359, 13.694352507644954, -16.64119481345278, -11.312929259035378, -18.13529598786401, 45.34897885184123, 23.826362235509034, -57.38261178111852, -4.824135407911413, -9.04003778487035, -27.84476856611945, 1.9653497854048076, -12.849314709755994, 16.593210209870094, 8.588823884408262, -32.74992264022329, -21.04129458355142, -10.802193533979228, -41.76478607147865, -25.45195957913767, -2.0810999426653254, -15.830462328056463, -17.62627422237633, -8.693145003205807, -30.444690773017886, 36.97872444274475, 19.588382364870395, -32.184292792908835, -19.213908641596372, -42.233876868536, -15.78646647894628, 5.389405463994031, 7.179043276924006, -28.625975273999277, -32.97490720195881, 13.000532841017296, 1.702128980017335, -35.52276991539267, -23.4259357861921, -20.700891557096295, 2.0150196466702397, -23.117550890854467, -25.635926777593674, -47.73496350124408, -16.473458586315893, -19.15676901597473, -25.296810229581553, 6.9908187055616295, -3.667371827174861, -15.944788771712396, -28.463381201451355, -27.411081322698205, -24.35225148448165, -33.96398941308138, -21.70428638285108, -41.275820084271025, -0.8138882410545776, -6.813167273937033, -11.339111223119566, -5.568703512192023, -0.536219416100927, -10.379809631082125, -9.921513994007277, -23.50677190274903, -32.152956878534766, -30.09761674625666, -23.00668885177025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3852792359413169, "mean_inference_ms": 0.9585055646576588, "mean_action_processing_ms": 0.1633345542856848, "mean_env_wait_ms": 0.056247270709929145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031328201293945312, "StateBufferConnector_ms": 0.002421736717224121, "ViewRequirementAgentConnector_ms": 0.06263494491577148}, "num_episodes": 19, "episode_return_max": 151.74199591850623, "episode_return_min": -156.67113104980183, "episode_return_mean": -31.6266676998188}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 506.1286420837184, "num_env_steps_trained_throughput_per_sec": 506.1286420837184, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 7924.426, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7924.392, "sample_time_ms": 736.243, "learn_time_ms": 7177.005, "learn_throughput": 557.336, "synch_weights_time_ms": 10.616}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 96, "trial_id": "eaa30_00000", "date": "2024-08-09_17-53-20", "timestamp": 1723240400, "time_this_iter_s": 7.907998323440552, "time_total_s": 784.0020723342896, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17809ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 784.0020723342896, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 22.583333333333332, "ram_util_percent": 79.59166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.014145361431061, "cur_kl_coeff": 0.22806973457336432, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.652465175699304, "policy_loss": -0.001386678053273095, "vf_loss": 5.652947155634562, "vf_explained_var": 0.09268585263736664, "kl": 0.00396672161819571, "entropy": 0.8301899385199976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.8408556963006655, "cur_kl_coeff": 0.6583250172027422, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.101787859201432, "policy_loss": 0.006274588046653662, "vf_loss": 7.077436172465483, "vf_explained_var": 0.1980922563622395, "kl": 0.027459226166441416, "entropy": 1.2401175394654274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "env_runners": {"episode_reward_max": 151.74199591850623, "episode_reward_min": -156.67113104980183, "episode_reward_mean": -37.03522491890054, "episode_len_mean": 178.11, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 17811, "policy_reward_min": {"agent_policy": -78.33556552490086, "adversary_policy": -57.38261178111852}, "policy_reward_max": {"agent_policy": 75.87099795925313, "adversary_policy": 45.34897885184123}, "policy_reward_mean": {"agent_policy": -18.517612459450266, "adversary_policy": -9.258806229725133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.990115117482404, -8.397693816879666, -98.34465963142529, -30.740934027727505, 44.022316036477605, 95.3296651999791, -26.54815063234485, 8.811751911325686, 94.0351830295945, -94.60670123578686, -27.631681367084553, 151.74199591850623, 6.151861345410481, -109.21926469220054, 8.199894944401969, -134.05261337262692, -156.67113104980183, -120.20474560630657, 15.567311519103438, -56.16744504234795, -131.98158828363933, 149.51842183079893, 11.777384064134527, 4.212725897797069, -50.49827799844901, 15.406436103176784, -105.79126465396587, 21.488737768078103, -28.774398532083907, -110.5409666934516, -82.91681564018197, -43.342257434488346, -103.34459875227648, 34.42082675606735, 92.10320971276985, 94.55396217771886, -107.08946281377558, -119.77555854697238, 17.370458088808448, -30.688004711915738, -137.73450847725138, -106.82989522866185, -5.8936846116156545, -58.89645049379885, 138.35068217470047, -124.41349437805985, -73.76961270197964, -21.767929848702366, 50.364068188556715, -107.58243444754955, -105.13395921091563, -55.066119043605944, -66.91347310086562, -78.27567155244733, 113.1342136152303, -102.7964028690105, -116.04068669496456, 25.136897481836073, -123.20176495191615, 29.405323642069263, -117.89741140316971, -37.37174382085212, -97.50695533689635, -128.4168441751199, -88.9071584911126, 6.64689375677353, -88.81633994632745, -103.52666561435981, -111.33655159186503, -84.17941665065126, -36.3045569941132, -12.2098458565859, -40.60264725017879, -111.31945756256758, -106.20861119605388, 70.8440855943478, -97.94743117182446, -104.73666716860293, -26.400420981432525, 25.42314040931093, -132.00660941086153, -141.02415647056011, -136.21077312094636, 61.080175672957935, -67.54691187889696, -123.54775611563716, 70.05027199929977, -86.18932251749507, 68.9874152504411, -115.92028375291994, 8.157736790906633, 113.42405435999743, 132.5974878681482, 3.3901299315183477, -107.6595067295338, 87.1117865737778, -24.028545532003562, 56.47747948422453, -119.18755056379118, -102.17191841937964], "episode_lengths": [200, 200, 200, 200, 200, 80, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 6, 11, 200, 19, 200, 200, 200, 200, 200, 200, 200, 33, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 190, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 17, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 200, 65, 200, 200, 18, 200, 200, 200, 200, 59, 200, 15, 200, 200, 200, 58, 200, 200], "policy_agent_policy_reward": [-8.995057558741234, -4.198846908439833, -49.1723298157126, -15.370467013863749, 22.011158018238792, 47.664832599989545, -13.27407531617241, 4.40587595566285, 47.01759151479726, -47.30335061789341, -13.815840683542223, 75.87099795925313, 3.0759306727052227, -54.60963234610026, 4.09994747220099, -67.02630668631349, -78.33556552490086, -60.102372803153315, 7.783655759551719, -28.08372252117398, -65.99079414181969, 74.75921091539944, 5.888692032067263, 2.1063629488985347, -25.249138999224492, 7.7032180515883955, -52.895632326982934, 10.744368884039044, -14.387199266041954, -55.270483346725804, -41.458407820090954, -21.671128717244173, -51.67229937613823, 17.21041337803367, 46.05160485638491, 47.27698108885939, -53.544731406887855, -59.88777927348613, 8.685229044404217, -15.344002355957933, -68.86725423862566, -53.41494761433089, -2.9468423058078272, -29.44822524689939, 69.17534108735028, -62.20674718902993, -36.8848063509898, -10.883964924351204, 25.182034094278364, -53.791217223774666, -52.56697960545788, -27.533059521802997, -33.456736550432794, -39.137835776223696, 56.56710680761512, -51.398201434505204, -58.02034334748228, 12.568448740918036, -61.6008824759581, 14.702661821034631, -58.94870570158481, -18.68587191042605, -48.75347766844814, -64.20842208755994, -44.453579245556284, 3.323446878386772, -44.408169973163744, -51.76333280717985, -55.66827579593245, -42.08970832532561, -18.1522784970566, -6.10492292829295, -20.301323625089406, -55.65972878128378, -53.10430559802691, 35.422042797173916, -48.97371558591228, -52.36833358430145, -13.200210490716291, 12.711570204655464, -66.00330470543072, -70.51207823528017, -68.10538656047322, 30.540087836478968, -33.77345593944855, -61.77387805781865, 35.025135999649876, -43.09466125874754, 34.493707625220566, -57.960141876460014, 4.078868395453316, 56.71202717999872, 66.29874393407405, 1.6950649657591732, -53.82975336476687, 43.55589328688888, -12.014272766001781, 28.23873974211226, -59.5937752818956, -51.085959209689854], "policy_adversary_policy_reward": [-1.7824623984313988, -7.212595160309817, -3.2538115030856787, -0.9450354053541545, -22.01429071352463, -27.158039102187963, -32.216741823011596, 16.84627480914785, 18.17066563387, 3.8404923843687833, 42.15852772700449, 5.5063048729850665, -0.6413823770143523, -12.632692939158058, -1.433739923721717, 5.839615879384567, 13.82848934238449, 33.189102172412774, -25.179314906666498, -22.1240357112269, 5.029033727002023, -18.84487441054425, 36.483038710019116, 39.38795924923399, -2.186348384620537, 5.26227905732576, -6.829444969901324, -47.78018737619894, -1.0556734895747013, 5.155620961775686, -33.06832769098398, -33.95797899532948, -33.507150126025614, -44.82841539887527, -32.93888386924893, -27.163488933904446, 4.6946462278523855, 3.0890095316993325, -1.2606139829348137, -26.823108538239158, -40.12296855070036, -25.86782559111935, 39.76054751824638, 34.99866339715307, 7.279211451366782, -1.390519419299519, 11.012735641488451, -8.906372692589917, -17.564093229318708, -7.685045769905795, 0.038110871013897096, 7.665107180574498, -26.76508177554705, -26.130550551435885, 13.072014714353896, -2.32764583031485, -6.590330589369351, -7.796868676672602, -27.54844199818354, -27.722041348542263, -2.2548562911187204, -39.203551528972234, -4.694858746188025, -16.976269971056148, -20.95504114520804, -30.717258230930188, 23.006613805697807, -5.796200427664132, 27.090007664734106, 18.96159719165081, 19.348259049785558, 27.928722039073843, -21.71460945372919, -31.830121953158663, -34.12612920014514, -25.761650073341034, -10.144123961387114, 18.82935300579134, -5.41378241379363, -9.930219942164307, -45.766207995879036, -23.101046242746612, -28.900367003927293, -24.51458061040359, 13.694352507644954, -16.64119481345278, -11.312929259035378, -18.13529598786401, 45.34897885184123, 23.826362235509034, -57.38261178111852, -4.824135407911413, -9.04003778487035, -27.84476856611945, 1.9653497854048076, -12.849314709755994, 16.593210209870094, 8.588823884408262, -32.74992264022329, -21.04129458355142, -10.802193533979228, -41.76478607147865, -25.45195957913767, -2.0810999426653254, -15.830462328056463, -17.62627422237633, -8.693145003205807, -30.444690773017886, 36.97872444274475, 19.588382364870395, -32.184292792908835, -19.213908641596372, -42.233876868536, -15.78646647894628, 5.389405463994031, 7.179043276924006, -28.625975273999277, -32.97490720195881, 13.000532841017296, 1.702128980017335, -35.52276991539267, -23.4259357861921, -20.700891557096295, 2.0150196466702397, -23.117550890854467, -25.635926777593674, -47.73496350124408, -16.473458586315893, -19.15676901597473, -25.296810229581553, 6.9908187055616295, -3.667371827174861, -15.944788771712396, -28.463381201451355, -27.411081322698205, -24.35225148448165, -33.96398941308138, -21.70428638285108, -41.275820084271025, -0.8138882410545776, -6.813167273937033, -11.339111223119566, -5.568703512192023, -0.536219416100927, -10.379809631082125, -9.921513994007277, -23.50677190274903, -32.152956878534766, -30.09761674625666, -23.00668885177025, 4.049427283519476, 31.372615513654438, -11.774141506820506, -37.199574079091775, -19.598377581107798, -32.769956003193656, 4.851246414954652, -18.051456905670936, 29.767999722386453, -17.056429517730987, -42.09124453380151, -23.91206017162927, -42.353902629480274, -28.15817560579992, -28.767902697040554, -39.33748386343266, 7.429602707690196, 23.110485128788767, -29.312258928999945, -4.4611970104486005, -36.8140760074728, -24.959802050345846, 20.855885346416358, 14.169250653233522, -23.54629052681421, -19.54837073193333, 23.13914738317138, 11.354560242049203, -30.86642930875777, -27.09371256770224, -7.518881395100532, 11.597749790553856, 16.271469508450323, 40.44055767154838, 28.308080045912053, 37.99066388816201, 15.630661755385418, -13.935596789626246, -18.251793841720428, -35.577959523046445, 3.5163418645482984, 40.03955142234059, -0.6708618077094215, -11.34341095829236, 9.536947129931516, 18.701792612180746, -19.47221129281633, -40.12156398907928, -16.183430793998845, -34.902528415691016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3850954310514333, "mean_inference_ms": 0.9576165585955017, "mean_action_processing_ms": 0.16329410569681763, "mean_env_wait_ms": 0.056211077598264526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032014846801757812, "StateBufferConnector_ms": 0.0024437904357910156, "ViewRequirementAgentConnector_ms": 0.06335127353668213}, "num_episodes": 25, "episode_return_max": 151.74199591850623, "episode_return_min": -156.67113104980183, "episode_return_mean": -37.03522491890054}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.4500751883482, "num_env_steps_trained_throughput_per_sec": 502.4500751883482, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 7948.798, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7948.764, "sample_time_ms": 733.732, "learn_time_ms": 7203.722, "learn_throughput": 555.269, "synch_weights_time_ms": 10.782}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "training_iteration": 97, "trial_id": "eaa30_00000", "date": "2024-08-09_17-53-28", "timestamp": 1723240408, "time_this_iter_s": 7.9644060134887695, "time_total_s": 791.9664783477783, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc7c1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 791.9664783477783, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 23.145454545454545, "ram_util_percent": 79.56363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.604279618414622, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.677946628464593, "policy_loss": -0.00463671242527506, "vf_loss": 5.681053359672506, "vf_explained_var": 0.009620625821370927, "kl": 0.013416604003647253, "entropy": 0.7771671176272095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.8384946860993905, "cur_kl_coeff": 0.9874875258041134, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.101619656383991, "policy_loss": -0.0021578460446714113, "vf_loss": 7.087592151761055, "vf_explained_var": 0.05836324021220207, "kl": 0.016390429305223126, "entropy": 1.290390715872248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "env_runners": {"episode_reward_max": 138.35068217470047, "episode_reward_min": -203.39563459872056, "episode_reward_mean": -51.84024866568261, "episode_len_mean": 180.79, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18079, "policy_reward_min": {"agent_policy": -101.69781729936025, "adversary_policy": -57.38261178111852}, "policy_reward_max": {"agent_policy": 69.17534108735028, "adversary_policy": 45.34897885184123}, "policy_reward_mean": {"agent_policy": -25.9201243328413, "adversary_policy": -12.960062166420652}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.777384064134527, 4.212725897797069, -50.49827799844901, 15.406436103176784, -105.79126465396587, 21.488737768078103, -28.774398532083907, -110.5409666934516, -82.91681564018197, -43.342257434488346, -103.34459875227648, 34.42082675606735, 92.10320971276985, 94.55396217771886, -107.08946281377558, -119.77555854697238, 17.370458088808448, -30.688004711915738, -137.73450847725138, -106.82989522866185, -5.8936846116156545, -58.89645049379885, 138.35068217470047, -124.41349437805985, -73.76961270197964, -21.767929848702366, 50.364068188556715, -107.58243444754955, -105.13395921091563, -55.066119043605944, -66.91347310086562, -78.27567155244733, 113.1342136152303, -102.7964028690105, -116.04068669496456, 25.136897481836073, -123.20176495191615, 29.405323642069263, -117.89741140316971, -37.37174382085212, -97.50695533689635, -128.4168441751199, -88.9071584911126, 6.64689375677353, -88.81633994632745, -103.52666561435981, -111.33655159186503, -84.17941665065126, -36.3045569941132, -12.2098458565859, -40.60264725017879, -111.31945756256758, -106.20861119605388, 70.8440855943478, -97.94743117182446, -104.73666716860293, -26.400420981432525, 25.42314040931093, -132.00660941086153, -141.02415647056011, -136.21077312094636, 61.080175672957935, -67.54691187889696, -123.54775611563716, 70.05027199929977, -86.18932251749507, 68.9874152504411, -115.92028375291994, 8.157736790906633, 113.42405435999743, 132.5974878681482, 3.3901299315183477, -107.6595067295338, 87.1117865737778, -24.028545532003562, 56.47747948422453, -119.18755056379118, -102.17191841937964, -78.18254456572731, -138.29950146519906, -154.9604469039491, -203.39563459872056, -13.453084567958918, -145.3789380355103, 56.61807280449131, -116.14860176447922, -80.59983409061104, -106.38890882710984, -61.37861960953079, -150.8131530395059, -30.098677783520074, -79.90649501701093, -111.50242773905148, -24.118323156170135, -141.11757141230459, 67.17753908755395, -103.03875486394432, -118.32417342434113, -121.1328228600151, -65.23779498564937], "episode_lengths": [6, 11, 200, 19, 200, 200, 200, 200, 200, 200, 200, 33, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 190, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 17, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 200, 65, 200, 200, 18, 200, 200, 200, 200, 59, 200, 15, 200, 200, 200, 58, 200, 200, 200, 200, 200, 200, 200, 200, 152, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [5.888692032067263, 2.1063629488985347, -25.249138999224492, 7.7032180515883955, -52.895632326982934, 10.744368884039044, -14.387199266041954, -55.270483346725804, -41.458407820090954, -21.671128717244173, -51.67229937613823, 17.21041337803367, 46.05160485638491, 47.27698108885939, -53.544731406887855, -59.88777927348613, 8.685229044404217, -15.344002355957933, -68.86725423862566, -53.41494761433089, -2.9468423058078272, -29.44822524689939, 69.17534108735028, -62.20674718902993, -36.8848063509898, -10.883964924351204, 25.182034094278364, -53.791217223774666, -52.56697960545788, -27.533059521802997, -33.456736550432794, -39.137835776223696, 56.56710680761512, -51.398201434505204, -58.02034334748228, 12.568448740918036, -61.6008824759581, 14.702661821034631, -58.94870570158481, -18.68587191042605, -48.75347766844814, -64.20842208755994, -44.453579245556284, 3.323446878386772, -44.408169973163744, -51.76333280717985, -55.66827579593245, -42.08970832532561, -18.1522784970566, -6.10492292829295, -20.301323625089406, -55.65972878128378, -53.10430559802691, 35.422042797173916, -48.97371558591228, -52.36833358430145, -13.200210490716291, 12.711570204655464, -66.00330470543072, -70.51207823528017, -68.10538656047322, 30.540087836478968, -33.77345593944855, -61.77387805781865, 35.025135999649876, -43.09466125874754, 34.493707625220566, -57.960141876460014, 4.078868395453316, 56.71202717999872, 66.29874393407405, 1.6950649657591732, -53.82975336476687, 43.55589328688888, -12.014272766001781, 28.23873974211226, -59.5937752818956, -51.085959209689854, -39.09127228286368, -69.14975073259946, -77.48022345197455, -101.69781729936025, -6.726542283979455, -72.6894690177551, 28.309036402245667, -58.074300882239584, -40.299917045305484, -53.19445441355492, -30.68930980476539, -75.40657651975286, -15.049338891760037, -39.953247508505484, -55.75121386952573, -12.059161578085067, -70.55878570615229, 33.58876954377695, -51.51937743197214, -59.16208671217059, -60.56641143000757, -32.618897492824665], "policy_adversary_policy_reward": [7.279211451366782, -1.390519419299519, 11.012735641488451, -8.906372692589917, -17.564093229318708, -7.685045769905795, 0.038110871013897096, 7.665107180574498, -26.76508177554705, -26.130550551435885, 13.072014714353896, -2.32764583031485, -6.590330589369351, -7.796868676672602, -27.54844199818354, -27.722041348542263, -2.2548562911187204, -39.203551528972234, -4.694858746188025, -16.976269971056148, -20.95504114520804, -30.717258230930188, 23.006613805697807, -5.796200427664132, 27.090007664734106, 18.96159719165081, 19.348259049785558, 27.928722039073843, -21.71460945372919, -31.830121953158663, -34.12612920014514, -25.761650073341034, -10.144123961387114, 18.82935300579134, -5.41378241379363, -9.930219942164307, -45.766207995879036, -23.101046242746612, -28.900367003927293, -24.51458061040359, 13.694352507644954, -16.64119481345278, -11.312929259035378, -18.13529598786401, 45.34897885184123, 23.826362235509034, -57.38261178111852, -4.824135407911413, -9.04003778487035, -27.84476856611945, 1.9653497854048076, -12.849314709755994, 16.593210209870094, 8.588823884408262, -32.74992264022329, -21.04129458355142, -10.802193533979228, -41.76478607147865, -25.45195957913767, -2.0810999426653254, -15.830462328056463, -17.62627422237633, -8.693145003205807, -30.444690773017886, 36.97872444274475, 19.588382364870395, -32.184292792908835, -19.213908641596372, -42.233876868536, -15.78646647894628, 5.389405463994031, 7.179043276924006, -28.625975273999277, -32.97490720195881, 13.000532841017296, 1.702128980017335, -35.52276991539267, -23.4259357861921, -20.700891557096295, 2.0150196466702397, -23.117550890854467, -25.635926777593674, -47.73496350124408, -16.473458586315893, -19.15676901597473, -25.296810229581553, 6.9908187055616295, -3.667371827174861, -15.944788771712396, -28.463381201451355, -27.411081322698205, -24.35225148448165, -33.96398941308138, -21.70428638285108, -41.275820084271025, -0.8138882410545776, -6.813167273937033, -11.339111223119566, -5.568703512192023, -0.536219416100927, -10.379809631082125, -9.921513994007277, -23.50677190274903, -32.152956878534766, -30.09761674625666, -23.00668885177025, 4.049427283519476, 31.372615513654438, -11.774141506820506, -37.199574079091775, -19.598377581107798, -32.769956003193656, 4.851246414954652, -18.051456905670936, 29.767999722386453, -17.056429517730987, -42.09124453380151, -23.91206017162927, -42.353902629480274, -28.15817560579992, -28.767902697040554, -39.33748386343266, 7.429602707690196, 23.110485128788767, -29.312258928999945, -4.4611970104486005, -36.8140760074728, -24.959802050345846, 20.855885346416358, 14.169250653233522, -23.54629052681421, -19.54837073193333, 23.13914738317138, 11.354560242049203, -30.86642930875777, -27.09371256770224, -7.518881395100532, 11.597749790553856, 16.271469508450323, 40.44055767154838, 28.308080045912053, 37.99066388816201, 15.630661755385418, -13.935596789626246, -18.251793841720428, -35.577959523046445, 3.5163418645482984, 40.03955142234059, -0.6708618077094215, -11.34341095829236, 9.536947129931516, 18.701792612180746, -19.47221129281633, -40.12156398907928, -16.183430793998845, -34.902528415691016, -18.610629480201943, -20.480642802661723, -25.454222556428007, -43.69552817617148, -43.78987400074873, -33.690349451225835, -52.573861078314565, -49.12395622104571, -9.403697045351603, 2.677154761372144, -43.83227335925889, -28.85719565849621, 25.239613231358117, 3.069423170887558, -20.874437639881673, -37.199863242357914, -9.557343434877161, -30.742573610428327, -28.69533127427971, -24.499123139275216, -23.276736077697567, -7.412573727067823, -36.73927393569194, -38.66730258406092, -13.334357750993696, -1.7149811407663407, -23.353365694910817, -16.599881813594664, -44.30552379995403, -11.445690069571697, -4.232444652367498, -7.8267169257175695, -38.4661012733535, -32.09268443279881, 33.05447225871576, 0.5342972850612, -16.091162650075432, -35.428214781896706, -29.381497238510974, -29.78058947365962, -20.93773685173653, -39.62867457827103, -13.558870601240258, -19.060026891584407]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3849722716223051, "mean_inference_ms": 0.956519941623698, "mean_action_processing_ms": 0.16327252445254595, "mean_env_wait_ms": 0.05621451321774983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032808780670166016, "StateBufferConnector_ms": 0.002436995506286621, "ViewRequirementAgentConnector_ms": 0.06213569641113281}, "num_episodes": 22, "episode_return_max": 138.35068217470047, "episode_return_min": -203.39563459872056, "episode_return_mean": -51.84024866568261}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 514.5437158251239, "num_env_steps_trained_throughput_per_sec": 514.5437158251239, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 7927.028, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7926.995, "sample_time_ms": 731.93, "learn_time_ms": 7183.688, "learn_throughput": 556.817, "synch_weights_time_ms": 10.902}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "training_iteration": 98, "trial_id": "eaa30_00000", "date": "2024-08-09_17-53-36", "timestamp": 1723240416, "time_this_iter_s": 7.778476715087891, "time_total_s": 799.7449550628662, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a28573a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 799.7449550628662, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 22.88181818181818, "ram_util_percent": 79.56363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.179674355819743, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.7190645631658965, "policy_loss": 0.007867605472476315, "vf_loss": 6.7084933823378625, "vf_explained_var": -0.07993960777918498, "kl": 0.02370830103902826, "entropy": 0.8719747864695453, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.818713624899586, "cur_kl_coeff": 0.9874875258041134, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.47703777551651, "policy_loss": -0.0020015262646969254, "vf_loss": 7.456168500582377, "vf_explained_var": 0.1484616034353773, "kl": 0.02316060380350488, "entropy": 1.2964651482800642, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "env_runners": {"episode_reward_max": 138.35068217470047, "episode_reward_min": -221.0529056382519, "episode_reward_mean": -65.47656374085797, "episode_len_mean": 186.02, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18602, "policy_reward_min": {"agent_policy": -110.52645281912606, "adversary_policy": -62.27045675107258}, "policy_reward_max": {"agent_policy": 69.17534108735028, "adversary_policy": 45.34897885184123}, "policy_reward_mean": {"agent_policy": -32.73828187042899, "adversary_policy": -16.369140935214496}, "custom_metrics": {}, "hist_stats": {"episode_reward": [138.35068217470047, -124.41349437805985, -73.76961270197964, -21.767929848702366, 50.364068188556715, -107.58243444754955, -105.13395921091563, -55.066119043605944, -66.91347310086562, -78.27567155244733, 113.1342136152303, -102.7964028690105, -116.04068669496456, 25.136897481836073, -123.20176495191615, 29.405323642069263, -117.89741140316971, -37.37174382085212, -97.50695533689635, -128.4168441751199, -88.9071584911126, 6.64689375677353, -88.81633994632745, -103.52666561435981, -111.33655159186503, -84.17941665065126, -36.3045569941132, -12.2098458565859, -40.60264725017879, -111.31945756256758, -106.20861119605388, 70.8440855943478, -97.94743117182446, -104.73666716860293, -26.400420981432525, 25.42314040931093, -132.00660941086153, -141.02415647056011, -136.21077312094636, 61.080175672957935, -67.54691187889696, -123.54775611563716, 70.05027199929977, -86.18932251749507, 68.9874152504411, -115.92028375291994, 8.157736790906633, 113.42405435999743, 132.5974878681482, 3.3901299315183477, -107.6595067295338, 87.1117865737778, -24.028545532003562, 56.47747948422453, -119.18755056379118, -102.17191841937964, -78.18254456572731, -138.29950146519906, -154.9604469039491, -203.39563459872056, -13.453084567958918, -145.3789380355103, 56.61807280449131, -116.14860176447922, -80.59983409061104, -106.38890882710984, -61.37861960953079, -150.8131530395059, -30.098677783520074, -79.90649501701093, -111.50242773905148, -24.118323156170135, -141.11757141230459, 67.17753908755395, -103.03875486394432, -118.32417342434113, -121.1328228600151, -65.23779498564937, -221.0529056382519, -16.030273691110523, -192.5233698216659, -163.77678659680174, -119.46565840514339, -122.36100849772447, -90.0116894039875, -114.69529464742527, -71.08091112370914, -128.97610223963625, -154.54207286929517, -70.30840959509428, 56.50178983140266, -73.73338595811302, 70.54332881336028, -132.31256166237569, -211.30577656894758, -141.23825317498958, -72.07800268922958, 55.84472928333183, -100.68782926744491, -151.12346761502351], "episode_lengths": [190, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 17, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 200, 65, 200, 200, 18, 200, 200, 200, 200, 59, 200, 15, 200, 200, 200, 58, 200, 200, 200, 200, 200, 200, 200, 200, 152, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 38, 200, 200, 200, 200, 154, 200, 200], "policy_agent_policy_reward": [69.17534108735028, -62.20674718902993, -36.8848063509898, -10.883964924351204, 25.182034094278364, -53.791217223774666, -52.56697960545788, -27.533059521802997, -33.456736550432794, -39.137835776223696, 56.56710680761512, -51.398201434505204, -58.02034334748228, 12.568448740918036, -61.6008824759581, 14.702661821034631, -58.94870570158481, -18.68587191042605, -48.75347766844814, -64.20842208755994, -44.453579245556284, 3.323446878386772, -44.408169973163744, -51.76333280717985, -55.66827579593245, -42.08970832532561, -18.1522784970566, -6.10492292829295, -20.301323625089406, -55.65972878128378, -53.10430559802691, 35.422042797173916, -48.97371558591228, -52.36833358430145, -13.200210490716291, 12.711570204655464, -66.00330470543072, -70.51207823528017, -68.10538656047322, 30.540087836478968, -33.77345593944855, -61.77387805781865, 35.025135999649876, -43.09466125874754, 34.493707625220566, -57.960141876460014, 4.078868395453316, 56.71202717999872, 66.29874393407405, 1.6950649657591732, -53.82975336476687, 43.55589328688888, -12.014272766001781, 28.23873974211226, -59.5937752818956, -51.085959209689854, -39.09127228286368, -69.14975073259946, -77.48022345197455, -101.69781729936025, -6.726542283979455, -72.6894690177551, 28.309036402245667, -58.074300882239584, -40.299917045305484, -53.19445441355492, -30.68930980476539, -75.40657651975286, -15.049338891760037, -39.953247508505484, -55.75121386952573, -12.059161578085067, -70.55878570615229, 33.58876954377695, -51.51937743197214, -59.16208671217059, -60.56641143000757, -32.618897492824665, -110.52645281912606, -8.015136845555261, -96.26168491083318, -81.88839329840086, -59.7328292025717, -61.18050424886223, -45.00584470199376, -57.34764732371271, -35.540455561854536, -64.48805111981815, -77.27103643464756, -35.154204797547145, 28.25089491570133, -36.86669297905646, 35.27166440668013, -66.15628083118787, -105.65288828447376, -70.61912658749486, -36.03900134461478, 27.922364641665915, -50.343914633722456, -75.56173380751177], "policy_adversary_policy_reward": [45.34897885184123, 23.826362235509034, -57.38261178111852, -4.824135407911413, -9.04003778487035, -27.84476856611945, 1.9653497854048076, -12.849314709755994, 16.593210209870094, 8.588823884408262, -32.74992264022329, -21.04129458355142, -10.802193533979228, -41.76478607147865, -25.45195957913767, -2.0810999426653254, -15.830462328056463, -17.62627422237633, -8.693145003205807, -30.444690773017886, 36.97872444274475, 19.588382364870395, -32.184292792908835, -19.213908641596372, -42.233876868536, -15.78646647894628, 5.389405463994031, 7.179043276924006, -28.625975273999277, -32.97490720195881, 13.000532841017296, 1.702128980017335, -35.52276991539267, -23.4259357861921, -20.700891557096295, 2.0150196466702397, -23.117550890854467, -25.635926777593674, -47.73496350124408, -16.473458586315893, -19.15676901597473, -25.296810229581553, 6.9908187055616295, -3.667371827174861, -15.944788771712396, -28.463381201451355, -27.411081322698205, -24.35225148448165, -33.96398941308138, -21.70428638285108, -41.275820084271025, -0.8138882410545776, -6.813167273937033, -11.339111223119566, -5.568703512192023, -0.536219416100927, -10.379809631082125, -9.921513994007277, -23.50677190274903, -32.152956878534766, -30.09761674625666, -23.00668885177025, 4.049427283519476, 31.372615513654438, -11.774141506820506, -37.199574079091775, -19.598377581107798, -32.769956003193656, 4.851246414954652, -18.051456905670936, 29.767999722386453, -17.056429517730987, -42.09124453380151, -23.91206017162927, -42.353902629480274, -28.15817560579992, -28.767902697040554, -39.33748386343266, 7.429602707690196, 23.110485128788767, -29.312258928999945, -4.4611970104486005, -36.8140760074728, -24.959802050345846, 20.855885346416358, 14.169250653233522, -23.54629052681421, -19.54837073193333, 23.13914738317138, 11.354560242049203, -30.86642930875777, -27.09371256770224, -7.518881395100532, 11.597749790553856, 16.271469508450323, 40.44055767154838, 28.308080045912053, 37.99066388816201, 15.630661755385418, -13.935596789626246, -18.251793841720428, -35.577959523046445, 3.5163418645482984, 40.03955142234059, -0.6708618077094215, -11.34341095829236, 9.536947129931516, 18.701792612180746, -19.47221129281633, -40.12156398907928, -16.183430793998845, -34.902528415691016, -18.610629480201943, -20.480642802661723, -25.454222556428007, -43.69552817617148, -43.78987400074873, -33.690349451225835, -52.573861078314565, -49.12395622104571, -9.403697045351603, 2.677154761372144, -43.83227335925889, -28.85719565849621, 25.239613231358117, 3.069423170887558, -20.874437639881673, -37.199863242357914, -9.557343434877161, -30.742573610428327, -28.69533127427971, -24.499123139275216, -23.276736077697567, -7.412573727067823, -36.73927393569194, -38.66730258406092, -13.334357750993696, -1.7149811407663407, -23.353365694910817, -16.599881813594664, -44.30552379995403, -11.445690069571697, -4.232444652367498, -7.8267169257175695, -38.4661012733535, -32.09268443279881, 33.05447225871576, 0.5342972850612, -16.091162650075432, -35.428214781896706, -29.381497238510974, -29.78058947365962, -20.93773685173653, -39.62867457827103, -13.558870601240258, -19.060026891584407, -48.25599606805353, -62.27045675107258, -4.426601574587686, -3.5885352709675757, -50.68389935269026, -45.57778555814285, -40.896367776597494, -40.99202552180325, -35.757936520946885, -23.97489268162481, -27.47491835185061, -33.70558589701164, -31.008650141620883, -13.99719456037288, -48.38499345763564, -8.96265386607707, -24.781838217107378, -10.758617344747158, -33.044420186275715, -31.44363093354243, -39.25177341230295, -38.019263022344646, -14.37984607241745, -20.774358725129694, 14.778689661032569, 13.472205254668765, -24.145763480797605, -12.720929498258855, 1.279850091165116, 33.991814315515015, -30.615971342341457, -35.540309488846404, -48.499914669120216, -57.15297361535358, -32.46570874356608, -38.153417843928786, -11.420935449859222, -24.61806589475556, 16.053037995615483, 11.869326646050427, -25.51417726755036, -24.829737366172107, -36.212899544274535, -39.34883426323726]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3848222204135616, "mean_inference_ms": 0.9558427149438968, "mean_action_processing_ms": 0.16332728853177791, "mean_env_wait_ms": 0.05619129897470659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003402233123779297, "StateBufferConnector_ms": 0.0024760961532592773, "ViewRequirementAgentConnector_ms": 0.0635380744934082}, "num_episodes": 22, "episode_return_max": 138.35068217470047, "episode_return_min": -221.0529056382519, "episode_return_mean": -65.47656374085797}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.3060722403519, "num_env_steps_trained_throughput_per_sec": 498.3060722403519, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 7933.87, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7933.837, "sample_time_ms": 731.957, "learn_time_ms": 7190.761, "learn_throughput": 556.269, "synch_weights_time_ms": 10.617}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "training_iteration": 99, "trial_id": "eaa30_00000", "date": "2024-08-09_17-53-45", "timestamp": 1723240425, "time_this_iter_s": 8.031499862670898, "time_total_s": 807.7764549255371, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a28575e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 807.7764549255371, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 23.974999999999998, "ram_util_percent": 79.70833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.601006403423491, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.867640061605544, "policy_loss": -0.001630025895721422, "vf_loss": 5.865973619178489, "vf_explained_var": -0.005988309055409103, "kl": 0.019271788517722772, "entropy": 0.9078492478403465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.387102267270287, "cur_kl_coeff": 1.4812312887061698, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.732798862457275, "policy_loss": 0.003095426749981319, "vf_loss": 6.703987918794155, "vf_explained_var": 0.07665349797656139, "kl": 0.01736089675396215, "entropy": 1.320542133351167, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 132.5974878681482, "episode_reward_min": -221.0529056382519, "episode_reward_mean": -70.36827053401615, "episode_len_mean": 184.34, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18434, "policy_reward_min": {"agent_policy": -110.52645281912606, "adversary_policy": -62.27045675107258}, "policy_reward_max": {"agent_policy": 66.29874393407405, "adversary_policy": 40.44055767154838}, "policy_reward_mean": {"agent_policy": -35.184135267008074, "adversary_policy": -17.59206763350404}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88.9071584911126, 6.64689375677353, -88.81633994632745, -103.52666561435981, -111.33655159186503, -84.17941665065126, -36.3045569941132, -12.2098458565859, -40.60264725017879, -111.31945756256758, -106.20861119605388, 70.8440855943478, -97.94743117182446, -104.73666716860293, -26.400420981432525, 25.42314040931093, -132.00660941086153, -141.02415647056011, -136.21077312094636, 61.080175672957935, -67.54691187889696, -123.54775611563716, 70.05027199929977, -86.18932251749507, 68.9874152504411, -115.92028375291994, 8.157736790906633, 113.42405435999743, 132.5974878681482, 3.3901299315183477, -107.6595067295338, 87.1117865737778, -24.028545532003562, 56.47747948422453, -119.18755056379118, -102.17191841937964, -78.18254456572731, -138.29950146519906, -154.9604469039491, -203.39563459872056, -13.453084567958918, -145.3789380355103, 56.61807280449131, -116.14860176447922, -80.59983409061104, -106.38890882710984, -61.37861960953079, -150.8131530395059, -30.098677783520074, -79.90649501701093, -111.50242773905148, -24.118323156170135, -141.11757141230459, 67.17753908755395, -103.03875486394432, -118.32417342434113, -121.1328228600151, -65.23779498564937, -221.0529056382519, -16.030273691110523, -192.5233698216659, -163.77678659680174, -119.46565840514339, -122.36100849772447, -90.0116894039875, -114.69529464742527, -71.08091112370914, -128.97610223963625, -154.54207286929517, -70.30840959509428, 56.50178983140266, -73.73338595811302, 70.54332881336028, -132.31256166237569, -211.30577656894758, -141.23825317498958, -72.07800268922958, 55.84472928333183, -100.68782926744491, -151.12346761502351, -117.23126588927613, -108.29511616837561, -48.69130173268125, -167.8268824662003, -95.77360116204687, -152.71699803768308, 37.76357071056282, -38.48629130507115, 83.07811932006423, -144.2395923160368, 95.24485138348152, -78.1256996693401, -131.82479116577875, 60.84670269713102, -84.99259287390854, -168.6788623103887, -65.44786653180985, -91.81868069491736, -134.01458942310651, -137.70311011409768], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 200, 65, 200, 200, 18, 200, 200, 200, 200, 59, 200, 15, 200, 200, 200, 58, 200, 200, 200, 200, 200, 200, 200, 200, 152, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 38, 200, 200, 200, 200, 154, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 200, 21, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-44.453579245556284, 3.323446878386772, -44.408169973163744, -51.76333280717985, -55.66827579593245, -42.08970832532561, -18.1522784970566, -6.10492292829295, -20.301323625089406, -55.65972878128378, -53.10430559802691, 35.422042797173916, -48.97371558591228, -52.36833358430145, -13.200210490716291, 12.711570204655464, -66.00330470543072, -70.51207823528017, -68.10538656047322, 30.540087836478968, -33.77345593944855, -61.77387805781865, 35.025135999649876, -43.09466125874754, 34.493707625220566, -57.960141876460014, 4.078868395453316, 56.71202717999872, 66.29874393407405, 1.6950649657591732, -53.82975336476687, 43.55589328688888, -12.014272766001781, 28.23873974211226, -59.5937752818956, -51.085959209689854, -39.09127228286368, -69.14975073259946, -77.48022345197455, -101.69781729936025, -6.726542283979455, -72.6894690177551, 28.309036402245667, -58.074300882239584, -40.299917045305484, -53.19445441355492, -30.68930980476539, -75.40657651975286, -15.049338891760037, -39.953247508505484, -55.75121386952573, -12.059161578085067, -70.55878570615229, 33.58876954377695, -51.51937743197214, -59.16208671217059, -60.56641143000757, -32.618897492824665, -110.52645281912606, -8.015136845555261, -96.26168491083318, -81.88839329840086, -59.7328292025717, -61.18050424886223, -45.00584470199376, -57.34764732371271, -35.540455561854536, -64.48805111981815, -77.27103643464756, -35.154204797547145, 28.25089491570133, -36.86669297905646, 35.27166440668013, -66.15628083118787, -105.65288828447376, -70.61912658749486, -36.03900134461478, 27.922364641665915, -50.343914633722456, -75.56173380751177, -58.615632944638094, -54.14755808418779, -24.34565086634063, -83.91344123310006, -47.88680058102344, -76.35849901884163, 18.8817853552814, -19.243145652535578, 41.539059660032116, -72.1197961580184, 47.62242569174071, -39.06284983467003, -65.91239558288939, 30.423351348565518, -42.496296436954225, -84.33943115519429, -32.72393326590487, -45.90934034745872, -67.00729471155321, -68.85155505704886], "policy_adversary_policy_reward": [-19.15676901597473, -25.296810229581553, 6.9908187055616295, -3.667371827174861, -15.944788771712396, -28.463381201451355, -27.411081322698205, -24.35225148448165, -33.96398941308138, -21.70428638285108, -41.275820084271025, -0.8138882410545776, -6.813167273937033, -11.339111223119566, -5.568703512192023, -0.536219416100927, -10.379809631082125, -9.921513994007277, -23.50677190274903, -32.152956878534766, -30.09761674625666, -23.00668885177025, 4.049427283519476, 31.372615513654438, -11.774141506820506, -37.199574079091775, -19.598377581107798, -32.769956003193656, 4.851246414954652, -18.051456905670936, 29.767999722386453, -17.056429517730987, -42.09124453380151, -23.91206017162927, -42.353902629480274, -28.15817560579992, -28.767902697040554, -39.33748386343266, 7.429602707690196, 23.110485128788767, -29.312258928999945, -4.4611970104486005, -36.8140760074728, -24.959802050345846, 20.855885346416358, 14.169250653233522, -23.54629052681421, -19.54837073193333, 23.13914738317138, 11.354560242049203, -30.86642930875777, -27.09371256770224, -7.518881395100532, 11.597749790553856, 16.271469508450323, 40.44055767154838, 28.308080045912053, 37.99066388816201, 15.630661755385418, -13.935596789626246, -18.251793841720428, -35.577959523046445, 3.5163418645482984, 40.03955142234059, -0.6708618077094215, -11.34341095829236, 9.536947129931516, 18.701792612180746, -19.47221129281633, -40.12156398907928, -16.183430793998845, -34.902528415691016, -18.610629480201943, -20.480642802661723, -25.454222556428007, -43.69552817617148, -43.78987400074873, -33.690349451225835, -52.573861078314565, -49.12395622104571, -9.403697045351603, 2.677154761372144, -43.83227335925889, -28.85719565849621, 25.239613231358117, 3.069423170887558, -20.874437639881673, -37.199863242357914, -9.557343434877161, -30.742573610428327, -28.69533127427971, -24.499123139275216, -23.276736077697567, -7.412573727067823, -36.73927393569194, -38.66730258406092, -13.334357750993696, -1.7149811407663407, -23.353365694910817, -16.599881813594664, -44.30552379995403, -11.445690069571697, -4.232444652367498, -7.8267169257175695, -38.4661012733535, -32.09268443279881, 33.05447225871576, 0.5342972850612, -16.091162650075432, -35.428214781896706, -29.381497238510974, -29.78058947365962, -20.93773685173653, -39.62867457827103, -13.558870601240258, -19.060026891584407, -48.25599606805353, -62.27045675107258, -4.426601574587686, -3.5885352709675757, -50.68389935269026, -45.57778555814285, -40.896367776597494, -40.99202552180325, -35.757936520946885, -23.97489268162481, -27.47491835185061, -33.70558589701164, -31.008650141620883, -13.99719456037288, -48.38499345763564, -8.96265386607707, -24.781838217107378, -10.758617344747158, -33.044420186275715, -31.44363093354243, -39.25177341230295, -38.019263022344646, -14.37984607241745, -20.774358725129694, 14.778689661032569, 13.472205254668765, -24.145763480797605, -12.720929498258855, 1.279850091165116, 33.991814315515015, -30.615971342341457, -35.540309488846404, -48.499914669120216, -57.15297361535358, -32.46570874356608, -38.153417843928786, -11.420935449859222, -24.61806589475556, 16.053037995615483, 11.869326646050427, -25.51417726755036, -24.829737366172107, -36.212899544274535, -39.34883426323726, -18.644233770519058, -39.97139917411904, -32.04438083908966, -22.10317724509813, -8.292607233997781, -16.053043632342845, -52.97281893144719, -30.940622301652972, -28.835637823949696, -19.05116275707374, -37.53473931031689, -38.82375970852476, 27.224702833246596, -8.342917477965198, -15.916988798352861, -3.326156854182706, 22.451994741931927, 19.08706491810019, -38.36530850352782, -33.75448765449059, 30.63763963013813, 16.98478606160259, -14.604554198740736, -24.458295635929296, -30.149248644219043, -35.763146938670346, 10.766991090399738, 19.656360258165776, -5.440742278464789, -37.05555415848944, -43.582876257738256, -40.756554897456105, -12.802281252396675, -19.921652013508197, -39.99072141468263, -5.918618932776084, -26.822822656750763, -40.184472054802455, -37.14935073793576, -31.702204319113086]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3846339824820676, "mean_inference_ms": 0.9555214846082549, "mean_action_processing_ms": 0.16326900043497694, "mean_env_wait_ms": 0.05618571049461552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034199953079223633, "StateBufferConnector_ms": 0.002430558204650879, "ViewRequirementAgentConnector_ms": 0.06361377239227295}, "num_episodes": 20, "episode_return_max": 132.5974878681482, "episode_return_min": -221.0529056382519, "episode_return_mean": -70.36827053401615}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.0208794202426, "num_env_steps_trained_throughput_per_sec": 504.0208794202426, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 7903.632, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7903.599, "sample_time_ms": 714.629, "learn_time_ms": 7178.062, "learn_throughput": 557.253, "synch_weights_time_ms": 10.406}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 100, "trial_id": "eaa30_00000", "date": "2024-08-09_17-53-53", "timestamp": 1723240433, "time_this_iter_s": 7.941312789916992, "time_total_s": 815.7177677154541, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2857820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 815.7177677154541, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 26.94545454545455, "ram_util_percent": 79.33636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.859171946591171, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.537512711116245, "policy_loss": 0.0011187430126247582, "vf_loss": 5.533591216960281, "vf_explained_var": 0.04903848874505865, "kl": 0.0163853447068798, "entropy": 0.9085437834262848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.423225736866395, "cur_kl_coeff": 1.4812312887061698, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.904762116074562, "policy_loss": -0.006094669286782543, "vf_loss": 6.890462678174178, "vf_explained_var": 0.0106809605533878, "kl": 0.013768351611603672, "entropy": 1.370457663014531, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 96480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "env_runners": {"episode_reward_max": 132.5974878681482, "episode_reward_min": -221.0529056382519, "episode_reward_mean": -73.08649564155048, "episode_len_mean": 185.98, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 18598, "policy_reward_min": {"agent_policy": -110.52645281912606, "adversary_policy": -62.27045675107258}, "policy_reward_max": {"agent_policy": 66.29874393407405, "adversary_policy": 40.44055767154838}, "policy_reward_mean": {"agent_policy": -36.54324782077524, "adversary_policy": -18.27162391038762}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-136.21077312094636, 61.080175672957935, -67.54691187889696, -123.54775611563716, 70.05027199929977, -86.18932251749507, 68.9874152504411, -115.92028375291994, 8.157736790906633, 113.42405435999743, 132.5974878681482, 3.3901299315183477, -107.6595067295338, 87.1117865737778, -24.028545532003562, 56.47747948422453, -119.18755056379118, -102.17191841937964, -78.18254456572731, -138.29950146519906, -154.9604469039491, -203.39563459872056, -13.453084567958918, -145.3789380355103, 56.61807280449131, -116.14860176447922, -80.59983409061104, -106.38890882710984, -61.37861960953079, -150.8131530395059, -30.098677783520074, -79.90649501701093, -111.50242773905148, -24.118323156170135, -141.11757141230459, 67.17753908755395, -103.03875486394432, -118.32417342434113, -121.1328228600151, -65.23779498564937, -221.0529056382519, -16.030273691110523, -192.5233698216659, -163.77678659680174, -119.46565840514339, -122.36100849772447, -90.0116894039875, -114.69529464742527, -71.08091112370914, -128.97610223963625, -154.54207286929517, -70.30840959509428, 56.50178983140266, -73.73338595811302, 70.54332881336028, -132.31256166237569, -211.30577656894758, -141.23825317498958, -72.07800268922958, 55.84472928333183, -100.68782926744491, -151.12346761502351, -117.23126588927613, -108.29511616837561, -48.69130173268125, -167.8268824662003, -95.77360116204687, -152.71699803768308, 37.76357071056282, -38.48629130507115, 83.07811932006423, -144.2395923160368, 95.24485138348152, -78.1256996693401, -131.82479116577875, 60.84670269713102, -84.99259287390854, -168.6788623103887, -65.44786653180985, -91.81868069491736, -134.01458942310651, -137.70311011409768, -166.04426914135388, 36.40911723313303, -7.945115621883552, -39.893877323703435, -155.52753584841975, -110.25021141082614, -25.716024781245636, -106.65629073224932, -7.735988606569549, -132.7496582247619, -81.60850230977832, -104.79401051033, -134.2867380670777, -34.632641111010926, -34.62296353778105, -141.06670775840266, -117.66451161865511, -89.64899797918153], "episode_lengths": [200, 65, 200, 200, 18, 200, 200, 200, 200, 59, 200, 15, 200, 200, 200, 58, 200, 200, 200, 200, 200, 200, 200, 200, 152, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 38, 200, 200, 200, 200, 154, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 200, 21, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-68.10538656047322, 30.540087836478968, -33.77345593944855, -61.77387805781865, 35.025135999649876, -43.09466125874754, 34.493707625220566, -57.960141876460014, 4.078868395453316, 56.71202717999872, 66.29874393407405, 1.6950649657591732, -53.82975336476687, 43.55589328688888, -12.014272766001781, 28.23873974211226, -59.5937752818956, -51.085959209689854, -39.09127228286368, -69.14975073259946, -77.48022345197455, -101.69781729936025, -6.726542283979455, -72.6894690177551, 28.309036402245667, -58.074300882239584, -40.299917045305484, -53.19445441355492, -30.68930980476539, -75.40657651975286, -15.049338891760037, -39.953247508505484, -55.75121386952573, -12.059161578085067, -70.55878570615229, 33.58876954377695, -51.51937743197214, -59.16208671217059, -60.56641143000757, -32.618897492824665, -110.52645281912606, -8.015136845555261, -96.26168491083318, -81.88839329840086, -59.7328292025717, -61.18050424886223, -45.00584470199376, -57.34764732371271, -35.540455561854536, -64.48805111981815, -77.27103643464756, -35.154204797547145, 28.25089491570133, -36.86669297905646, 35.27166440668013, -66.15628083118787, -105.65288828447376, -70.61912658749486, -36.03900134461478, 27.922364641665915, -50.343914633722456, -75.56173380751177, -58.615632944638094, -54.14755808418779, -24.34565086634063, -83.91344123310006, -47.88680058102344, -76.35849901884163, 18.8817853552814, -19.243145652535578, 41.539059660032116, -72.1197961580184, 47.62242569174071, -39.06284983467003, -65.91239558288939, 30.423351348565518, -42.496296436954225, -84.33943115519429, -32.72393326590487, -45.90934034745872, -67.00729471155321, -68.85155505704886, -83.02213457067697, 18.204558616566505, -3.972557810941776, -19.946938661851718, -77.76376792420987, -55.125105705413084, -12.858012390622818, -53.32814536612468, -3.8679943032847746, -66.37482911238095, -40.804251154889215, -52.39700525516502, -67.14336903353885, -17.316320555505463, -17.311481768890523, -70.5333538792014, -58.83225580932753, -44.82449898959075], "policy_adversary_policy_reward": [-28.767902697040554, -39.33748386343266, 7.429602707690196, 23.110485128788767, -29.312258928999945, -4.4611970104486005, -36.8140760074728, -24.959802050345846, 20.855885346416358, 14.169250653233522, -23.54629052681421, -19.54837073193333, 23.13914738317138, 11.354560242049203, -30.86642930875777, -27.09371256770224, -7.518881395100532, 11.597749790553856, 16.271469508450323, 40.44055767154838, 28.308080045912053, 37.99066388816201, 15.630661755385418, -13.935596789626246, -18.251793841720428, -35.577959523046445, 3.5163418645482984, 40.03955142234059, -0.6708618077094215, -11.34341095829236, 9.536947129931516, 18.701792612180746, -19.47221129281633, -40.12156398907928, -16.183430793998845, -34.902528415691016, -18.610629480201943, -20.480642802661723, -25.454222556428007, -43.69552817617148, -43.78987400074873, -33.690349451225835, -52.573861078314565, -49.12395622104571, -9.403697045351603, 2.677154761372144, -43.83227335925889, -28.85719565849621, 25.239613231358117, 3.069423170887558, -20.874437639881673, -37.199863242357914, -9.557343434877161, -30.742573610428327, -28.69533127427971, -24.499123139275216, -23.276736077697567, -7.412573727067823, -36.73927393569194, -38.66730258406092, -13.334357750993696, -1.7149811407663407, -23.353365694910817, -16.599881813594664, -44.30552379995403, -11.445690069571697, -4.232444652367498, -7.8267169257175695, -38.4661012733535, -32.09268443279881, 33.05447225871576, 0.5342972850612, -16.091162650075432, -35.428214781896706, -29.381497238510974, -29.78058947365962, -20.93773685173653, -39.62867457827103, -13.558870601240258, -19.060026891584407, -48.25599606805353, -62.27045675107258, -4.426601574587686, -3.5885352709675757, -50.68389935269026, -45.57778555814285, -40.896367776597494, -40.99202552180325, -35.757936520946885, -23.97489268162481, -27.47491835185061, -33.70558589701164, -31.008650141620883, -13.99719456037288, -48.38499345763564, -8.96265386607707, -24.781838217107378, -10.758617344747158, -33.044420186275715, -31.44363093354243, -39.25177341230295, -38.019263022344646, -14.37984607241745, -20.774358725129694, 14.778689661032569, 13.472205254668765, -24.145763480797605, -12.720929498258855, 1.279850091165116, 33.991814315515015, -30.615971342341457, -35.540309488846404, -48.499914669120216, -57.15297361535358, -32.46570874356608, -38.153417843928786, -11.420935449859222, -24.61806589475556, 16.053037995615483, 11.869326646050427, -25.51417726755036, -24.829737366172107, -36.212899544274535, -39.34883426323726, -18.644233770519058, -39.97139917411904, -32.04438083908966, -22.10317724509813, -8.292607233997781, -16.053043632342845, -52.97281893144719, -30.940622301652972, -28.835637823949696, -19.05116275707374, -37.53473931031689, -38.82375970852476, 27.224702833246596, -8.342917477965198, -15.916988798352861, -3.326156854182706, 22.451994741931927, 19.08706491810019, -38.36530850352782, -33.75448765449059, 30.63763963013813, 16.98478606160259, -14.604554198740736, -24.458295635929296, -30.149248644219043, -35.763146938670346, 10.766991090399738, 19.656360258165776, -5.440742278464789, -37.05555415848944, -43.582876257738256, -40.756554897456105, -12.802281252396675, -19.921652013508197, -39.99072141468263, -5.918618932776084, -26.822822656750763, -40.184472054802455, -37.14935073793576, -31.702204319113086, -39.85757976649884, -43.16455480417815, -5.436016450235613, 23.640575066802118, -5.0123061689990855, 1.0397483580573095, -9.59301397466811, -10.353924687183607, -29.379516706379402, -48.38425121783045, -17.690661791497597, -37.43444391391549, 3.0882434043295426, -15.94625579495236, -36.01712371740167, -17.311021648723, -10.20599558579515, 6.338001282510376, -33.90077883904313, -32.474050273337845, -33.04838117954122, -7.755869975347991, -24.568120111405406, -27.828885143759603, -34.49267756929279, -32.650691464246144, -1.4895487747032092, -15.826771780802257, -8.007765249260522, -9.303716519630001, -44.54293828991982, -25.990415589281596, -37.95257313510521, -20.879682674222302, -42.10912731317918, -2.7153716764115714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3844005722393771, "mean_inference_ms": 0.9547185377457434, "mean_action_processing_ms": 0.16323772036531206, "mean_env_wait_ms": 0.05618921236272193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033648014068603516, "StateBufferConnector_ms": 0.0024127960205078125, "ViewRequirementAgentConnector_ms": 0.06298494338989258}, "num_episodes": 18, "episode_return_max": 132.5974878681482, "episode_return_min": -221.0529056382519, "episode_return_mean": -73.08649564155048}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.0466190605072, "num_env_steps_trained_throughput_per_sec": 494.0466190605072, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 1212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 7914.213, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7914.181, "sample_time_ms": 713.825, "learn_time_ms": 7189.484, "learn_throughput": 556.368, "synch_weights_time_ms": 10.448}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "training_iteration": 101, "trial_id": "eaa30_00000", "date": "2024-08-09_17-54-01", "timestamp": 1723240441, "time_this_iter_s": 8.104202032089233, "time_total_s": 823.8219697475433, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a28578b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 823.8219697475433, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 21.583333333333332, "ram_util_percent": 79.05833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.865871364288229, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.558108256859754, "policy_loss": 0.010272006598232245, "vf_loss": 5.54513490136969, "vf_explained_var": 0.035162714391789106, "kl": 0.01579244842890788, "entropy": 0.8894017077627636, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.805760133390625, "cur_kl_coeff": 1.4812312887061698, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.880735117693742, "policy_loss": 0.00438687418209156, "vf_loss": 6.855207703014215, "vf_explained_var": 0.1505726110190153, "kl": 0.014272278567174605, "entropy": 1.4000543378293515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 97440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "env_runners": {"episode_reward_max": 101.11528200448275, "episode_reward_min": -221.0529056382519, "episode_reward_mean": -83.72816519151799, "episode_len_mean": 190.22, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 19022, "policy_reward_min": {"agent_policy": -110.52645281912606, "adversary_policy": -62.27045675107258}, "policy_reward_max": {"agent_policy": 50.55764100224137, "adversary_policy": 33.991814315515015}, "policy_reward_mean": {"agent_policy": -41.864082595759, "adversary_policy": -20.932041297879504}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-145.3789380355103, 56.61807280449131, -116.14860176447922, -80.59983409061104, -106.38890882710984, -61.37861960953079, -150.8131530395059, -30.098677783520074, -79.90649501701093, -111.50242773905148, -24.118323156170135, -141.11757141230459, 67.17753908755395, -103.03875486394432, -118.32417342434113, -121.1328228600151, -65.23779498564937, -221.0529056382519, -16.030273691110523, -192.5233698216659, -163.77678659680174, -119.46565840514339, -122.36100849772447, -90.0116894039875, -114.69529464742527, -71.08091112370914, -128.97610223963625, -154.54207286929517, -70.30840959509428, 56.50178983140266, -73.73338595811302, 70.54332881336028, -132.31256166237569, -211.30577656894758, -141.23825317498958, -72.07800268922958, 55.84472928333183, -100.68782926744491, -151.12346761502351, -117.23126588927613, -108.29511616837561, -48.69130173268125, -167.8268824662003, -95.77360116204687, -152.71699803768308, 37.76357071056282, -38.48629130507115, 83.07811932006423, -144.2395923160368, 95.24485138348152, -78.1256996693401, -131.82479116577875, 60.84670269713102, -84.99259287390854, -168.6788623103887, -65.44786653180985, -91.81868069491736, -134.01458942310651, -137.70311011409768, -166.04426914135388, 36.40911723313303, -7.945115621883552, -39.893877323703435, -155.52753584841975, -110.25021141082614, -25.716024781245636, -106.65629073224932, -7.735988606569549, -132.7496582247619, -81.60850230977832, -104.79401051033, -134.2867380670777, -34.632641111010926, -34.62296353778105, -141.06670775840266, -117.66451161865511, -89.64899797918153, -1.4945305030582716, -110.29591060104008, -65.75106886605415, -127.1543341243075, -49.332378288398786, -153.3836214906284, -70.25742915726059, -112.35049004425404, -56.68689907358163, -101.02647692533927, -107.96681992917509, -71.25272470998269, -108.06857970989662, -106.1680845518193, 1.728563417845303, -113.91588439308686, -89.57752044361285, -112.5421563540512, -118.5319413318596, 101.11528200448275, -150.59403322959355, -74.50515585225443, -135.632003640712], "episode_lengths": [200, 152, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 38, 200, 200, 200, 200, 154, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 200, 21, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 38, 200, 200, 200], "policy_agent_policy_reward": [-72.6894690177551, 28.309036402245667, -58.074300882239584, -40.299917045305484, -53.19445441355492, -30.68930980476539, -75.40657651975286, -15.049338891760037, -39.953247508505484, -55.75121386952573, -12.059161578085067, -70.55878570615229, 33.58876954377695, -51.51937743197214, -59.16208671217059, -60.56641143000757, -32.618897492824665, -110.52645281912606, -8.015136845555261, -96.26168491083318, -81.88839329840086, -59.7328292025717, -61.18050424886223, -45.00584470199376, -57.34764732371271, -35.540455561854536, -64.48805111981815, -77.27103643464756, -35.154204797547145, 28.25089491570133, -36.86669297905646, 35.27166440668013, -66.15628083118787, -105.65288828447376, -70.61912658749486, -36.03900134461478, 27.922364641665915, -50.343914633722456, -75.56173380751177, -58.615632944638094, -54.14755808418779, -24.34565086634063, -83.91344123310006, -47.88680058102344, -76.35849901884163, 18.8817853552814, -19.243145652535578, 41.539059660032116, -72.1197961580184, 47.62242569174071, -39.06284983467003, -65.91239558288939, 30.423351348565518, -42.496296436954225, -84.33943115519429, -32.72393326590487, -45.90934034745872, -67.00729471155321, -68.85155505704886, -83.02213457067697, 18.204558616566505, -3.972557810941776, -19.946938661851718, -77.76376792420987, -55.125105705413084, -12.858012390622818, -53.32814536612468, -3.8679943032847746, -66.37482911238095, -40.804251154889215, -52.39700525516502, -67.14336903353885, -17.316320555505463, -17.311481768890523, -70.5333538792014, -58.83225580932753, -44.82449898959075, -0.7472652515291358, -55.14795530052003, -32.87553443302707, -63.57716706215374, -24.666189144199393, -76.69181074531423, -35.128714578630294, -56.17524502212698, -28.343449536790825, -50.51323846266961, -53.98340996458748, -35.626362354991365, -54.03428985494836, -53.08404227590963, 0.8642817089226515, -56.95794219654343, -44.788760221806456, -56.27107817702559, -59.265970665929814, 50.55764100224137, -75.29701661479673, -37.25257792612723, -67.81600182035604], "policy_adversary_policy_reward": [-43.83227335925889, -28.85719565849621, 25.239613231358117, 3.069423170887558, -20.874437639881673, -37.199863242357914, -9.557343434877161, -30.742573610428327, -28.69533127427971, -24.499123139275216, -23.276736077697567, -7.412573727067823, -36.73927393569194, -38.66730258406092, -13.334357750993696, -1.7149811407663407, -23.353365694910817, -16.599881813594664, -44.30552379995403, -11.445690069571697, -4.232444652367498, -7.8267169257175695, -38.4661012733535, -32.09268443279881, 33.05447225871576, 0.5342972850612, -16.091162650075432, -35.428214781896706, -29.381497238510974, -29.78058947365962, -20.93773685173653, -39.62867457827103, -13.558870601240258, -19.060026891584407, -48.25599606805353, -62.27045675107258, -4.426601574587686, -3.5885352709675757, -50.68389935269026, -45.57778555814285, -40.896367776597494, -40.99202552180325, -35.757936520946885, -23.97489268162481, -27.47491835185061, -33.70558589701164, -31.008650141620883, -13.99719456037288, -48.38499345763564, -8.96265386607707, -24.781838217107378, -10.758617344747158, -33.044420186275715, -31.44363093354243, -39.25177341230295, -38.019263022344646, -14.37984607241745, -20.774358725129694, 14.778689661032569, 13.472205254668765, -24.145763480797605, -12.720929498258855, 1.279850091165116, 33.991814315515015, -30.615971342341457, -35.540309488846404, -48.499914669120216, -57.15297361535358, -32.46570874356608, -38.153417843928786, -11.420935449859222, -24.61806589475556, 16.053037995615483, 11.869326646050427, -25.51417726755036, -24.829737366172107, -36.212899544274535, -39.34883426323726, -18.644233770519058, -39.97139917411904, -32.04438083908966, -22.10317724509813, -8.292607233997781, -16.053043632342845, -52.97281893144719, -30.940622301652972, -28.835637823949696, -19.05116275707374, -37.53473931031689, -38.82375970852476, 27.224702833246596, -8.342917477965198, -15.916988798352861, -3.326156854182706, 22.451994741931927, 19.08706491810019, -38.36530850352782, -33.75448765449059, 30.63763963013813, 16.98478606160259, -14.604554198740736, -24.458295635929296, -30.149248644219043, -35.763146938670346, 10.766991090399738, 19.656360258165776, -5.440742278464789, -37.05555415848944, -43.582876257738256, -40.756554897456105, -12.802281252396675, -19.921652013508197, -39.99072141468263, -5.918618932776084, -26.822822656750763, -40.184472054802455, -37.14935073793576, -31.702204319113086, -39.85757976649884, -43.16455480417815, -5.436016450235613, 23.640575066802118, -5.0123061689990855, 1.0397483580573095, -9.59301397466811, -10.353924687183607, -29.379516706379402, -48.38425121783045, -17.690661791497597, -37.43444391391549, 3.0882434043295426, -15.94625579495236, -36.01712371740167, -17.311021648723, -10.20599558579515, 6.338001282510376, -33.90077883904313, -32.474050273337845, -33.04838117954122, -7.755869975347991, -24.568120111405406, -27.828885143759603, -34.49267756929279, -32.650691464246144, -1.4895487747032092, -15.826771780802257, -8.007765249260522, -9.303716519630001, -44.54293828991982, -25.990415589281596, -37.95257313510521, -20.879682674222302, -42.10912731317918, -2.7153716764115714, 0.9359962317989456, -1.6832614833280815, -38.98785542802723, -16.1600998724928, -14.368803644060371, -18.5067307889667, -23.205983513460026, -40.37118354869372, -3.327835882002212, -21.33835326219718, -37.705885240930236, -38.98592550438401, -20.774421252214566, -14.354293326415736, -31.22303750756516, -24.95220751456182, -19.255655736600364, -9.087793800190461, -33.169738454771135, -17.343500007898477, -1.3073385102077637, -52.676071454379716, -12.207496573344876, -23.41886578164648, -19.913601545754364, -34.12068830919398, -12.82715596586818, -40.25688631004146, 1.1342318025940195, -0.2699500936713679, -22.36338887924096, -34.594553317302456, -26.558988352544265, -18.229771869262194, -6.548881347931694, -49.7221968290939, -25.452477689604976, -33.81349297632484, 28.937203385758323, 21.620437616483052, -39.45687639158156, -35.8401402232152, -27.19690019760941, -10.055677728517821, -38.07815648930056, -29.737845331055482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.384731904309957, "mean_inference_ms": 0.9552416339426401, "mean_action_processing_ms": 0.16328553271591495, "mean_env_wait_ms": 0.056234758951500805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035876035690307617, "StateBufferConnector_ms": 0.0026323795318603516, "ViewRequirementAgentConnector_ms": 0.06985151767730713}, "num_episodes": 23, "episode_return_max": 101.11528200448275, "episode_return_min": -221.0529056382519, "episode_return_mean": -83.72816519151799}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 475.51585450972385, "num_env_steps_trained_throughput_per_sec": 475.51585450972385, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 1224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 7971.936, "restore_workers_time_ms": 0.018, "training_step_time_ms": 7971.893, "sample_time_ms": 747.219, "learn_time_ms": 7213.75, "learn_throughput": 554.497, "synch_weights_time_ms": 10.499}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "training_iteration": 102, "trial_id": "eaa30_00000", "date": "2024-08-09_17-54-09", "timestamp": 1723240449, "time_this_iter_s": 8.41616415977478, "time_total_s": 832.2381339073181, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17809ee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 832.2381339073181, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 26.525000000000002, "ram_util_percent": 79.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.5681343272880275, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.660801376615252, "policy_loss": 0.0016304785607471352, "vf_loss": 5.656152973225508, "vf_explained_var": -0.0019180385839371453, "kl": 0.017643170028668706, "entropy": 0.9284238644693263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.753470150878032, "cur_kl_coeff": 1.4812312887061698, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.510258047282695, "policy_loss": -0.0012222872785059736, "vf_loss": 7.497276803851127, "vf_explained_var": -0.000909142941236496, "kl": 0.009589007806304532, "entropy": 1.417187799140811, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 98400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "env_runners": {"episode_reward_max": 101.11528200448275, "episode_reward_min": -211.30577656894758, "episode_reward_mean": -79.17668244482594, "episode_len_mean": 188.89, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18889, "policy_reward_min": {"agent_policy": -105.65288828447376, "adversary_policy": -57.15297361535358}, "policy_reward_max": {"agent_policy": 50.55764100224137, "adversary_policy": 33.991814315515015}, "policy_reward_mean": {"agent_policy": -39.58834122241297, "adversary_policy": -19.79417061120649}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-90.0116894039875, -114.69529464742527, -71.08091112370914, -128.97610223963625, -154.54207286929517, -70.30840959509428, 56.50178983140266, -73.73338595811302, 70.54332881336028, -132.31256166237569, -211.30577656894758, -141.23825317498958, -72.07800268922958, 55.84472928333183, -100.68782926744491, -151.12346761502351, -117.23126588927613, -108.29511616837561, -48.69130173268125, -167.8268824662003, -95.77360116204687, -152.71699803768308, 37.76357071056282, -38.48629130507115, 83.07811932006423, -144.2395923160368, 95.24485138348152, -78.1256996693401, -131.82479116577875, 60.84670269713102, -84.99259287390854, -168.6788623103887, -65.44786653180985, -91.81868069491736, -134.01458942310651, -137.70311011409768, -166.04426914135388, 36.40911723313303, -7.945115621883552, -39.893877323703435, -155.52753584841975, -110.25021141082614, -25.716024781245636, -106.65629073224932, -7.735988606569549, -132.7496582247619, -81.60850230977832, -104.79401051033, -134.2867380670777, -34.632641111010926, -34.62296353778105, -141.06670775840266, -117.66451161865511, -89.64899797918153, -1.4945305030582716, -110.29591060104008, -65.75106886605415, -127.1543341243075, -49.332378288398786, -153.3836214906284, -70.25742915726059, -112.35049004425404, -56.68689907358163, -101.02647692533927, -107.96681992917509, -71.25272470998269, -108.06857970989662, -106.1680845518193, 1.728563417845303, -113.91588439308686, -89.57752044361285, -112.5421563540512, -118.5319413318596, 101.11528200448275, -150.59403322959355, -74.50515585225443, -135.632003640712, -28.683848583387345, -103.92244355000139, -65.14110034113293, -130.90456889911377, -109.72985378610565, -93.49096405754253, -167.01334418960374, -22.882253131021983, -97.66599054309407, -142.563348053295, -89.5792780384073, -43.31170720974532, 52.112513545622896, -103.00378448326015, 43.520062602568956, -119.0690229637814, -85.45067455271453, -8.686020056037442, -63.29671157763941, -5.463248909729728, -106.16724436081043, -97.92746131184862, -123.13092024812153], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 38, 200, 200, 200, 200, 154, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 200, 21, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-45.00584470199376, -57.34764732371271, -35.540455561854536, -64.48805111981815, -77.27103643464756, -35.154204797547145, 28.25089491570133, -36.86669297905646, 35.27166440668013, -66.15628083118787, -105.65288828447376, -70.61912658749486, -36.03900134461478, 27.922364641665915, -50.343914633722456, -75.56173380751177, -58.615632944638094, -54.14755808418779, -24.34565086634063, -83.91344123310006, -47.88680058102344, -76.35849901884163, 18.8817853552814, -19.243145652535578, 41.539059660032116, -72.1197961580184, 47.62242569174071, -39.06284983467003, -65.91239558288939, 30.423351348565518, -42.496296436954225, -84.33943115519429, -32.72393326590487, -45.90934034745872, -67.00729471155321, -68.85155505704886, -83.02213457067697, 18.204558616566505, -3.972557810941776, -19.946938661851718, -77.76376792420987, -55.125105705413084, -12.858012390622818, -53.32814536612468, -3.8679943032847746, -66.37482911238095, -40.804251154889215, -52.39700525516502, -67.14336903353885, -17.316320555505463, -17.311481768890523, -70.5333538792014, -58.83225580932753, -44.82449898959075, -0.7472652515291358, -55.14795530052003, -32.87553443302707, -63.57716706215374, -24.666189144199393, -76.69181074531423, -35.128714578630294, -56.17524502212698, -28.343449536790825, -50.51323846266961, -53.98340996458748, -35.626362354991365, -54.03428985494836, -53.08404227590963, 0.8642817089226515, -56.95794219654343, -44.788760221806456, -56.27107817702559, -59.265970665929814, 50.55764100224137, -75.29701661479673, -37.25257792612723, -67.81600182035604, -14.341924291693665, -51.96122177500066, -32.57055017056647, -65.45228444955691, -54.86492689305284, -46.74548202877128, -83.5066720948019, -11.441126565510991, -48.83299527154704, -71.28167402664738, -44.78963901920362, -21.65585360487266, 26.05625677281144, -51.50189224163001, 21.760031301284464, -59.53451148189069, -42.72533727635731, -4.343010028018721, -31.648355788819703, -2.731624454864864, -53.0836221804052, -48.963730655924316, -61.565460124060664], "policy_adversary_policy_reward": [-31.008650141620883, -13.99719456037288, -48.38499345763564, -8.96265386607707, -24.781838217107378, -10.758617344747158, -33.044420186275715, -31.44363093354243, -39.25177341230295, -38.019263022344646, -14.37984607241745, -20.774358725129694, 14.778689661032569, 13.472205254668765, -24.145763480797605, -12.720929498258855, 1.279850091165116, 33.991814315515015, -30.615971342341457, -35.540309488846404, -48.499914669120216, -57.15297361535358, -32.46570874356608, -38.153417843928786, -11.420935449859222, -24.61806589475556, 16.053037995615483, 11.869326646050427, -25.51417726755036, -24.829737366172107, -36.212899544274535, -39.34883426323726, -18.644233770519058, -39.97139917411904, -32.04438083908966, -22.10317724509813, -8.292607233997781, -16.053043632342845, -52.97281893144719, -30.940622301652972, -28.835637823949696, -19.05116275707374, -37.53473931031689, -38.82375970852476, 27.224702833246596, -8.342917477965198, -15.916988798352861, -3.326156854182706, 22.451994741931927, 19.08706491810019, -38.36530850352782, -33.75448765449059, 30.63763963013813, 16.98478606160259, -14.604554198740736, -24.458295635929296, -30.149248644219043, -35.763146938670346, 10.766991090399738, 19.656360258165776, -5.440742278464789, -37.05555415848944, -43.582876257738256, -40.756554897456105, -12.802281252396675, -19.921652013508197, -39.99072141468263, -5.918618932776084, -26.822822656750763, -40.184472054802455, -37.14935073793576, -31.702204319113086, -39.85757976649884, -43.16455480417815, -5.436016450235613, 23.640575066802118, -5.0123061689990855, 1.0397483580573095, -9.59301397466811, -10.353924687183607, -29.379516706379402, -48.38425121783045, -17.690661791497597, -37.43444391391549, 3.0882434043295426, -15.94625579495236, -36.01712371740167, -17.311021648723, -10.20599558579515, 6.338001282510376, -33.90077883904313, -32.474050273337845, -33.04838117954122, -7.755869975347991, -24.568120111405406, -27.828885143759603, -34.49267756929279, -32.650691464246144, -1.4895487747032092, -15.826771780802257, -8.007765249260522, -9.303716519630001, -44.54293828991982, -25.990415589281596, -37.95257313510521, -20.879682674222302, -42.10912731317918, -2.7153716764115714, 0.9359962317989456, -1.6832614833280815, -38.98785542802723, -16.1600998724928, -14.368803644060371, -18.5067307889667, -23.205983513460026, -40.37118354869372, -3.327835882002212, -21.33835326219718, -37.705885240930236, -38.98592550438401, -20.774421252214566, -14.354293326415736, -31.22303750756516, -24.95220751456182, -19.255655736600364, -9.087793800190461, -33.169738454771135, -17.343500007898477, -1.3073385102077637, -52.676071454379716, -12.207496573344876, -23.41886578164648, -19.913601545754364, -34.12068830919398, -12.82715596586818, -40.25688631004146, 1.1342318025940195, -0.2699500936713679, -22.36338887924096, -34.594553317302456, -26.558988352544265, -18.229771869262194, -6.548881347931694, -49.7221968290939, -25.452477689604976, -33.81349297632484, 28.937203385758323, 21.620437616483052, -39.45687639158156, -35.8401402232152, -27.19690019760941, -10.055677728517821, -38.07815648930056, -29.737845331055482, -5.768681629739973, -8.573242661953696, -10.725000171627535, -41.23622160337312, -17.082501469698588, -15.488048700867889, -45.18722597132746, -20.26505847822945, -34.858797976605196, -20.006128916447643, -27.67039220996726, -19.075089818804013, -42.63280124239559, -40.8738708524063, -17.93283759527646, 6.491711029765469, -16.7559929068953, -32.07700236465173, -43.87199150733771, -27.409682519309683, -3.0100108807160737, -41.77962813848754, -13.405868204222248, -8.249985400650413, 22.236788501174733, 3.8194682716367083, -36.39265267100827, -15.109239570621732, 12.161512388556034, 9.59851891272843, -36.10630363343203, -23.42820784845867, -1.8708133127107516, -40.854523963646564, 3.925079686087088, -8.268089714105809, -28.313157835664317, -3.3351979531553866, 11.797288693255577, -14.528913148120441, -22.364912108608795, -30.71871007179641, -25.112592054151403, -23.851138601772917, -30.615175081881915, -30.950285042178777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38503008824414164, "mean_inference_ms": 0.9567877870022808, "mean_action_processing_ms": 0.1633615344389057, "mean_env_wait_ms": 0.05626230413462094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003510713577270508, "StateBufferConnector_ms": 0.002637028694152832, "ViewRequirementAgentConnector_ms": 0.07032501697540283}, "num_episodes": 23, "episode_return_max": 101.11528200448275, "episode_return_min": -211.30577656894758, "episode_return_mean": -79.17668244482594}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 450.1058688923436, "num_env_steps_trained_throughput_per_sec": 450.1058688923436, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 1236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1236000, "timers": {"training_iteration_time_ms": 8072.924, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8072.881, "sample_time_ms": 755.027, "learn_time_ms": 7306.908, "learn_throughput": 547.427, "synch_weights_time_ms": 10.512}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "done": false, "training_iteration": 103, "trial_id": "eaa30_00000", "date": "2024-08-09_17-54-19", "timestamp": 1723240459, "time_this_iter_s": 8.905356645584106, "time_total_s": 841.1434905529022, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2857af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 841.1434905529022, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 30.06153846153847, "ram_util_percent": 79.76923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.709227092303927, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.801693802031259, "policy_loss": -0.006061915449660133, "vf_loss": 4.804543570740513, "vf_explained_var": 0.15553215811492274, "kl": 0.01877867811847301, "entropy": 0.926995029808983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.610432604203622, "cur_kl_coeff": 1.4812312887061698, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.71745753834645, "policy_loss": -0.0038199758685853644, "vf_loss": 6.705512945353985, "vf_explained_var": 0.18286783931156, "kl": 0.010642866417280553, "entropy": 1.3999309100210666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 99360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 101.11528200448275, "episode_reward_min": -168.6788623103887, "episode_reward_mean": -73.84476996485401, "episode_len_mean": 190.97, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19097, "policy_reward_min": {"agent_policy": -84.33943115519429, "adversary_policy": -52.97281893144719}, "policy_reward_max": {"agent_policy": 50.55764100224137, "adversary_policy": 30.63763963013813}, "policy_reward_mean": {"agent_policy": -36.922384982427005, "adversary_policy": -18.461192491213506}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.8268824662003, -95.77360116204687, -152.71699803768308, 37.76357071056282, -38.48629130507115, 83.07811932006423, -144.2395923160368, 95.24485138348152, -78.1256996693401, -131.82479116577875, 60.84670269713102, -84.99259287390854, -168.6788623103887, -65.44786653180985, -91.81868069491736, -134.01458942310651, -137.70311011409768, -166.04426914135388, 36.40911723313303, -7.945115621883552, -39.893877323703435, -155.52753584841975, -110.25021141082614, -25.716024781245636, -106.65629073224932, -7.735988606569549, -132.7496582247619, -81.60850230977832, -104.79401051033, -134.2867380670777, -34.632641111010926, -34.62296353778105, -141.06670775840266, -117.66451161865511, -89.64899797918153, -1.4945305030582716, -110.29591060104008, -65.75106886605415, -127.1543341243075, -49.332378288398786, -153.3836214906284, -70.25742915726059, -112.35049004425404, -56.68689907358163, -101.02647692533927, -107.96681992917509, -71.25272470998269, -108.06857970989662, -106.1680845518193, 1.728563417845303, -113.91588439308686, -89.57752044361285, -112.5421563540512, -118.5319413318596, 101.11528200448275, -150.59403322959355, -74.50515585225443, -135.632003640712, -28.683848583387345, -103.92244355000139, -65.14110034113293, -130.90456889911377, -109.72985378610565, -93.49096405754253, -167.01334418960374, -22.882253131021983, -97.66599054309407, -142.563348053295, -89.5792780384073, -43.31170720974532, 52.112513545622896, -103.00378448326015, 43.520062602568956, -119.0690229637814, -85.45067455271453, -8.686020056037442, -63.29671157763941, -5.463248909729728, -106.16724436081043, -97.92746131184862, -123.13092024812153, 11.742810774677015, -121.57511890278164, 19.646931227747025, -79.73607260455191, -19.716956159396496, -82.53980804338562, -75.17481495874952, -89.97155594379221, -127.3658322790304, -125.68177410132387, -11.058227652421209, -78.68821598861481, -3.9158486470755918, -54.96836160432824, 50.15876618870465, -138.1333933471622, -85.45842465910877, -63.54508741708031, 5.75063943735708], "episode_lengths": [200, 200, 200, 200, 200, 18, 200, 200, 200, 200, 21, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-83.91344123310006, -47.88680058102344, -76.35849901884163, 18.8817853552814, -19.243145652535578, 41.539059660032116, -72.1197961580184, 47.62242569174071, -39.06284983467003, -65.91239558288939, 30.423351348565518, -42.496296436954225, -84.33943115519429, -32.72393326590487, -45.90934034745872, -67.00729471155321, -68.85155505704886, -83.02213457067697, 18.204558616566505, -3.972557810941776, -19.946938661851718, -77.76376792420987, -55.125105705413084, -12.858012390622818, -53.32814536612468, -3.8679943032847746, -66.37482911238095, -40.804251154889215, -52.39700525516502, -67.14336903353885, -17.316320555505463, -17.311481768890523, -70.5333538792014, -58.83225580932753, -44.82449898959075, -0.7472652515291358, -55.14795530052003, -32.87553443302707, -63.57716706215374, -24.666189144199393, -76.69181074531423, -35.128714578630294, -56.17524502212698, -28.343449536790825, -50.51323846266961, -53.98340996458748, -35.626362354991365, -54.03428985494836, -53.08404227590963, 0.8642817089226515, -56.95794219654343, -44.788760221806456, -56.27107817702559, -59.265970665929814, 50.55764100224137, -75.29701661479673, -37.25257792612723, -67.81600182035604, -14.341924291693665, -51.96122177500066, -32.57055017056647, -65.45228444955691, -54.86492689305284, -46.74548202877128, -83.5066720948019, -11.441126565510991, -48.83299527154704, -71.28167402664738, -44.78963901920362, -21.65585360487266, 26.05625677281144, -51.50189224163001, 21.760031301284464, -59.53451148189069, -42.72533727635731, -4.343010028018721, -31.648355788819703, -2.731624454864864, -53.0836221804052, -48.963730655924316, -61.565460124060664, 5.871405387338523, -60.78755945139076, 9.823465613873545, -39.86803630227599, -9.858478079698251, -41.269904021692746, -37.58740747937471, -44.98577797189604, -63.682916139515235, -62.84088705066195, -5.529113826210587, -39.34410799430739, -1.9579243235377959, -27.484180802164097, 25.079383094352337, -69.06669667358118, -42.72921232955435, -31.772543708540155, 2.8753197186785293], "policy_adversary_policy_reward": [-52.97281893144719, -30.940622301652972, -28.835637823949696, -19.05116275707374, -37.53473931031689, -38.82375970852476, 27.224702833246596, -8.342917477965198, -15.916988798352861, -3.326156854182706, 22.451994741931927, 19.08706491810019, -38.36530850352782, -33.75448765449059, 30.63763963013813, 16.98478606160259, -14.604554198740736, -24.458295635929296, -30.149248644219043, -35.763146938670346, 10.766991090399738, 19.656360258165776, -5.440742278464789, -37.05555415848944, -43.582876257738256, -40.756554897456105, -12.802281252396675, -19.921652013508197, -39.99072141468263, -5.918618932776084, -26.822822656750763, -40.184472054802455, -37.14935073793576, -31.702204319113086, -39.85757976649884, -43.16455480417815, -5.436016450235613, 23.640575066802118, -5.0123061689990855, 1.0397483580573095, -9.59301397466811, -10.353924687183607, -29.379516706379402, -48.38425121783045, -17.690661791497597, -37.43444391391549, 3.0882434043295426, -15.94625579495236, -36.01712371740167, -17.311021648723, -10.20599558579515, 6.338001282510376, -33.90077883904313, -32.474050273337845, -33.04838117954122, -7.755869975347991, -24.568120111405406, -27.828885143759603, -34.49267756929279, -32.650691464246144, -1.4895487747032092, -15.826771780802257, -8.007765249260522, -9.303716519630001, -44.54293828991982, -25.990415589281596, -37.95257313510521, -20.879682674222302, -42.10912731317918, -2.7153716764115714, 0.9359962317989456, -1.6832614833280815, -38.98785542802723, -16.1600998724928, -14.368803644060371, -18.5067307889667, -23.205983513460026, -40.37118354869372, -3.327835882002212, -21.33835326219718, -37.705885240930236, -38.98592550438401, -20.774421252214566, -14.354293326415736, -31.22303750756516, -24.95220751456182, -19.255655736600364, -9.087793800190461, -33.169738454771135, -17.343500007898477, -1.3073385102077637, -52.676071454379716, -12.207496573344876, -23.41886578164648, -19.913601545754364, -34.12068830919398, -12.82715596586818, -40.25688631004146, 1.1342318025940195, -0.2699500936713679, -22.36338887924096, -34.594553317302456, -26.558988352544265, -18.229771869262194, -6.548881347931694, -49.7221968290939, -25.452477689604976, -33.81349297632484, 28.937203385758323, 21.620437616483052, -39.45687639158156, -35.8401402232152, -27.19690019760941, -10.055677728517821, -38.07815648930056, -29.737845331055482, -5.768681629739973, -8.573242661953696, -10.725000171627535, -41.23622160337312, -17.082501469698588, -15.488048700867889, -45.18722597132746, -20.26505847822945, -34.858797976605196, -20.006128916447643, -27.67039220996726, -19.075089818804013, -42.63280124239559, -40.8738708524063, -17.93283759527646, 6.491711029765469, -16.7559929068953, -32.07700236465173, -43.87199150733771, -27.409682519309683, -3.0100108807160737, -41.77962813848754, -13.405868204222248, -8.249985400650413, 22.236788501174733, 3.8194682716367083, -36.39265267100827, -15.109239570621732, 12.161512388556034, 9.59851891272843, -36.10630363343203, -23.42820784845867, -1.8708133127107516, -40.854523963646564, 3.925079686087088, -8.268089714105809, -28.313157835664317, -3.3351979531553866, 11.797288693255577, -14.528913148120441, -22.364912108608795, -30.71871007179641, -25.112592054151403, -23.851138601772917, -30.615175081881915, -30.950285042178777, 3.420969269663015, 2.4504361176754976, -37.179350638620164, -23.6082088127706, -3.80143192482768, 13.624897538701216, -22.48142165098197, -17.386614651294018, -8.922709624091823, -0.9357684556064285, -30.69481217865176, -10.575091843040987, -16.8460251631259, -20.741382316248806, -25.862494737242844, -19.123283234653197, -34.325932195902666, -29.35698394361258, -40.358636869883156, -22.482250180778777, 3.5522572212809056, -9.081371047491498, -9.921032503809982, -29.423075490497396, -11.656966141613346, 9.69904181807555, -20.707239437209502, -6.776941364954595, 21.961019715224957, 3.118363379127352, -32.86538064942686, -36.20131602415429, -21.63467433198116, -21.094537997573195, -32.82157558021847, 1.0490318716783094, -21.300818313302166, 24.176138031980717]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3854297813713002, "mean_inference_ms": 0.9567472577050683, "mean_action_processing_ms": 0.163554055892366, "mean_env_wait_ms": 0.056389355953454984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035026073455810547, "StateBufferConnector_ms": 0.0026322603225708008, "ViewRequirementAgentConnector_ms": 0.07167458534240723}, "num_episodes": 19, "episode_return_max": 101.11528200448275, "episode_return_min": -168.6788623103887, "episode_return_mean": -73.84476996485401}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 477.18643328965794, "num_env_steps_trained_throughput_per_sec": 477.18643328965794, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 8123.709, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8123.666, "sample_time_ms": 767.305, "learn_time_ms": 7345.423, "learn_throughput": 544.557, "synch_weights_time_ms": 10.501}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 104, "trial_id": "eaa30_00000", "date": "2024-08-09_17-54-27", "timestamp": 1723240467, "time_this_iter_s": 8.38734221458435, "time_total_s": 849.5308327674866, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2857ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 849.5308327674866, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 25.433333333333337, "ram_util_percent": 81.12500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.18570864251051, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.401844201769148, "policy_loss": -0.0026417516067220024, "vf_loss": 5.401995853898386, "vf_explained_var": 0.018352467010891625, "kl": 0.014557526487531879, "entropy": 0.9239831811221189, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.607738920797904, "cur_kl_coeff": 1.4812312887061698, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.000199458003044, "policy_loss": -0.0035080948286728623, "vf_loss": 6.989267610510191, "vf_explained_var": 0.10012269367774328, "kl": 0.009748613016563467, "entropy": 1.42323719051977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 100320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "env_runners": {"episode_reward_max": 101.11528200448275, "episode_reward_min": -168.01119478508457, "episode_reward_mean": -76.60737141812552, "episode_len_mean": 192.86, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19286, "policy_reward_min": {"agent_policy": -84.00559739254233, "adversary_policy": -54.916712426764725}, "policy_reward_max": {"agent_policy": 50.55764100224137, "adversary_policy": 28.937203385758323}, "policy_reward_mean": {"agent_policy": -38.30368570906276, "adversary_policy": -19.15184285453138}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.893877323703435, -155.52753584841975, -110.25021141082614, -25.716024781245636, -106.65629073224932, -7.735988606569549, -132.7496582247619, -81.60850230977832, -104.79401051033, -134.2867380670777, -34.632641111010926, -34.62296353778105, -141.06670775840266, -117.66451161865511, -89.64899797918153, -1.4945305030582716, -110.29591060104008, -65.75106886605415, -127.1543341243075, -49.332378288398786, -153.3836214906284, -70.25742915726059, -112.35049004425404, -56.68689907358163, -101.02647692533927, -107.96681992917509, -71.25272470998269, -108.06857970989662, -106.1680845518193, 1.728563417845303, -113.91588439308686, -89.57752044361285, -112.5421563540512, -118.5319413318596, 101.11528200448275, -150.59403322959355, -74.50515585225443, -135.632003640712, -28.683848583387345, -103.92244355000139, -65.14110034113293, -130.90456889911377, -109.72985378610565, -93.49096405754253, -167.01334418960374, -22.882253131021983, -97.66599054309407, -142.563348053295, -89.5792780384073, -43.31170720974532, 52.112513545622896, -103.00378448326015, 43.520062602568956, -119.0690229637814, -85.45067455271453, -8.686020056037442, -63.29671157763941, -5.463248909729728, -106.16724436081043, -97.92746131184862, -123.13092024812153, 11.742810774677015, -121.57511890278164, 19.646931227747025, -79.73607260455191, -19.716956159396496, -82.53980804338562, -75.17481495874952, -89.97155594379221, -127.3658322790304, -125.68177410132387, -11.058227652421209, -78.68821598861481, -3.9158486470755918, -54.96836160432824, 50.15876618870465, -138.1333933471622, -85.45842465910877, -63.54508741708031, 5.75063943735708, -54.282470269988806, -48.62350720170822, -43.09769374395436, -81.47201963493868, -59.934833089553166, -142.9966848984975, -152.86696111211006, -82.01463900601996, -168.01119478508457, -3.1785779306037387, -100.24239190212214, -114.84317790433738, -93.71585769703898, -96.80638962789723, -87.21830210926308, -127.76911841895523, -111.15755229208685, -52.72414026954209, 48.79792154318888, -56.39913646588915], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200], "policy_agent_policy_reward": [-19.946938661851718, -77.76376792420987, -55.125105705413084, -12.858012390622818, -53.32814536612468, -3.8679943032847746, -66.37482911238095, -40.804251154889215, -52.39700525516502, -67.14336903353885, -17.316320555505463, -17.311481768890523, -70.5333538792014, -58.83225580932753, -44.82449898959075, -0.7472652515291358, -55.14795530052003, -32.87553443302707, -63.57716706215374, -24.666189144199393, -76.69181074531423, -35.128714578630294, -56.17524502212698, -28.343449536790825, -50.51323846266961, -53.98340996458748, -35.626362354991365, -54.03428985494836, -53.08404227590963, 0.8642817089226515, -56.95794219654343, -44.788760221806456, -56.27107817702559, -59.265970665929814, 50.55764100224137, -75.29701661479673, -37.25257792612723, -67.81600182035604, -14.341924291693665, -51.96122177500066, -32.57055017056647, -65.45228444955691, -54.86492689305284, -46.74548202877128, -83.5066720948019, -11.441126565510991, -48.83299527154704, -71.28167402664738, -44.78963901920362, -21.65585360487266, 26.05625677281144, -51.50189224163001, 21.760031301284464, -59.53451148189069, -42.72533727635731, -4.343010028018721, -31.648355788819703, -2.731624454864864, -53.0836221804052, -48.963730655924316, -61.565460124060664, 5.871405387338523, -60.78755945139076, 9.823465613873545, -39.86803630227599, -9.858478079698251, -41.269904021692746, -37.58740747937471, -44.98577797189604, -63.682916139515235, -62.84088705066195, -5.529113826210587, -39.34410799430739, -1.9579243235377959, -27.484180802164097, 25.079383094352337, -69.06669667358118, -42.72921232955435, -31.772543708540155, 2.8753197186785293, -27.141235134994403, -24.31175360085411, -21.548846871977158, -40.73600981746934, -29.967416544776547, -71.49834244924872, -76.433480556055, -41.00731950301004, -84.00559739254233, -1.5892889653018756, -50.121195951061104, -57.421588952168705, -46.85792884851953, -48.40319481394867, -43.609151054631546, -63.88455920947757, -55.57877614604337, -26.362070134771045, 24.39896077159443, -28.19956823294458], "policy_adversary_policy_reward": [-9.59301397466811, -10.353924687183607, -29.379516706379402, -48.38425121783045, -17.690661791497597, -37.43444391391549, 3.0882434043295426, -15.94625579495236, -36.01712371740167, -17.311021648723, -10.20599558579515, 6.338001282510376, -33.90077883904313, -32.474050273337845, -33.04838117954122, -7.755869975347991, -24.568120111405406, -27.828885143759603, -34.49267756929279, -32.650691464246144, -1.4895487747032092, -15.826771780802257, -8.007765249260522, -9.303716519630001, -44.54293828991982, -25.990415589281596, -37.95257313510521, -20.879682674222302, -42.10912731317918, -2.7153716764115714, 0.9359962317989456, -1.6832614833280815, -38.98785542802723, -16.1600998724928, -14.368803644060371, -18.5067307889667, -23.205983513460026, -40.37118354869372, -3.327835882002212, -21.33835326219718, -37.705885240930236, -38.98592550438401, -20.774421252214566, -14.354293326415736, -31.22303750756516, -24.95220751456182, -19.255655736600364, -9.087793800190461, -33.169738454771135, -17.343500007898477, -1.3073385102077637, -52.676071454379716, -12.207496573344876, -23.41886578164648, -19.913601545754364, -34.12068830919398, -12.82715596586818, -40.25688631004146, 1.1342318025940195, -0.2699500936713679, -22.36338887924096, -34.594553317302456, -26.558988352544265, -18.229771869262194, -6.548881347931694, -49.7221968290939, -25.452477689604976, -33.81349297632484, 28.937203385758323, 21.620437616483052, -39.45687639158156, -35.8401402232152, -27.19690019760941, -10.055677728517821, -38.07815648930056, -29.737845331055482, -5.768681629739973, -8.573242661953696, -10.725000171627535, -41.23622160337312, -17.082501469698588, -15.488048700867889, -45.18722597132746, -20.26505847822945, -34.858797976605196, -20.006128916447643, -27.67039220996726, -19.075089818804013, -42.63280124239559, -40.8738708524063, -17.93283759527646, 6.491711029765469, -16.7559929068953, -32.07700236465173, -43.87199150733771, -27.409682519309683, -3.0100108807160737, -41.77962813848754, -13.405868204222248, -8.249985400650413, 22.236788501174733, 3.8194682716367083, -36.39265267100827, -15.109239570621732, 12.161512388556034, 9.59851891272843, -36.10630363343203, -23.42820784845867, -1.8708133127107516, -40.854523963646564, 3.925079686087088, -8.268089714105809, -28.313157835664317, -3.3351979531553866, 11.797288693255577, -14.528913148120441, -22.364912108608795, -30.71871007179641, -25.112592054151403, -23.851138601772917, -30.615175081881915, -30.950285042178777, 3.420969269663015, 2.4504361176754976, -37.179350638620164, -23.6082088127706, -3.80143192482768, 13.624897538701216, -22.48142165098197, -17.386614651294018, -8.922709624091823, -0.9357684556064285, -30.69481217865176, -10.575091843040987, -16.8460251631259, -20.741382316248806, -25.862494737242844, -19.123283234653197, -34.325932195902666, -29.35698394361258, -40.358636869883156, -22.482250180778777, 3.5522572212809056, -9.081371047491498, -9.921032503809982, -29.423075490497396, -11.656966141613346, 9.69904181807555, -20.707239437209502, -6.776941364954595, 21.961019715224957, 3.118363379127352, -32.86538064942686, -36.20131602415429, -21.63467433198116, -21.094537997573195, -32.82157558021847, 1.0490318716783094, -21.300818313302166, 24.176138031980717, -6.152494487821208, -20.988740647173195, -5.101710551900588, -19.21004304895352, -2.382380137414568, -19.166466734562594, -34.157324057519745, -6.578685759949586, -15.044400541816714, -14.923016002959837, -38.62702184642937, -32.87132060281938, -54.916712426764725, -21.516768129290273, -34.91368573299139, -6.0936337700186485, -45.55739614767696, -38.44820124486532, 8.96970648348395, -10.558995448785826, -26.374970721477318, -23.74622522958379, -14.225387774952658, -43.19620117721604, -16.421463689352198, -30.436465159167334, -29.793171551797414, -18.610023262151252, -21.82942987395638, -21.779721180675175, -20.483367912590648, -43.401191296886914, -35.30833161699966, -20.27044452904371, -6.325171656163263, -20.03689847860778, 2.153525203993679, 22.24543556760075, -12.962281255026546, -15.237286977918032]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3857813042126919, "mean_inference_ms": 0.9578173612646096, "mean_action_processing_ms": 0.1637126076052449, "mean_env_wait_ms": 0.05648545175365831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003542304039001465, "StateBufferConnector_ms": 0.0026705265045166016, "ViewRequirementAgentConnector_ms": 0.07309126853942871}, "num_episodes": 20, "episode_return_max": 101.11528200448275, "episode_return_min": -168.01119478508457, "episode_return_mean": -76.60737141812552}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.374239523449, "num_env_steps_trained_throughput_per_sec": 496.374239523449, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 1260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 8143.749, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8143.705, "sample_time_ms": 771.189, "learn_time_ms": 7361.657, "learn_throughput": 543.356, "synch_weights_time_ms": 10.426}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "training_iteration": 105, "trial_id": "eaa30_00000", "date": "2024-08-09_17-54-35", "timestamp": 1723240475, "time_this_iter_s": 8.06259274482727, "time_total_s": 857.5934255123138, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2857f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 857.5934255123138, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 21.991666666666664, "ram_util_percent": 81.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.377637333466263, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.986708347381107, "policy_loss": -0.0016354942948079456, "vf_loss": 4.985321475462939, "vf_explained_var": 0.05549970291278981, "kl": 0.017669252696984186, "entropy": 0.9450941304365794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.044343567763765, "cur_kl_coeff": 1.4812312887061698, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.974928004046281, "policy_loss": 0.0014095780182591018, "vf_loss": 6.959476515650749, "vf_explained_var": 0.023498391546308995, "kl": 0.009479888857943783, "entropy": 1.4169396455089251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 101280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "env_runners": {"episode_reward_max": 101.11528200448275, "episode_reward_min": -169.1146555052282, "episode_reward_mean": -73.55172672916429, "episode_len_mean": 185.38, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 18538, "policy_reward_min": {"agent_policy": -84.55732775261414, "adversary_policy": -56.40319523953574}, "policy_reward_max": {"agent_policy": 50.55764100224137, "adversary_policy": 28.937203385758323}, "policy_reward_mean": {"agent_policy": -36.775863364582136, "adversary_policy": -18.38793168229107}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.02647692533927, -107.96681992917509, -71.25272470998269, -108.06857970989662, -106.1680845518193, 1.728563417845303, -113.91588439308686, -89.57752044361285, -112.5421563540512, -118.5319413318596, 101.11528200448275, -150.59403322959355, -74.50515585225443, -135.632003640712, -28.683848583387345, -103.92244355000139, -65.14110034113293, -130.90456889911377, -109.72985378610565, -93.49096405754253, -167.01334418960374, -22.882253131021983, -97.66599054309407, -142.563348053295, -89.5792780384073, -43.31170720974532, 52.112513545622896, -103.00378448326015, 43.520062602568956, -119.0690229637814, -85.45067455271453, -8.686020056037442, -63.29671157763941, -5.463248909729728, -106.16724436081043, -97.92746131184862, -123.13092024812153, 11.742810774677015, -121.57511890278164, 19.646931227747025, -79.73607260455191, -19.716956159396496, -82.53980804338562, -75.17481495874952, -89.97155594379221, -127.3658322790304, -125.68177410132387, -11.058227652421209, -78.68821598861481, -3.9158486470755918, -54.96836160432824, 50.15876618870465, -138.1333933471622, -85.45842465910877, -63.54508741708031, 5.75063943735708, -54.282470269988806, -48.62350720170822, -43.09769374395436, -81.47201963493868, -59.934833089553166, -142.9966848984975, -152.86696111211006, -82.01463900601996, -168.01119478508457, -3.1785779306037387, -100.24239190212214, -114.84317790433738, -93.71585769703898, -96.80638962789723, -87.21830210926308, -127.76911841895523, -111.15755229208685, -52.72414026954209, 48.79792154318888, -56.39913646588915, -169.1146555052282, -60.68416714839082, -97.37821960842562, -88.67532473625093, -35.44043328503133, -107.09405468886257, 8.089183139929427, 26.96395592013425, -94.27048212303876, -83.04402776690415, -151.45147317194647, -110.94691803386002, -101.65932566610078, -114.21168448347748, -58.34599132562363, 34.40073870788227, -120.36174424575677, -15.738952660789707, -103.06408820992787, -139.6546817380595, -109.95616235548269, -72.32988003579277, -1.9826538944131755, 7.95418984296488], "episode_lengths": [200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 14, 14, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 13], "policy_agent_policy_reward": [-50.51323846266961, -53.98340996458748, -35.626362354991365, -54.03428985494836, -53.08404227590963, 0.8642817089226515, -56.95794219654343, -44.788760221806456, -56.27107817702559, -59.265970665929814, 50.55764100224137, -75.29701661479673, -37.25257792612723, -67.81600182035604, -14.341924291693665, -51.96122177500066, -32.57055017056647, -65.45228444955691, -54.86492689305284, -46.74548202877128, -83.5066720948019, -11.441126565510991, -48.83299527154704, -71.28167402664738, -44.78963901920362, -21.65585360487266, 26.05625677281144, -51.50189224163001, 21.760031301284464, -59.53451148189069, -42.72533727635731, -4.343010028018721, -31.648355788819703, -2.731624454864864, -53.0836221804052, -48.963730655924316, -61.565460124060664, 5.871405387338523, -60.78755945139076, 9.823465613873545, -39.86803630227599, -9.858478079698251, -41.269904021692746, -37.58740747937471, -44.98577797189604, -63.682916139515235, -62.84088705066195, -5.529113826210587, -39.34410799430739, -1.9579243235377959, -27.484180802164097, 25.079383094352337, -69.06669667358118, -42.72921232955435, -31.772543708540155, 2.8753197186785293, -27.141235134994403, -24.31175360085411, -21.548846871977158, -40.73600981746934, -29.967416544776547, -71.49834244924872, -76.433480556055, -41.00731950301004, -84.00559739254233, -1.5892889653018756, -50.121195951061104, -57.421588952168705, -46.85792884851953, -48.40319481394867, -43.609151054631546, -63.88455920947757, -55.57877614604337, -26.362070134771045, 24.39896077159443, -28.19956823294458, -84.55732775261414, -30.3420835741954, -48.68910980421289, -44.33766236812546, -17.720216642515666, -53.547027344431285, 4.044591569964714, 13.481977960067125, -47.13524106151939, -41.5220138834521, -75.72573658597327, -55.47345901692998, -50.829662833050385, -57.1058422417387, -29.172995662811815, 17.20036935394113, -60.18087212287839, -7.869476330394853, -51.532044104963916, -69.82734086902963, -54.978081177741245, -36.16494001789639, -0.9913269472066357, 3.977094921482441], "policy_adversary_policy_reward": [-33.169738454771135, -17.343500007898477, -1.3073385102077637, -52.676071454379716, -12.207496573344876, -23.41886578164648, -19.913601545754364, -34.12068830919398, -12.82715596586818, -40.25688631004146, 1.1342318025940195, -0.2699500936713679, -22.36338887924096, -34.594553317302456, -26.558988352544265, -18.229771869262194, -6.548881347931694, -49.7221968290939, -25.452477689604976, -33.81349297632484, 28.937203385758323, 21.620437616483052, -39.45687639158156, -35.8401402232152, -27.19690019760941, -10.055677728517821, -38.07815648930056, -29.737845331055482, -5.768681629739973, -8.573242661953696, -10.725000171627535, -41.23622160337312, -17.082501469698588, -15.488048700867889, -45.18722597132746, -20.26505847822945, -34.858797976605196, -20.006128916447643, -27.67039220996726, -19.075089818804013, -42.63280124239559, -40.8738708524063, -17.93283759527646, 6.491711029765469, -16.7559929068953, -32.07700236465173, -43.87199150733771, -27.409682519309683, -3.0100108807160737, -41.77962813848754, -13.405868204222248, -8.249985400650413, 22.236788501174733, 3.8194682716367083, -36.39265267100827, -15.109239570621732, 12.161512388556034, 9.59851891272843, -36.10630363343203, -23.42820784845867, -1.8708133127107516, -40.854523963646564, 3.925079686087088, -8.268089714105809, -28.313157835664317, -3.3351979531553866, 11.797288693255577, -14.528913148120441, -22.364912108608795, -30.71871007179641, -25.112592054151403, -23.851138601772917, -30.615175081881915, -30.950285042178777, 3.420969269663015, 2.4504361176754976, -37.179350638620164, -23.6082088127706, -3.80143192482768, 13.624897538701216, -22.48142165098197, -17.386614651294018, -8.922709624091823, -0.9357684556064285, -30.69481217865176, -10.575091843040987, -16.8460251631259, -20.741382316248806, -25.862494737242844, -19.123283234653197, -34.325932195902666, -29.35698394361258, -40.358636869883156, -22.482250180778777, 3.5522572212809056, -9.081371047491498, -9.921032503809982, -29.423075490497396, -11.656966141613346, 9.69904181807555, -20.707239437209502, -6.776941364954595, 21.961019715224957, 3.118363379127352, -32.86538064942686, -36.20131602415429, -21.63467433198116, -21.094537997573195, -32.82157558021847, 1.0490318716783094, -21.300818313302166, 24.176138031980717, -6.152494487821208, -20.988740647173195, -5.101710551900588, -19.21004304895352, -2.382380137414568, -19.166466734562594, -34.157324057519745, -6.578685759949586, -15.044400541816714, -14.923016002959837, -38.62702184642937, -32.87132060281938, -54.916712426764725, -21.516768129290273, -34.91368573299139, -6.0936337700186485, -45.55739614767696, -38.44820124486532, 8.96970648348395, -10.558995448785826, -26.374970721477318, -23.74622522958379, -14.225387774952658, -43.19620117721604, -16.421463689352198, -30.436465159167334, -29.793171551797414, -18.610023262151252, -21.82942987395638, -21.779721180675175, -20.483367912590648, -43.401191296886914, -35.30833161699966, -20.27044452904371, -6.325171656163263, -20.03689847860778, 2.153525203993679, 22.24543556760075, -12.962281255026546, -15.237286977918032, -40.1031508989852, -44.45417685362894, -8.583514462507644, -21.758569111687756, -30.044456955837983, -18.64465284837491, -22.607683388672243, -21.729978979453218, -8.89110326945552, -8.829113373060146, -29.36430948994564, -24.18271785448564, -3.3238579405298836, 7.368449510494596, -0.5560034562169385, 14.037981416284063, -10.562134575529633, -36.57310648598976, -9.28504520792033, -32.23696867553177, -24.61411979546532, -51.111616790507966, -28.362540285381964, -27.11091873154801, -47.668858119524984, -3.1608047135254083, -21.56559459243332, -35.540247649305385, -13.279689224516723, -15.893306438295092, 9.398425356621914, 7.801943997319217, -21.083141429405515, -39.097730693472876, -11.785176156252831, 3.9156998258579776, -16.675346490529037, -34.85669761443488, -56.40319523953574, -13.42414562949395, -28.576820022141284, -26.401261155599983, -19.4820519306935, -16.68288808720289, 16.471560303479524, -17.462887250686155, -3.0100115980412063, 6.987106519523647]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.386029860940989, "mean_inference_ms": 0.9585466469968015, "mean_action_processing_ms": 0.1637379782427272, "mean_env_wait_ms": 0.056547427283778574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035233497619628906, "StateBufferConnector_ms": 0.0025860071182250977, "ViewRequirementAgentConnector_ms": 0.07026207447052002}, "num_episodes": 24, "episode_return_max": 101.11528200448275, "episode_return_min": -169.1146555052282, "episode_return_mean": -73.55172672916429}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.2725627321603, "num_env_steps_trained_throughput_per_sec": 493.2725627321603, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 1272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 8164.347, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8164.302, "sample_time_ms": 770.428, "learn_time_ms": 7383.12, "learn_throughput": 541.776, "synch_weights_time_ms": 10.322}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "training_iteration": 106, "trial_id": "eaa30_00000", "date": "2024-08-09_17-54-44", "timestamp": 1723240484, "time_this_iter_s": 8.113724708557129, "time_total_s": 865.707150220871, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1780fb280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 865.707150220871, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 23.027272727272727, "ram_util_percent": 81.01818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.611268223278106, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.281227933540546, "policy_loss": -0.0008990991790409363, "vf_loss": 5.279281904205443, "vf_explained_var": -0.006078514630201632, "kl": 0.01663303874117672, "entropy": 0.960901443541996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.360800036167105, "cur_kl_coeff": 1.4812312887061698, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.853093140820662, "policy_loss": -0.005032995701185428, "vf_loss": 6.846760385235151, "vf_explained_var": -0.0011115457241733869, "kl": 0.007673176207269232, "entropy": 1.4226183342436949, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 102240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "env_runners": {"episode_reward_max": 77.68636325524594, "episode_reward_min": -179.78216013823686, "episode_reward_mean": -70.2242199098236, "episode_len_mean": 187.32, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18732, "policy_reward_min": {"agent_policy": -89.89108006911829, "adversary_policy": -56.40319523953574}, "policy_reward_max": {"agent_policy": 38.843181627623, "adversary_policy": 24.325668184911144}, "policy_reward_mean": {"agent_policy": -35.11210995491179, "adversary_policy": -17.556054977455894}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.882253131021983, -97.66599054309407, -142.563348053295, -89.5792780384073, -43.31170720974532, 52.112513545622896, -103.00378448326015, 43.520062602568956, -119.0690229637814, -85.45067455271453, -8.686020056037442, -63.29671157763941, -5.463248909729728, -106.16724436081043, -97.92746131184862, -123.13092024812153, 11.742810774677015, -121.57511890278164, 19.646931227747025, -79.73607260455191, -19.716956159396496, -82.53980804338562, -75.17481495874952, -89.97155594379221, -127.3658322790304, -125.68177410132387, -11.058227652421209, -78.68821598861481, -3.9158486470755918, -54.96836160432824, 50.15876618870465, -138.1333933471622, -85.45842465910877, -63.54508741708031, 5.75063943735708, -54.282470269988806, -48.62350720170822, -43.09769374395436, -81.47201963493868, -59.934833089553166, -142.9966848984975, -152.86696111211006, -82.01463900601996, -168.01119478508457, -3.1785779306037387, -100.24239190212214, -114.84317790433738, -93.71585769703898, -96.80638962789723, -87.21830210926308, -127.76911841895523, -111.15755229208685, -52.72414026954209, 48.79792154318888, -56.39913646588915, -169.1146555052282, -60.68416714839082, -97.37821960842562, -88.67532473625093, -35.44043328503133, -107.09405468886257, 8.089183139929427, 26.96395592013425, -94.27048212303876, -83.04402776690415, -151.45147317194647, -110.94691803386002, -101.65932566610078, -114.21168448347748, -58.34599132562363, 34.40073870788227, -120.36174424575677, -15.738952660789707, -103.06408820992787, -139.6546817380595, -109.95616235548269, -72.32988003579277, -1.9826538944131755, 7.95418984296488, -128.7381568158965, 77.68636325524594, -78.13195495193281, -105.69892464798056, -73.76492103137858, -98.91350045500678, -0.5243646093245431, -155.7688094907457, -179.78216013823686, 12.894447415573936, -128.85977228194912, -64.77162657603179, -91.94572153009597, -32.80275081007077, 33.61514818646842, 3.6088095469094412, -86.53064273229398, -86.77153586122373, -67.59604078820664, -142.7670404381032, -157.50982236759188], "episode_lengths": [200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 14, 14, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 13, 200, 33, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-11.441126565510991, -48.83299527154704, -71.28167402664738, -44.78963901920362, -21.65585360487266, 26.05625677281144, -51.50189224163001, 21.760031301284464, -59.53451148189069, -42.72533727635731, -4.343010028018721, -31.648355788819703, -2.731624454864864, -53.0836221804052, -48.963730655924316, -61.565460124060664, 5.871405387338523, -60.78755945139076, 9.823465613873545, -39.86803630227599, -9.858478079698251, -41.269904021692746, -37.58740747937471, -44.98577797189604, -63.682916139515235, -62.84088705066195, -5.529113826210587, -39.34410799430739, -1.9579243235377959, -27.484180802164097, 25.079383094352337, -69.06669667358118, -42.72921232955435, -31.772543708540155, 2.8753197186785293, -27.141235134994403, -24.31175360085411, -21.548846871977158, -40.73600981746934, -29.967416544776547, -71.49834244924872, -76.433480556055, -41.00731950301004, -84.00559739254233, -1.5892889653018756, -50.121195951061104, -57.421588952168705, -46.85792884851953, -48.40319481394867, -43.609151054631546, -63.88455920947757, -55.57877614604337, -26.362070134771045, 24.39896077159443, -28.19956823294458, -84.55732775261414, -30.3420835741954, -48.68910980421289, -44.33766236812546, -17.720216642515666, -53.547027344431285, 4.044591569964714, 13.481977960067125, -47.13524106151939, -41.5220138834521, -75.72573658597327, -55.47345901692998, -50.829662833050385, -57.1058422417387, -29.172995662811815, 17.20036935394113, -60.18087212287839, -7.869476330394853, -51.532044104963916, -69.82734086902963, -54.978081177741245, -36.16494001789639, -0.9913269472066357, 3.977094921482441, -64.36907840794825, 38.843181627623, -39.06597747596645, -52.84946232399033, -36.8824605156893, -49.45675022750334, -0.2621823046622733, -77.88440474537285, -89.89108006911829, 6.447223707786936, -64.42988614097465, -32.38581328801588, -45.97286076504799, -16.401375405035385, 16.807574093234194, 1.8044047734547242, -43.26532136614699, -43.38576793061184, -33.79802039410333, -71.38352021905145, -78.754911183796], "policy_adversary_policy_reward": [-17.93283759527646, 6.491711029765469, -16.7559929068953, -32.07700236465173, -43.87199150733771, -27.409682519309683, -3.0100108807160737, -41.77962813848754, -13.405868204222248, -8.249985400650413, 22.236788501174733, 3.8194682716367083, -36.39265267100827, -15.109239570621732, 12.161512388556034, 9.59851891272843, -36.10630363343203, -23.42820784845867, -1.8708133127107516, -40.854523963646564, 3.925079686087088, -8.268089714105809, -28.313157835664317, -3.3351979531553866, 11.797288693255577, -14.528913148120441, -22.364912108608795, -30.71871007179641, -25.112592054151403, -23.851138601772917, -30.615175081881915, -30.950285042178777, 3.420969269663015, 2.4504361176754976, -37.179350638620164, -23.6082088127706, -3.80143192482768, 13.624897538701216, -22.48142165098197, -17.386614651294018, -8.922709624091823, -0.9357684556064285, -30.69481217865176, -10.575091843040987, -16.8460251631259, -20.741382316248806, -25.862494737242844, -19.123283234653197, -34.325932195902666, -29.35698394361258, -40.358636869883156, -22.482250180778777, 3.5522572212809056, -9.081371047491498, -9.921032503809982, -29.423075490497396, -11.656966141613346, 9.69904181807555, -20.707239437209502, -6.776941364954595, 21.961019715224957, 3.118363379127352, -32.86538064942686, -36.20131602415429, -21.63467433198116, -21.094537997573195, -32.82157558021847, 1.0490318716783094, -21.300818313302166, 24.176138031980717, -6.152494487821208, -20.988740647173195, -5.101710551900588, -19.21004304895352, -2.382380137414568, -19.166466734562594, -34.157324057519745, -6.578685759949586, -15.044400541816714, -14.923016002959837, -38.62702184642937, -32.87132060281938, -54.916712426764725, -21.516768129290273, -34.91368573299139, -6.0936337700186485, -45.55739614767696, -38.44820124486532, 8.96970648348395, -10.558995448785826, -26.374970721477318, -23.74622522958379, -14.225387774952658, -43.19620117721604, -16.421463689352198, -30.436465159167334, -29.793171551797414, -18.610023262151252, -21.82942987395638, -21.779721180675175, -20.483367912590648, -43.401191296886914, -35.30833161699966, -20.27044452904371, -6.325171656163263, -20.03689847860778, 2.153525203993679, 22.24543556760075, -12.962281255026546, -15.237286977918032, -40.1031508989852, -44.45417685362894, -8.583514462507644, -21.758569111687756, -30.044456955837983, -18.64465284837491, -22.607683388672243, -21.729978979453218, -8.89110326945552, -8.829113373060146, -29.36430948994564, -24.18271785448564, -3.3238579405298836, 7.368449510494596, -0.5560034562169385, 14.037981416284063, -10.562134575529633, -36.57310648598976, -9.28504520792033, -32.23696867553177, -24.61411979546532, -51.111616790507966, -28.362540285381964, -27.11091873154801, -47.668858119524984, -3.1608047135254083, -21.56559459243332, -35.540247649305385, -13.279689224516723, -15.893306438295092, 9.398425356621914, 7.801943997319217, -21.083141429405515, -39.097730693472876, -11.785176156252831, 3.9156998258579776, -16.675346490529037, -34.85669761443488, -56.40319523953574, -13.42414562949395, -28.576820022141284, -26.401261155599983, -19.4820519306935, -16.68288808720289, 16.471560303479524, -17.462887250686155, -3.0100115980412063, 6.987106519523647, -42.59797728399781, -21.771101123950416, 16.21433137464565, 22.628850252977347, -28.22416474243332, -10.841812733533125, -43.27118630850728, -9.578276015483041, -5.918003711933963, -30.96445680375534, -2.754573851724487, -46.70217637577886, -5.984259805514206, 5.722077500851934, -40.960962611992834, -36.92344213338005, -39.12552104807917, -50.765559021039195, 0.36980024548667956, 6.077423462300281, -41.83272980897435, -22.59715633200021, -21.41973997036197, -10.966073317653912, -12.7488526447354, -33.22400812031258, 6.384611991334246, -22.78598739636963, 24.325668184911144, -7.518094091676936, -4.359147046557446, 6.163551820012174, -18.104376853882844, -25.160944512264145, -36.68337570049675, -6.702392230115088, -18.41100452958084, -15.387015864522489, -42.98002856425833, -28.40349165479315, -42.8430572731241, -35.911853910671844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38605270249917295, "mean_inference_ms": 0.9594250775999835, "mean_action_processing_ms": 0.16378719557530286, "mean_env_wait_ms": 0.05661134890859734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003570079803466797, "StateBufferConnector_ms": 0.0024411678314208984, "ViewRequirementAgentConnector_ms": 0.06786835193634033}, "num_episodes": 21, "episode_return_max": 77.68636325524594, "episode_return_min": -179.78216013823686, "episode_return_mean": -70.2242199098236}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.1595403401456, "num_env_steps_trained_throughput_per_sec": 486.1595403401456, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 1284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 8191.023, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8190.978, "sample_time_ms": 774.125, "learn_time_ms": 7405.998, "learn_throughput": 540.103, "synch_weights_time_ms": 10.397}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "training_iteration": 107, "trial_id": "eaa30_00000", "date": "2024-08-09_17-54-52", "timestamp": 1723240492, "time_this_iter_s": 8.23131012916565, "time_total_s": 873.9384603500366, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1780fb5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 873.9384603500366, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 22.241666666666664, "ram_util_percent": 80.76666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.166360234457349, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.36276326684094, "policy_loss": -0.0006190930440203933, "vf_loss": 5.361489215477434, "vf_explained_var": 0.08327981895870633, "kl": 0.011067620335422731, "entropy": 0.9866991557772198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.321120450769862, "cur_kl_coeff": 1.4812312887061698, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.7622087970376015, "policy_loss": -0.001296785972226644, "vf_loss": 6.752694624662399, "vf_explained_var": -0.025763017311692237, "kl": 0.007298637256220293, "entropy": 1.4308518670499324, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 103200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 77.68636325524594, "episode_reward_min": -216.84661071400546, "episode_reward_mean": -72.12674738174384, "episode_len_mean": 187.34, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18734, "policy_reward_min": {"agent_policy": -108.42330535700282, "adversary_policy": -60.38167706932318}, "policy_reward_max": {"agent_policy": 38.843181627623, "adversary_policy": 24.325668184911144}, "policy_reward_mean": {"agent_policy": -36.06337369087192, "adversary_policy": -18.03168684543596}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-75.17481495874952, -89.97155594379221, -127.3658322790304, -125.68177410132387, -11.058227652421209, -78.68821598861481, -3.9158486470755918, -54.96836160432824, 50.15876618870465, -138.1333933471622, -85.45842465910877, -63.54508741708031, 5.75063943735708, -54.282470269988806, -48.62350720170822, -43.09769374395436, -81.47201963493868, -59.934833089553166, -142.9966848984975, -152.86696111211006, -82.01463900601996, -168.01119478508457, -3.1785779306037387, -100.24239190212214, -114.84317790433738, -93.71585769703898, -96.80638962789723, -87.21830210926308, -127.76911841895523, -111.15755229208685, -52.72414026954209, 48.79792154318888, -56.39913646588915, -169.1146555052282, -60.68416714839082, -97.37821960842562, -88.67532473625093, -35.44043328503133, -107.09405468886257, 8.089183139929427, 26.96395592013425, -94.27048212303876, -83.04402776690415, -151.45147317194647, -110.94691803386002, -101.65932566610078, -114.21168448347748, -58.34599132562363, 34.40073870788227, -120.36174424575677, -15.738952660789707, -103.06408820992787, -139.6546817380595, -109.95616235548269, -72.32988003579277, -1.9826538944131755, 7.95418984296488, -128.7381568158965, 77.68636325524594, -78.13195495193281, -105.69892464798056, -73.76492103137858, -98.91350045500678, -0.5243646093245431, -155.7688094907457, -179.78216013823686, 12.894447415573936, -128.85977228194912, -64.77162657603179, -91.94572153009597, -32.80275081007077, 33.61514818646842, 3.6088095469094412, -86.53064273229398, -86.77153586122373, -67.59604078820664, -142.7670404381032, -157.50982236759188, -72.21592765706782, -41.80062492263072, -141.61681060325273, -78.14566181219138, -49.69872469124583, 15.852218249166729, -131.82272961048716, -86.541586914866, -216.84661071400546, -9.567251404552842, -87.95189843708611, -34.17600671768406, -81.7959524744364, -63.480580390083716, -80.64438751508843, -140.5938280533366, 26.536309819354805, 28.89639006737098, -55.46520110178262, -53.85305875623037, -102.61489373491426, -17.449232815983027], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 14, 14, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 13, 200, 33, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 21, 200, 200, 200, 200], "policy_agent_policy_reward": [-37.58740747937471, -44.98577797189604, -63.682916139515235, -62.84088705066195, -5.529113826210587, -39.34410799430739, -1.9579243235377959, -27.484180802164097, 25.079383094352337, -69.06669667358118, -42.72921232955435, -31.772543708540155, 2.8753197186785293, -27.141235134994403, -24.31175360085411, -21.548846871977158, -40.73600981746934, -29.967416544776547, -71.49834244924872, -76.433480556055, -41.00731950301004, -84.00559739254233, -1.5892889653018756, -50.121195951061104, -57.421588952168705, -46.85792884851953, -48.40319481394867, -43.609151054631546, -63.88455920947757, -55.57877614604337, -26.362070134771045, 24.39896077159443, -28.19956823294458, -84.55732775261414, -30.3420835741954, -48.68910980421289, -44.33766236812546, -17.720216642515666, -53.547027344431285, 4.044591569964714, 13.481977960067125, -47.13524106151939, -41.5220138834521, -75.72573658597327, -55.47345901692998, -50.829662833050385, -57.1058422417387, -29.172995662811815, 17.20036935394113, -60.18087212287839, -7.869476330394853, -51.532044104963916, -69.82734086902963, -54.978081177741245, -36.16494001789639, -0.9913269472066357, 3.977094921482441, -64.36907840794825, 38.843181627623, -39.06597747596645, -52.84946232399033, -36.8824605156893, -49.45675022750334, -0.2621823046622733, -77.88440474537285, -89.89108006911829, 6.447223707786936, -64.42988614097465, -32.38581328801588, -45.97286076504799, -16.401375405035385, 16.807574093234194, 1.8044047734547242, -43.26532136614699, -43.38576793061184, -33.79802039410333, -71.38352021905145, -78.754911183796, -36.107963828533904, -20.90031246131536, -70.80840530162627, -39.0728309060957, -24.849362345622914, 7.926109124583366, -65.91136480524357, -43.270793457433, -108.42330535700282, -4.783625702276414, -43.97594921854306, -17.088003358842045, -40.8979762372182, -31.740290195041858, -40.322193757544255, -70.29691402666828, 13.268154909677396, 14.448195033685492, -27.73260055089131, -26.926529378115184, -51.30744686745718, -8.724616407991512], "policy_adversary_policy_reward": [-16.8460251631259, -20.741382316248806, -25.862494737242844, -19.123283234653197, -34.325932195902666, -29.35698394361258, -40.358636869883156, -22.482250180778777, 3.5522572212809056, -9.081371047491498, -9.921032503809982, -29.423075490497396, -11.656966141613346, 9.69904181807555, -20.707239437209502, -6.776941364954595, 21.961019715224957, 3.118363379127352, -32.86538064942686, -36.20131602415429, -21.63467433198116, -21.094537997573195, -32.82157558021847, 1.0490318716783094, -21.300818313302166, 24.176138031980717, -6.152494487821208, -20.988740647173195, -5.101710551900588, -19.21004304895352, -2.382380137414568, -19.166466734562594, -34.157324057519745, -6.578685759949586, -15.044400541816714, -14.923016002959837, -38.62702184642937, -32.87132060281938, -54.916712426764725, -21.516768129290273, -34.91368573299139, -6.0936337700186485, -45.55739614767696, -38.44820124486532, 8.96970648348395, -10.558995448785826, -26.374970721477318, -23.74622522958379, -14.225387774952658, -43.19620117721604, -16.421463689352198, -30.436465159167334, -29.793171551797414, -18.610023262151252, -21.82942987395638, -21.779721180675175, -20.483367912590648, -43.401191296886914, -35.30833161699966, -20.27044452904371, -6.325171656163263, -20.03689847860778, 2.153525203993679, 22.24543556760075, -12.962281255026546, -15.237286977918032, -40.1031508989852, -44.45417685362894, -8.583514462507644, -21.758569111687756, -30.044456955837983, -18.64465284837491, -22.607683388672243, -21.729978979453218, -8.89110326945552, -8.829113373060146, -29.36430948994564, -24.18271785448564, -3.3238579405298836, 7.368449510494596, -0.5560034562169385, 14.037981416284063, -10.562134575529633, -36.57310648598976, -9.28504520792033, -32.23696867553177, -24.61411979546532, -51.111616790507966, -28.362540285381964, -27.11091873154801, -47.668858119524984, -3.1608047135254083, -21.56559459243332, -35.540247649305385, -13.279689224516723, -15.893306438295092, 9.398425356621914, 7.801943997319217, -21.083141429405515, -39.097730693472876, -11.785176156252831, 3.9156998258579776, -16.675346490529037, -34.85669761443488, -56.40319523953574, -13.42414562949395, -28.576820022141284, -26.401261155599983, -19.4820519306935, -16.68288808720289, 16.471560303479524, -17.462887250686155, -3.0100115980412063, 6.987106519523647, -42.59797728399781, -21.771101123950416, 16.21433137464565, 22.628850252977347, -28.22416474243332, -10.841812733533125, -43.27118630850728, -9.578276015483041, -5.918003711933963, -30.96445680375534, -2.754573851724487, -46.70217637577886, -5.984259805514206, 5.722077500851934, -40.960962611992834, -36.92344213338005, -39.12552104807917, -50.765559021039195, 0.36980024548667956, 6.077423462300281, -41.83272980897435, -22.59715633200021, -21.41973997036197, -10.966073317653912, -12.7488526447354, -33.22400812031258, 6.384611991334246, -22.78598739636963, 24.325668184911144, -7.518094091676936, -4.359147046557446, 6.163551820012174, -18.104376853882844, -25.160944512264145, -36.68337570049675, -6.702392230115088, -18.41100452958084, -15.387015864522489, -42.98002856425833, -28.40349165479315, -42.8430572731241, -35.911853910671844, -15.75924066408622, -20.348723164447684, -25.101297701278174, 4.200985239962812, -30.9016015955821, -39.90680370604419, -21.00894817138229, -18.063882734713413, -0.8433448212360268, -24.006017524386877, -9.337150524304917, 17.263259648888283, -47.35678255814814, -18.55458224709545, -15.598941454298652, -27.671852003134337, -48.04162828767963, -60.38167706932318, -2.43323215389589, -2.3503935483805245, 1.1626914625104163, -45.13864068105347, 13.217611055266595, -30.305614414108632, -10.919365898557118, -29.978610338661085, -4.5787133882004625, -27.161576806841396, -26.527791256575373, -13.794402500968872, -22.629398475830307, -47.667515550837976, 12.134120205764962, 1.1340347039124339, -6.218910361889286, 20.66710539557478, -26.39639151423795, -1.3362090366533579, -24.1828924740104, -2.7436369041047826, -25.567130787186578, -25.740316080270603, -7.587962576245047, -1.1366538317464645]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38625092582298864, "mean_inference_ms": 0.9591394837208743, "mean_action_processing_ms": 0.16389618920408477, "mean_env_wait_ms": 0.05664612283482368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036041736602783203, "StateBufferConnector_ms": 0.002436995506286621, "ViewRequirementAgentConnector_ms": 0.07117128372192383}, "num_episodes": 22, "episode_return_max": 77.68636325524594, "episode_return_min": -216.84661071400546, "episode_return_mean": -72.12674738174384}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 458.9044674241105, "num_env_steps_trained_throughput_per_sec": 458.9044674241105, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 8285.276, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8285.232, "sample_time_ms": 790.935, "learn_time_ms": 7483.289, "learn_throughput": 534.524, "synch_weights_time_ms": 10.547}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 108, "trial_id": "eaa30_00000", "date": "2024-08-09_17-55-01", "timestamp": 1723240501, "time_this_iter_s": 8.72114086151123, "time_total_s": 882.6596012115479, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1780fbc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 882.6596012115479, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 29.992307692307698, "ram_util_percent": 80.2076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.545863452285685, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.5476619508531355, "policy_loss": 0.0017785466475678342, "vf_loss": 5.544065278673929, "vf_explained_var": 0.016454814981531212, "kl": 0.01062908272761556, "entropy": 0.9710033423370785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.673044062281648, "cur_kl_coeff": 1.4812312887061698, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.724804491301378, "policy_loss": -0.006772406563444141, "vf_loss": 7.717853530248006, "vf_explained_var": 0.03488881327211857, "kl": 0.009264831845939625, "entropy": 1.4258836567401887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 104160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "env_runners": {"episode_reward_max": 125.62795854097851, "episode_reward_min": -216.84661071400546, "episode_reward_mean": -68.5960961876762, "episode_len_mean": 184.48, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18448, "policy_reward_min": {"agent_policy": -108.42330535700282, "adversary_policy": -60.38167706932318}, "policy_reward_max": {"agent_policy": 62.813979270489284, "adversary_policy": 43.22741677403}, "policy_reward_mean": {"agent_policy": -34.2980480938381, "adversary_policy": -17.149024046919052}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-168.01119478508457, -3.1785779306037387, -100.24239190212214, -114.84317790433738, -93.71585769703898, -96.80638962789723, -87.21830210926308, -127.76911841895523, -111.15755229208685, -52.72414026954209, 48.79792154318888, -56.39913646588915, -169.1146555052282, -60.68416714839082, -97.37821960842562, -88.67532473625093, -35.44043328503133, -107.09405468886257, 8.089183139929427, 26.96395592013425, -94.27048212303876, -83.04402776690415, -151.45147317194647, -110.94691803386002, -101.65932566610078, -114.21168448347748, -58.34599132562363, 34.40073870788227, -120.36174424575677, -15.738952660789707, -103.06408820992787, -139.6546817380595, -109.95616235548269, -72.32988003579277, -1.9826538944131755, 7.95418984296488, -128.7381568158965, 77.68636325524594, -78.13195495193281, -105.69892464798056, -73.76492103137858, -98.91350045500678, -0.5243646093245431, -155.7688094907457, -179.78216013823686, 12.894447415573936, -128.85977228194912, -64.77162657603179, -91.94572153009597, -32.80275081007077, 33.61514818646842, 3.6088095469094412, -86.53064273229398, -86.77153586122373, -67.59604078820664, -142.7670404381032, -157.50982236759188, -72.21592765706782, -41.80062492263072, -141.61681060325273, -78.14566181219138, -49.69872469124583, 15.852218249166729, -131.82272961048716, -86.541586914866, -216.84661071400546, -9.567251404552842, -87.95189843708611, -34.17600671768406, -81.7959524744364, -63.480580390083716, -80.64438751508843, -140.5938280533366, 26.536309819354805, 28.89639006737098, -55.46520110178262, -53.85305875623037, -102.61489373491426, -17.449232815983027, -38.396601439852574, 39.43904631913317, 1.3330589994808015, -165.79992127406499, -125.51812755592613, -76.60814540057763, -95.1756076968453, 85.85883057547034, -137.1027115606012, -110.85274915169738, 51.478766432862564, -91.66921441113476, 125.62795854097851, -106.62530475042838, -76.50968845164044, -72.73512911240249, -52.57956212503901, -44.68710015763494, -15.57215353824909, -132.63948923282618, -71.5419755316361], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 14, 14, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 13, 200, 33, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 21, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 56, 200, 200, 58, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-84.00559739254233, -1.5892889653018756, -50.121195951061104, -57.421588952168705, -46.85792884851953, -48.40319481394867, -43.609151054631546, -63.88455920947757, -55.57877614604337, -26.362070134771045, 24.39896077159443, -28.19956823294458, -84.55732775261414, -30.3420835741954, -48.68910980421289, -44.33766236812546, -17.720216642515666, -53.547027344431285, 4.044591569964714, 13.481977960067125, -47.13524106151939, -41.5220138834521, -75.72573658597327, -55.47345901692998, -50.829662833050385, -57.1058422417387, -29.172995662811815, 17.20036935394113, -60.18087212287839, -7.869476330394853, -51.532044104963916, -69.82734086902963, -54.978081177741245, -36.16494001789639, -0.9913269472066357, 3.977094921482441, -64.36907840794825, 38.843181627623, -39.06597747596645, -52.84946232399033, -36.8824605156893, -49.45675022750334, -0.2621823046622733, -77.88440474537285, -89.89108006911829, 6.447223707786936, -64.42988614097465, -32.38581328801588, -45.97286076504799, -16.401375405035385, 16.807574093234194, 1.8044047734547242, -43.26532136614699, -43.38576793061184, -33.79802039410333, -71.38352021905145, -78.754911183796, -36.107963828533904, -20.90031246131536, -70.80840530162627, -39.0728309060957, -24.849362345622914, 7.926109124583366, -65.91136480524357, -43.270793457433, -108.42330535700282, -4.783625702276414, -43.97594921854306, -17.088003358842045, -40.8979762372182, -31.740290195041858, -40.322193757544255, -70.29691402666828, 13.268154909677396, 14.448195033685492, -27.73260055089131, -26.926529378115184, -51.30744686745718, -8.724616407991512, -19.198300719926284, 19.71952315956658, 0.6665294997404203, -82.89996063703236, -62.7590637779631, -38.30407270028877, -47.58780384842268, 42.92941528773516, -68.55135578030065, -55.42637457584868, 25.739383216431303, -45.83460720556742, 62.813979270489284, -53.31265237521418, -38.25484422582025, -36.36756455620125, -26.28978106251952, -22.34355007881747, -7.786076769124524, -66.31974461641312, -35.77098776581801], "policy_adversary_policy_reward": [-45.55739614767696, -38.44820124486532, 8.96970648348395, -10.558995448785826, -26.374970721477318, -23.74622522958379, -14.225387774952658, -43.19620117721604, -16.421463689352198, -30.436465159167334, -29.793171551797414, -18.610023262151252, -21.82942987395638, -21.779721180675175, -20.483367912590648, -43.401191296886914, -35.30833161699966, -20.27044452904371, -6.325171656163263, -20.03689847860778, 2.153525203993679, 22.24543556760075, -12.962281255026546, -15.237286977918032, -40.1031508989852, -44.45417685362894, -8.583514462507644, -21.758569111687756, -30.044456955837983, -18.64465284837491, -22.607683388672243, -21.729978979453218, -8.89110326945552, -8.829113373060146, -29.36430948994564, -24.18271785448564, -3.3238579405298836, 7.368449510494596, -0.5560034562169385, 14.037981416284063, -10.562134575529633, -36.57310648598976, -9.28504520792033, -32.23696867553177, -24.61411979546532, -51.111616790507966, -28.362540285381964, -27.11091873154801, -47.668858119524984, -3.1608047135254083, -21.56559459243332, -35.540247649305385, -13.279689224516723, -15.893306438295092, 9.398425356621914, 7.801943997319217, -21.083141429405515, -39.097730693472876, -11.785176156252831, 3.9156998258579776, -16.675346490529037, -34.85669761443488, -56.40319523953574, -13.42414562949395, -28.576820022141284, -26.401261155599983, -19.4820519306935, -16.68288808720289, 16.471560303479524, -17.462887250686155, -3.0100115980412063, 6.987106519523647, -42.59797728399781, -21.771101123950416, 16.21433137464565, 22.628850252977347, -28.22416474243332, -10.841812733533125, -43.27118630850728, -9.578276015483041, -5.918003711933963, -30.96445680375534, -2.754573851724487, -46.70217637577886, -5.984259805514206, 5.722077500851934, -40.960962611992834, -36.92344213338005, -39.12552104807917, -50.765559021039195, 0.36980024548667956, 6.077423462300281, -41.83272980897435, -22.59715633200021, -21.41973997036197, -10.966073317653912, -12.7488526447354, -33.22400812031258, 6.384611991334246, -22.78598739636963, 24.325668184911144, -7.518094091676936, -4.359147046557446, 6.163551820012174, -18.104376853882844, -25.160944512264145, -36.68337570049675, -6.702392230115088, -18.41100452958084, -15.387015864522489, -42.98002856425833, -28.40349165479315, -42.8430572731241, -35.911853910671844, -15.75924066408622, -20.348723164447684, -25.101297701278174, 4.200985239962812, -30.9016015955821, -39.90680370604419, -21.00894817138229, -18.063882734713413, -0.8433448212360268, -24.006017524386877, -9.337150524304917, 17.263259648888283, -47.35678255814814, -18.55458224709545, -15.598941454298652, -27.671852003134337, -48.04162828767963, -60.38167706932318, -2.43323215389589, -2.3503935483805245, 1.1626914625104163, -45.13864068105347, 13.217611055266595, -30.305614414108632, -10.919365898557118, -29.978610338661085, -4.5787133882004625, -27.161576806841396, -26.527791256575373, -13.794402500968872, -22.629398475830307, -47.667515550837976, 12.134120205764962, 1.1340347039124339, -6.218910361889286, 20.66710539557478, -26.39639151423795, -1.3362090366533579, -24.1828924740104, -2.7436369041047826, -25.567130787186578, -25.740316080270603, -7.587962576245047, -1.1366538317464645, -3.2781504532560994, -15.920150266670184, 26.198133689131176, -6.478610529564621, -4.618654308526686, 5.2851838082671065, -34.783264048139124, -48.11669658889326, -46.90828501554383, -15.850778762419253, -22.18040718409109, -16.12366551619768, -17.60934977670108, -29.97845407172157, 43.22741677403, -0.29800148629482504, -27.536642872827475, -41.01471290747314, -20.117231201352578, -35.30914337449611, -8.072209343607636, 33.81159256003894, -12.67984684329587, -33.154760362271546, 30.075533300810985, 32.73844596967836, -30.953656910189792, -22.358995465024385, -17.171307354120692, -21.083536871699557, -28.588568900126454, -7.778995656074791, -26.40920837408528, 0.11942731156576514, -8.455932859962786, -13.887617218854682, 1.9062241509176765, -9.6923009200422, -38.46561916290964, -27.854125453503492, -10.85532320853131, -24.915664557286703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38632274652365445, "mean_inference_ms": 0.9590479076832352, "mean_action_processing_ms": 0.16386655020348595, "mean_env_wait_ms": 0.05664532647707325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036249160766601562, "StateBufferConnector_ms": 0.0024111270904541016, "ViewRequirementAgentConnector_ms": 0.07031047344207764}, "num_episodes": 21, "episode_return_max": 125.62795854097851, "episode_return_min": -216.84661071400546, "episode_return_mean": -68.5960961876762}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.0011233484899, "num_env_steps_trained_throughput_per_sec": 501.0011233484899, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 1308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1308000, "timers": {"training_iteration_time_ms": 8280.958, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8280.913, "sample_time_ms": 786.879, "learn_time_ms": 7482.824, "learn_throughput": 534.558, "synch_weights_time_ms": 10.722}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "done": false, "training_iteration": 109, "trial_id": "eaa30_00000", "date": "2024-08-09_17-55-09", "timestamp": 1723240509, "time_this_iter_s": 7.988461017608643, "time_total_s": 890.6480622291565, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2857160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 890.6480622291565, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 21.62727272727273, "ram_util_percent": 80.41818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.510558346844224, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.131855903605305, "policy_loss": -0.0010722114118161025, "vf_loss": 5.1311932450249085, "vf_explained_var": 0.07851911666532042, "kl": 0.01014237899219903, "entropy": 1.023470538854599, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12995922639966, "cur_kl_coeff": 1.4812312887061698, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.083001156151295, "policy_loss": -0.005772588436957449, "vf_loss": 7.08132181117932, "vf_explained_var": -0.055342025806506476, "kl": 0.005030899027042323, "entropy": 1.440612568333745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 105120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 125.62795854097851, "episode_reward_min": -216.84661071400546, "episode_reward_mean": -65.27228650244714, "episode_len_mean": 188.07, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18807, "policy_reward_min": {"agent_policy": -108.42330535700282, "adversary_policy": -60.38167706932318}, "policy_reward_max": {"agent_policy": 62.813979270489284, "adversary_policy": 43.22741677403}, "policy_reward_mean": {"agent_policy": -32.636143251223565, "adversary_policy": -16.318071625611783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-94.27048212303876, -83.04402776690415, -151.45147317194647, -110.94691803386002, -101.65932566610078, -114.21168448347748, -58.34599132562363, 34.40073870788227, -120.36174424575677, -15.738952660789707, -103.06408820992787, -139.6546817380595, -109.95616235548269, -72.32988003579277, -1.9826538944131755, 7.95418984296488, -128.7381568158965, 77.68636325524594, -78.13195495193281, -105.69892464798056, -73.76492103137858, -98.91350045500678, -0.5243646093245431, -155.7688094907457, -179.78216013823686, 12.894447415573936, -128.85977228194912, -64.77162657603179, -91.94572153009597, -32.80275081007077, 33.61514818646842, 3.6088095469094412, -86.53064273229398, -86.77153586122373, -67.59604078820664, -142.7670404381032, -157.50982236759188, -72.21592765706782, -41.80062492263072, -141.61681060325273, -78.14566181219138, -49.69872469124583, 15.852218249166729, -131.82272961048716, -86.541586914866, -216.84661071400546, -9.567251404552842, -87.95189843708611, -34.17600671768406, -81.7959524744364, -63.480580390083716, -80.64438751508843, -140.5938280533366, 26.536309819354805, 28.89639006737098, -55.46520110178262, -53.85305875623037, -102.61489373491426, -17.449232815983027, -38.396601439852574, 39.43904631913317, 1.3330589994808015, -165.79992127406499, -125.51812755592613, -76.60814540057763, -95.1756076968453, 85.85883057547034, -137.1027115606012, -110.85274915169738, 51.478766432862564, -91.66921441113476, 125.62795854097851, -106.62530475042838, -76.50968845164044, -72.73512911240249, -52.57956212503901, -44.68710015763494, -15.57215353824909, -132.63948923282618, -71.5419755316361, -119.64531059589464, -46.39015585673491, 4.36870013841634, -74.20486225164122, -2.9358977732255553, -51.14730006960335, -149.22455855616715, -143.1839760034612, -87.9034534961235, -90.34012157248816, -81.16768677405577, -65.91982546828349, -70.9738445042592, -17.92980613596105, -108.78189079755558, -45.066083300001, 39.45937212092301, 110.60414554489603, -162.30151050525683, 8.463400607626028], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 13, 200, 33, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 21, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 56, 200, 200, 58, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-47.13524106151939, -41.5220138834521, -75.72573658597327, -55.47345901692998, -50.829662833050385, -57.1058422417387, -29.172995662811815, 17.20036935394113, -60.18087212287839, -7.869476330394853, -51.532044104963916, -69.82734086902963, -54.978081177741245, -36.16494001789639, -0.9913269472066357, 3.977094921482441, -64.36907840794825, 38.843181627623, -39.06597747596645, -52.84946232399033, -36.8824605156893, -49.45675022750334, -0.2621823046622733, -77.88440474537285, -89.89108006911829, 6.447223707786936, -64.42988614097465, -32.38581328801588, -45.97286076504799, -16.401375405035385, 16.807574093234194, 1.8044047734547242, -43.26532136614699, -43.38576793061184, -33.79802039410333, -71.38352021905145, -78.754911183796, -36.107963828533904, -20.90031246131536, -70.80840530162627, -39.0728309060957, -24.849362345622914, 7.926109124583366, -65.91136480524357, -43.270793457433, -108.42330535700282, -4.783625702276414, -43.97594921854306, -17.088003358842045, -40.8979762372182, -31.740290195041858, -40.322193757544255, -70.29691402666828, 13.268154909677396, 14.448195033685492, -27.73260055089131, -26.926529378115184, -51.30744686745718, -8.724616407991512, -19.198300719926284, 19.71952315956658, 0.6665294997404203, -82.89996063703236, -62.7590637779631, -38.30407270028877, -47.58780384842268, 42.92941528773516, -68.55135578030065, -55.42637457584868, 25.739383216431303, -45.83460720556742, 62.813979270489284, -53.31265237521418, -38.25484422582025, -36.36756455620125, -26.28978106251952, -22.34355007881747, -7.786076769124524, -66.31974461641312, -35.77098776581801, -59.8226552979473, -23.195077928367436, 2.1843500692081705, -37.10243112582062, -1.4679488866127777, -25.57365003480168, -74.61227927808349, -71.59198800173056, -43.95172674806179, -45.17006078624415, -40.58384338702786, -32.95991273414174, -35.486922252129595, -8.964903067980526, -54.390945398777845, -22.533041650000502, 19.7296860604615, 55.30207277244801, -81.1507552526283, 4.23170030381301], "policy_adversary_policy_reward": [-10.562134575529633, -36.57310648598976, -9.28504520792033, -32.23696867553177, -24.61411979546532, -51.111616790507966, -28.362540285381964, -27.11091873154801, -47.668858119524984, -3.1608047135254083, -21.56559459243332, -35.540247649305385, -13.279689224516723, -15.893306438295092, 9.398425356621914, 7.801943997319217, -21.083141429405515, -39.097730693472876, -11.785176156252831, 3.9156998258579776, -16.675346490529037, -34.85669761443488, -56.40319523953574, -13.42414562949395, -28.576820022141284, -26.401261155599983, -19.4820519306935, -16.68288808720289, 16.471560303479524, -17.462887250686155, -3.0100115980412063, 6.987106519523647, -42.59797728399781, -21.771101123950416, 16.21433137464565, 22.628850252977347, -28.22416474243332, -10.841812733533125, -43.27118630850728, -9.578276015483041, -5.918003711933963, -30.96445680375534, -2.754573851724487, -46.70217637577886, -5.984259805514206, 5.722077500851934, -40.960962611992834, -36.92344213338005, -39.12552104807917, -50.765559021039195, 0.36980024548667956, 6.077423462300281, -41.83272980897435, -22.59715633200021, -21.41973997036197, -10.966073317653912, -12.7488526447354, -33.22400812031258, 6.384611991334246, -22.78598739636963, 24.325668184911144, -7.518094091676936, -4.359147046557446, 6.163551820012174, -18.104376853882844, -25.160944512264145, -36.68337570049675, -6.702392230115088, -18.41100452958084, -15.387015864522489, -42.98002856425833, -28.40349165479315, -42.8430572731241, -35.911853910671844, -15.75924066408622, -20.348723164447684, -25.101297701278174, 4.200985239962812, -30.9016015955821, -39.90680370604419, -21.00894817138229, -18.063882734713413, -0.8433448212360268, -24.006017524386877, -9.337150524304917, 17.263259648888283, -47.35678255814814, -18.55458224709545, -15.598941454298652, -27.671852003134337, -48.04162828767963, -60.38167706932318, -2.43323215389589, -2.3503935483805245, 1.1626914625104163, -45.13864068105347, 13.217611055266595, -30.305614414108632, -10.919365898557118, -29.978610338661085, -4.5787133882004625, -27.161576806841396, -26.527791256575373, -13.794402500968872, -22.629398475830307, -47.667515550837976, 12.134120205764962, 1.1340347039124339, -6.218910361889286, 20.66710539557478, -26.39639151423795, -1.3362090366533579, -24.1828924740104, -2.7436369041047826, -25.567130787186578, -25.740316080270603, -7.587962576245047, -1.1366538317464645, -3.2781504532560994, -15.920150266670184, 26.198133689131176, -6.478610529564621, -4.618654308526686, 5.2851838082671065, -34.783264048139124, -48.11669658889326, -46.90828501554383, -15.850778762419253, -22.18040718409109, -16.12366551619768, -17.60934977670108, -29.97845407172157, 43.22741677403, -0.29800148629482504, -27.536642872827475, -41.01471290747314, -20.117231201352578, -35.30914337449611, -8.072209343607636, 33.81159256003894, -12.67984684329587, -33.154760362271546, 30.075533300810985, 32.73844596967836, -30.953656910189792, -22.358995465024385, -17.171307354120692, -21.083536871699557, -28.588568900126454, -7.778995656074791, -26.40920837408528, 0.11942731156576514, -8.455932859962786, -13.887617218854682, 1.9062241509176765, -9.6923009200422, -38.46561916290964, -27.854125453503492, -10.85532320853131, -24.915664557286703, -27.24528226437525, -32.57737303357205, -6.292398314351665, -16.902679614015767, 11.91168379038111, -9.72733372117294, -13.76380471712482, -23.338626408695806, 5.376033971667987, -6.843982858280764, -16.650670113170428, -8.922979921631258, -33.81297382754469, -40.79930545053882, -19.530199022721007, -52.06178897900955, -30.262967577438985, -13.688759170622804, -12.056789701471068, -33.11327108477308, -8.76012697237789, -31.823716414649972, -9.96862275642873, -22.991289977713006, -12.107806852308471, -23.37911539982112, 4.621522917689564, -13.58642598567009, -30.513666821763877, -23.877278577013968, 0.641228075843502, -23.17426972584401, 16.53114804774798, 3.1985380127135272, 20.372958816027303, 34.92911395642071, -43.55926719420948, -37.59148805841884, 13.500465730689228, -9.268765426876218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3862306784941072, "mean_inference_ms": 0.9594755011558607, "mean_action_processing_ms": 0.16386626120570008, "mean_env_wait_ms": 0.05665892262485654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003615736961364746, "StateBufferConnector_ms": 0.002620100975036621, "ViewRequirementAgentConnector_ms": 0.07062292098999023}, "num_episodes": 20, "episode_return_max": 125.62795854097851, "episode_return_min": -216.84661071400546, "episode_return_mean": -65.27228650244714}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.0309218091364, "num_env_steps_trained_throughput_per_sec": 494.0309218091364, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 8297.006, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8296.962, "sample_time_ms": 786.097, "learn_time_ms": 7499.194, "learn_throughput": 533.391, "synch_weights_time_ms": 11.091}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 110, "trial_id": "eaa30_00000", "date": "2024-08-09_17-55-17", "timestamp": 1723240517, "time_this_iter_s": 8.101667881011963, "time_total_s": 898.7497301101685, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1780fbca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 898.7497301101685, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 22.408333333333335, "ram_util_percent": 80.27500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.257973464330037, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.5676487677942506, "policy_loss": -0.00462650954255233, "vf_loss": 5.570597682680402, "vf_explained_var": 0.10693808961166906, "kl": 0.00980750343752483, "entropy": 1.017706729905315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.096875143920382, "cur_kl_coeff": 1.4812312887061698, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.332689072191715, "policy_loss": -0.002599944852408953, "vf_loss": 7.328937218089899, "vf_explained_var": -0.013823161895076434, "kl": 0.0042881763198238335, "entropy": 1.4318925386915604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 106080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "env_runners": {"episode_reward_max": 125.62795854097851, "episode_reward_min": -216.84661071400546, "episode_reward_mean": -59.85318511999863, "episode_len_mean": 190.03, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19003, "policy_reward_min": {"agent_policy": -108.42330535700282, "adversary_policy": -60.38167706932318}, "policy_reward_max": {"agent_policy": 62.813979270489284, "adversary_policy": 43.22741677403}, "policy_reward_mean": {"agent_policy": -29.926592559999307, "adversary_policy": -14.963296279999653}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-98.91350045500678, -0.5243646093245431, -155.7688094907457, -179.78216013823686, 12.894447415573936, -128.85977228194912, -64.77162657603179, -91.94572153009597, -32.80275081007077, 33.61514818646842, 3.6088095469094412, -86.53064273229398, -86.77153586122373, -67.59604078820664, -142.7670404381032, -157.50982236759188, -72.21592765706782, -41.80062492263072, -141.61681060325273, -78.14566181219138, -49.69872469124583, 15.852218249166729, -131.82272961048716, -86.541586914866, -216.84661071400546, -9.567251404552842, -87.95189843708611, -34.17600671768406, -81.7959524744364, -63.480580390083716, -80.64438751508843, -140.5938280533366, 26.536309819354805, 28.89639006737098, -55.46520110178262, -53.85305875623037, -102.61489373491426, -17.449232815983027, -38.396601439852574, 39.43904631913317, 1.3330589994808015, -165.79992127406499, -125.51812755592613, -76.60814540057763, -95.1756076968453, 85.85883057547034, -137.1027115606012, -110.85274915169738, 51.478766432862564, -91.66921441113476, 125.62795854097851, -106.62530475042838, -76.50968845164044, -72.73512911240249, -52.57956212503901, -44.68710015763494, -15.57215353824909, -132.63948923282618, -71.5419755316361, -119.64531059589464, -46.39015585673491, 4.36870013841634, -74.20486225164122, -2.9358977732255553, -51.14730006960335, -149.22455855616715, -143.1839760034612, -87.9034534961235, -90.34012157248816, -81.16768677405577, -65.91982546828349, -70.9738445042592, -17.92980613596105, -108.78189079755558, -45.066083300001, 39.45937212092301, 110.60414554489603, -162.30151050525683, 8.463400607626028, -85.23456235767566, -111.72205236619638, -104.00999659839422, -73.68580465740968, 33.196701481031425, 14.67818951522558, -94.07343347579513, 39.42268863755092, -134.92896639993455, -114.53408330737281, -137.4838695749777, 17.416241023252084, -38.9811192456222, -94.68227398773678, -61.95058266731844, 64.88171667281657, -41.09093902947649, -107.31321860443603, -38.31200110468092, -12.439527391827546, 79.44630033155926], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 21, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 56, 200, 200, 58, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-49.45675022750334, -0.2621823046622733, -77.88440474537285, -89.89108006911829, 6.447223707786936, -64.42988614097465, -32.38581328801588, -45.97286076504799, -16.401375405035385, 16.807574093234194, 1.8044047734547242, -43.26532136614699, -43.38576793061184, -33.79802039410333, -71.38352021905145, -78.754911183796, -36.107963828533904, -20.90031246131536, -70.80840530162627, -39.0728309060957, -24.849362345622914, 7.926109124583366, -65.91136480524357, -43.270793457433, -108.42330535700282, -4.783625702276414, -43.97594921854306, -17.088003358842045, -40.8979762372182, -31.740290195041858, -40.322193757544255, -70.29691402666828, 13.268154909677396, 14.448195033685492, -27.73260055089131, -26.926529378115184, -51.30744686745718, -8.724616407991512, -19.198300719926284, 19.71952315956658, 0.6665294997404203, -82.89996063703236, -62.7590637779631, -38.30407270028877, -47.58780384842268, 42.92941528773516, -68.55135578030065, -55.42637457584868, 25.739383216431303, -45.83460720556742, 62.813979270489284, -53.31265237521418, -38.25484422582025, -36.36756455620125, -26.28978106251952, -22.34355007881747, -7.786076769124524, -66.31974461641312, -35.77098776581801, -59.8226552979473, -23.195077928367436, 2.1843500692081705, -37.10243112582062, -1.4679488866127777, -25.57365003480168, -74.61227927808349, -71.59198800173056, -43.95172674806179, -45.17006078624415, -40.58384338702786, -32.95991273414174, -35.486922252129595, -8.964903067980526, -54.390945398777845, -22.533041650000502, 19.7296860604615, 55.30207277244801, -81.1507552526283, 4.23170030381301, -42.617281178837864, -55.861026183098254, -52.00499829919701, -36.842902328704874, 16.598350740515713, 7.339094757612802, -47.03671673789756, 19.71134431877546, -67.46448319996728, -57.26704165368634, -68.74193478748876, 8.708120511626042, -19.490559622811105, -47.34113699386839, -30.9752913336592, 32.440858336408326, -20.545469514738244, -53.65660930221799, -19.15600055234046, -6.219763695913745, 39.7231501657797], "policy_adversary_policy_reward": [-2.754573851724487, -46.70217637577886, -5.984259805514206, 5.722077500851934, -40.960962611992834, -36.92344213338005, -39.12552104807917, -50.765559021039195, 0.36980024548667956, 6.077423462300281, -41.83272980897435, -22.59715633200021, -21.41973997036197, -10.966073317653912, -12.7488526447354, -33.22400812031258, 6.384611991334246, -22.78598739636963, 24.325668184911144, -7.518094091676936, -4.359147046557446, 6.163551820012174, -18.104376853882844, -25.160944512264145, -36.68337570049675, -6.702392230115088, -18.41100452958084, -15.387015864522489, -42.98002856425833, -28.40349165479315, -42.8430572731241, -35.911853910671844, -15.75924066408622, -20.348723164447684, -25.101297701278174, 4.200985239962812, -30.9016015955821, -39.90680370604419, -21.00894817138229, -18.063882734713413, -0.8433448212360268, -24.006017524386877, -9.337150524304917, 17.263259648888283, -47.35678255814814, -18.55458224709545, -15.598941454298652, -27.671852003134337, -48.04162828767963, -60.38167706932318, -2.43323215389589, -2.3503935483805245, 1.1626914625104163, -45.13864068105347, 13.217611055266595, -30.305614414108632, -10.919365898557118, -29.978610338661085, -4.5787133882004625, -27.161576806841396, -26.527791256575373, -13.794402500968872, -22.629398475830307, -47.667515550837976, 12.134120205764962, 1.1340347039124339, -6.218910361889286, 20.66710539557478, -26.39639151423795, -1.3362090366533579, -24.1828924740104, -2.7436369041047826, -25.567130787186578, -25.740316080270603, -7.587962576245047, -1.1366538317464645, -3.2781504532560994, -15.920150266670184, 26.198133689131176, -6.478610529564621, -4.618654308526686, 5.2851838082671065, -34.783264048139124, -48.11669658889326, -46.90828501554383, -15.850778762419253, -22.18040718409109, -16.12366551619768, -17.60934977670108, -29.97845407172157, 43.22741677403, -0.29800148629482504, -27.536642872827475, -41.01471290747314, -20.117231201352578, -35.30914337449611, -8.072209343607636, 33.81159256003894, -12.67984684329587, -33.154760362271546, 30.075533300810985, 32.73844596967836, -30.953656910189792, -22.358995465024385, -17.171307354120692, -21.083536871699557, -28.588568900126454, -7.778995656074791, -26.40920837408528, 0.11942731156576514, -8.455932859962786, -13.887617218854682, 1.9062241509176765, -9.6923009200422, -38.46561916290964, -27.854125453503492, -10.85532320853131, -24.915664557286703, -27.24528226437525, -32.57737303357205, -6.292398314351665, -16.902679614015767, 11.91168379038111, -9.72733372117294, -13.76380471712482, -23.338626408695806, 5.376033971667987, -6.843982858280764, -16.650670113170428, -8.922979921631258, -33.81297382754469, -40.79930545053882, -19.530199022721007, -52.06178897900955, -30.262967577438985, -13.688759170622804, -12.056789701471068, -33.11327108477308, -8.76012697237789, -31.823716414649972, -9.96862275642873, -22.991289977713006, -12.107806852308471, -23.37911539982112, 4.621522917689564, -13.58642598567009, -30.513666821763877, -23.877278577013968, 0.641228075843502, -23.17426972584401, 16.53114804774798, 3.1985380127135272, 20.372958816027303, 34.92911395642071, -43.55926719420948, -37.59148805841884, 13.500465730689228, -9.268765426876218, -26.851368997604034, -15.765912181233858, -29.666376583826104, -26.194649599272147, -9.294915773972924, -42.71008252522408, -20.244644065499365, -16.59825826320551, -5.776722176397608, 22.375072916913325, -19.3514270189434, 26.690521776556203, -23.703592007793876, -23.333124730103687, 18.036499352295454, 1.674844966480002, -51.63493140132247, -15.8295517986448, -21.86697287427606, -35.400068779410276, -24.120619546337846, -44.62131524115091, 20.01708943014239, -11.308968918516353, -12.581653712400012, -6.908905910411093, -28.741274627799882, -18.599862366068507, -21.979687295891672, -8.995604037767528, 18.741944075124536, 13.698914261283754, 6.90954048008134, -27.455009994819584, -21.224344082785024, -32.43226521943295, -2.3747516919723566, -16.781248860368102, -5.083439776654455, -1.13632391925929, 25.30021017409942, 14.422939991680298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38627325085795683, "mean_inference_ms": 0.958949002164836, "mean_action_processing_ms": 0.16393705707251677, "mean_env_wait_ms": 0.056687338287932466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035659074783325195, "StateBufferConnector_ms": 0.0026417970657348633, "ViewRequirementAgentConnector_ms": 0.07004952430725098}, "num_episodes": 21, "episode_return_max": 125.62795854097851, "episode_return_min": -216.84661071400546, "episode_return_mean": -59.85318511999863}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.4917616925327, "num_env_steps_trained_throughput_per_sec": 499.4917616925327, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 1332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 8288.18, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8288.135, "sample_time_ms": 787.846, "learn_time_ms": 7488.655, "learn_throughput": 534.141, "synch_weights_time_ms": 11.053}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "training_iteration": 111, "trial_id": "eaa30_00000", "date": "2024-08-09_17-55-25", "timestamp": 1723240525, "time_this_iter_s": 8.013164043426514, "time_total_s": 906.762894153595, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17808c310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 906.762894153595, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 23.80909090909091, "ram_util_percent": 80.30909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.883567773223554, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.196041498991548, "policy_loss": -0.0025195961252653175, "vf_loss": 5.196539667926769, "vf_explained_var": -0.01395919127439065, "kl": 0.011817423110364607, "entropy": 1.047306753687127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.691227202489973, "cur_kl_coeff": 0.7406156443530849, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.105811211466789, "policy_loss": -0.008509970922023057, "vf_loss": 7.109040417770545, "vf_explained_var": 0.1115587298447887, "kl": 0.007130224958382314, "entropy": 1.4451117410014074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 107040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 142.21271935284304, "episode_reward_min": -216.84661071400546, "episode_reward_mean": -51.830451790432896, "episode_len_mean": 186.6, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18660, "policy_reward_min": {"agent_policy": -108.42330535700282, "adversary_policy": -60.38167706932318}, "policy_reward_max": {"agent_policy": 71.10635967642155, "adversary_policy": 43.22741677403}, "policy_reward_mean": {"agent_policy": -25.915225895216448, "adversary_policy": -12.957612947608224}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-86.541586914866, -216.84661071400546, -9.567251404552842, -87.95189843708611, -34.17600671768406, -81.7959524744364, -63.480580390083716, -80.64438751508843, -140.5938280533366, 26.536309819354805, 28.89639006737098, -55.46520110178262, -53.85305875623037, -102.61489373491426, -17.449232815983027, -38.396601439852574, 39.43904631913317, 1.3330589994808015, -165.79992127406499, -125.51812755592613, -76.60814540057763, -95.1756076968453, 85.85883057547034, -137.1027115606012, -110.85274915169738, 51.478766432862564, -91.66921441113476, 125.62795854097851, -106.62530475042838, -76.50968845164044, -72.73512911240249, -52.57956212503901, -44.68710015763494, -15.57215353824909, -132.63948923282618, -71.5419755316361, -119.64531059589464, -46.39015585673491, 4.36870013841634, -74.20486225164122, -2.9358977732255553, -51.14730006960335, -149.22455855616715, -143.1839760034612, -87.9034534961235, -90.34012157248816, -81.16768677405577, -65.91982546828349, -70.9738445042592, -17.92980613596105, -108.78189079755558, -45.066083300001, 39.45937212092301, 110.60414554489603, -162.30151050525683, 8.463400607626028, -85.23456235767566, -111.72205236619638, -104.00999659839422, -73.68580465740968, 33.196701481031425, 14.67818951522558, -94.07343347579513, 39.42268863755092, -134.92896639993455, -114.53408330737281, -137.4838695749777, 17.416241023252084, -38.9811192456222, -94.68227398773678, -61.95058266731844, 64.88171667281657, -41.09093902947649, -107.31321860443603, -38.31200110468092, -12.439527391827546, 79.44630033155926, -152.22903480362322, -11.07010292478391, -24.367568591326314, 16.39199193536733, -107.78040024148545, -59.8140499283658, -73.91236041842302, -37.24446213631725, -91.94720457764248, 3.119691946957687, 56.33219166926564, -50.966891246135575, 56.26921850464835, -124.2728202709012, -11.493024625300368, -88.0977822637368, -19.613150297230355, -27.974311410548843, -64.1327493566572, 142.21271935284304, -125.85341530930253, -98.6554254110313, -46.501370617335894], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 21, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 56, 200, 200, 58, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 200], "policy_agent_policy_reward": [-43.270793457433, -108.42330535700282, -4.783625702276414, -43.97594921854306, -17.088003358842045, -40.8979762372182, -31.740290195041858, -40.322193757544255, -70.29691402666828, 13.268154909677396, 14.448195033685492, -27.73260055089131, -26.926529378115184, -51.30744686745718, -8.724616407991512, -19.198300719926284, 19.71952315956658, 0.6665294997404203, -82.89996063703236, -62.7590637779631, -38.30407270028877, -47.58780384842268, 42.92941528773516, -68.55135578030065, -55.42637457584868, 25.739383216431303, -45.83460720556742, 62.813979270489284, -53.31265237521418, -38.25484422582025, -36.36756455620125, -26.28978106251952, -22.34355007881747, -7.786076769124524, -66.31974461641312, -35.77098776581801, -59.8226552979473, -23.195077928367436, 2.1843500692081705, -37.10243112582062, -1.4679488866127777, -25.57365003480168, -74.61227927808349, -71.59198800173056, -43.95172674806179, -45.17006078624415, -40.58384338702786, -32.95991273414174, -35.486922252129595, -8.964903067980526, -54.390945398777845, -22.533041650000502, 19.7296860604615, 55.30207277244801, -81.1507552526283, 4.23170030381301, -42.617281178837864, -55.861026183098254, -52.00499829919701, -36.842902328704874, 16.598350740515713, 7.339094757612802, -47.03671673789756, 19.71134431877546, -67.46448319996728, -57.26704165368634, -68.74193478748876, 8.708120511626042, -19.490559622811105, -47.34113699386839, -30.9752913336592, 32.440858336408326, -20.545469514738244, -53.65660930221799, -19.15600055234046, -6.219763695913745, 39.7231501657797, -76.11451740181161, -5.535051462391955, -12.183784295663163, 8.195995967683665, -53.89020012074275, -29.907024964182924, -36.956180209211475, -18.622231068158626, -45.97360228882128, 1.5598459734788221, 28.16609583463289, -25.483445623067787, 28.134609252324132, -62.136410135450646, -5.746512312650161, -44.048891131868345, -9.806575148615178, -13.987155705274422, -32.0663746783286, 71.10635967642155, -62.926707654651324, -49.327712705515594, -23.250685308667975], "policy_adversary_policy_reward": [-15.598941454298652, -27.671852003134337, -48.04162828767963, -60.38167706932318, -2.43323215389589, -2.3503935483805245, 1.1626914625104163, -45.13864068105347, 13.217611055266595, -30.305614414108632, -10.919365898557118, -29.978610338661085, -4.5787133882004625, -27.161576806841396, -26.527791256575373, -13.794402500968872, -22.629398475830307, -47.667515550837976, 12.134120205764962, 1.1340347039124339, -6.218910361889286, 20.66710539557478, -26.39639151423795, -1.3362090366533579, -24.1828924740104, -2.7436369041047826, -25.567130787186578, -25.740316080270603, -7.587962576245047, -1.1366538317464645, -3.2781504532560994, -15.920150266670184, 26.198133689131176, -6.478610529564621, -4.618654308526686, 5.2851838082671065, -34.783264048139124, -48.11669658889326, -46.90828501554383, -15.850778762419253, -22.18040718409109, -16.12366551619768, -17.60934977670108, -29.97845407172157, 43.22741677403, -0.29800148629482504, -27.536642872827475, -41.01471290747314, -20.117231201352578, -35.30914337449611, -8.072209343607636, 33.81159256003894, -12.67984684329587, -33.154760362271546, 30.075533300810985, 32.73844596967836, -30.953656910189792, -22.358995465024385, -17.171307354120692, -21.083536871699557, -28.588568900126454, -7.778995656074791, -26.40920837408528, 0.11942731156576514, -8.455932859962786, -13.887617218854682, 1.9062241509176765, -9.6923009200422, -38.46561916290964, -27.854125453503492, -10.85532320853131, -24.915664557286703, -27.24528226437525, -32.57737303357205, -6.292398314351665, -16.902679614015767, 11.91168379038111, -9.72733372117294, -13.76380471712482, -23.338626408695806, 5.376033971667987, -6.843982858280764, -16.650670113170428, -8.922979921631258, -33.81297382754469, -40.79930545053882, -19.530199022721007, -52.06178897900955, -30.262967577438985, -13.688759170622804, -12.056789701471068, -33.11327108477308, -8.76012697237789, -31.823716414649972, -9.96862275642873, -22.991289977713006, -12.107806852308471, -23.37911539982112, 4.621522917689564, -13.58642598567009, -30.513666821763877, -23.877278577013968, 0.641228075843502, -23.17426972584401, 16.53114804774798, 3.1985380127135272, 20.372958816027303, 34.92911395642071, -43.55926719420948, -37.59148805841884, 13.500465730689228, -9.268765426876218, -26.851368997604034, -15.765912181233858, -29.666376583826104, -26.194649599272147, -9.294915773972924, -42.71008252522408, -20.244644065499365, -16.59825826320551, -5.776722176397608, 22.375072916913325, -19.3514270189434, 26.690521776556203, -23.703592007793876, -23.333124730103687, 18.036499352295454, 1.674844966480002, -51.63493140132247, -15.8295517986448, -21.86697287427606, -35.400068779410276, -24.120619546337846, -44.62131524115091, 20.01708943014239, -11.308968918516353, -12.581653712400012, -6.908905910411093, -28.741274627799882, -18.599862366068507, -21.979687295891672, -8.995604037767528, 18.741944075124536, 13.698914261283754, 6.90954048008134, -27.455009994819584, -21.224344082785024, -32.43226521943295, -2.3747516919723566, -16.781248860368102, -5.083439776654455, -1.13632391925929, 25.30021017409942, 14.422939991680298, -34.43162800263142, -41.68288939918029, 9.523673363999087, -15.058724826391042, -1.8577504071600188, -10.326033888503144, 3.393617808751159, 4.802378158932505, -25.224767452054746, -28.665432668688005, -32.42846034832773, 2.5214353841448016, -15.171887965560906, -21.784292243650565, -16.891320222849387, -1.7309108453092392, -13.449583023022882, -32.52401926579841, 1.676912692410962, -0.11706671893214704, 7.391170199513111, 20.77492563511975, -13.5504345520072, -11.933011071060587, -10.014617360426397, 38.149226612750596, -24.080590175590167, -38.0558199598605, 1.8949459755687563, -7.641458288218937, -12.929966172393435, -31.118924959474917, -13.823354678849899, 4.016779530234722, -2.5919135876226918, -11.39524211765173, -5.926110525507532, -26.140264152821068, 36.96839849618677, 34.137961180234754, -19.63424738945897, -43.29246026519236, -20.29477629131283, -29.032936414202766, -13.345597260056312, -9.905088048611663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38635232312657647, "mean_inference_ms": 0.9597867267957563, "mean_action_processing_ms": 0.1638826225600653, "mean_env_wait_ms": 0.056659148498455554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034303665161132812, "StateBufferConnector_ms": 0.0027083158493041992, "ViewRequirementAgentConnector_ms": 0.07050788402557373}, "num_episodes": 23, "episode_return_max": 142.21271935284304, "episode_return_min": -216.84661071400546, "episode_return_mean": -51.830451790432896}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.3147288057845, "num_env_steps_trained_throughput_per_sec": 502.3147288057845, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 8243.299, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8243.265, "sample_time_ms": 752.724, "learn_time_ms": 7478.909, "learn_throughput": 534.837, "synch_weights_time_ms": 11.054}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 112, "trial_id": "eaa30_00000", "date": "2024-08-09_17-55-33", "timestamp": 1723240533, "time_this_iter_s": 7.967609643936157, "time_total_s": 914.7305037975311, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17808c3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 914.7305037975311, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 22.099999999999998, "ram_util_percent": 80.27499999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.637919725185979, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.204034054468549, "policy_loss": 0.0016573615193554254, "vf_loss": 5.1998684978989695, "vf_explained_var": 0.08823862952530069, "kl": 0.014663450333176467, "entropy": 1.0502861800647918, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.935147589569291, "cur_kl_coeff": 0.7406156443530849, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.625988502800465, "policy_loss": -0.0051120267831720415, "vf_loss": 7.624982571601867, "vf_explained_var": 0.06580582049985727, "kl": 0.008260637884571527, "entropy": 1.4261595806727807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "env_runners": {"episode_reward_max": 142.21271935284304, "episode_reward_min": -162.30151050525683, "episode_reward_mean": -45.59163090594195, "episode_len_mean": 186.89, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18689, "policy_reward_min": {"agent_policy": -81.1507552526283, "adversary_policy": -52.06178897900955}, "policy_reward_max": {"agent_policy": 71.10635967642155, "adversary_policy": 43.22741677403}, "policy_reward_mean": {"agent_policy": -22.79581545297097, "adversary_policy": -11.397907726485482}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.85883057547034, -137.1027115606012, -110.85274915169738, 51.478766432862564, -91.66921441113476, 125.62795854097851, -106.62530475042838, -76.50968845164044, -72.73512911240249, -52.57956212503901, -44.68710015763494, -15.57215353824909, -132.63948923282618, -71.5419755316361, -119.64531059589464, -46.39015585673491, 4.36870013841634, -74.20486225164122, -2.9358977732255553, -51.14730006960335, -149.22455855616715, -143.1839760034612, -87.9034534961235, -90.34012157248816, -81.16768677405577, -65.91982546828349, -70.9738445042592, -17.92980613596105, -108.78189079755558, -45.066083300001, 39.45937212092301, 110.60414554489603, -162.30151050525683, 8.463400607626028, -85.23456235767566, -111.72205236619638, -104.00999659839422, -73.68580465740968, 33.196701481031425, 14.67818951522558, -94.07343347579513, 39.42268863755092, -134.92896639993455, -114.53408330737281, -137.4838695749777, 17.416241023252084, -38.9811192456222, -94.68227398773678, -61.95058266731844, 64.88171667281657, -41.09093902947649, -107.31321860443603, -38.31200110468092, -12.439527391827546, 79.44630033155926, -152.22903480362322, -11.07010292478391, -24.367568591326314, 16.39199193536733, -107.78040024148545, -59.8140499283658, -73.91236041842302, -37.24446213631725, -91.94720457764248, 3.119691946957687, 56.33219166926564, -50.966891246135575, 56.26921850464835, -124.2728202709012, -11.493024625300368, -88.0977822637368, -19.613150297230355, -27.974311410548843, -64.1327493566572, 142.21271935284304, -125.85341530930253, -98.6554254110313, -46.501370617335894, -28.824030948147858, 140.7330961692041, 7.584326700255584, 27.37744811971212, 67.72092258504622, -63.92629742290002, -41.95360569457882, -74.97209275629379, 21.269968221467813, -115.18278011659629, -26.41321631823486, -71.75944248627997, -30.872001018343127, -96.08267935949578, -93.38878418194909, -112.3052096700867, 71.37572045322833, -55.1040459658134, -67.5129778652709, -117.01834039852655, -91.21246703620236, -61.925509753074536], "episode_lengths": [56, 200, 200, 58, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 200, 200, 50, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [42.92941528773516, -68.55135578030065, -55.42637457584868, 25.739383216431303, -45.83460720556742, 62.813979270489284, -53.31265237521418, -38.25484422582025, -36.36756455620125, -26.28978106251952, -22.34355007881747, -7.786076769124524, -66.31974461641312, -35.77098776581801, -59.8226552979473, -23.195077928367436, 2.1843500692081705, -37.10243112582062, -1.4679488866127777, -25.57365003480168, -74.61227927808349, -71.59198800173056, -43.95172674806179, -45.17006078624415, -40.58384338702786, -32.95991273414174, -35.486922252129595, -8.964903067980526, -54.390945398777845, -22.533041650000502, 19.7296860604615, 55.30207277244801, -81.1507552526283, 4.23170030381301, -42.617281178837864, -55.861026183098254, -52.00499829919701, -36.842902328704874, 16.598350740515713, 7.339094757612802, -47.03671673789756, 19.71134431877546, -67.46448319996728, -57.26704165368634, -68.74193478748876, 8.708120511626042, -19.490559622811105, -47.34113699386839, -30.9752913336592, 32.440858336408326, -20.545469514738244, -53.65660930221799, -19.15600055234046, -6.219763695913745, 39.7231501657797, -76.11451740181161, -5.535051462391955, -12.183784295663163, 8.195995967683665, -53.89020012074275, -29.907024964182924, -36.956180209211475, -18.622231068158626, -45.97360228882128, 1.5598459734788221, 28.16609583463289, -25.483445623067787, 28.134609252324132, -62.136410135450646, -5.746512312650161, -44.048891131868345, -9.806575148615178, -13.987155705274422, -32.0663746783286, 71.10635967642155, -62.926707654651324, -49.327712705515594, -23.250685308667975, -14.412015474073883, 70.36654808460206, 3.7921633501277885, 13.688724059856053, 33.860461292523084, -31.96314871145003, -20.97680284728941, -37.486046378146966, 10.634984110733905, -57.59139005829809, -13.20660815911743, -35.87972124314004, -15.43600050917156, -48.04133967974791, -46.694392090974596, -56.152604835043405, 35.68786022661411, -27.55202298290672, -33.756488932635456, -58.509170199263316, -45.60623351810115, -30.96275487653731], "policy_adversary_policy_reward": [43.22741677403, -0.29800148629482504, -27.536642872827475, -41.01471290747314, -20.117231201352578, -35.30914337449611, -8.072209343607636, 33.81159256003894, -12.67984684329587, -33.154760362271546, 30.075533300810985, 32.73844596967836, -30.953656910189792, -22.358995465024385, -17.171307354120692, -21.083536871699557, -28.588568900126454, -7.778995656074791, -26.40920837408528, 0.11942731156576514, -8.455932859962786, -13.887617218854682, 1.9062241509176765, -9.6923009200422, -38.46561916290964, -27.854125453503492, -10.85532320853131, -24.915664557286703, -27.24528226437525, -32.57737303357205, -6.292398314351665, -16.902679614015767, 11.91168379038111, -9.72733372117294, -13.76380471712482, -23.338626408695806, 5.376033971667987, -6.843982858280764, -16.650670113170428, -8.922979921631258, -33.81297382754469, -40.79930545053882, -19.530199022721007, -52.06178897900955, -30.262967577438985, -13.688759170622804, -12.056789701471068, -33.11327108477308, -8.76012697237789, -31.823716414649972, -9.96862275642873, -22.991289977713006, -12.107806852308471, -23.37911539982112, 4.621522917689564, -13.58642598567009, -30.513666821763877, -23.877278577013968, 0.641228075843502, -23.17426972584401, 16.53114804774798, 3.1985380127135272, 20.372958816027303, 34.92911395642071, -43.55926719420948, -37.59148805841884, 13.500465730689228, -9.268765426876218, -26.851368997604034, -15.765912181233858, -29.666376583826104, -26.194649599272147, -9.294915773972924, -42.71008252522408, -20.244644065499365, -16.59825826320551, -5.776722176397608, 22.375072916913325, -19.3514270189434, 26.690521776556203, -23.703592007793876, -23.333124730103687, 18.036499352295454, 1.674844966480002, -51.63493140132247, -15.8295517986448, -21.86697287427606, -35.400068779410276, -24.120619546337846, -44.62131524115091, 20.01708943014239, -11.308968918516353, -12.581653712400012, -6.908905910411093, -28.741274627799882, -18.599862366068507, -21.979687295891672, -8.995604037767528, 18.741944075124536, 13.698914261283754, 6.90954048008134, -27.455009994819584, -21.224344082785024, -32.43226521943295, -2.3747516919723566, -16.781248860368102, -5.083439776654455, -1.13632391925929, 25.30021017409942, 14.422939991680298, -34.43162800263142, -41.68288939918029, 9.523673363999087, -15.058724826391042, -1.8577504071600188, -10.326033888503144, 3.393617808751159, 4.802378158932505, -25.224767452054746, -28.665432668688005, -32.42846034832773, 2.5214353841448016, -15.171887965560906, -21.784292243650565, -16.891320222849387, -1.7309108453092392, -13.449583023022882, -32.52401926579841, 1.676912692410962, -0.11706671893214704, 7.391170199513111, 20.77492563511975, -13.5504345520072, -11.933011071060587, -10.014617360426397, 38.149226612750596, -24.080590175590167, -38.0558199598605, 1.8949459755687563, -7.641458288218937, -12.929966172393435, -31.118924959474917, -13.823354678849899, 4.016779530234722, -2.5919135876226918, -11.39524211765173, -5.926110525507532, -26.140264152821068, 36.96839849618677, 34.137961180234754, -19.63424738945897, -43.29246026519236, -20.29477629131283, -29.032936414202766, -13.345597260056312, -9.905088048611663, -7.64446747951845, -6.767547994555439, 39.35192997601554, 31.014618108586518, 0.2181144179202441, 3.5740489322075426, 11.986345650820319, 1.7023784090357346, 5.327229927085215, 28.533231365437896, -16.572762753045172, -15.390385958404863, -2.439335736274799, -18.53746711101461, -22.437255595202377, -15.048790782944558, 4.372590553476158, 6.262393557257747, -23.945054553782043, -33.646335504516045, -8.21405532544501, -4.99255283367242, -15.857184674196901, -20.022536568943135, -16.143008634517788, 0.7070081253462241, -31.205232168973566, -16.836107510774344, -14.061681767009592, -32.63271032396501, -32.499711140332984, -23.652893694710418, 32.00664153968524, 3.6812186869289327, -20.70373362050247, -6.848289362404252, -21.727153247945463, -12.029335684689995, -32.72541872322556, -25.783751476037764, -25.352781558281222, -20.253451959819927, -9.148979135843756, -21.813775740693554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3862161068524217, "mean_inference_ms": 0.9595231307638364, "mean_action_processing_ms": 0.16382747439636083, "mean_env_wait_ms": 0.05666251551815126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032922029495239258, "StateBufferConnector_ms": 0.0026203393936157227, "ViewRequirementAgentConnector_ms": 0.0648583173751831}, "num_episodes": 22, "episode_return_max": 142.21271935284304, "episode_return_min": -162.30151050525683, "episode_return_mean": -45.59163090594195}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.6601121847403, "num_env_steps_trained_throughput_per_sec": 503.6601121847403, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 1356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 8148.805, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8148.771, "sample_time_ms": 747.427, "learn_time_ms": 7389.901, "learn_throughput": 541.279, "synch_weights_time_ms": 10.874}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "training_iteration": 113, "trial_id": "eaa30_00000", "date": "2024-08-09_17-55-42", "timestamp": 1723240542, "time_this_iter_s": 7.946753025054932, "time_total_s": 922.6772568225861, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17808c700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 922.6772568225861, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 21.772727272727273, "ram_util_percent": 80.23636363636365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.906079057537058, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.192138377699272, "policy_loss": 0.0011911325866267794, "vf_loss": 6.188593587925825, "vf_explained_var": -0.0014963452778165303, "kl": 0.013759809135700818, "entropy": 1.0267502739315941, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.829915674279134, "cur_kl_coeff": 0.7406156443530849, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.58846837580204, "policy_loss": -0.005336062404482315, "vf_loss": 7.585768549144268, "vf_explained_var": -0.005126331994930903, "kl": 0.010850231419802488, "entropy": 1.3870064343015354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "env_runners": {"episode_reward_max": 142.21271935284304, "episode_reward_min": -162.30151050525683, "episode_reward_mean": -36.106086816954246, "episode_len_mean": 189.96, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18996, "policy_reward_min": {"agent_policy": -81.1507552526283, "adversary_policy": -52.06178897900955}, "policy_reward_max": {"agent_policy": 71.10635967642155, "adversary_policy": 39.35192997601554}, "policy_reward_mean": {"agent_policy": -18.053043408477127, "adversary_policy": -9.026521704238565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149.22455855616715, -143.1839760034612, -87.9034534961235, -90.34012157248816, -81.16768677405577, -65.91982546828349, -70.9738445042592, -17.92980613596105, -108.78189079755558, -45.066083300001, 39.45937212092301, 110.60414554489603, -162.30151050525683, 8.463400607626028, -85.23456235767566, -111.72205236619638, -104.00999659839422, -73.68580465740968, 33.196701481031425, 14.67818951522558, -94.07343347579513, 39.42268863755092, -134.92896639993455, -114.53408330737281, -137.4838695749777, 17.416241023252084, -38.9811192456222, -94.68227398773678, -61.95058266731844, 64.88171667281657, -41.09093902947649, -107.31321860443603, -38.31200110468092, -12.439527391827546, 79.44630033155926, -152.22903480362322, -11.07010292478391, -24.367568591326314, 16.39199193536733, -107.78040024148545, -59.8140499283658, -73.91236041842302, -37.24446213631725, -91.94720457764248, 3.119691946957687, 56.33219166926564, -50.966891246135575, 56.26921850464835, -124.2728202709012, -11.493024625300368, -88.0977822637368, -19.613150297230355, -27.974311410548843, -64.1327493566572, 142.21271935284304, -125.85341530930253, -98.6554254110313, -46.501370617335894, -28.824030948147858, 140.7330961692041, 7.584326700255584, 27.37744811971212, 67.72092258504622, -63.92629742290002, -41.95360569457882, -74.97209275629379, 21.269968221467813, -115.18278011659629, -26.41321631823486, -71.75944248627997, -30.872001018343127, -96.08267935949578, -93.38878418194909, -112.3052096700867, 71.37572045322833, -55.1040459658134, -67.5129778652709, -117.01834039852655, -91.21246703620236, -61.925509753074536, -9.169328497707724, -33.99660893841108, -29.372933968076623, 37.486785492944634, 8.514777554146647, 1.8237784308182903, 21.78250421712842, 68.98558234284337, -36.85048206441045, -8.92232858199133, -5.883651411559622, -20.591715260866273, 1.6075425904228666, 47.11941304728683, 41.087314480152216, -16.901242143322094, -27.42920361439061, 63.30449373446746, 4.002422842968759, -97.54706023633724], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 200, 200, 50, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-74.61227927808349, -71.59198800173056, -43.95172674806179, -45.17006078624415, -40.58384338702786, -32.95991273414174, -35.486922252129595, -8.964903067980526, -54.390945398777845, -22.533041650000502, 19.7296860604615, 55.30207277244801, -81.1507552526283, 4.23170030381301, -42.617281178837864, -55.861026183098254, -52.00499829919701, -36.842902328704874, 16.598350740515713, 7.339094757612802, -47.03671673789756, 19.71134431877546, -67.46448319996728, -57.26704165368634, -68.74193478748876, 8.708120511626042, -19.490559622811105, -47.34113699386839, -30.9752913336592, 32.440858336408326, -20.545469514738244, -53.65660930221799, -19.15600055234046, -6.219763695913745, 39.7231501657797, -76.11451740181161, -5.535051462391955, -12.183784295663163, 8.195995967683665, -53.89020012074275, -29.907024964182924, -36.956180209211475, -18.622231068158626, -45.97360228882128, 1.5598459734788221, 28.16609583463289, -25.483445623067787, 28.134609252324132, -62.136410135450646, -5.746512312650161, -44.048891131868345, -9.806575148615178, -13.987155705274422, -32.0663746783286, 71.10635967642155, -62.926707654651324, -49.327712705515594, -23.250685308667975, -14.412015474073883, 70.36654808460206, 3.7921633501277885, 13.688724059856053, 33.860461292523084, -31.96314871145003, -20.97680284728941, -37.486046378146966, 10.634984110733905, -57.59139005829809, -13.20660815911743, -35.87972124314004, -15.43600050917156, -48.04133967974791, -46.694392090974596, -56.152604835043405, 35.68786022661411, -27.55202298290672, -33.756488932635456, -58.509170199263316, -45.60623351810115, -30.96275487653731, -4.584664248853887, -16.998304469205564, -14.686466984038322, 18.743392746472313, 4.257388777073331, 0.9118892154091434, 10.891252108564213, 34.49279117142167, -18.425241032205225, -4.46116429099566, -2.941825705779813, -10.295857630433133, 0.8037712952114369, 23.559706523643413, 20.543657240076108, -8.450621071661047, -13.714601807195308, 31.65224686723369, 2.001211421484376, -48.773530118168594], "policy_adversary_policy_reward": [-33.81297382754469, -40.79930545053882, -19.530199022721007, -52.06178897900955, -30.262967577438985, -13.688759170622804, -12.056789701471068, -33.11327108477308, -8.76012697237789, -31.823716414649972, -9.96862275642873, -22.991289977713006, -12.107806852308471, -23.37911539982112, 4.621522917689564, -13.58642598567009, -30.513666821763877, -23.877278577013968, 0.641228075843502, -23.17426972584401, 16.53114804774798, 3.1985380127135272, 20.372958816027303, 34.92911395642071, -43.55926719420948, -37.59148805841884, 13.500465730689228, -9.268765426876218, -26.851368997604034, -15.765912181233858, -29.666376583826104, -26.194649599272147, -9.294915773972924, -42.71008252522408, -20.244644065499365, -16.59825826320551, -5.776722176397608, 22.375072916913325, -19.3514270189434, 26.690521776556203, -23.703592007793876, -23.333124730103687, 18.036499352295454, 1.674844966480002, -51.63493140132247, -15.8295517986448, -21.86697287427606, -35.400068779410276, -24.120619546337846, -44.62131524115091, 20.01708943014239, -11.308968918516353, -12.581653712400012, -6.908905910411093, -28.741274627799882, -18.599862366068507, -21.979687295891672, -8.995604037767528, 18.741944075124536, 13.698914261283754, 6.90954048008134, -27.455009994819584, -21.224344082785024, -32.43226521943295, -2.3747516919723566, -16.781248860368102, -5.083439776654455, -1.13632391925929, 25.30021017409942, 14.422939991680298, -34.43162800263142, -41.68288939918029, 9.523673363999087, -15.058724826391042, -1.8577504071600188, -10.326033888503144, 3.393617808751159, 4.802378158932505, -25.224767452054746, -28.665432668688005, -32.42846034832773, 2.5214353841448016, -15.171887965560906, -21.784292243650565, -16.891320222849387, -1.7309108453092392, -13.449583023022882, -32.52401926579841, 1.676912692410962, -0.11706671893214704, 7.391170199513111, 20.77492563511975, -13.5504345520072, -11.933011071060587, -10.014617360426397, 38.149226612750596, -24.080590175590167, -38.0558199598605, 1.8949459755687563, -7.641458288218937, -12.929966172393435, -31.118924959474917, -13.823354678849899, 4.016779530234722, -2.5919135876226918, -11.39524211765173, -5.926110525507532, -26.140264152821068, 36.96839849618677, 34.137961180234754, -19.63424738945897, -43.29246026519236, -20.29477629131283, -29.032936414202766, -13.345597260056312, -9.905088048611663, -7.64446747951845, -6.767547994555439, 39.35192997601554, 31.014618108586518, 0.2181144179202441, 3.5740489322075426, 11.986345650820319, 1.7023784090357346, 5.327229927085215, 28.533231365437896, -16.572762753045172, -15.390385958404863, -2.439335736274799, -18.53746711101461, -22.437255595202377, -15.048790782944558, 4.372590553476158, 6.262393557257747, -23.945054553782043, -33.646335504516045, -8.21405532544501, -4.99255283367242, -15.857184674196901, -20.022536568943135, -16.143008634517788, 0.7070081253462241, -31.205232168973566, -16.836107510774344, -14.061681767009592, -32.63271032396501, -32.499711140332984, -23.652893694710418, 32.00664153968524, 3.6812186869289327, -20.70373362050247, -6.848289362404252, -21.727153247945463, -12.029335684689995, -32.72541872322556, -25.783751476037764, -25.352781558281222, -20.253451959819927, -9.148979135843756, -21.813775740693554, 16.74469964514018, -21.32936389399407, -4.504494876180544, -12.49380959302502, -6.619809853019291, -8.066657131019035, 3.0914411695340114, 15.651951576938302, 16.46924807452327, -12.21185929744994, 8.762069217823544, -7.850180002414399, 6.91808034801717, 3.9731717605470447, 8.74568476686233, 25.74710640455934, 2.915299028937042, -21.340540061142267, -7.512362494298351, 3.0511982033026896, 5.001558577979257, -7.94338428375907, -8.34560724600996, -1.9502503844231711, -1.9138634632844749, 2.7176347584959117, -5.544983760272238, 29.10469028391565, 12.559461064325959, 7.984196175750149, -16.74811366211767, 8.297492590456628, -19.429033401280265, 5.714431594084953, 15.686355918980748, 15.965890948252948, 1.19187546702768, 0.8093359544566958, -31.569568641162434, -17.203961477006168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38605015610064775, "mean_inference_ms": 0.9587928446755382, "mean_action_processing_ms": 0.16383720719354183, "mean_env_wait_ms": 0.05666771160518533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003234267234802246, "StateBufferConnector_ms": 0.002620697021484375, "ViewRequirementAgentConnector_ms": 0.06510937213897705}, "num_episodes": 20, "episode_return_max": 142.21271935284304, "episode_return_min": -162.30151050525683, "episode_return_mean": -36.106086816954246}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.63575537014464, "num_env_steps_trained_throughput_per_sec": 502.63575537014464, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 1368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 8106.364, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8106.329, "sample_time_ms": 735.582, "learn_time_ms": 7359.216, "learn_throughput": 543.536, "synch_weights_time_ms": 10.962}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "training_iteration": 114, "trial_id": "eaa30_00000", "date": "2024-08-09_17-55-50", "timestamp": 1723240550, "time_this_iter_s": 7.963788032531738, "time_total_s": 930.6410448551178, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1780fbe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 930.6410448551178, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 23.650000000000002, "ram_util_percent": 80.20833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.77609082113498, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.331099234434663, "policy_loss": -0.002647749392843002, "vf_loss": 5.330757362628109, "vf_explained_var": 0.02378007968266805, "kl": 0.017477804754993744, "entropy": 1.0176537671101786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.669282603636384, "cur_kl_coeff": 0.7406156443530849, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.449967852731546, "policy_loss": 0.0035579743060225157, "vf_loss": 7.429573660592238, "vf_explained_var": 0.07536537268509468, "kl": 0.02273269741272088, "entropy": 1.3490741314987342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 109920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "env_runners": {"episode_reward_max": 148.20530677742977, "episode_reward_min": -152.22903480362322, "episode_reward_mean": -20.776650666105997, "episode_len_mean": 188.0, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18800, "policy_reward_min": {"agent_policy": -76.11451740181161, "adversary_policy": -51.63493140132247}, "policy_reward_max": {"agent_policy": 74.10265338871497, "adversary_policy": 45.80348454633233}, "policy_reward_mean": {"agent_policy": -10.388325333052997, "adversary_policy": -5.194162666526499}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.42268863755092, -134.92896639993455, -114.53408330737281, -137.4838695749777, 17.416241023252084, -38.9811192456222, -94.68227398773678, -61.95058266731844, 64.88171667281657, -41.09093902947649, -107.31321860443603, -38.31200110468092, -12.439527391827546, 79.44630033155926, -152.22903480362322, -11.07010292478391, -24.367568591326314, 16.39199193536733, -107.78040024148545, -59.8140499283658, -73.91236041842302, -37.24446213631725, -91.94720457764248, 3.119691946957687, 56.33219166926564, -50.966891246135575, 56.26921850464835, -124.2728202709012, -11.493024625300368, -88.0977822637368, -19.613150297230355, -27.974311410548843, -64.1327493566572, 142.21271935284304, -125.85341530930253, -98.6554254110313, -46.501370617335894, -28.824030948147858, 140.7330961692041, 7.584326700255584, 27.37744811971212, 67.72092258504622, -63.92629742290002, -41.95360569457882, -74.97209275629379, 21.269968221467813, -115.18278011659629, -26.41321631823486, -71.75944248627997, -30.872001018343127, -96.08267935949578, -93.38878418194909, -112.3052096700867, 71.37572045322833, -55.1040459658134, -67.5129778652709, -117.01834039852655, -91.21246703620236, -61.925509753074536, -9.169328497707724, -33.99660893841108, -29.372933968076623, 37.486785492944634, 8.514777554146647, 1.8237784308182903, 21.78250421712842, 68.98558234284337, -36.85048206441045, -8.92232858199133, -5.883651411559622, -20.591715260866273, 1.6075425904228666, 47.11941304728683, 41.087314480152216, -16.901242143322094, -27.42920361439061, 63.30449373446746, 4.002422842968759, -97.54706023633724, -40.89765466953299, 71.14569831660448, -103.49617798278109, 17.627283352499234, -24.86414816991165, -98.5767072128663, 61.18825538243464, 3.7760278846156154, 148.20530677742977, 77.98249505694997, 62.91022632124705, -74.32251399828908, 57.31877370133445, 101.77463808461528, -94.78660739321296, 0.5145399018685302, 5.747109573759154, 75.83963167715022, 28.630495971049612, -56.12829951924233, 28.238444729722403], "episode_lengths": [200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 200, 200, 50, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 196, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [19.71134431877546, -67.46448319996728, -57.26704165368634, -68.74193478748876, 8.708120511626042, -19.490559622811105, -47.34113699386839, -30.9752913336592, 32.440858336408326, -20.545469514738244, -53.65660930221799, -19.15600055234046, -6.219763695913745, 39.7231501657797, -76.11451740181161, -5.535051462391955, -12.183784295663163, 8.195995967683665, -53.89020012074275, -29.907024964182924, -36.956180209211475, -18.622231068158626, -45.97360228882128, 1.5598459734788221, 28.16609583463289, -25.483445623067787, 28.134609252324132, -62.136410135450646, -5.746512312650161, -44.048891131868345, -9.806575148615178, -13.987155705274422, -32.0663746783286, 71.10635967642155, -62.926707654651324, -49.327712705515594, -23.250685308667975, -14.412015474073883, 70.36654808460206, 3.7921633501277885, 13.688724059856053, 33.860461292523084, -31.96314871145003, -20.97680284728941, -37.486046378146966, 10.634984110733905, -57.59139005829809, -13.20660815911743, -35.87972124314004, -15.43600050917156, -48.04133967974791, -46.694392090974596, -56.152604835043405, 35.68786022661411, -27.55202298290672, -33.756488932635456, -58.509170199263316, -45.60623351810115, -30.96275487653731, -4.584664248853887, -16.998304469205564, -14.686466984038322, 18.743392746472313, 4.257388777073331, 0.9118892154091434, 10.891252108564213, 34.49279117142167, -18.425241032205225, -4.46116429099566, -2.941825705779813, -10.295857630433133, 0.8037712952114369, 23.559706523643413, 20.543657240076108, -8.450621071661047, -13.714601807195308, 31.65224686723369, 2.001211421484376, -48.773530118168594, -20.448827334766484, 35.57284915830222, -51.7480889913905, 8.813641676249624, -12.432074084955829, -49.28835360643316, 30.594127691217317, 1.8880139423078113, 74.10265338871497, 38.991247528474936, 31.455113160623515, -37.16125699914455, 28.659386850667232, 50.88731904230768, -47.3933036966065, 0.2572699509342651, 2.8735547868796054, 37.91981583857514, 14.315247985524806, -28.064149759621117, 14.119222364861201], "policy_adversary_policy_reward": [18.036499352295454, 1.674844966480002, -51.63493140132247, -15.8295517986448, -21.86697287427606, -35.400068779410276, -24.120619546337846, -44.62131524115091, 20.01708943014239, -11.308968918516353, -12.581653712400012, -6.908905910411093, -28.741274627799882, -18.599862366068507, -21.979687295891672, -8.995604037767528, 18.741944075124536, 13.698914261283754, 6.90954048008134, -27.455009994819584, -21.224344082785024, -32.43226521943295, -2.3747516919723566, -16.781248860368102, -5.083439776654455, -1.13632391925929, 25.30021017409942, 14.422939991680298, -34.43162800263142, -41.68288939918029, 9.523673363999087, -15.058724826391042, -1.8577504071600188, -10.326033888503144, 3.393617808751159, 4.802378158932505, -25.224767452054746, -28.665432668688005, -32.42846034832773, 2.5214353841448016, -15.171887965560906, -21.784292243650565, -16.891320222849387, -1.7309108453092392, -13.449583023022882, -32.52401926579841, 1.676912692410962, -0.11706671893214704, 7.391170199513111, 20.77492563511975, -13.5504345520072, -11.933011071060587, -10.014617360426397, 38.149226612750596, -24.080590175590167, -38.0558199598605, 1.8949459755687563, -7.641458288218937, -12.929966172393435, -31.118924959474917, -13.823354678849899, 4.016779530234722, -2.5919135876226918, -11.39524211765173, -5.926110525507532, -26.140264152821068, 36.96839849618677, 34.137961180234754, -19.63424738945897, -43.29246026519236, -20.29477629131283, -29.032936414202766, -13.345597260056312, -9.905088048611663, -7.64446747951845, -6.767547994555439, 39.35192997601554, 31.014618108586518, 0.2181144179202441, 3.5740489322075426, 11.986345650820319, 1.7023784090357346, 5.327229927085215, 28.533231365437896, -16.572762753045172, -15.390385958404863, -2.439335736274799, -18.53746711101461, -22.437255595202377, -15.048790782944558, 4.372590553476158, 6.262393557257747, -23.945054553782043, -33.646335504516045, -8.21405532544501, -4.99255283367242, -15.857184674196901, -20.022536568943135, -16.143008634517788, 0.7070081253462241, -31.205232168973566, -16.836107510774344, -14.061681767009592, -32.63271032396501, -32.499711140332984, -23.652893694710418, 32.00664153968524, 3.6812186869289327, -20.70373362050247, -6.848289362404252, -21.727153247945463, -12.029335684689995, -32.72541872322556, -25.783751476037764, -25.352781558281222, -20.253451959819927, -9.148979135843756, -21.813775740693554, 16.74469964514018, -21.32936389399407, -4.504494876180544, -12.49380959302502, -6.619809853019291, -8.066657131019035, 3.0914411695340114, 15.651951576938302, 16.46924807452327, -12.21185929744994, 8.762069217823544, -7.850180002414399, 6.91808034801717, 3.9731717605470447, 8.74568476686233, 25.74710640455934, 2.915299028937042, -21.340540061142267, -7.512362494298351, 3.0511982033026896, 5.001558577979257, -7.94338428375907, -8.34560724600996, -1.9502503844231711, -1.9138634632844749, 2.7176347584959117, -5.544983760272238, 29.10469028391565, 12.559461064325959, 7.984196175750149, -16.74811366211767, 8.297492590456628, -19.429033401280265, 5.714431594084953, 15.686355918980748, 15.965890948252948, 1.19187546702768, 0.8093359544566958, -31.569568641162434, -17.203961477006168, -16.748119147171575, -3.7007081875949055, 19.257916464402154, 16.314932693900097, -27.58009049940221, -24.167998491988296, 3.00528778464993, 5.808353891599694, 14.694626965322108, -27.126701050277937, -27.826084303279373, -21.462269303153782, 11.937276443643029, 18.656851247574288, 10.980745095492257, -9.092731153184445, 28.29916884238262, 45.80348454633233, 13.008328023617857, 25.982919504857087, -2.259023170655002, 33.71413633127852, -32.4583541744585, -4.702902824686042, 6.855381487260807, 21.804005363406414, 10.353396303909893, 40.53392273839775, -27.786984367094014, -19.60631932951249, 1.013766334409684, -0.7564963834754188, 3.4626543649152044, -0.5890995780356114, 26.654812510076525, 11.2650033284986, 6.360584582053155, 7.954663403471651, 0.5551335709464382, -28.619283330567555, 6.293569680572283, 7.825652684288919]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38590028172969576, "mean_inference_ms": 0.9584253294123474, "mean_action_processing_ms": 0.1638418718243183, "mean_env_wait_ms": 0.056645717296496825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003179192543029785, "StateBufferConnector_ms": 0.002401113510131836, "ViewRequirementAgentConnector_ms": 0.06425559520721436}, "num_episodes": 21, "episode_return_max": 148.20530677742977, "episode_return_min": -152.22903480362322, "episode_return_mean": -20.776650666105997}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.48519057188645, "num_env_steps_trained_throughput_per_sec": 504.48519057188645, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 1380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 8093.408, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8093.373, "sample_time_ms": 736.397, "learn_time_ms": 7345.333, "learn_throughput": 544.563, "synch_weights_time_ms": 11.067}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "training_iteration": 115, "trial_id": "eaa30_00000", "date": "2024-08-09_17-55-58", "timestamp": 1723240558, "time_this_iter_s": 7.933012962341309, "time_total_s": 938.5740578174591, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17808cd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 938.5740578174591, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 28.581818181818186, "ram_util_percent": 80.23636363636362}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.443399701484297, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.335439418611072, "policy_loss": -0.0030108945256976222, "vf_loss": 6.335733362480446, "vf_explained_var": 0.038068459998993644, "kl": 0.015883742131677175, "entropy": 0.9522220540298987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.438146939501166, "cur_kl_coeff": 1.1109234665296275, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.970294524232546, "policy_loss": 0.0001940146496053785, "vf_loss": 7.955231910943985, "vf_explained_var": -0.04235219284892082, "kl": 0.01338399765615274, "entropy": 1.330916233236591, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 110880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 148.20530677742977, "episode_reward_min": -125.85341530930253, "episode_reward_mean": 0.18625434104108934, "episode_len_mean": 185.78, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 18578, "policy_reward_min": {"agent_policy": -62.926707654651324, "adversary_policy": -43.29246026519236}, "policy_reward_max": {"agent_policy": 74.10265338871497, "adversary_policy": 45.80348454633233}, "policy_reward_mean": {"agent_policy": 0.09312717052054122, "adversary_policy": 0.04656358526027077}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.33219166926564, -50.966891246135575, 56.26921850464835, -124.2728202709012, -11.493024625300368, -88.0977822637368, -19.613150297230355, -27.974311410548843, -64.1327493566572, 142.21271935284304, -125.85341530930253, -98.6554254110313, -46.501370617335894, -28.824030948147858, 140.7330961692041, 7.584326700255584, 27.37744811971212, 67.72092258504622, -63.92629742290002, -41.95360569457882, -74.97209275629379, 21.269968221467813, -115.18278011659629, -26.41321631823486, -71.75944248627997, -30.872001018343127, -96.08267935949578, -93.38878418194909, -112.3052096700867, 71.37572045322833, -55.1040459658134, -67.5129778652709, -117.01834039852655, -91.21246703620236, -61.925509753074536, -9.169328497707724, -33.99660893841108, -29.372933968076623, 37.486785492944634, 8.514777554146647, 1.8237784308182903, 21.78250421712842, 68.98558234284337, -36.85048206441045, -8.92232858199133, -5.883651411559622, -20.591715260866273, 1.6075425904228666, 47.11941304728683, 41.087314480152216, -16.901242143322094, -27.42920361439061, 63.30449373446746, 4.002422842968759, -97.54706023633724, -40.89765466953299, 71.14569831660448, -103.49617798278109, 17.627283352499234, -24.86414816991165, -98.5767072128663, 61.18825538243464, 3.7760278846156154, 148.20530677742977, 77.98249505694997, 62.91022632124705, -74.32251399828908, 57.31877370133445, 101.77463808461528, -94.78660739321296, 0.5145399018685302, 5.747109573759154, 75.83963167715022, 28.630495971049612, -56.12829951924233, 28.238444729722403, -29.707821973943226, 1.6057641732502859, 52.19071640619029, 37.91239253646553, 89.84986047235628, 54.54268339542238, 55.485942501250115, 24.664346768503428, 14.235138807173847, 48.801684395233536, 36.45295666031255, -34.457887686857966, 115.29928917244402, 15.081592501565176, 121.29354803079971, 24.26430219989782, 30.847688277251336, 2.9709005157010395, 108.9561893451925, 74.55332631785677, 67.02152654621598, 5.259782515265467, -1.5807008216291507, 61.34414527094361], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 200, 200, 50, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 196, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 79, 200, 37, 200, 200, 200, 200, 200, 195, 174, 200, 200, 73, 148, 200, 200, 200, 200, 200, 200, 100, 200, 200], "policy_agent_policy_reward": [28.16609583463289, -25.483445623067787, 28.134609252324132, -62.136410135450646, -5.746512312650161, -44.048891131868345, -9.806575148615178, -13.987155705274422, -32.0663746783286, 71.10635967642155, -62.926707654651324, -49.327712705515594, -23.250685308667975, -14.412015474073883, 70.36654808460206, 3.7921633501277885, 13.688724059856053, 33.860461292523084, -31.96314871145003, -20.97680284728941, -37.486046378146966, 10.634984110733905, -57.59139005829809, -13.20660815911743, -35.87972124314004, -15.43600050917156, -48.04133967974791, -46.694392090974596, -56.152604835043405, 35.68786022661411, -27.55202298290672, -33.756488932635456, -58.509170199263316, -45.60623351810115, -30.96275487653731, -4.584664248853887, -16.998304469205564, -14.686466984038322, 18.743392746472313, 4.257388777073331, 0.9118892154091434, 10.891252108564213, 34.49279117142167, -18.425241032205225, -4.46116429099566, -2.941825705779813, -10.295857630433133, 0.8037712952114369, 23.559706523643413, 20.543657240076108, -8.450621071661047, -13.714601807195308, 31.65224686723369, 2.001211421484376, -48.773530118168594, -20.448827334766484, 35.57284915830222, -51.7480889913905, 8.813641676249624, -12.432074084955829, -49.28835360643316, 30.594127691217317, 1.8880139423078113, 74.10265338871497, 38.991247528474936, 31.455113160623515, -37.16125699914455, 28.659386850667232, 50.88731904230768, -47.3933036966065, 0.2572699509342651, 2.8735547868796054, 37.91981583857514, 14.315247985524806, -28.064149759621117, 14.119222364861201, -14.853910986971634, 0.8028820866251412, 26.095358203095145, 18.95619626823277, 44.924930236178135, 27.27134169771118, 27.742971250625047, 12.33217338425171, 7.1175694035869235, 24.400842197616786, 18.2264783301563, -17.22894384342898, 57.649644586221925, 7.540796250782587, 60.64677401539984, 12.13215109994891, 15.423844138625666, 1.4854502578505482, 54.47809467259624, 37.2766631589284, 33.51076327310797, 2.629891257632731, -0.7903504108145789, 30.672072635471817], "policy_adversary_policy_reward": [7.391170199513111, 20.77492563511975, -13.5504345520072, -11.933011071060587, -10.014617360426397, 38.149226612750596, -24.080590175590167, -38.0558199598605, 1.8949459755687563, -7.641458288218937, -12.929966172393435, -31.118924959474917, -13.823354678849899, 4.016779530234722, -2.5919135876226918, -11.39524211765173, -5.926110525507532, -26.140264152821068, 36.96839849618677, 34.137961180234754, -19.63424738945897, -43.29246026519236, -20.29477629131283, -29.032936414202766, -13.345597260056312, -9.905088048611663, -7.64446747951845, -6.767547994555439, 39.35192997601554, 31.014618108586518, 0.2181144179202441, 3.5740489322075426, 11.986345650820319, 1.7023784090357346, 5.327229927085215, 28.533231365437896, -16.572762753045172, -15.390385958404863, -2.439335736274799, -18.53746711101461, -22.437255595202377, -15.048790782944558, 4.372590553476158, 6.262393557257747, -23.945054553782043, -33.646335504516045, -8.21405532544501, -4.99255283367242, -15.857184674196901, -20.022536568943135, -16.143008634517788, 0.7070081253462241, -31.205232168973566, -16.836107510774344, -14.061681767009592, -32.63271032396501, -32.499711140332984, -23.652893694710418, 32.00664153968524, 3.6812186869289327, -20.70373362050247, -6.848289362404252, -21.727153247945463, -12.029335684689995, -32.72541872322556, -25.783751476037764, -25.352781558281222, -20.253451959819927, -9.148979135843756, -21.813775740693554, 16.74469964514018, -21.32936389399407, -4.504494876180544, -12.49380959302502, -6.619809853019291, -8.066657131019035, 3.0914411695340114, 15.651951576938302, 16.46924807452327, -12.21185929744994, 8.762069217823544, -7.850180002414399, 6.91808034801717, 3.9731717605470447, 8.74568476686233, 25.74710640455934, 2.915299028937042, -21.340540061142267, -7.512362494298351, 3.0511982033026896, 5.001558577979257, -7.94338428375907, -8.34560724600996, -1.9502503844231711, -1.9138634632844749, 2.7176347584959117, -5.544983760272238, 29.10469028391565, 12.559461064325959, 7.984196175750149, -16.74811366211767, 8.297492590456628, -19.429033401280265, 5.714431594084953, 15.686355918980748, 15.965890948252948, 1.19187546702768, 0.8093359544566958, -31.569568641162434, -17.203961477006168, -16.748119147171575, -3.7007081875949055, 19.257916464402154, 16.314932693900097, -27.58009049940221, -24.167998491988296, 3.00528778464993, 5.808353891599694, 14.694626965322108, -27.126701050277937, -27.826084303279373, -21.462269303153782, 11.937276443643029, 18.656851247574288, 10.980745095492257, -9.092731153184445, 28.29916884238262, 45.80348454633233, 13.008328023617857, 25.982919504857087, -2.259023170655002, 33.71413633127852, -32.4583541744585, -4.702902824686042, 6.855381487260807, 21.804005363406414, 10.353396303909893, 40.53392273839775, -27.786984367094014, -19.60631932951249, 1.013766334409684, -0.7564963834754188, 3.4626543649152044, -0.5890995780356114, 26.654812510076525, 11.2650033284986, 6.360584582053155, 7.954663403471651, 0.5551335709464382, -28.619283330567555, 6.293569680572283, 7.825652684288919, 3.0977487900063068, -17.951659776977944, 15.658233832222319, -14.85535174559718, 6.140407779653415, 19.95495042344173, -3.875891276165035, 22.832087544397805, 21.64468136185413, 23.28024887432401, 11.207563583673739, 16.063778114037447, 32.007060976457566, -4.26408972583252, 2.6950036427186745, 9.637169741533029, 6.210425707522305, 0.9071436960646189, 13.4818147466199, 10.919027450996888, 29.696827794878384, -11.470349464722084, -12.21150388859427, -5.01743995483471, 28.527733383012738, 29.1219112032092, 29.33146751918972, -21.790671268407134, 23.330798278508233, 37.31597573689161, -15.588408530494032, 27.720559630442942, -14.888035273555587, 30.311879412181256, 12.002743283065907, -10.517293025215366, 23.532620731280836, 30.9454739413154, 22.100300202714504, 15.176362956213897, 23.478677465089028, 10.032085808018941, -11.967901727379221, 14.59779298501195, 1.6161382123263053, -2.4064886231408824, 2.604019140471028, 28.06805349500079]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38573826475922773, "mean_inference_ms": 0.9584549077749424, "mean_action_processing_ms": 0.16379327233000407, "mean_env_wait_ms": 0.05661373705657523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032007694244384766, "StateBufferConnector_ms": 0.002354860305786133, "ViewRequirementAgentConnector_ms": 0.06336188316345215}, "num_episodes": 24, "episode_return_max": 148.20530677742977, "episode_return_min": -125.85341530930253, "episode_return_mean": 0.18625434104108934}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 508.1075531454972, "num_env_steps_trained_throughput_per_sec": 508.1075531454972, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 8069.732, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8069.698, "sample_time_ms": 738.951, "learn_time_ms": 7318.873, "learn_throughput": 546.532, "synch_weights_time_ms": 11.298}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 116, "trial_id": "eaa30_00000", "date": "2024-08-09_17-56-06", "timestamp": 1723240566, "time_this_iter_s": 7.876730918884277, "time_total_s": 946.4507887363434, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17808cdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 946.4507887363434, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 21.774999999999995, "ram_util_percent": 80.34999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.650949933415367, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.9079512225257025, "policy_loss": 0.005816809646292496, "vf_loss": 5.899230735011832, "vf_explained_var": 0.1383968367147698, "kl": 0.01697545532265274, "entropy": 0.9246871885483858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.909270003872613, "cur_kl_coeff": 1.1109234665296275, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.82498533129692, "policy_loss": -0.013599042774634048, "vf_loss": 7.82696394721667, "vf_explained_var": 0.0038282436008254686, "kl": 0.010460164045798592, "entropy": 1.3130216700335344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 111840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "env_runners": {"episode_reward_max": 148.20530677742977, "episode_reward_min": -117.01834039852655, "episode_reward_mean": 15.618172535674866, "episode_len_mean": 182.49, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 18249, "policy_reward_min": {"agent_policy": -58.509170199263316, "adversary_policy": -32.72541872322556}, "policy_reward_max": {"agent_policy": 74.10265338871497, "adversary_policy": 45.80348454633233}, "policy_reward_mean": {"agent_policy": 7.809086267837432, "adversary_policy": 3.904543133918716}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-71.75944248627997, -30.872001018343127, -96.08267935949578, -93.38878418194909, -112.3052096700867, 71.37572045322833, -55.1040459658134, -67.5129778652709, -117.01834039852655, -91.21246703620236, -61.925509753074536, -9.169328497707724, -33.99660893841108, -29.372933968076623, 37.486785492944634, 8.514777554146647, 1.8237784308182903, 21.78250421712842, 68.98558234284337, -36.85048206441045, -8.92232858199133, -5.883651411559622, -20.591715260866273, 1.6075425904228666, 47.11941304728683, 41.087314480152216, -16.901242143322094, -27.42920361439061, 63.30449373446746, 4.002422842968759, -97.54706023633724, -40.89765466953299, 71.14569831660448, -103.49617798278109, 17.627283352499234, -24.86414816991165, -98.5767072128663, 61.18825538243464, 3.7760278846156154, 148.20530677742977, 77.98249505694997, 62.91022632124705, -74.32251399828908, 57.31877370133445, 101.77463808461528, -94.78660739321296, 0.5145399018685302, 5.747109573759154, 75.83963167715022, 28.630495971049612, -56.12829951924233, 28.238444729722403, -29.707821973943226, 1.6057641732502859, 52.19071640619029, 37.91239253646553, 89.84986047235628, 54.54268339542238, 55.485942501250115, 24.664346768503428, 14.235138807173847, 48.801684395233536, 36.45295666031255, -34.457887686857966, 115.29928917244402, 15.081592501565176, 121.29354803079971, 24.26430219989782, 30.847688277251336, 2.9709005157010395, 108.9561893451925, 74.55332631785677, 67.02152654621598, 5.259782515265467, -1.5807008216291507, 61.34414527094361, 23.82947182668587, 39.07760921450965, 40.47945336134299, 69.03308389990933, 77.64832166825423, 3.2863431333840225, 2.2245345713541695, 66.09878503135099, 98.79512538259527, -27.894387496839336, 45.54009902802631, 48.49285968839155, 86.37591297060726, 42.81951893444237, -3.7759272997907942, 3.135310156253211, 30.02075878505302, 40.06196838626694, 95.28526866613602, 49.549533507688366, -10.68001397341197, 96.50970486379458, 86.66498017293998, 51.28043224194525], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 196, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 79, 200, 37, 200, 200, 200, 200, 200, 195, 174, 200, 200, 73, 148, 200, 200, 200, 200, 200, 200, 100, 200, 200, 77, 200, 200, 200, 200, 200, 200, 200, 200, 200, 92, 156, 200, 200, 200, 22, 27, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-35.87972124314004, -15.43600050917156, -48.04133967974791, -46.694392090974596, -56.152604835043405, 35.68786022661411, -27.55202298290672, -33.756488932635456, -58.509170199263316, -45.60623351810115, -30.96275487653731, -4.584664248853887, -16.998304469205564, -14.686466984038322, 18.743392746472313, 4.257388777073331, 0.9118892154091434, 10.891252108564213, 34.49279117142167, -18.425241032205225, -4.46116429099566, -2.941825705779813, -10.295857630433133, 0.8037712952114369, 23.559706523643413, 20.543657240076108, -8.450621071661047, -13.714601807195308, 31.65224686723369, 2.001211421484376, -48.773530118168594, -20.448827334766484, 35.57284915830222, -51.7480889913905, 8.813641676249624, -12.432074084955829, -49.28835360643316, 30.594127691217317, 1.8880139423078113, 74.10265338871497, 38.991247528474936, 31.455113160623515, -37.16125699914455, 28.659386850667232, 50.88731904230768, -47.3933036966065, 0.2572699509342651, 2.8735547868796054, 37.91981583857514, 14.315247985524806, -28.064149759621117, 14.119222364861201, -14.853910986971634, 0.8028820866251412, 26.095358203095145, 18.95619626823277, 44.924930236178135, 27.27134169771118, 27.742971250625047, 12.33217338425171, 7.1175694035869235, 24.400842197616786, 18.2264783301563, -17.22894384342898, 57.649644586221925, 7.540796250782587, 60.64677401539984, 12.13215109994891, 15.423844138625666, 1.4854502578505482, 54.47809467259624, 37.2766631589284, 33.51076327310797, 2.629891257632731, -0.7903504108145789, 30.672072635471817, 11.914735913342934, 19.538804607254864, 20.23972668067152, 34.51654194995459, 38.82416083412715, 1.6431715666920397, 1.1122672856770635, 33.04939251567551, 49.39756269129764, -13.9471937484197, 22.77004951401315, 24.246429844195774, 43.18795648530362, 21.40975946722119, -1.8879636498953971, 1.5676550781266063, 15.010379392526511, 20.03098419313347, 47.64263433306803, 24.774766753844165, -5.340006986705982, 48.2548524318973, 43.33249008647002, 25.640216120972624], "policy_adversary_policy_reward": [-15.857184674196901, -20.022536568943135, -16.143008634517788, 0.7070081253462241, -31.205232168973566, -16.836107510774344, -14.061681767009592, -32.63271032396501, -32.499711140332984, -23.652893694710418, 32.00664153968524, 3.6812186869289327, -20.70373362050247, -6.848289362404252, -21.727153247945463, -12.029335684689995, -32.72541872322556, -25.783751476037764, -25.352781558281222, -20.253451959819927, -9.148979135843756, -21.813775740693554, 16.74469964514018, -21.32936389399407, -4.504494876180544, -12.49380959302502, -6.619809853019291, -8.066657131019035, 3.0914411695340114, 15.651951576938302, 16.46924807452327, -12.21185929744994, 8.762069217823544, -7.850180002414399, 6.91808034801717, 3.9731717605470447, 8.74568476686233, 25.74710640455934, 2.915299028937042, -21.340540061142267, -7.512362494298351, 3.0511982033026896, 5.001558577979257, -7.94338428375907, -8.34560724600996, -1.9502503844231711, -1.9138634632844749, 2.7176347584959117, -5.544983760272238, 29.10469028391565, 12.559461064325959, 7.984196175750149, -16.74811366211767, 8.297492590456628, -19.429033401280265, 5.714431594084953, 15.686355918980748, 15.965890948252948, 1.19187546702768, 0.8093359544566958, -31.569568641162434, -17.203961477006168, -16.748119147171575, -3.7007081875949055, 19.257916464402154, 16.314932693900097, -27.58009049940221, -24.167998491988296, 3.00528778464993, 5.808353891599694, 14.694626965322108, -27.126701050277937, -27.826084303279373, -21.462269303153782, 11.937276443643029, 18.656851247574288, 10.980745095492257, -9.092731153184445, 28.29916884238262, 45.80348454633233, 13.008328023617857, 25.982919504857087, -2.259023170655002, 33.71413633127852, -32.4583541744585, -4.702902824686042, 6.855381487260807, 21.804005363406414, 10.353396303909893, 40.53392273839775, -27.786984367094014, -19.60631932951249, 1.013766334409684, -0.7564963834754188, 3.4626543649152044, -0.5890995780356114, 26.654812510076525, 11.2650033284986, 6.360584582053155, 7.954663403471651, 0.5551335709464382, -28.619283330567555, 6.293569680572283, 7.825652684288919, 3.0977487900063068, -17.951659776977944, 15.658233832222319, -14.85535174559718, 6.140407779653415, 19.95495042344173, -3.875891276165035, 22.832087544397805, 21.64468136185413, 23.28024887432401, 11.207563583673739, 16.063778114037447, 32.007060976457566, -4.26408972583252, 2.6950036427186745, 9.637169741533029, 6.210425707522305, 0.9071436960646189, 13.4818147466199, 10.919027450996888, 29.696827794878384, -11.470349464722084, -12.21150388859427, -5.01743995483471, 28.527733383012738, 29.1219112032092, 29.33146751918972, -21.790671268407134, 23.330798278508233, 37.31597573689161, -15.588408530494032, 27.720559630442942, -14.888035273555587, 30.311879412181256, 12.002743283065907, -10.517293025215366, 23.532620731280836, 30.9454739413154, 22.100300202714504, 15.176362956213897, 23.478677465089028, 10.032085808018941, -11.967901727379221, 14.59779298501195, 1.6161382123263053, -2.4064886231408824, 2.604019140471028, 28.06805349500079, -6.762829443421968, 18.6775653567649, 9.592785554967609, 9.946019052287255, 10.885707480969181, 9.354019199702343, 19.117118987751443, 15.399422962203168, 27.011451407865078, 11.812709426262064, 18.05850073357441, -16.41532916688237, 4.598918887144482, -3.486651601467422, 9.696774817993266, 23.35261769768224, 27.382969593302395, 22.01459309799523, -14.786573200297934, 0.8393794518782265, 20.67078355857926, 2.099265955433891, 21.98397802506089, 2.262451819134885, 33.19310777481763, 9.994848710485991, 6.262643226656753, 15.147116240564436, -10.93511218217845, 9.047148532283053, 13.352996048262767, -11.785340970136165, 15.000000135305848, 0.010379257220662907, 20.569880015523804, -0.5388958223903337, 30.620643876376057, 17.021990456691974, 14.052932984154419, 10.721833769689752, -1.523077132731208, -3.816929853974788, 21.054314975289724, 27.200537456607574, 13.574478130147558, 29.75801195632246, -0.4563294092611585, 26.096545530233783]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3856514212226115, "mean_inference_ms": 0.9574131207601123, "mean_action_processing_ms": 0.1637236124974101, "mean_env_wait_ms": 0.0565982991179799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031986236572265625, "StateBufferConnector_ms": 0.002370119094848633, "ViewRequirementAgentConnector_ms": 0.062331199645996094}, "num_episodes": 24, "episode_return_max": 148.20530677742977, "episode_return_min": -117.01834039852655, "episode_return_mean": 15.618172535674866}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 475.90895468597773, "num_env_steps_trained_throughput_per_sec": 475.90895468597773, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 1404000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 8087.454, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8087.419, "sample_time_ms": 734.742, "learn_time_ms": 7340.889, "learn_throughput": 544.893, "synch_weights_time_ms": 11.239}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "training_iteration": 117, "trial_id": "eaa30_00000", "date": "2024-08-09_17-56-14", "timestamp": 1723240574, "time_this_iter_s": 8.408583879470825, "time_total_s": 954.8593726158142, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1780da160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 954.8593726158142, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 27.450000000000003, "ram_util_percent": 80.45833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.630370199995697, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.782072725497857, "policy_loss": 0.0010427042649733642, "vf_loss": 5.778870545493232, "vf_explained_var": 0.0036183040924173183, "kl": 0.012624662030468543, "entropy": 0.8553911940761344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.414256126868228, "cur_kl_coeff": 1.1109234665296275, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.823093515634537, "policy_loss": 0.001641755466213605, "vf_loss": 7.808980541924636, "vf_explained_var": 0.07320694761971633, "kl": 0.011225969113002065, "entropy": 1.2902799674620231, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 112800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "env_runners": {"episode_reward_max": 160.1461638531732, "episode_reward_min": -103.49617798278109, "episode_reward_mean": 36.87957882520666, "episode_len_mean": 174.93, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 17493, "policy_reward_min": {"agent_policy": -51.7480889913905, "adversary_policy": -32.4583541744585}, "policy_reward_max": {"agent_policy": 80.07308192658665, "adversary_policy": 45.80348454633233}, "policy_reward_mean": {"agent_policy": 18.43978941260333, "adversary_policy": 9.219894706301663}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.11941304728683, 41.087314480152216, -16.901242143322094, -27.42920361439061, 63.30449373446746, 4.002422842968759, -97.54706023633724, -40.89765466953299, 71.14569831660448, -103.49617798278109, 17.627283352499234, -24.86414816991165, -98.5767072128663, 61.18825538243464, 3.7760278846156154, 148.20530677742977, 77.98249505694997, 62.91022632124705, -74.32251399828908, 57.31877370133445, 101.77463808461528, -94.78660739321296, 0.5145399018685302, 5.747109573759154, 75.83963167715022, 28.630495971049612, -56.12829951924233, 28.238444729722403, -29.707821973943226, 1.6057641732502859, 52.19071640619029, 37.91239253646553, 89.84986047235628, 54.54268339542238, 55.485942501250115, 24.664346768503428, 14.235138807173847, 48.801684395233536, 36.45295666031255, -34.457887686857966, 115.29928917244402, 15.081592501565176, 121.29354803079971, 24.26430219989782, 30.847688277251336, 2.9709005157010395, 108.9561893451925, 74.55332631785677, 67.02152654621598, 5.259782515265467, -1.5807008216291507, 61.34414527094361, 23.82947182668587, 39.07760921450965, 40.47945336134299, 69.03308389990933, 77.64832166825423, 3.2863431333840225, 2.2245345713541695, 66.09878503135099, 98.79512538259527, -27.894387496839336, 45.54009902802631, 48.49285968839155, 86.37591297060726, 42.81951893444237, -3.7759272997907942, 3.135310156253211, 30.02075878505302, 40.06196838626694, 95.28526866613602, 49.549533507688366, -10.68001397341197, 96.50970486379458, 86.66498017293998, 51.28043224194525, 53.46992302391389, 5.154292961366885, 160.1461638531732, 52.153032790264646, 49.699843916581564, 94.82058497670312, 34.160767127956845, 133.16128624483534, -61.86322385568265, 76.74224548178644, 60.314136725483735, 29.51839849481408, 7.710181026742497, 87.85846555423488, 74.78535467889726, 76.08387853354542, 43.091857164805006, 101.39295906535776, 130.79497191694657, 52.78077398814391, 53.60099851671639, 4.936019102480536, 24.894370024706312, 50.341532262871496], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 196, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 79, 200, 37, 200, 200, 200, 200, 200, 195, 174, 200, 200, 73, 148, 200, 200, 200, 200, 200, 200, 100, 200, 200, 77, 200, 200, 200, 200, 200, 200, 200, 200, 200, 92, 156, 200, 200, 200, 22, 27, 200, 200, 200, 200, 200, 200, 200, 155, 200, 106, 200, 200, 200, 55, 155, 200, 73, 162, 200, 200, 200, 189, 200, 165, 200, 200, 200, 200, 3, 200, 17], "policy_agent_policy_reward": [23.559706523643413, 20.543657240076108, -8.450621071661047, -13.714601807195308, 31.65224686723369, 2.001211421484376, -48.773530118168594, -20.448827334766484, 35.57284915830222, -51.7480889913905, 8.813641676249624, -12.432074084955829, -49.28835360643316, 30.594127691217317, 1.8880139423078113, 74.10265338871497, 38.991247528474936, 31.455113160623515, -37.16125699914455, 28.659386850667232, 50.88731904230768, -47.3933036966065, 0.2572699509342651, 2.8735547868796054, 37.91981583857514, 14.315247985524806, -28.064149759621117, 14.119222364861201, -14.853910986971634, 0.8028820866251412, 26.095358203095145, 18.95619626823277, 44.924930236178135, 27.27134169771118, 27.742971250625047, 12.33217338425171, 7.1175694035869235, 24.400842197616786, 18.2264783301563, -17.22894384342898, 57.649644586221925, 7.540796250782587, 60.64677401539984, 12.13215109994891, 15.423844138625666, 1.4854502578505482, 54.47809467259624, 37.2766631589284, 33.51076327310797, 2.629891257632731, -0.7903504108145789, 30.672072635471817, 11.914735913342934, 19.538804607254864, 20.23972668067152, 34.51654194995459, 38.82416083412715, 1.6431715666920397, 1.1122672856770635, 33.04939251567551, 49.39756269129764, -13.9471937484197, 22.77004951401315, 24.246429844195774, 43.18795648530362, 21.40975946722119, -1.8879636498953971, 1.5676550781266063, 15.010379392526511, 20.03098419313347, 47.64263433306803, 24.774766753844165, -5.340006986705982, 48.2548524318973, 43.33249008647002, 25.640216120972624, 26.734961511956946, 2.577146480683435, 80.07308192658665, 26.076516395132323, 24.8499219582908, 47.41029248835157, 17.080383563978423, 66.5806431224177, -30.931611927841352, 38.371122740893234, 30.157068362741875, 14.759199247407041, 3.855090513371259, 43.92923277711745, 37.39267733944865, 38.041939266772715, 21.5459285824025, 50.696479532678886, 65.39748595847325, 26.390386994071946, 26.800499258358197, 2.4680095512402676, 12.447185012353161, 25.17076613143576], "policy_adversary_policy_reward": [-5.544983760272238, 29.10469028391565, 12.559461064325959, 7.984196175750149, -16.74811366211767, 8.297492590456628, -19.429033401280265, 5.714431594084953, 15.686355918980748, 15.965890948252948, 1.19187546702768, 0.8093359544566958, -31.569568641162434, -17.203961477006168, -16.748119147171575, -3.7007081875949055, 19.257916464402154, 16.314932693900097, -27.58009049940221, -24.167998491988296, 3.00528778464993, 5.808353891599694, 14.694626965322108, -27.126701050277937, -27.826084303279373, -21.462269303153782, 11.937276443643029, 18.656851247574288, 10.980745095492257, -9.092731153184445, 28.29916884238262, 45.80348454633233, 13.008328023617857, 25.982919504857087, -2.259023170655002, 33.71413633127852, -32.4583541744585, -4.702902824686042, 6.855381487260807, 21.804005363406414, 10.353396303909893, 40.53392273839775, -27.786984367094014, -19.60631932951249, 1.013766334409684, -0.7564963834754188, 3.4626543649152044, -0.5890995780356114, 26.654812510076525, 11.2650033284986, 6.360584582053155, 7.954663403471651, 0.5551335709464382, -28.619283330567555, 6.293569680572283, 7.825652684288919, 3.0977487900063068, -17.951659776977944, 15.658233832222319, -14.85535174559718, 6.140407779653415, 19.95495042344173, -3.875891276165035, 22.832087544397805, 21.64468136185413, 23.28024887432401, 11.207563583673739, 16.063778114037447, 32.007060976457566, -4.26408972583252, 2.6950036427186745, 9.637169741533029, 6.210425707522305, 0.9071436960646189, 13.4818147466199, 10.919027450996888, 29.696827794878384, -11.470349464722084, -12.21150388859427, -5.01743995483471, 28.527733383012738, 29.1219112032092, 29.33146751918972, -21.790671268407134, 23.330798278508233, 37.31597573689161, -15.588408530494032, 27.720559630442942, -14.888035273555587, 30.311879412181256, 12.002743283065907, -10.517293025215366, 23.532620731280836, 30.9454739413154, 22.100300202714504, 15.176362956213897, 23.478677465089028, 10.032085808018941, -11.967901727379221, 14.59779298501195, 1.6161382123263053, -2.4064886231408824, 2.604019140471028, 28.06805349500079, -6.762829443421968, 18.6775653567649, 9.592785554967609, 9.946019052287255, 10.885707480969181, 9.354019199702343, 19.117118987751443, 15.399422962203168, 27.011451407865078, 11.812709426262064, 18.05850073357441, -16.41532916688237, 4.598918887144482, -3.486651601467422, 9.696774817993266, 23.35261769768224, 27.382969593302395, 22.01459309799523, -14.786573200297934, 0.8393794518782265, 20.67078355857926, 2.099265955433891, 21.98397802506089, 2.262451819134885, 33.19310777481763, 9.994848710485991, 6.262643226656753, 15.147116240564436, -10.93511218217845, 9.047148532283053, 13.352996048262767, -11.785340970136165, 15.000000135305848, 0.010379257220662907, 20.569880015523804, -0.5388958223903337, 30.620643876376057, 17.021990456691974, 14.052932984154419, 10.721833769689752, -1.523077132731208, -3.816929853974788, 21.054314975289724, 27.200537456607574, 13.574478130147558, 29.75801195632246, -0.4563294092611585, 26.096545530233783, 13.247263888353803, 13.487697623603143, -2.234044520926691, 4.81119100161013, 41.74783787442251, 38.3252440521641, -1.4108703270536687, 27.487386722185988, 12.414635830344354, 12.43528612794643, 20.996898114602942, 26.413394373748627, -7.390361258006419, 24.47074482198484, 36.342554797869525, 30.23808832454817, -14.066500550877834, -16.865111376963522, 1.2007771748990663, 37.170345565994175, 12.839919203930915, 17.31714915881096, 4.531535762469013, 10.22766348493803, 0.5820073680726487, 3.2730831452986084, 22.64971676801614, 21.279516009101286, 20.606977837734213, 16.785699501714447, 13.1585666951206, 24.883372571652124, 2.9348671737576275, 18.61106140864488, 24.65971598067362, 26.036763552005226, 21.886973740955337, 43.51051221751793, 10.14533057527428, 16.245056418797667, 6.142700452898863, 20.657798805459326, 1.6737795737829584, 0.7942299774573094, 16.241004224311993, -3.793819211958837, 16.040220308411538, 9.130545823024221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3855391605811886, "mean_inference_ms": 0.9567163277477413, "mean_action_processing_ms": 0.16378174014196276, "mean_env_wait_ms": 0.05661674004486803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003377199172973633, "StateBufferConnector_ms": 0.002456068992614746, "ViewRequirementAgentConnector_ms": 0.0636289119720459}, "num_episodes": 24, "episode_return_max": 160.1461638531732, "episode_return_min": -103.49617798278109, "episode_return_mean": 36.87957882520666}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 508.4770029332293, "num_env_steps_trained_throughput_per_sec": 508.4770029332293, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 1416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 8002.475, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8002.441, "sample_time_ms": 719.629, "learn_time_ms": 7271.167, "learn_throughput": 550.118, "synch_weights_time_ms": 11.051}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "training_iteration": 118, "trial_id": "eaa30_00000", "date": "2024-08-09_17-56-22", "timestamp": 1723240582, "time_this_iter_s": 7.87204122543335, "time_total_s": 962.7314138412476, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1780da4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 962.7314138412476, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 23.181818181818183, "ram_util_percent": 80.75454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.84381677801647, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.832644710338935, "policy_loss": 0.0030752474905321836, "vf_loss": 6.827122961276423, "vf_explained_var": 0.057548082442510695, "kl": 0.014302651896067555, "entropy": 0.7971618390272535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.12833608382692, "cur_kl_coeff": 1.1109234665296275, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.331286022563775, "policy_loss": 0.008726293720004226, "vf_loss": 8.304819076756637, "vf_explained_var": 0.0029143063351511956, "kl": 0.015969291830939862, "entropy": 1.2655819368859131, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 113760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "env_runners": {"episode_reward_max": 160.1461638531732, "episode_reward_min": -61.86322385568265, "episode_reward_mean": 53.87210551716606, "episode_len_mean": 169.91, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 16991, "policy_reward_min": {"agent_policy": -30.931611927841352, "adversary_policy": -28.619283330567555}, "policy_reward_max": {"agent_policy": 80.07308192658665, "adversary_policy": 48.268702729563024}, "policy_reward_mean": {"agent_policy": 26.93605275858303, "adversary_policy": 13.468026379291514}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.83963167715022, 28.630495971049612, -56.12829951924233, 28.238444729722403, -29.707821973943226, 1.6057641732502859, 52.19071640619029, 37.91239253646553, 89.84986047235628, 54.54268339542238, 55.485942501250115, 24.664346768503428, 14.235138807173847, 48.801684395233536, 36.45295666031255, -34.457887686857966, 115.29928917244402, 15.081592501565176, 121.29354803079971, 24.26430219989782, 30.847688277251336, 2.9709005157010395, 108.9561893451925, 74.55332631785677, 67.02152654621598, 5.259782515265467, -1.5807008216291507, 61.34414527094361, 23.82947182668587, 39.07760921450965, 40.47945336134299, 69.03308389990933, 77.64832166825423, 3.2863431333840225, 2.2245345713541695, 66.09878503135099, 98.79512538259527, -27.894387496839336, 45.54009902802631, 48.49285968839155, 86.37591297060726, 42.81951893444237, -3.7759272997907942, 3.135310156253211, 30.02075878505302, 40.06196838626694, 95.28526866613602, 49.549533507688366, -10.68001397341197, 96.50970486379458, 86.66498017293998, 51.28043224194525, 53.46992302391389, 5.154292961366885, 160.1461638531732, 52.153032790264646, 49.699843916581564, 94.82058497670312, 34.160767127956845, 133.16128624483534, -61.86322385568265, 76.74224548178644, 60.314136725483735, 29.51839849481408, 7.710181026742497, 87.85846555423488, 74.78535467889726, 76.08387853354542, 43.091857164805006, 101.39295906535776, 130.79497191694657, 52.78077398814391, 53.60099851671639, 4.936019102480536, 24.894370024706312, 50.341532262871496, 100.66632700974807, 65.75196836683378, 68.0915130378823, 48.28696447081486, 67.42794995753208, 104.09856832548002, 82.73118529217695, 83.22745870254496, 46.673953813567366, 94.434897848524, 139.02782160147643, 96.61231504775472, 89.12873124498415, 98.07841814265126, -2.318506102835517, 136.67845722853525, 106.03085132611915, 82.3020365848319, 1.34057785679538, 113.0183020874012, 72.59548636791723, 50.77418893650942, 108.30832690302174, 31.16755818326346], "episode_lengths": [200, 200, 200, 200, 200, 79, 200, 37, 200, 200, 200, 200, 200, 195, 174, 200, 200, 73, 148, 200, 200, 200, 200, 200, 200, 100, 200, 200, 77, 200, 200, 200, 200, 200, 200, 200, 200, 200, 92, 156, 200, 200, 200, 22, 27, 200, 200, 200, 200, 200, 200, 200, 155, 200, 106, 200, 200, 200, 55, 155, 200, 73, 162, 200, 200, 200, 189, 200, 165, 200, 200, 200, 200, 3, 200, 17, 200, 128, 168, 92, 200, 101, 200, 200, 200, 135, 169, 149, 123, 195, 144, 191, 200, 200, 85, 200, 200, 200, 178, 73], "policy_agent_policy_reward": [37.91981583857514, 14.315247985524806, -28.064149759621117, 14.119222364861201, -14.853910986971634, 0.8028820866251412, 26.095358203095145, 18.95619626823277, 44.924930236178135, 27.27134169771118, 27.742971250625047, 12.33217338425171, 7.1175694035869235, 24.400842197616786, 18.2264783301563, -17.22894384342898, 57.649644586221925, 7.540796250782587, 60.64677401539984, 12.13215109994891, 15.423844138625666, 1.4854502578505482, 54.47809467259624, 37.2766631589284, 33.51076327310797, 2.629891257632731, -0.7903504108145789, 30.672072635471817, 11.914735913342934, 19.538804607254864, 20.23972668067152, 34.51654194995459, 38.82416083412715, 1.6431715666920397, 1.1122672856770635, 33.04939251567551, 49.39756269129764, -13.9471937484197, 22.77004951401315, 24.246429844195774, 43.18795648530362, 21.40975946722119, -1.8879636498953971, 1.5676550781266063, 15.010379392526511, 20.03098419313347, 47.64263433306803, 24.774766753844165, -5.340006986705982, 48.2548524318973, 43.33249008647002, 25.640216120972624, 26.734961511956946, 2.577146480683435, 80.07308192658665, 26.076516395132323, 24.8499219582908, 47.41029248835157, 17.080383563978423, 66.5806431224177, -30.931611927841352, 38.371122740893234, 30.157068362741875, 14.759199247407041, 3.855090513371259, 43.92923277711745, 37.39267733944865, 38.041939266772715, 21.5459285824025, 50.696479532678886, 65.39748595847325, 26.390386994071946, 26.800499258358197, 2.4680095512402676, 12.447185012353161, 25.17076613143576, 50.33316350487405, 32.87598418341688, 34.04575651894113, 24.143482235407433, 33.71397497876603, 52.049284162740044, 41.36559264608844, 41.61372935127246, 23.33697690678368, 47.21744892426198, 69.51391080073815, 48.30615752387738, 44.56436562249207, 49.03920907132563, -1.1592530514177515, 68.33922861426763, 53.01542566305955, 41.151018292415934, 0.6702889283976896, 56.50915104370067, 36.2977431839586, 25.387094468254716, 54.15416345151087, 15.583779091631737], "policy_adversary_policy_reward": [26.654812510076525, 11.2650033284986, 6.360584582053155, 7.954663403471651, 0.5551335709464382, -28.619283330567555, 6.293569680572283, 7.825652684288919, 3.0977487900063068, -17.951659776977944, 15.658233832222319, -14.85535174559718, 6.140407779653415, 19.95495042344173, -3.875891276165035, 22.832087544397805, 21.64468136185413, 23.28024887432401, 11.207563583673739, 16.063778114037447, 32.007060976457566, -4.26408972583252, 2.6950036427186745, 9.637169741533029, 6.210425707522305, 0.9071436960646189, 13.4818147466199, 10.919027450996888, 29.696827794878384, -11.470349464722084, -12.21150388859427, -5.01743995483471, 28.527733383012738, 29.1219112032092, 29.33146751918972, -21.790671268407134, 23.330798278508233, 37.31597573689161, -15.588408530494032, 27.720559630442942, -14.888035273555587, 30.311879412181256, 12.002743283065907, -10.517293025215366, 23.532620731280836, 30.9454739413154, 22.100300202714504, 15.176362956213897, 23.478677465089028, 10.032085808018941, -11.967901727379221, 14.59779298501195, 1.6161382123263053, -2.4064886231408824, 2.604019140471028, 28.06805349500079, -6.762829443421968, 18.6775653567649, 9.592785554967609, 9.946019052287255, 10.885707480969181, 9.354019199702343, 19.117118987751443, 15.399422962203168, 27.011451407865078, 11.812709426262064, 18.05850073357441, -16.41532916688237, 4.598918887144482, -3.486651601467422, 9.696774817993266, 23.35261769768224, 27.382969593302395, 22.01459309799523, -14.786573200297934, 0.8393794518782265, 20.67078355857926, 2.099265955433891, 21.98397802506089, 2.262451819134885, 33.19310777481763, 9.994848710485991, 6.262643226656753, 15.147116240564436, -10.93511218217845, 9.047148532283053, 13.352996048262767, -11.785340970136165, 15.000000135305848, 0.010379257220662907, 20.569880015523804, -0.5388958223903337, 30.620643876376057, 17.021990456691974, 14.052932984154419, 10.721833769689752, -1.523077132731208, -3.816929853974788, 21.054314975289724, 27.200537456607574, 13.574478130147558, 29.75801195632246, -0.4563294092611585, 26.096545530233783, 13.247263888353803, 13.487697623603143, -2.234044520926691, 4.81119100161013, 41.74783787442251, 38.3252440521641, -1.4108703270536687, 27.487386722185988, 12.414635830344354, 12.43528612794643, 20.996898114602942, 26.413394373748627, -7.390361258006419, 24.47074482198484, 36.342554797869525, 30.23808832454817, -14.066500550877834, -16.865111376963522, 1.2007771748990663, 37.170345565994175, 12.839919203930915, 17.31714915881096, 4.531535762469013, 10.22766348493803, 0.5820073680726487, 3.2730831452986084, 22.64971676801614, 21.279516009101286, 20.606977837734213, 16.785699501714447, 13.1585666951206, 24.883372571652124, 2.9348671737576275, 18.61106140864488, 24.65971598067362, 26.036763552005226, 21.886973740955337, 43.51051221751793, 10.14533057527428, 16.245056418797667, 6.142700452898863, 20.657798805459326, 1.6737795737829584, 0.7942299774573094, 16.241004224311993, -3.793819211958837, 16.040220308411538, 9.130545823024221, 29.540802997224127, 20.79236050764993, 3.656207851622076, 29.219776331794808, 23.35201934771062, 10.693737171230513, 9.277932695553039, 14.865549539854396, 9.77123793443911, 23.942737044326933, 18.53854325093559, 33.51074091180444, 24.080510614711137, 17.285082031377314, 29.66888500519662, 11.944844346075842, 2.972945512246593, 20.364031394537086, 5.043117032993489, 42.17433189126849, 25.15281245059447, 44.361098350143706, 37.59529145537752, 10.710866068499861, 17.185070108840193, 27.379295513651883, 34.525803339308126, 14.51340573201752, 10.396722920883228, -11.555975972300978, 48.268702729563024, 20.07052588470463, 26.293640867021594, 26.721784796037966, 26.014943629724776, 15.136074662691165, -7.54136055110763, 8.211649479505322, 22.21126329003673, 34.29788775366392, 9.381182138820169, 26.916561045138437, 19.893719696354296, 5.493374771900399, 35.55456140632214, 18.599602045188718, 3.850246871139521, 11.733532220492215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38536816051962935, "mean_inference_ms": 0.9571221985192992, "mean_action_processing_ms": 0.163578188994038, "mean_env_wait_ms": 0.05662944021233414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034540891647338867, "StateBufferConnector_ms": 0.0024312734603881836, "ViewRequirementAgentConnector_ms": 0.06366920471191406}, "num_episodes": 24, "episode_return_max": 160.1461638531732, "episode_return_min": -61.86322385568265, "episode_return_mean": 53.87210551716606}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.0252632798231, "num_env_steps_trained_throughput_per_sec": 505.0252632798231, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 1428000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 7996.114, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7996.08, "sample_time_ms": 720.519, "learn_time_ms": 7264.07, "learn_throughput": 550.655, "synch_weights_time_ms": 10.952}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "training_iteration": 119, "trial_id": "eaa30_00000", "date": "2024-08-09_17-56-30", "timestamp": 1723240590, "time_this_iter_s": 7.924472093582153, "time_total_s": 970.6558859348297, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc920d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 970.6558859348297, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 22.28181818181818, "ram_util_percent": 80.67272727272729}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.993015008628683, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.312000435369986, "policy_loss": 0.003877952394553672, "vf_loss": 7.305570671545765, "vf_explained_var": -0.01487350687778816, "kl": 0.014918369621472069, "entropy": 0.7893398345147491, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0788162191088, "cur_kl_coeff": 1.1109234665296275, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.747394401331743, "policy_loss": 0.011188275427533275, "vf_loss": 8.713074032465617, "vf_explained_var": -0.24034974426031114, "kl": 0.020822417335390735, "entropy": 1.2563933772345384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 114720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 160.1461638531732, "episode_reward_min": -61.86322385568265, "episode_reward_mean": 64.1395851061395, "episode_len_mean": 152.94, "episode_media": {}, "episodes_this_iter": 31, "episodes_timesteps_total": 15294, "policy_reward_min": {"agent_policy": -30.931611927841352, "adversary_policy": -16.865111376963522}, "policy_reward_max": {"agent_policy": 80.07308192658665, "adversary_policy": 48.268702729563024}, "policy_reward_mean": {"agent_policy": 32.06979255306975, "adversary_policy": 16.034896276534873}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.03308389990933, 77.64832166825423, 3.2863431333840225, 2.2245345713541695, 66.09878503135099, 98.79512538259527, -27.894387496839336, 45.54009902802631, 48.49285968839155, 86.37591297060726, 42.81951893444237, -3.7759272997907942, 3.135310156253211, 30.02075878505302, 40.06196838626694, 95.28526866613602, 49.549533507688366, -10.68001397341197, 96.50970486379458, 86.66498017293998, 51.28043224194525, 53.46992302391389, 5.154292961366885, 160.1461638531732, 52.153032790264646, 49.699843916581564, 94.82058497670312, 34.160767127956845, 133.16128624483534, -61.86322385568265, 76.74224548178644, 60.314136725483735, 29.51839849481408, 7.710181026742497, 87.85846555423488, 74.78535467889726, 76.08387853354542, 43.091857164805006, 101.39295906535776, 130.79497191694657, 52.78077398814391, 53.60099851671639, 4.936019102480536, 24.894370024706312, 50.341532262871496, 100.66632700974807, 65.75196836683378, 68.0915130378823, 48.28696447081486, 67.42794995753208, 104.09856832548002, 82.73118529217695, 83.22745870254496, 46.673953813567366, 94.434897848524, 139.02782160147643, 96.61231504775472, 89.12873124498415, 98.07841814265126, -2.318506102835517, 136.67845722853525, 106.03085132611915, 82.3020365848319, 1.34057785679538, 113.0183020874012, 72.59548636791723, 50.77418893650942, 108.30832690302174, 31.16755818326346, 29.395377848285648, 41.718674476463875, 33.687899014855006, 103.25364629479134, 56.711367201971896, 74.80082400423697, 93.09590798512698, 53.79435931950228, 97.6255453254723, 11.288670292623664, 90.60020776524632, 98.46117717963554, 123.52701172450426, 135.95282319644477, 34.74508727347816, 78.77794607481334, 90.65476561011961, 7.040474302472134, 27.720962897802057, 115.69994548319471, 8.613840409152262, 120.31334322474365, 75.92886824625667, 81.77373490413703, 68.1587901510933, 63.52416213059885, 39.694156355000075, 68.5585847802426, 87.6986852793724, 65.64742196732242, 105.13787176646395], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 92, 156, 200, 200, 200, 22, 27, 200, 200, 200, 200, 200, 200, 200, 155, 200, 106, 200, 200, 200, 55, 155, 200, 73, 162, 200, 200, 200, 189, 200, 165, 200, 200, 200, 200, 3, 200, 17, 200, 128, 168, 92, 200, 101, 200, 200, 200, 135, 169, 149, 123, 195, 144, 191, 200, 200, 85, 200, 200, 200, 178, 73, 183, 116, 198, 145, 52, 114, 200, 191, 110, 200, 60, 143, 200, 96, 153, 159, 115, 33, 128, 143, 5, 93, 35, 200, 31, 95, 129, 195, 33, 121, 110], "policy_agent_policy_reward": [34.51654194995459, 38.82416083412715, 1.6431715666920397, 1.1122672856770635, 33.04939251567551, 49.39756269129764, -13.9471937484197, 22.77004951401315, 24.246429844195774, 43.18795648530362, 21.40975946722119, -1.8879636498953971, 1.5676550781266063, 15.010379392526511, 20.03098419313347, 47.64263433306803, 24.774766753844165, -5.340006986705982, 48.2548524318973, 43.33249008647002, 25.640216120972624, 26.734961511956946, 2.577146480683435, 80.07308192658665, 26.076516395132323, 24.8499219582908, 47.41029248835157, 17.080383563978423, 66.5806431224177, -30.931611927841352, 38.371122740893234, 30.157068362741875, 14.759199247407041, 3.855090513371259, 43.92923277711745, 37.39267733944865, 38.041939266772715, 21.5459285824025, 50.696479532678886, 65.39748595847325, 26.390386994071946, 26.800499258358197, 2.4680095512402676, 12.447185012353161, 25.17076613143576, 50.33316350487405, 32.87598418341688, 34.04575651894113, 24.143482235407433, 33.71397497876603, 52.049284162740044, 41.36559264608844, 41.61372935127246, 23.33697690678368, 47.21744892426198, 69.51391080073815, 48.30615752387738, 44.56436562249207, 49.03920907132563, -1.1592530514177515, 68.33922861426763, 53.01542566305955, 41.151018292415934, 0.6702889283976896, 56.50915104370067, 36.2977431839586, 25.387094468254716, 54.15416345151087, 15.583779091631737, 14.697688924142799, 20.859337238231923, 16.843949507427475, 51.626823147395626, 28.355683600985934, 37.40041200211847, 46.54795399256347, 26.897179659751135, 48.81277266273615, 5.644335146311839, 45.300103882623176, 49.23058858981776, 61.76350586225213, 67.97641159822236, 17.372543636739074, 39.38897303740668, 45.3273828050598, 3.520237151236067, 13.860481448901046, 57.849972741597355, 4.30692020457613, 60.15667161237181, 37.96443412312832, 40.886867452068536, 34.07939507554664, 31.76208106529943, 19.84707817750003, 34.279292390121284, 43.849342639686185, 32.823710983661215, 52.56893588323193], "policy_adversary_policy_reward": [19.117118987751443, 15.399422962203168, 27.011451407865078, 11.812709426262064, 18.05850073357441, -16.41532916688237, 4.598918887144482, -3.486651601467422, 9.696774817993266, 23.35261769768224, 27.382969593302395, 22.01459309799523, -14.786573200297934, 0.8393794518782265, 20.67078355857926, 2.099265955433891, 21.98397802506089, 2.262451819134885, 33.19310777481763, 9.994848710485991, 6.262643226656753, 15.147116240564436, -10.93511218217845, 9.047148532283053, 13.352996048262767, -11.785340970136165, 15.000000135305848, 0.010379257220662907, 20.569880015523804, -0.5388958223903337, 30.620643876376057, 17.021990456691974, 14.052932984154419, 10.721833769689752, -1.523077132731208, -3.816929853974788, 21.054314975289724, 27.200537456607574, 13.574478130147558, 29.75801195632246, -0.4563294092611585, 26.096545530233783, 13.247263888353803, 13.487697623603143, -2.234044520926691, 4.81119100161013, 41.74783787442251, 38.3252440521641, -1.4108703270536687, 27.487386722185988, 12.414635830344354, 12.43528612794643, 20.996898114602942, 26.413394373748627, -7.390361258006419, 24.47074482198484, 36.342554797869525, 30.23808832454817, -14.066500550877834, -16.865111376963522, 1.2007771748990663, 37.170345565994175, 12.839919203930915, 17.31714915881096, 4.531535762469013, 10.22766348493803, 0.5820073680726487, 3.2730831452986084, 22.64971676801614, 21.279516009101286, 20.606977837734213, 16.785699501714447, 13.1585666951206, 24.883372571652124, 2.9348671737576275, 18.61106140864488, 24.65971598067362, 26.036763552005226, 21.886973740955337, 43.51051221751793, 10.14533057527428, 16.245056418797667, 6.142700452898863, 20.657798805459326, 1.6737795737829584, 0.7942299774573094, 16.241004224311993, -3.793819211958837, 16.040220308411538, 9.130545823024221, 29.540802997224127, 20.79236050764993, 3.656207851622076, 29.219776331794808, 23.35201934771062, 10.693737171230513, 9.277932695553039, 14.865549539854396, 9.77123793443911, 23.942737044326933, 18.53854325093559, 33.51074091180444, 24.080510614711137, 17.285082031377314, 29.66888500519662, 11.944844346075842, 2.972945512246593, 20.364031394537086, 5.043117032993489, 42.17433189126849, 25.15281245059447, 44.361098350143706, 37.59529145537752, 10.710866068499861, 17.185070108840193, 27.379295513651883, 34.525803339308126, 14.51340573201752, 10.396722920883228, -11.555975972300978, 48.268702729563024, 20.07052588470463, 26.293640867021594, 26.721784796037966, 26.014943629724776, 15.136074662691165, -7.54136055110763, 8.211649479505322, 22.21126329003673, 34.29788775366392, 9.381182138820169, 26.916561045138437, 19.893719696354296, 5.493374771900399, 35.55456140632214, 18.599602045188718, 3.850246871139521, 11.733532220492215, -1.4449564537781612, 16.14264537792096, -8.834533575744107, 29.693870813976034, 12.002854220918657, 4.841095286508796, 40.13839690153156, 11.48842624586408, 22.142680046688035, 6.213003554297899, 16.030188956020606, 21.37022304609787, 36.76568998461836, 9.782264007945125, 14.499277814717406, 12.397901845033726, 30.705421044820866, 18.107351617915285, 4.411294916503632, 1.2330402298082035, 13.134283716858775, 32.16582016576441, 34.30593824051855, 14.924650349299222, 29.318826065158518, 32.44467979709361, 33.419122481926046, 34.557289116296296, 0.8552794497386209, 16.517264187000453, 23.600897990593527, 15.788075046813148, 16.264027365360715, 29.06335543969908, 17.772081626761526, -14.25184447552546, -6.9292011393750315, 20.78968258827608, 18.070679721900547, 39.77929301969681, 2.4831829807706995, 1.823737223805431, 31.71203912121178, 28.444632491160032, 8.020266318344193, 29.944167804784122, 17.248984281461855, 23.637883170606667, 13.800137935779139, 20.279257139767513, 24.976013358906087, 6.786067706393343, 8.454150108069989, 11.392928069430036, 4.571544689981721, 29.70774770013957, 24.738818022354536, 19.11052461733164, 6.410019168278854, 26.413691815382364, 16.335929157522145, 36.233006725709785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.385066486585991, "mean_inference_ms": 0.9555842529559733, "mean_action_processing_ms": 0.1637443106519965, "mean_env_wait_ms": 0.05661238190073583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035783052444458008, "StateBufferConnector_ms": 0.0025032758712768555, "ViewRequirementAgentConnector_ms": 0.0671776533126831}, "num_episodes": 31, "episode_return_max": 160.1461638531732, "episode_return_min": -61.86322385568265, "episode_return_mean": 64.1395851061395}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.0423370175955, "num_env_steps_trained_throughput_per_sec": 503.0423370175955, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 7981.61, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7981.575, "sample_time_ms": 723.568, "learn_time_ms": 7246.838, "learn_throughput": 551.965, "synch_weights_time_ms": 10.721}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 120, "trial_id": "eaa30_00000", "date": "2024-08-09_17-56-39", "timestamp": 1723240599, "time_this_iter_s": 7.956055164337158, "time_total_s": 978.6119410991669, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1780da820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 978.6119410991669, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 22.325, "ram_util_percent": 80.60833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.096599114004267, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.6237989238961035, "policy_loss": 0.002232375078731113, "vf_loss": 7.619862788316434, "vf_explained_var": -0.00046812005774684684, "kl": 0.009960386173543397, "entropy": 0.7295707486609303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.249666609118382, "cur_kl_coeff": 1.6663851997944408, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.436645562946797, "policy_loss": 0.011258332548701825, "vf_loss": 8.377125751972198, "vf_explained_var": 0.0376255448286732, "kl": 0.028961777459092748, "entropy": 1.3020107282946507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 115680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "env_runners": {"episode_reward_max": 139.02782160147643, "episode_reward_min": -14.103904325727157, "episode_reward_mean": 67.2361551645263, "episode_len_mean": 141.88, "episode_media": {}, "episodes_this_iter": 32, "episodes_timesteps_total": 14188, "policy_reward_min": {"agent_policy": -7.0519521628636, "adversary_policy": -26.678172357918566}, "policy_reward_max": {"agent_policy": 69.51391080073815, "adversary_policy": 48.268702729563024}, "policy_reward_mean": {"agent_policy": 33.61807758226315, "adversary_policy": 16.80903879113157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.51839849481408, 7.710181026742497, 87.85846555423488, 74.78535467889726, 76.08387853354542, 43.091857164805006, 101.39295906535776, 130.79497191694657, 52.78077398814391, 53.60099851671639, 4.936019102480536, 24.894370024706312, 50.341532262871496, 100.66632700974807, 65.75196836683378, 68.0915130378823, 48.28696447081486, 67.42794995753208, 104.09856832548002, 82.73118529217695, 83.22745870254496, 46.673953813567366, 94.434897848524, 139.02782160147643, 96.61231504775472, 89.12873124498415, 98.07841814265126, -2.318506102835517, 136.67845722853525, 106.03085132611915, 82.3020365848319, 1.34057785679538, 113.0183020874012, 72.59548636791723, 50.77418893650942, 108.30832690302174, 31.16755818326346, 29.395377848285648, 41.718674476463875, 33.687899014855006, 103.25364629479134, 56.711367201971896, 74.80082400423697, 93.09590798512698, 53.79435931950228, 97.6255453254723, 11.288670292623664, 90.60020776524632, 98.46117717963554, 123.52701172450426, 135.95282319644477, 34.74508727347816, 78.77794607481334, 90.65476561011961, 7.040474302472134, 27.720962897802057, 115.69994548319471, 8.613840409152262, 120.31334322474365, 75.92886824625667, 81.77373490413703, 68.1587901510933, 63.52416213059885, 39.694156355000075, 68.5585847802426, 87.6986852793724, 65.64742196732242, 105.13787176646395, 94.68222524020203, 46.782439621575044, 49.87802304981062, 97.5224468312463, 107.69206936129353, 15.896787664400051, -4.766725222534255, 15.505573072639407, 65.96919908626555, 53.51660035363719, 84.0736846791433, 96.83653182161504, 112.04054139353502, 96.14923661424912, 61.39337962134465, 65.829851858126, 21.293782511211827, 73.28213492122039, 86.20701167646587, -14.103904325727157, 80.76074911874933, 106.91152493785691, 14.022316622101414, 81.80666565281891, 47.72538247962388, -1.5892092191584908, 109.93313963972237, 39.81414838082786, 105.60790475046528, 14.870462676097208, 41.951534251428356, 50.592762283159345], "episode_lengths": [200, 200, 200, 189, 200, 165, 200, 200, 200, 200, 3, 200, 17, 200, 128, 168, 92, 200, 101, 200, 200, 200, 135, 169, 149, 123, 195, 144, 191, 200, 200, 85, 200, 200, 200, 178, 73, 183, 116, 198, 145, 52, 114, 200, 191, 110, 200, 60, 143, 200, 96, 153, 159, 115, 33, 128, 143, 5, 93, 35, 200, 31, 95, 129, 195, 33, 121, 110, 200, 173, 151, 141, 119, 32, 150, 19, 137, 181, 177, 123, 56, 155, 190, 102, 71, 39, 156, 200, 36, 154, 173, 163, 200, 88, 171, 176, 200, 42, 154, 168], "policy_agent_policy_reward": [14.759199247407041, 3.855090513371259, 43.92923277711745, 37.39267733944865, 38.041939266772715, 21.5459285824025, 50.696479532678886, 65.39748595847325, 26.390386994071946, 26.800499258358197, 2.4680095512402676, 12.447185012353161, 25.17076613143576, 50.33316350487405, 32.87598418341688, 34.04575651894113, 24.143482235407433, 33.71397497876603, 52.049284162740044, 41.36559264608844, 41.61372935127246, 23.33697690678368, 47.21744892426198, 69.51391080073815, 48.30615752387738, 44.56436562249207, 49.03920907132563, -1.1592530514177515, 68.33922861426763, 53.01542566305955, 41.151018292415934, 0.6702889283976896, 56.50915104370067, 36.2977431839586, 25.387094468254716, 54.15416345151087, 15.583779091631737, 14.697688924142799, 20.859337238231923, 16.843949507427475, 51.626823147395626, 28.355683600985934, 37.40041200211847, 46.54795399256347, 26.897179659751135, 48.81277266273615, 5.644335146311839, 45.300103882623176, 49.23058858981776, 61.76350586225213, 67.97641159822236, 17.372543636739074, 39.38897303740668, 45.3273828050598, 3.520237151236067, 13.860481448901046, 57.849972741597355, 4.30692020457613, 60.15667161237181, 37.96443412312832, 40.886867452068536, 34.07939507554664, 31.76208106529943, 19.84707817750003, 34.279292390121284, 43.849342639686185, 32.823710983661215, 52.56893588323193, 47.341112620101015, 23.391219810787522, 24.939011524905304, 48.76122341562315, 53.84603468064681, 7.948393832200026, -2.383362611267138, 7.752786536319707, 32.98459954313275, 26.758300176818597, 42.03684233957166, 48.41826591080753, 56.02027069676749, 48.07461830712452, 30.69668981067232, 32.914925929063, 10.64689125560591, 36.64106746061019, 43.10350583823294, -7.0519521628636, 40.38037455937466, 53.455762468928455, 7.011158311050693, 40.90333282640947, 23.86269123981194, -0.7946046095792436, 54.96656981986118, 19.90707419041394, 52.80395237523263, 7.435231338048606, 20.97576712571418, 25.296381141579666], "policy_adversary_policy_reward": [4.531535762469013, 10.22766348493803, 0.5820073680726487, 3.2730831452986084, 22.64971676801614, 21.279516009101286, 20.606977837734213, 16.785699501714447, 13.1585666951206, 24.883372571652124, 2.9348671737576275, 18.61106140864488, 24.65971598067362, 26.036763552005226, 21.886973740955337, 43.51051221751793, 10.14533057527428, 16.245056418797667, 6.142700452898863, 20.657798805459326, 1.6737795737829584, 0.7942299774573094, 16.241004224311993, -3.793819211958837, 16.040220308411538, 9.130545823024221, 29.540802997224127, 20.79236050764993, 3.656207851622076, 29.219776331794808, 23.35201934771062, 10.693737171230513, 9.277932695553039, 14.865549539854396, 9.77123793443911, 23.942737044326933, 18.53854325093559, 33.51074091180444, 24.080510614711137, 17.285082031377314, 29.66888500519662, 11.944844346075842, 2.972945512246593, 20.364031394537086, 5.043117032993489, 42.17433189126849, 25.15281245059447, 44.361098350143706, 37.59529145537752, 10.710866068499861, 17.185070108840193, 27.379295513651883, 34.525803339308126, 14.51340573201752, 10.396722920883228, -11.555975972300978, 48.268702729563024, 20.07052588470463, 26.293640867021594, 26.721784796037966, 26.014943629724776, 15.136074662691165, -7.54136055110763, 8.211649479505322, 22.21126329003673, 34.29788775366392, 9.381182138820169, 26.916561045138437, 19.893719696354296, 5.493374771900399, 35.55456140632214, 18.599602045188718, 3.850246871139521, 11.733532220492215, -1.4449564537781612, 16.14264537792096, -8.834533575744107, 29.693870813976034, 12.002854220918657, 4.841095286508796, 40.13839690153156, 11.48842624586408, 22.142680046688035, 6.213003554297899, 16.030188956020606, 21.37022304609787, 36.76568998461836, 9.782264007945125, 14.499277814717406, 12.397901845033726, 30.705421044820866, 18.107351617915285, 4.411294916503632, 1.2330402298082035, 13.134283716858775, 32.16582016576441, 34.30593824051855, 14.924650349299222, 29.318826065158518, 32.44467979709361, 33.419122481926046, 34.557289116296296, 0.8552794497386209, 16.517264187000453, 23.600897990593527, 15.788075046813148, 16.264027365360715, 29.06335543969908, 17.772081626761526, -14.25184447552546, -6.9292011393750315, 20.78968258827608, 18.070679721900547, 39.77929301969681, 2.4831829807706995, 1.823737223805431, 31.71203912121178, 28.444632491160032, 8.020266318344193, 29.944167804784122, 17.248984281461855, 23.637883170606667, 13.800137935779139, 20.279257139767513, 24.976013358906087, 6.786067706393343, 8.454150108069989, 11.392928069430036, 4.571544689981721, 29.70774770013957, 24.738818022354536, 19.11052461733164, 6.410019168278854, 26.413691815382364, 16.335929157522145, 36.233006725709785, 15.750147766732418, 31.590964853368597, -12.035892466087159, 35.42711227687468, 20.485688026701126, 4.453323498204185, 40.45661485180312, 8.304608563820029, 24.208065923728483, 29.6379687569183, -7.282893361374494, 15.23128719357452, 9.610312874675653, -11.993675485942788, 14.040812547595, -6.288026011275296, 13.201955113138418, 19.78264442999434, 8.961781737674025, 17.79651843914456, 23.54721053341788, 18.48963180615378, 15.616571350778006, 32.80169456002951, 14.929337357088826, 41.090933339678664, 26.4022920334474, 21.672326273677122, 23.690311409265583, 7.006378401406742, 8.454830917596517, 24.46009501146649, 37.32506361352448, -26.678172357918566, 27.78914657608941, 8.851920884520787, -1.6346564787431062, 44.738162316976045, -13.454467029910777, 6.402514867047184, 26.88040616184315, 13.499968397531513, 35.96548683297813, 17.490275635950333, 13.729569420376777, -6.718411109326063, 15.092089198134342, 25.811243628275125, 25.803686718703336, -1.940995478891395, -7.631196379112936, 6.83659176953369, 32.3729625566564, 22.593607263204774, 5.209853158080676, 14.697221032333267, 17.359543783656665, 35.44440859157598, -2.866131234470531, 10.301362572519135, 18.532750697803728, 2.4430164279104583, 12.437940312012735, 12.858440829566934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3850904437611573, "mean_inference_ms": 0.956234508644659, "mean_action_processing_ms": 0.16358894976314442, "mean_env_wait_ms": 0.056524385710045755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034459829330444336, "StateBufferConnector_ms": 0.0024350881576538086, "ViewRequirementAgentConnector_ms": 0.06557118892669678}, "num_episodes": 32, "episode_return_max": 139.02782160147643, "episode_return_min": -14.103904325727157, "episode_return_mean": 67.2361551645263}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 506.93473682276726, "num_env_steps_trained_throughput_per_sec": 506.93473682276726, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 1452000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1452000, "timers": {"training_iteration_time_ms": 7969.852, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7969.818, "sample_time_ms": 720.768, "learn_time_ms": 7237.921, "learn_throughput": 552.645, "synch_weights_time_ms": 10.631}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "done": false, "training_iteration": 121, "trial_id": "eaa30_00000", "date": "2024-08-09_17-56-47", "timestamp": 1723240607, "time_this_iter_s": 7.895525932312012, "time_total_s": 986.5074670314789, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1780dae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 986.5074670314789, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 22.31818181818182, "ram_util_percent": 80.46363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.08967941803907, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.884803414470935, "policy_loss": 0.0020110193360350515, "vf_loss": 6.881143750084771, "vf_explained_var": 0.11630270039593732, "kl": 0.0096382527474176, "entropy": 0.6972537907973799, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.130267592457434, "cur_kl_coeff": 2.499577799691662, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.201001286506653, "policy_loss": 0.005789080870939264, "vf_loss": 8.146910611788432, "vf_explained_var": 0.041809787352879844, "kl": 0.01932389678840991, "entropy": 1.3203087117522956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 116640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "env_runners": {"episode_reward_max": 148.58382826376706, "episode_reward_min": -42.91678594493584, "episode_reward_mean": 64.47093769641873, "episode_len_mean": 136.78, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 13678, "policy_reward_min": {"agent_policy": -21.458392972467962, "adversary_policy": -26.678172357918566}, "policy_reward_max": {"agent_policy": 74.29191413188354, "adversary_policy": 48.268702729563024}, "policy_reward_mean": {"agent_policy": 32.23546884820936, "adversary_policy": 16.11773442410468}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.318506102835517, 136.67845722853525, 106.03085132611915, 82.3020365848319, 1.34057785679538, 113.0183020874012, 72.59548636791723, 50.77418893650942, 108.30832690302174, 31.16755818326346, 29.395377848285648, 41.718674476463875, 33.687899014855006, 103.25364629479134, 56.711367201971896, 74.80082400423697, 93.09590798512698, 53.79435931950228, 97.6255453254723, 11.288670292623664, 90.60020776524632, 98.46117717963554, 123.52701172450426, 135.95282319644477, 34.74508727347816, 78.77794607481334, 90.65476561011961, 7.040474302472134, 27.720962897802057, 115.69994548319471, 8.613840409152262, 120.31334322474365, 75.92886824625667, 81.77373490413703, 68.1587901510933, 63.52416213059885, 39.694156355000075, 68.5585847802426, 87.6986852793724, 65.64742196732242, 105.13787176646395, 94.68222524020203, 46.782439621575044, 49.87802304981062, 97.5224468312463, 107.69206936129353, 15.896787664400051, -4.766725222534255, 15.505573072639407, 65.96919908626555, 53.51660035363719, 84.0736846791433, 96.83653182161504, 112.04054139353502, 96.14923661424912, 61.39337962134465, 65.829851858126, 21.293782511211827, 73.28213492122039, 86.20701167646587, -14.103904325727157, 80.76074911874933, 106.91152493785691, 14.022316622101414, 81.80666565281891, 47.72538247962388, -1.5892092191584908, 109.93313963972237, 39.81414838082786, 105.60790475046528, 14.870462676097208, 41.951534251428356, 50.592762283159345, 89.19910439262298, -42.91678594493584, 35.06503162914049, 57.49346748470764, 26.775241064774235, 96.71988104420016, 57.34347354234167, 70.26677836687116, 107.37885275071255, 58.905212937246475, 10.97410082264912, 89.53865723151026, 56.00558420119145, 67.58160583217227, 51.53742659657509, -7.189136855696674, 85.30716824835942, 111.45108949243047, 92.17436296730166, 79.97882123764722, 31.141664170078297, 148.58382826376706, 4.345424313994485, 87.76385690433915, 85.39336112822278, 73.27831891988501, 21.4096956393678], "episode_lengths": [144, 191, 200, 200, 85, 200, 200, 200, 178, 73, 183, 116, 198, 145, 52, 114, 200, 191, 110, 200, 60, 143, 200, 96, 153, 159, 115, 33, 128, 143, 5, 93, 35, 200, 31, 95, 129, 195, 33, 121, 110, 200, 173, 151, 141, 119, 32, 150, 19, 137, 181, 177, 123, 56, 155, 190, 102, 71, 39, 156, 200, 36, 154, 173, 163, 200, 88, 171, 176, 200, 42, 154, 168, 137, 200, 48, 125, 135, 132, 180, 132, 172, 155, 200, 126, 75, 172, 200, 138, 195, 112, 155, 200, 158, 65, 173, 78, 200, 150, 111], "policy_agent_policy_reward": [-1.1592530514177515, 68.33922861426763, 53.01542566305955, 41.151018292415934, 0.6702889283976896, 56.50915104370067, 36.2977431839586, 25.387094468254716, 54.15416345151087, 15.583779091631737, 14.697688924142799, 20.859337238231923, 16.843949507427475, 51.626823147395626, 28.355683600985934, 37.40041200211847, 46.54795399256347, 26.897179659751135, 48.81277266273615, 5.644335146311839, 45.300103882623176, 49.23058858981776, 61.76350586225213, 67.97641159822236, 17.372543636739074, 39.38897303740668, 45.3273828050598, 3.520237151236067, 13.860481448901046, 57.849972741597355, 4.30692020457613, 60.15667161237181, 37.96443412312832, 40.886867452068536, 34.07939507554664, 31.76208106529943, 19.84707817750003, 34.279292390121284, 43.849342639686185, 32.823710983661215, 52.56893588323193, 47.341112620101015, 23.391219810787522, 24.939011524905304, 48.76122341562315, 53.84603468064681, 7.948393832200026, -2.383362611267138, 7.752786536319707, 32.98459954313275, 26.758300176818597, 42.03684233957166, 48.41826591080753, 56.02027069676749, 48.07461830712452, 30.69668981067232, 32.914925929063, 10.64689125560591, 36.64106746061019, 43.10350583823294, -7.0519521628636, 40.38037455937466, 53.455762468928455, 7.011158311050693, 40.90333282640947, 23.86269123981194, -0.7946046095792436, 54.96656981986118, 19.90707419041394, 52.80395237523263, 7.435231338048606, 20.97576712571418, 25.296381141579666, 44.59955219631148, -21.458392972467962, 17.53251581457025, 28.746733742353825, 13.387620532387121, 48.3599405221001, 28.67173677117087, 35.13338918343558, 53.68942637535629, 29.452606468623237, 5.487050411324542, 44.76932861575509, 28.002792100595723, 33.79080291608615, 25.768713298287548, -3.5945684278483174, 42.653584124179716, 55.725544746215185, 46.08718148365084, 39.98941061882362, 15.57083208503915, 74.29191413188354, 2.1727121569972567, 43.881928452169575, 42.69668056411139, 36.63915945994249, 10.704847819683902], "policy_adversary_policy_reward": [10.396722920883228, -11.555975972300978, 48.268702729563024, 20.07052588470463, 26.293640867021594, 26.721784796037966, 26.014943629724776, 15.136074662691165, -7.54136055110763, 8.211649479505322, 22.21126329003673, 34.29788775366392, 9.381182138820169, 26.916561045138437, 19.893719696354296, 5.493374771900399, 35.55456140632214, 18.599602045188718, 3.850246871139521, 11.733532220492215, -1.4449564537781612, 16.14264537792096, -8.834533575744107, 29.693870813976034, 12.002854220918657, 4.841095286508796, 40.13839690153156, 11.48842624586408, 22.142680046688035, 6.213003554297899, 16.030188956020606, 21.37022304609787, 36.76568998461836, 9.782264007945125, 14.499277814717406, 12.397901845033726, 30.705421044820866, 18.107351617915285, 4.411294916503632, 1.2330402298082035, 13.134283716858775, 32.16582016576441, 34.30593824051855, 14.924650349299222, 29.318826065158518, 32.44467979709361, 33.419122481926046, 34.557289116296296, 0.8552794497386209, 16.517264187000453, 23.600897990593527, 15.788075046813148, 16.264027365360715, 29.06335543969908, 17.772081626761526, -14.25184447552546, -6.9292011393750315, 20.78968258827608, 18.070679721900547, 39.77929301969681, 2.4831829807706995, 1.823737223805431, 31.71203912121178, 28.444632491160032, 8.020266318344193, 29.944167804784122, 17.248984281461855, 23.637883170606667, 13.800137935779139, 20.279257139767513, 24.976013358906087, 6.786067706393343, 8.454150108069989, 11.392928069430036, 4.571544689981721, 29.70774770013957, 24.738818022354536, 19.11052461733164, 6.410019168278854, 26.413691815382364, 16.335929157522145, 36.233006725709785, 15.750147766732418, 31.590964853368597, -12.035892466087159, 35.42711227687468, 20.485688026701126, 4.453323498204185, 40.45661485180312, 8.304608563820029, 24.208065923728483, 29.6379687569183, -7.282893361374494, 15.23128719357452, 9.610312874675653, -11.993675485942788, 14.040812547595, -6.288026011275296, 13.201955113138418, 19.78264442999434, 8.961781737674025, 17.79651843914456, 23.54721053341788, 18.48963180615378, 15.616571350778006, 32.80169456002951, 14.929337357088826, 41.090933339678664, 26.4022920334474, 21.672326273677122, 23.690311409265583, 7.006378401406742, 8.454830917596517, 24.46009501146649, 37.32506361352448, -26.678172357918566, 27.78914657608941, 8.851920884520787, -1.6346564787431062, 44.738162316976045, -13.454467029910777, 6.402514867047184, 26.88040616184315, 13.499968397531513, 35.96548683297813, 17.490275635950333, 13.729569420376777, -6.718411109326063, 15.092089198134342, 25.811243628275125, 25.803686718703336, -1.940995478891395, -7.631196379112936, 6.83659176953369, 32.3729625566564, 22.593607263204774, 5.209853158080676, 14.697221032333267, 17.359543783656665, 35.44440859157598, -2.866131234470531, 10.301362572519135, 18.532750697803728, 2.4430164279104583, 12.437940312012735, 12.858440829566934, 8.611853583187639, 35.98769861312387, -3.615238793239083, -17.843154179228875, 12.913250732782416, 4.619265081787834, 11.60988710589806, 17.136846636455765, 7.444288358104394, 5.943332174282725, 23.407206565115416, 24.952733956984684, 5.033636150079538, 23.638100621091336, -6.4691249665751, 41.60251415001069, 20.90564190533438, 32.78378447002191, 10.053095378065224, 19.399511090558004, -4.528358900779896, 10.015409312104438, 31.62063844046167, 13.148690175293439, 7.363400038851924, 20.639392061743795, -5.256920391239738, 39.04772330732589, 19.998896732331026, 5.769816565956528, 22.27423341648685, -25.868801844335177, 16.20719937768168, 26.446384746498044, 37.89966675483894, 17.825877991376263, 16.86412740263644, 29.22305408101439, 18.666845721665286, 21.322564897158326, 28.356326461773953, -12.78549437673481, 37.479998131947724, 36.81191599993582, -19.011127494481556, 21.183839651478806, 4.717800283114613, 39.16412816905496, 23.95219452504606, 18.74448603906532, 36.78426854111478, -0.14510908117226862, 20.99308844837106, -10.28824062868716]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38505790445078836, "mean_inference_ms": 0.9554477268182033, "mean_action_processing_ms": 0.16367056767692603, "mean_env_wait_ms": 0.05654407863311119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031975507736206055, "StateBufferConnector_ms": 0.0023589134216308594, "ViewRequirementAgentConnector_ms": 0.06449270248413086}, "num_episodes": 27, "episode_return_max": 148.58382826376706, "episode_return_min": -42.91678594493584, "episode_return_mean": 64.47093769641873}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 508.5742322998469, "num_env_steps_trained_throughput_per_sec": 508.5742322998469, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 1464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 7960.051, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7960.017, "sample_time_ms": 720.038, "learn_time_ms": 7228.937, "learn_throughput": 553.332, "synch_weights_time_ms": 10.544}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "training_iteration": 122, "trial_id": "eaa30_00000", "date": "2024-08-09_17-56-55", "timestamp": 1723240615, "time_this_iter_s": 7.8699610233306885, "time_total_s": 994.3774280548096, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1780daee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 994.3774280548096, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 21.366666666666664, "ram_util_percent": 80.325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.998182879806196, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.158742102365645, "policy_loss": 0.0014062885271395168, "vf_loss": 6.155877834148508, "vf_explained_var": 0.2310877111223009, "kl": 0.008523582631140631, "entropy": 0.6246554937627581, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.457612300415834, "cur_kl_coeff": 2.499577799691662, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.975187773505847, "policy_loss": 0.004808980043162592, "vf_loss": 7.950818635523319, "vf_explained_var": 0.025761748539904754, "kl": 0.007825381749474522, "entropy": 1.3187678154557942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 117600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "env_runners": {"episode_reward_max": 148.58382826376706, "episode_reward_min": -42.91678594493584, "episode_reward_mean": 59.29495363949063, "episode_len_mean": 136.5, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 13650, "policy_reward_min": {"agent_policy": -21.458392972467962, "adversary_policy": -26.678172357918566}, "policy_reward_max": {"agent_policy": 74.29191413188354, "adversary_policy": 50.505158314347646}, "policy_reward_mean": {"agent_policy": 29.64747681974531, "adversary_policy": 14.823738409872657}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.720962897802057, 115.69994548319471, 8.613840409152262, 120.31334322474365, 75.92886824625667, 81.77373490413703, 68.1587901510933, 63.52416213059885, 39.694156355000075, 68.5585847802426, 87.6986852793724, 65.64742196732242, 105.13787176646395, 94.68222524020203, 46.782439621575044, 49.87802304981062, 97.5224468312463, 107.69206936129353, 15.896787664400051, -4.766725222534255, 15.505573072639407, 65.96919908626555, 53.51660035363719, 84.0736846791433, 96.83653182161504, 112.04054139353502, 96.14923661424912, 61.39337962134465, 65.829851858126, 21.293782511211827, 73.28213492122039, 86.20701167646587, -14.103904325727157, 80.76074911874933, 106.91152493785691, 14.022316622101414, 81.80666565281891, 47.72538247962388, -1.5892092191584908, 109.93313963972237, 39.81414838082786, 105.60790475046528, 14.870462676097208, 41.951534251428356, 50.592762283159345, 89.19910439262298, -42.91678594493584, 35.06503162914049, 57.49346748470764, 26.775241064774235, 96.71988104420016, 57.34347354234167, 70.26677836687116, 107.37885275071255, 58.905212937246475, 10.97410082264912, 89.53865723151026, 56.00558420119145, 67.58160583217227, 51.53742659657509, -7.189136855696674, 85.30716824835942, 111.45108949243047, 92.17436296730166, 79.97882123764722, 31.141664170078297, 148.58382826376706, 4.345424313994485, 87.76385690433915, 85.39336112822278, 73.27831891988501, 21.4096956393678, -30.136622687524397, 39.1214701257127, 124.95875617062741, 29.57776321878936, 66.07051742217661, 24.294365553141702, 58.72328496163722, 15.279494019477376, 93.73462686122357, 90.68316296487136, 0.44902876215790233, 46.28450807649165, 93.13600945468386, -23.65784212487155, 79.2867557125543, 47.948008587252446, 53.55784287141505, 76.15663396496332, 40.41723668042242, -18.004238244575905, 95.30333608538248, 121.75820926833251, 52.95776867166124, 111.42117090683868, 47.75043505408523, 16.45241583822918, 76.91557186508122, 6.990968528558401], "episode_lengths": [128, 143, 5, 93, 35, 200, 31, 95, 129, 195, 33, 121, 110, 200, 173, 151, 141, 119, 32, 150, 19, 137, 181, 177, 123, 56, 155, 190, 102, 71, 39, 156, 200, 36, 154, 173, 163, 200, 88, 171, 176, 200, 42, 154, 168, 137, 200, 48, 125, 135, 132, 180, 132, 172, 155, 200, 126, 75, 172, 200, 138, 195, 112, 155, 200, 158, 65, 173, 78, 200, 150, 111, 200, 51, 200, 180, 200, 200, 67, 200, 200, 200, 169, 96, 92, 200, 200, 160, 175, 104, 35, 78, 160, 200, 180, 71, 29, 200, 64, 200], "policy_agent_policy_reward": [13.860481448901046, 57.849972741597355, 4.30692020457613, 60.15667161237181, 37.96443412312832, 40.886867452068536, 34.07939507554664, 31.76208106529943, 19.84707817750003, 34.279292390121284, 43.849342639686185, 32.823710983661215, 52.56893588323193, 47.341112620101015, 23.391219810787522, 24.939011524905304, 48.76122341562315, 53.84603468064681, 7.948393832200026, -2.383362611267138, 7.752786536319707, 32.98459954313275, 26.758300176818597, 42.03684233957166, 48.41826591080753, 56.02027069676749, 48.07461830712452, 30.69668981067232, 32.914925929063, 10.64689125560591, 36.64106746061019, 43.10350583823294, -7.0519521628636, 40.38037455937466, 53.455762468928455, 7.011158311050693, 40.90333282640947, 23.86269123981194, -0.7946046095792436, 54.96656981986118, 19.90707419041394, 52.80395237523263, 7.435231338048606, 20.97576712571418, 25.296381141579666, 44.59955219631148, -21.458392972467962, 17.53251581457025, 28.746733742353825, 13.387620532387121, 48.3599405221001, 28.67173677117087, 35.13338918343558, 53.68942637535629, 29.452606468623237, 5.487050411324542, 44.76932861575509, 28.002792100595723, 33.79080291608615, 25.768713298287548, -3.5945684278483174, 42.653584124179716, 55.725544746215185, 46.08718148365084, 39.98941061882362, 15.57083208503915, 74.29191413188354, 2.1727121569972567, 43.881928452169575, 42.69668056411139, 36.63915945994249, 10.704847819683902, -15.068311343762211, 19.56073506285634, 62.4793780853137, 14.788881609394679, 33.03525871108833, 12.147182776570851, 29.36164248081859, 7.639747009738714, 46.86731343061179, 45.34158148243567, 0.22451438107896848, 23.14225403824582, 46.56800472734198, -11.828921062435782, 39.643377856277155, 23.974004293626216, 26.778921435707524, 38.07831698248165, 20.20861834021121, -9.002119122287969, 47.65166804269125, 60.87910463416624, 26.47888433583062, 55.710585453419355, 23.87521752704261, 8.22620791911459, 38.4577859325406, 3.495484264279172], "policy_adversary_policy_reward": [-6.9292011393750315, 20.78968258827608, 18.070679721900547, 39.77929301969681, 2.4831829807706995, 1.823737223805431, 31.71203912121178, 28.444632491160032, 8.020266318344193, 29.944167804784122, 17.248984281461855, 23.637883170606667, 13.800137935779139, 20.279257139767513, 24.976013358906087, 6.786067706393343, 8.454150108069989, 11.392928069430036, 4.571544689981721, 29.70774770013957, 24.738818022354536, 19.11052461733164, 6.410019168278854, 26.413691815382364, 16.335929157522145, 36.233006725709785, 15.750147766732418, 31.590964853368597, -12.035892466087159, 35.42711227687468, 20.485688026701126, 4.453323498204185, 40.45661485180312, 8.304608563820029, 24.208065923728483, 29.6379687569183, -7.282893361374494, 15.23128719357452, 9.610312874675653, -11.993675485942788, 14.040812547595, -6.288026011275296, 13.201955113138418, 19.78264442999434, 8.961781737674025, 17.79651843914456, 23.54721053341788, 18.48963180615378, 15.616571350778006, 32.80169456002951, 14.929337357088826, 41.090933339678664, 26.4022920334474, 21.672326273677122, 23.690311409265583, 7.006378401406742, 8.454830917596517, 24.46009501146649, 37.32506361352448, -26.678172357918566, 27.78914657608941, 8.851920884520787, -1.6346564787431062, 44.738162316976045, -13.454467029910777, 6.402514867047184, 26.88040616184315, 13.499968397531513, 35.96548683297813, 17.490275635950333, 13.729569420376777, -6.718411109326063, 15.092089198134342, 25.811243628275125, 25.803686718703336, -1.940995478891395, -7.631196379112936, 6.83659176953369, 32.3729625566564, 22.593607263204774, 5.209853158080676, 14.697221032333267, 17.359543783656665, 35.44440859157598, -2.866131234470531, 10.301362572519135, 18.532750697803728, 2.4430164279104583, 12.437940312012735, 12.858440829566934, 8.611853583187639, 35.98769861312387, -3.615238793239083, -17.843154179228875, 12.913250732782416, 4.619265081787834, 11.60988710589806, 17.136846636455765, 7.444288358104394, 5.943332174282725, 23.407206565115416, 24.952733956984684, 5.033636150079538, 23.638100621091336, -6.4691249665751, 41.60251415001069, 20.90564190533438, 32.78378447002191, 10.053095378065224, 19.399511090558004, -4.528358900779896, 10.015409312104438, 31.62063844046167, 13.148690175293439, 7.363400038851924, 20.639392061743795, -5.256920391239738, 39.04772330732589, 19.998896732331026, 5.769816565956528, 22.27423341648685, -25.868801844335177, 16.20719937768168, 26.446384746498044, 37.89966675483894, 17.825877991376263, 16.86412740263644, 29.22305408101439, 18.666845721665286, 21.322564897158326, 28.356326461773953, -12.78549437673481, 37.479998131947724, 36.81191599993582, -19.011127494481556, 21.183839651478806, 4.717800283114613, 39.16412816905496, 23.95219452504606, 18.74448603906532, 36.78426854111478, -0.14510908117226862, 20.99308844837106, -10.28824062868716, -18.704948976902827, 3.636637633140616, 2.536754948114731, 17.02398011474161, 20.56542066396393, 41.91395742134977, 28.898251913709714, -14.109370304315028, 20.780410398189865, 12.254848312898439, -0.03685684299281533, 12.184039619563666, 29.94277881710306, -0.5811363362844695, 4.3122032351257715, 3.3275437746129346, 27.89762616944777, 18.96968726116401, 31.43296717220271, 13.908614310232954, -14.39016431229209, 14.614678693371069, -12.436321829071689, 35.57857586731751, -3.937153587005671, 50.505158314347646, 11.303036455468439, -23.13195751790424, 34.333577162613864, 5.309800693663299, -2.8859813124721967, 26.859985606098412, 7.09709023246198, 19.681831203245544, 23.671264778543915, 14.407052203937738, 18.00859160101127, 2.2000267391999415, -16.32499410650493, 7.322874984216968, 20.108023692435033, 27.54364435025621, 30.135602945892323, 30.743501688273916, 11.886696315951383, 14.592188019879238, 17.403202547462982, 38.307382905956366, 26.437245004304707, -2.5620274772621023, 3.413120041253862, 4.813087877860728, 24.143899571310953, 14.313886361229649, 1.2514120319016193, 2.2440722323775653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3848668943781936, "mean_inference_ms": 0.9551335556667653, "mean_action_processing_ms": 0.16369395883904253, "mean_env_wait_ms": 0.056490150938353974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031126737594604492, "StateBufferConnector_ms": 0.0023037195205688477, "ViewRequirementAgentConnector_ms": 0.06107068061828613}, "num_episodes": 28, "episode_return_max": 148.58382826376706, "episode_return_min": -42.91678594493584, "episode_return_mean": 59.29495363949063}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 507.2285869952038, "num_env_steps_trained_throughput_per_sec": 507.2285869952038, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 1476000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 7954.463, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7954.429, "sample_time_ms": 722.63, "learn_time_ms": 7220.54, "learn_throughput": 553.975, "synch_weights_time_ms": 10.759}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "training_iteration": 123, "trial_id": "eaa30_00000", "date": "2024-08-09_17-57-03", "timestamp": 1723240623, "time_this_iter_s": 7.890213966369629, "time_total_s": 1002.2676420211792, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1780f7280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1002.2676420211792, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 21.83636363636364, "ram_util_percent": 80.23636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.695564122931668, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.712037548438582, "policy_loss": -0.0005263671718744768, "vf_loss": 6.711335717054902, "vf_explained_var": 0.19395141245196104, "kl": 0.007180297905924143, "entropy": 0.5328661964683936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.733913968689739, "cur_kl_coeff": 2.499577799691662, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.179565363625686, "policy_loss": 0.0018122454838400395, "vf_loss": 8.157751475771269, "vf_explained_var": -0.17231699818124374, "kl": 0.00800200598629696, "entropy": 1.31433685036997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 118560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 208.18954762475818, "episode_reward_min": -42.91678594493584, "episode_reward_mean": 57.857972711515075, "episode_len_mean": 140.6, "episode_media": {}, "episodes_this_iter": 32, "episodes_timesteps_total": 14060, "policy_reward_min": {"agent_policy": -21.458392972467962, "adversary_policy": -25.868801844335177}, "policy_reward_max": {"agent_policy": 104.09477381237906, "adversary_policy": 55.44541798848573}, "policy_reward_mean": {"agent_policy": 28.928986355757537, "adversary_policy": 14.464493177878769}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.103904325727157, 80.76074911874933, 106.91152493785691, 14.022316622101414, 81.80666565281891, 47.72538247962388, -1.5892092191584908, 109.93313963972237, 39.81414838082786, 105.60790475046528, 14.870462676097208, 41.951534251428356, 50.592762283159345, 89.19910439262298, -42.91678594493584, 35.06503162914049, 57.49346748470764, 26.775241064774235, 96.71988104420016, 57.34347354234167, 70.26677836687116, 107.37885275071255, 58.905212937246475, 10.97410082264912, 89.53865723151026, 56.00558420119145, 67.58160583217227, 51.53742659657509, -7.189136855696674, 85.30716824835942, 111.45108949243047, 92.17436296730166, 79.97882123764722, 31.141664170078297, 148.58382826376706, 4.345424313994485, 87.76385690433915, 85.39336112822278, 73.27831891988501, 21.4096956393678, -30.136622687524397, 39.1214701257127, 124.95875617062741, 29.57776321878936, 66.07051742217661, 24.294365553141702, 58.72328496163722, 15.279494019477376, 93.73462686122357, 90.68316296487136, 0.44902876215790233, 46.28450807649165, 93.13600945468386, -23.65784212487155, 79.2867557125543, 47.948008587252446, 53.55784287141505, 76.15663396496332, 40.41723668042242, -18.004238244575905, 95.30333608538248, 121.75820926833251, 52.95776867166124, 111.42117090683868, 47.75043505408523, 16.45241583822918, 76.91557186508122, 6.990968528558401, 208.18954762475818, 46.05183382980934, 57.14061817225828, 38.62398562490083, 68.73209952167332, 47.361414579616465, -5.480684968585241, 8.754538398833787, -6.680046243860977, 29.357184615116935, 20.169156007899332, 73.13896066817449, 118.29744725436967, 2.658736106634919, 129.9355196781084, 128.9423477198254, 31.048147574083707, 166.7513809915261, 19.13445773528266, -3.598221843603497, 92.8927070960471, 76.6785665248951, 22.879856536333648, 40.87049423802743, 27.466401259794456, 108.94904685715977, 112.47825942259048, 27.982435280443468, 108.03096199724877, 99.81648375816889, 73.62434504262487, 54.35908789311506], "episode_lengths": [200, 36, 154, 173, 163, 200, 88, 171, 176, 200, 42, 154, 168, 137, 200, 48, 125, 135, 132, 180, 132, 172, 155, 200, 126, 75, 172, 200, 138, 195, 112, 155, 200, 158, 65, 173, 78, 200, 150, 111, 200, 51, 200, 180, 200, 200, 67, 200, 200, 200, 169, 96, 92, 200, 200, 160, 175, 104, 35, 78, 160, 200, 180, 71, 29, 200, 64, 200, 113, 148, 165, 200, 175, 200, 179, 26, 9, 83, 145, 200, 107, 163, 99, 61, 150, 108, 200, 200, 98, 200, 43, 67, 133, 179, 68, 122, 98, 57, 104, 200], "policy_agent_policy_reward": [-7.0519521628636, 40.38037455937466, 53.455762468928455, 7.011158311050693, 40.90333282640947, 23.86269123981194, -0.7946046095792436, 54.96656981986118, 19.90707419041394, 52.80395237523263, 7.435231338048606, 20.97576712571418, 25.296381141579666, 44.59955219631148, -21.458392972467962, 17.53251581457025, 28.746733742353825, 13.387620532387121, 48.3599405221001, 28.67173677117087, 35.13338918343558, 53.68942637535629, 29.452606468623237, 5.487050411324542, 44.76932861575509, 28.002792100595723, 33.79080291608615, 25.768713298287548, -3.5945684278483174, 42.653584124179716, 55.725544746215185, 46.08718148365084, 39.98941061882362, 15.57083208503915, 74.29191413188354, 2.1727121569972567, 43.881928452169575, 42.69668056411139, 36.63915945994249, 10.704847819683902, -15.068311343762211, 19.56073506285634, 62.4793780853137, 14.788881609394679, 33.03525871108833, 12.147182776570851, 29.36164248081859, 7.639747009738714, 46.86731343061179, 45.34158148243567, 0.22451438107896848, 23.14225403824582, 46.56800472734198, -11.828921062435782, 39.643377856277155, 23.974004293626216, 26.778921435707524, 38.07831698248165, 20.20861834021121, -9.002119122287969, 47.65166804269125, 60.87910463416624, 26.47888433583062, 55.710585453419355, 23.87521752704261, 8.22620791911459, 38.4577859325406, 3.495484264279172, 104.09477381237906, 23.025916914904627, 28.57030908612913, 19.31199281245044, 34.36604976083666, 23.680707289808232, -2.7403424842926256, 4.377269199416894, -3.3400231219304892, 14.67859230755846, 10.084578003949666, 36.56948033408721, 59.14872362718485, 1.3293680533174665, 64.96775983905421, 64.47117385991271, 15.524073787041868, 83.37569049576305, 9.567228867641324, -1.7991109218017485, 46.44635354802358, 38.339283262447566, 11.439928268166819, 20.435247119013724, 13.73320062989724, 54.47452342857987, 56.239129711295206, 13.991217640221734, 54.01548099862439, 49.90824187908442, 36.81217252131243, 27.17954394655753], "policy_adversary_policy_reward": [-13.454467029910777, 6.402514867047184, 26.88040616184315, 13.499968397531513, 35.96548683297813, 17.490275635950333, 13.729569420376777, -6.718411109326063, 15.092089198134342, 25.811243628275125, 25.803686718703336, -1.940995478891395, -7.631196379112936, 6.83659176953369, 32.3729625566564, 22.593607263204774, 5.209853158080676, 14.697221032333267, 17.359543783656665, 35.44440859157598, -2.866131234470531, 10.301362572519135, 18.532750697803728, 2.4430164279104583, 12.437940312012735, 12.858440829566934, 8.611853583187639, 35.98769861312387, -3.615238793239083, -17.843154179228875, 12.913250732782416, 4.619265081787834, 11.60988710589806, 17.136846636455765, 7.444288358104394, 5.943332174282725, 23.407206565115416, 24.952733956984684, 5.033636150079538, 23.638100621091336, -6.4691249665751, 41.60251415001069, 20.90564190533438, 32.78378447002191, 10.053095378065224, 19.399511090558004, -4.528358900779896, 10.015409312104438, 31.62063844046167, 13.148690175293439, 7.363400038851924, 20.639392061743795, -5.256920391239738, 39.04772330732589, 19.998896732331026, 5.769816565956528, 22.27423341648685, -25.868801844335177, 16.20719937768168, 26.446384746498044, 37.89966675483894, 17.825877991376263, 16.86412740263644, 29.22305408101439, 18.666845721665286, 21.322564897158326, 28.356326461773953, -12.78549437673481, 37.479998131947724, 36.81191599993582, -19.011127494481556, 21.183839651478806, 4.717800283114613, 39.16412816905496, 23.95219452504606, 18.74448603906532, 36.78426854111478, -0.14510908117226862, 20.99308844837106, -10.28824062868716, -18.704948976902827, 3.636637633140616, 2.536754948114731, 17.02398011474161, 20.56542066396393, 41.91395742134977, 28.898251913709714, -14.109370304315028, 20.780410398189865, 12.254848312898439, -0.03685684299281533, 12.184039619563666, 29.94277881710306, -0.5811363362844695, 4.3122032351257715, 3.3275437746129346, 27.89762616944777, 18.96968726116401, 31.43296717220271, 13.908614310232954, -14.39016431229209, 14.614678693371069, -12.436321829071689, 35.57857586731751, -3.937153587005671, 50.505158314347646, 11.303036455468439, -23.13195751790424, 34.333577162613864, 5.309800693663299, -2.8859813124721967, 26.859985606098412, 7.09709023246198, 19.681831203245544, 23.671264778543915, 14.407052203937738, 18.00859160101127, 2.2000267391999415, -16.32499410650493, 7.322874984216968, 20.108023692435033, 27.54364435025621, 30.135602945892323, 30.743501688273916, 11.886696315951383, 14.592188019879238, 17.403202547462982, 38.307382905956366, 26.437245004304707, -2.5620274772621023, 3.413120041253862, 4.813087877860728, 24.143899571310953, 14.313886361229649, 1.2514120319016193, 2.2440722323775653, 48.64935582389334, 55.44541798848573, 10.278424458800531, 12.747492456104116, 19.733342636913395, 8.83696644921573, 12.37602506552762, 6.93596774692282, 19.796815912016115, 14.569233848820542, 16.51627459409861, 7.164432695709621, 1.100050746894219, -3.840393231186848, -1.6237482661059914, 6.001017465522885, 4.398031144303703, -7.738054266234192, 24.156999959194255, -9.478407651635798, -19.215839192985015, 29.30041719693468, 40.99760032955327, -4.428119995466073, 30.843279678571044, 28.30544394861379, 6.840909066935982, -5.511541013618519, 11.596505439249214, 53.37125439980498, 36.27425620989516, 28.196917650017546, 10.118773789420828, 5.405299997621036, 33.08523344584793, 50.29045704991512, 0.12196693182056428, 9.445261935820755, 16.654491072774242, -18.453601994575994, 29.27905492244009, 17.167298625583484, 18.586054891584496, 19.753228370863066, -5.926764279092428, 17.36669254725925, -10.549060607066947, 30.98430772608067, 11.052902906671003, 2.6802977232262366, 30.610398208975045, 23.86412521960483, 15.963529795051718, 40.27559991624349, -4.262139634151003, 18.253357274372743, 28.907051442497185, 25.108429556127213, 50.73059459814841, -0.8223527190639786, 25.939988383571574, 10.872184137740856, 7.149075701499619, 20.03046824505791]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38461781608948603, "mean_inference_ms": 0.953751043938845, "mean_action_processing_ms": 0.1635794957844508, "mean_env_wait_ms": 0.05647704410786687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031167268753051758, "StateBufferConnector_ms": 0.002279043197631836, "ViewRequirementAgentConnector_ms": 0.060945868492126465}, "num_episodes": 32, "episode_return_max": 208.18954762475818, "episode_return_min": -42.91678594493584, "episode_return_mean": 57.857972711515075}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 508.08768759208726, "num_env_steps_trained_throughput_per_sec": 508.08768759208726, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 7945.923, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7945.891, "sample_time_ms": 721.674, "learn_time_ms": 7212.892, "learn_throughput": 554.563, "synch_weights_time_ms": 10.829}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 124, "trial_id": "eaa30_00000", "date": "2024-08-09_17-57-11", "timestamp": 1723240631, "time_this_iter_s": 7.877137184143066, "time_total_s": 1010.1447792053223, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2857ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1010.1447792053223, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 21.745454545454546, "ram_util_percent": 79.78181818181817}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.90918102857297, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.29099381562894, "policy_loss": -0.001093626048701702, "vf_loss": 6.291274619228625, "vf_explained_var": 0.28984818537399254, "kl": 0.004751862972610132, "entropy": 0.5095366912859457, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.536931222863496, "cur_kl_coeff": 2.499577799691662, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.480787660678228, "policy_loss": 0.006281281007007541, "vf_loss": 7.445663902660211, "vf_explained_var": -0.14190415795892478, "kl": 0.011538942172774114, "entropy": 1.2690370512505373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 119520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "env_runners": {"episode_reward_max": 208.18954762475818, "episode_reward_min": -53.47235208613502, "episode_reward_mean": 55.17149380991561, "episode_len_mean": 134.17, "episode_media": {}, "episodes_this_iter": 30, "episodes_timesteps_total": 13417, "policy_reward_min": {"agent_policy": -26.736176043067537, "adversary_policy": -23.13195751790424}, "policy_reward_max": {"agent_policy": 104.09477381237906, "adversary_policy": 55.44541798848573}, "policy_reward_mean": {"agent_policy": 27.585746904957805, "adversary_policy": 13.792873452478903}, "custom_metrics": {}, "hist_stats": {"episode_reward": [111.45108949243047, 92.17436296730166, 79.97882123764722, 31.141664170078297, 148.58382826376706, 4.345424313994485, 87.76385690433915, 85.39336112822278, 73.27831891988501, 21.4096956393678, -30.136622687524397, 39.1214701257127, 124.95875617062741, 29.57776321878936, 66.07051742217661, 24.294365553141702, 58.72328496163722, 15.279494019477376, 93.73462686122357, 90.68316296487136, 0.44902876215790233, 46.28450807649165, 93.13600945468386, -23.65784212487155, 79.2867557125543, 47.948008587252446, 53.55784287141505, 76.15663396496332, 40.41723668042242, -18.004238244575905, 95.30333608538248, 121.75820926833251, 52.95776867166124, 111.42117090683868, 47.75043505408523, 16.45241583822918, 76.91557186508122, 6.990968528558401, 208.18954762475818, 46.05183382980934, 57.14061817225828, 38.62398562490083, 68.73209952167332, 47.361414579616465, -5.480684968585241, 8.754538398833787, -6.680046243860977, 29.357184615116935, 20.169156007899332, 73.13896066817449, 118.29744725436967, 2.658736106634919, 129.9355196781084, 128.9423477198254, 31.048147574083707, 166.7513809915261, 19.13445773528266, -3.598221843603497, 92.8927070960471, 76.6785665248951, 22.879856536333648, 40.87049423802743, 27.466401259794456, 108.94904685715977, 112.47825942259048, 27.982435280443468, 108.03096199724877, 99.81648375816889, 73.62434504262487, 54.35908789311506, 64.4402799523121, 3.3045005204347584, 58.26785818425428, 52.67369568706113, 32.53143390931122, 67.1886482870407, 15.490646899722087, 55.28815263892227, 54.45404088867086, -32.0786242000934, 47.025919883164676, 118.45798249472517, 49.77930768689646, 55.9923910075917, 56.38545227470816, 5.329122738286266, 18.106735612786075, 27.902297373055223, 150.37649237469338, 12.267339336995551, 33.28800954339412, 52.174983911555856, 66.36538264907409, 19.535146423592515, -53.47235208613502, 79.2055501883084, 84.74791359401038, 14.038182855540626, 44.63229267874881, 65.94246712383224], "episode_lengths": [112, 155, 200, 158, 65, 173, 78, 200, 150, 111, 200, 51, 200, 180, 200, 200, 67, 200, 200, 200, 169, 96, 92, 200, 200, 160, 175, 104, 35, 78, 160, 200, 180, 71, 29, 200, 64, 200, 113, 148, 165, 200, 175, 200, 179, 26, 9, 83, 145, 200, 107, 163, 99, 61, 150, 108, 200, 200, 98, 200, 43, 67, 133, 179, 68, 122, 98, 57, 104, 200, 91, 106, 117, 101, 77, 54, 200, 37, 181, 200, 149, 110, 200, 31, 125, 200, 200, 125, 127, 84, 196, 61, 127, 32, 200, 200, 77, 200, 40, 156], "policy_agent_policy_reward": [55.725544746215185, 46.08718148365084, 39.98941061882362, 15.57083208503915, 74.29191413188354, 2.1727121569972567, 43.881928452169575, 42.69668056411139, 36.63915945994249, 10.704847819683902, -15.068311343762211, 19.56073506285634, 62.4793780853137, 14.788881609394679, 33.03525871108833, 12.147182776570851, 29.36164248081859, 7.639747009738714, 46.86731343061179, 45.34158148243567, 0.22451438107896848, 23.14225403824582, 46.56800472734198, -11.828921062435782, 39.643377856277155, 23.974004293626216, 26.778921435707524, 38.07831698248165, 20.20861834021121, -9.002119122287969, 47.65166804269125, 60.87910463416624, 26.47888433583062, 55.710585453419355, 23.87521752704261, 8.22620791911459, 38.4577859325406, 3.495484264279172, 104.09477381237906, 23.025916914904627, 28.57030908612913, 19.31199281245044, 34.36604976083666, 23.680707289808232, -2.7403424842926256, 4.377269199416894, -3.3400231219304892, 14.67859230755846, 10.084578003949666, 36.56948033408721, 59.14872362718485, 1.3293680533174665, 64.96775983905421, 64.47117385991271, 15.524073787041868, 83.37569049576305, 9.567228867641324, -1.7991109218017485, 46.44635354802358, 38.339283262447566, 11.439928268166819, 20.435247119013724, 13.73320062989724, 54.47452342857987, 56.239129711295206, 13.991217640221734, 54.01548099862439, 49.90824187908442, 36.81217252131243, 27.17954394655753, 32.22013997615605, 1.6522502602173716, 29.133929092127136, 26.33684784353056, 16.265716954655616, 33.59432414352035, 7.745323449861047, 27.644076319461142, 27.227020444335444, -16.03931210004671, 23.512959941582345, 59.2289912473626, 24.88965384344823, 27.99619550379586, 28.19272613735408, 2.6645613691431507, 9.053367806393037, 13.951148686527612, 75.18824618734669, 6.133669668497774, 16.644004771697066, 26.08749195577792, 33.18269132453704, 9.767573211796265, -26.736176043067537, 39.60277509415421, 42.37395679700518, 7.019091427770315, 22.31614633937439, 32.971233561916094], "policy_adversary_policy_reward": [37.89966675483894, 17.825877991376263, 16.86412740263644, 29.22305408101439, 18.666845721665286, 21.322564897158326, 28.356326461773953, -12.78549437673481, 37.479998131947724, 36.81191599993582, -19.011127494481556, 21.183839651478806, 4.717800283114613, 39.16412816905496, 23.95219452504606, 18.74448603906532, 36.78426854111478, -0.14510908117226862, 20.99308844837106, -10.28824062868716, -18.704948976902827, 3.636637633140616, 2.536754948114731, 17.02398011474161, 20.56542066396393, 41.91395742134977, 28.898251913709714, -14.109370304315028, 20.780410398189865, 12.254848312898439, -0.03685684299281533, 12.184039619563666, 29.94277881710306, -0.5811363362844695, 4.3122032351257715, 3.3275437746129346, 27.89762616944777, 18.96968726116401, 31.43296717220271, 13.908614310232954, -14.39016431229209, 14.614678693371069, -12.436321829071689, 35.57857586731751, -3.937153587005671, 50.505158314347646, 11.303036455468439, -23.13195751790424, 34.333577162613864, 5.309800693663299, -2.8859813124721967, 26.859985606098412, 7.09709023246198, 19.681831203245544, 23.671264778543915, 14.407052203937738, 18.00859160101127, 2.2000267391999415, -16.32499410650493, 7.322874984216968, 20.108023692435033, 27.54364435025621, 30.135602945892323, 30.743501688273916, 11.886696315951383, 14.592188019879238, 17.403202547462982, 38.307382905956366, 26.437245004304707, -2.5620274772621023, 3.413120041253862, 4.813087877860728, 24.143899571310953, 14.313886361229649, 1.2514120319016193, 2.2440722323775653, 48.64935582389334, 55.44541798848573, 10.278424458800531, 12.747492456104116, 19.733342636913395, 8.83696644921573, 12.37602506552762, 6.93596774692282, 19.796815912016115, 14.569233848820542, 16.51627459409861, 7.164432695709621, 1.100050746894219, -3.840393231186848, -1.6237482661059914, 6.001017465522885, 4.398031144303703, -7.738054266234192, 24.156999959194255, -9.478407651635798, -19.215839192985015, 29.30041719693468, 40.99760032955327, -4.428119995466073, 30.843279678571044, 28.30544394861379, 6.840909066935982, -5.511541013618519, 11.596505439249214, 53.37125439980498, 36.27425620989516, 28.196917650017546, 10.118773789420828, 5.405299997621036, 33.08523344584793, 50.29045704991512, 0.12196693182056428, 9.445261935820755, 16.654491072774242, -18.453601994575994, 29.27905492244009, 17.167298625583484, 18.586054891584496, 19.753228370863066, -5.926764279092428, 17.36669254725925, -10.549060607066947, 30.98430772608067, 11.052902906671003, 2.6802977232262366, 30.610398208975045, 23.86412521960483, 15.963529795051718, 40.27559991624349, -4.262139634151003, 18.253357274372743, 28.907051442497185, 25.108429556127213, 50.73059459814841, -0.8223527190639786, 25.939988383571574, 10.872184137740856, 7.149075701499619, 20.03046824505791, 26.378760751523792, 5.8413792246322735, 12.287997349776898, -10.635747089559526, -15.426054280575592, 44.55998337270272, 7.212965884458093, 19.123881959072467, -9.973166350224098, 26.238883304879714, 23.231252223053453, 10.363071920466904, 4.795351243334375, 2.9499722065266702, 15.502151837054727, 12.14192448240641, 19.76684383230983, 7.460176612025613, -4.830481257058004, -11.208830842988704, 14.894308610098626, 8.618651331483713, 34.56952541846913, 24.659465828893463, 4.703136709205097, 20.186517134243132, 8.474937394744899, 19.52125810905096, 46.83121425791303, -18.638488120558947, -12.200997574798397, 14.865558943941547, -1.490166072635784, 10.543533879028821, -15.091771707253008, 29.04292039378062, 54.711090891365345, 20.477155295981337, -18.2640469501178, 24.39771661861558, 15.471831221086656, 1.1721735506104114, 9.79047040093877, 16.29702155483916, 4.425898297092846, 28.756793027444186, -2.46125689544926, 12.228830107245528, -4.972929248954781, -21.76324679411276, 12.33429884914489, 27.268476245009317, 24.69381254466673, 17.680144252338437, 3.220879657478557, 3.7982117702917613, 25.726267440533547, -3.410121101159156, 18.557868333607555, 14.413365228308539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3844828439862696, "mean_inference_ms": 0.9536249827448902, "mean_action_processing_ms": 0.1636236549399565, "mean_env_wait_ms": 0.05645416034850525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032281875610351562, "StateBufferConnector_ms": 0.0023249387741088867, "ViewRequirementAgentConnector_ms": 0.061881065368652344}, "num_episodes": 30, "episode_return_max": 208.18954762475818, "episode_return_min": -53.47235208613502, "episode_return_mean": 55.17149380991561}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 468.3431649144385, "num_env_steps_trained_throughput_per_sec": 468.3431649144385, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 1500000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 8007.11, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8007.078, "sample_time_ms": 717.039, "learn_time_ms": 7278.759, "learn_throughput": 549.544, "synch_weights_time_ms": 10.708}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": false, "training_iteration": 125, "trial_id": "eaa30_00000", "date": "2024-08-09_17-57-19", "timestamp": 1723240639, "time_this_iter_s": 8.548303127288818, "time_total_s": 1018.6930823326111, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1780f78b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1018.6930823326111, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 26.184615384615384, "ram_util_percent": 80.40769230769232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.199931755520048, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.745797919217871, "policy_loss": 0.0010117187668574313, "vf_loss": 5.744472231940618, "vf_explained_var": 0.22343214725060437, "kl": 0.003671068547505432, "entropy": 0.4876958793275571, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.762782243018349, "cur_kl_coeff": 2.499577799691662, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.86926843971014, "policy_loss": 0.004004287414136343, "vf_loss": 6.845991572737693, "vf_explained_var": -0.13496281777818997, "kl": 0.007710336497984827, "entropy": 1.2293024819344283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 120480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "env_runners": {"episode_reward_max": 208.18954762475818, "episode_reward_min": -53.47235208613502, "episode_reward_mean": 54.69089559251925, "episode_len_mean": 133.51, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 13351, "policy_reward_min": {"agent_policy": -26.736176043067537, "adversary_policy": -27.652279218138133}, "policy_reward_max": {"agent_policy": 104.09477381237906, "adversary_policy": 55.44541798848573}, "policy_reward_mean": {"agent_policy": 27.34544779625962, "adversary_policy": 13.672723898129806}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.948008587252446, 53.55784287141505, 76.15663396496332, 40.41723668042242, -18.004238244575905, 95.30333608538248, 121.75820926833251, 52.95776867166124, 111.42117090683868, 47.75043505408523, 16.45241583822918, 76.91557186508122, 6.990968528558401, 208.18954762475818, 46.05183382980934, 57.14061817225828, 38.62398562490083, 68.73209952167332, 47.361414579616465, -5.480684968585241, 8.754538398833787, -6.680046243860977, 29.357184615116935, 20.169156007899332, 73.13896066817449, 118.29744725436967, 2.658736106634919, 129.9355196781084, 128.9423477198254, 31.048147574083707, 166.7513809915261, 19.13445773528266, -3.598221843603497, 92.8927070960471, 76.6785665248951, 22.879856536333648, 40.87049423802743, 27.466401259794456, 108.94904685715977, 112.47825942259048, 27.982435280443468, 108.03096199724877, 99.81648375816889, 73.62434504262487, 54.35908789311506, 64.4402799523121, 3.3045005204347584, 58.26785818425428, 52.67369568706113, 32.53143390931122, 67.1886482870407, 15.490646899722087, 55.28815263892227, 54.45404088867086, -32.0786242000934, 47.025919883164676, 118.45798249472517, 49.77930768689646, 55.9923910075917, 56.38545227470816, 5.329122738286266, 18.106735612786075, 27.902297373055223, 150.37649237469338, 12.267339336995551, 33.28800954339412, 52.174983911555856, 66.36538264907409, 19.535146423592515, -53.47235208613502, 79.2055501883084, 84.74791359401038, 14.038182855540626, 44.63229267874881, 65.94246712383224, -17.3264696088564, -38.80532053804896, 155.7978312146729, 79.22931433462858, 28.60249677087092, 55.50730146167089, 108.4977341714306, 31.70907109818603, 15.64119937495511, 0.7778572855827974, 85.61467478508595, 13.788794671688223, 17.036779166941297, 189.44459071308398, 14.919864526473518, 129.5342723191662, 51.64959902098036, 87.4952250866753, 19.156701027372122, 19.552554461892434, 65.26742177304135, 124.94768780671328, 85.37369199142555, -0.8772005555842313, 72.73020742849818], "episode_lengths": [160, 175, 104, 35, 78, 160, 200, 180, 71, 29, 200, 64, 200, 113, 148, 165, 200, 175, 200, 179, 26, 9, 83, 145, 200, 107, 163, 99, 61, 150, 108, 200, 200, 98, 200, 43, 67, 133, 179, 68, 122, 98, 57, 104, 200, 91, 106, 117, 101, 77, 54, 200, 37, 181, 200, 149, 110, 200, 31, 125, 200, 200, 125, 127, 84, 196, 61, 127, 32, 200, 200, 77, 200, 40, 156, 200, 200, 138, 176, 200, 200, 112, 107, 123, 200, 200, 200, 83, 183, 200, 104, 96, 57, 200, 79, 200, 94, 39, 200, 200], "policy_agent_policy_reward": [23.974004293626216, 26.778921435707524, 38.07831698248165, 20.20861834021121, -9.002119122287969, 47.65166804269125, 60.87910463416624, 26.47888433583062, 55.710585453419355, 23.87521752704261, 8.22620791911459, 38.4577859325406, 3.495484264279172, 104.09477381237906, 23.025916914904627, 28.57030908612913, 19.31199281245044, 34.36604976083666, 23.680707289808232, -2.7403424842926256, 4.377269199416894, -3.3400231219304892, 14.67859230755846, 10.084578003949666, 36.56948033408721, 59.14872362718485, 1.3293680533174665, 64.96775983905421, 64.47117385991271, 15.524073787041868, 83.37569049576305, 9.567228867641324, -1.7991109218017485, 46.44635354802358, 38.339283262447566, 11.439928268166819, 20.435247119013724, 13.73320062989724, 54.47452342857987, 56.239129711295206, 13.991217640221734, 54.01548099862439, 49.90824187908442, 36.81217252131243, 27.17954394655753, 32.22013997615605, 1.6522502602173716, 29.133929092127136, 26.33684784353056, 16.265716954655616, 33.59432414352035, 7.745323449861047, 27.644076319461142, 27.227020444335444, -16.03931210004671, 23.512959941582345, 59.2289912473626, 24.88965384344823, 27.99619550379586, 28.19272613735408, 2.6645613691431507, 9.053367806393037, 13.951148686527612, 75.18824618734669, 6.133669668497774, 16.644004771697066, 26.08749195577792, 33.18269132453704, 9.767573211796265, -26.736176043067537, 39.60277509415421, 42.37395679700518, 7.019091427770315, 22.31614633937439, 32.971233561916094, -8.663234804428203, -19.402660269024494, 77.89891560733643, 39.614657167314284, 14.30124838543546, 27.753650730835446, 54.248867085715304, 15.854535549093013, 7.820599687477555, 0.3889286427914058, 42.807337392542976, 6.894397335844111, 8.518389583470649, 94.72229535654198, 7.459932263236759, 64.7671361595831, 25.82479951049018, 43.74761254333765, 9.578350513686061, 9.776277230946219, 32.63371088652067, 62.47384390335664, 42.68684599571275, -0.43860027779211563, 36.36510371424909], "policy_adversary_policy_reward": [-2.8859813124721967, 26.859985606098412, 7.09709023246198, 19.681831203245544, 23.671264778543915, 14.407052203937738, 18.00859160101127, 2.2000267391999415, -16.32499410650493, 7.322874984216968, 20.108023692435033, 27.54364435025621, 30.135602945892323, 30.743501688273916, 11.886696315951383, 14.592188019879238, 17.403202547462982, 38.307382905956366, 26.437245004304707, -2.5620274772621023, 3.413120041253862, 4.813087877860728, 24.143899571310953, 14.313886361229649, 1.2514120319016193, 2.2440722323775653, 48.64935582389334, 55.44541798848573, 10.278424458800531, 12.747492456104116, 19.733342636913395, 8.83696644921573, 12.37602506552762, 6.93596774692282, 19.796815912016115, 14.569233848820542, 16.51627459409861, 7.164432695709621, 1.100050746894219, -3.840393231186848, -1.6237482661059914, 6.001017465522885, 4.398031144303703, -7.738054266234192, 24.156999959194255, -9.478407651635798, -19.215839192985015, 29.30041719693468, 40.99760032955327, -4.428119995466073, 30.843279678571044, 28.30544394861379, 6.840909066935982, -5.511541013618519, 11.596505439249214, 53.37125439980498, 36.27425620989516, 28.196917650017546, 10.118773789420828, 5.405299997621036, 33.08523344584793, 50.29045704991512, 0.12196693182056428, 9.445261935820755, 16.654491072774242, -18.453601994575994, 29.27905492244009, 17.167298625583484, 18.586054891584496, 19.753228370863066, -5.926764279092428, 17.36669254725925, -10.549060607066947, 30.98430772608067, 11.052902906671003, 2.6802977232262366, 30.610398208975045, 23.86412521960483, 15.963529795051718, 40.27559991624349, -4.262139634151003, 18.253357274372743, 28.907051442497185, 25.108429556127213, 50.73059459814841, -0.8223527190639786, 25.939988383571574, 10.872184137740856, 7.149075701499619, 20.03046824505791, 26.378760751523792, 5.8413792246322735, 12.287997349776898, -10.635747089559526, -15.426054280575592, 44.55998337270272, 7.212965884458093, 19.123881959072467, -9.973166350224098, 26.238883304879714, 23.231252223053453, 10.363071920466904, 4.795351243334375, 2.9499722065266702, 15.502151837054727, 12.14192448240641, 19.76684383230983, 7.460176612025613, -4.830481257058004, -11.208830842988704, 14.894308610098626, 8.618651331483713, 34.56952541846913, 24.659465828893463, 4.703136709205097, 20.186517134243132, 8.474937394744899, 19.52125810905096, 46.83121425791303, -18.638488120558947, -12.200997574798397, 14.865558943941547, -1.490166072635784, 10.543533879028821, -15.091771707253008, 29.04292039378062, 54.711090891365345, 20.477155295981337, -18.2640469501178, 24.39771661861558, 15.471831221086656, 1.1721735506104114, 9.79047040093877, 16.29702155483916, 4.425898297092846, 28.756793027444186, -2.46125689544926, 12.228830107245528, -4.972929248954781, -21.76324679411276, 12.33429884914489, 27.268476245009317, 24.69381254466673, 17.680144252338437, 3.220879657478557, 3.7982117702917613, 25.726267440533547, -3.410121101159156, 18.557868333607555, 14.413365228308539, -12.660678666474123, 3.9974438620459196, -5.585110762570528, -13.817549506453975, 44.61687128400108, 33.28204432333538, 41.256746613438786, -1.6420894461245013, -10.311304079004646, 24.612552464440107, 30.018375375474335, -2.264724644638889, 29.209499875285793, 25.039367210429496, -13.244540024741859, 29.099075573834874, -27.652279218138133, 35.47287890561569, 13.133895328849288, -12.744966686057879, 25.8435737189195, 16.963763673623475, 9.942414383216082, -3.048017047371971, 18.206372039188036, -9.687982455717375, 46.237355565506235, 48.48493979103573, 4.509263366398137, 2.9506688968386214, 32.679254719045666, 32.08788144053744, 14.02368813544328, 11.8011113750469, 40.71944476180657, 3.0281677815310815, 4.6575835995066015, 4.92076691417946, -22.533505299020398, 32.30978252996661, 20.466062512881116, 12.167648373639551, 22.23665115569335, 40.23719274766328, 13.207327892425988, 29.479518103286757, -5.605819512718966, 5.167219234926851, 20.657298006750693, 15.707805707498384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3844119067793879, "mean_inference_ms": 0.9529640275941261, "mean_action_processing_ms": 0.1637428079342746, "mean_env_wait_ms": 0.056441982780006776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003453969955444336, "StateBufferConnector_ms": 0.002398252487182617, "ViewRequirementAgentConnector_ms": 0.06459391117095947}, "num_episodes": 25, "episode_return_max": 208.18954762475818, "episode_return_min": -53.47235208613502, "episode_return_mean": 54.69089559251925}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.6899502049903, "num_env_steps_trained_throughput_per_sec": 499.6899502049903, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 1512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 8020.372, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8020.339, "sample_time_ms": 712.177, "learn_time_ms": 7296.747, "learn_throughput": 548.189, "synch_weights_time_ms": 10.838}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": false, "training_iteration": 126, "trial_id": "eaa30_00000", "date": "2024-08-09_17-57-28", "timestamp": 1723240648, "time_this_iter_s": 8.010410070419312, "time_total_s": 1026.7034924030304, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1780f7940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1026.7034924030304, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 23.69090909090909, "ram_util_percent": 80.47272727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.663262739887944, "cur_kl_coeff": 0.04276307523250579, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.386674322905364, "policy_loss": -0.001292985183847132, "vf_loss": 6.387785308827799, "vf_explained_var": 0.18923645498891356, "kl": 0.004256124955616773, "entropy": 0.4990937807099529, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.842371309921146, "cur_kl_coeff": 2.499577799691662, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.392133549352486, "policy_loss": 0.001039055448200088, "vf_loss": 8.372120563685893, "vf_explained_var": -0.1348780763025085, "kl": 0.007590862106007989, "entropy": 1.1667648311704397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 121440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000}, "env_runners": {"episode_reward_max": 189.44459071308398, "episode_reward_min": -53.47235208613502, "episode_reward_mean": 51.23472285894795, "episode_len_mean": 126.0, "episode_media": {}, "episodes_this_iter": 39, "episodes_timesteps_total": 12600, "policy_reward_min": {"agent_policy": -26.736176043067537, "adversary_policy": -27.652279218138133}, "policy_reward_max": {"agent_policy": 94.72229535654198, "adversary_policy": 54.711090891365345}, "policy_reward_mean": {"agent_policy": 25.617361429473974, "adversary_policy": 12.808680714736989}, "custom_metrics": {}, "hist_stats": {"episode_reward": [112.47825942259048, 27.982435280443468, 108.03096199724877, 99.81648375816889, 73.62434504262487, 54.35908789311506, 64.4402799523121, 3.3045005204347584, 58.26785818425428, 52.67369568706113, 32.53143390931122, 67.1886482870407, 15.490646899722087, 55.28815263892227, 54.45404088867086, -32.0786242000934, 47.025919883164676, 118.45798249472517, 49.77930768689646, 55.9923910075917, 56.38545227470816, 5.329122738286266, 18.106735612786075, 27.902297373055223, 150.37649237469338, 12.267339336995551, 33.28800954339412, 52.174983911555856, 66.36538264907409, 19.535146423592515, -53.47235208613502, 79.2055501883084, 84.74791359401038, 14.038182855540626, 44.63229267874881, 65.94246712383224, -17.3264696088564, -38.80532053804896, 155.7978312146729, 79.22931433462858, 28.60249677087092, 55.50730146167089, 108.4977341714306, 31.70907109818603, 15.64119937495511, 0.7778572855827974, 85.61467478508595, 13.788794671688223, 17.036779166941297, 189.44459071308398, 14.919864526473518, 129.5342723191662, 51.64959902098036, 87.4952250866753, 19.156701027372122, 19.552554461892434, 65.26742177304135, 124.94768780671328, 85.37369199142555, -0.8772005555842313, 72.73020742849818, 82.28133288821795, 47.99970200066099, 45.6306737370105, 41.85657869153084, 38.58449303822505, 11.482850843646435, 20.737029307047425, 27.29430528640053, 19.45683048371728, 48.605234212213205, 2.0410067749387215, 56.17039020544412, 89.99307174290212, 29.897911798843836, 34.75355398984962, 90.1345897244515, 123.0677704680713, 42.914361992618055, 106.9138011076837, 22.7915333501321, 88.36066825802821, 31.271483087633115, 43.803988987553566, 14.69344773974866, -16.222133006768416, 34.493006571973595, 145.54862503814428, 7.757750352186704, 81.59611185239942, 51.9819690370783, 57.24191917492523, -44.78433401140779, 125.97260172870273, 49.94456047166469, 92.96632830257627, 65.72705381041848, 26.617071623896095, 128.8269170560826, -36.1304754388442], "episode_lengths": [68, 122, 98, 57, 104, 200, 91, 106, 117, 101, 77, 54, 200, 37, 181, 200, 149, 110, 200, 31, 125, 200, 200, 125, 127, 84, 196, 61, 127, 32, 200, 200, 77, 200, 40, 156, 200, 200, 138, 176, 200, 200, 112, 107, 123, 200, 200, 200, 83, 183, 200, 104, 96, 57, 200, 79, 200, 94, 39, 200, 200, 148, 124, 151, 86, 145, 85, 86, 37, 200, 40, 5, 51, 157, 200, 17, 80, 71, 121, 70, 200, 155, 79, 96, 109, 200, 65, 130, 186, 87, 74, 66, 200, 138, 80, 72, 156, 89, 100, 200], "policy_agent_policy_reward": [56.239129711295206, 13.991217640221734, 54.01548099862439, 49.90824187908442, 36.81217252131243, 27.17954394655753, 32.22013997615605, 1.6522502602173716, 29.133929092127136, 26.33684784353056, 16.265716954655616, 33.59432414352035, 7.745323449861047, 27.644076319461142, 27.227020444335444, -16.03931210004671, 23.512959941582345, 59.2289912473626, 24.88965384344823, 27.99619550379586, 28.19272613735408, 2.6645613691431507, 9.053367806393037, 13.951148686527612, 75.18824618734669, 6.133669668497774, 16.644004771697066, 26.08749195577792, 33.18269132453704, 9.767573211796265, -26.736176043067537, 39.60277509415421, 42.37395679700518, 7.019091427770315, 22.31614633937439, 32.971233561916094, -8.663234804428203, -19.402660269024494, 77.89891560733643, 39.614657167314284, 14.30124838543546, 27.753650730835446, 54.248867085715304, 15.854535549093013, 7.820599687477555, 0.3889286427914058, 42.807337392542976, 6.894397335844111, 8.518389583470649, 94.72229535654198, 7.459932263236759, 64.7671361595831, 25.82479951049018, 43.74761254333765, 9.578350513686061, 9.776277230946219, 32.63371088652067, 62.47384390335664, 42.68684599571275, -0.43860027779211563, 36.36510371424909, 41.14066644410901, 23.999851000330487, 22.81533686850525, 20.928289345765418, 19.29224651911253, 5.741425421823217, 10.368514653523714, 13.647152643200267, 9.728415241858656, 24.302617106106602, 1.0205033874693608, 28.08519510272207, 44.99653587145109, 14.948955899421918, 17.37677699492481, 45.06729486222576, 61.533885234035665, 21.457180996309027, 53.456900553841834, 11.39576667506605, 44.18033412901414, 15.63574154381656, 21.901994493776797, 7.3467238698743405, -8.111066503384201, 17.246503285986794, 72.77431251907211, 3.878875176093352, 40.798055926199716, 25.990984518539143, 28.620959587462604, -22.39216700570394, 62.98630086435137, 24.972280235832343, 46.48316415128812, 32.863526905209255, 13.308535811948047, 64.4134585280413, -18.0652377194221], "policy_adversary_policy_reward": [15.963529795051718, 40.27559991624349, -4.262139634151003, 18.253357274372743, 28.907051442497185, 25.108429556127213, 50.73059459814841, -0.8223527190639786, 25.939988383571574, 10.872184137740856, 7.149075701499619, 20.03046824505791, 26.378760751523792, 5.8413792246322735, 12.287997349776898, -10.635747089559526, -15.426054280575592, 44.55998337270272, 7.212965884458093, 19.123881959072467, -9.973166350224098, 26.238883304879714, 23.231252223053453, 10.363071920466904, 4.795351243334375, 2.9499722065266702, 15.502151837054727, 12.14192448240641, 19.76684383230983, 7.460176612025613, -4.830481257058004, -11.208830842988704, 14.894308610098626, 8.618651331483713, 34.56952541846913, 24.659465828893463, 4.703136709205097, 20.186517134243132, 8.474937394744899, 19.52125810905096, 46.83121425791303, -18.638488120558947, -12.200997574798397, 14.865558943941547, -1.490166072635784, 10.543533879028821, -15.091771707253008, 29.04292039378062, 54.711090891365345, 20.477155295981337, -18.2640469501178, 24.39771661861558, 15.471831221086656, 1.1721735506104114, 9.79047040093877, 16.29702155483916, 4.425898297092846, 28.756793027444186, -2.46125689544926, 12.228830107245528, -4.972929248954781, -21.76324679411276, 12.33429884914489, 27.268476245009317, 24.69381254466673, 17.680144252338437, 3.220879657478557, 3.7982117702917613, 25.726267440533547, -3.410121101159156, 18.557868333607555, 14.413365228308539, -12.660678666474123, 3.9974438620459196, -5.585110762570528, -13.817549506453975, 44.61687128400108, 33.28204432333538, 41.256746613438786, -1.6420894461245013, -10.311304079004646, 24.612552464440107, 30.018375375474335, -2.264724644638889, 29.209499875285793, 25.039367210429496, -13.244540024741859, 29.099075573834874, -27.652279218138133, 35.47287890561569, 13.133895328849288, -12.744966686057879, 25.8435737189195, 16.963763673623475, 9.942414383216082, -3.048017047371971, 18.206372039188036, -9.687982455717375, 46.237355565506235, 48.48493979103573, 4.509263366398137, 2.9506688968386214, 32.679254719045666, 32.08788144053744, 14.02368813544328, 11.8011113750469, 40.71944476180657, 3.0281677815310815, 4.6575835995066015, 4.92076691417946, -22.533505299020398, 32.30978252996661, 20.466062512881116, 12.167648373639551, 22.23665115569335, 40.23719274766328, 13.207327892425988, 29.479518103286757, -5.605819512718966, 5.167219234926851, 20.657298006750693, 15.707805707498384, 45.985550312020166, -4.8448838679111645, 9.21408549746058, 14.785765502869907, 14.319477812911444, 8.495859055593803, 16.467736267586158, 4.460553078179252, -13.29606135075986, 32.5883078698724, -17.251942867889582, 22.993368289712798, 6.122722533273327, 4.245792120250385, 4.696100390685878, 8.951052252514392, 7.022304958745583, 2.7061102831130697, 9.585529734514553, 14.717087371592047, -1.0745298530081326, 2.0950332404774934, 13.076864882229604, 15.008330220492462, 27.028788962899903, 17.96774690855117, 6.336817472110543, 8.612138427311375, 5.951532103310313, 11.425244891614497, 22.04786116790169, 23.019433694324068, 32.435138778969424, 29.098746455066234, 12.265220472594137, 9.19196052371489, 27.51928171833179, 25.937618835510026, -0.1451614948229576, 11.540928169889007, 6.9719590028155105, 37.208375126198604, -11.630159593078762, 27.265901136895316, 4.50673906173585, 17.395255432040944, -26.667512096136445, 34.01423596601077, -3.5085389368111777, -4.602527566573025, 30.274724650952773, -13.028221364965976, 23.029082984695627, 49.74522953437649, -7.949680196023472, 11.82855537211682, 26.8381203594678, 13.959935566731918, 19.431591614557266, 6.559392903981877, -9.545168657040644, 38.16612824450324, -18.350695368178673, -4.0414716375252535, 32.4002452067362, 30.58605565761517, 4.950627263433304, 20.02165297239904, 32.158868630034334, 14.324295521253795, -14.954594509606267, 47.818121414815515, 19.34316005853477, -6.0346242465867235, 39.667151604383754, 24.746306923657563, 2.9420668920536137, -21.007304611475718]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38430273906507834, "mean_inference_ms": 0.9530414283651503, "mean_action_processing_ms": 0.16343152388313112, "mean_env_wait_ms": 0.056517085385400796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003444194793701172, "StateBufferConnector_ms": 0.002432703971862793, "ViewRequirementAgentConnector_ms": 0.0668644905090332}, "num_episodes": 39, "episode_return_max": 189.44459071308398, "episode_return_min": -53.47235208613502, "episode_return_mean": 51.23472285894795}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.5389233547812, "num_env_steps_trained_throughput_per_sec": 503.5389233547812, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 1524000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1524000, "timers": {"training_iteration_time_ms": 7974.252, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7974.219, "sample_time_ms": 717.138, "learn_time_ms": 7245.785, "learn_throughput": 552.045, "synch_weights_time_ms": 10.721}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000}, "done": false, "training_iteration": 127, "trial_id": "eaa30_00000", "date": "2024-08-09_17-57-36", "timestamp": 1723240656, "time_this_iter_s": 7.948288679122925, "time_total_s": 1034.6517810821533, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1780f7f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1034.6517810821533, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 21.533333333333335, "ram_util_percent": 80.51666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.275969117028373, "cur_kl_coeff": 0.021381537616252895, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.320662965471782, "policy_loss": -0.00040488769066219447, "vf_loss": 6.320946674498301, "vf_explained_var": 0.13669173972947257, "kl": 0.005667959909920616, "entropy": 0.47633612720423907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.832323122459154, "cur_kl_coeff": 2.499577799691662, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.3760252594947815, "policy_loss": 0.00048516014503547923, "vf_loss": 7.362302893400193, "vf_explained_var": -0.1173913225531578, "kl": 0.005295772927638609, "entropy": 1.1053205732256175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 122400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 189.44459071308398, "episode_reward_min": -44.78433401140779, "episode_reward_mean": 55.32100241724948, "episode_len_mean": 121.28, "episode_media": {}, "episodes_this_iter": 36, "episodes_timesteps_total": 12128, "policy_reward_min": {"agent_policy": -22.39216700570394, "adversary_policy": -27.652279218138133}, "policy_reward_max": {"agent_policy": 94.72229535654198, "adversary_policy": 49.74522953437649}, "policy_reward_mean": {"agent_policy": 27.66050120862474, "adversary_policy": 13.830250604312369}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.3264696088564, -38.80532053804896, 155.7978312146729, 79.22931433462858, 28.60249677087092, 55.50730146167089, 108.4977341714306, 31.70907109818603, 15.64119937495511, 0.7778572855827974, 85.61467478508595, 13.788794671688223, 17.036779166941297, 189.44459071308398, 14.919864526473518, 129.5342723191662, 51.64959902098036, 87.4952250866753, 19.156701027372122, 19.552554461892434, 65.26742177304135, 124.94768780671328, 85.37369199142555, -0.8772005555842313, 72.73020742849818, 82.28133288821795, 47.99970200066099, 45.6306737370105, 41.85657869153084, 38.58449303822505, 11.482850843646435, 20.737029307047425, 27.29430528640053, 19.45683048371728, 48.605234212213205, 2.0410067749387215, 56.17039020544412, 89.99307174290212, 29.897911798843836, 34.75355398984962, 90.1345897244515, 123.0677704680713, 42.914361992618055, 106.9138011076837, 22.7915333501321, 88.36066825802821, 31.271483087633115, 43.803988987553566, 14.69344773974866, -16.222133006768416, 34.493006571973595, 145.54862503814428, 7.757750352186704, 81.59611185239942, 51.9819690370783, 57.24191917492523, -44.78433401140779, 125.97260172870273, 49.94456047166469, 92.96632830257627, 65.72705381041848, 26.617071623896095, 128.8269170560826, -36.1304754388442, 70.96899551177023, 101.54749131649962, 54.31347322892907, 40.2334630908111, 13.360752670182745, 16.102618418416004, 48.90909270674432, 153.06530109966693, 85.4431656566417, 94.0932558322967, 72.30478365521147, 25.491532696062123, 55.625358119967366, 50.650672564067605, 31.89604041015265, 40.45690461496098, 36.68315525905274, 167.81897677400633, 127.37648318197117, 9.813798236515055, 69.05200284304468, 58.119869504206676, 14.03168264351568, 40.56475743824508, 25.27211727926994, 48.64862057864181, 16.796079297144686, 104.74907386112592, 98.269306258099, 78.57591469141182, 81.07136392798674, 68.03662954125956, 99.64365852751837, 79.60998758813238, 36.16130759830438, -10.196906965027352], "episode_lengths": [200, 200, 138, 176, 200, 200, 112, 107, 123, 200, 200, 200, 83, 183, 200, 104, 96, 57, 200, 79, 200, 94, 39, 200, 200, 148, 124, 151, 86, 145, 85, 86, 37, 200, 40, 5, 51, 157, 200, 17, 80, 71, 121, 70, 200, 155, 79, 96, 109, 200, 65, 130, 186, 87, 74, 66, 200, 138, 80, 72, 156, 89, 100, 200, 200, 200, 200, 125, 67, 26, 107, 171, 127, 200, 53, 79, 54, 68, 79, 85, 85, 126, 86, 54, 44, 155, 200, 19, 140, 200, 43, 119, 55, 46, 200, 103, 200, 93, 54, 118], "policy_agent_policy_reward": [-8.663234804428203, -19.402660269024494, 77.89891560733643, 39.614657167314284, 14.30124838543546, 27.753650730835446, 54.248867085715304, 15.854535549093013, 7.820599687477555, 0.3889286427914058, 42.807337392542976, 6.894397335844111, 8.518389583470649, 94.72229535654198, 7.459932263236759, 64.7671361595831, 25.82479951049018, 43.74761254333765, 9.578350513686061, 9.776277230946219, 32.63371088652067, 62.47384390335664, 42.68684599571275, -0.43860027779211563, 36.36510371424909, 41.14066644410901, 23.999851000330487, 22.81533686850525, 20.928289345765418, 19.29224651911253, 5.741425421823217, 10.368514653523714, 13.647152643200267, 9.728415241858656, 24.302617106106602, 1.0205033874693608, 28.08519510272207, 44.99653587145109, 14.948955899421918, 17.37677699492481, 45.06729486222576, 61.533885234035665, 21.457180996309027, 53.456900553841834, 11.39576667506605, 44.18033412901414, 15.63574154381656, 21.901994493776797, 7.3467238698743405, -8.111066503384201, 17.246503285986794, 72.77431251907211, 3.878875176093352, 40.798055926199716, 25.990984518539143, 28.620959587462604, -22.39216700570394, 62.98630086435137, 24.972280235832343, 46.48316415128812, 32.863526905209255, 13.308535811948047, 64.4134585280413, -18.0652377194221, 35.4844977558851, 50.77374565824981, 27.156736614464528, 20.116731545405546, 6.680376335091374, 8.051309209208002, 24.454546353372166, 76.53265054983346, 42.721582828320855, 47.04662791614841, 36.15239182760572, 12.745766348031061, 27.8126790599837, 25.325336282033806, 15.948020205076322, 20.2284523074805, 18.341577629526366, 83.90948838700321, 63.6882415909856, 4.9068991182575274, 34.52600142152234, 29.059934752103324, 7.015841321757847, 20.282378719122548, 12.63605863963497, 24.324310289320906, 8.398039648572345, 52.374536930562975, 49.134653129049475, 39.28795734570592, 40.535681963993355, 34.018314770629786, 49.821829263759184, 39.804993794066185, 18.08065379915219, -5.098453482513683], "policy_adversary_policy_reward": [-12.660678666474123, 3.9974438620459196, -5.585110762570528, -13.817549506453975, 44.61687128400108, 33.28204432333538, 41.256746613438786, -1.6420894461245013, -10.311304079004646, 24.612552464440107, 30.018375375474335, -2.264724644638889, 29.209499875285793, 25.039367210429496, -13.244540024741859, 29.099075573834874, -27.652279218138133, 35.47287890561569, 13.133895328849288, -12.744966686057879, 25.8435737189195, 16.963763673623475, 9.942414383216082, -3.048017047371971, 18.206372039188036, -9.687982455717375, 46.237355565506235, 48.48493979103573, 4.509263366398137, 2.9506688968386214, 32.679254719045666, 32.08788144053744, 14.02368813544328, 11.8011113750469, 40.71944476180657, 3.0281677815310815, 4.6575835995066015, 4.92076691417946, -22.533505299020398, 32.30978252996661, 20.466062512881116, 12.167648373639551, 22.23665115569335, 40.23719274766328, 13.207327892425988, 29.479518103286757, -5.605819512718966, 5.167219234926851, 20.657298006750693, 15.707805707498384, 45.985550312020166, -4.8448838679111645, 9.21408549746058, 14.785765502869907, 14.319477812911444, 8.495859055593803, 16.467736267586158, 4.460553078179252, -13.29606135075986, 32.5883078698724, -17.251942867889582, 22.993368289712798, 6.122722533273327, 4.245792120250385, 4.696100390685878, 8.951052252514392, 7.022304958745583, 2.7061102831130697, 9.585529734514553, 14.717087371592047, -1.0745298530081326, 2.0950332404774934, 13.076864882229604, 15.008330220492462, 27.028788962899903, 17.96774690855117, 6.336817472110543, 8.612138427311375, 5.951532103310313, 11.425244891614497, 22.04786116790169, 23.019433694324068, 32.435138778969424, 29.098746455066234, 12.265220472594137, 9.19196052371489, 27.51928171833179, 25.937618835510026, -0.1451614948229576, 11.540928169889007, 6.9719590028155105, 37.208375126198604, -11.630159593078762, 27.265901136895316, 4.50673906173585, 17.395255432040944, -26.667512096136445, 34.01423596601077, -3.5085389368111777, -4.602527566573025, 30.274724650952773, -13.028221364965976, 23.029082984695627, 49.74522953437649, -7.949680196023472, 11.82855537211682, 26.8381203594678, 13.959935566731918, 19.431591614557266, 6.559392903981877, -9.545168657040644, 38.16612824450324, -18.350695368178673, -4.0414716375252535, 32.4002452067362, 30.58605565761517, 4.950627263433304, 20.02165297239904, 32.158868630034334, 14.324295521253795, -14.954594509606267, 47.818121414815515, 19.34316005853477, -6.0346242465867235, 39.667151604383754, 24.746306923657563, 2.9420668920536137, -21.007304611475718, 23.712864594471217, 11.771633161413895, 25.835508889947633, 24.93823676830218, 11.511977796767482, 15.644758817697046, -7.918885464863269, 28.035617010268812, 1.767794401409148, 4.912581933682225, 12.050797211593922, -3.9994880023859203, -3.5417831653323653, 27.99632951870453, 30.912353667099552, 45.62029688273391, 16.901665895949215, 25.819916932371644, 23.093524080294245, 23.953103835854158, 9.752402726423961, 26.39998910118176, 8.443982249343915, 4.301784098687147, -4.290468406252021, 32.10314746623572, 14.698212014260687, 10.627124267773116, 26.800660370081815, -10.85264016500549, -13.128686489158746, 33.35713879663924, 23.650918342168403, -5.309340712642033, 36.78232702856385, 47.127161358439324, 31.124110349930593, 32.564131241054994, -9.648226674852069, 14.555125793109596, 27.80646223629144, 6.7195391852309, -3.6007791889545615, 32.660713941057885, 16.73667026084851, -9.720828939090666, 10.477508688343695, 9.804870030778847, -6.23281474244116, 18.868873382076128, 6.28930055887804, 18.035009730442866, 6.3995771385553795, 1.9984625100169646, 24.841238192835227, 27.533298737727737, 30.839191700915386, 18.29546142813411, 12.181501492840955, 27.106455852864965, 15.649639992248796, 24.886041971744568, 7.308357704749632, 26.709957065880143, 5.436016581532851, 44.38581268222634, 2.3908404266018906, 37.4141533674643, -2.3883270259171425, 20.468980825069334, -7.687873136228781, 2.5894196537150993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3842616602145485, "mean_inference_ms": 0.9520769203908156, "mean_action_processing_ms": 0.16334480648477318, "mean_env_wait_ms": 0.056537131931842045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003390789031982422, "StateBufferConnector_ms": 0.0023995637893676758, "ViewRequirementAgentConnector_ms": 0.06618678569793701}, "num_episodes": 36, "episode_return_max": 189.44459071308398, "episode_return_min": -44.78433401140779, "episode_return_mean": 55.32100241724948}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 449.7416491728434, "num_env_steps_trained_throughput_per_sec": 449.7416491728434, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 8076.989, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8076.956, "sample_time_ms": 716.342, "learn_time_ms": 7349.263, "learn_throughput": 544.272, "synch_weights_time_ms": 10.8}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 128, "trial_id": "eaa30_00000", "date": "2024-08-09_17-57-45", "timestamp": 1723240665, "time_this_iter_s": 8.920153856277466, "time_total_s": 1043.5719349384308, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2839310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1043.5719349384308, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 33.138461538461534, "ram_util_percent": 83.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.296725104347107, "cur_kl_coeff": 0.021381537616252895, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.723845778066646, "policy_loss": 0.0007703218460033732, "vf_loss": 6.722819591703869, "vf_explained_var": 0.12112498169853574, "kl": 0.0119664842908384, "entropy": 0.5213849499742821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.314477271710834, "cur_kl_coeff": 2.499577799691662, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.173350323239962, "policy_loss": -0.0007534982190312197, "vf_loss": 8.162179232140382, "vf_explained_var": 0.023885252016286055, "kl": 0.004770629962877138, "entropy": 1.0324965299417574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 123360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000}, "env_runners": {"episode_reward_max": 180.80825107367224, "episode_reward_min": -44.78433401140779, "episode_reward_mean": 64.65969290404169, "episode_len_mean": 110.74, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 11074, "policy_reward_min": {"agent_policy": -22.39216700570394, "adversary_policy": -26.667512096136445}, "policy_reward_max": {"agent_policy": 90.40412553683613, "adversary_policy": 50.866852231272404}, "policy_reward_mean": {"agent_policy": 32.32984645202085, "adversary_policy": 16.164923226010423}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.1345897244515, 123.0677704680713, 42.914361992618055, 106.9138011076837, 22.7915333501321, 88.36066825802821, 31.271483087633115, 43.803988987553566, 14.69344773974866, -16.222133006768416, 34.493006571973595, 145.54862503814428, 7.757750352186704, 81.59611185239942, 51.9819690370783, 57.24191917492523, -44.78433401140779, 125.97260172870273, 49.94456047166469, 92.96632830257627, 65.72705381041848, 26.617071623896095, 128.8269170560826, -36.1304754388442, 70.96899551177023, 101.54749131649962, 54.31347322892907, 40.2334630908111, 13.360752670182745, 16.102618418416004, 48.90909270674432, 153.06530109966693, 85.4431656566417, 94.0932558322967, 72.30478365521147, 25.491532696062123, 55.625358119967366, 50.650672564067605, 31.89604041015265, 40.45690461496098, 36.68315525905274, 167.81897677400633, 127.37648318197117, 9.813798236515055, 69.05200284304468, 58.119869504206676, 14.03168264351568, 40.56475743824508, 25.27211727926994, 48.64862057864181, 16.796079297144686, 104.74907386112592, 98.269306258099, 78.57591469141182, 81.07136392798674, 68.03662954125956, 99.64365852751837, 79.60998758813238, 36.16130759830438, -10.196906965027352, 55.28437498095847, 51.694285184587564, 41.628985765404124, 73.48824952973384, 61.789210001292275, 14.538208457628347, 42.72421635714994, 93.65382892726657, 12.119435882731112, 63.526904437820534, 94.55510479439882, 55.128175306661845, 128.9728705371961, 68.55350222843902, 41.21684014502726, 38.27357125023274, 131.7208583217617, 101.83412213735699, 130.42284134606587, 145.07676082037833, 74.15404526209741, 92.28036439228279, 180.80825107367224, 168.0684784949306, 55.48190090529866, 40.50573752361159, 65.01005031695122, 57.04094457043367, 42.99075938492601, 42.73602571815434, 53.71655953825873, 70.71326833585309, 49.252847628865794, 5.44821053518398, 113.20921127853065, 114.05894841766484, 37.66332242422905, 67.03693100684598, 84.91874281688732, 64.62294743164733], "episode_lengths": [80, 71, 121, 70, 200, 155, 79, 96, 109, 200, 65, 130, 186, 87, 74, 66, 200, 138, 80, 72, 156, 89, 100, 200, 200, 200, 200, 125, 67, 26, 107, 171, 127, 200, 53, 79, 54, 68, 79, 85, 85, 126, 86, 54, 44, 155, 200, 19, 140, 200, 43, 119, 55, 46, 200, 103, 200, 93, 54, 118, 118, 42, 195, 61, 62, 65, 200, 68, 147, 98, 105, 129, 85, 70, 200, 53, 143, 117, 69, 200, 64, 71, 107, 114, 75, 87, 160, 97, 131, 41, 68, 81, 93, 126, 200, 125, 66, 61, 126, 149], "policy_agent_policy_reward": [45.06729486222576, 61.533885234035665, 21.457180996309027, 53.456900553841834, 11.39576667506605, 44.18033412901414, 15.63574154381656, 21.901994493776797, 7.3467238698743405, -8.111066503384201, 17.246503285986794, 72.77431251907211, 3.878875176093352, 40.798055926199716, 25.990984518539143, 28.620959587462604, -22.39216700570394, 62.98630086435137, 24.972280235832343, 46.48316415128812, 32.863526905209255, 13.308535811948047, 64.4134585280413, -18.0652377194221, 35.4844977558851, 50.77374565824981, 27.156736614464528, 20.116731545405546, 6.680376335091374, 8.051309209208002, 24.454546353372166, 76.53265054983346, 42.721582828320855, 47.04662791614841, 36.15239182760572, 12.745766348031061, 27.8126790599837, 25.325336282033806, 15.948020205076322, 20.2284523074805, 18.341577629526366, 83.90948838700321, 63.6882415909856, 4.9068991182575274, 34.52600142152234, 29.059934752103324, 7.015841321757847, 20.282378719122548, 12.63605863963497, 24.324310289320906, 8.398039648572345, 52.374536930562975, 49.134653129049475, 39.28795734570592, 40.535681963993355, 34.018314770629786, 49.821829263759184, 39.804993794066185, 18.08065379915219, -5.098453482513683, 27.642187490479234, 25.847142592293782, 20.814492882702062, 36.744124764866875, 30.894605000646152, 7.269104228814172, 21.362108178574985, 46.8269144636333, 6.059717941365557, 31.76345221891028, 47.27755239719943, 27.56408765333092, 64.48643526859806, 34.27675111421949, 20.608420072513635, 19.136785625116374, 65.86042916088087, 50.917061068678485, 65.2114206730329, 72.53838041018915, 37.077022631048706, 46.1401821961414, 90.40412553683613, 84.0342392474653, 27.740950452649326, 20.2528687618058, 32.50502515847561, 28.520472285216833, 21.495379692462997, 21.36801285907717, 26.85827976912938, 35.356634167926565, 24.6264238144329, 2.72410526759199, 56.604605639265344, 57.029474208832426, 18.831661212114525, 33.518465503423, 42.45937140844366, 32.31147371582367], "policy_adversary_policy_reward": [22.04786116790169, 23.019433694324068, 32.435138778969424, 29.098746455066234, 12.265220472594137, 9.19196052371489, 27.51928171833179, 25.937618835510026, -0.1451614948229576, 11.540928169889007, 6.9719590028155105, 37.208375126198604, -11.630159593078762, 27.265901136895316, 4.50673906173585, 17.395255432040944, -26.667512096136445, 34.01423596601077, -3.5085389368111777, -4.602527566573025, 30.274724650952773, -13.028221364965976, 23.029082984695627, 49.74522953437649, -7.949680196023472, 11.82855537211682, 26.8381203594678, 13.959935566731918, 19.431591614557266, 6.559392903981877, -9.545168657040644, 38.16612824450324, -18.350695368178673, -4.0414716375252535, 32.4002452067362, 30.58605565761517, 4.950627263433304, 20.02165297239904, 32.158868630034334, 14.324295521253795, -14.954594509606267, 47.818121414815515, 19.34316005853477, -6.0346242465867235, 39.667151604383754, 24.746306923657563, 2.9420668920536137, -21.007304611475718, 23.712864594471217, 11.771633161413895, 25.835508889947633, 24.93823676830218, 11.511977796767482, 15.644758817697046, -7.918885464863269, 28.035617010268812, 1.767794401409148, 4.912581933682225, 12.050797211593922, -3.9994880023859203, -3.5417831653323653, 27.99632951870453, 30.912353667099552, 45.62029688273391, 16.901665895949215, 25.819916932371644, 23.093524080294245, 23.953103835854158, 9.752402726423961, 26.39998910118176, 8.443982249343915, 4.301784098687147, -4.290468406252021, 32.10314746623572, 14.698212014260687, 10.627124267773116, 26.800660370081815, -10.85264016500549, -13.128686489158746, 33.35713879663924, 23.650918342168403, -5.309340712642033, 36.78232702856385, 47.127161358439324, 31.124110349930593, 32.564131241054994, -9.648226674852069, 14.555125793109596, 27.80646223629144, 6.7195391852309, -3.6007791889545615, 32.660713941057885, 16.73667026084851, -9.720828939090666, 10.477508688343695, 9.804870030778847, -6.23281474244116, 18.868873382076128, 6.28930055887804, 18.035009730442866, 6.3995771385553795, 1.9984625100169646, 24.841238192835227, 27.533298737727737, 30.839191700915386, 18.29546142813411, 12.181501492840955, 27.106455852864965, 15.649639992248796, 24.886041971744568, 7.308357704749632, 26.709957065880143, 5.436016581532851, 44.38581268222634, 2.3908404266018906, 37.4141533674643, -2.3883270259171425, 20.468980825069334, -7.687873136228781, 2.5894196537150993, 9.321609722209146, 18.320577768270088, 16.462538453105203, 9.384604139188578, 2.670330353990906, 18.144162528711156, 29.027530716734386, 7.716594048132492, 11.018492737171648, 19.876112263474504, -4.972876290489973, 12.241980519304144, 9.07022284625743, 12.291885332317555, 18.10017021475752, 28.726744248875796, -5.539713431639143, 11.5994313730047, -4.48378166820563, 36.247233887115904, 33.98557097736548, 13.291981419833935, 20.29320932193585, 7.270878331395071, 38.581262765790875, 25.905172502807172, 25.160035121854264, 9.116715992365219, 0.7636722753993404, 19.844747797114294, 22.05972345398821, -2.922937828871836, 31.77962362940052, 34.080805531480344, 28.96473879017875, 21.952322278499736, 23.030998824743506, 42.1804218482894, 30.64109860955569, 41.897281800633465, 13.92693143340945, 23.150091197639256, 18.64164956580616, 27.498532630335234, 46.22090357414549, 44.183221962690666, 33.16738701619291, 50.866852231272404, 9.749192624873654, 17.991757827775672, -7.407776807696671, 27.660645569502464, 41.6425484642628, -9.137523305787184, 17.200711891234107, 11.319760393982726, -14.184016421391282, 35.679396113854274, 1.0817800190821636, 20.286232839995005, 13.671486765889878, 13.186793003239497, 29.95844438623019, 5.398189781696374, 12.880743699817405, 11.745680114615496, 19.017782388263207, -16.293677120671216, 23.325875967748743, 33.27872967151659, 18.755461176242214, 38.274013032590204, 6.636231502463222, 12.195429709651306, 19.71497099195014, 13.803494511472856, 20.865150834096937, 21.594220574346707, 38.911131087941314, -6.599657372117651]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3839134006309664, "mean_inference_ms": 0.953205889922869, "mean_action_processing_ms": 0.1631166896739498, "mean_env_wait_ms": 0.05649322091545612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003493785858154297, "StateBufferConnector_ms": 0.0023581981658935547, "ViewRequirementAgentConnector_ms": 0.0665121078491211}, "num_episodes": 40, "episode_return_max": 180.80825107367224, "episode_return_min": -44.78433401140779, "episode_return_mean": 64.65969290404169}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 438.08696879211703, "num_env_steps_trained_throughput_per_sec": 438.08696879211703, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 1548000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1548000, "timers": {"training_iteration_time_ms": 8198.01, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8197.976, "sample_time_ms": 722.581, "learn_time_ms": 7463.276, "learn_throughput": 535.958, "synch_weights_time_ms": 11.385}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000}, "done": false, "training_iteration": 129, "trial_id": "eaa30_00000", "date": "2024-08-09_17-57-54", "timestamp": 1723240674, "time_this_iter_s": 9.145175218582153, "time_total_s": 1052.717110157013, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2839670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1052.717110157013, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 42.21538461538462, "ram_util_percent": 83.17692307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.43365449211585, "cur_kl_coeff": 0.021381537616252895, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.4991205482886585, "policy_loss": -0.0003544728978778477, "vf_loss": 6.498865757543574, "vf_explained_var": 0.07036198380762938, "kl": 0.02849613546379029, "entropy": 0.5938793102900187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.051238014300665, "cur_kl_coeff": 1.249788899845831, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.008513602117697, "policy_loss": -0.002216316589571458, "vf_loss": 8.006250369548798, "vf_explained_var": -0.14667666995277007, "kl": 0.0035842127836076543, "entropy": 0.9965559927125772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 124320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 180.80825107367224, "episode_reward_min": -10.196906965027352, "episode_reward_mean": 68.86469186462632, "episode_len_mean": 97.93, "episode_media": {}, "episodes_this_iter": 38, "episodes_timesteps_total": 9793, "policy_reward_min": {"agent_policy": -5.098453482513683, "adversary_policy": -16.293677120671216}, "policy_reward_max": {"agent_policy": 90.40412553683613, "adversary_policy": 50.866852231272404}, "policy_reward_mean": {"agent_policy": 34.43234593231317, "adversary_policy": 17.21617296615658}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.89604041015265, 40.45690461496098, 36.68315525905274, 167.81897677400633, 127.37648318197117, 9.813798236515055, 69.05200284304468, 58.119869504206676, 14.03168264351568, 40.56475743824508, 25.27211727926994, 48.64862057864181, 16.796079297144686, 104.74907386112592, 98.269306258099, 78.57591469141182, 81.07136392798674, 68.03662954125956, 99.64365852751837, 79.60998758813238, 36.16130759830438, -10.196906965027352, 55.28437498095847, 51.694285184587564, 41.628985765404124, 73.48824952973384, 61.789210001292275, 14.538208457628347, 42.72421635714994, 93.65382892726657, 12.119435882731112, 63.526904437820534, 94.55510479439882, 55.128175306661845, 128.9728705371961, 68.55350222843902, 41.21684014502726, 38.27357125023274, 131.7208583217617, 101.83412213735699, 130.42284134606587, 145.07676082037833, 74.15404526209741, 92.28036439228279, 180.80825107367224, 168.0684784949306, 55.48190090529866, 40.50573752361159, 65.01005031695122, 57.04094457043367, 42.99075938492601, 42.73602571815434, 53.71655953825873, 70.71326833585309, 49.252847628865794, 5.44821053518398, 113.20921127853065, 114.05894841766484, 37.66332242422905, 67.03693100684598, 84.91874281688732, 64.62294743164733, 44.80131976775914, 77.23148038718163, 88.33930924009891, 61.32122795054707, 37.79168972288793, 92.45496366948495, 56.136036680513186, 31.960117974164508, 59.538775281081946, 56.54282444390808, 96.24478321889949, 23.728533480062737, 101.1847975853169, 102.32076987563077, 43.62583172143006, 86.62390593912318, 16.430167355410354, 25.174739875297167, 58.19745861867138, 74.9452082262104, 66.55006316089205, 5.894015191112102, 88.88387965153504, 68.20314801309212, 74.1026878533869, 147.8662032878293, 36.85280069769872, 74.55928603689645, 74.63137719522308, 60.509078770860015, 82.02261194478807, 75.68973162384539, 70.37091183561914, 70.62785535467641, 65.82946947798331, 72.15552485513192, 134.91154560361036, 133.8443383368179], "episode_lengths": [79, 85, 85, 126, 86, 54, 44, 155, 200, 19, 140, 200, 43, 119, 55, 46, 200, 103, 200, 93, 54, 118, 118, 42, 195, 61, 62, 65, 200, 68, 147, 98, 105, 129, 85, 70, 200, 53, 143, 117, 69, 200, 64, 71, 107, 114, 75, 87, 160, 97, 131, 41, 68, 81, 93, 126, 200, 125, 66, 61, 126, 149, 58, 102, 43, 186, 57, 71, 28, 52, 102, 48, 84, 22, 52, 70, 46, 149, 9, 54, 104, 81, 55, 98, 47, 47, 78, 200, 87, 85, 125, 70, 101, 38, 168, 192, 39, 44, 200, 128], "policy_agent_policy_reward": [15.948020205076322, 20.2284523074805, 18.341577629526366, 83.90948838700321, 63.6882415909856, 4.9068991182575274, 34.52600142152234, 29.059934752103324, 7.015841321757847, 20.282378719122548, 12.63605863963497, 24.324310289320906, 8.398039648572345, 52.374536930562975, 49.134653129049475, 39.28795734570592, 40.535681963993355, 34.018314770629786, 49.821829263759184, 39.804993794066185, 18.08065379915219, -5.098453482513683, 27.642187490479234, 25.847142592293782, 20.814492882702062, 36.744124764866875, 30.894605000646152, 7.269104228814172, 21.362108178574985, 46.8269144636333, 6.059717941365557, 31.76345221891028, 47.27755239719943, 27.56408765333092, 64.48643526859806, 34.27675111421949, 20.608420072513635, 19.136785625116374, 65.86042916088087, 50.917061068678485, 65.2114206730329, 72.53838041018915, 37.077022631048706, 46.1401821961414, 90.40412553683613, 84.0342392474653, 27.740950452649326, 20.2528687618058, 32.50502515847561, 28.520472285216833, 21.495379692462997, 21.36801285907717, 26.85827976912938, 35.356634167926565, 24.6264238144329, 2.72410526759199, 56.604605639265344, 57.029474208832426, 18.831661212114525, 33.518465503423, 42.45937140844366, 32.31147371582367, 22.400659883879573, 38.61574019359081, 44.169654620049485, 30.660613975273538, 18.895844861443965, 46.227481834742484, 28.068018340256586, 15.98005898708226, 29.769387640540984, 28.271412221954044, 48.12239160944972, 11.864266740031365, 50.592398792658486, 51.160384937815394, 21.812915860715027, 43.31195296956161, 8.215083677705175, 12.587369937648585, 29.09872930933566, 37.47260411310522, 33.275031580446026, 2.9470075955560553, 44.441939825767534, 34.10157400654606, 37.051343926693455, 73.93310164391468, 18.426400348849363, 37.27964301844823, 37.31568859761152, 30.254539385430007, 41.01130597239403, 37.84486581192269, 35.18545591780958, 35.31392767733821, 32.914734738991655, 36.07776242756597, 67.4557728018052, 66.92216916840893], "policy_adversary_policy_reward": [26.800660370081815, -10.85264016500549, -13.128686489158746, 33.35713879663924, 23.650918342168403, -5.309340712642033, 36.78232702856385, 47.127161358439324, 31.124110349930593, 32.564131241054994, -9.648226674852069, 14.555125793109596, 27.80646223629144, 6.7195391852309, -3.6007791889545615, 32.660713941057885, 16.73667026084851, -9.720828939090666, 10.477508688343695, 9.804870030778847, -6.23281474244116, 18.868873382076128, 6.28930055887804, 18.035009730442866, 6.3995771385553795, 1.9984625100169646, 24.841238192835227, 27.533298737727737, 30.839191700915386, 18.29546142813411, 12.181501492840955, 27.106455852864965, 15.649639992248796, 24.886041971744568, 7.308357704749632, 26.709957065880143, 5.436016581532851, 44.38581268222634, 2.3908404266018906, 37.4141533674643, -2.3883270259171425, 20.468980825069334, -7.687873136228781, 2.5894196537150993, 9.321609722209146, 18.320577768270088, 16.462538453105203, 9.384604139188578, 2.670330353990906, 18.144162528711156, 29.027530716734386, 7.716594048132492, 11.018492737171648, 19.876112263474504, -4.972876290489973, 12.241980519304144, 9.07022284625743, 12.291885332317555, 18.10017021475752, 28.726744248875796, -5.539713431639143, 11.5994313730047, -4.48378166820563, 36.247233887115904, 33.98557097736548, 13.291981419833935, 20.29320932193585, 7.270878331395071, 38.581262765790875, 25.905172502807172, 25.160035121854264, 9.116715992365219, 0.7636722753993404, 19.844747797114294, 22.05972345398821, -2.922937828871836, 31.77962362940052, 34.080805531480344, 28.96473879017875, 21.952322278499736, 23.030998824743506, 42.1804218482894, 30.64109860955569, 41.897281800633465, 13.92693143340945, 23.150091197639256, 18.64164956580616, 27.498532630335234, 46.22090357414549, 44.183221962690666, 33.16738701619291, 50.866852231272404, 9.749192624873654, 17.991757827775672, -7.407776807696671, 27.660645569502464, 41.6425484642628, -9.137523305787184, 17.200711891234107, 11.319760393982726, -14.184016421391282, 35.679396113854274, 1.0817800190821636, 20.286232839995005, 13.671486765889878, 13.186793003239497, 29.95844438623019, 5.398189781696374, 12.880743699817405, 11.745680114615496, 19.017782388263207, -16.293677120671216, 23.325875967748743, 33.27872967151659, 18.755461176242214, 38.274013032590204, 6.636231502463222, 12.195429709651306, 19.71497099195014, 13.803494511472856, 20.865150834096937, 21.594220574346707, 38.911131087941314, -6.599657372117651, 7.72439489641905, 14.67626498746052, 27.98421791804849, 10.631522275542327, 22.23909253096791, 21.93056208908157, 19.313147265138802, 11.347466710134736, 18.056042901094052, 0.839801960349913, 19.405957346506963, 26.821524488235518, 18.228923117879525, 9.839095222377065, 6.5006345718305205, 9.479424415251735, 15.400952949396157, 14.368434691144827, 25.847777732497253, 2.423634489456804, 14.196024541907056, 33.926367067542664, 7.1170184626704724, 4.747248277360892, 20.18631065514645, 30.40608813751203, 30.978802126446, 20.18158281136939, 11.715135095468993, 10.097780765246036, 21.324500692604126, 21.98745227695747, 1.5297353731541055, 6.68534830455107, 16.169503829681588, -3.5821338920330064, 23.10455836061098, 5.99417094872468, 40.44187141029532, -2.969267297190104, 15.582281132055968, 17.69275044839006, -8.285924788229064, 11.23293238378512, 27.453177056846243, 16.988762768921294, 15.603091295797213, 18.498482710748846, 18.5721341539698, 18.479209772723646, 31.43361618033302, 42.49948546358166, 21.33529320968302, -2.9088928608336566, 14.050963887550747, 23.228679130897476, 34.95493450981217, 2.3607540877993607, 22.63281331564209, 7.621726069787917, 22.90526573043451, 18.106040241959512, 15.233746661050489, 22.611119150872213, 24.447691519815017, 10.737764397994564, 23.97202799889041, 11.341899678447795, 23.36754114198158, 9.547193597010075, 26.0252582025722, 10.05250422499377, 33.27082598095847, 34.184946820846726, 25.665944405693132, 41.2562247627158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3844264151399248, "mean_inference_ms": 0.952308462295073, "mean_action_processing_ms": 0.16327695086156233, "mean_env_wait_ms": 0.0565411384648043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003679037094116211, "StateBufferConnector_ms": 0.0024775266647338867, "ViewRequirementAgentConnector_ms": 0.06739914417266846}, "num_episodes": 38, "episode_return_max": 180.80825107367224, "episode_return_min": -10.196906965027352, "episode_return_mean": 68.86469186462632}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 449.65904399381503, "num_env_steps_trained_throughput_per_sec": 449.65904399381503, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 8292.411, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8292.377, "sample_time_ms": 734.803, "learn_time_ms": 7545.401, "learn_throughput": 530.124, "synch_weights_time_ms": 11.434}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 130, "trial_id": "eaa30_00000", "date": "2024-08-09_17-58-03", "timestamp": 1723240683, "time_this_iter_s": 8.90065312385559, "time_total_s": 1061.6177632808685, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2839700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1061.6177632808685, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 43.55384615384616, "ram_util_percent": 81.3153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.398775658027205, "cur_kl_coeff": 0.03207230642437935, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.194840260914394, "policy_loss": 0.0019138686960099866, "vf_loss": 7.191928027168153, "vf_explained_var": -0.004993447393336624, "kl": 0.031128475595285338, "entropy": 0.6741968059035205, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.008674817656477, "cur_kl_coeff": 0.6248944499229155, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.274619767069817, "policy_loss": 0.0037734520097728818, "vf_loss": 8.268775622049967, "vf_explained_var": -0.028451656239728132, "kl": 0.0033136287282104606, "entropy": 0.9594213144232829, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 125280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000}, "env_runners": {"episode_reward_max": 180.80825107367224, "episode_reward_min": 0.5282349292293085, "episode_reward_mean": 76.78638356316168, "episode_len_mean": 97.1, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 9710, "policy_reward_min": {"agent_policy": 0.26411746461465246, "adversary_policy": -16.293677120671216}, "policy_reward_max": {"agent_policy": 90.40412553683613, "adversary_policy": 51.95102961552389}, "policy_reward_mean": {"agent_policy": 38.39319178158084, "adversary_policy": 19.196595890790412}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.15404526209741, 92.28036439228279, 180.80825107367224, 168.0684784949306, 55.48190090529866, 40.50573752361159, 65.01005031695122, 57.04094457043367, 42.99075938492601, 42.73602571815434, 53.71655953825873, 70.71326833585309, 49.252847628865794, 5.44821053518398, 113.20921127853065, 114.05894841766484, 37.66332242422905, 67.03693100684598, 84.91874281688732, 64.62294743164733, 44.80131976775914, 77.23148038718163, 88.33930924009891, 61.32122795054707, 37.79168972288793, 92.45496366948495, 56.136036680513186, 31.960117974164508, 59.538775281081946, 56.54282444390808, 96.24478321889949, 23.728533480062737, 101.1847975853169, 102.32076987563077, 43.62583172143006, 86.62390593912318, 16.430167355410354, 25.174739875297167, 58.19745861867138, 74.9452082262104, 66.55006316089205, 5.894015191112102, 88.88387965153504, 68.20314801309212, 74.1026878533869, 147.8662032878293, 36.85280069769872, 74.55928603689645, 74.63137719522308, 60.509078770860015, 82.02261194478807, 75.68973162384539, 70.37091183561914, 70.62785535467641, 65.82946947798331, 72.15552485513192, 134.91154560361036, 133.8443383368179, 87.58350663159592, 122.14762845501345, 48.5140766929648, 129.09455427657926, 77.55470086827845, 97.51629842435756, 104.91269270644955, 34.139256453564094, 81.01050661351768, 160.19824407310142, 47.525008255840184, 138.63876021280925, 25.457442795320283, 54.12582247841865, 0.5282349292293085, 55.51071468033274, 127.82489367131632, 39.394057161229014, 63.82774364555389, 65.627558789203, 66.92598029733378, 148.52484017754094, 44.096033148257455, 57.8473062956864, 63.033299185550675, 116.51852939402892, 78.78780201542041, 161.50062505825568, 46.60567631188835, 95.92128931342506, 110.65422775126365, 104.31585967078037, 100.73635281035976, 39.67754053458761, 118.62746679538728, 102.24528434583635, 98.58332833925724, 87.90841628655653, 53.08849084599253, 97.89558826803272, 72.00206114775, 134.19463954729562], "episode_lengths": [64, 71, 107, 114, 75, 87, 160, 97, 131, 41, 68, 81, 93, 126, 200, 125, 66, 61, 126, 149, 58, 102, 43, 186, 57, 71, 28, 52, 102, 48, 84, 22, 52, 70, 46, 149, 9, 54, 104, 81, 55, 98, 47, 47, 78, 200, 87, 85, 125, 70, 101, 38, 168, 192, 39, 44, 200, 128, 123, 123, 83, 141, 111, 82, 73, 47, 157, 125, 97, 160, 35, 200, 37, 103, 87, 59, 200, 47, 74, 147, 44, 57, 90, 112, 83, 155, 79, 158, 109, 56, 110, 120, 173, 50, 165, 61, 200, 80, 90, 145], "policy_agent_policy_reward": [37.077022631048706, 46.1401821961414, 90.40412553683613, 84.0342392474653, 27.740950452649326, 20.2528687618058, 32.50502515847561, 28.520472285216833, 21.495379692462997, 21.36801285907717, 26.85827976912938, 35.356634167926565, 24.6264238144329, 2.72410526759199, 56.604605639265344, 57.029474208832426, 18.831661212114525, 33.518465503423, 42.45937140844366, 32.31147371582367, 22.400659883879573, 38.61574019359081, 44.169654620049485, 30.660613975273538, 18.895844861443965, 46.227481834742484, 28.068018340256586, 15.98005898708226, 29.769387640540984, 28.271412221954044, 48.12239160944972, 11.864266740031365, 50.592398792658486, 51.160384937815394, 21.812915860715027, 43.31195296956161, 8.215083677705175, 12.587369937648585, 29.09872930933566, 37.47260411310522, 33.275031580446026, 2.9470075955560553, 44.441939825767534, 34.10157400654606, 37.051343926693455, 73.93310164391468, 18.426400348849363, 37.27964301844823, 37.31568859761152, 30.254539385430007, 41.01130597239403, 37.84486581192269, 35.18545591780958, 35.31392767733821, 32.914734738991655, 36.07776242756597, 67.4557728018052, 66.92216916840893, 43.79175331579795, 61.07381422750669, 24.257038346482396, 64.54727713828966, 38.77735043413924, 48.75814921217879, 52.45634635322483, 17.069628226782047, 40.50525330675884, 80.09912203655074, 23.76250412792009, 69.31938010640461, 12.728721397660141, 27.062911239209342, 0.26411746461465246, 27.755357340166366, 63.91244683565815, 19.697028580614507, 31.91387182277694, 32.81377939460152, 33.462990148666876, 74.26242008877047, 22.048016574128727, 28.92365314784321, 31.516649592775345, 58.25926469701447, 39.39390100771019, 80.75031252912783, 23.302838155944176, 47.96064465671252, 55.327113875631824, 52.157929835390185, 50.36817640517988, 19.838770267293803, 59.31373339769367, 51.12264217291816, 49.291664169628625, 43.95420814327825, 26.544245422996283, 48.947794134016355, 36.001030573875, 67.0973197736478], "policy_adversary_policy_reward": [13.92693143340945, 23.150091197639256, 18.64164956580616, 27.498532630335234, 46.22090357414549, 44.183221962690666, 33.16738701619291, 50.866852231272404, 9.749192624873654, 17.991757827775672, -7.407776807696671, 27.660645569502464, 41.6425484642628, -9.137523305787184, 17.200711891234107, 11.319760393982726, -14.184016421391282, 35.679396113854274, 1.0817800190821636, 20.286232839995005, 13.671486765889878, 13.186793003239497, 29.95844438623019, 5.398189781696374, 12.880743699817405, 11.745680114615496, 19.017782388263207, -16.293677120671216, 23.325875967748743, 33.27872967151659, 18.755461176242214, 38.274013032590204, 6.636231502463222, 12.195429709651306, 19.71497099195014, 13.803494511472856, 20.865150834096937, 21.594220574346707, 38.911131087941314, -6.599657372117651, 7.72439489641905, 14.67626498746052, 27.98421791804849, 10.631522275542327, 22.23909253096791, 21.93056208908157, 19.313147265138802, 11.347466710134736, 18.056042901094052, 0.839801960349913, 19.405957346506963, 26.821524488235518, 18.228923117879525, 9.839095222377065, 6.5006345718305205, 9.479424415251735, 15.400952949396157, 14.368434691144827, 25.847777732497253, 2.423634489456804, 14.196024541907056, 33.926367067542664, 7.1170184626704724, 4.747248277360892, 20.18631065514645, 30.40608813751203, 30.978802126446, 20.18158281136939, 11.715135095468993, 10.097780765246036, 21.324500692604126, 21.98745227695747, 1.5297353731541055, 6.68534830455107, 16.169503829681588, -3.5821338920330064, 23.10455836061098, 5.99417094872468, 40.44187141029532, -2.969267297190104, 15.582281132055968, 17.69275044839006, -8.285924788229064, 11.23293238378512, 27.453177056846243, 16.988762768921294, 15.603091295797213, 18.498482710748846, 18.5721341539698, 18.479209772723646, 31.43361618033302, 42.49948546358166, 21.33529320968302, -2.9088928608336566, 14.050963887550747, 23.228679130897476, 34.95493450981217, 2.3607540877993607, 22.63281331564209, 7.621726069787917, 22.90526573043451, 18.106040241959512, 15.233746661050489, 22.611119150872213, 24.447691519815017, 10.737764397994564, 23.97202799889041, 11.341899678447795, 23.36754114198158, 9.547193597010075, 26.0252582025722, 10.05250422499377, 33.27082598095847, 34.184946820846726, 25.665944405693132, 41.2562247627158, 17.89150214800635, 25.900251167791595, 27.77424053941877, 33.29957368808793, 17.59471775885214, 6.6623205876302585, 31.536770751933357, 33.01050638635631, -3.7692752058214065, 42.54662563996063, 29.16704155790746, 19.59110765427133, 21.38844624526998, 31.067900107954838, 8.914672930066287, 8.154955296715762, 28.422337774540967, 12.082915532217864, 35.776517771643626, 44.32260426490713, 10.538297485348277, 13.224206642571815, 43.52615700704193, 25.793223099362674, -2.122196434168064, 14.850917831828205, 19.695197582477334, 7.367713656732002, 1.6671549064264017, -1.4030374418117493, -1.6166250061762781, 29.371982346342644, 34.034556542242036, 29.87789029341611, 2.354378715852228, 17.34264986476228, 19.85157061719533, 12.062301205581612, 17.941834730010388, 14.87194466459113, 19.121470432110588, 14.341519716556292, 22.311390473246576, 51.95102961552389, 3.966499534991385, 18.081517039137342, 7.5670251797180565, 21.356627968125153, 30.196947500672664, 1.3197020921026734, 42.496741873203014, 15.762522823811448, 1.0313531621289265, 38.36254784558126, 46.816912044252504, 33.93340048487531, 5.959045379013629, 17.34379277693055, 7.483407247908799, 40.47723740880371, 18.293416686788404, 37.03369718884341, 26.712436828474626, 25.44549300691555, 30.03227178495191, 20.33590462022797, 16.811129673407176, 3.027640593886627, 32.19963038392055, 27.1141030137731, 31.17506102134023, 19.947581151577932, 25.47275011927384, 23.818914050354778, 13.99416864873791, 29.960039494540347, 10.091657621107483, 16.452587801888797, 31.33751789832904, 17.6102762356873, 11.633779162535202, 24.367251411339797, 32.388917604936566, 34.708402168711245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3846240318804057, "mean_inference_ms": 0.9522790712418033, "mean_action_processing_ms": 0.16345382318006826, "mean_env_wait_ms": 0.056577669964952705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041506290435791016, "StateBufferConnector_ms": 0.002688169479370117, "ViewRequirementAgentConnector_ms": 0.07134521007537842}, "num_episodes": 42, "episode_return_max": 180.80825107367224, "episode_return_min": 0.5282349292293085, "episode_return_mean": 76.78638356316168}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.4277458243963, "num_env_steps_trained_throughput_per_sec": 500.4277458243963, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 1572000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1572000, "timers": {"training_iteration_time_ms": 8302.672, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8302.636, "sample_time_ms": 743.112, "learn_time_ms": 7547.429, "learn_throughput": 529.982, "synch_weights_time_ms": 11.409}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000}, "done": false, "training_iteration": 131, "trial_id": "eaa30_00000", "date": "2024-08-09_17-58-11", "timestamp": 1723240691, "time_this_iter_s": 7.99836802482605, "time_total_s": 1069.6161313056946, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1780f7dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1069.6161313056946, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 40.58181818181818, "ram_util_percent": 81.24545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.957015911359635, "cur_kl_coeff": 0.048108459636569026, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.479028469166428, "policy_loss": 0.0007503218536151859, "vf_loss": 7.477158242180234, "vf_explained_var": -0.07235327410319495, "kl": 0.02327825967370281, "entropy": 0.7193869360540279, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.744191590634485, "cur_kl_coeff": 0.31244722496145777, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.57798515856266, "policy_loss": -0.0023801216259016654, "vf_loss": 8.578343083957831, "vf_explained_var": -0.030157781143983205, "kl": 0.006472077381476993, "entropy": 0.9300541268040736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 126240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 163.24366990680343, "episode_reward_min": 0.5282349292293085, "episode_reward_mean": 86.18185863335607, "episode_len_mean": 102.7, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 10270, "policy_reward_min": {"agent_policy": 0.26411746461465246, "adversary_policy": -9.123239850889167}, "policy_reward_max": {"agent_policy": 81.62183495340172, "adversary_policy": 53.660392552268696}, "policy_reward_mean": {"agent_policy": 43.09092931667805, "adversary_policy": 21.545464658339032}, "custom_metrics": {}, "hist_stats": {"episode_reward": [88.88387965153504, 68.20314801309212, 74.1026878533869, 147.8662032878293, 36.85280069769872, 74.55928603689645, 74.63137719522308, 60.509078770860015, 82.02261194478807, 75.68973162384539, 70.37091183561914, 70.62785535467641, 65.82946947798331, 72.15552485513192, 134.91154560361036, 133.8443383368179, 87.58350663159592, 122.14762845501345, 48.5140766929648, 129.09455427657926, 77.55470086827845, 97.51629842435756, 104.91269270644955, 34.139256453564094, 81.01050661351768, 160.19824407310142, 47.525008255840184, 138.63876021280925, 25.457442795320283, 54.12582247841865, 0.5282349292293085, 55.51071468033274, 127.82489367131632, 39.394057161229014, 63.82774364555389, 65.627558789203, 66.92598029733378, 148.52484017754094, 44.096033148257455, 57.8473062956864, 63.033299185550675, 116.51852939402892, 78.78780201542041, 161.50062505825568, 46.60567631188835, 95.92128931342506, 110.65422775126365, 104.31585967078037, 100.73635281035976, 39.67754053458761, 118.62746679538728, 102.24528434583635, 98.58332833925724, 87.90841628655653, 53.08849084599253, 97.89558826803272, 72.00206114775, 134.19463954729562, 121.47444646858156, 43.71342460613664, 13.132233476713894, 54.486187472689565, 88.8901600367221, 92.14848919942213, 70.0442339953415, 127.09540656834763, 138.54317240626975, 75.00649341470604, 133.11050679734572, 14.388647220563099, 33.049442927401785, 40.38643581469353, 13.144069724646222, 119.85665668285698, 101.27769068804184, 41.743993420680276, 61.275957664018094, 139.2782468395828, 96.02636418553253, 110.2605425031045, 115.25250195384076, 99.59789568721811, 122.71549516268419, 152.04145021744316, 97.01709496995781, 137.95089844228428, 75.56278411262437, 89.74911470556847, 103.80709960962592, 81.90333322791415, 90.88290567378212, 87.72853562270109, 89.05762735450534, 163.24366990680343, 138.0956373243484, 57.709309624931684, 114.51215351514556, 97.07609072472447, 79.31985132651327, 4.746822165440525], "episode_lengths": [47, 47, 78, 200, 87, 85, 125, 70, 101, 38, 168, 192, 39, 44, 200, 128, 123, 123, 83, 141, 111, 82, 73, 47, 157, 125, 97, 160, 35, 200, 37, 103, 87, 59, 200, 47, 74, 147, 44, 57, 90, 112, 83, 155, 79, 158, 109, 56, 110, 120, 173, 50, 165, 61, 200, 80, 90, 145, 69, 60, 115, 102, 104, 173, 80, 66, 110, 122, 76, 18, 52, 114, 36, 129, 172, 147, 92, 112, 104, 136, 149, 100, 91, 136, 105, 134, 110, 84, 87, 192, 97, 77, 62, 71, 92, 61, 137, 89, 68, 42], "policy_agent_policy_reward": [44.441939825767534, 34.10157400654606, 37.051343926693455, 73.93310164391468, 18.426400348849363, 37.27964301844823, 37.31568859761152, 30.254539385430007, 41.01130597239403, 37.84486581192269, 35.18545591780958, 35.31392767733821, 32.914734738991655, 36.07776242756597, 67.4557728018052, 66.92216916840893, 43.79175331579795, 61.07381422750669, 24.257038346482396, 64.54727713828966, 38.77735043413924, 48.75814921217879, 52.45634635322483, 17.069628226782047, 40.50525330675884, 80.09912203655074, 23.76250412792009, 69.31938010640461, 12.728721397660141, 27.062911239209342, 0.26411746461465246, 27.755357340166366, 63.91244683565815, 19.697028580614507, 31.91387182277694, 32.81377939460152, 33.462990148666876, 74.26242008877047, 22.048016574128727, 28.92365314784321, 31.516649592775345, 58.25926469701447, 39.39390100771019, 80.75031252912783, 23.302838155944176, 47.96064465671252, 55.327113875631824, 52.157929835390185, 50.36817640517988, 19.838770267293803, 59.31373339769367, 51.12264217291816, 49.291664169628625, 43.95420814327825, 26.544245422996283, 48.947794134016355, 36.001030573875, 67.0973197736478, 60.73722323429078, 21.85671230306832, 6.566116738356948, 27.243093736344782, 44.445080018361054, 46.074244599711065, 35.02211699767075, 63.54770328417381, 69.27158620313485, 37.50324670735302, 66.55525339867283, 7.194323610281549, 16.524721463700885, 20.193217907346764, 6.572034862323112, 59.9283283414285, 50.638845344020915, 20.871996710340134, 30.63797883200906, 69.63912341979142, 48.01318209276627, 55.13027125155226, 57.62625097692039, 49.79894784360906, 61.35774758134211, 76.02072510872159, 48.50854748497893, 68.97544922114213, 37.78139205631218, 44.87455735278423, 51.90354980481299, 40.95166661395707, 45.44145283689106, 43.864267811350565, 44.52881367725268, 81.62183495340172, 69.04781866217421, 28.854654812465846, 57.256076757572764, 48.538045362362226, 39.65992566325665, 2.3734110827202617], "policy_adversary_policy_reward": [27.453177056846243, 16.988762768921294, 15.603091295797213, 18.498482710748846, 18.5721341539698, 18.479209772723646, 31.43361618033302, 42.49948546358166, 21.33529320968302, -2.9088928608336566, 14.050963887550747, 23.228679130897476, 34.95493450981217, 2.3607540877993607, 22.63281331564209, 7.621726069787917, 22.90526573043451, 18.106040241959512, 15.233746661050489, 22.611119150872213, 24.447691519815017, 10.737764397994564, 23.97202799889041, 11.341899678447795, 23.36754114198158, 9.547193597010075, 26.0252582025722, 10.05250422499377, 33.27082598095847, 34.184946820846726, 25.665944405693132, 41.2562247627158, 17.89150214800635, 25.900251167791595, 27.77424053941877, 33.29957368808793, 17.59471775885214, 6.6623205876302585, 31.536770751933357, 33.01050638635631, -3.7692752058214065, 42.54662563996063, 29.16704155790746, 19.59110765427133, 21.38844624526998, 31.067900107954838, 8.914672930066287, 8.154955296715762, 28.422337774540967, 12.082915532217864, 35.776517771643626, 44.32260426490713, 10.538297485348277, 13.224206642571815, 43.52615700704193, 25.793223099362674, -2.122196434168064, 14.850917831828205, 19.695197582477334, 7.367713656732002, 1.6671549064264017, -1.4030374418117493, -1.6166250061762781, 29.371982346342644, 34.034556542242036, 29.87789029341611, 2.354378715852228, 17.34264986476228, 19.85157061719533, 12.062301205581612, 17.941834730010388, 14.87194466459113, 19.121470432110588, 14.341519716556292, 22.311390473246576, 51.95102961552389, 3.966499534991385, 18.081517039137342, 7.5670251797180565, 21.356627968125153, 30.196947500672664, 1.3197020921026734, 42.496741873203014, 15.762522823811448, 1.0313531621289265, 38.36254784558126, 46.816912044252504, 33.93340048487531, 5.959045379013629, 17.34379277693055, 7.483407247908799, 40.47723740880371, 18.293416686788404, 37.03369718884341, 26.712436828474626, 25.44549300691555, 30.03227178495191, 20.33590462022797, 16.811129673407176, 3.027640593886627, 32.19963038392055, 27.1141030137731, 31.17506102134023, 19.947581151577932, 25.47275011927384, 23.818914050354778, 13.99416864873791, 29.960039494540347, 10.091657621107483, 16.452587801888797, 31.33751789832904, 17.6102762356873, 11.633779162535202, 24.367251411339797, 32.388917604936566, 34.708402168711245, 28.782558014882863, 31.954665219407893, 8.06417018648001, 13.792542116588304, -2.9066336717905665, 9.472750410147514, 10.213951170759664, 17.02914256558512, 27.631244877681546, 16.8138351406795, 27.592034854381374, 18.48220974532969, 25.423249002157323, 9.598867995513423, 29.45703276377762, 34.09067052039619, 40.67686463066341, 28.594721572471443, 25.024968140225756, 12.478278567127266, 39.11395797736808, 27.44129542130476, 4.655853439831013, 2.538470170450536, 10.231106065518638, 6.293615398182244, 4.812400853473054, 15.380817053873708, 1.2748400449275472, 5.297194817395564, 28.72271021085257, 31.205618130575928, 26.87969773229441, 23.759147611726505, 12.79037653204102, 8.081620178299117, -5.800794394288365, 36.43877322629743, 44.0728139120142, 25.566309507777213, 20.956622263008278, 27.056559829757987, 29.697118547342303, 25.433152704209956, 30.470253058013043, 27.155997918907346, 41.29412750955519, 8.504820334053875, 26.97178436282326, 34.38596321851883, 53.660392552268696, 22.3603325564529, 18.183924985348572, 30.324622499630365, 44.04414736997586, 24.931301851166275, 30.938767735781955, 6.842624320530225, 7.207263326581415, 37.66729402620282, 18.258878500555582, 33.64467130425739, 12.32057226823149, 28.63109434572558, 19.362031214866434, 26.079421622024633, 21.22530600597159, 22.638961805378948, 20.738425938880546, 23.79038773837214, 36.057796994931664, 45.56403795847007, 30.33854698302033, 38.709271679153886, 10.832031621893883, 18.02262319057196, 34.75454493852785, 22.501531819044914, 15.006755799677348, 33.53128956268488, 33.30980036392669, 6.35012529932996, -9.123239850889167, 11.49665093360943]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38546256521097805, "mean_inference_ms": 0.9549947915232638, "mean_action_processing_ms": 0.16384608730151462, "mean_env_wait_ms": 0.05671386397703084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004330754280090332, "StateBufferConnector_ms": 0.002924680709838867, "ViewRequirementAgentConnector_ms": 0.09811341762542725}, "num_episodes": 42, "episode_return_max": 163.24366990680343, "episode_return_min": 0.5282349292293085, "episode_return_mean": 86.18185863335607}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.6463415831015, "num_env_steps_trained_throughput_per_sec": 346.6463415831015, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 8670.075, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8670.03, "sample_time_ms": 798.647, "learn_time_ms": 7859.036, "learn_throughput": 508.968, "synch_weights_time_ms": 11.423}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 132, "trial_id": "eaa30_00000", "date": "2024-08-09_17-58-23", "timestamp": 1723240703, "time_this_iter_s": 11.586516857147217, "time_total_s": 1081.2026481628418, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2839dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1081.2026481628418, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 54.11764705882353, "ram_util_percent": 82.45882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.755739899287148, "cur_kl_coeff": 0.07216268945485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.645633871593173, "policy_loss": 0.004619797666325535, "vf_loss": 7.639468925970572, "vf_explained_var": 0.023059300613151024, "kl": 0.02141196577903376, "entropy": 0.7728112302759967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.986725047292809, "cur_kl_coeff": 0.31244722496145777, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.797917309900125, "policy_loss": -0.003040835073625203, "vf_loss": 8.79848206837972, "vf_explained_var": -0.023294220181802907, "kl": 0.00792483776458539, "entropy": 0.951773600342373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 127200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000}, "env_runners": {"episode_reward_max": 216.40541546657485, "episode_reward_min": 4.746822165440525, "episode_reward_mean": 88.81629598714647, "episode_len_mean": 90.81, "episode_media": {}, "episodes_this_iter": 51, "episodes_timesteps_total": 9081, "policy_reward_min": {"agent_policy": 2.3734110827202617, "adversary_policy": -13.48152092344349}, "policy_reward_max": {"agent_policy": 108.20270773328741, "adversary_policy": 57.63168708123037}, "policy_reward_mean": {"agent_policy": 44.40814799357324, "adversary_policy": 22.204073996786622}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.24528434583635, 98.58332833925724, 87.90841628655653, 53.08849084599253, 97.89558826803272, 72.00206114775, 134.19463954729562, 121.47444646858156, 43.71342460613664, 13.132233476713894, 54.486187472689565, 88.8901600367221, 92.14848919942213, 70.0442339953415, 127.09540656834763, 138.54317240626975, 75.00649341470604, 133.11050679734572, 14.388647220563099, 33.049442927401785, 40.38643581469353, 13.144069724646222, 119.85665668285698, 101.27769068804184, 41.743993420680276, 61.275957664018094, 139.2782468395828, 96.02636418553253, 110.2605425031045, 115.25250195384076, 99.59789568721811, 122.71549516268419, 152.04145021744316, 97.01709496995781, 137.95089844228428, 75.56278411262437, 89.74911470556847, 103.80709960962592, 81.90333322791415, 90.88290567378212, 87.72853562270109, 89.05762735450534, 163.24366990680343, 138.0956373243484, 57.709309624931684, 114.51215351514556, 97.07609072472447, 79.31985132651327, 4.746822165440525, 87.17218997373834, 140.80317574446437, 157.02232127818434, 94.96829643571658, 6.7838908176109225, 153.34111281492505, 39.42757140065468, 47.30041303384318, 78.30990487020424, 201.17410334999855, 6.430384622432886, 82.50770352370895, 180.74619258272764, 86.97368359026916, 216.40541546657485, 87.3036673170266, 45.27491030081584, 66.81876003664178, 60.454212810337765, 134.1299418022136, 37.57188376853495, 142.64904619140287, 25.19759361546316, 100.2869436741913, 26.334804502677393, 55.60237987844184, 131.97322547717016, 69.4682710392784, 131.51019750479512, 81.19270134876653, 105.06710505761633, 100.79979259720527, 36.21891349006251, 82.21871276754294, 157.09397201525684, 102.48053536135538, 47.95228163288647, 114.43560856999807, 98.45474259061815, 104.79293069169154, 75.45270007301397, 71.91027811215446, 38.7953936910414, 39.446407214260404, 26.493809206943975, 117.12488456133292, 98.02961580172342, 128.91591758562234, 32.812789895614756, 83.85694217368739, 71.92048463003339], "episode_lengths": [50, 165, 61, 200, 80, 90, 145, 69, 60, 115, 102, 104, 173, 80, 66, 110, 122, 76, 18, 52, 114, 36, 129, 172, 147, 92, 112, 104, 136, 149, 100, 91, 136, 105, 134, 110, 84, 87, 192, 97, 77, 62, 71, 92, 61, 137, 89, 68, 42, 70, 129, 136, 128, 4, 100, 69, 50, 74, 127, 63, 52, 152, 78, 126, 54, 53, 92, 56, 119, 52, 73, 45, 75, 66, 64, 125, 133, 83, 51, 114, 78, 49, 93, 124, 83, 42, 100, 104, 68, 45, 71, 60, 73, 36, 119, 58, 72, 95, 68, 66], "policy_agent_policy_reward": [51.12264217291816, 49.291664169628625, 43.95420814327825, 26.544245422996283, 48.947794134016355, 36.001030573875, 67.0973197736478, 60.73722323429078, 21.85671230306832, 6.566116738356948, 27.243093736344782, 44.445080018361054, 46.074244599711065, 35.02211699767075, 63.54770328417381, 69.27158620313485, 37.50324670735302, 66.55525339867283, 7.194323610281549, 16.524721463700885, 20.193217907346764, 6.572034862323112, 59.9283283414285, 50.638845344020915, 20.871996710340134, 30.63797883200906, 69.63912341979142, 48.01318209276627, 55.13027125155226, 57.62625097692039, 49.79894784360906, 61.35774758134211, 76.02072510872159, 48.50854748497893, 68.97544922114213, 37.78139205631218, 44.87455735278423, 51.90354980481299, 40.95166661395707, 45.44145283689106, 43.864267811350565, 44.52881367725268, 81.62183495340172, 69.04781866217421, 28.854654812465846, 57.256076757572764, 48.538045362362226, 39.65992566325665, 2.3734110827202617, 43.58609498686917, 70.40158787223221, 78.51116063909217, 47.48414821785828, 3.3919454088054612, 76.6705564074625, 19.713785700327335, 23.650206516921592, 39.15495243510212, 100.58705167499926, 3.215192311216443, 41.25385176185447, 90.37309629136381, 43.486841795134566, 108.20270773328741, 43.651833658513304, 22.63745515040792, 33.40938001832088, 30.22710640516888, 67.06497090110678, 18.78594188426748, 71.3245230957015, 12.598796807731576, 50.14347183709564, 13.167402251338697, 27.801189939220922, 65.98661273858508, 34.734135519639196, 65.75509875239754, 40.59635067438325, 52.533552528808166, 50.39989629860263, 18.109456745031267, 41.10935638377148, 78.54698600762842, 51.24026768067771, 23.976140816443223, 57.21780428499903, 49.22737129530907, 52.396465345845755, 37.726350036506986, 35.955139056077215, 19.39769684552069, 19.723203607130202, 13.246904603471988, 58.56244228066645, 49.01480790086171, 64.45795879281111, 16.406394947807378, 41.92847108684369, 35.9602423150167], "policy_adversary_policy_reward": [31.17506102134023, 19.947581151577932, 25.47275011927384, 23.818914050354778, 13.99416864873791, 29.960039494540347, 10.091657621107483, 16.452587801888797, 31.33751789832904, 17.6102762356873, 11.633779162535202, 24.367251411339797, 32.388917604936566, 34.708402168711245, 28.782558014882863, 31.954665219407893, 8.06417018648001, 13.792542116588304, -2.9066336717905665, 9.472750410147514, 10.213951170759664, 17.02914256558512, 27.631244877681546, 16.8138351406795, 27.592034854381374, 18.48220974532969, 25.423249002157323, 9.598867995513423, 29.45703276377762, 34.09067052039619, 40.67686463066341, 28.594721572471443, 25.024968140225756, 12.478278567127266, 39.11395797736808, 27.44129542130476, 4.655853439831013, 2.538470170450536, 10.231106065518638, 6.293615398182244, 4.812400853473054, 15.380817053873708, 1.2748400449275472, 5.297194817395564, 28.72271021085257, 31.205618130575928, 26.87969773229441, 23.759147611726505, 12.79037653204102, 8.081620178299117, -5.800794394288365, 36.43877322629743, 44.0728139120142, 25.566309507777213, 20.956622263008278, 27.056559829757987, 29.697118547342303, 25.433152704209956, 30.470253058013043, 27.155997918907346, 41.29412750955519, 8.504820334053875, 26.97178436282326, 34.38596321851883, 53.660392552268696, 22.3603325564529, 18.183924985348572, 30.324622499630365, 44.04414736997586, 24.931301851166275, 30.938767735781955, 6.842624320530225, 7.207263326581415, 37.66729402620282, 18.258878500555582, 33.64467130425739, 12.32057226823149, 28.63109434572558, 19.362031214866434, 26.079421622024633, 21.22530600597159, 22.638961805378948, 20.738425938880546, 23.79038773837214, 36.057796994931664, 45.56403795847007, 30.33854698302033, 38.709271679153886, 10.832031621893883, 18.02262319057196, 34.75454493852785, 22.501531819044914, 15.006755799677348, 33.53128956268488, 33.30980036392669, 6.35012529932996, -9.123239850889167, 11.49665093360943, 17.395763241532716, 26.190331745336447, 34.752646648636166, 35.64894122359602, 46.44667045120429, 32.06449018788786, 7.491545809088466, 39.9926024087698, 2.6637264982659445, 0.7282189105395165, 39.085816484050184, 37.58473992341232, 17.333182999301734, 2.3806027010256026, 10.067519343420809, 13.582687173500785, 17.07816985113941, 22.076782583962704, 43.765921143599876, 56.82113053139939, 15.183757980391919, -11.968565669175476, 13.832172329347696, 27.421679432506778, 52.07281733320367, 38.30027895816013, 24.995034654375495, 18.49180714075908, 50.57102065205703, 57.63168708123037, 23.232821952684926, 20.41901170582837, 15.722921173794713, 6.914533976613207, 26.957069347494127, 6.452310670826764, 4.008522000789248, 26.21858440437963, 32.11791102436548, 34.947059876741285, 5.819910474556849, 12.96603140971063, 37.655602507013015, 33.66892058868847, 8.212485384469172, 4.386311423262406, 19.128985899206025, 31.014485937889614, 21.961485232092233, -8.79408298075354, 3.9564932788561613, 23.84469666036476, 27.548858819965893, 38.437753918619194, 20.73423703215469, 13.999898487484504, 43.05232622106446, 22.70277253133309, 14.592662697267766, 26.003687977115483, 29.553034034046355, 22.98051849476181, 30.540612056052026, 19.859284242550604, 10.47467386327478, 7.6347828817564825, 27.959243160322234, 13.150113223449258, 36.491214608530214, 42.055771399098205, 43.57163533125212, 7.668632349425596, 13.550971371514573, 10.425169444928645, 43.86907985256504, 13.348724432433997, 36.45013710067828, 12.77723419463079, 22.817042934019106, 29.579422411826634, 21.263686108548825, 16.462663927958157, 21.503813851365194, 14.451325204712024, 7.498415843577018, 11.89928100194367, 33.204724530573685, -13.48152092344349, 3.0767459108047284, 10.17015869266726, 19.479070678530476, 39.083371602135976, 13.468902676682411, 35.5459052241793, 26.640569904150468, 37.81738888866064, 15.015425611962272, 1.3909693358451065, 24.83876449250878, 17.089706594334913, 7.193073837704041, 28.767168477312648]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38729076088729775, "mean_inference_ms": 0.961011032305695, "mean_action_processing_ms": 0.16458844700623676, "mean_env_wait_ms": 0.05706649505757943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004438519477844238, "StateBufferConnector_ms": 0.0066214799880981445, "ViewRequirementAgentConnector_ms": 0.1277017593383789}, "num_episodes": 51, "episode_return_max": 216.40541546657485, "episode_return_min": 4.746822165440525, "episode_return_mean": 88.81629598714647}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.77680884306903, "num_env_steps_trained_throughput_per_sec": 433.77680884306903, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 1596000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1596000, "timers": {"training_iteration_time_ms": 8803.609, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8803.563, "sample_time_ms": 841.651, "learn_time_ms": 7949.137, "learn_throughput": 503.199, "synch_weights_time_ms": 11.515}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000}, "done": false, "training_iteration": 133, "trial_id": "eaa30_00000", "date": "2024-08-09_17-58-33", "timestamp": 1723240713, "time_this_iter_s": 9.259065866470337, "time_total_s": 1090.4617140293121, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1780230d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1090.4617140293121, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 38.238461538461536, "ram_util_percent": 83.38461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.565615454048076, "cur_kl_coeff": 0.10824403418228033, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.620304542874533, "policy_loss": -0.0016286673655033742, "vf_loss": 7.620571058263224, "vf_explained_var": 0.0847121676124593, "kl": 0.01258406720971738, "entropy": 0.7834581693328878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.300192711874843, "cur_kl_coeff": 0.31244722496145777, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.014862626791, "policy_loss": -0.001549019111795739, "vf_loss": 9.01148925324281, "vf_explained_var": -0.11309855182965596, "kl": 0.01575430457596667, "entropy": 0.9994423357769847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 128160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000}, "env_runners": {"episode_reward_max": 216.40541546657485, "episode_reward_min": 2.618732745040827, "episode_reward_mean": 82.56356918456677, "episode_len_mean": 82.05, "episode_media": {}, "episodes_this_iter": 48, "episodes_timesteps_total": 8205, "policy_reward_min": {"agent_policy": 1.3093663725204099, "adversary_policy": -17.382449332410154}, "policy_reward_max": {"agent_policy": 108.20270773328741, "adversary_policy": 57.63168708123037}, "policy_reward_mean": {"agent_policy": 41.28178459228339, "adversary_policy": 20.640892296141693}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.746822165440525, 87.17218997373834, 140.80317574446437, 157.02232127818434, 94.96829643571658, 6.7838908176109225, 153.34111281492505, 39.42757140065468, 47.30041303384318, 78.30990487020424, 201.17410334999855, 6.430384622432886, 82.50770352370895, 180.74619258272764, 86.97368359026916, 216.40541546657485, 87.3036673170266, 45.27491030081584, 66.81876003664178, 60.454212810337765, 134.1299418022136, 37.57188376853495, 142.64904619140287, 25.19759361546316, 100.2869436741913, 26.334804502677393, 55.60237987844184, 131.97322547717016, 69.4682710392784, 131.51019750479512, 81.19270134876653, 105.06710505761633, 100.79979259720527, 36.21891349006251, 82.21871276754294, 157.09397201525684, 102.48053536135538, 47.95228163288647, 114.43560856999807, 98.45474259061815, 104.79293069169154, 75.45270007301397, 71.91027811215446, 38.7953936910414, 39.446407214260404, 26.493809206943975, 117.12488456133292, 98.02961580172342, 128.91591758562234, 32.812789895614756, 83.85694217368739, 71.92048463003339, 68.7974270452822, 132.015789277606, 31.6221713974101, 87.72795240194766, 39.34728613317104, 54.50486457860353, 64.93834414849745, 25.112397160581803, 118.34398446708312, 100.60618901133716, 96.80044701094405, 70.89953589839507, 137.248987083031, 91.84592988246533, 100.23095210853579, 69.4490120052441, 37.95773328587653, 65.19125882523525, 2.618732745040827, 60.65166749637085, 52.27986396764831, 147.81696400063637, 115.99081888324883, 163.43224022031956, 30.421321681728934, 20.965720702315416, 28.575402252459835, 56.48354976245119, 139.4849038909078, 146.02674040400336, 15.422831964618165, 53.67870194318233, 60.563690348246695, 66.10536221375648, 80.08303964704285, 12.16285644635802, 14.532932181849457, 123.07134545648498, 136.8931004326793, 23.61920330298487, 121.11902194399906, 112.8521969085437, 91.50899485645401, 35.798892002634254, 102.85058038167244, 108.48176900507491, 110.77502598552007, 115.29364704928338], "episode_lengths": [42, 70, 129, 136, 128, 4, 100, 69, 50, 74, 127, 63, 52, 152, 78, 126, 54, 53, 92, 56, 119, 52, 73, 45, 75, 66, 64, 125, 133, 83, 51, 114, 78, 49, 93, 124, 83, 42, 100, 104, 68, 45, 71, 60, 73, 36, 119, 58, 72, 95, 68, 66, 72, 114, 85, 73, 123, 67, 58, 104, 110, 86, 86, 53, 114, 94, 87, 79, 34, 70, 57, 107, 94, 118, 85, 114, 54, 72, 131, 70, 82, 159, 70, 75, 42, 57, 99, 72, 31, 74, 129, 57, 93, 144, 106, 61, 62, 64, 71, 87], "policy_agent_policy_reward": [2.3734110827202617, 43.58609498686917, 70.40158787223221, 78.51116063909217, 47.48414821785828, 3.3919454088054612, 76.6705564074625, 19.713785700327335, 23.650206516921592, 39.15495243510212, 100.58705167499926, 3.215192311216443, 41.25385176185447, 90.37309629136381, 43.486841795134566, 108.20270773328741, 43.651833658513304, 22.63745515040792, 33.40938001832088, 30.22710640516888, 67.06497090110678, 18.78594188426748, 71.3245230957015, 12.598796807731576, 50.14347183709564, 13.167402251338697, 27.801189939220922, 65.98661273858508, 34.734135519639196, 65.75509875239754, 40.59635067438325, 52.533552528808166, 50.39989629860263, 18.109456745031267, 41.10935638377148, 78.54698600762842, 51.24026768067771, 23.976140816443223, 57.21780428499903, 49.22737129530907, 52.396465345845755, 37.726350036506986, 35.955139056077215, 19.39769684552069, 19.723203607130202, 13.246904603471988, 58.56244228066645, 49.01480790086171, 64.45795879281111, 16.406394947807378, 41.92847108684369, 35.9602423150167, 34.3987135226411, 66.00789463880298, 15.81108569870505, 43.86397620097384, 19.673643066585516, 27.252432289301765, 32.46917207424872, 12.556198580290921, 59.17199223354157, 50.3030945056686, 48.40022350547203, 35.449767949197536, 68.62449354151545, 45.92296494123266, 50.11547605426791, 34.72450600262206, 18.97886664293826, 32.595629412617626, 1.3093663725204099, 30.32583374818542, 26.13993198382417, 73.90848200031819, 57.9954094416244, 81.71612011015979, 15.210660840864463, 10.482860351157706, 14.287701126229917, 28.241774881225595, 69.74245194545391, 73.01337020200167, 7.711415982309084, 26.839350971591177, 30.28184517412335, 33.05268110687825, 40.041519823521426, 6.08142822317901, 7.266466090924729, 61.535672728242474, 68.44655021633965, 11.809601651492436, 60.559510971999515, 56.42609845427192, 45.754497428227026, 17.89944600131713, 51.42529019083618, 54.24088450253752, 55.38751299276006, 57.64682352464165], "policy_adversary_policy_reward": [-9.123239850889167, 11.49665093360943, 17.395763241532716, 26.190331745336447, 34.752646648636166, 35.64894122359602, 46.44667045120429, 32.06449018788786, 7.491545809088466, 39.9926024087698, 2.6637264982659445, 0.7282189105395165, 39.085816484050184, 37.58473992341232, 17.333182999301734, 2.3806027010256026, 10.067519343420809, 13.582687173500785, 17.07816985113941, 22.076782583962704, 43.765921143599876, 56.82113053139939, 15.183757980391919, -11.968565669175476, 13.832172329347696, 27.421679432506778, 52.07281733320367, 38.30027895816013, 24.995034654375495, 18.49180714075908, 50.57102065205703, 57.63168708123037, 23.232821952684926, 20.41901170582837, 15.722921173794713, 6.914533976613207, 26.957069347494127, 6.452310670826764, 4.008522000789248, 26.21858440437963, 32.11791102436548, 34.947059876741285, 5.819910474556849, 12.96603140971063, 37.655602507013015, 33.66892058868847, 8.212485384469172, 4.386311423262406, 19.128985899206025, 31.014485937889614, 21.961485232092233, -8.79408298075354, 3.9564932788561613, 23.84469666036476, 27.548858819965893, 38.437753918619194, 20.73423703215469, 13.999898487484504, 43.05232622106446, 22.70277253133309, 14.592662697267766, 26.003687977115483, 29.553034034046355, 22.98051849476181, 30.540612056052026, 19.859284242550604, 10.47467386327478, 7.6347828817564825, 27.959243160322234, 13.150113223449258, 36.491214608530214, 42.055771399098205, 43.57163533125212, 7.668632349425596, 13.550971371514573, 10.425169444928645, 43.86907985256504, 13.348724432433997, 36.45013710067828, 12.77723419463079, 22.817042934019106, 29.579422411826634, 21.263686108548825, 16.462663927958157, 21.503813851365194, 14.451325204712024, 7.498415843577018, 11.89928100194367, 33.204724530573685, -13.48152092344349, 3.0767459108047284, 10.17015869266726, 19.479070678530476, 39.083371602135976, 13.468902676682411, 35.5459052241793, 26.640569904150468, 37.81738888866064, 15.015425611962272, 1.3909693358451065, 24.83876449250878, 17.089706594334913, 7.193073837704041, 28.767168477312648, 30.266130372894136, 4.132583149746981, 19.943806932126883, 46.06408770667612, -2.2802215664379375, 18.091307265142987, 39.48897792610927, 4.374998274864563, 24.898468431724417, -5.2248253651389, 9.28431735253314, 17.968114936768625, 21.855820310935, 10.61335176331372, 11.876084035474634, 0.6801145448162913, 30.305499985185293, 28.866492248356288, 14.348730099510625, 35.95436440615796, 30.820093862902983, 17.580129642569048, 21.210596091370558, 14.239171857826978, 22.916713129334187, 45.707780412181265, 33.20036899573628, 12.722595945496376, 23.628618195457722, 26.48685785881019, 16.717658121751647, 18.00684788087041, 4.433118673245137, 14.545747969693124, 0.2517623544007179, 32.34386705821691, -17.382449332410154, 18.691815704930566, 2.6578625823685407, 27.667971165816883, 6.517775374572727, 19.62215660925144, 40.82155066886394, 33.086931331454245, 34.913473167401854, 23.081936274222546, 42.763682978565505, 38.95243713159429, -0.1404919631302466, 15.351152803994712, 4.863424451099641, 5.619435900058063, 20.96104132099801, -6.673340194768093, 23.14751093298584, 5.094263948239757, 31.186119886616744, 38.55633205883716, 31.865813931588995, 41.14755627041267, 2.193886505160539, 5.517529477148546, 7.886763322350838, 18.95258764924034, 6.896407017703652, 23.3854381564197, 18.592040874277526, 14.460640232600717, 36.55407528961268, 3.487444533908743, -12.735124620394192, 18.816552843573202, 4.582754643040711, 2.6837114478840185, 33.350481976001355, 28.185190752241127, 41.28079395013373, 27.16575626620591, 7.838573005849249, 3.9710286456431856, 24.30590901247925, 36.25360195952029, 43.7506559623647, 12.675442491907212, 35.63372798471206, 10.12076944351497, 11.775490507613158, 6.123955493703972, 32.46051003723627, 18.96478015359991, 39.85344307588142, 14.387441426656075, 10.735685113046788, 44.65182787971326, 30.900956612203863, 26.745866912437783]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38852813709216816, "mean_inference_ms": 0.9651538630426717, "mean_action_processing_ms": 0.1651670299338026, "mean_env_wait_ms": 0.05734789837954125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004980206489562988, "StateBufferConnector_ms": 0.006794333457946777, "ViewRequirementAgentConnector_ms": 0.11832273006439209}, "num_episodes": 48, "episode_return_max": 216.40541546657485, "episode_return_min": 2.618732745040827, "episode_return_mean": 82.56356918456677}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 439.34931154218134, "num_env_steps_trained_throughput_per_sec": 439.34931154218134, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 1608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1608000, "timers": {"training_iteration_time_ms": 8926.781, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8926.734, "sample_time_ms": 875.475, "learn_time_ms": 8038.263, "learn_throughput": 497.62, "synch_weights_time_ms": 11.732}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000}, "done": false, "training_iteration": 134, "trial_id": "eaa30_00000", "date": "2024-08-09_17-58-42", "timestamp": 1723240722, "time_this_iter_s": 9.110030174255371, "time_total_s": 1099.5717442035675, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1780dadc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1099.5717442035675, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 35.23571428571428, "ram_util_percent": 83.14285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.61178498293357, "cur_kl_coeff": 0.10824403418228033, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.229892199127763, "policy_loss": -0.00014534973017082958, "vf_loss": 7.2288077573927625, "vf_explained_var": 0.04272966142053957, "kl": 0.011361251234338081, "entropy": 0.7555845473809217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.9659671238313114, "cur_kl_coeff": 0.31244722496145777, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.708065057794252, "policy_loss": 0.0021047412320816267, "vf_loss": 8.702599541346233, "vf_explained_var": -0.04844603159775337, "kl": 0.010756389693415257, "entropy": 0.9676552026222149, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 129120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000}, "env_runners": {"episode_reward_max": 181.43426941534443, "episode_reward_min": 2.618732745040827, "episode_reward_mean": 82.4280321986009, "episode_len_mean": 87.56, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 8756, "policy_reward_min": {"agent_policy": 1.3093663725204099, "adversary_policy": -17.382449332410154}, "policy_reward_max": {"agent_policy": 90.71713470767224, "adversary_policy": 55.87713981145252}, "policy_reward_mean": {"agent_policy": 41.21401609930046, "adversary_policy": 20.60700804965023}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.91027811215446, 38.7953936910414, 39.446407214260404, 26.493809206943975, 117.12488456133292, 98.02961580172342, 128.91591758562234, 32.812789895614756, 83.85694217368739, 71.92048463003339, 68.7974270452822, 132.015789277606, 31.6221713974101, 87.72795240194766, 39.34728613317104, 54.50486457860353, 64.93834414849745, 25.112397160581803, 118.34398446708312, 100.60618901133716, 96.80044701094405, 70.89953589839507, 137.248987083031, 91.84592988246533, 100.23095210853579, 69.4490120052441, 37.95773328587653, 65.19125882523525, 2.618732745040827, 60.65166749637085, 52.27986396764831, 147.81696400063637, 115.99081888324883, 163.43224022031956, 30.421321681728934, 20.965720702315416, 28.575402252459835, 56.48354976245119, 139.4849038909078, 146.02674040400336, 15.422831964618165, 53.67870194318233, 60.563690348246695, 66.10536221375648, 80.08303964704285, 12.16285644635802, 14.532932181849457, 123.07134545648498, 136.8931004326793, 23.61920330298487, 121.11902194399906, 112.8521969085437, 91.50899485645401, 35.798892002634254, 102.85058038167244, 108.48176900507491, 110.77502598552007, 115.29364704928338, 94.50295744861288, 41.3951870938904, 175.36007961741385, 51.45829199158723, 175.77742105869967, 181.43426941534443, 37.92240834661262, 158.76263975572942, 132.68814041696555, 82.50759573953151, 13.75762085772422, 35.49395556422407, 134.27580032141643, 156.5267191540062, 54.057378805028506, 52.94234039341427, 161.43273151089932, 108.73549463400526, 50.76987568869261, 65.16783499173096, 68.0354472449045, 19.706089532172594, 98.252607005676, 23.270856950612274, 32.97382132265567, 56.52596142729821, 109.39160346309882, 83.28779264925932, 104.90360948609491, 39.70595367685221, 164.52672831144304, 36.925214719505576, 117.8376735039017, 85.65741734474149, 145.49835653900993, 113.85450073268998, 165.69581888772092, 57.844030111311014, 120.1286550589966, 18.950686319333254, 28.70520829645993, 134.6485417996456], "episode_lengths": [71, 60, 73, 36, 119, 58, 72, 95, 68, 66, 72, 114, 85, 73, 123, 67, 58, 104, 110, 86, 86, 53, 114, 94, 87, 79, 34, 70, 57, 107, 94, 118, 85, 114, 54, 72, 131, 70, 82, 159, 70, 75, 42, 57, 99, 72, 31, 74, 129, 57, 93, 144, 106, 61, 62, 64, 71, 87, 107, 82, 146, 83, 168, 103, 57, 140, 147, 158, 47, 50, 97, 85, 60, 83, 131, 81, 63, 77, 89, 63, 64, 66, 58, 85, 124, 106, 116, 80, 102, 200, 118, 67, 104, 83, 89, 65, 96, 33, 88, 131], "policy_agent_policy_reward": [35.955139056077215, 19.39769684552069, 19.723203607130202, 13.246904603471988, 58.56244228066645, 49.01480790086171, 64.45795879281111, 16.406394947807378, 41.92847108684369, 35.9602423150167, 34.3987135226411, 66.00789463880298, 15.81108569870505, 43.86397620097384, 19.673643066585516, 27.252432289301765, 32.46917207424872, 12.556198580290921, 59.17199223354157, 50.3030945056686, 48.40022350547203, 35.449767949197536, 68.62449354151545, 45.92296494123266, 50.11547605426791, 34.72450600262206, 18.97886664293826, 32.595629412617626, 1.3093663725204099, 30.32583374818542, 26.13993198382417, 73.90848200031819, 57.9954094416244, 81.71612011015979, 15.210660840864463, 10.482860351157706, 14.287701126229917, 28.241774881225595, 69.74245194545391, 73.01337020200167, 7.711415982309084, 26.839350971591177, 30.28184517412335, 33.05268110687825, 40.041519823521426, 6.08142822317901, 7.266466090924729, 61.535672728242474, 68.44655021633965, 11.809601651492436, 60.559510971999515, 56.42609845427192, 45.754497428227026, 17.89944600131713, 51.42529019083618, 54.24088450253752, 55.38751299276006, 57.64682352464165, 47.25147872430644, 20.6975935469452, 87.68003980870691, 25.729145995793615, 87.88871052934985, 90.71713470767224, 18.961204173306307, 79.38131987786474, 66.34407020848276, 41.25379786976575, 6.878810428862112, 17.746977782112026, 67.1379001607082, 78.26335957700316, 27.028689402514253, 26.471170196707135, 80.71636575544967, 54.367747317002625, 25.384937844346307, 32.583917495865485, 34.017723622452245, 9.853044766086299, 49.126303502838, 11.635428475306139, 16.486910661327833, 28.262980713649103, 54.6958017315494, 41.64389632462966, 52.45180474304743, 19.852976838426112, 82.26336415572155, 18.462607359752784, 58.91883675195085, 42.82870867237074, 72.74917826950495, 56.92725036634499, 82.84790944386049, 28.922015055655503, 60.06432752949829, 9.475343159666625, 14.352604148229968, 67.3242708998228], "policy_adversary_policy_reward": [21.503813851365194, 14.451325204712024, 7.498415843577018, 11.89928100194367, 33.204724530573685, -13.48152092344349, 3.0767459108047284, 10.17015869266726, 19.479070678530476, 39.083371602135976, 13.468902676682411, 35.5459052241793, 26.640569904150468, 37.81738888866064, 15.015425611962272, 1.3909693358451065, 24.83876449250878, 17.089706594334913, 7.193073837704041, 28.767168477312648, 30.266130372894136, 4.132583149746981, 19.943806932126883, 46.06408770667612, -2.2802215664379375, 18.091307265142987, 39.48897792610927, 4.374998274864563, 24.898468431724417, -5.2248253651389, 9.28431735253314, 17.968114936768625, 21.855820310935, 10.61335176331372, 11.876084035474634, 0.6801145448162913, 30.305499985185293, 28.866492248356288, 14.348730099510625, 35.95436440615796, 30.820093862902983, 17.580129642569048, 21.210596091370558, 14.239171857826978, 22.916713129334187, 45.707780412181265, 33.20036899573628, 12.722595945496376, 23.628618195457722, 26.48685785881019, 16.717658121751647, 18.00684788087041, 4.433118673245137, 14.545747969693124, 0.2517623544007179, 32.34386705821691, -17.382449332410154, 18.691815704930566, 2.6578625823685407, 27.667971165816883, 6.517775374572727, 19.62215660925144, 40.82155066886394, 33.086931331454245, 34.913473167401854, 23.081936274222546, 42.763682978565505, 38.95243713159429, -0.1404919631302466, 15.351152803994712, 4.863424451099641, 5.619435900058063, 20.96104132099801, -6.673340194768093, 23.14751093298584, 5.094263948239757, 31.186119886616744, 38.55633205883716, 31.865813931588995, 41.14755627041267, 2.193886505160539, 5.517529477148546, 7.886763322350838, 18.95258764924034, 6.896407017703652, 23.3854381564197, 18.592040874277526, 14.460640232600717, 36.55407528961268, 3.487444533908743, -12.735124620394192, 18.816552843573202, 4.582754643040711, 2.6837114478840185, 33.350481976001355, 28.185190752241127, 41.28079395013373, 27.16575626620591, 7.838573005849249, 3.9710286456431856, 24.30590901247925, 36.25360195952029, 43.7506559623647, 12.675442491907212, 35.63372798471206, 10.12076944351497, 11.775490507613158, 6.123955493703972, 32.46051003723627, 18.96478015359991, 39.85344307588142, 14.387441426656075, 10.735685113046788, 44.65182787971326, 30.900956612203863, 26.745866912437783, 13.168996481392425, 34.08248224291402, 3.544626242987377, 17.152967303957823, 41.64599367367467, 46.03404613503225, 15.062823846576785, 10.666322149216828, 55.87713981145252, 32.01157071789733, 55.77457389768347, 34.94256080998876, 8.005616133665217, 10.955588039641091, 35.678250500570776, 43.703069377293964, 26.876219203304274, 39.46785100517849, 21.3971394739076, 19.85665839585815, -1.3539167598278148, 8.232727188689926, -0.7148732040137205, 18.461850986125746, 36.08891636347831, 31.048983797229887, 32.013207835945956, 46.25015174105719, 26.316296051867017, 0.7123933506472326, 13.24485599863269, 13.226314198074444, 35.7365791397988, 44.97978661565087, 34.998240289806034, 19.369507027196605, 14.370036861879154, 11.014900982467152, 14.253325279695218, 18.33059221617027, 17.1285971047123, 16.889126517739946, 0.37610516911022795, 9.476939596976074, 27.58857843847067, 21.53772506436733, -8.044534111971918, 19.67996258727806, 8.840413504376055, 7.646497156951778, 18.174449046507913, 10.088531667141192, 22.450006399451254, 32.24579533209815, 16.558954712362805, 25.084941612266853, 24.8515961990251, 27.600208544022337, 6.811116932603618, 13.041859905822495, 35.856410798855435, 46.40695335686611, -3.026891843966485, 21.48949920371927, 24.39441747184321, 34.52441928010764, 15.43886273505928, 27.389845937311453, 32.758113672017714, 39.99106459748724, 24.966312063321574, 31.96093830302342, 51.54938247079001, 31.29852697307045, 7.194093779617896, 21.727921276037605, 28.459865027226463, 31.604462502271844, 6.424595573677962, 3.050747585988664, 1.9312265719038617, 12.421377576326098, 29.451691364739887, 37.87257953508292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3889714170309109, "mean_inference_ms": 0.9664640875982868, "mean_action_processing_ms": 0.16526848293345647, "mean_env_wait_ms": 0.057428814614175004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004527688026428223, "StateBufferConnector_ms": 0.006523013114929199, "ViewRequirementAgentConnector_ms": 0.09069907665252686}, "num_episodes": 42, "episode_return_max": 181.43426941534443, "episode_return_min": 2.618732745040827, "episode_return_mean": 82.4280321986009}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.0980511663648, "num_env_steps_trained_throughput_per_sec": 498.0980511663648, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 1620000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1620000, "timers": {"training_iteration_time_ms": 8875.761, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8875.715, "sample_time_ms": 887.613, "learn_time_ms": 7975.075, "learn_throughput": 501.563, "synch_weights_time_ms": 11.791}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000}, "done": false, "training_iteration": 135, "trial_id": "eaa30_00000", "date": "2024-08-09_17-58-50", "timestamp": 1723240730, "time_this_iter_s": 8.035727977752686, "time_total_s": 1107.6074721813202, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x178023430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1107.6074721813202, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 28.718181818181822, "ram_util_percent": 83.30909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.340362688473293, "cur_kl_coeff": 0.10824403418228033, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.100901838837477, "policy_loss": 0.00017338926071133563, "vf_loss": 7.09944659389516, "vf_explained_var": -0.05503673622847865, "kl": 0.011842275811507116, "entropy": 0.7605732397112266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.28749264255166, "cur_kl_coeff": 0.31244722496145777, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.01760526150465, "policy_loss": -0.001602312175479407, "vf_loss": 8.017338701089223, "vf_explained_var": -0.027724975595871608, "kl": 0.0059812905128637794, "entropy": 0.9483849646523594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 130080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "env_runners": {"episode_reward_max": 181.43426941534443, "episode_reward_min": 12.16285644635802, "episode_reward_mean": 84.27890682152002, "episode_len_mean": 93.95, "episode_media": {}, "episodes_this_iter": 36, "episodes_timesteps_total": 9395, "policy_reward_min": {"agent_policy": 6.08142822317901, "adversary_policy": -12.735124620394192}, "policy_reward_max": {"agent_policy": 90.71713470767224, "adversary_policy": 55.87713981145252}, "policy_reward_mean": {"agent_policy": 42.13945341076003, "adversary_policy": 21.069726705380013}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.575402252459835, 56.48354976245119, 139.4849038909078, 146.02674040400336, 15.422831964618165, 53.67870194318233, 60.563690348246695, 66.10536221375648, 80.08303964704285, 12.16285644635802, 14.532932181849457, 123.07134545648498, 136.8931004326793, 23.61920330298487, 121.11902194399906, 112.8521969085437, 91.50899485645401, 35.798892002634254, 102.85058038167244, 108.48176900507491, 110.77502598552007, 115.29364704928338, 94.50295744861288, 41.3951870938904, 175.36007961741385, 51.45829199158723, 175.77742105869967, 181.43426941534443, 37.92240834661262, 158.76263975572942, 132.68814041696555, 82.50759573953151, 13.75762085772422, 35.49395556422407, 134.27580032141643, 156.5267191540062, 54.057378805028506, 52.94234039341427, 161.43273151089932, 108.73549463400526, 50.76987568869261, 65.16783499173096, 68.0354472449045, 19.706089532172594, 98.252607005676, 23.270856950612274, 32.97382132265567, 56.52596142729821, 109.39160346309882, 83.28779264925932, 104.90360948609491, 39.70595367685221, 164.52672831144304, 36.925214719505576, 117.8376735039017, 85.65741734474149, 145.49835653900993, 113.85450073268998, 165.69581888772092, 57.844030111311014, 120.1286550589966, 18.950686319333254, 28.70520829645993, 134.6485417996456, 111.08721396066323, 151.3836688971969, 115.84207050685947, 46.635001225496275, 63.142994411044015, 28.79662796950211, 41.48074625092491, 69.16043394430885, 74.3509511290816, 40.51119978637717, 115.13821218329164, 55.86450476181375, 15.147249382027551, 31.541235649380813, 84.0585530485076, 71.86978611809019, 62.94208205084331, 94.48480683281275, 45.20720643712263, 84.01852538157428, 63.7324165573684, 89.04128633116227, 123.00215410995693, 92.5823280900491, 39.132559225661495, 96.4175413858114, 85.8388793680963, 179.03591569531437, 39.55680534723891, 152.16056953764846, 130.3649308393471, 121.70881196504496, 66.80814630431712, 98.2991945805089, 54.985058464108775, 45.88190885433208], "episode_lengths": [131, 70, 82, 159, 70, 75, 42, 57, 99, 72, 31, 74, 129, 57, 93, 144, 106, 61, 62, 64, 71, 87, 107, 82, 146, 83, 168, 103, 57, 140, 147, 158, 47, 50, 97, 85, 60, 83, 131, 81, 63, 77, 89, 63, 64, 66, 58, 85, 124, 106, 116, 80, 102, 200, 118, 67, 104, 83, 89, 65, 96, 33, 88, 131, 93, 113, 83, 47, 63, 49, 63, 67, 106, 53, 171, 110, 28, 32, 68, 61, 82, 125, 37, 149, 92, 165, 115, 153, 200, 177, 48, 118, 74, 112, 155, 126, 101, 160, 49, 122], "policy_agent_policy_reward": [14.287701126229917, 28.241774881225595, 69.74245194545391, 73.01337020200167, 7.711415982309084, 26.839350971591177, 30.28184517412335, 33.05268110687825, 40.041519823521426, 6.08142822317901, 7.266466090924729, 61.535672728242474, 68.44655021633965, 11.809601651492436, 60.559510971999515, 56.42609845427192, 45.754497428227026, 17.89944600131713, 51.42529019083618, 54.24088450253752, 55.38751299276006, 57.64682352464165, 47.25147872430644, 20.6975935469452, 87.68003980870691, 25.729145995793615, 87.88871052934985, 90.71713470767224, 18.961204173306307, 79.38131987786474, 66.34407020848276, 41.25379786976575, 6.878810428862112, 17.746977782112026, 67.1379001607082, 78.26335957700316, 27.028689402514253, 26.471170196707135, 80.71636575544967, 54.367747317002625, 25.384937844346307, 32.583917495865485, 34.017723622452245, 9.853044766086299, 49.126303502838, 11.635428475306139, 16.486910661327833, 28.262980713649103, 54.6958017315494, 41.64389632462966, 52.45180474304743, 19.852976838426112, 82.26336415572155, 18.462607359752784, 58.91883675195085, 42.82870867237074, 72.74917826950495, 56.92725036634499, 82.84790944386049, 28.922015055655503, 60.06432752949829, 9.475343159666625, 14.352604148229968, 67.3242708998228, 55.54360698033161, 75.69183444859847, 57.921035253429736, 23.31750061274814, 31.571497205522004, 14.398313984751058, 20.740373125462458, 34.58021697215442, 37.175475564540804, 20.255599893188588, 57.56910609164582, 27.932252380906874, 7.573624691013775, 15.770617824690408, 42.029276524253795, 35.934893059045095, 31.47104102542165, 47.242403416406376, 22.603603218561314, 42.00926269078715, 31.86620827868421, 44.520643165581106, 61.501077054978495, 46.29116404502455, 19.566279612830744, 48.2087706929057, 42.91943968404814, 89.51795784765721, 19.77840267361944, 76.08028476882421, 65.18246541967358, 60.854405982522465, 33.404073152158546, 49.14959729025445, 27.492529232054373, 22.940954427166048], "policy_adversary_policy_reward": [20.96104132099801, -6.673340194768093, 23.14751093298584, 5.094263948239757, 31.186119886616744, 38.55633205883716, 31.865813931588995, 41.14755627041267, 2.193886505160539, 5.517529477148546, 7.886763322350838, 18.95258764924034, 6.896407017703652, 23.3854381564197, 18.592040874277526, 14.460640232600717, 36.55407528961268, 3.487444533908743, -12.735124620394192, 18.816552843573202, 4.582754643040711, 2.6837114478840185, 33.350481976001355, 28.185190752241127, 41.28079395013373, 27.16575626620591, 7.838573005849249, 3.9710286456431856, 24.30590901247925, 36.25360195952029, 43.7506559623647, 12.675442491907212, 35.63372798471206, 10.12076944351497, 11.775490507613158, 6.123955493703972, 32.46051003723627, 18.96478015359991, 39.85344307588142, 14.387441426656075, 10.735685113046788, 44.65182787971326, 30.900956612203863, 26.745866912437783, 13.168996481392425, 34.08248224291402, 3.544626242987377, 17.152967303957823, 41.64599367367467, 46.03404613503225, 15.062823846576785, 10.666322149216828, 55.87713981145252, 32.01157071789733, 55.77457389768347, 34.94256080998876, 8.005616133665217, 10.955588039641091, 35.678250500570776, 43.703069377293964, 26.876219203304274, 39.46785100517849, 21.3971394739076, 19.85665839585815, -1.3539167598278148, 8.232727188689926, -0.7148732040137205, 18.461850986125746, 36.08891636347831, 31.048983797229887, 32.013207835945956, 46.25015174105719, 26.316296051867017, 0.7123933506472326, 13.24485599863269, 13.226314198074444, 35.7365791397988, 44.97978661565087, 34.998240289806034, 19.369507027196605, 14.370036861879154, 11.014900982467152, 14.253325279695218, 18.33059221617027, 17.1285971047123, 16.889126517739946, 0.37610516911022795, 9.476939596976074, 27.58857843847067, 21.53772506436733, -8.044534111971918, 19.67996258727806, 8.840413504376055, 7.646497156951778, 18.174449046507913, 10.088531667141192, 22.450006399451254, 32.24579533209815, 16.558954712362805, 25.084941612266853, 24.8515961990251, 27.600208544022337, 6.811116932603618, 13.041859905822495, 35.856410798855435, 46.40695335686611, -3.026891843966485, 21.48949920371927, 24.39441747184321, 34.52441928010764, 15.43886273505928, 27.389845937311453, 32.758113672017714, 39.99106459748724, 24.966312063321574, 31.96093830302342, 51.54938247079001, 31.29852697307045, 7.194093779617896, 21.727921276037605, 28.459865027226463, 31.604462502271844, 6.424595573677962, 3.050747585988664, 1.9312265719038617, 12.421377576326098, 29.451691364739887, 37.87257953508292, 24.865539827812725, 30.678067152518885, 38.51375369240614, 37.178080756192315, 25.537334109154624, 32.3837011442751, 18.82234041272048, 4.495160200027663, 23.35809901981284, 8.213398185709163, 9.125913711213144, 5.272400273537912, 10.98823465537775, 9.752138470084706, 15.022996452030519, 19.557220520123902, 17.497824369443798, 19.677651195097003, 6.631112582606482, 13.624487310582106, 11.730525233856993, 45.83858085778883, 5.026901544067478, 22.905350836839396, 4.242622078990074, 3.3310026120237013, 8.76114736839519, 7.009470456295219, 24.210557986988675, 17.81871853726513, 20.719012752158587, 15.215880306886504, 18.3090735250006, 13.161967500421053, 21.038298755727617, 26.20410466067876, 8.032478399975128, 14.571124818586188, 34.870602814378614, 7.138659876408532, 14.862557967367518, 17.00365031131669, 2.4067283027817528, 42.11391486279936, 23.656536589303194, 37.84454046567528, 5.937033978980687, 40.354130066043865, 7.872786764455032, 11.693492848375712, 44.27788326884404, 3.9308874240616607, 18.295206819100176, 24.62423286494797, 36.34433310419084, 53.17362474346637, 13.823522671905621, 5.9548800017138195, 42.61444792306304, 33.46583684576118, 26.916965935229463, 38.26549948444411, 32.04430376375642, 28.810102218766048, 14.643348269931291, 18.760724882227258, 23.61666772132703, 25.53292956892742, 26.17692115229425, 1.3156080797601355, 18.150401886873386, 4.790552540292662]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38900316161270254, "mean_inference_ms": 0.9663737933720202, "mean_action_processing_ms": 0.16549845095837967, "mean_env_wait_ms": 0.05742966241034406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038309097290039062, "StateBufferConnector_ms": 0.0026727914810180664, "ViewRequirementAgentConnector_ms": 0.07371294498443604}, "num_episodes": 36, "episode_return_max": 181.43426941534443, "episode_return_min": 12.16285644635802, "episode_return_mean": 84.27890682152002}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.0164558349173, "num_env_steps_trained_throughput_per_sec": 503.0164558349173, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 1632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1632000, "timers": {"training_iteration_time_ms": 8870.467, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8870.421, "sample_time_ms": 892.996, "learn_time_ms": 7964.587, "learn_throughput": 502.223, "synch_weights_time_ms": 11.604}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "done": false, "training_iteration": 136, "trial_id": "eaa30_00000", "date": "2024-08-09_17-58-58", "timestamp": 1723240738, "time_this_iter_s": 7.956377983093262, "time_total_s": 1115.5638501644135, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x178023790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1115.5638501644135, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 25.141666666666666, "ram_util_percent": 83.10833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.736780336546519, "cur_kl_coeff": 0.10824403418228033, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.540861872264317, "policy_loss": -0.00238844974104453, "vf_loss": 7.542191088388837, "vf_explained_var": 0.035337216418886944, "kl": 0.00978562768213648, "entropy": 0.7316912076145253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.928637171660861, "cur_kl_coeff": 0.31244722496145777, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.481876268982887, "policy_loss": -0.0031327756953639136, "vf_loss": 8.483213861783346, "vf_explained_var": -0.08405071900536616, "kl": 0.005745654722462253, "entropy": 0.9548222505797942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 131040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000}, "env_runners": {"episode_reward_max": 188.11205381834336, "episode_reward_min": 8.334554082645498, "episode_reward_mean": 88.67551699529746, "episode_len_mean": 100.29, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10029, "policy_reward_min": {"agent_policy": 4.167277041322748, "adversary_policy": -8.044534111971918}, "policy_reward_max": {"agent_policy": 94.05602690917166, "adversary_policy": 57.26654287961959}, "policy_reward_mean": {"agent_policy": 44.33775849764873, "adversary_policy": 22.16887924882436}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.76987568869261, 65.16783499173096, 68.0354472449045, 19.706089532172594, 98.252607005676, 23.270856950612274, 32.97382132265567, 56.52596142729821, 109.39160346309882, 83.28779264925932, 104.90360948609491, 39.70595367685221, 164.52672831144304, 36.925214719505576, 117.8376735039017, 85.65741734474149, 145.49835653900993, 113.85450073268998, 165.69581888772092, 57.844030111311014, 120.1286550589966, 18.950686319333254, 28.70520829645993, 134.6485417996456, 111.08721396066323, 151.3836688971969, 115.84207050685947, 46.635001225496275, 63.142994411044015, 28.79662796950211, 41.48074625092491, 69.16043394430885, 74.3509511290816, 40.51119978637717, 115.13821218329164, 55.86450476181375, 15.147249382027551, 31.541235649380813, 84.0585530485076, 71.86978611809019, 62.94208205084331, 94.48480683281275, 45.20720643712263, 84.01852538157428, 63.7324165573684, 89.04128633116227, 123.00215410995693, 92.5823280900491, 39.132559225661495, 96.4175413858114, 85.8388793680963, 179.03591569531437, 39.55680534723891, 152.16056953764846, 130.3649308393471, 121.70881196504496, 66.80814630431712, 98.2991945805089, 54.985058464108775, 45.88190885433208, 36.69006273585107, 158.67272352074616, 118.09374176849091, 102.10725157628426, 108.99293401466831, 66.52956883937495, 90.82003776254041, 69.60137501633655, 186.01634614992966, 89.15843772849303, 142.06443425968894, 35.05879207053382, 132.72316069512112, 134.5582149961481, 121.19023741426862, 79.78441857431356, 76.89955073863294, 18.06595611894539, 182.41347169630816, 99.68058293859508, 180.7732398083694, 104.79583276802504, 101.42429919243789, 49.54424228894939, 156.22084598715833, 128.78461136118875, 125.96202348855519, 82.10782593866841, 8.334554082645498, 95.61645958173582, 73.973718799387, 88.55770638902582, 56.10200459209212, 70.7435353385824, 41.68000685420594, 104.16000721935578, 188.11205381834336, 97.88395302984185, 146.0664585904702, 94.11116013874411], "episode_lengths": [63, 77, 89, 63, 64, 66, 58, 85, 124, 106, 116, 80, 102, 200, 118, 67, 104, 83, 89, 65, 96, 33, 88, 131, 93, 113, 83, 47, 63, 49, 63, 67, 106, 53, 171, 110, 28, 32, 68, 61, 82, 125, 37, 149, 92, 165, 115, 153, 200, 177, 48, 118, 74, 112, 155, 126, 101, 160, 49, 122, 88, 75, 200, 101, 200, 72, 109, 57, 188, 156, 141, 77, 154, 122, 148, 82, 80, 114, 161, 55, 84, 159, 68, 72, 119, 159, 125, 64, 16, 67, 61, 64, 108, 102, 48, 135, 133, 114, 145, 72], "policy_agent_policy_reward": [25.384937844346307, 32.583917495865485, 34.017723622452245, 9.853044766086299, 49.126303502838, 11.635428475306139, 16.486910661327833, 28.262980713649103, 54.6958017315494, 41.64389632462966, 52.45180474304743, 19.852976838426112, 82.26336415572155, 18.462607359752784, 58.91883675195085, 42.82870867237074, 72.74917826950495, 56.92725036634499, 82.84790944386049, 28.922015055655503, 60.06432752949829, 9.475343159666625, 14.352604148229968, 67.3242708998228, 55.54360698033161, 75.69183444859847, 57.921035253429736, 23.31750061274814, 31.571497205522004, 14.398313984751058, 20.740373125462458, 34.58021697215442, 37.175475564540804, 20.255599893188588, 57.56910609164582, 27.932252380906874, 7.573624691013775, 15.770617824690408, 42.029276524253795, 35.934893059045095, 31.47104102542165, 47.242403416406376, 22.603603218561314, 42.00926269078715, 31.86620827868421, 44.520643165581106, 61.501077054978495, 46.29116404502455, 19.566279612830744, 48.2087706929057, 42.91943968404814, 89.51795784765721, 19.77840267361944, 76.08028476882421, 65.18246541967358, 60.854405982522465, 33.404073152158546, 49.14959729025445, 27.492529232054373, 22.940954427166048, 18.345031367925543, 79.33636176037311, 59.046870884245465, 51.053625788142114, 54.496467007334104, 33.26478441968747, 45.41001888127022, 34.800687508168274, 93.00817307496483, 44.57921886424651, 71.03221712984447, 17.529396035266913, 66.36158034756056, 67.27910749807405, 60.595118707134304, 39.89220928715677, 38.44977536931648, 9.032978059472697, 91.20673584815407, 49.84029146929753, 90.38661990418467, 52.3979163840125, 50.71214959621893, 24.772121144474696, 78.11042299357916, 64.39230568059438, 62.981011744277595, 41.053912969334206, 4.167277041322748, 47.808229790867884, 36.98685939969348, 44.27885319451289, 28.05100229604607, 35.371767669291216, 20.84000342710297, 52.08000360967789, 94.05602690917166, 48.941976514920924, 73.03322929523509, 47.05558006937208], "policy_adversary_policy_reward": [14.370036861879154, 11.014900982467152, 14.253325279695218, 18.33059221617027, 17.1285971047123, 16.889126517739946, 0.37610516911022795, 9.476939596976074, 27.58857843847067, 21.53772506436733, -8.044534111971918, 19.67996258727806, 8.840413504376055, 7.646497156951778, 18.174449046507913, 10.088531667141192, 22.450006399451254, 32.24579533209815, 16.558954712362805, 25.084941612266853, 24.8515961990251, 27.600208544022337, 6.811116932603618, 13.041859905822495, 35.856410798855435, 46.40695335686611, -3.026891843966485, 21.48949920371927, 24.39441747184321, 34.52441928010764, 15.43886273505928, 27.389845937311453, 32.758113672017714, 39.99106459748724, 24.966312063321574, 31.96093830302342, 51.54938247079001, 31.29852697307045, 7.194093779617896, 21.727921276037605, 28.459865027226463, 31.604462502271844, 6.424595573677962, 3.050747585988664, 1.9312265719038617, 12.421377576326098, 29.451691364739887, 37.87257953508292, 24.865539827812725, 30.678067152518885, 38.51375369240614, 37.178080756192315, 25.537334109154624, 32.3837011442751, 18.82234041272048, 4.495160200027663, 23.35809901981284, 8.213398185709163, 9.125913711213144, 5.272400273537912, 10.98823465537775, 9.752138470084706, 15.022996452030519, 19.557220520123902, 17.497824369443798, 19.677651195097003, 6.631112582606482, 13.624487310582106, 11.730525233856993, 45.83858085778883, 5.026901544067478, 22.905350836839396, 4.242622078990074, 3.3310026120237013, 8.76114736839519, 7.009470456295219, 24.210557986988675, 17.81871853726513, 20.719012752158587, 15.215880306886504, 18.3090735250006, 13.161967500421053, 21.038298755727617, 26.20410466067876, 8.032478399975128, 14.571124818586188, 34.870602814378614, 7.138659876408532, 14.862557967367518, 17.00365031131669, 2.4067283027817528, 42.11391486279936, 23.656536589303194, 37.84454046567528, 5.937033978980687, 40.354130066043865, 7.872786764455032, 11.693492848375712, 44.27788326884404, 3.9308874240616607, 18.295206819100176, 24.62423286494797, 36.34433310419084, 53.17362474346637, 13.823522671905621, 5.9548800017138195, 42.61444792306304, 33.46583684576118, 26.916965935229463, 38.26549948444411, 32.04430376375642, 28.810102218766048, 14.643348269931291, 18.760724882227258, 23.61666772132703, 25.53292956892742, 26.17692115229425, 1.3156080797601355, 18.150401886873386, 4.790552540292662, 2.247768103393671, 16.09726326453187, 36.427557134743445, 42.90880462562966, 40.017244423475546, 19.02962646076991, 27.580698313552222, 23.472927474589888, 40.450010608354965, 14.046456398979146, 16.223418055613525, 17.04136636407394, 17.380984119682516, 28.029034761587706, 23.201660637447304, 11.599026870720973, 57.26654287961959, 35.741630195345245, 23.01254263845164, 21.566676225794875, 33.01604360998843, 38.016173519856046, 12.625019777491156, 4.9043762577757555, 27.86764191261935, 38.49393843494121, 23.80926443207862, 43.469843065995434, 39.850757660341344, 20.744361046792953, 16.633757936038208, 23.258451351118566, 21.23079001209, 17.218985357226465, 7.735149480978226, 1.297828578494471, 47.593907793262204, 43.61282805489187, 19.069643934125693, 30.770647535171843, 45.01075374114988, 45.375866163034836, 30.02359871400501, 22.374317670007486, 16.627685723540857, 34.08446387267808, 19.472521044523198, 5.299600099951498, 38.02242758326241, 40.08799541031675, 21.629237085729244, 42.76306859486513, 22.033873720602834, 40.94713802367476, 18.776449613546404, 22.277463355787802, 5.41793657981149, -1.2506595384887405, 31.896795917094412, 15.911433873773479, 10.717976185052386, 26.2688832146411, 22.471495613388125, 21.80735758112476, 11.961573102825248, 16.089429193220823, 13.218349136053632, 22.153418533237577, 13.206049836590008, 7.633953590512959, 19.532619025049883, 32.547384584628006, 46.72519020089032, 47.33083670828136, 29.485226643008453, 19.456749871912475, 37.092305228036786, 35.9409240671983, 8.342431163309971, 38.71314890606211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38912471448628183, "mean_inference_ms": 0.9666521907840884, "mean_action_processing_ms": 0.16539751601266733, "mean_env_wait_ms": 0.05740440505085113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033262968063354492, "StateBufferConnector_ms": 0.0023688077926635742, "ViewRequirementAgentConnector_ms": 0.06554114818572998}, "num_episodes": 40, "episode_return_max": 188.11205381834336, "episode_return_min": 8.334554082645498, "episode_return_mean": 88.67551699529746}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 506.81905581281677, "num_env_steps_trained_throughput_per_sec": 506.81905581281677, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 1644000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1644000, "timers": {"training_iteration_time_ms": 8865.326, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8865.28, "sample_time_ms": 887.903, "learn_time_ms": 7964.546, "learn_throughput": 502.226, "synch_weights_time_ms": 11.591}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000}, "done": false, "training_iteration": 137, "trial_id": "eaa30_00000", "date": "2024-08-09_17-59-06", "timestamp": 1723240746, "time_this_iter_s": 7.897408962249756, "time_total_s": 1123.4612591266632, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x178023af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1123.4612591266632, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 24.63636363636364, "ram_util_percent": 83.08181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.3964152680503, "cur_kl_coeff": 0.10824403418228033, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.126714585571693, "policy_loss": -0.0033656317425310297, "vf_loss": 7.128558103874247, "vf_explained_var": -0.05122030317467987, "kl": 0.014062002456436554, "entropy": 0.7214147317031073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.059316013629238, "cur_kl_coeff": 0.31244722496145777, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.562321204443773, "policy_loss": -0.0024197696897317656, "vf_loss": 8.56344769547383, "vf_explained_var": 0.01408424594750007, "kl": 0.004139130458982739, "entropy": 0.9433292437965671, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000}, "env_runners": {"episode_reward_max": 188.11205381834336, "episode_reward_min": -9.42450482377756, "episode_reward_mean": 91.7181456855663, "episode_len_mean": 103.44, "episode_media": {}, "episodes_this_iter": 44, "episodes_timesteps_total": 10344, "policy_reward_min": {"agent_policy": -4.71225241188878, "adversary_policy": -6.895935247350014}, "policy_reward_max": {"agent_policy": 94.05602690917166, "adversary_policy": 57.26654287961959}, "policy_reward_mean": {"agent_policy": 45.85907284278315, "adversary_policy": 22.92953642139158}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.7324165573684, 89.04128633116227, 123.00215410995693, 92.5823280900491, 39.132559225661495, 96.4175413858114, 85.8388793680963, 179.03591569531437, 39.55680534723891, 152.16056953764846, 130.3649308393471, 121.70881196504496, 66.80814630431712, 98.2991945805089, 54.985058464108775, 45.88190885433208, 36.69006273585107, 158.67272352074616, 118.09374176849091, 102.10725157628426, 108.99293401466831, 66.52956883937495, 90.82003776254041, 69.60137501633655, 186.01634614992966, 89.15843772849303, 142.06443425968894, 35.05879207053382, 132.72316069512112, 134.5582149961481, 121.19023741426862, 79.78441857431356, 76.89955073863294, 18.06595611894539, 182.41347169630816, 99.68058293859508, 180.7732398083694, 104.79583276802504, 101.42429919243789, 49.54424228894939, 156.22084598715833, 128.78461136118875, 125.96202348855519, 82.10782593866841, 8.334554082645498, 95.61645958173582, 73.973718799387, 88.55770638902582, 56.10200459209212, 70.7435353385824, 41.68000685420594, 104.16000721935578, 188.11205381834336, 97.88395302984185, 146.0664585904702, 94.11116013874411, 119.49665983742338, 20.612531851009148, 24.887501036481783, 65.65815639188696, 139.37148885425938, 37.61769497627152, 87.72505866392679, 28.044982618164667, 29.85689059044268, 125.19667296962896, 76.57368435330578, 98.97058248491577, 61.969661977406275, 98.90112666462328, 70.45034104104683, 55.714776904539235, 102.64007336300332, 117.22708656351945, 143.07631827469947, 19.83007099672627, 121.75755474834696, 81.53603366748388, 140.92722984670326, 121.36906787352535, 12.709307401414936, 176.03369823798795, 181.45587966949472, 60.91492650855019, 110.16605326870847, 91.97017161405847, 137.7001235321651, 130.65264910508517, 37.3868568695001, 92.93279098986866, -9.42450482377756, 35.61209073202024, 127.78758890906565, 21.565893441029615, 45.75376601227677, 79.88513307949589, 40.76168662601125, 73.69379179373558, 35.23048359703198, 176.9905909045486], "episode_lengths": [92, 165, 115, 153, 200, 177, 48, 118, 74, 112, 155, 126, 101, 160, 49, 122, 88, 75, 200, 101, 200, 72, 109, 57, 188, 156, 141, 77, 154, 122, 148, 82, 80, 114, 161, 55, 84, 159, 68, 72, 119, 159, 125, 64, 16, 67, 61, 64, 108, 102, 48, 135, 133, 114, 145, 72, 100, 29, 16, 69, 84, 50, 68, 21, 65, 72, 80, 119, 76, 143, 75, 77, 156, 169, 83, 78, 91, 70, 131, 122, 62, 149, 161, 84, 64, 173, 84, 122, 75, 146, 19, 66, 128, 123, 84, 134, 52, 128, 52, 132], "policy_agent_policy_reward": [31.86620827868421, 44.520643165581106, 61.501077054978495, 46.29116404502455, 19.566279612830744, 48.2087706929057, 42.91943968404814, 89.51795784765721, 19.77840267361944, 76.08028476882421, 65.18246541967358, 60.854405982522465, 33.404073152158546, 49.14959729025445, 27.492529232054373, 22.940954427166048, 18.345031367925543, 79.33636176037311, 59.046870884245465, 51.053625788142114, 54.496467007334104, 33.26478441968747, 45.41001888127022, 34.800687508168274, 93.00817307496483, 44.57921886424651, 71.03221712984447, 17.529396035266913, 66.36158034756056, 67.27910749807405, 60.595118707134304, 39.89220928715677, 38.44977536931648, 9.032978059472697, 91.20673584815407, 49.84029146929753, 90.38661990418467, 52.3979163840125, 50.71214959621893, 24.772121144474696, 78.11042299357916, 64.39230568059438, 62.981011744277595, 41.053912969334206, 4.167277041322748, 47.808229790867884, 36.98685939969348, 44.27885319451289, 28.05100229604607, 35.371767669291216, 20.84000342710297, 52.08000360967789, 94.05602690917166, 48.941976514920924, 73.03322929523509, 47.05558006937208, 59.74832991871167, 10.306265925504574, 12.44375051824089, 32.82907819594348, 69.68574442712963, 18.808847488135765, 43.862529331963394, 14.022491309082334, 14.928445295221344, 62.59833648481448, 38.286842176652904, 49.48529124245789, 30.984830988703138, 49.450563332311646, 35.22517052052342, 27.857388452269618, 51.32003668150166, 58.61354328175973, 71.53815913734972, 9.915035498363135, 60.87877737417349, 40.76801683374194, 70.46361492335163, 60.68453393676266, 6.3546537007074715, 88.01684911899397, 90.72793983474735, 30.457463254275098, 55.08302663435422, 45.985085807029236, 68.85006176608253, 65.3263245525426, 18.693428434750054, 46.46639549493433, -4.71225241188878, 17.806045366010117, 63.89379445453283, 10.782946720514808, 22.87688300613838, 39.942566539747936, 20.380843313005624, 36.84689589686779, 17.61524179851599, 88.49529545227436], "policy_adversary_policy_reward": [14.862557967367518, 17.00365031131669, 2.4067283027817528, 42.11391486279936, 23.656536589303194, 37.84454046567528, 5.937033978980687, 40.354130066043865, 7.872786764455032, 11.693492848375712, 44.27788326884404, 3.9308874240616607, 18.295206819100176, 24.62423286494797, 36.34433310419084, 53.17362474346637, 13.823522671905621, 5.9548800017138195, 42.61444792306304, 33.46583684576118, 26.916965935229463, 38.26549948444411, 32.04430376375642, 28.810102218766048, 14.643348269931291, 18.760724882227258, 23.61666772132703, 25.53292956892742, 26.17692115229425, 1.3156080797601355, 18.150401886873386, 4.790552540292662, 2.247768103393671, 16.09726326453187, 36.427557134743445, 42.90880462562966, 40.017244423475546, 19.02962646076991, 27.580698313552222, 23.472927474589888, 40.450010608354965, 14.046456398979146, 16.223418055613525, 17.04136636407394, 17.380984119682516, 28.029034761587706, 23.201660637447304, 11.599026870720973, 57.26654287961959, 35.741630195345245, 23.01254263845164, 21.566676225794875, 33.01604360998843, 38.016173519856046, 12.625019777491156, 4.9043762577757555, 27.86764191261935, 38.49393843494121, 23.80926443207862, 43.469843065995434, 39.850757660341344, 20.744361046792953, 16.633757936038208, 23.258451351118566, 21.23079001209, 17.218985357226465, 7.735149480978226, 1.297828578494471, 47.593907793262204, 43.61282805489187, 19.069643934125693, 30.770647535171843, 45.01075374114988, 45.375866163034836, 30.02359871400501, 22.374317670007486, 16.627685723540857, 34.08446387267808, 19.472521044523198, 5.299600099951498, 38.02242758326241, 40.08799541031675, 21.629237085729244, 42.76306859486513, 22.033873720602834, 40.94713802367476, 18.776449613546404, 22.277463355787802, 5.41793657981149, -1.2506595384887405, 31.896795917094412, 15.911433873773479, 10.717976185052386, 26.2688832146411, 22.471495613388125, 21.80735758112476, 11.961573102825248, 16.089429193220823, 13.218349136053632, 22.153418533237577, 13.206049836590008, 7.633953590512959, 19.532619025049883, 32.547384584628006, 46.72519020089032, 47.33083670828136, 29.485226643008453, 19.456749871912475, 37.092305228036786, 35.9409240671983, 8.342431163309971, 38.71314890606211, 22.38662766748643, 37.36170225122524, -1.5833487805862294, 11.889614706090804, 7.009279634057198, 5.434470884183693, 14.959836482282732, 17.86924171366075, 40.04471296146171, 29.641031465667915, 8.470205379095995, 10.338642109039768, 13.868424483933474, 29.99410484802992, 8.878486704186965, 5.144004604895368, 3.4962157761610015, 11.432229519060343, 20.086100524856864, 42.51223595995763, 13.715430304391141, 24.57141187226175, 28.677386326030238, 20.807904916427653, 22.40406795940071, 8.580763029302421, 32.38957064639033, 17.060992685921317, 18.252084446679184, 16.973086073844243, -1.5344657516808304, 29.39185420395045, 32.429827370106274, 18.890209311395385, 10.43775018662002, 48.17579309513971, 45.69413353686739, 25.844025600482354, 1.843073963075966, 8.07196153528717, 27.366574083710184, 33.512203290463304, 26.162117429589635, 14.605899404152296, 33.665464716593206, 36.798150206758415, 34.0409031282612, 26.643630808501474, -2.109443808590166, 8.464097509297638, 43.49074298948829, 44.52610612950569, 38.35162097500146, 52.37631885974589, 19.992082673669607, 10.465380580605492, 22.48706956507801, 32.595957069276224, 37.3123014210459, 8.672784385983336, 43.96649898269349, 24.883562783389067, 26.972399424550908, 38.35392512799169, 13.34979155007105, 5.343636884679002, 11.114690558811304, 35.35170493612303, 2.183682835461233, -6.895935247350014, 4.074607681423261, 13.731437684586854, 31.917168632932416, 31.976625821600408, -4.255301287864604, 15.038248008379412, 14.4966554203495, 8.380227585788882, 25.830083457079088, 14.11248308266885, 16.023382566225933, 4.35746074677969, 13.468594521793818, 23.378301375073978, 5.167896937975058, 12.447344860540932, 33.591675119630594, 54.90362033264376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3890922655829058, "mean_inference_ms": 0.9665417606350085, "mean_action_processing_ms": 0.1654018110394394, "mean_env_wait_ms": 0.057402515454938935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003321528434753418, "StateBufferConnector_ms": 0.002349853515625, "ViewRequirementAgentConnector_ms": 0.06443262100219727}, "num_episodes": 44, "episode_return_max": 188.11205381834336, "episode_return_min": -9.42450482377756, "episode_return_mean": 91.7181456855663}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 512.1004728375206, "num_env_steps_trained_throughput_per_sec": 512.1004728375206, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 1656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1656000, "timers": {"training_iteration_time_ms": 8757.024, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8756.977, "sample_time_ms": 888.58, "learn_time_ms": 7855.332, "learn_throughput": 509.208, "synch_weights_time_ms": 11.83}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000}, "done": false, "training_iteration": 138, "trial_id": "eaa30_00000", "date": "2024-08-09_17-59-14", "timestamp": 1723240754, "time_this_iter_s": 7.816059112548828, "time_total_s": 1131.277318239212, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x178023e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1131.277318239212, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 22.59166666666667, "ram_util_percent": 82.21666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.278078158570345, "cur_kl_coeff": 0.10824403418228033, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.4385602166413, "policy_loss": -0.00026420666984031127, "vf_loss": 7.43718101107885, "vf_explained_var": 0.09352836318747706, "kl": 0.015182509143693896, "entropy": 0.7289980968154928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.505404062258701, "cur_kl_coeff": 0.15622361248072889, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.758413897951444, "policy_loss": -0.001360732692410238, "vf_loss": 8.758690420289835, "vf_explained_var": -0.004463180216650168, "kl": 0.00694013936445117, "entropy": 0.9440517590070764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000}, "env_runners": {"episode_reward_max": 184.50144413798142, "episode_reward_min": -9.42450482377756, "episode_reward_mean": 80.75351366951591, "episode_len_mean": 82.89, "episode_media": {}, "episodes_this_iter": 54, "episodes_timesteps_total": 8289, "policy_reward_min": {"agent_policy": -4.71225241188878, "adversary_policy": -10.64907739292232}, "policy_reward_max": {"agent_policy": 92.25072206899071, "adversary_policy": 54.90362033264376}, "policy_reward_mean": {"agent_policy": 40.37675683475796, "adversary_policy": 20.188378417378985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.0664585904702, 94.11116013874411, 119.49665983742338, 20.612531851009148, 24.887501036481783, 65.65815639188696, 139.37148885425938, 37.61769497627152, 87.72505866392679, 28.044982618164667, 29.85689059044268, 125.19667296962896, 76.57368435330578, 98.97058248491577, 61.969661977406275, 98.90112666462328, 70.45034104104683, 55.714776904539235, 102.64007336300332, 117.22708656351945, 143.07631827469947, 19.83007099672627, 121.75755474834696, 81.53603366748388, 140.92722984670326, 121.36906787352535, 12.709307401414936, 176.03369823798795, 181.45587966949472, 60.91492650855019, 110.16605326870847, 91.97017161405847, 137.7001235321651, 130.65264910508517, 37.3868568695001, 92.93279098986866, -9.42450482377756, 35.61209073202024, 127.78758890906565, 21.565893441029615, 45.75376601227677, 79.88513307949589, 40.76168662601125, 73.69379179373558, 35.23048359703198, 176.9905909045486, 148.01476249623272, 11.697945823208963, 44.64244186873582, 52.06113775615722, 93.42189943079906, 116.55471939694849, 27.98308056858724, 31.95846680602476, 6.493223360428209, 12.731497845212964, 162.09158028454178, 77.82332309236378, 53.144281271819324, 84.15527340624281, 160.31926271068764, 77.83724370928222, 43.569514037518616, 31.63993564498361, 121.21524846010766, 4.464606492974042, 74.75380848023147, 43.50056779039372, 101.0825403930578, 136.7073083488179, 32.48395504325072, 122.36784557568537, 66.09457232433255, 39.59316315400032, 118.61641907174143, 165.97163842100503, 16.737791741044216, 70.93741703333309, 95.0913715179322, 25.34529532079199, 145.68729591370382, 184.50144413798142, 116.82570811376831, 97.62359228557968, 81.34263492823777, 59.48277267807805, 141.63117539649943, 97.2129885990386, 42.92779496358161, 176.61426175557074, 85.25797866578684, 23.52619590920561, 53.39446199043957, 32.11251541065402, 49.6272972120567, 50.825176761517895, 58.30906161204628, 52.55269933619563, 118.0427517279095, 47.38257812844075], "episode_lengths": [145, 72, 100, 29, 16, 69, 84, 50, 68, 21, 65, 72, 80, 119, 76, 143, 75, 77, 156, 169, 83, 78, 91, 70, 131, 122, 62, 149, 161, 84, 64, 173, 84, 122, 75, 146, 19, 66, 128, 123, 84, 134, 52, 128, 52, 132, 108, 41, 83, 100, 55, 118, 29, 32, 10, 40, 118, 73, 91, 62, 68, 79, 31, 44, 122, 66, 67, 31, 100, 125, 39, 147, 84, 26, 108, 80, 74, 75, 87, 28, 119, 114, 76, 69, 51, 52, 81, 106, 99, 102, 69, 55, 49, 37, 67, 105, 59, 63, 98, 78], "policy_agent_policy_reward": [73.03322929523509, 47.05558006937208, 59.74832991871167, 10.306265925504574, 12.44375051824089, 32.82907819594348, 69.68574442712963, 18.808847488135765, 43.862529331963394, 14.022491309082334, 14.928445295221344, 62.59833648481448, 38.286842176652904, 49.48529124245789, 30.984830988703138, 49.450563332311646, 35.22517052052342, 27.857388452269618, 51.32003668150166, 58.61354328175973, 71.53815913734972, 9.915035498363135, 60.87877737417349, 40.76801683374194, 70.46361492335163, 60.68453393676266, 6.3546537007074715, 88.01684911899397, 90.72793983474735, 30.457463254275098, 55.08302663435422, 45.985085807029236, 68.85006176608253, 65.3263245525426, 18.693428434750054, 46.46639549493433, -4.71225241188878, 17.806045366010117, 63.89379445453283, 10.782946720514808, 22.87688300613838, 39.942566539747936, 20.380843313005624, 36.84689589686779, 17.61524179851599, 88.49529545227436, 74.00738124811636, 5.8489729116044815, 22.321220934367908, 26.030568878078622, 46.71094971539952, 58.277359698474264, 13.99154028429362, 15.979233403012378, 3.2466116802141034, 6.365748922606482, 81.04579014227087, 38.91166154618188, 26.572140635909662, 42.0776367031214, 80.1596313553438, 38.91862185464111, 21.784757018759297, 15.819967822491805, 60.607624230053844, 2.23230324648703, 37.376904240115735, 21.75028389519687, 50.541270196528885, 68.35365417440893, 16.24197752162536, 61.183922787842675, 33.047286162166266, 19.796581577000154, 59.3082095358707, 82.98581921050253, 8.368895870522108, 35.46870851666657, 47.545685758966094, 12.672647660395995, 72.8436479568519, 92.25072206899071, 58.41285405688419, 48.81179614278983, 40.671317464118864, 29.741386339039032, 70.81558769824977, 48.606494299519284, 21.463897481790806, 88.30713087778534, 42.62898933289343, 11.763097954602806, 26.697230995219783, 16.056257705327006, 24.81364860602835, 25.412588380758947, 29.15453080602314, 26.276349668097815, 59.02137586395475, 23.691289064220378], "policy_adversary_policy_reward": [37.092305228036786, 35.9409240671983, 8.342431163309971, 38.71314890606211, 22.38662766748643, 37.36170225122524, -1.5833487805862294, 11.889614706090804, 7.009279634057198, 5.434470884183693, 14.959836482282732, 17.86924171366075, 40.04471296146171, 29.641031465667915, 8.470205379095995, 10.338642109039768, 13.868424483933474, 29.99410484802992, 8.878486704186965, 5.144004604895368, 3.4962157761610015, 11.432229519060343, 20.086100524856864, 42.51223595995763, 13.715430304391141, 24.57141187226175, 28.677386326030238, 20.807904916427653, 22.40406795940071, 8.580763029302421, 32.38957064639033, 17.060992685921317, 18.252084446679184, 16.973086073844243, -1.5344657516808304, 29.39185420395045, 32.429827370106274, 18.890209311395385, 10.43775018662002, 48.17579309513971, 45.69413353686739, 25.844025600482354, 1.843073963075966, 8.07196153528717, 27.366574083710184, 33.512203290463304, 26.162117429589635, 14.605899404152296, 33.665464716593206, 36.798150206758415, 34.0409031282612, 26.643630808501474, -2.109443808590166, 8.464097509297638, 43.49074298948829, 44.52610612950569, 38.35162097500146, 52.37631885974589, 19.992082673669607, 10.465380580605492, 22.48706956507801, 32.595957069276224, 37.3123014210459, 8.672784385983336, 43.96649898269349, 24.883562783389067, 26.972399424550908, 38.35392512799169, 13.34979155007105, 5.343636884679002, 11.114690558811304, 35.35170493612303, 2.183682835461233, -6.895935247350014, 4.074607681423261, 13.731437684586854, 31.917168632932416, 31.976625821600408, -4.255301287864604, 15.038248008379412, 14.4966554203495, 8.380227585788882, 25.830083457079088, 14.11248308266885, 16.023382566225933, 4.35746074677969, 13.468594521793818, 23.378301375073978, 5.167896937975058, 12.447344860540932, 33.591675119630594, 54.90362033264376, 32.712426381454826, 41.29495486666154, 7.323264547095463, -1.4742916354909816, 10.781864322833776, 11.539356611534128, 29.12063926360297, -3.0900703855243528, 26.572368470153798, 20.138581245245742, 17.05399460724771, 41.22336509122657, 7.20237815114697, 6.789162133146651, 9.152746825938646, 6.826486577073734, 0.30565107552070714, 2.9409606046933963, 3.9335356496015237, 2.432213273004958, 47.6714461313216, 33.374344010949265, 20.326671117503334, 18.584990428678537, 0.15445783207424135, 26.417682803835422, 22.576367166053505, 19.501269537067913, 44.63630465701542, 35.523326698328376, 23.32595260616919, 15.592669248471918, 11.636043403091252, 10.148713615668045, 7.261410785245364, 8.558557037246441, 21.17238895316357, 39.435235276890275, 0.876655556148032, 1.3556476903389951, 25.303372127021092, 12.073532113094647, 8.271584252937577, 13.478699642259288, 4.564057847135711, 45.97721234939319, 30.369919474910684, 37.98373469949824, 17.111914341001714, -0.8699368193763561, 22.703204941321758, 38.48071784652092, 5.72775423147559, 27.319531930690673, 14.863348168356012, 4.933233408644141, 29.809117132415395, 29.499092403455304, 41.802606895121016, 41.183212315381496, -10.64907739292232, 19.01797326344443, 5.007962216876154, 30.460746299790408, 27.735733479811657, 19.80995227915444, 8.426810840302906, 4.245836820093089, 19.506350422797276, 53.33729753405463, 50.81203611428333, 41.43868595470735, 23.122304038409126, 35.29055001847506, 30.613127838887085, 18.198668303902743, 19.450038382838056, 21.22127908128081, 19.79830570297773, 9.943080636061298, 30.374483137003505, 40.441104561246256, 16.004187876473413, 32.602306423045874, 19.962239227659435, 1.5016582541313692, 43.364632564230405, 44.942498313554914, 20.06857513113175, 22.560414201761667, 3.1915023693900473, 8.571595585212759, 9.528737376000457, 17.168493619219326, 11.588412752195321, 4.467844953131685, 20.111903009850764, 4.701745596177588, 17.891625503205567, 7.52096287755338, 10.088413220929928, 19.06611758509321, 11.058216103349888, 15.218133564747939, 39.24381951728273, 19.77755634667203, 21.10639500623121, 2.5848940579891693]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38954259122529483, "mean_inference_ms": 0.9668746810772436, "mean_action_processing_ms": 0.1653838055380425, "mean_env_wait_ms": 0.057569463550841464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003617405891418457, "StateBufferConnector_ms": 0.0027593374252319336, "ViewRequirementAgentConnector_ms": 0.0797034502029419}, "num_episodes": 54, "episode_return_max": 184.50144413798142, "episode_return_min": -9.42450482377756, "episode_return_mean": 80.75351366951591}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 448.85020835804136, "num_env_steps_trained_throughput_per_sec": 448.85020835804136, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 1668000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1668000, "timers": {"training_iteration_time_ms": 8735.129, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8735.083, "sample_time_ms": 919.98, "learn_time_ms": 7802.712, "learn_throughput": 512.642, "synch_weights_time_ms": 11.282}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000}, "done": false, "training_iteration": 139, "trial_id": "eaa30_00000", "date": "2024-08-09_17-59-23", "timestamp": 1723240763, "time_this_iter_s": 8.916320085525513, "time_total_s": 1140.1936383247375, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x178023ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1140.1936383247375, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 33.08333333333332, "ram_util_percent": 82.70833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098649809726332, "cur_kl_coeff": 0.10824403418228033, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.597215424895917, "policy_loss": -0.00026778753886304833, "vf_loss": 7.5961727134765145, "vf_explained_var": 0.03413501848619451, "kl": 0.012106848151112596, "entropy": 0.7539738328999313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.8253241819640005, "cur_kl_coeff": 0.15622361248072889, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.780405850708485, "policy_loss": -0.005153276495305666, "vf_loss": 8.783577073117097, "vf_explained_var": 0.02186312365035216, "kl": 0.012687398729516039, "entropy": 0.9574297298366825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 133920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 184.50144413798142, "episode_reward_min": 4.464606492974042, "episode_reward_mean": 86.21925487684281, "episode_len_mean": 75.02, "episode_media": {}, "episodes_this_iter": 52, "episodes_timesteps_total": 7502, "policy_reward_min": {"agent_policy": 2.23230324648703, "adversary_policy": -10.64907739292232}, "policy_reward_max": {"agent_policy": 92.25072206899071, "adversary_policy": 54.59198846216693}, "policy_reward_mean": {"agent_policy": 43.10962743842142, "adversary_policy": 21.554813719210706}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.98308056858724, 31.95846680602476, 6.493223360428209, 12.731497845212964, 162.09158028454178, 77.82332309236378, 53.144281271819324, 84.15527340624281, 160.31926271068764, 77.83724370928222, 43.569514037518616, 31.63993564498361, 121.21524846010766, 4.464606492974042, 74.75380848023147, 43.50056779039372, 101.0825403930578, 136.7073083488179, 32.48395504325072, 122.36784557568537, 66.09457232433255, 39.59316315400032, 118.61641907174143, 165.97163842100503, 16.737791741044216, 70.93741703333309, 95.0913715179322, 25.34529532079199, 145.68729591370382, 184.50144413798142, 116.82570811376831, 97.62359228557968, 81.34263492823777, 59.48277267807805, 141.63117539649943, 97.2129885990386, 42.92779496358161, 176.61426175557074, 85.25797866578684, 23.52619590920561, 53.39446199043957, 32.11251541065402, 49.6272972120567, 50.825176761517895, 58.30906161204628, 52.55269933619563, 118.0427517279095, 47.38257812844075, 152.12399783191424, 147.1755588790109, 24.33083605716852, 101.24963423565094, 75.75970269439996, 146.98418274118558, 92.32976238432218, 51.66178886096845, 101.49584816675309, 96.3990174995436, 87.24071497381391, 33.396693083877544, 128.29149894056326, 148.73731605495766, 32.03329035040019, 43.35092259654195, 18.390916934393477, 76.004279376603, 75.72784039329133, 63.763437035092366, 108.62930559775293, 42.3332294445128, 91.26141149801339, 35.88678881918223, 174.8354593724773, 104.500011359314, 151.91568108827303, 91.66555699878717, 115.02883226480236, 118.28365650966668, 76.85903613037468, 108.592557589559, 102.80816495584519, 145.6242852428734, 99.34835785479137, 4.954356583826629, 51.55504628277858, 90.92640184334533, 129.60499862762862, 64.17812818756607, 135.02321762665022, 78.09690679797362, 84.48878633567956, 39.567990842639176, 91.86184363880217, 101.73747898755067, 83.89834899731787, 100.83320506546315, 134.0535986307952, 148.89463704581922, 164.80275076245286, 133.8376001786317], "episode_lengths": [29, 32, 10, 40, 118, 73, 91, 62, 68, 79, 31, 44, 122, 66, 67, 31, 100, 125, 39, 147, 84, 26, 108, 80, 74, 75, 87, 28, 119, 114, 76, 69, 51, 52, 81, 106, 99, 102, 69, 55, 49, 37, 67, 105, 59, 63, 98, 78, 126, 75, 44, 87, 66, 89, 83, 51, 83, 73, 45, 67, 77, 82, 63, 42, 25, 65, 119, 77, 122, 91, 81, 124, 100, 77, 85, 68, 103, 82, 34, 100, 84, 115, 69, 11, 30, 134, 92, 45, 104, 49, 90, 60, 42, 76, 89, 46, 103, 74, 84, 114], "policy_agent_policy_reward": [13.99154028429362, 15.979233403012378, 3.2466116802141034, 6.365748922606482, 81.04579014227087, 38.91166154618188, 26.572140635909662, 42.0776367031214, 80.1596313553438, 38.91862185464111, 21.784757018759297, 15.819967822491805, 60.607624230053844, 2.23230324648703, 37.376904240115735, 21.75028389519687, 50.541270196528885, 68.35365417440893, 16.24197752162536, 61.183922787842675, 33.047286162166266, 19.796581577000154, 59.3082095358707, 82.98581921050253, 8.368895870522108, 35.46870851666657, 47.545685758966094, 12.672647660395995, 72.8436479568519, 92.25072206899071, 58.41285405688419, 48.81179614278983, 40.671317464118864, 29.741386339039032, 70.81558769824977, 48.606494299519284, 21.463897481790806, 88.30713087778534, 42.62898933289343, 11.763097954602806, 26.697230995219783, 16.056257705327006, 24.81364860602835, 25.412588380758947, 29.15453080602314, 26.276349668097815, 59.02137586395475, 23.691289064220378, 76.06199891595709, 73.5877794395055, 12.16541802858426, 50.62481711782547, 37.8798513472, 73.49209137059285, 46.16488119216109, 25.830894430484232, 50.74792408337653, 48.19950874977179, 43.62035748690695, 16.69834654193878, 64.14574947028163, 74.3686580274788, 16.016645175200097, 21.67546129827098, 9.195458467196739, 38.0021396883015, 37.863920196645665, 31.88171851754619, 54.31465279887647, 21.1666147222564, 45.6307057490067, 17.943394409591114, 87.41772968623863, 52.25000567965698, 75.95784054413652, 45.83277849939359, 57.5144161324012, 59.141828254833314, 38.42951806518734, 54.296278794779525, 51.4040824779226, 72.81214262143668, 49.67417892739571, 2.4771782919133147, 25.777523141389285, 45.463200921672666, 64.80249931381428, 32.08906409378302, 67.51160881332513, 39.048453398986794, 42.24439316783978, 19.783995421319588, 45.930921819401085, 50.86873949377536, 41.949174498658934, 50.4166025327316, 67.02679931539762, 74.44731852290964, 82.40137538122647, 66.91880008931584], "policy_adversary_policy_reward": [7.20237815114697, 6.789162133146651, 9.152746825938646, 6.826486577073734, 0.30565107552070714, 2.9409606046933963, 3.9335356496015237, 2.432213273004958, 47.6714461313216, 33.374344010949265, 20.326671117503334, 18.584990428678537, 0.15445783207424135, 26.417682803835422, 22.576367166053505, 19.501269537067913, 44.63630465701542, 35.523326698328376, 23.32595260616919, 15.592669248471918, 11.636043403091252, 10.148713615668045, 7.261410785245364, 8.558557037246441, 21.17238895316357, 39.435235276890275, 0.876655556148032, 1.3556476903389951, 25.303372127021092, 12.073532113094647, 8.271584252937577, 13.478699642259288, 4.564057847135711, 45.97721234939319, 30.369919474910684, 37.98373469949824, 17.111914341001714, -0.8699368193763561, 22.703204941321758, 38.48071784652092, 5.72775423147559, 27.319531930690673, 14.863348168356012, 4.933233408644141, 29.809117132415395, 29.499092403455304, 41.802606895121016, 41.183212315381496, -10.64907739292232, 19.01797326344443, 5.007962216876154, 30.460746299790408, 27.735733479811657, 19.80995227915444, 8.426810840302906, 4.245836820093089, 19.506350422797276, 53.33729753405463, 50.81203611428333, 41.43868595470735, 23.122304038409126, 35.29055001847506, 30.613127838887085, 18.198668303902743, 19.450038382838056, 21.22127908128081, 19.79830570297773, 9.943080636061298, 30.374483137003505, 40.441104561246256, 16.004187876473413, 32.602306423045874, 19.962239227659435, 1.5016582541313692, 43.364632564230405, 44.942498313554914, 20.06857513113175, 22.560414201761667, 3.1915023693900473, 8.571595585212759, 9.528737376000457, 17.168493619219326, 11.588412752195321, 4.467844953131685, 20.111903009850764, 4.701745596177588, 17.891625503205567, 7.52096287755338, 10.088413220929928, 19.06611758509321, 11.058216103349888, 15.218133564747939, 39.24381951728273, 19.77755634667203, 21.10639500623121, 2.5848940579891693, 45.95342127044046, 30.108577645516654, 32.21487364577858, 41.3729057937269, 6.790977302860055, 5.374440725724206, 28.92026599624036, 21.704551121585116, 21.204679547557433, 16.67517179964256, 27.840203407372808, 45.65188796322002, 20.795124712028453, 25.36975648013264, 7.085357795846268, 18.74553663463796, 40.32722216752302, 10.42070191585351, 21.59975310027357, 26.599755649498228, 27.366679720470984, 16.25367776643596, 0.4400333885893666, 16.258313153349413, 44.00986804108859, 20.13588142919304, 30.939557771717688, 43.42910025576112, 6.373439145327006, 9.643206029873092, 20.754316323369334, 0.9211449749016474, 1.8257766341819348, 7.369681833014804, 15.475058436204431, 22.527081252097062, 21.256204478381985, 16.607715718263684, 17.95322755027594, 13.92849096727025, 30.329839024235184, 23.984813774641296, 11.201286980898477, 9.965327741357925, 26.863098498384545, 18.767607250622156, 14.38964737523142, 3.5537470343596915, 34.976673627654534, 52.44105605858412, 27.43729327851505, 24.81271240114194, 27.146270940307392, 48.81156960382914, 17.687781055834808, 28.144997443558797, 19.61285722871083, 37.901558903690365, 22.66672826999414, 36.475099984839204, 13.788258634068253, 24.64125943111908, 20.41253962259716, 33.88373917218235, 43.281204712087785, 8.122877765834815, 47.3764328900379, 25.435709731398767, 35.25336779171591, 14.420811135679806, 0.40827171383625327, 2.0689065780770615, 12.429368432885346, 13.348154708503937, 19.687638811120745, 25.775562110551924, 31.91986981149195, 32.882629502322345, 14.806324581979549, 17.282739511803477, 45.646812701283565, 21.864796112041567, 10.247993389418992, 28.800460009567804, 6.276613345321608, 35.967779822518175, 6.742579842197516, 13.04141557912207, 24.113198659880737, 21.817723159520362, 32.74631581642153, 18.122423677353833, 25.646469768365, 16.30270473029393, 16.353859560406754, 34.06274297232483, 35.07034809342021, 31.95645122197741, 49.6073693031166, 24.83994921979305, 54.59198846216693, 27.809386919059513, 20.258529070821695, 46.66027101849415]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3896644780647624, "mean_inference_ms": 0.9652347778509573, "mean_action_processing_ms": 0.16574797394583615, "mean_env_wait_ms": 0.05756083875958121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00353240966796875, "StateBufferConnector_ms": 0.0027042627334594727, "ViewRequirementAgentConnector_ms": 0.08263349533081055}, "num_episodes": 52, "episode_return_max": 184.50144413798142, "episode_return_min": 4.464606492974042, "episode_return_mean": 86.21925487684281}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 514.9835824046155, "num_env_steps_trained_throughput_per_sec": 514.9835824046155, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 8622.29, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8622.244, "sample_time_ms": 911.513, "learn_time_ms": 7698.355, "learn_throughput": 519.591, "synch_weights_time_ms": 11.221}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 140, "trial_id": "eaa30_00000", "date": "2024-08-09_17-59-31", "timestamp": 1723240771, "time_this_iter_s": 7.771238803863525, "time_total_s": 1147.964877128601, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17809ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1147.964877128601, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 24.058333333333326, "ram_util_percent": 81.48333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.116433128099592, "cur_kl_coeff": 0.10824403418228033, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.557522217684952, "policy_loss": 0.005606028986059957, "vf_loss": 7.549666909566001, "vf_explained_var": 0.055429437425401476, "kl": 0.020779613318246983, "entropy": 0.7848712755889489, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.569976895302534, "cur_kl_coeff": 0.15622361248072889, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.734451961020628, "policy_loss": 0.005840889433360038, "vf_loss": 8.724890360236168, "vf_explained_var": -0.023328339184323945, "kl": 0.023816640929241354, "entropy": 0.927725353402396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 134880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000}, "env_runners": {"episode_reward_max": 202.70521939199972, "episode_reward_min": 2.685149403555421, "episode_reward_mean": 94.57751580685031, "episode_len_mean": 76.11, "episode_media": {}, "episodes_this_iter": 54, "episodes_timesteps_total": 7611, "policy_reward_min": {"agent_policy": 1.3425747017777105, "adversary_policy": -4.992019484577392}, "policy_reward_max": {"agent_policy": 101.35260969599985, "adversary_policy": 57.290941333423255}, "policy_reward_mean": {"agent_policy": 47.28875790342516, "adversary_policy": 23.64437895171258}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.32976238432218, 51.66178886096845, 101.49584816675309, 96.3990174995436, 87.24071497381391, 33.396693083877544, 128.29149894056326, 148.73731605495766, 32.03329035040019, 43.35092259654195, 18.390916934393477, 76.004279376603, 75.72784039329133, 63.763437035092366, 108.62930559775293, 42.3332294445128, 91.26141149801339, 35.88678881918223, 174.8354593724773, 104.500011359314, 151.91568108827303, 91.66555699878717, 115.02883226480236, 118.28365650966668, 76.85903613037468, 108.592557589559, 102.80816495584519, 145.6242852428734, 99.34835785479137, 4.954356583826629, 51.55504628277858, 90.92640184334533, 129.60499862762862, 64.17812818756607, 135.02321762665022, 78.09690679797362, 84.48878633567956, 39.567990842639176, 91.86184363880217, 101.73747898755067, 83.89834899731787, 100.83320506546315, 134.0535986307952, 148.89463704581922, 164.80275076245286, 133.8376001786317, 71.78055910883882, 93.82824409188689, 160.35958207237098, 41.549074870500306, 138.93825902263177, 165.40707173131943, 124.07638153217744, 143.2032525317881, 69.11565297377685, 90.38617695182548, 104.50148926852194, 38.660100032039374, 52.036075574511294, 79.72082412757042, 183.36568514785404, 118.84261689328302, 75.4841405146611, 31.911896786836035, 77.77403297536335, 155.555510098152, 104.0647714629383, 18.31157554839916, 71.31981523619736, 77.69359828801288, 77.22768553001764, 93.27409854414879, 144.89536772531292, 87.6539070667142, 116.09113911582257, 198.8512798332314, 76.33808362420946, 70.66746165978314, 111.68847668222858, 133.8913610008024, 84.89406574432036, 49.79519993053742, 121.09018718298844, 172.8835330536788, 69.25889158367238, 48.123738192999156, 68.64299667135047, 202.70521939199972, 45.85920129680753, 142.56523239203142, 89.57387762130776, 80.4689669779381, 123.38686800512514, 117.44702260682075, 51.510894714149494, 123.39851255556536, 79.04242685787229, 2.685149403555421, 89.15585636519015, 42.0875347011258], "episode_lengths": [83, 51, 83, 73, 45, 67, 77, 82, 63, 42, 25, 65, 119, 77, 122, 91, 81, 124, 100, 77, 85, 68, 103, 82, 34, 100, 84, 115, 69, 11, 30, 134, 92, 45, 104, 49, 90, 60, 42, 76, 89, 46, 103, 74, 84, 114, 97, 71, 94, 53, 112, 126, 89, 80, 64, 81, 73, 90, 60, 130, 76, 87, 65, 57, 45, 89, 58, 44, 43, 66, 76, 77, 106, 55, 79, 102, 103, 70, 94, 103, 57, 56, 91, 97, 48, 82, 44, 78, 68, 88, 62, 77, 71, 79, 84, 77, 96, 2, 55, 54], "policy_agent_policy_reward": [46.16488119216109, 25.830894430484232, 50.74792408337653, 48.19950874977179, 43.62035748690695, 16.69834654193878, 64.14574947028163, 74.3686580274788, 16.016645175200097, 21.67546129827098, 9.195458467196739, 38.0021396883015, 37.863920196645665, 31.88171851754619, 54.31465279887647, 21.1666147222564, 45.6307057490067, 17.943394409591114, 87.41772968623863, 52.25000567965698, 75.95784054413652, 45.83277849939359, 57.5144161324012, 59.141828254833314, 38.42951806518734, 54.296278794779525, 51.4040824779226, 72.81214262143668, 49.67417892739571, 2.4771782919133147, 25.777523141389285, 45.463200921672666, 64.80249931381428, 32.08906409378302, 67.51160881332513, 39.048453398986794, 42.24439316783978, 19.783995421319588, 45.930921819401085, 50.86873949377536, 41.949174498658934, 50.4166025327316, 67.02679931539762, 74.44731852290964, 82.40137538122647, 66.91880008931584, 35.89027955441939, 46.91412204594347, 80.17979103618548, 20.774537435250153, 69.46912951131586, 82.70353586565975, 62.03819076608873, 71.60162626589405, 34.557826486888416, 45.193088475912724, 52.25074463426101, 19.330050016019683, 26.01803778725565, 39.860412063785205, 91.68284257392693, 59.42130844664155, 37.74207025733057, 15.955948393418018, 38.88701648768166, 77.77775504907605, 52.03238573146915, 9.155787774199577, 35.65990761809868, 38.84679914400644, 38.61384276500882, 46.637049272074385, 72.44768386265649, 43.826953533357084, 58.045569557911286, 99.42563991661574, 38.169041812104744, 35.33373082989157, 55.84423834111427, 66.9456805004012, 42.44703287216018, 24.897599965268714, 60.545093591494236, 86.44176652683942, 34.62944579183621, 24.061869096499574, 34.321498335675244, 101.35260969599985, 22.929600648403756, 71.28261619601574, 44.78693881065388, 40.23448348896904, 61.69343400256256, 58.723511303410376, 25.755447357074743, 61.699256277782666, 39.52121342893613, 1.3425747017777105, 44.577928182595095, 21.043767350562902], "policy_adversary_policy_reward": [20.795124712028453, 25.36975648013264, 7.085357795846268, 18.74553663463796, 40.32722216752302, 10.42070191585351, 21.59975310027357, 26.599755649498228, 27.366679720470984, 16.25367776643596, 0.4400333885893666, 16.258313153349413, 44.00986804108859, 20.13588142919304, 30.939557771717688, 43.42910025576112, 6.373439145327006, 9.643206029873092, 20.754316323369334, 0.9211449749016474, 1.8257766341819348, 7.369681833014804, 15.475058436204431, 22.527081252097062, 21.256204478381985, 16.607715718263684, 17.95322755027594, 13.92849096727025, 30.329839024235184, 23.984813774641296, 11.201286980898477, 9.965327741357925, 26.863098498384545, 18.767607250622156, 14.38964737523142, 3.5537470343596915, 34.976673627654534, 52.44105605858412, 27.43729327851505, 24.81271240114194, 27.146270940307392, 48.81156960382914, 17.687781055834808, 28.144997443558797, 19.61285722871083, 37.901558903690365, 22.66672826999414, 36.475099984839204, 13.788258634068253, 24.64125943111908, 20.41253962259716, 33.88373917218235, 43.281204712087785, 8.122877765834815, 47.3764328900379, 25.435709731398767, 35.25336779171591, 14.420811135679806, 0.40827171383625327, 2.0689065780770615, 12.429368432885346, 13.348154708503937, 19.687638811120745, 25.775562110551924, 31.91986981149195, 32.882629502322345, 14.806324581979549, 17.282739511803477, 45.646812701283565, 21.864796112041567, 10.247993389418992, 28.800460009567804, 6.276613345321608, 35.967779822518175, 6.742579842197516, 13.04141557912207, 24.113198659880737, 21.817723159520362, 32.74631581642153, 18.122423677353833, 25.646469768365, 16.30270473029393, 16.353859560406754, 34.06274297232483, 35.07034809342021, 31.95645122197741, 49.6073693031166, 24.83994921979305, 54.59198846216693, 27.809386919059513, 20.258529070821695, 46.66027101849415, 20.810412648650498, 15.079866905768894, 24.6707903640518, 22.24333168189166, 42.058324369170634, 38.12146666701484, 7.104078577569663, 13.67045885768049, 28.628758826984683, 40.840370684331184, 41.558291289475434, 41.1452445761843, 11.037990551835309, 51.00020021425341, 41.71510175379265, 29.88652451210141, 19.950936439131198, 14.606890047757219, 33.38456299764307, 11.808525478269653, 20.84787726041815, 31.40286737384284, 5.651619052905135, 13.67843096311455, 18.929984462550635, 7.088053324705015, 25.340199147543373, 14.520212916241833, 44.124030973673904, 47.55881160025305, 23.09616112663035, 36.32514732001119, 17.498358331056192, 20.243711926274372, 8.170582425034052, 7.7853659683839656, 17.13807598576607, 21.74894050191559, 43.89748397623137, 33.88027107284469, 22.417317395907624, 29.615068335561524, 7.310212627262768, 1.8455751469368105, 20.347459001998455, 15.312448616100223, 21.65645640331567, 17.190342740690767, 16.310995474491946, 22.302847290516873, 29.611693768627, 17.025355503447383, 32.42632081820539, 40.02136304445109, 14.407326368601456, 29.41962716475561, 24.249364756900945, 33.79620480101034, 52.042524644967244, 47.383115271648464, 10.343852109213366, 27.825189702891368, 8.068672339904644, 27.265058489986927, 29.92256135300015, 25.921676988114122, 48.2566912190796, 18.688989281321582, 19.194963900644638, 23.252068971515545, 8.331275607137728, 16.56632435813099, 28.269862936001346, 32.27523065549289, 44.09623207598336, 42.34553445085606, 25.962832271270113, 8.666613520566095, 20.27214856206363, 3.7897205344359435, 13.019872848709763, 21.301625486965484, 44.06166836257658, 57.290941333423255, 27.921620132981154, -4.992019484577392, 48.31999836106145, 22.962617834954283, 34.79129574387228, 9.995643066781593, 27.983270250012747, 12.251213238956293, 29.727792261574287, 31.965641740988268, 22.43195693814549, 36.291554365264886, 10.176083407920387, 15.57936394915435, 30.263370774959363, 31.435885502823304, 13.86589751904976, 25.655315909886365, 0.3846417063912285, 0.9579329953864821, 27.89114553503884, 16.686782647556246, 22.563987273490998, -1.5202199229280922]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38955505245491023, "mean_inference_ms": 0.9652958831796421, "mean_action_processing_ms": 0.1656550807967172, "mean_env_wait_ms": 0.05752898366483211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003302931785583496, "StateBufferConnector_ms": 0.0024520158767700195, "ViewRequirementAgentConnector_ms": 0.07080638408660889}, "num_episodes": 54, "episode_return_max": 202.70521939199972, "episode_return_min": 2.685149403555421, "episode_return_mean": 94.57751580685031}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 506.9342926194224, "num_env_steps_trained_throughput_per_sec": 506.9342926194224, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 1692000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1692000, "timers": {"training_iteration_time_ms": 8612.03, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8611.985, "sample_time_ms": 905.159, "learn_time_ms": 7694.474, "learn_throughput": 519.854, "synch_weights_time_ms": 11.166}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000}, "done": false, "training_iteration": 141, "trial_id": "eaa30_00000", "date": "2024-08-09_17-59-39", "timestamp": 1723240779, "time_this_iter_s": 7.895280838012695, "time_total_s": 1155.8601579666138, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17803a550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1155.8601579666138, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 25.236363636363635, "ram_util_percent": 81.4090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.206457742685995, "cur_kl_coeff": 0.16236605127342046, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.700699282953979, "policy_loss": -0.0006333937777930664, "vf_loss": 7.698178501734658, "vf_explained_var": 0.06235987884657723, "kl": 0.01942640519922688, "entropy": 0.7768475341418433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.335465231103202, "cur_kl_coeff": 0.2343354187210932, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.63008416891098, "policy_loss": 0.0015643939264312697, "vf_loss": 8.623779885470867, "vf_explained_var": -0.03898991520206133, "kl": 0.020226895010758503, "entropy": 0.8891330920780699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 135840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000}, "env_runners": {"episode_reward_max": 202.70521939199972, "episode_reward_min": 2.685149403555421, "episode_reward_mean": 90.10384455933243, "episode_len_mean": 76.91, "episode_media": {}, "episodes_this_iter": 50, "episodes_timesteps_total": 7691, "policy_reward_min": {"agent_policy": 1.3425747017777105, "adversary_policy": -8.553203322784501}, "policy_reward_max": {"agent_policy": 101.35260969599985, "adversary_policy": 57.290941333423255}, "policy_reward_mean": {"agent_policy": 45.051922279666215, "adversary_policy": 22.525961139833107}, "custom_metrics": {}, "hist_stats": {"episode_reward": [138.93825902263177, 165.40707173131943, 124.07638153217744, 143.2032525317881, 69.11565297377685, 90.38617695182548, 104.50148926852194, 38.660100032039374, 52.036075574511294, 79.72082412757042, 183.36568514785404, 118.84261689328302, 75.4841405146611, 31.911896786836035, 77.77403297536335, 155.555510098152, 104.0647714629383, 18.31157554839916, 71.31981523619736, 77.69359828801288, 77.22768553001764, 93.27409854414879, 144.89536772531292, 87.6539070667142, 116.09113911582257, 198.8512798332314, 76.33808362420946, 70.66746165978314, 111.68847668222858, 133.8913610008024, 84.89406574432036, 49.79519993053742, 121.09018718298844, 172.8835330536788, 69.25889158367238, 48.123738192999156, 68.64299667135047, 202.70521939199972, 45.85920129680753, 142.56523239203142, 89.57387762130776, 80.4689669779381, 123.38686800512514, 117.44702260682075, 51.510894714149494, 123.39851255556536, 79.04242685787229, 2.685149403555421, 89.15585636519015, 42.0875347011258, 160.30833642127232, 41.14040908466076, 97.17166148310302, 93.9444855837176, 107.85560513128027, 43.294262801205136, 126.10999540955605, 82.36958568497059, 89.30701636761832, 70.18010532742377, 80.27663170152674, 25.14150927777834, 145.51652499733882, 48.06433029912102, 43.768219596433426, 92.67722250117478, 143.9072122530096, 134.4981347957513, 135.63894183465996, 137.03430397707376, 53.8128164875695, 107.21846263296783, 154.12073296159332, 82.89799423530992, 42.918655974256524, 44.94965698247145, 57.57149375835722, 93.86395137987205, 67.96822010570494, 115.26611590083328, 67.20054533020223, 110.42480905431299, 8.968946727271572, 96.8317878880799, 103.50504021159281, 5.026616151662715, 40.67651321871112, 26.85012315062736, 84.64928442100117, 24.244844057091267, 49.520032515426834, 112.89255581080131, 145.7556396926078, 72.71282381275279, 170.71752775803648, 47.84872575530699, 28.64165583061844, 125.97143406647132, 9.60502243367074, 124.02477037021805], "episode_lengths": [112, 126, 89, 80, 64, 81, 73, 90, 60, 130, 76, 87, 65, 57, 45, 89, 58, 44, 43, 66, 76, 77, 106, 55, 79, 102, 103, 70, 94, 103, 57, 56, 91, 97, 48, 82, 44, 78, 68, 88, 62, 77, 71, 79, 84, 77, 96, 2, 55, 54, 101, 53, 50, 101, 58, 41, 106, 80, 70, 133, 117, 24, 69, 97, 87, 106, 102, 120, 71, 85, 106, 77, 84, 123, 86, 54, 64, 103, 130, 77, 39, 104, 42, 63, 87, 39, 104, 23, 66, 47, 48, 66, 98, 89, 102, 87, 9, 114, 52, 71], "policy_agent_policy_reward": [69.46912951131586, 82.70353586565975, 62.03819076608873, 71.60162626589405, 34.557826486888416, 45.193088475912724, 52.25074463426101, 19.330050016019683, 26.01803778725565, 39.860412063785205, 91.68284257392693, 59.42130844664155, 37.74207025733057, 15.955948393418018, 38.88701648768166, 77.77775504907605, 52.03238573146915, 9.155787774199577, 35.65990761809868, 38.84679914400644, 38.61384276500882, 46.637049272074385, 72.44768386265649, 43.826953533357084, 58.045569557911286, 99.42563991661574, 38.169041812104744, 35.33373082989157, 55.84423834111427, 66.9456805004012, 42.44703287216018, 24.897599965268714, 60.545093591494236, 86.44176652683942, 34.62944579183621, 24.061869096499574, 34.321498335675244, 101.35260969599985, 22.929600648403756, 71.28261619601574, 44.78693881065388, 40.23448348896904, 61.69343400256256, 58.723511303410376, 25.755447357074743, 61.699256277782666, 39.52121342893613, 1.3425747017777105, 44.577928182595095, 21.043767350562902, 80.15416821063613, 20.570204542330384, 48.585830741551526, 46.97224279185878, 53.92780256564018, 21.647131400602582, 63.054997704778025, 41.184792842485294, 44.6535081838092, 35.09005266371189, 40.13831585076337, 12.57075463888917, 72.75826249866941, 24.03216514956051, 21.884109798216716, 46.33861125058739, 71.95360612650477, 67.24906739787568, 67.81947091732995, 68.51715198853685, 26.906408243784767, 53.609231316483935, 77.06036648079672, 41.44899711765498, 21.45932798712825, 22.474828491235726, 28.785746879178614, 46.931975689936024, 33.98411005285248, 57.63305795041664, 33.6002726651011, 55.21240452715647, 4.484473363635786, 48.415893944039965, 51.7525201057964, 2.5133080758313575, 20.338256609355565, 13.42506157531368, 42.32464221050057, 12.122422028545635, 24.76001625771341, 56.446277905400706, 72.87781984630391, 36.356411906376394, 85.35876387901824, 23.924362877653493, 14.320827915309222, 62.98571703323566, 4.802511216835374, 62.012385185109025], "policy_adversary_policy_reward": [28.628758826984683, 40.840370684331184, 41.558291289475434, 41.1452445761843, 11.037990551835309, 51.00020021425341, 41.71510175379265, 29.88652451210141, 19.950936439131198, 14.606890047757219, 33.38456299764307, 11.808525478269653, 20.84787726041815, 31.40286737384284, 5.651619052905135, 13.67843096311455, 18.929984462550635, 7.088053324705015, 25.340199147543373, 14.520212916241833, 44.124030973673904, 47.55881160025305, 23.09616112663035, 36.32514732001119, 17.498358331056192, 20.243711926274372, 8.170582425034052, 7.7853659683839656, 17.13807598576607, 21.74894050191559, 43.89748397623137, 33.88027107284469, 22.417317395907624, 29.615068335561524, 7.310212627262768, 1.8455751469368105, 20.347459001998455, 15.312448616100223, 21.65645640331567, 17.190342740690767, 16.310995474491946, 22.302847290516873, 29.611693768627, 17.025355503447383, 32.42632081820539, 40.02136304445109, 14.407326368601456, 29.41962716475561, 24.249364756900945, 33.79620480101034, 52.042524644967244, 47.383115271648464, 10.343852109213366, 27.825189702891368, 8.068672339904644, 27.265058489986927, 29.92256135300015, 25.921676988114122, 48.2566912190796, 18.688989281321582, 19.194963900644638, 23.252068971515545, 8.331275607137728, 16.56632435813099, 28.269862936001346, 32.27523065549289, 44.09623207598336, 42.34553445085606, 25.962832271270113, 8.666613520566095, 20.27214856206363, 3.7897205344359435, 13.019872848709763, 21.301625486965484, 44.06166836257658, 57.290941333423255, 27.921620132981154, -4.992019484577392, 48.31999836106145, 22.962617834954283, 34.79129574387228, 9.995643066781593, 27.983270250012747, 12.251213238956293, 29.727792261574287, 31.965641740988268, 22.43195693814549, 36.291554365264886, 10.176083407920387, 15.57936394915435, 30.263370774959363, 31.435885502823304, 13.86589751904976, 25.655315909886365, 0.3846417063912285, 0.9579329953864821, 27.89114553503884, 16.686782647556246, 22.563987273490998, -1.5202199229280922, 47.53946956092225, 32.6146986497139, 19.401946903711092, 1.1682576386192878, 35.50020653561935, 13.08562420593217, 34.104086548884084, 12.868156242974695, 35.85924540962745, 18.068557156012723, 18.04201820311509, 3.605113197487487, 27.92758266428293, 35.127415040495094, 20.57153918431279, 20.613253658172486, 15.125981434449164, 29.52752674936003, 23.283392212774924, 11.806660450936963, 27.240375839958357, 12.897940010805012, 10.542796987429963, 2.0279576514592073, 46.79524156382473, 25.96302093484469, 17.269401640998858, 6.762763508561651, 28.90622194469122, -7.022112146474505, 30.198911613747413, 16.139699636839975, 22.968242057940483, 48.98536406856428, 35.826705983441876, 31.422361414433794, 32.460331320956314, 35.35913959637364, 38.553783440322576, 29.963368548214284, 15.12440975263095, 11.781998491153818, 32.71691561135674, 20.89231570512719, 39.46196077859456, 37.59840570220214, 37.494369724050216, 3.954627393604765, 0.25196688712279425, 21.207361100005464, -3.402945033849825, 25.87777352508555, -3.440754531922142, 32.226501411100756, 28.736394093792708, 18.19558159614332, 13.059034285541813, 20.925075767310666, 32.188428091733186, 25.444629858683456, 13.760559845071445, 19.839712820029646, 9.10696573989427, 46.10543878726221, 9.383903873287935, -4.899430509652149, 38.65140517539754, 9.764488768642398, 27.632714991127553, 24.119805114668846, -0.38275387809169814, 2.8960619539230557, 2.909577514687932, 17.428679094667633, 11.962381970511435, 1.4626796048022452, 37.31068756380944, 5.013954646691136, -3.3610175520089953, 15.483439580554627, 6.187327562511747, 18.57268869520166, 29.210241150388825, 27.23603675501187, 27.69223603739075, 45.18558380891315, 11.371630662650007, 24.984781243726385, 46.4199842220149, 38.93877965700335, 25.50470630508388, -1.5803434274303854, 7.016010155899922, 7.3048177594093, 22.587850286178913, 40.397866747056746, -8.553203322784501, 13.355714539619875, 31.20093481052809, 30.811450374580943]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38962481623322154, "mean_inference_ms": 0.9665399160801218, "mean_action_processing_ms": 0.16549837406875587, "mean_env_wait_ms": 0.057521406616557406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031032562255859375, "StateBufferConnector_ms": 0.0024373531341552734, "ViewRequirementAgentConnector_ms": 0.06421053409576416}, "num_episodes": 50, "episode_return_max": 202.70521939199972, "episode_return_min": 2.685149403555421, "episode_return_mean": 90.10384455933243}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 508.2067194865279, "num_env_steps_trained_throughput_per_sec": 508.2067194865279, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 1704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1704000, "timers": {"training_iteration_time_ms": 8245.196, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8245.161, "sample_time_ms": 855.294, "learn_time_ms": 7377.679, "learn_throughput": 542.176, "synch_weights_time_ms": 11.237}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000}, "done": false, "training_iteration": 142, "trial_id": "eaa30_00000", "date": "2024-08-09_17-59-47", "timestamp": 1723240787, "time_this_iter_s": 7.87468695640564, "time_total_s": 1163.7348449230194, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17803a5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1163.7348449230194, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 24.53333333333333, "ram_util_percent": 81.18333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.571325412250701, "cur_kl_coeff": 0.16236605127342046, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.786125510584109, "policy_loss": -0.0024327198332964035, "vf_loss": 7.783737611518335, "vf_explained_var": 0.1360042754935209, "kl": 0.029689906690289418, "entropy": 0.8626610829401269, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.815111724597712, "cur_kl_coeff": 0.3515031280816399, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.92926177183787, "policy_loss": 0.009618383594594585, "vf_loss": 8.911324348052343, "vf_explained_var": -0.021528447481493154, "kl": 0.023667027914780193, "entropy": 0.8909182111422221, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 136800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000}, "env_runners": {"episode_reward_max": 177.1920021162186, "episode_reward_min": 2.685149403555421, "episode_reward_mean": 77.1027570660998, "episode_len_mean": 80.21, "episode_media": {}, "episodes_this_iter": 47, "episodes_timesteps_total": 8021, "policy_reward_min": {"agent_policy": 1.3425747017777105, "adversary_policy": -20.725306150265332}, "policy_reward_max": {"agent_policy": 88.59600105810924, "adversary_policy": 53.202117676783985}, "policy_reward_mean": {"agent_policy": 38.551378533049906, "adversary_policy": 19.27568926652495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.685149403555421, 89.15585636519015, 42.0875347011258, 160.30833642127232, 41.14040908466076, 97.17166148310302, 93.9444855837176, 107.85560513128027, 43.294262801205136, 126.10999540955605, 82.36958568497059, 89.30701636761832, 70.18010532742377, 80.27663170152674, 25.14150927777834, 145.51652499733882, 48.06433029912102, 43.768219596433426, 92.67722250117478, 143.9072122530096, 134.4981347957513, 135.63894183465996, 137.03430397707376, 53.8128164875695, 107.21846263296783, 154.12073296159332, 82.89799423530992, 42.918655974256524, 44.94965698247145, 57.57149375835722, 93.86395137987205, 67.96822010570494, 115.26611590083328, 67.20054533020223, 110.42480905431299, 8.968946727271572, 96.8317878880799, 103.50504021159281, 5.026616151662715, 40.67651321871112, 26.85012315062736, 84.64928442100117, 24.244844057091267, 49.520032515426834, 112.89255581080131, 145.7556396926078, 72.71282381275279, 170.71752775803648, 47.84872575530699, 28.64165583061844, 125.97143406647132, 9.60502243367074, 124.02477037021805, 52.2432998694601, 94.19217640817979, 74.14881821862977, 13.738921382228376, 12.648158404617604, 31.19370269072141, 42.51402625344451, 39.83918096951758, 105.37995429569807, 14.713436171883885, 49.1621766089125, 37.99011023375401, 54.438259215554595, 87.75994246905942, 5.6050942881665335, 113.20529315605924, 36.26872399699362, 25.626056304658192, 113.73303738661386, 21.964289618999203, 76.38264973538068, 177.1920021162186, 153.75244265581995, 163.80428854391627, 7.662567932766329, 129.62432454624238, 17.617122691245232, 81.47288127041588, 136.63738611109298, 11.391425820209005, 74.87558037614171, 78.40990126518668, 42.130052005642526, 16.37508738151387, 151.7675467904273, 47.054541451599576, 153.44501985222985, 65.3601640770471, 66.76313133308646, 106.34882960299701, 54.32217685356005, 102.55637442268477, 100.67513657742603, 122.1171275999948, 42.654679223819144, 89.45517549063676, 105.27359926558017], "episode_lengths": [2, 55, 54, 101, 53, 50, 101, 58, 41, 106, 80, 70, 133, 117, 24, 69, 97, 87, 106, 102, 120, 71, 85, 106, 77, 84, 123, 86, 54, 64, 103, 130, 77, 39, 104, 42, 63, 87, 39, 104, 23, 66, 47, 48, 66, 98, 89, 102, 87, 9, 114, 52, 71, 76, 47, 51, 59, 101, 15, 88, 101, 108, 26, 51, 140, 124, 119, 39, 108, 48, 52, 65, 89, 103, 180, 126, 157, 23, 55, 69, 135, 122, 23, 76, 93, 24, 31, 125, 93, 100, 57, 67, 117, 41, 123, 107, 118, 129, 76, 108], "policy_agent_policy_reward": [1.3425747017777105, 44.577928182595095, 21.043767350562902, 80.15416821063613, 20.570204542330384, 48.585830741551526, 46.97224279185878, 53.92780256564018, 21.647131400602582, 63.054997704778025, 41.184792842485294, 44.6535081838092, 35.09005266371189, 40.13831585076337, 12.57075463888917, 72.75826249866941, 24.03216514956051, 21.884109798216716, 46.33861125058739, 71.95360612650477, 67.24906739787568, 67.81947091732995, 68.51715198853685, 26.906408243784767, 53.609231316483935, 77.06036648079672, 41.44899711765498, 21.45932798712825, 22.474828491235726, 28.785746879178614, 46.931975689936024, 33.98411005285248, 57.63305795041664, 33.6002726651011, 55.21240452715647, 4.484473363635786, 48.415893944039965, 51.7525201057964, 2.5133080758313575, 20.338256609355565, 13.42506157531368, 42.32464221050057, 12.122422028545635, 24.76001625771341, 56.446277905400706, 72.87781984630391, 36.356411906376394, 85.35876387901824, 23.924362877653493, 14.320827915309222, 62.98571703323566, 4.802511216835374, 62.012385185109025, 26.121649934730055, 47.09608820408988, 37.07440910931489, 6.8694606911141864, 6.324079202308832, 15.596851345360704, 21.257013126722256, 19.9195904847588, 52.689977147849035, 7.3567180859419405, 24.58108830445625, 18.995055116877012, 27.21912960777731, 43.87997123452972, 2.8025471440832668, 56.60264657802959, 18.13436199849681, 12.813028152329085, 56.86651869330692, 10.982144809499601, 38.19132486769033, 88.59600105810924, 76.87622132790997, 81.9021442719581, 3.831283966383165, 64.81216227312119, 8.808561345622618, 40.736440635207956, 68.31869305554653, 5.695712910104503, 37.43779018807085, 39.204950632593345, 21.065026002821263, 8.187543690756938, 75.88377339521367, 23.527270725799788, 76.72250992611495, 32.68008203852356, 33.381565666543224, 53.17441480149851, 27.161088426780026, 51.27818721134244, 50.337568288713015, 61.0585637999974, 21.32733961190957, 44.727587745318374, 52.63679963279009], "policy_adversary_policy_reward": [0.3846417063912285, 0.9579329953864821, 27.89114553503884, 16.686782647556246, 22.563987273490998, -1.5202199229280922, 47.53946956092225, 32.6146986497139, 19.401946903711092, 1.1682576386192878, 35.50020653561935, 13.08562420593217, 34.104086548884084, 12.868156242974695, 35.85924540962745, 18.068557156012723, 18.04201820311509, 3.605113197487487, 27.92758266428293, 35.127415040495094, 20.57153918431279, 20.613253658172486, 15.125981434449164, 29.52752674936003, 23.283392212774924, 11.806660450936963, 27.240375839958357, 12.897940010805012, 10.542796987429963, 2.0279576514592073, 46.79524156382473, 25.96302093484469, 17.269401640998858, 6.762763508561651, 28.90622194469122, -7.022112146474505, 30.198911613747413, 16.139699636839975, 22.968242057940483, 48.98536406856428, 35.826705983441876, 31.422361414433794, 32.460331320956314, 35.35913959637364, 38.553783440322576, 29.963368548214284, 15.12440975263095, 11.781998491153818, 32.71691561135674, 20.89231570512719, 39.46196077859456, 37.59840570220214, 37.494369724050216, 3.954627393604765, 0.25196688712279425, 21.207361100005464, -3.402945033849825, 25.87777352508555, -3.440754531922142, 32.226501411100756, 28.736394093792708, 18.19558159614332, 13.059034285541813, 20.925075767310666, 32.188428091733186, 25.444629858683456, 13.760559845071445, 19.839712820029646, 9.10696573989427, 46.10543878726221, 9.383903873287935, -4.899430509652149, 38.65140517539754, 9.764488768642398, 27.632714991127553, 24.119805114668846, -0.38275387809169814, 2.8960619539230557, 2.909577514687932, 17.428679094667633, 11.962381970511435, 1.4626796048022452, 37.31068756380944, 5.013954646691136, -3.3610175520089953, 15.483439580554627, 6.187327562511747, 18.57268869520166, 29.210241150388825, 27.23603675501187, 27.69223603739075, 45.18558380891315, 11.371630662650007, 24.984781243726385, 46.4199842220149, 38.93877965700335, 25.50470630508388, -1.5803434274303854, 7.016010155899922, 7.3048177594093, 22.587850286178913, 40.397866747056746, -8.553203322784501, 13.355714539619875, 31.20093481052809, 30.811450374580943, 34.53725074346027, -8.41560080873022, 19.19898232435823, 27.897105879731658, 14.474321690256367, 22.600087419058514, 16.796876923419166, -9.92741623230498, 10.938072014139998, -4.613992811831174, 5.026837537505084, 10.57001380785562, 10.501431278738291, 10.755581847983965, 11.48103143724846, 8.438559047510338, 17.591762557258836, 35.0982145905902, 11.731091539260184, -4.374373453318243, 12.73773362882964, 11.84335467562661, 20.36612562564795, -1.3710705087709414, 31.732874651696378, -4.513745043919062, 21.09288701271565, 22.787084221814066, 1.643390487653086, 1.1591566564301807, 29.032243322309697, 27.570403255719917, 11.993360674651196, 6.1410013238456145, 7.362358100828084, 5.450670051501001, 21.24371719446011, 35.62280149884681, -20.725306150265332, 31.707450959764934, 45.04415333089275, -6.852828463202414, 46.49577466254063, 42.1002263955686, 40.53004774556436, 36.346173582345614, 40.179484227292164, 41.72266004466593, 6.219178710122033, -2.387894743738869, 34.57127524868116, 30.24088702444003, -1.1244743000188784, 9.933035645641498, 2.2251291092206147, 38.51131152598734, 30.207587972101027, 38.1111050834455, 5.376370762877762, 0.3193421472267417, 20.246193150610942, 17.191597037459907, 7.456395757705538, 31.74855487488781, 12.229990352398598, 8.835035650422665, -4.694271711040578, 12.881815401797516, 53.202117676783985, 22.681655718429674, 32.53568885635063, -9.008418130550847, 34.99248919816972, 41.730020727945224, 32.81604934922006, -0.13596731069649692, 10.173832410837552, 23.20773325570567, 31.66518061757541, 21.50923418392309, 10.159531721839997, 17.00155670494003, 8.208674138371546, 43.06951307297088, 41.687147596792116, 8.650420691920896, 30.686928312621827, 30.37163548737557, 2.0060507539031, 19.32128885800647, 12.055618062210307, 32.67196968310805, 12.123707880067894, 40.513091752722204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38999685540529727, "mean_inference_ms": 0.9670381853127759, "mean_action_processing_ms": 0.1654379900696932, "mean_env_wait_ms": 0.05759070771215148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033822059631347656, "StateBufferConnector_ms": 0.002604246139526367, "ViewRequirementAgentConnector_ms": 0.06959271430969238}, "num_episodes": 47, "episode_return_max": 177.1920021162186, "episode_return_min": 2.685149403555421, "episode_return_mean": 77.1027570660998}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.81244780969837, "num_env_steps_trained_throughput_per_sec": 500.81244780969837, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 1716000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1716000, "timers": {"training_iteration_time_ms": 8121.765, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8121.731, "sample_time_ms": 816.602, "learn_time_ms": 7293.541, "learn_throughput": 548.43, "synch_weights_time_ms": 10.974}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000}, "done": false, "training_iteration": 143, "trial_id": "eaa30_00000", "date": "2024-08-09_17-59-55", "timestamp": 1723240795, "time_this_iter_s": 7.99197793006897, "time_total_s": 1171.7268228530884, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17803a940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1171.7268228530884, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 30.3090909090909, "ram_util_percent": 81.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.068779825281213, "cur_kl_coeff": 0.2435490769101306, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.06330168436444, "policy_loss": 0.001087513623793644, "vf_loss": 6.053985731437724, "vf_explained_var": 0.4222419489313055, "kl": 0.033785569597843776, "entropy": 1.0137989361765523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.484811420800785, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.632106053332488, "policy_loss": 0.00345711994280767, "vf_loss": 7.622444941600164, "vf_explained_var": 0.006730220591028531, "kl": 0.011766625410139871, "entropy": 0.9128683299447099, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 137760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "env_runners": {"episode_reward_max": 177.1920021162186, "episode_reward_min": -124.95919687896816, "episode_reward_mean": 57.041073890063, "episode_len_mean": 88.57, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 8857, "policy_reward_min": {"agent_policy": -62.47959843948411, "adversary_policy": -47.25903997095228}, "policy_reward_max": {"agent_policy": 88.59600105810924, "adversary_policy": 53.202117676783985}, "policy_reward_mean": {"agent_policy": 28.5205369450315, "adversary_policy": 14.260268472515753}, "custom_metrics": {}, "hist_stats": {"episode_reward": [103.50504021159281, 5.026616151662715, 40.67651321871112, 26.85012315062736, 84.64928442100117, 24.244844057091267, 49.520032515426834, 112.89255581080131, 145.7556396926078, 72.71282381275279, 170.71752775803648, 47.84872575530699, 28.64165583061844, 125.97143406647132, 9.60502243367074, 124.02477037021805, 52.2432998694601, 94.19217640817979, 74.14881821862977, 13.738921382228376, 12.648158404617604, 31.19370269072141, 42.51402625344451, 39.83918096951758, 105.37995429569807, 14.713436171883885, 49.1621766089125, 37.99011023375401, 54.438259215554595, 87.75994246905942, 5.6050942881665335, 113.20529315605924, 36.26872399699362, 25.626056304658192, 113.73303738661386, 21.964289618999203, 76.38264973538068, 177.1920021162186, 153.75244265581995, 163.80428854391627, 7.662567932766329, 129.62432454624238, 17.617122691245232, 81.47288127041588, 136.63738611109298, 11.391425820209005, 74.87558037614171, 78.40990126518668, 42.130052005642526, 16.37508738151387, 151.7675467904273, 47.054541451599576, 153.44501985222985, 65.3601640770471, 66.76313133308646, 106.34882960299701, 54.32217685356005, 102.55637442268477, 100.67513657742603, 122.1171275999948, 42.654679223819144, 89.45517549063676, 105.27359926558017, -9.785975648148986, 38.239127784410925, 31.293471034709626, 3.595023023826732, 75.99098036704376, 129.96345881491615, -102.27204172491022, 44.21565441553979, 102.84420750112955, -9.965730303965351, 81.11061083236544, 101.37706258884002, 37.01475423128818, 31.754620167934423, -17.670183803684523, 136.62967839973172, -12.851373092545828, 29.42247414863862, 33.45235678559593, 150.73864308427235, 11.159148162641753, 63.19734503601009, 61.63604188095596, 13.207527937933314, 38.337163654713464, 144.19781436312778, -124.95919687896816, 7.729881483800838, -45.30119916117539, -14.380451920088277, 72.34393757765449, -75.99088405541758, -16.31066594570963, 13.91477033016583, 4.0029290473596335, 77.24536267438383, 24.852564019293766], "episode_lengths": [87, 39, 104, 23, 66, 47, 48, 66, 98, 89, 102, 87, 9, 114, 52, 71, 76, 47, 51, 59, 101, 15, 88, 101, 108, 26, 51, 140, 124, 119, 39, 108, 48, 52, 65, 89, 103, 180, 126, 157, 23, 55, 69, 135, 122, 23, 76, 93, 24, 31, 125, 93, 100, 57, 67, 117, 41, 123, 107, 118, 129, 76, 108, 68, 90, 110, 38, 72, 107, 200, 131, 95, 149, 60, 116, 113, 59, 52, 108, 80, 171, 62, 146, 5, 55, 114, 65, 89, 76, 200, 200, 112, 60, 77, 200, 59, 103, 92, 119, 117], "policy_agent_policy_reward": [51.7525201057964, 2.5133080758313575, 20.338256609355565, 13.42506157531368, 42.32464221050057, 12.122422028545635, 24.76001625771341, 56.446277905400706, 72.87781984630391, 36.356411906376394, 85.35876387901824, 23.924362877653493, 14.320827915309222, 62.98571703323566, 4.802511216835374, 62.012385185109025, 26.121649934730055, 47.09608820408988, 37.07440910931489, 6.8694606911141864, 6.324079202308832, 15.596851345360704, 21.257013126722256, 19.9195904847588, 52.689977147849035, 7.3567180859419405, 24.58108830445625, 18.995055116877012, 27.21912960777731, 43.87997123452972, 2.8025471440832668, 56.60264657802959, 18.13436199849681, 12.813028152329085, 56.86651869330692, 10.982144809499601, 38.19132486769033, 88.59600105810924, 76.87622132790997, 81.9021442719581, 3.831283966383165, 64.81216227312119, 8.808561345622618, 40.736440635207956, 68.31869305554653, 5.695712910104503, 37.43779018807085, 39.204950632593345, 21.065026002821263, 8.187543690756938, 75.88377339521367, 23.527270725799788, 76.72250992611495, 32.68008203852356, 33.381565666543224, 53.17441480149851, 27.161088426780026, 51.27818721134244, 50.337568288713015, 61.0585637999974, 21.32733961190957, 44.727587745318374, 52.63679963279009, -4.892987824074492, 19.119563892205463, 15.646735517354813, 1.7975115119133651, 37.99549018352191, 64.98172940745805, -51.13602086245515, 22.107827207769898, 51.422103750564744, -4.982865151982658, 40.55530541618272, 50.68853129442002, 18.507377115644093, 15.877310083967211, -8.835091901842247, 68.31483919986587, -6.425686546272914, 14.71123707431931, 16.72617839279797, 75.36932154213616, 5.579574081320876, 31.598672518005053, 30.81802094047798, 6.603763968966657, 19.16858182735674, 72.09890718156387, -62.47959843948411, 3.864940741900419, -22.650599580587674, -7.190225960044141, 36.17196878882724, -37.99544202770879, -8.155332972854815, 6.957385165082915, 2.0014645236798163, 38.62268133719189, 12.426282009646883], "policy_adversary_policy_reward": [27.632714991127553, 24.119805114668846, -0.38275387809169814, 2.8960619539230557, 2.909577514687932, 17.428679094667633, 11.962381970511435, 1.4626796048022452, 37.31068756380944, 5.013954646691136, -3.3610175520089953, 15.483439580554627, 6.187327562511747, 18.57268869520166, 29.210241150388825, 27.23603675501187, 27.69223603739075, 45.18558380891315, 11.371630662650007, 24.984781243726385, 46.4199842220149, 38.93877965700335, 25.50470630508388, -1.5803434274303854, 7.016010155899922, 7.3048177594093, 22.587850286178913, 40.397866747056746, -8.553203322784501, 13.355714539619875, 31.20093481052809, 30.811450374580943, 34.53725074346027, -8.41560080873022, 19.19898232435823, 27.897105879731658, 14.474321690256367, 22.600087419058514, 16.796876923419166, -9.92741623230498, 10.938072014139998, -4.613992811831174, 5.026837537505084, 10.57001380785562, 10.501431278738291, 10.755581847983965, 11.48103143724846, 8.438559047510338, 17.591762557258836, 35.0982145905902, 11.731091539260184, -4.374373453318243, 12.73773362882964, 11.84335467562661, 20.36612562564795, -1.3710705087709414, 31.732874651696378, -4.513745043919062, 21.09288701271565, 22.787084221814066, 1.643390487653086, 1.1591566564301807, 29.032243322309697, 27.570403255719917, 11.993360674651196, 6.1410013238456145, 7.362358100828084, 5.450670051501001, 21.24371719446011, 35.62280149884681, -20.725306150265332, 31.707450959764934, 45.04415333089275, -6.852828463202414, 46.49577466254063, 42.1002263955686, 40.53004774556436, 36.346173582345614, 40.179484227292164, 41.72266004466593, 6.219178710122033, -2.387894743738869, 34.57127524868116, 30.24088702444003, -1.1244743000188784, 9.933035645641498, 2.2251291092206147, 38.51131152598734, 30.207587972101027, 38.1111050834455, 5.376370762877762, 0.3193421472267417, 20.246193150610942, 17.191597037459907, 7.456395757705538, 31.74855487488781, 12.229990352398598, 8.835035650422665, -4.694271711040578, 12.881815401797516, 53.202117676783985, 22.681655718429674, 32.53568885635063, -9.008418130550847, 34.99248919816972, 41.730020727945224, 32.81604934922006, -0.13596731069649692, 10.173832410837552, 23.20773325570567, 31.66518061757541, 21.50923418392309, 10.159531721839997, 17.00155670494003, 8.208674138371546, 43.06951307297088, 41.687147596792116, 8.650420691920896, 30.686928312621827, 30.37163548737557, 2.0060507539031, 19.32128885800647, 12.055618062210307, 32.67196968310805, 12.123707880067894, 40.513091752722204, 16.701410879325014, -21.594398703399506, 3.3685855342178286, 15.750978357987634, -4.812494685556587, 20.4592302029114, 8.045129580858932, -6.247618068945567, 26.29087801088437, 11.704612172637532, 21.547255830995315, 43.434473576462764, -29.445876249454408, -21.69014461300074, -10.999270116425052, 33.10709732419494, 17.195745855932685, 34.226357894632066, -36.43246883682904, 31.44960368484638, 33.83187943570076, 6.723425980481956, 17.64441155974174, 33.044119734678276, 7.933134259731963, 10.574242855912127, 11.94637832672282, 3.930931757244391, -10.241325270772272, 1.406233368930014, 24.773526275114587, 43.54131292475129, 10.648459318788227, -17.07414586506114, 26.353847941084613, -11.642610866765303, 12.3915063376603, 4.334672055137668, 33.7892958674353, 41.58002567470086, -1.6194596003210648, 7.199033681641941, 11.501677217874935, 20.096995300130114, 24.723863190137195, 6.094157750340786, 23.515990683039714, -16.912226714073057, 25.35185830955377, -6.183276482197037, 47.49302655652646, 24.605880625037408, -47.25903997095228, -15.220558468531824, 4.816004249504942, -0.9510635076045233, 3.7079849591579777, -26.358584539745657, 32.23327532164492, -39.423501281689056, 30.697214006463973, 5.474754782363268, -13.533272517321144, -24.462169510387646, 15.837732937117696, -23.99306590997251, 41.24808673508402, -34.290701570001104, -23.292762518808374, 25.294227042488192, 31.006759588666938, 7.615921748524966, -17.95279488978688, 30.379076899433766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3898514774395677, "mean_inference_ms": 0.9674888521499532, "mean_action_processing_ms": 0.16541011659025298, "mean_env_wait_ms": 0.057532114007933954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033991336822509766, "StateBufferConnector_ms": 0.0025142431259155273, "ViewRequirementAgentConnector_ms": 0.06856489181518555}, "num_episodes": 37, "episode_return_max": 177.1920021162186, "episode_return_min": -124.95919687896816, "episode_return_mean": 57.041073890063}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 469.2809936847457, "num_env_steps_trained_throughput_per_sec": 469.2809936847457, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 1728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1728000, "timers": {"training_iteration_time_ms": 8063.695, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8063.661, "sample_time_ms": 781.47, "learn_time_ms": 7270.129, "learn_throughput": 550.197, "synch_weights_time_ms": 11.393}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "done": false, "training_iteration": 144, "trial_id": "eaa30_00000", "date": "2024-08-09_18-00-04", "timestamp": 1723240804, "time_this_iter_s": 8.52833890914917, "time_total_s": 1180.2551617622375, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17803aca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1180.2551617622375, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 33.84166666666666, "ram_util_percent": 82.16666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.533253775071845, "cur_kl_coeff": 0.36532361536519614, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.158182812493945, "policy_loss": 0.0018027649463090317, "vf_loss": 6.147416133476944, "vf_explained_var": 0.4318783126495503, "kl": 0.02453689791124176, "entropy": 1.0462869030457955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.55087591757377, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.884762536982695, "policy_loss": 0.0004413480429017606, "vf_loss": 7.8751568680008255, "vf_explained_var": 0.019706260040402414, "kl": 0.017381161981029437, "entropy": 0.9069968437155088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 138720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000}, "env_runners": {"episode_reward_max": 177.95960127177838, "episode_reward_min": -148.184027872329, "episode_reward_mean": 44.70401025108442, "episode_len_mean": 102.96, "episode_media": {}, "episodes_this_iter": 34, "episodes_timesteps_total": 10296, "policy_reward_min": {"agent_policy": -74.09201393616456, "adversary_policy": -47.25903997095228}, "policy_reward_max": {"agent_policy": 88.9798006358892, "adversary_policy": 53.202117676783985}, "policy_reward_mean": {"agent_policy": 22.35200512554221, "adversary_policy": 11.176002562771105}, "custom_metrics": {}, "hist_stats": {"episode_reward": [113.73303738661386, 21.964289618999203, 76.38264973538068, 177.1920021162186, 153.75244265581995, 163.80428854391627, 7.662567932766329, 129.62432454624238, 17.617122691245232, 81.47288127041588, 136.63738611109298, 11.391425820209005, 74.87558037614171, 78.40990126518668, 42.130052005642526, 16.37508738151387, 151.7675467904273, 47.054541451599576, 153.44501985222985, 65.3601640770471, 66.76313133308646, 106.34882960299701, 54.32217685356005, 102.55637442268477, 100.67513657742603, 122.1171275999948, 42.654679223819144, 89.45517549063676, 105.27359926558017, -9.785975648148986, 38.239127784410925, 31.293471034709626, 3.595023023826732, 75.99098036704376, 129.96345881491615, -102.27204172491022, 44.21565441553979, 102.84420750112955, -9.965730303965351, 81.11061083236544, 101.37706258884002, 37.01475423128818, 31.754620167934423, -17.670183803684523, 136.62967839973172, -12.851373092545828, 29.42247414863862, 33.45235678559593, 150.73864308427235, 11.159148162641753, 63.19734503601009, 61.63604188095596, 13.207527937933314, 38.337163654713464, 144.19781436312778, -124.95919687896816, 7.729881483800838, -45.30119916117539, -14.380451920088277, 72.34393757765449, -75.99088405541758, -16.31066594570963, 13.91477033016583, 4.0029290473596335, 77.24536267438383, 24.852564019293766, 1.029916667674243, -3.0596502840582596, -58.776717568667266, -4.704805778792611, 52.66455389339055, 89.2197180620998, -148.184027872329, -52.51164555541738, 17.946928922909265, -14.330285892449915, 69.01819567859658, -91.57066951995759, 71.80180354198194, -8.754997913391577, -29.02204468806267, 120.74695088929919, 0.3551405339894984, 177.95960127177838, -8.944126388255192, 145.49691890403332, 73.00016556338133, 128.8915148874731, 50.389424951488145, 27.67757672469895, 25.54061382630651, -24.446552464758696, 32.28745601159604, -67.00119823836944, -5.366389997210753, -0.3170453975961749, 102.22296184920144, 4.94828578290034, 138.3332909866457, 17.062714906150177], "episode_lengths": [65, 89, 103, 180, 126, 157, 23, 55, 69, 135, 122, 23, 76, 93, 24, 31, 125, 93, 100, 57, 67, 117, 41, 123, 107, 118, 129, 76, 108, 68, 90, 110, 38, 72, 107, 200, 131, 95, 149, 60, 116, 113, 59, 52, 108, 80, 171, 62, 146, 5, 55, 114, 65, 89, 76, 200, 200, 112, 60, 77, 200, 59, 103, 92, 119, 117, 200, 52, 200, 134, 91, 116, 200, 200, 82, 75, 40, 200, 79, 200, 99, 58, 166, 133, 68, 68, 131, 109, 66, 148, 65, 91, 128, 200, 134, 25, 36, 11, 184, 105], "policy_agent_policy_reward": [56.86651869330692, 10.982144809499601, 38.19132486769033, 88.59600105810924, 76.87622132790997, 81.9021442719581, 3.831283966383165, 64.81216227312119, 8.808561345622618, 40.736440635207956, 68.31869305554653, 5.695712910104503, 37.43779018807085, 39.204950632593345, 21.065026002821263, 8.187543690756938, 75.88377339521367, 23.527270725799788, 76.72250992611495, 32.68008203852356, 33.381565666543224, 53.17441480149851, 27.161088426780026, 51.27818721134244, 50.337568288713015, 61.0585637999974, 21.32733961190957, 44.727587745318374, 52.63679963279009, -4.892987824074492, 19.119563892205463, 15.646735517354813, 1.7975115119133651, 37.99549018352191, 64.98172940745805, -51.13602086245515, 22.107827207769898, 51.422103750564744, -4.982865151982658, 40.55530541618272, 50.68853129442002, 18.507377115644093, 15.877310083967211, -8.835091901842247, 68.31483919986587, -6.425686546272914, 14.71123707431931, 16.72617839279797, 75.36932154213616, 5.579574081320876, 31.598672518005053, 30.81802094047798, 6.603763968966657, 19.16858182735674, 72.09890718156387, -62.47959843948411, 3.864940741900419, -22.650599580587674, -7.190225960044141, 36.17196878882724, -37.99544202770879, -8.155332972854815, 6.957385165082915, 2.0014645236798163, 38.62268133719189, 12.426282009646883, 0.5149583338371215, -1.5298251420291296, -29.38835878433367, -2.3524028893963305, 26.33227694669527, 44.609859031049915, -74.09201393616456, -26.2558227777087, 8.973464461454633, -7.165142946224961, 34.5090978392983, -45.78533475997882, 35.90090177099096, -4.3774989566957885, -14.511022344031339, 60.37347544464963, 0.17757026699477052, 88.9798006358892, -4.472063194127598, 72.74845945201666, 36.50008278169065, 64.44575744373655, 25.194712475744048, 13.838788362349476, 12.770306913153256, -12.223276232379348, 16.143728005798025, -33.50059911918473, -2.6831949986053765, -0.15852269879808745, 51.11148092460072, 2.47414289145017, 69.16664549332285, 8.531357453075088], "policy_adversary_policy_reward": [21.24371719446011, 35.62280149884681, -20.725306150265332, 31.707450959764934, 45.04415333089275, -6.852828463202414, 46.49577466254063, 42.1002263955686, 40.53004774556436, 36.346173582345614, 40.179484227292164, 41.72266004466593, 6.219178710122033, -2.387894743738869, 34.57127524868116, 30.24088702444003, -1.1244743000188784, 9.933035645641498, 2.2251291092206147, 38.51131152598734, 30.207587972101027, 38.1111050834455, 5.376370762877762, 0.3193421472267417, 20.246193150610942, 17.191597037459907, 7.456395757705538, 31.74855487488781, 12.229990352398598, 8.835035650422665, -4.694271711040578, 12.881815401797516, 53.202117676783985, 22.681655718429674, 32.53568885635063, -9.008418130550847, 34.99248919816972, 41.730020727945224, 32.81604934922006, -0.13596731069649692, 10.173832410837552, 23.20773325570567, 31.66518061757541, 21.50923418392309, 10.159531721839997, 17.00155670494003, 8.208674138371546, 43.06951307297088, 41.687147596792116, 8.650420691920896, 30.686928312621827, 30.37163548737557, 2.0060507539031, 19.32128885800647, 12.055618062210307, 32.67196968310805, 12.123707880067894, 40.513091752722204, 16.701410879325014, -21.594398703399506, 3.3685855342178286, 15.750978357987634, -4.812494685556587, 20.4592302029114, 8.045129580858932, -6.247618068945567, 26.29087801088437, 11.704612172637532, 21.547255830995315, 43.434473576462764, -29.445876249454408, -21.69014461300074, -10.999270116425052, 33.10709732419494, 17.195745855932685, 34.226357894632066, -36.43246883682904, 31.44960368484638, 33.83187943570076, 6.723425980481956, 17.64441155974174, 33.044119734678276, 7.933134259731963, 10.574242855912127, 11.94637832672282, 3.930931757244391, -10.241325270772272, 1.406233368930014, 24.773526275114587, 43.54131292475129, 10.648459318788227, -17.07414586506114, 26.353847941084613, -11.642610866765303, 12.3915063376603, 4.334672055137668, 33.7892958674353, 41.58002567470086, -1.6194596003210648, 7.199033681641941, 11.501677217874935, 20.096995300130114, 24.723863190137195, 6.094157750340786, 23.515990683039714, -16.912226714073057, 25.35185830955377, -6.183276482197037, 47.49302655652646, 24.605880625037408, -47.25903997095228, -15.220558468531824, 4.816004249504942, -0.9510635076045233, 3.7079849591579777, -26.358584539745657, 32.23327532164492, -39.423501281689056, 30.697214006463973, 5.474754782363268, -13.533272517321144, -24.462169510387646, 15.837732937117696, -23.99306590997251, 41.24808673508402, -34.290701570001104, -23.292762518808374, 25.294227042488192, 31.006759588666938, 7.615921748524966, -17.95279488978688, 30.379076899433766, 3.7630680716715617, -3.24810973783444, 27.3323322538798, -28.862157395908937, -5.201498884018896, -24.18685990031477, 14.737212164230074, -17.0896150536264, -10.153512190001809, 36.48578913669708, 14.398852818079032, 30.211006212970887, -37.97659473903767, -36.11541919712683, -22.279384990674647, -3.976437787034051, 13.347050257937605, -4.373585796482972, 11.41554845720922, -18.58069140343418, 12.819518383013765, 21.689579456284537, -14.26569561407024, -31.519639145908577, -3.608369879742618, 39.509271650733574, -8.753324935786381, 4.3758259790905925, 20.882737348492316, -35.39375969252366, 27.132288715748203, 33.24118672890141, 39.28084688075336, -39.10327661375859, 49.1509809629424, 39.82881967294676, -24.87808665367099, 20.406023459543395, 27.865333475985658, 44.88312597603098, 45.27417831973195, -8.774095538041301, 24.81173736294763, 39.63402008078892, 38.136982661037756, -12.942270185293708, 36.398814318563126, -22.56002595621365, 24.735935440867802, -11.965628527714546, 14.966097475085556, -27.18937370746491, 21.10927720001868, -4.965549194220657, -20.718073457289083, -12.782525661895647, 28.295500712868098, -30.97869571147347, 6.45102556530486, -6.609548264102948, 19.48340222352008, 31.62807870108063, 4.317420013410305, -1.843277121960135, 26.551930815652476, 42.61471467767038, 33.36108689855669, -24.829729445481597]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38940449952535333, "mean_inference_ms": 0.9679463075101117, "mean_action_processing_ms": 0.1651726020845941, "mean_env_wait_ms": 0.05751048277354389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003560185432434082, "StateBufferConnector_ms": 0.0024764537811279297, "ViewRequirementAgentConnector_ms": 0.06619930267333984}, "num_episodes": 34, "episode_return_max": 177.95960127177838, "episode_return_min": -148.184027872329, "episode_return_mean": 44.70401025108442}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 480.8389285990755, "num_env_steps_trained_throughput_per_sec": 480.8389285990755, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 1740000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1740000, "timers": {"training_iteration_time_ms": 8092.52, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8092.485, "sample_time_ms": 780.127, "learn_time_ms": 7300.256, "learn_throughput": 547.926, "synch_weights_time_ms": 11.486}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000}, "done": false, "training_iteration": 145, "trial_id": "eaa30_00000", "date": "2024-08-09_18-00-13", "timestamp": 1723240813, "time_this_iter_s": 8.324808120727539, "time_total_s": 1188.579969882965, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc7c4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1188.579969882965, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 28.075, "ram_util_percent": 82.58333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.68384887478339, "cur_kl_coeff": 0.5479854230477937, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.080577497129087, "policy_loss": -0.006261738594227209, "vf_loss": 6.0784403909451115, "vf_explained_var": 0.36249052661436576, "kl": 0.015326787928543079, "entropy": 1.1169889570544005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.343789248696218, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.861131677528222, "policy_loss": 0.003852848200282703, "vf_loss": 7.850429031252861, "vf_explained_var": -0.0008933313190937042, "kl": 0.012991454231572183, "entropy": 0.8688889438286423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 139680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000}, "env_runners": {"episode_reward_max": 177.95960127177838, "episode_reward_min": -148.184027872329, "episode_reward_mean": 27.189127950624695, "episode_len_mean": 116.5, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 11650, "policy_reward_min": {"agent_policy": -74.09201393616456, "adversary_policy": -47.25903997095228}, "policy_reward_max": {"agent_policy": 88.9798006358892, "adversary_policy": 49.1509809629424}, "policy_reward_mean": {"agent_policy": 13.594563975312344, "adversary_policy": 6.797281987656172}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.27359926558017, -9.785975648148986, 38.239127784410925, 31.293471034709626, 3.595023023826732, 75.99098036704376, 129.96345881491615, -102.27204172491022, 44.21565441553979, 102.84420750112955, -9.965730303965351, 81.11061083236544, 101.37706258884002, 37.01475423128818, 31.754620167934423, -17.670183803684523, 136.62967839973172, -12.851373092545828, 29.42247414863862, 33.45235678559593, 150.73864308427235, 11.159148162641753, 63.19734503601009, 61.63604188095596, 13.207527937933314, 38.337163654713464, 144.19781436312778, -124.95919687896816, 7.729881483800838, -45.30119916117539, -14.380451920088277, 72.34393757765449, -75.99088405541758, -16.31066594570963, 13.91477033016583, 4.0029290473596335, 77.24536267438383, 24.852564019293766, 1.029916667674243, -3.0596502840582596, -58.776717568667266, -4.704805778792611, 52.66455389339055, 89.2197180620998, -148.184027872329, -52.51164555541738, 17.946928922909265, -14.330285892449915, 69.01819567859658, -91.57066951995759, 71.80180354198194, -8.754997913391577, -29.02204468806267, 120.74695088929919, 0.3551405339894984, 177.95960127177838, -8.944126388255192, 145.49691890403332, 73.00016556338133, 128.8915148874731, 50.389424951488145, 27.67757672469895, 25.54061382630651, -24.446552464758696, 32.28745601159604, -67.00119823836944, -5.366389997210753, -0.3170453975961749, 102.22296184920144, 4.94828578290034, 138.3332909866457, 17.062714906150177, 18.084753909522973, -10.150005707199085, 157.001871770191, 48.39487288213768, -110.39701427165775, 91.77607851770976, -48.564319898429765, -56.80637075318961, 125.17012600867915, -11.429497507799844, -91.79545967132657, 53.213678555376525, 9.154961710241643, 55.66247798848069, 45.94370585962977, 55.11888553453042, 23.18714229053763, 5.739090800080405, 9.065655154632935, -24.253936792710206, 56.47248129172626, -28.644327888312816, 15.190804636269391, 100.25783603213637, 77.12014328240295, 26.799605182145072, 41.614906048272026, 21.12856772286413], "episode_lengths": [108, 68, 90, 110, 38, 72, 107, 200, 131, 95, 149, 60, 116, 113, 59, 52, 108, 80, 171, 62, 146, 5, 55, 114, 65, 89, 76, 200, 200, 112, 60, 77, 200, 59, 103, 92, 119, 117, 200, 52, 200, 134, 91, 116, 200, 200, 82, 75, 40, 200, 79, 200, 99, 58, 166, 133, 68, 68, 131, 109, 66, 148, 65, 91, 128, 200, 134, 25, 36, 11, 184, 105, 200, 62, 66, 89, 200, 110, 200, 200, 191, 200, 200, 109, 2, 103, 157, 42, 169, 200, 164, 200, 108, 80, 200, 200, 98, 64, 95, 169], "policy_agent_policy_reward": [52.63679963279009, -4.892987824074492, 19.119563892205463, 15.646735517354813, 1.7975115119133651, 37.99549018352191, 64.98172940745805, -51.13602086245515, 22.107827207769898, 51.422103750564744, -4.982865151982658, 40.55530541618272, 50.68853129442002, 18.507377115644093, 15.877310083967211, -8.835091901842247, 68.31483919986587, -6.425686546272914, 14.71123707431931, 16.72617839279797, 75.36932154213616, 5.579574081320876, 31.598672518005053, 30.81802094047798, 6.603763968966657, 19.16858182735674, 72.09890718156387, -62.47959843948411, 3.864940741900419, -22.650599580587674, -7.190225960044141, 36.17196878882724, -37.99544202770879, -8.155332972854815, 6.957385165082915, 2.0014645236798163, 38.62268133719189, 12.426282009646883, 0.5149583338371215, -1.5298251420291296, -29.38835878433367, -2.3524028893963305, 26.33227694669527, 44.609859031049915, -74.09201393616456, -26.2558227777087, 8.973464461454633, -7.165142946224961, 34.5090978392983, -45.78533475997882, 35.90090177099096, -4.3774989566957885, -14.511022344031339, 60.37347544464963, 0.17757026699477052, 88.9798006358892, -4.472063194127598, 72.74845945201666, 36.50008278169065, 64.44575744373655, 25.194712475744048, 13.838788362349476, 12.770306913153256, -12.223276232379348, 16.143728005798025, -33.50059911918473, -2.6831949986053765, -0.15852269879808745, 51.11148092460072, 2.47414289145017, 69.16664549332285, 8.531357453075088, 9.04237695476149, -5.075002853599546, 78.50093588509546, 24.19743644106883, -55.19850713582888, 45.88803925885488, -24.282159949214883, -28.40318537659487, 62.58506300433956, -5.714748753899922, -45.89772983566332, 26.60683927768826, 4.577480855120822, 27.83123899424035, 22.971852929814872, 27.559442767265224, 11.593571145268786, 2.8695454000402023, 4.532827577316439, -12.126968396355073, 28.236240645863123, -14.322163944156419, 7.5954023181346955, 50.128918016068184, 38.56007164120147, 13.399802591072536, 20.807453024136016, 10.56428386143207], "policy_adversary_policy_reward": [12.123707880067894, 40.513091752722204, 16.701410879325014, -21.594398703399506, 3.3685855342178286, 15.750978357987634, -4.812494685556587, 20.4592302029114, 8.045129580858932, -6.247618068945567, 26.29087801088437, 11.704612172637532, 21.547255830995315, 43.434473576462764, -29.445876249454408, -21.69014461300074, -10.999270116425052, 33.10709732419494, 17.195745855932685, 34.226357894632066, -36.43246883682904, 31.44960368484638, 33.83187943570076, 6.723425980481956, 17.64441155974174, 33.044119734678276, 7.933134259731963, 10.574242855912127, 11.94637832672282, 3.930931757244391, -10.241325270772272, 1.406233368930014, 24.773526275114587, 43.54131292475129, 10.648459318788227, -17.07414586506114, 26.353847941084613, -11.642610866765303, 12.3915063376603, 4.334672055137668, 33.7892958674353, 41.58002567470086, -1.6194596003210648, 7.199033681641941, 11.501677217874935, 20.096995300130114, 24.723863190137195, 6.094157750340786, 23.515990683039714, -16.912226714073057, 25.35185830955377, -6.183276482197037, 47.49302655652646, 24.605880625037408, -47.25903997095228, -15.220558468531824, 4.816004249504942, -0.9510635076045233, 3.7079849591579777, -26.358584539745657, 32.23327532164492, -39.423501281689056, 30.697214006463973, 5.474754782363268, -13.533272517321144, -24.462169510387646, 15.837732937117696, -23.99306590997251, 41.24808673508402, -34.290701570001104, -23.292762518808374, 25.294227042488192, 31.006759588666938, 7.615921748524966, -17.95279488978688, 30.379076899433766, 3.7630680716715617, -3.24810973783444, 27.3323322538798, -28.862157395908937, -5.201498884018896, -24.18685990031477, 14.737212164230074, -17.0896150536264, -10.153512190001809, 36.48578913669708, 14.398852818079032, 30.211006212970887, -37.97659473903767, -36.11541919712683, -22.279384990674647, -3.976437787034051, 13.347050257937605, -4.373585796482972, 11.41554845720922, -18.58069140343418, 12.819518383013765, 21.689579456284537, -14.26569561407024, -31.519639145908577, -3.608369879742618, 39.509271650733574, -8.753324935786381, 4.3758259790905925, 20.882737348492316, -35.39375969252366, 27.132288715748203, 33.24118672890141, 39.28084688075336, -39.10327661375859, 49.1509809629424, 39.82881967294676, -24.87808665367099, 20.406023459543395, 27.865333475985658, 44.88312597603098, 45.27417831973195, -8.774095538041301, 24.81173736294763, 39.63402008078892, 38.136982661037756, -12.942270185293708, 36.398814318563126, -22.56002595621365, 24.735935440867802, -11.965628527714546, 14.966097475085556, -27.18937370746491, 21.10927720001868, -4.965549194220657, -20.718073457289083, -12.782525661895647, 28.295500712868098, -30.97869571147347, 6.45102556530486, -6.609548264102948, 19.48340222352008, 31.62807870108063, 4.317420013410305, -1.843277121960135, 26.551930815652476, 42.61471467767038, 33.36108689855669, -24.829729445481597, 15.178817226195378, -6.136440271433887, 12.235094341237737, -17.310097194837276, 29.79568474386696, 48.7052511412285, -1.5603621723754753, 25.757798613444308, -28.749602743097903, -26.448904392730984, 7.6889014575914505, 38.199137801263426, -14.327103714163826, -9.955056235051057, -18.730367334203397, -9.672818042391473, 31.081869026460826, 31.503193977878723, -5.129651161286954, -0.5850975926129678, -22.993923409531963, -22.903806426131357, 24.07215365032961, 2.5346856273586553, 1.6728591652742217, 2.9046216898466, 13.984278906287123, 13.846960087953228, 2.75246496764915, 20.219387962165722, 10.93735834219436, 16.62208442507086, 28.84608666442149, -17.25251551915271, 3.459372060613001, -0.5898266605727969, 46.67921736188607, -42.146389784569635, -13.733879507719259, 1.6069111113641874, 13.396901903776216, 14.839338742086907, -26.296926142163265, 11.974762198006848, 11.92976500179621, -4.33436268366151, 24.58272410039618, 25.546193915672006, 34.39987823055585, 4.160193410645614, 2.823289102608018, 10.576513488464519, -0.8401761747087839, 21.647629198844804, -12.547244069337786, 23.111527930769856]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39026680770950634, "mean_inference_ms": 0.9688684815828026, "mean_action_processing_ms": 0.16528422928084724, "mean_env_wait_ms": 0.057725034840474934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039288997650146484, "StateBufferConnector_ms": 0.0027539730072021484, "ViewRequirementAgentConnector_ms": 0.08652877807617188}, "num_episodes": 28, "episode_return_max": 177.95960127177838, "episode_return_min": -148.184027872329, "episode_return_mean": 27.189127950624695}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 400.2194845338642, "num_env_steps_trained_throughput_per_sec": 400.2194845338642, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 1752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1752000, "timers": {"training_iteration_time_ms": 8296.769, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8296.734, "sample_time_ms": 828.273, "learn_time_ms": 7456.289, "learn_throughput": 536.46, "synch_weights_time_ms": 11.545}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000}, "done": false, "training_iteration": 146, "trial_id": "eaa30_00000", "date": "2024-08-09_18-00-23", "timestamp": 1723240823, "time_this_iter_s": 9.998822927474976, "time_total_s": 1198.57879281044, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc7c790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1198.57879281044, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 44.04666666666666, "ram_util_percent": 82.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.598473591779275, "cur_kl_coeff": 0.5479854230477937, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.749197333704227, "policy_loss": -0.00703530649188906, "vf_loss": 6.750979885979304, "vf_explained_var": 0.09505723812592723, "kl": 0.009585562199551277, "entropy": 1.0837865160886573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.873011670013268, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.330994087457658, "policy_loss": -0.004487717842857819, "vf_loss": 8.331789953013262, "vf_explained_var": 0.001425010214249293, "kl": 0.0070019633979730616, "entropy": 0.8909464554240306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 140640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000}, "env_runners": {"episode_reward_max": 177.95960127177838, "episode_reward_min": -148.184027872329, "episode_reward_mean": 29.12227327757614, "episode_len_mean": 128.38, "episode_media": {}, "episodes_this_iter": 29, "episodes_timesteps_total": 12838, "policy_reward_min": {"agent_policy": -74.09201393616456, "adversary_policy": -42.146389784569635}, "policy_reward_max": {"agent_policy": 88.9798006358892, "adversary_policy": 49.1509809629424}, "policy_reward_mean": {"agent_policy": 14.56113663878807, "adversary_policy": 7.280568319394035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.30119916117539, -14.380451920088277, 72.34393757765449, -75.99088405541758, -16.31066594570963, 13.91477033016583, 4.0029290473596335, 77.24536267438383, 24.852564019293766, 1.029916667674243, -3.0596502840582596, -58.776717568667266, -4.704805778792611, 52.66455389339055, 89.2197180620998, -148.184027872329, -52.51164555541738, 17.946928922909265, -14.330285892449915, 69.01819567859658, -91.57066951995759, 71.80180354198194, -8.754997913391577, -29.02204468806267, 120.74695088929919, 0.3551405339894984, 177.95960127177838, -8.944126388255192, 145.49691890403332, 73.00016556338133, 128.8915148874731, 50.389424951488145, 27.67757672469895, 25.54061382630651, -24.446552464758696, 32.28745601159604, -67.00119823836944, -5.366389997210753, -0.3170453975961749, 102.22296184920144, 4.94828578290034, 138.3332909866457, 17.062714906150177, 18.084753909522973, -10.150005707199085, 157.001871770191, 48.39487288213768, -110.39701427165775, 91.77607851770976, -48.564319898429765, -56.80637075318961, 125.17012600867915, -11.429497507799844, -91.79545967132657, 53.213678555376525, 9.154961710241643, 55.66247798848069, 45.94370585962977, 55.11888553453042, 23.18714229053763, 5.739090800080405, 9.065655154632935, -24.253936792710206, 56.47248129172626, -28.644327888312816, 15.190804636269391, 100.25783603213637, 77.12014328240295, 26.799605182145072, 41.614906048272026, 21.12856772286413, 23.303168590764535, 73.65503422778579, 45.145711849557486, -83.4968546594595, 42.10721107326734, 18.987311406905818, 55.295227557608115, 26.10722776235093, 73.79786814623449, 39.273609995009, 37.964540454022874, 43.538770983650025, -14.801599010794853, 145.1560021029128, 61.108598805945476, 30.169548404203155, 32.382070415728954, 98.88575550318001, 19.16437948237737, 90.46435106198176, 72.02912195767513, 76.27733861259883, 13.075124942628406, 74.60059564179086, 55.205807370322226, 35.552453709987546, 84.46308576648188, 91.06171075025053, 27.71750330296124], "episode_lengths": [112, 60, 77, 200, 59, 103, 92, 119, 117, 200, 52, 200, 134, 91, 116, 200, 200, 82, 75, 40, 200, 79, 200, 99, 58, 166, 133, 68, 68, 131, 109, 66, 148, 65, 91, 128, 200, 134, 25, 36, 11, 184, 105, 200, 62, 66, 89, 200, 110, 200, 200, 191, 200, 200, 109, 2, 103, 157, 42, 169, 200, 164, 200, 108, 80, 200, 200, 98, 64, 95, 169, 172, 52, 183, 200, 170, 106, 95, 200, 85, 181, 175, 169, 123, 91, 200, 141, 167, 155, 7, 50, 32, 200, 177, 149, 200, 172, 135, 200, 140], "policy_agent_policy_reward": [-22.650599580587674, -7.190225960044141, 36.17196878882724, -37.99544202770879, -8.155332972854815, 6.957385165082915, 2.0014645236798163, 38.62268133719189, 12.426282009646883, 0.5149583338371215, -1.5298251420291296, -29.38835878433367, -2.3524028893963305, 26.33227694669527, 44.609859031049915, -74.09201393616456, -26.2558227777087, 8.973464461454633, -7.165142946224961, 34.5090978392983, -45.78533475997882, 35.90090177099096, -4.3774989566957885, -14.511022344031339, 60.37347544464963, 0.17757026699477052, 88.9798006358892, -4.472063194127598, 72.74845945201666, 36.50008278169065, 64.44575744373655, 25.194712475744048, 13.838788362349476, 12.770306913153256, -12.223276232379348, 16.143728005798025, -33.50059911918473, -2.6831949986053765, -0.15852269879808745, 51.11148092460072, 2.47414289145017, 69.16664549332285, 8.531357453075088, 9.04237695476149, -5.075002853599546, 78.50093588509546, 24.19743644106883, -55.19850713582888, 45.88803925885488, -24.282159949214883, -28.40318537659487, 62.58506300433956, -5.714748753899922, -45.89772983566332, 26.60683927768826, 4.577480855120822, 27.83123899424035, 22.971852929814872, 27.559442767265224, 11.593571145268786, 2.8695454000402023, 4.532827577316439, -12.126968396355073, 28.236240645863123, -14.322163944156419, 7.5954023181346955, 50.128918016068184, 38.56007164120147, 13.399802591072536, 20.807453024136016, 10.56428386143207, 11.651584295382268, 36.82751711389291, 22.572855924778736, -41.74842732972971, 21.05360553663366, 9.493655703452914, 27.647613778804057, 13.053613881175494, 36.898934073117275, 19.636804997504505, 18.982270227011433, 21.76938549182504, -7.400799505397426, 72.57800105145638, 30.554299402972738, 15.084774202101558, 16.191035207864523, 49.44287775159003, 9.582189741188682, 45.23217553099085, 36.01456097883757, 38.138669306299406, 6.53756247131421, 37.30029782089541, 27.602903685161113, 17.776226854993773, 42.23154288324092, 45.530855375125284, 13.858751651480624], "policy_adversary_policy_reward": [3.7079849591579777, -26.358584539745657, 32.23327532164492, -39.423501281689056, 30.697214006463973, 5.474754782363268, -13.533272517321144, -24.462169510387646, 15.837732937117696, -23.99306590997251, 41.24808673508402, -34.290701570001104, -23.292762518808374, 25.294227042488192, 31.006759588666938, 7.615921748524966, -17.95279488978688, 30.379076899433766, 3.7630680716715617, -3.24810973783444, 27.3323322538798, -28.862157395908937, -5.201498884018896, -24.18685990031477, 14.737212164230074, -17.0896150536264, -10.153512190001809, 36.48578913669708, 14.398852818079032, 30.211006212970887, -37.97659473903767, -36.11541919712683, -22.279384990674647, -3.976437787034051, 13.347050257937605, -4.373585796482972, 11.41554845720922, -18.58069140343418, 12.819518383013765, 21.689579456284537, -14.26569561407024, -31.519639145908577, -3.608369879742618, 39.509271650733574, -8.753324935786381, 4.3758259790905925, 20.882737348492316, -35.39375969252366, 27.132288715748203, 33.24118672890141, 39.28084688075336, -39.10327661375859, 49.1509809629424, 39.82881967294676, -24.87808665367099, 20.406023459543395, 27.865333475985658, 44.88312597603098, 45.27417831973195, -8.774095538041301, 24.81173736294763, 39.63402008078892, 38.136982661037756, -12.942270185293708, 36.398814318563126, -22.56002595621365, 24.735935440867802, -11.965628527714546, 14.966097475085556, -27.18937370746491, 21.10927720001868, -4.965549194220657, -20.718073457289083, -12.782525661895647, 28.295500712868098, -30.97869571147347, 6.45102556530486, -6.609548264102948, 19.48340222352008, 31.62807870108063, 4.317420013410305, -1.843277121960135, 26.551930815652476, 42.61471467767038, 33.36108689855669, -24.829729445481597, 15.178817226195378, -6.136440271433887, 12.235094341237737, -17.310097194837276, 29.79568474386696, 48.7052511412285, -1.5603621723754753, 25.757798613444308, -28.749602743097903, -26.448904392730984, 7.6889014575914505, 38.199137801263426, -14.327103714163826, -9.955056235051057, -18.730367334203397, -9.672818042391473, 31.081869026460826, 31.503193977878723, -5.129651161286954, -0.5850975926129678, -22.993923409531963, -22.903806426131357, 24.07215365032961, 2.5346856273586553, 1.6728591652742217, 2.9046216898466, 13.984278906287123, 13.846960087953228, 2.75246496764915, 20.219387962165722, 10.93735834219436, 16.62208442507086, 28.84608666442149, -17.25251551915271, 3.459372060613001, -0.5898266605727969, 46.67921736188607, -42.146389784569635, -13.733879507719259, 1.6069111113641874, 13.396901903776216, 14.839338742086907, -26.296926142163265, 11.974762198006848, 11.92976500179621, -4.33436268366151, 24.58272410039618, 25.546193915672006, 34.39987823055585, 4.160193410645614, 2.823289102608018, 10.576513488464519, -0.8401761747087839, 21.647629198844804, -12.547244069337786, 23.111527930769856, -5.351716835752907, 17.003301131135185, 8.734260697949509, 28.0932564159434, 29.125092370639184, -6.552236445860448, -24.148547068410487, -17.59988026131921, 9.317119804775563, 11.7364857318581, 17.66482744152177, -8.171171738068864, 3.554900880136115, 24.092712898667944, -4.605648295902718, 17.659262177078208, -11.801963854878746, 48.70089792799601, 26.542364109006186, -6.9055591115016774, 24.38191492629162, -5.399644699280188, 31.534673876670915, -9.765288384845888, -29.689948714348958, 22.289149208951528, 26.99635731097785, 45.58164374047855, 6.919017209943796, 23.635282193028942, 2.781075740703411, 12.303698461398145, 15.999758629160059, 0.19127657870443926, 31.161718642117652, 18.281159109472366, 2.8377096156786656, 6.744480125510016, 24.420312566086718, 20.811862964904126, 21.009825321865222, 15.00473565697235, 25.25765011690111, 12.881019189398298, -5.915688817566341, 12.453251288880551, -7.057500040594828, 44.357797861490255, 18.359128010038898, 9.243775675122215, 35.92256639621396, -18.146339541220183, 8.24154847560807, 33.98999440763285, 30.149846751907955, 15.381008623217333, 18.191382960229415, -4.3326313087487875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3909890188274215, "mean_inference_ms": 0.9710271543222807, "mean_action_processing_ms": 0.16563920028601545, "mean_env_wait_ms": 0.057904004936656595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042116641998291016, "StateBufferConnector_ms": 0.0031703710556030273, "ViewRequirementAgentConnector_ms": 0.09463620185852051}, "num_episodes": 29, "episode_return_max": 177.95960127177838, "episode_return_min": -148.184027872329, "episode_return_mean": 29.12227327757614}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 438.58845924109045, "num_env_steps_trained_throughput_per_sec": 438.58845924109045, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 1764000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1764000, "timers": {"training_iteration_time_ms": 8419.549, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8419.515, "sample_time_ms": 864.867, "learn_time_ms": 7542.279, "learn_throughput": 530.344, "synch_weights_time_ms": 11.694}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000}, "done": false, "training_iteration": 147, "trial_id": "eaa30_00000", "date": "2024-08-09_18-00-32", "timestamp": 1723240832, "time_this_iter_s": 9.126230001449585, "time_total_s": 1207.7050228118896, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x178120040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1207.7050228118896, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 34.846153846153854, "ram_util_percent": 83.21538461538461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.931267619006848, "cur_kl_coeff": 0.5479854230477937, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.670755004630518, "policy_loss": -0.006763527475583253, "vf_loss": 6.673619485532165, "vf_explained_var": 0.12499622863436502, "kl": 0.007115248586765673, "entropy": 1.0496819596441964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.30925148203969, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.116567752261956, "policy_loss": 0.0011236717808060348, "vf_loss": 8.109466261665027, "vf_explained_var": 0.006516620454688867, "kl": 0.011337617814327435, "entropy": 0.9015657619883617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 141600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "env_runners": {"episode_reward_max": 166.446682285605, "episode_reward_min": -110.39701427165775, "episode_reward_mean": 47.77219392698202, "episode_len_mean": 137.35, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 13735, "policy_reward_min": {"agent_policy": -55.19850713582888, "adversary_policy": -42.146389784569635}, "policy_reward_max": {"agent_policy": 83.2233411428025, "adversary_policy": 48.7052511412285}, "policy_reward_mean": {"agent_policy": 23.88609696349101, "adversary_policy": 11.943048481745505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.944126388255192, 145.49691890403332, 73.00016556338133, 128.8915148874731, 50.389424951488145, 27.67757672469895, 25.54061382630651, -24.446552464758696, 32.28745601159604, -67.00119823836944, -5.366389997210753, -0.3170453975961749, 102.22296184920144, 4.94828578290034, 138.3332909866457, 17.062714906150177, 18.084753909522973, -10.150005707199085, 157.001871770191, 48.39487288213768, -110.39701427165775, 91.77607851770976, -48.564319898429765, -56.80637075318961, 125.17012600867915, -11.429497507799844, -91.79545967132657, 53.213678555376525, 9.154961710241643, 55.66247798848069, 45.94370585962977, 55.11888553453042, 23.18714229053763, 5.739090800080405, 9.065655154632935, -24.253936792710206, 56.47248129172626, -28.644327888312816, 15.190804636269391, 100.25783603213637, 77.12014328240295, 26.799605182145072, 41.614906048272026, 21.12856772286413, 23.303168590764535, 73.65503422778579, 45.145711849557486, -83.4968546594595, 42.10721107326734, 18.987311406905818, 55.295227557608115, 26.10722776235093, 73.79786814623449, 39.273609995009, 37.964540454022874, 43.538770983650025, -14.801599010794853, 145.1560021029128, 61.108598805945476, 30.169548404203155, 32.382070415728954, 98.88575550318001, 19.16437948237737, 90.46435106198176, 72.02912195767513, 76.27733861259883, 13.075124942628406, 74.60059564179086, 55.205807370322226, 35.552453709987546, 84.46308576648188, 91.06171075025053, 27.71750330296124, 109.2210461924893, 64.34106475173894, 53.598458264280744, 90.38501598180744, 90.68534465486272, 39.13117400104149, 52.85799745352511, 124.61166914569698, 107.45489537041092, 11.666595812071183, 30.846562300185013, 102.60410110815099, 41.998853577997096, 102.75942495494472, 96.47908799869172, 113.54410169115017, 69.60331479568444, 38.31799145702092, 130.9968750116569, 18.496783665092018, 100.37484215617307, 77.71789049006655, 70.37912343117603, 43.20087935510238, 81.67588323856546, 65.80073275046098, 166.446682285605], "episode_lengths": [68, 68, 131, 109, 66, 148, 65, 91, 128, 200, 134, 25, 36, 11, 184, 105, 200, 62, 66, 89, 200, 110, 200, 200, 191, 200, 200, 109, 2, 103, 157, 42, 169, 200, 164, 200, 108, 80, 200, 200, 98, 64, 95, 169, 172, 52, 183, 200, 170, 106, 95, 200, 85, 181, 175, 169, 123, 91, 200, 141, 167, 155, 7, 50, 32, 200, 177, 149, 200, 172, 135, 200, 140, 184, 200, 193, 70, 145, 145, 200, 200, 173, 58, 196, 193, 142, 100, 184, 120, 130, 91, 200, 109, 190, 199, 117, 175, 200, 200, 47], "policy_agent_policy_reward": [-4.472063194127598, 72.74845945201666, 36.50008278169065, 64.44575744373655, 25.194712475744048, 13.838788362349476, 12.770306913153256, -12.223276232379348, 16.143728005798025, -33.50059911918473, -2.6831949986053765, -0.15852269879808745, 51.11148092460072, 2.47414289145017, 69.16664549332285, 8.531357453075088, 9.04237695476149, -5.075002853599546, 78.50093588509546, 24.19743644106883, -55.19850713582888, 45.88803925885488, -24.282159949214883, -28.40318537659487, 62.58506300433956, -5.714748753899922, -45.89772983566332, 26.60683927768826, 4.577480855120822, 27.83123899424035, 22.971852929814872, 27.559442767265224, 11.593571145268786, 2.8695454000402023, 4.532827577316439, -12.126968396355073, 28.236240645863123, -14.322163944156419, 7.5954023181346955, 50.128918016068184, 38.56007164120147, 13.399802591072536, 20.807453024136016, 10.56428386143207, 11.651584295382268, 36.82751711389291, 22.572855924778736, -41.74842732972971, 21.05360553663366, 9.493655703452914, 27.647613778804057, 13.053613881175494, 36.898934073117275, 19.636804997504505, 18.982270227011433, 21.76938549182504, -7.400799505397426, 72.57800105145638, 30.554299402972738, 15.084774202101558, 16.191035207864523, 49.44287775159003, 9.582189741188682, 45.23217553099085, 36.01456097883757, 38.138669306299406, 6.53756247131421, 37.30029782089541, 27.602903685161113, 17.776226854993773, 42.23154288324092, 45.530855375125284, 13.858751651480624, 54.61052309624468, 32.17053237586947, 26.79922913214037, 45.19250799090374, 45.34267232743133, 19.565587000520743, 26.428998726762554, 62.3058345728485, 53.727447685205455, 5.833297906035591, 15.423281150092507, 51.30205055407545, 20.999426788998548, 51.37971247747236, 48.23954399934584, 56.772050845575066, 34.80165739784222, 19.15899572851049, 65.49843750582845, 9.248391832546016, 50.18742107808659, 38.858945245033276, 35.189561715588006, 21.600439677551204, 40.837941619282745, 32.900366375230476, 83.2233411428025], "policy_adversary_policy_reward": [-24.87808665367099, 20.406023459543395, 27.865333475985658, 44.88312597603098, 45.27417831973195, -8.774095538041301, 24.81173736294763, 39.63402008078892, 38.136982661037756, -12.942270185293708, 36.398814318563126, -22.56002595621365, 24.735935440867802, -11.965628527714546, 14.966097475085556, -27.18937370746491, 21.10927720001868, -4.965549194220657, -20.718073457289083, -12.782525661895647, 28.295500712868098, -30.97869571147347, 6.45102556530486, -6.609548264102948, 19.48340222352008, 31.62807870108063, 4.317420013410305, -1.843277121960135, 26.551930815652476, 42.61471467767038, 33.36108689855669, -24.829729445481597, 15.178817226195378, -6.136440271433887, 12.235094341237737, -17.310097194837276, 29.79568474386696, 48.7052511412285, -1.5603621723754753, 25.757798613444308, -28.749602743097903, -26.448904392730984, 7.6889014575914505, 38.199137801263426, -14.327103714163826, -9.955056235051057, -18.730367334203397, -9.672818042391473, 31.081869026460826, 31.503193977878723, -5.129651161286954, -0.5850975926129678, -22.993923409531963, -22.903806426131357, 24.07215365032961, 2.5346856273586553, 1.6728591652742217, 2.9046216898466, 13.984278906287123, 13.846960087953228, 2.75246496764915, 20.219387962165722, 10.93735834219436, 16.62208442507086, 28.84608666442149, -17.25251551915271, 3.459372060613001, -0.5898266605727969, 46.67921736188607, -42.146389784569635, -13.733879507719259, 1.6069111113641874, 13.396901903776216, 14.839338742086907, -26.296926142163265, 11.974762198006848, 11.92976500179621, -4.33436268366151, 24.58272410039618, 25.546193915672006, 34.39987823055585, 4.160193410645614, 2.823289102608018, 10.576513488464519, -0.8401761747087839, 21.647629198844804, -12.547244069337786, 23.111527930769856, -5.351716835752907, 17.003301131135185, 8.734260697949509, 28.0932564159434, 29.125092370639184, -6.552236445860448, -24.148547068410487, -17.59988026131921, 9.317119804775563, 11.7364857318581, 17.66482744152177, -8.171171738068864, 3.554900880136115, 24.092712898667944, -4.605648295902718, 17.659262177078208, -11.801963854878746, 48.70089792799601, 26.542364109006186, -6.9055591115016774, 24.38191492629162, -5.399644699280188, 31.534673876670915, -9.765288384845888, -29.689948714348958, 22.289149208951528, 26.99635731097785, 45.58164374047855, 6.919017209943796, 23.635282193028942, 2.781075740703411, 12.303698461398145, 15.999758629160059, 0.19127657870443926, 31.161718642117652, 18.281159109472366, 2.8377096156786656, 6.744480125510016, 24.420312566086718, 20.811862964904126, 21.009825321865222, 15.00473565697235, 25.25765011690111, 12.881019189398298, -5.915688817566341, 12.453251288880551, -7.057500040594828, 44.357797861490255, 18.359128010038898, 9.243775675122215, 35.92256639621396, -18.146339541220183, 8.24154847560807, 33.98999440763285, 30.149846751907955, 15.381008623217333, 18.191382960229415, -4.3326313087487875, 44.02013607859748, 10.590387017647188, 10.952169188893144, 21.218363186976333, 26.187591971912205, 0.6116371602281667, 46.472631763965744, -1.2801237730620016, 15.284039078909156, 30.058633248522185, 10.770295530483747, 8.795291470036998, 0.38127841794820583, 26.04772030881435, 29.70226181315612, 32.60357275969237, 40.19878025361339, 13.52866743159207, 2.48235573517214, 3.3509421708634513, 23.423816633041447, -8.00053548294894, 28.101150378614598, 23.20090017546086, 33.84458471015047, -12.84515792115192, 29.315345323537045, 22.06436715393529, 18.200786478639703, 30.03875752070615, 28.74774477330942, 28.024306072265645, -9.585418307598705, 44.38707570544089, 8.889064063920156, 10.269931664590327, 41.549295874689534, 23.949141631138925, -0.6923456304330813, 9.940737462979099, 8.740857577456161, 41.44656350063041, 34.51404289078607, 4.344902354247203, 16.85000835895323, 18.339553356634784, 4.079286623169125, 17.521153054382083, 13.236914533571174, 27.60102708571157, 12.04919669968179, 20.851169675548682, 45.35019092209374, 37.87315022070875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39165828699644634, "mean_inference_ms": 0.9741187981537588, "mean_action_processing_ms": 0.16606666771741388, "mean_env_wait_ms": 0.05804979253986302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00419306755065918, "StateBufferConnector_ms": 0.0032138824462890625, "ViewRequirementAgentConnector_ms": 0.09585690498352051}, "num_episodes": 27, "episode_return_max": 166.446682285605, "episode_return_min": -110.39701427165775, "episode_return_mean": 47.77219392698202}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 482.37516090585535, "num_env_steps_trained_throughput_per_sec": 482.37516090585535, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 1776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1776000, "timers": {"training_iteration_time_ms": 8467.683, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8467.649, "sample_time_ms": 877.21, "learn_time_ms": 7578.326, "learn_throughput": 527.821, "synch_weights_time_ms": 11.45}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "done": false, "training_iteration": 148, "trial_id": "eaa30_00000", "date": "2024-08-09_18-00-40", "timestamp": 1723240840, "time_this_iter_s": 8.297495126724243, "time_total_s": 1216.002517938614, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x178120700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1216.002517938614, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 28.849999999999998, "ram_util_percent": 82.56666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.254652068980787, "cur_kl_coeff": 0.5479854230477937, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.370319616731512, "policy_loss": -0.0030759375448777245, "vf_loss": 7.369172981302574, "vf_explained_var": 0.0942769362497582, "kl": 0.007705654133672989, "entropy": 1.0066284524700628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.633629629698893, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.589431032041709, "policy_loss": 0.004246658534490659, "vf_loss": 8.573277261853217, "vf_explained_var": 0.026007860464354358, "kl": 0.02258325127962356, "entropy": 0.8613045484448473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 142560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000}, "env_runners": {"episode_reward_max": 166.446682285605, "episode_reward_min": -83.4968546594595, "episode_reward_mean": 63.08749251573274, "episode_len_mean": 136.44, "episode_media": {}, "episodes_this_iter": 33, "episodes_timesteps_total": 13644, "policy_reward_min": {"agent_policy": -41.74842732972971, "adversary_policy": -42.146389784569635}, "policy_reward_max": {"agent_policy": 83.2233411428025, "adversary_policy": 48.85979151918235}, "policy_reward_mean": {"agent_policy": 31.54374625786637, "adversary_policy": 15.771873128933185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.739090800080405, 9.065655154632935, -24.253936792710206, 56.47248129172626, -28.644327888312816, 15.190804636269391, 100.25783603213637, 77.12014328240295, 26.799605182145072, 41.614906048272026, 21.12856772286413, 23.303168590764535, 73.65503422778579, 45.145711849557486, -83.4968546594595, 42.10721107326734, 18.987311406905818, 55.295227557608115, 26.10722776235093, 73.79786814623449, 39.273609995009, 37.964540454022874, 43.538770983650025, -14.801599010794853, 145.1560021029128, 61.108598805945476, 30.169548404203155, 32.382070415728954, 98.88575550318001, 19.16437948237737, 90.46435106198176, 72.02912195767513, 76.27733861259883, 13.075124942628406, 74.60059564179086, 55.205807370322226, 35.552453709987546, 84.46308576648188, 91.06171075025053, 27.71750330296124, 109.2210461924893, 64.34106475173894, 53.598458264280744, 90.38501598180744, 90.68534465486272, 39.13117400104149, 52.85799745352511, 124.61166914569698, 107.45489537041092, 11.666595812071183, 30.846562300185013, 102.60410110815099, 41.998853577997096, 102.75942495494472, 96.47908799869172, 113.54410169115017, 69.60331479568444, 38.31799145702092, 130.9968750116569, 18.496783665092018, 100.37484215617307, 77.71789049006655, 70.37912343117603, 43.20087935510238, 81.67588323856546, 65.80073275046098, 166.446682285605, 51.54563088680143, 102.91474092707747, 50.87191867354551, 16.779215405528237, 152.2417917685042, 124.80074653787273, 88.03268769996265, 76.5805212344836, 80.2691618414313, 128.80965708321588, 99.03309920995267, 112.7879919767911, 80.45985183929045, 57.616715590126034, 79.05097757327553, 110.730389548467, 41.827577707974015, 54.7611595855694, 60.506673207197395, 49.795488178654296, 75.46129888916263, 6.861133506184636, 84.9865210444661, 94.11895757201653, 43.94269736607424, 54.82865939572774, 96.08592102029313, 55.561719896317804, 44.80468545196429, 134.48219487690488, 86.28216111118739, 30.194284046343682, 97.8451273478272], "episode_lengths": [200, 164, 200, 108, 80, 200, 200, 98, 64, 95, 169, 172, 52, 183, 200, 170, 106, 95, 200, 85, 181, 175, 169, 123, 91, 200, 141, 167, 155, 7, 50, 32, 200, 177, 149, 200, 172, 135, 200, 140, 184, 200, 193, 70, 145, 145, 200, 200, 173, 58, 196, 193, 142, 100, 184, 120, 130, 91, 200, 109, 190, 199, 117, 175, 200, 200, 47, 171, 73, 38, 19, 167, 199, 98, 112, 170, 161, 60, 177, 200, 96, 85, 184, 8, 154, 59, 40, 99, 31, 44, 128, 159, 134, 107, 146, 96, 173, 149, 98, 143], "policy_agent_policy_reward": [2.8695454000402023, 4.532827577316439, -12.126968396355073, 28.236240645863123, -14.322163944156419, 7.5954023181346955, 50.128918016068184, 38.56007164120147, 13.399802591072536, 20.807453024136016, 10.56428386143207, 11.651584295382268, 36.82751711389291, 22.572855924778736, -41.74842732972971, 21.05360553663366, 9.493655703452914, 27.647613778804057, 13.053613881175494, 36.898934073117275, 19.636804997504505, 18.982270227011433, 21.76938549182504, -7.400799505397426, 72.57800105145638, 30.554299402972738, 15.084774202101558, 16.191035207864523, 49.44287775159003, 9.582189741188682, 45.23217553099085, 36.01456097883757, 38.138669306299406, 6.53756247131421, 37.30029782089541, 27.602903685161113, 17.776226854993773, 42.23154288324092, 45.530855375125284, 13.858751651480624, 54.61052309624468, 32.17053237586947, 26.79922913214037, 45.19250799090374, 45.34267232743133, 19.565587000520743, 26.428998726762554, 62.3058345728485, 53.727447685205455, 5.833297906035591, 15.423281150092507, 51.30205055407545, 20.999426788998548, 51.37971247747236, 48.23954399934584, 56.772050845575066, 34.80165739784222, 19.15899572851049, 65.49843750582845, 9.248391832546016, 50.18742107808659, 38.858945245033276, 35.189561715588006, 21.600439677551204, 40.837941619282745, 32.900366375230476, 83.2233411428025, 25.772815443400702, 51.45737046353878, 25.435959336772747, 8.389607702764117, 76.12089588425204, 62.40037326893639, 44.016343849981325, 38.29026061724181, 40.13458092071565, 64.40482854160796, 49.51654960497633, 56.39399598839555, 40.22992591964516, 28.808357795063028, 39.525488786637744, 55.36519477423348, 20.913788853987008, 27.38057979278472, 30.25333660359871, 24.897744089327137, 37.73064944458132, 3.430566753092318, 42.49326052223303, 47.059478786008256, 21.971348683037114, 27.41432969786387, 48.04296051014654, 27.780859948158906, 22.402342725982145, 67.24109743845246, 43.1410805555937, 15.09714202317184, 48.9225636739136], "policy_adversary_policy_reward": [3.459372060613001, -0.5898266605727969, 46.67921736188607, -42.146389784569635, -13.733879507719259, 1.6069111113641874, 13.396901903776216, 14.839338742086907, -26.296926142163265, 11.974762198006848, 11.92976500179621, -4.33436268366151, 24.58272410039618, 25.546193915672006, 34.39987823055585, 4.160193410645614, 2.823289102608018, 10.576513488464519, -0.8401761747087839, 21.647629198844804, -12.547244069337786, 23.111527930769856, -5.351716835752907, 17.003301131135185, 8.734260697949509, 28.0932564159434, 29.125092370639184, -6.552236445860448, -24.148547068410487, -17.59988026131921, 9.317119804775563, 11.7364857318581, 17.66482744152177, -8.171171738068864, 3.554900880136115, 24.092712898667944, -4.605648295902718, 17.659262177078208, -11.801963854878746, 48.70089792799601, 26.542364109006186, -6.9055591115016774, 24.38191492629162, -5.399644699280188, 31.534673876670915, -9.765288384845888, -29.689948714348958, 22.289149208951528, 26.99635731097785, 45.58164374047855, 6.919017209943796, 23.635282193028942, 2.781075740703411, 12.303698461398145, 15.999758629160059, 0.19127657870443926, 31.161718642117652, 18.281159109472366, 2.8377096156786656, 6.744480125510016, 24.420312566086718, 20.811862964904126, 21.009825321865222, 15.00473565697235, 25.25765011690111, 12.881019189398298, -5.915688817566341, 12.453251288880551, -7.057500040594828, 44.357797861490255, 18.359128010038898, 9.243775675122215, 35.92256639621396, -18.146339541220183, 8.24154847560807, 33.98999440763285, 30.149846751907955, 15.381008623217333, 18.191382960229415, -4.3326313087487875, 44.02013607859748, 10.590387017647188, 10.952169188893144, 21.218363186976333, 26.187591971912205, 0.6116371602281667, 46.472631763965744, -1.2801237730620016, 15.284039078909156, 30.058633248522185, 10.770295530483747, 8.795291470036998, 0.38127841794820583, 26.04772030881435, 29.70226181315612, 32.60357275969237, 40.19878025361339, 13.52866743159207, 2.48235573517214, 3.3509421708634513, 23.423816633041447, -8.00053548294894, 28.101150378614598, 23.20090017546086, 33.84458471015047, -12.84515792115192, 29.315345323537045, 22.06436715393529, 18.200786478639703, 30.03875752070615, 28.74774477330942, 28.024306072265645, -9.585418307598705, 44.38707570544089, 8.889064063920156, 10.269931664590327, 41.549295874689534, 23.949141631138925, -0.6923456304330813, 9.940737462979099, 8.740857577456161, 41.44656350063041, 34.51404289078607, 4.344902354247203, 16.85000835895323, 18.339553356634784, 4.079286623169125, 17.521153054382083, 13.236914533571174, 27.60102708571157, 12.04919669968179, 20.851169675548682, 45.35019092209374, 37.87315022070875, 0.6359516956839819, 25.136863747716724, 27.419184578189157, 24.03818588534962, 18.075027045885886, 7.360932290886861, 10.511097822779526, -2.121490120015409, 34.93418559758526, 41.186710286666795, 43.345038649869224, 19.055334619067153, 48.85979151918235, -4.84344766920103, 20.893258840062952, 17.397001777178854, 13.083999596196552, 27.050581324519094, 19.929479637302514, 44.47534890430543, 20.981593031266524, 28.534956573709806, 23.266755963144288, 33.12724002525127, 21.082119290460778, 19.14780662918439, 40.78564230669923, -11.977284511636217, 28.46401235030698, 11.061476436330757, 27.10013650735211, 28.265058266881383, 11.194501325058162, 9.719287528928845, -1.986671433695392, 29.36725122648011, 11.45323049741245, 18.80010610618626, 31.450540190407636, -6.552796101080482, 19.3103712964868, 18.42027814809452, -18.581079330812273, 22.011646083904587, 25.545349909693446, 16.947910612539598, 19.348910313128556, 27.7105684728797, 19.528653317984816, 2.4426953650522982, 19.576693479382207, 7.837636218481663, 26.085125502069253, 21.957835008077303, 13.64281784381109, 14.138042104347814, 8.216133721673142, 14.186209004309003, 36.529504523613625, 30.711592914838832, 40.43573830967387, 2.705342245919825, -17.818648726738004, 32.91579074990985, 37.92105502641958, 11.001508647494022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39247761982030704, "mean_inference_ms": 0.9755321619642165, "mean_action_processing_ms": 0.16645546847871287, "mean_env_wait_ms": 0.05820725005564611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038225650787353516, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.08934926986694336}, "num_episodes": 33, "episode_return_max": 166.446682285605, "episode_return_min": -83.4968546594595, "episode_return_mean": 63.08749251573274}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 480.98654037690545, "num_env_steps_trained_throughput_per_sec": 480.98654037690545, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 1788000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1788000, "timers": {"training_iteration_time_ms": 8408.141, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8408.107, "sample_time_ms": 843.367, "learn_time_ms": 7552.79, "learn_throughput": 529.606, "synch_weights_time_ms": 11.345}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000}, "done": false, "training_iteration": 149, "trial_id": "eaa30_00000", "date": "2024-08-09_18-00-49", "timestamp": 1723240849, "time_this_iter_s": 8.320405006408691, "time_total_s": 1224.3229229450226, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x178120a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1224.3229229450226, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 28.75, "ram_util_percent": 82.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.95552657994013, "cur_kl_coeff": 0.5479854230477937, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.731440721743952, "policy_loss": 0.0007504294485977244, "vf_loss": 7.726866977176969, "vf_explained_var": 0.05429340399131573, "kl": 0.006977017281241912, "entropy": 0.9360321369436052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.728729717123011, "cur_kl_coeff": 0.7908820381836896, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.757071108122666, "policy_loss": 0.0029274017482142276, "vf_loss": 8.740619554122288, "vf_explained_var": 0.025550475406150023, "kl": 0.01710011443598584, "entropy": 0.8176068844273686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 143520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "env_runners": {"episode_reward_max": 169.3094792279254, "episode_reward_min": 0.07002345107378893, "episode_reward_mean": 75.52412870137172, "episode_len_mean": 135.5, "episode_media": {}, "episodes_this_iter": 31, "episodes_timesteps_total": 13550, "policy_reward_min": {"agent_policy": 0.035011725536895355, "adversary_policy": -18.581079330812273}, "policy_reward_max": {"agent_policy": 84.6547396139627, "adversary_policy": 48.85979151918235}, "policy_reward_mean": {"agent_policy": 37.76206435068586, "adversary_policy": 18.88103217534293}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.02912195767513, 76.27733861259883, 13.075124942628406, 74.60059564179086, 55.205807370322226, 35.552453709987546, 84.46308576648188, 91.06171075025053, 27.71750330296124, 109.2210461924893, 64.34106475173894, 53.598458264280744, 90.38501598180744, 90.68534465486272, 39.13117400104149, 52.85799745352511, 124.61166914569698, 107.45489537041092, 11.666595812071183, 30.846562300185013, 102.60410110815099, 41.998853577997096, 102.75942495494472, 96.47908799869172, 113.54410169115017, 69.60331479568444, 38.31799145702092, 130.9968750116569, 18.496783665092018, 100.37484215617307, 77.71789049006655, 70.37912343117603, 43.20087935510238, 81.67588323856546, 65.80073275046098, 166.446682285605, 51.54563088680143, 102.91474092707747, 50.87191867354551, 16.779215405528237, 152.2417917685042, 124.80074653787273, 88.03268769996265, 76.5805212344836, 80.2691618414313, 128.80965708321588, 99.03309920995267, 112.7879919767911, 80.45985183929045, 57.616715590126034, 79.05097757327553, 110.730389548467, 41.827577707974015, 54.7611595855694, 60.506673207197395, 49.795488178654296, 75.46129888916263, 6.861133506184636, 84.9865210444661, 94.11895757201653, 43.94269736607424, 54.82865939572774, 96.08592102029313, 55.561719896317804, 44.80468545196429, 134.48219487690488, 86.28216111118739, 30.194284046343682, 97.8451273478272, 106.38755886081283, 46.8214038001684, 118.25906203001774, 69.91214671745472, 75.99528709693772, 74.63547438236051, 72.41999572313937, 142.79678631557485, 58.86393282486145, 28.835470128643685, 102.59490813512414, 114.16004739156679, 75.1151810031024, 0.07002345107378893, 122.32525019470468, 76.20017728178264, 121.89141964107365, 76.14689032852581, 34.20002093973803, 68.02346724984525, 17.731600807595086, 78.79830364686252, 14.55787630217206, 50.780371478827675, 53.20711087225794, 87.13688703520177, 55.20831402235275, 100.76366792909172, 95.08411149489389, 169.3094792279254, 94.13015187294775], "episode_lengths": [32, 200, 177, 149, 200, 172, 135, 200, 140, 184, 200, 193, 70, 145, 145, 200, 200, 173, 58, 196, 193, 142, 100, 184, 120, 130, 91, 200, 109, 190, 199, 117, 175, 200, 200, 47, 171, 73, 38, 19, 167, 199, 98, 112, 170, 161, 60, 177, 200, 96, 85, 184, 8, 154, 59, 40, 99, 31, 44, 128, 159, 134, 107, 146, 96, 173, 149, 98, 143, 144, 11, 145, 34, 127, 69, 142, 153, 200, 15, 173, 139, 145, 21, 200, 139, 194, 65, 200, 168, 94, 161, 200, 117, 200, 67, 191, 173, 160, 174, 185], "policy_agent_policy_reward": [36.01456097883757, 38.138669306299406, 6.53756247131421, 37.30029782089541, 27.602903685161113, 17.776226854993773, 42.23154288324092, 45.530855375125284, 13.858751651480624, 54.61052309624468, 32.17053237586947, 26.79922913214037, 45.19250799090374, 45.34267232743133, 19.565587000520743, 26.428998726762554, 62.3058345728485, 53.727447685205455, 5.833297906035591, 15.423281150092507, 51.30205055407545, 20.999426788998548, 51.37971247747236, 48.23954399934584, 56.772050845575066, 34.80165739784222, 19.15899572851049, 65.49843750582845, 9.248391832546016, 50.18742107808659, 38.858945245033276, 35.189561715588006, 21.600439677551204, 40.837941619282745, 32.900366375230476, 83.2233411428025, 25.772815443400702, 51.45737046353878, 25.435959336772747, 8.389607702764117, 76.12089588425204, 62.40037326893639, 44.016343849981325, 38.29026061724181, 40.13458092071565, 64.40482854160796, 49.51654960497633, 56.39399598839555, 40.22992591964516, 28.808357795063028, 39.525488786637744, 55.36519477423348, 20.913788853987008, 27.38057979278472, 30.25333660359871, 24.897744089327137, 37.73064944458132, 3.430566753092318, 42.49326052223303, 47.059478786008256, 21.971348683037114, 27.41432969786387, 48.04296051014654, 27.780859948158906, 22.402342725982145, 67.24109743845246, 43.1410805555937, 15.09714202317184, 48.9225636739136, 53.193779430406416, 23.410701900084202, 59.129531015008865, 34.95607335872734, 37.99764354846883, 37.31773719118024, 36.209997861569676, 71.39839315778742, 29.431966412430725, 14.41773506432184, 51.29745406756207, 57.080023695783396, 37.55759050155121, 0.035011725536895355, 61.162625097352404, 38.10008864089128, 60.9457098205368, 38.07344516426291, 17.10001046986901, 34.011733624922634, 8.865800403797554, 39.39915182343127, 7.278938151085926, 25.390185739413837, 26.603555436128964, 43.568443517600876, 27.604157011176344, 50.38183396454587, 47.54205574744694, 84.6547396139627, 47.06507593647381], "policy_adversary_policy_reward": [21.009825321865222, 15.00473565697235, 25.25765011690111, 12.881019189398298, -5.915688817566341, 12.453251288880551, -7.057500040594828, 44.357797861490255, 18.359128010038898, 9.243775675122215, 35.92256639621396, -18.146339541220183, 8.24154847560807, 33.98999440763285, 30.149846751907955, 15.381008623217333, 18.191382960229415, -4.3326313087487875, 44.02013607859748, 10.590387017647188, 10.952169188893144, 21.218363186976333, 26.187591971912205, 0.6116371602281667, 46.472631763965744, -1.2801237730620016, 15.284039078909156, 30.058633248522185, 10.770295530483747, 8.795291470036998, 0.38127841794820583, 26.04772030881435, 29.70226181315612, 32.60357275969237, 40.19878025361339, 13.52866743159207, 2.48235573517214, 3.3509421708634513, 23.423816633041447, -8.00053548294894, 28.101150378614598, 23.20090017546086, 33.84458471015047, -12.84515792115192, 29.315345323537045, 22.06436715393529, 18.200786478639703, 30.03875752070615, 28.74774477330942, 28.024306072265645, -9.585418307598705, 44.38707570544089, 8.889064063920156, 10.269931664590327, 41.549295874689534, 23.949141631138925, -0.6923456304330813, 9.940737462979099, 8.740857577456161, 41.44656350063041, 34.51404289078607, 4.344902354247203, 16.85000835895323, 18.339553356634784, 4.079286623169125, 17.521153054382083, 13.236914533571174, 27.60102708571157, 12.04919669968179, 20.851169675548682, 45.35019092209374, 37.87315022070875, 0.6359516956839819, 25.136863747716724, 27.419184578189157, 24.03818588534962, 18.075027045885886, 7.360932290886861, 10.511097822779526, -2.121490120015409, 34.93418559758526, 41.186710286666795, 43.345038649869224, 19.055334619067153, 48.85979151918235, -4.84344766920103, 20.893258840062952, 17.397001777178854, 13.083999596196552, 27.050581324519094, 19.929479637302514, 44.47534890430543, 20.981593031266524, 28.534956573709806, 23.266755963144288, 33.12724002525127, 21.082119290460778, 19.14780662918439, 40.78564230669923, -11.977284511636217, 28.46401235030698, 11.061476436330757, 27.10013650735211, 28.265058266881383, 11.194501325058162, 9.719287528928845, -1.986671433695392, 29.36725122648011, 11.45323049741245, 18.80010610618626, 31.450540190407636, -6.552796101080482, 19.3103712964868, 18.42027814809452, -18.581079330812273, 22.011646083904587, 25.545349909693446, 16.947910612539598, 19.348910313128556, 27.7105684728797, 19.528653317984816, 2.4426953650522982, 19.576693479382207, 7.837636218481663, 26.085125502069253, 21.957835008077303, 13.64281784381109, 14.138042104347814, 8.216133721673142, 14.186209004309003, 36.529504523613625, 30.711592914838832, 40.43573830967387, 2.705342245919825, -17.818648726738004, 32.91579074990985, 37.92105502641958, 11.001508647494022, 19.50873436332622, 33.685045067080196, 12.46580612587291, 10.944895774211291, 41.42281168631164, 17.706719328697222, 19.392317072395766, 15.563756286331571, 10.57321329051116, 27.424430257957685, 11.516422988286475, 25.801314202893774, 31.338934735216213, 4.8710631263534605, 41.12121150776148, 30.27718165002596, 16.74595902381677, 12.686007388613959, 2.5788878146650163, 11.838847249656824, 23.6944632858631, 27.602990781698978, 40.64625200999299, 16.433771685790404, 14.404409279971885, 23.153181221579324, 8.916636997636246, -8.88162527209935, 19.827781951405505, 41.33484314594689, 13.215173796165999, 24.88491484472527, 23.06662760129569, 37.87908221924111, 1.801393789032815, 36.27205137523009, 8.361788820425417, 8.738221649443595, 9.249536975855374, 24.76219664906726, 2.857823946284059, 6.007976457513497, 13.78334833639353, 25.615803487037745, 4.41190344901905, 2.8670347020668547, 9.318008461926663, 16.072177277487178, 13.15732162339668, 13.446233812732295, 28.40006534938793, 15.168378168212943, 11.845903578806151, 15.758253432370175, 30.48816630878877, 19.893667655757096, 43.637836826492105, 3.904218920954839, 36.604884133127136, 48.04985548083556, 18.78536009116383, 28.279715845309973]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3927749442388236, "mean_inference_ms": 0.9756442448695956, "mean_action_processing_ms": 0.1665487234981798, "mean_env_wait_ms": 0.05825869771521448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00344693660736084, "StateBufferConnector_ms": 0.002518177032470703, "ViewRequirementAgentConnector_ms": 0.0734872817993164}, "num_episodes": 31, "episode_return_max": 169.3094792279254, "episode_return_min": 0.07002345107378893, "episode_return_mean": 75.52412870137172}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.41904465237855, "num_env_steps_trained_throughput_per_sec": 487.41904465237855, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 1800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1800000, "timers": {"training_iteration_time_ms": 8452.066, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8452.033, "sample_time_ms": 848.207, "learn_time_ms": 7591.846, "learn_throughput": 526.881, "synch_weights_time_ms": 11.425}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "done": false, "training_iteration": 150, "trial_id": "eaa30_00000", "date": "2024-08-09_18-00-57", "timestamp": 1723240857, "time_this_iter_s": 8.211766004562378, "time_total_s": 1232.534688949585, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x178120dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1232.534688949585, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 27.2, "ram_util_percent": 82.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.680279636383057, "cur_kl_coeff": 0.5479854230477937, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.858741035410967, "policy_loss": 0.003872762562056619, "vf_loss": 6.849509672386937, "vf_explained_var": 0.2161383499228765, "kl": 0.009778794301082454, "entropy": 0.86932477178397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.197232348565013, "cur_kl_coeff": 0.7908820381836896, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.619936765730381, "policy_loss": 0.0015950922112097032, "vf_loss": 8.614263392984867, "vf_explained_var": 0.08767030692348877, "kl": 0.005156617916509276, "entropy": 0.7824027438958486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 144480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000}, "env_runners": {"episode_reward_max": 171.03359291255924, "episode_reward_min": 0.07002345107378893, "episode_reward_mean": 79.64519618496372, "episode_len_mean": 128.05, "episode_media": {}, "episodes_this_iter": 32, "episodes_timesteps_total": 12805, "policy_reward_min": {"agent_policy": 0.035011725536895355, "adversary_policy": -18.581079330812273}, "policy_reward_max": {"agent_policy": 85.51679645627965, "adversary_policy": 49.98462895749368}, "policy_reward_mean": {"agent_policy": 39.822598092481854, "adversary_policy": 19.911299046240927}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.20087935510238, 81.67588323856546, 65.80073275046098, 166.446682285605, 51.54563088680143, 102.91474092707747, 50.87191867354551, 16.779215405528237, 152.2417917685042, 124.80074653787273, 88.03268769996265, 76.5805212344836, 80.2691618414313, 128.80965708321588, 99.03309920995267, 112.7879919767911, 80.45985183929045, 57.616715590126034, 79.05097757327553, 110.730389548467, 41.827577707974015, 54.7611595855694, 60.506673207197395, 49.795488178654296, 75.46129888916263, 6.861133506184636, 84.9865210444661, 94.11895757201653, 43.94269736607424, 54.82865939572774, 96.08592102029313, 55.561719896317804, 44.80468545196429, 134.48219487690488, 86.28216111118739, 30.194284046343682, 97.8451273478272, 106.38755886081283, 46.8214038001684, 118.25906203001774, 69.91214671745472, 75.99528709693772, 74.63547438236051, 72.41999572313937, 142.79678631557485, 58.86393282486145, 28.835470128643685, 102.59490813512414, 114.16004739156679, 75.1151810031024, 0.07002345107378893, 122.32525019470468, 76.20017728178264, 121.89141964107365, 76.14689032852581, 34.20002093973803, 68.02346724984525, 17.731600807595086, 78.79830364686252, 14.55787630217206, 50.780371478827675, 53.20711087225794, 87.13688703520177, 55.20831402235275, 100.76366792909172, 95.08411149489389, 169.3094792279254, 94.13015187294775, 120.81973716578256, 82.64838678101066, 112.73016336516795, 47.624761202155, 26.33810662656927, 83.90668786305787, 98.71606876073609, 47.351703498348385, 82.88187868203417, 41.977692788099525, 80.82840423577063, 171.03359291255924, 52.48583296929276, 100.24437657405522, 134.25980601947776, 35.72416018588987, 87.91485414326841, 127.26231483590547, 108.63605866774631, 50.0877842679311, 165.02564817431477, 35.588693806282606, 14.136991861457913, 45.868600963770405, 32.28633900681002, 87.11733929137027, 120.39466336987724, 89.78663349997016, 58.46919668742986, 55.189665944149006, 127.52852386015888, 155.2970366693607], "episode_lengths": [175, 200, 200, 47, 171, 73, 38, 19, 167, 199, 98, 112, 170, 161, 60, 177, 200, 96, 85, 184, 8, 154, 59, 40, 99, 31, 44, 128, 159, 134, 107, 146, 96, 173, 149, 98, 143, 144, 11, 145, 34, 127, 69, 142, 153, 200, 15, 173, 139, 145, 21, 200, 139, 194, 65, 200, 168, 94, 161, 200, 117, 200, 67, 191, 173, 160, 174, 185, 181, 50, 199, 58, 53, 200, 92, 200, 66, 22, 121, 184, 66, 168, 160, 38, 44, 198, 200, 98, 159, 123, 106, 70, 200, 188, 98, 200, 57, 200, 200, 200], "policy_agent_policy_reward": [21.600439677551204, 40.837941619282745, 32.900366375230476, 83.2233411428025, 25.772815443400702, 51.45737046353878, 25.435959336772747, 8.389607702764117, 76.12089588425204, 62.40037326893639, 44.016343849981325, 38.29026061724181, 40.13458092071565, 64.40482854160796, 49.51654960497633, 56.39399598839555, 40.22992591964516, 28.808357795063028, 39.525488786637744, 55.36519477423348, 20.913788853987008, 27.38057979278472, 30.25333660359871, 24.897744089327137, 37.73064944458132, 3.430566753092318, 42.49326052223303, 47.059478786008256, 21.971348683037114, 27.41432969786387, 48.04296051014654, 27.780859948158906, 22.402342725982145, 67.24109743845246, 43.1410805555937, 15.09714202317184, 48.9225636739136, 53.193779430406416, 23.410701900084202, 59.129531015008865, 34.95607335872734, 37.99764354846883, 37.31773719118024, 36.209997861569676, 71.39839315778742, 29.431966412430725, 14.41773506432184, 51.29745406756207, 57.080023695783396, 37.55759050155121, 0.035011725536895355, 61.162625097352404, 38.10008864089128, 60.9457098205368, 38.07344516426291, 17.10001046986901, 34.011733624922634, 8.865800403797554, 39.39915182343127, 7.278938151085926, 25.390185739413837, 26.603555436128964, 43.568443517600876, 27.604157011176344, 50.38183396454587, 47.54205574744694, 84.6547396139627, 47.06507593647381, 60.409868582891285, 41.32419339050533, 56.365081682583956, 23.812380601077496, 13.169053313284635, 41.95334393152894, 49.35803438036806, 23.6758517491742, 41.4409393410171, 20.98884639404976, 40.414202117885324, 85.51679645627965, 26.242916484646372, 50.12218828702759, 67.12990300973887, 17.862080092944936, 43.957427071634214, 63.63115741795275, 54.318029333873156, 25.04389213396555, 82.5128240871574, 17.794346903141296, 7.068495930728959, 22.9343004818852, 16.14316950340501, 43.558669645685136, 60.19733168493859, 44.89331674998511, 29.23459834371492, 27.594832972074492, 63.76426193007943, 77.64851833468032], "policy_adversary_policy_reward": [4.079286623169125, 17.521153054382083, 13.236914533571174, 27.60102708571157, 12.04919669968179, 20.851169675548682, 45.35019092209374, 37.87315022070875, 0.6359516956839819, 25.136863747716724, 27.419184578189157, 24.03818588534962, 18.075027045885886, 7.360932290886861, 10.511097822779526, -2.121490120015409, 34.93418559758526, 41.186710286666795, 43.345038649869224, 19.055334619067153, 48.85979151918235, -4.84344766920103, 20.893258840062952, 17.397001777178854, 13.083999596196552, 27.050581324519094, 19.929479637302514, 44.47534890430543, 20.981593031266524, 28.534956573709806, 23.266755963144288, 33.12724002525127, 21.082119290460778, 19.14780662918439, 40.78564230669923, -11.977284511636217, 28.46401235030698, 11.061476436330757, 27.10013650735211, 28.265058266881383, 11.194501325058162, 9.719287528928845, -1.986671433695392, 29.36725122648011, 11.45323049741245, 18.80010610618626, 31.450540190407636, -6.552796101080482, 19.3103712964868, 18.42027814809452, -18.581079330812273, 22.011646083904587, 25.545349909693446, 16.947910612539598, 19.348910313128556, 27.7105684728797, 19.528653317984816, 2.4426953650522982, 19.576693479382207, 7.837636218481663, 26.085125502069253, 21.957835008077303, 13.64281784381109, 14.138042104347814, 8.216133721673142, 14.186209004309003, 36.529504523613625, 30.711592914838832, 40.43573830967387, 2.705342245919825, -17.818648726738004, 32.91579074990985, 37.92105502641958, 11.001508647494022, 19.50873436332622, 33.685045067080196, 12.46580612587291, 10.944895774211291, 41.42281168631164, 17.706719328697222, 19.392317072395766, 15.563756286331571, 10.57321329051116, 27.424430257957685, 11.516422988286475, 25.801314202893774, 31.338934735216213, 4.8710631263534605, 41.12121150776148, 30.27718165002596, 16.74595902381677, 12.686007388613959, 2.5788878146650163, 11.838847249656824, 23.6944632858631, 27.602990781698978, 40.64625200999299, 16.433771685790404, 14.404409279971885, 23.153181221579324, 8.916636997636246, -8.88162527209935, 19.827781951405505, 41.33484314594689, 13.215173796165999, 24.88491484472527, 23.06662760129569, 37.87908221924111, 1.801393789032815, 36.27205137523009, 8.361788820425417, 8.738221649443595, 9.249536975855374, 24.76219664906726, 2.857823946284059, 6.007976457513497, 13.78334833639353, 25.615803487037745, 4.41190344901905, 2.8670347020668547, 9.318008461926663, 16.072177277487178, 13.15732162339668, 13.446233812732295, 28.40006534938793, 15.168378168212943, 11.845903578806151, 15.758253432370175, 30.48816630878877, 19.893667655757096, 43.637836826492105, 3.904218920954839, 36.604884133127136, 48.04985548083556, 18.78536009116383, 28.279715845309973, 37.15344547332861, 23.25642310956268, 13.274078390603854, 28.05011499990148, 14.115109973752642, 42.24997170883134, 37.565325369267825, -13.752944768190329, -3.3898019586876664, 16.558855271972305, 14.995121510567598, 26.958222420961334, 25.76288821022112, 23.595146170146936, 23.00778856521574, 0.6680631839584503, 40.13278165477931, 1.308157686237788, 7.75606561414331, 13.232780779906445, 32.76995404994102, 7.644248067944297, 40.32511421458295, 45.191682241696704, 1.1434524522533938, 25.09946403239298, 13.830433311473646, 36.29175497555394, 33.39554290265609, 33.7343601070828, -4.693660399925953, 22.55574049287089, 13.282501147592177, 30.67492592404204, 40.50570784724387, 23.125449570708888, 31.791367271528863, 22.526662062344293, 9.708344165387858, 15.335547968577691, 46.516461847817766, 35.996362239339604, 6.332067470867723, 11.46227943227357, 12.711444007713908, -5.642948076984954, 7.884009336353424, 15.050291145531776, 8.531585816908924, 7.611583686496093, 25.853425502070007, 17.70524414361513, 38.044484401063855, 22.152847283874735, 18.318922354013495, 26.574394395971613, 22.8513437928612, 6.383254550853723, 18.5091125178472, 9.0857204542273, 36.7948766013697, 26.969385328709727, 27.663889377186635, 49.98462895749368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3929524405666991, "mean_inference_ms": 0.9755032107361743, "mean_action_processing_ms": 0.1665335968198285, "mean_env_wait_ms": 0.058334420346672876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003488302230834961, "StateBufferConnector_ms": 0.0025440454483032227, "ViewRequirementAgentConnector_ms": 0.07351160049438477}, "num_episodes": 32, "episode_return_max": 171.03359291255924, "episode_return_min": 0.07002345107378893, "episode_return_mean": 79.64519618496372}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.87999933125303, "num_env_steps_trained_throughput_per_sec": 500.87999933125303, "timesteps_total": 604000, "num_env_steps_sampled_lifetime": 604000, "num_agent_steps_sampled_lifetime": 1812000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1812000, "timers": {"training_iteration_time_ms": 8461.604, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8461.57, "sample_time_ms": 854.202, "learn_time_ms": 7595.296, "learn_throughput": 526.642, "synch_weights_time_ms": 11.504}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000}, "done": false, "training_iteration": 151, "trial_id": "eaa30_00000", "date": "2024-08-09_18-01-05", "timestamp": 1723240865, "time_this_iter_s": 7.990412950515747, "time_total_s": 1240.5251019001007, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17807c430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1240.5251019001007, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 27.58333333333333, "ram_util_percent": 81.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.214865467535756, "cur_kl_coeff": 0.5479854230477937, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.782895540308069, "policy_loss": -0.0019336167690910833, "vf_loss": 6.78122686406292, "vf_explained_var": 0.18231446853390446, "kl": 0.006573680589941365, "entropy": 0.8090231039852062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.778305402336022, "cur_kl_coeff": 0.7908820381836896, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.120593938728174, "policy_loss": 0.0021262456648400985, "vf_loss": 8.114266283313434, "vf_explained_var": 0.0018634567037224769, "kl": 0.005312315979244886, "entropy": 0.7666099128623803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 145440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "env_runners": {"episode_reward_max": 171.03359291255924, "episode_reward_min": 0.07002345107378893, "episode_reward_mean": 84.81109339979874, "episode_len_mean": 135.08, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 13508, "policy_reward_min": {"agent_policy": 0.035011725536895355, "adversary_policy": -17.818648726738004}, "policy_reward_max": {"agent_policy": 85.51679645627965, "adversary_policy": 49.98462895749368}, "policy_reward_mean": {"agent_policy": 42.40554669989936, "adversary_policy": 21.202773349949684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.9865210444661, 94.11895757201653, 43.94269736607424, 54.82865939572774, 96.08592102029313, 55.561719896317804, 44.80468545196429, 134.48219487690488, 86.28216111118739, 30.194284046343682, 97.8451273478272, 106.38755886081283, 46.8214038001684, 118.25906203001774, 69.91214671745472, 75.99528709693772, 74.63547438236051, 72.41999572313937, 142.79678631557485, 58.86393282486145, 28.835470128643685, 102.59490813512414, 114.16004739156679, 75.1151810031024, 0.07002345107378893, 122.32525019470468, 76.20017728178264, 121.89141964107365, 76.14689032852581, 34.20002093973803, 68.02346724984525, 17.731600807595086, 78.79830364686252, 14.55787630217206, 50.780371478827675, 53.20711087225794, 87.13688703520177, 55.20831402235275, 100.76366792909172, 95.08411149489389, 169.3094792279254, 94.13015187294775, 120.81973716578256, 82.64838678101066, 112.73016336516795, 47.624761202155, 26.33810662656927, 83.90668786305787, 98.71606876073609, 47.351703498348385, 82.88187868203417, 41.977692788099525, 80.82840423577063, 171.03359291255924, 52.48583296929276, 100.24437657405522, 134.25980601947776, 35.72416018588987, 87.91485414326841, 127.26231483590547, 108.63605866774631, 50.0877842679311, 165.02564817431477, 35.588693806282606, 14.136991861457913, 45.868600963770405, 32.28633900681002, 87.11733929137027, 120.39466336987724, 89.78663349997016, 58.46919668742986, 55.189665944149006, 127.52852386015888, 155.2970366693607, 142.48739253539173, 62.31579180172173, 163.14457288610106, 73.1588137894345, 65.21023562143861, 139.98517418261338, 47.87337983302811, 128.13545837113173, 77.80250657650295, 152.1477095340813, 127.7956602217986, 80.04415252113748, 104.37910083978197, 13.279161804872725, 39.77447408114064, 34.64150925087744, 134.33006842542306, 130.093459485904, 101.41061705286859, 161.2922658491036, 57.56313147598827, 80.30462265201919, 121.85042602324484, 146.27387159907065, 84.20691791963071, 105.9518536499964], "episode_lengths": [44, 128, 159, 134, 107, 146, 96, 173, 149, 98, 143, 144, 11, 145, 34, 127, 69, 142, 153, 200, 15, 173, 139, 145, 21, 200, 139, 194, 65, 200, 168, 94, 161, 200, 117, 200, 67, 191, 173, 160, 174, 185, 181, 50, 199, 58, 53, 200, 92, 200, 66, 22, 121, 184, 66, 168, 160, 38, 44, 198, 200, 98, 159, 123, 106, 70, 200, 188, 98, 200, 57, 200, 200, 200, 172, 200, 200, 189, 73, 200, 163, 77, 200, 62, 175, 191, 200, 25, 140, 42, 200, 56, 133, 200, 113, 131, 200, 127, 57, 200], "policy_agent_policy_reward": [42.49326052223303, 47.059478786008256, 21.971348683037114, 27.41432969786387, 48.04296051014654, 27.780859948158906, 22.402342725982145, 67.24109743845246, 43.1410805555937, 15.09714202317184, 48.9225636739136, 53.193779430406416, 23.410701900084202, 59.129531015008865, 34.95607335872734, 37.99764354846883, 37.31773719118024, 36.209997861569676, 71.39839315778742, 29.431966412430725, 14.41773506432184, 51.29745406756207, 57.080023695783396, 37.55759050155121, 0.035011725536895355, 61.162625097352404, 38.10008864089128, 60.9457098205368, 38.07344516426291, 17.10001046986901, 34.011733624922634, 8.865800403797554, 39.39915182343127, 7.278938151085926, 25.390185739413837, 26.603555436128964, 43.568443517600876, 27.604157011176344, 50.38183396454587, 47.54205574744694, 84.6547396139627, 47.06507593647381, 60.409868582891285, 41.32419339050533, 56.365081682583956, 23.812380601077496, 13.169053313284635, 41.95334393152894, 49.35803438036806, 23.6758517491742, 41.4409393410171, 20.98884639404976, 40.414202117885324, 85.51679645627965, 26.242916484646372, 50.12218828702759, 67.12990300973887, 17.862080092944936, 43.957427071634214, 63.63115741795275, 54.318029333873156, 25.04389213396555, 82.5128240871574, 17.794346903141296, 7.068495930728959, 22.9343004818852, 16.14316950340501, 43.558669645685136, 60.19733168493859, 44.89331674998511, 29.23459834371492, 27.594832972074492, 63.76426193007943, 77.64851833468032, 71.24369626769584, 31.157895900860847, 81.57228644305061, 36.57940689471723, 32.605117810719285, 69.9925870913067, 23.936689916514034, 64.06772918556584, 38.90125328825146, 76.07385476704063, 63.89783011089934, 40.02207626056874, 52.18955041989099, 6.639580902436359, 19.88723704057031, 17.320754625438724, 67.1650342127115, 65.04672974295201, 50.70530852643434, 80.64613292455176, 28.78156573799411, 40.15231132600956, 60.925213011622375, 73.13693579953532, 42.10345895981537, 52.9759268249982], "policy_adversary_policy_reward": [25.545349909693446, 16.947910612539598, 19.348910313128556, 27.7105684728797, 19.528653317984816, 2.4426953650522982, 19.576693479382207, 7.837636218481663, 26.085125502069253, 21.957835008077303, 13.64281784381109, 14.138042104347814, 8.216133721673142, 14.186209004309003, 36.529504523613625, 30.711592914838832, 40.43573830967387, 2.705342245919825, -17.818648726738004, 32.91579074990985, 37.92105502641958, 11.001508647494022, 19.50873436332622, 33.685045067080196, 12.46580612587291, 10.944895774211291, 41.42281168631164, 17.706719328697222, 19.392317072395766, 15.563756286331571, 10.57321329051116, 27.424430257957685, 11.516422988286475, 25.801314202893774, 31.338934735216213, 4.8710631263534605, 41.12121150776148, 30.27718165002596, 16.74595902381677, 12.686007388613959, 2.5788878146650163, 11.838847249656824, 23.6944632858631, 27.602990781698978, 40.64625200999299, 16.433771685790404, 14.404409279971885, 23.153181221579324, 8.916636997636246, -8.88162527209935, 19.827781951405505, 41.33484314594689, 13.215173796165999, 24.88491484472527, 23.06662760129569, 37.87908221924111, 1.801393789032815, 36.27205137523009, 8.361788820425417, 8.738221649443595, 9.249536975855374, 24.76219664906726, 2.857823946284059, 6.007976457513497, 13.78334833639353, 25.615803487037745, 4.41190344901905, 2.8670347020668547, 9.318008461926663, 16.072177277487178, 13.15732162339668, 13.446233812732295, 28.40006534938793, 15.168378168212943, 11.845903578806151, 15.758253432370175, 30.48816630878877, 19.893667655757096, 43.637836826492105, 3.904218920954839, 36.604884133127136, 48.04985548083556, 18.78536009116383, 28.279715845309973, 37.15344547332861, 23.25642310956268, 13.274078390603854, 28.05011499990148, 14.115109973752642, 42.24997170883134, 37.565325369267825, -13.752944768190329, -3.3898019586876664, 16.558855271972305, 14.995121510567598, 26.958222420961334, 25.76288821022112, 23.595146170146936, 23.00778856521574, 0.6680631839584503, 40.13278165477931, 1.308157686237788, 7.75606561414331, 13.232780779906445, 32.76995404994102, 7.644248067944297, 40.32511421458295, 45.191682241696704, 1.1434524522533938, 25.09946403239298, 13.830433311473646, 36.29175497555394, 33.39554290265609, 33.7343601070828, -4.693660399925953, 22.55574049287089, 13.282501147592177, 30.67492592404204, 40.50570784724387, 23.125449570708888, 31.791367271528863, 22.526662062344293, 9.708344165387858, 15.335547968577691, 46.516461847817766, 35.996362239339604, 6.332067470867723, 11.46227943227357, 12.711444007713908, -5.642948076984954, 7.884009336353424, 15.050291145531776, 8.531585816908924, 7.611583686496093, 25.853425502070007, 17.70524414361513, 38.044484401063855, 22.152847283874735, 18.318922354013495, 26.574394395971613, 22.8513437928612, 6.383254550853723, 18.5091125178472, 9.0857204542273, 36.7948766013697, 26.969385328709727, 27.663889377186635, 49.98462895749368, 31.556847672003443, 39.68684859569241, 16.957216729503944, 14.200679171356906, 40.232888880887074, 41.339397562163505, 20.612815441878187, 15.96659145283904, 48.10617909481976, -15.501061284100473, 24.446397474463645, 45.54618961684305, 8.683396523701632, 15.253293392812402, 35.57991920772733, 28.487809977838513, 20.040776609834282, 18.86047667841718, 44.584895175912095, 31.488959591128534, 29.19347758645997, 34.70435252443938, 19.759784138293313, 20.262292122275433, 12.39487406189087, 39.794676358000125, -16.84358173552193, 23.48316263795829, 35.2515221190035, -15.364285078433195, 17.658617445215455, -0.3378628197767348, 34.779106371291164, 32.38592784142034, 37.682415064054915, 27.364314678897113, 37.86791844231182, 12.83739008412251, 45.00054026631449, 35.645592658237305, 18.65994695402568, 10.121618783968431, 16.725179530833984, 23.42713179517561, 14.32673484434062, 46.59847816728176, 31.210698044620933, 41.92623775491441, 46.70438503682857, -4.600926077013195, 28.001487248791427, 24.974439576206763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3928136239765731, "mean_inference_ms": 0.9751786295486711, "mean_action_processing_ms": 0.16673189309338324, "mean_env_wait_ms": 0.058303716980430735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034003257751464844, "StateBufferConnector_ms": 0.0025262832641601562, "ViewRequirementAgentConnector_ms": 0.0736609697341919}, "num_episodes": 26, "episode_return_max": 171.03359291255924, "episode_return_min": 0.07002345107378893, "episode_return_mean": 84.81109339979874}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 468.70334276417765, "num_env_steps_trained_throughput_per_sec": 468.70334276417765, "timesteps_total": 608000, "num_env_steps_sampled_lifetime": 608000, "num_agent_steps_sampled_lifetime": 1824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1824000, "timers": {"training_iteration_time_ms": 8527.941, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8527.907, "sample_time_ms": 859.95, "learn_time_ms": 7655.841, "learn_throughput": 522.477, "synch_weights_time_ms": 11.546}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "done": false, "training_iteration": 152, "trial_id": "eaa30_00000", "date": "2024-08-09_18-01-14", "timestamp": 1723240874, "time_this_iter_s": 8.538364887237549, "time_total_s": 1249.0634667873383, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17807c790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1249.0634667873383, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 29.700000000000003, "ram_util_percent": 81.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.285335953651913, "cur_kl_coeff": 0.5479854230477937, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.058180649318392, "policy_loss": -0.0010534541513869372, "vf_loss": 7.056100540817099, "vf_explained_var": -0.014050286156790597, "kl": 0.005718303910239782, "entropy": 0.728278112411499, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.890739811149737, "cur_kl_coeff": 0.7908820381836896, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.52016963561376, "policy_loss": 0.0016223819785712598, "vf_loss": 8.51556069503228, "vf_explained_var": -0.10607520236323277, "kl": 0.0037762708194350124, "entropy": 0.7726229962582389, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 146400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000}, "env_runners": {"episode_reward_max": 171.03359291255924, "episode_reward_min": 13.279161804872725, "episode_reward_mean": 88.33346172926252, "episode_len_mean": 142.19, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 14219, "policy_reward_min": {"agent_policy": 6.639580902436359, "adversary_policy": -16.84358173552193}, "policy_reward_max": {"agent_policy": 85.51679645627965, "adversary_policy": 49.98462895749368}, "policy_reward_mean": {"agent_policy": 44.16673086463126, "adversary_policy": 22.08336543231564}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.14689032852581, 34.20002093973803, 68.02346724984525, 17.731600807595086, 78.79830364686252, 14.55787630217206, 50.780371478827675, 53.20711087225794, 87.13688703520177, 55.20831402235275, 100.76366792909172, 95.08411149489389, 169.3094792279254, 94.13015187294775, 120.81973716578256, 82.64838678101066, 112.73016336516795, 47.624761202155, 26.33810662656927, 83.90668786305787, 98.71606876073609, 47.351703498348385, 82.88187868203417, 41.977692788099525, 80.82840423577063, 171.03359291255924, 52.48583296929276, 100.24437657405522, 134.25980601947776, 35.72416018588987, 87.91485414326841, 127.26231483590547, 108.63605866774631, 50.0877842679311, 165.02564817431477, 35.588693806282606, 14.136991861457913, 45.868600963770405, 32.28633900681002, 87.11733929137027, 120.39466336987724, 89.78663349997016, 58.46919668742986, 55.189665944149006, 127.52852386015888, 155.2970366693607, 142.48739253539173, 62.31579180172173, 163.14457288610106, 73.1588137894345, 65.21023562143861, 139.98517418261338, 47.87337983302811, 128.13545837113173, 77.80250657650295, 152.1477095340813, 127.7956602217986, 80.04415252113748, 104.37910083978197, 13.279161804872725, 39.77447408114064, 34.64150925087744, 134.33006842542306, 130.093459485904, 101.41061705286859, 161.2922658491036, 57.56313147598827, 80.30462265201919, 121.85042602324484, 146.27387159907065, 84.20691791963071, 105.9518536499964, 79.2354775817785, 98.8951445587893, 146.01387850272084, 101.49874876993681, 146.63207035293408, 158.79861917646988, 33.73556785289328, 72.43254979920334, 140.21732573273079, 34.036071228198935, 112.8028831549646, 103.98686654530954, 72.47013096343271, 55.03648585584094, 81.57785430261934, 90.53996478706416, 69.69646919660985, 159.23506870087465, 46.97137062467504, 107.3275606151338, 53.311425661465435, 151.2189712197849, 49.57804771695399, 36.73278394665326, 144.5208593298035, 79.80618663622263, 79.16759071742062, 77.17791352341962], "episode_lengths": [65, 200, 168, 94, 161, 200, 117, 200, 67, 191, 173, 160, 174, 185, 181, 50, 199, 58, 53, 200, 92, 200, 66, 22, 121, 184, 66, 168, 160, 38, 44, 198, 200, 98, 159, 123, 106, 70, 200, 188, 98, 200, 57, 200, 200, 200, 172, 200, 200, 189, 73, 200, 163, 77, 200, 62, 175, 191, 200, 25, 140, 42, 200, 56, 133, 200, 113, 131, 200, 127, 57, 200, 200, 197, 58, 66, 196, 180, 132, 151, 200, 119, 160, 200, 89, 132, 97, 194, 200, 79, 145, 157, 184, 200, 56, 100, 200, 200, 48, 199], "policy_agent_policy_reward": [38.07344516426291, 17.10001046986901, 34.011733624922634, 8.865800403797554, 39.39915182343127, 7.278938151085926, 25.390185739413837, 26.603555436128964, 43.568443517600876, 27.604157011176344, 50.38183396454587, 47.54205574744694, 84.6547396139627, 47.06507593647381, 60.409868582891285, 41.32419339050533, 56.365081682583956, 23.812380601077496, 13.169053313284635, 41.95334393152894, 49.35803438036806, 23.6758517491742, 41.4409393410171, 20.98884639404976, 40.414202117885324, 85.51679645627965, 26.242916484646372, 50.12218828702759, 67.12990300973887, 17.862080092944936, 43.957427071634214, 63.63115741795275, 54.318029333873156, 25.04389213396555, 82.5128240871574, 17.794346903141296, 7.068495930728959, 22.9343004818852, 16.14316950340501, 43.558669645685136, 60.19733168493859, 44.89331674998511, 29.23459834371492, 27.594832972074492, 63.76426193007943, 77.64851833468032, 71.24369626769584, 31.157895900860847, 81.57228644305061, 36.57940689471723, 32.605117810719285, 69.9925870913067, 23.936689916514034, 64.06772918556584, 38.90125328825146, 76.07385476704063, 63.89783011089934, 40.02207626056874, 52.18955041989099, 6.639580902436359, 19.88723704057031, 17.320754625438724, 67.1650342127115, 65.04672974295201, 50.70530852643434, 80.64613292455176, 28.78156573799411, 40.15231132600956, 60.925213011622375, 73.13693579953532, 42.10345895981537, 52.9759268249982, 39.61773879088922, 49.447572279394635, 73.00693925136044, 50.74937438496842, 73.31603517646703, 79.39930958823489, 16.86778392644661, 36.216274899601665, 70.10866286636538, 17.018035614099464, 56.40144157748234, 51.99343327265474, 36.23506548171636, 27.51824292792046, 40.78892715130968, 45.2699823935321, 34.84823459830487, 79.61753435043732, 23.48568531233752, 53.6637803075669, 26.65571283073276, 75.60948560989246, 24.789023858476988, 18.366391973326635, 72.26042966490175, 39.903093318111324, 39.58379535871031, 38.58895676170981], "policy_adversary_policy_reward": [1.801393789032815, 36.27205137523009, 8.361788820425417, 8.738221649443595, 9.249536975855374, 24.76219664906726, 2.857823946284059, 6.007976457513497, 13.78334833639353, 25.615803487037745, 4.41190344901905, 2.8670347020668547, 9.318008461926663, 16.072177277487178, 13.15732162339668, 13.446233812732295, 28.40006534938793, 15.168378168212943, 11.845903578806151, 15.758253432370175, 30.48816630878877, 19.893667655757096, 43.637836826492105, 3.904218920954839, 36.604884133127136, 48.04985548083556, 18.78536009116383, 28.279715845309973, 37.15344547332861, 23.25642310956268, 13.274078390603854, 28.05011499990148, 14.115109973752642, 42.24997170883134, 37.565325369267825, -13.752944768190329, -3.3898019586876664, 16.558855271972305, 14.995121510567598, 26.958222420961334, 25.76288821022112, 23.595146170146936, 23.00778856521574, 0.6680631839584503, 40.13278165477931, 1.308157686237788, 7.75606561414331, 13.232780779906445, 32.76995404994102, 7.644248067944297, 40.32511421458295, 45.191682241696704, 1.1434524522533938, 25.09946403239298, 13.830433311473646, 36.29175497555394, 33.39554290265609, 33.7343601070828, -4.693660399925953, 22.55574049287089, 13.282501147592177, 30.67492592404204, 40.50570784724387, 23.125449570708888, 31.791367271528863, 22.526662062344293, 9.708344165387858, 15.335547968577691, 46.516461847817766, 35.996362239339604, 6.332067470867723, 11.46227943227357, 12.711444007713908, -5.642948076984954, 7.884009336353424, 15.050291145531776, 8.531585816908924, 7.611583686496093, 25.853425502070007, 17.70524414361513, 38.044484401063855, 22.152847283874735, 18.318922354013495, 26.574394395971613, 22.8513437928612, 6.383254550853723, 18.5091125178472, 9.0857204542273, 36.7948766013697, 26.969385328709727, 27.663889377186635, 49.98462895749368, 31.556847672003443, 39.68684859569241, 16.957216729503944, 14.200679171356906, 40.232888880887074, 41.339397562163505, 20.612815441878187, 15.96659145283904, 48.10617909481976, -15.501061284100473, 24.446397474463645, 45.54618961684305, 8.683396523701632, 15.253293392812402, 35.57991920772733, 28.487809977838513, 20.040776609834282, 18.86047667841718, 44.584895175912095, 31.488959591128534, 29.19347758645997, 34.70435252443938, 19.759784138293313, 20.262292122275433, 12.39487406189087, 39.794676358000125, -16.84358173552193, 23.48316263795829, 35.2515221190035, -15.364285078433195, 17.658617445215455, -0.3378628197767348, 34.779106371291164, 32.38592784142034, 37.682415064054915, 27.364314678897113, 37.86791844231182, 12.83739008412251, 45.00054026631449, 35.645592658237305, 18.65994695402568, 10.121618783968431, 16.725179530833984, 23.42713179517561, 14.32673484434062, 46.59847816728176, 31.210698044620933, 41.92623775491441, 46.70438503682857, -4.600926077013195, 28.001487248791427, 24.974439576206763, 22.784769275776483, 16.832969515112744, 22.424090824926953, 27.023481454467692, 37.079740309142665, 35.927198942217764, 24.02590010984286, 26.723474275125565, 36.41058978808376, 36.90544538838326, 36.252915279731056, 43.146394308503844, 7.626080518141574, 9.241703408305032, 11.752582758407945, 24.463692141193718, 40.31111194465501, 29.797550921710368, 3.0093098846265676, 14.008725729472896, 20.74740458421244, 35.6540369932699, 28.769345380152124, 23.224087892502634, 7.481252867453918, 28.753812614262436, -14.2258167798682, 41.74405970778868, 16.6096035252998, 24.179323626009875, 24.299311218797936, 20.970671174734168, 19.261242589429553, 15.586992008875317, 35.921934330750794, 43.6956000196865, 12.703034018975545, 10.782651293361976, 25.536218934090424, 28.12756137347648, 7.784331939362147, 18.871380891370617, 37.88164132509283, 37.72784428479963, 28.255959518698962, -3.466935660221977, 8.962962502864723, 9.403429470461912, 34.70073039991537, 37.55969926498636, 33.05271891680695, 6.8503744013043715, 13.296052764258182, 26.287742594452126, 13.590403891926197, 24.998552869783616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39276119618078853, "mean_inference_ms": 0.9755184667087627, "mean_action_processing_ms": 0.16656258229576826, "mean_env_wait_ms": 0.05826800190458562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003718733787536621, "StateBufferConnector_ms": 0.002528071403503418, "ViewRequirementAgentConnector_ms": 0.06908905506134033}, "num_episodes": 28, "episode_return_max": 171.03359291255924, "episode_return_min": 13.279161804872725, "episode_return_mean": 88.33346172926252}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.8375281948382, "num_env_steps_trained_throughput_per_sec": 491.8375281948382, "timesteps_total": 612000, "num_env_steps_sampled_lifetime": 612000, "num_agent_steps_sampled_lifetime": 1836000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1836000, "timers": {"training_iteration_time_ms": 8542.515, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8542.482, "sample_time_ms": 859.203, "learn_time_ms": 7671.0, "learn_throughput": 521.444, "synch_weights_time_ms": 11.709}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000}, "done": false, "training_iteration": 153, "trial_id": "eaa30_00000", "date": "2024-08-09_18-01-22", "timestamp": 1723240882, "time_this_iter_s": 8.137111186981201, "time_total_s": 1257.2005779743195, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc921f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1257.2005779743195, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 27.441666666666666, "ram_util_percent": 81.24166666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.531206663575754, "cur_kl_coeff": 0.5479854230477937, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.070218782576304, "policy_loss": -0.0005030421594345065, "vf_loss": 7.069295346043098, "vf_explained_var": 0.07467633539406711, "kl": 0.0026031504490501467, "entropy": 0.6993362102874372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.5293294476345185, "cur_kl_coeff": 0.3954410190918448, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.282812864085038, "policy_loss": 0.00034342352009844037, "vf_loss": 8.280630522966385, "vf_explained_var": -0.013209842642148336, "kl": 0.004650304281070324, "entropy": 0.7845928495749831, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 147360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000}, "env_runners": {"episode_reward_max": 165.02564817431477, "episode_reward_min": 13.279161804872725, "episode_reward_mean": 90.08799179042475, "episode_len_mean": 142.06, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 14206, "policy_reward_min": {"agent_policy": 6.639580902436359, "adversary_policy": -16.84358173552193}, "policy_reward_max": {"agent_policy": 82.5128240871574, "adversary_policy": 49.98462895749368}, "policy_reward_mean": {"agent_policy": 45.043995895212376, "adversary_policy": 22.521997947606188}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.25980601947776, 35.72416018588987, 87.91485414326841, 127.26231483590547, 108.63605866774631, 50.0877842679311, 165.02564817431477, 35.588693806282606, 14.136991861457913, 45.868600963770405, 32.28633900681002, 87.11733929137027, 120.39466336987724, 89.78663349997016, 58.46919668742986, 55.189665944149006, 127.52852386015888, 155.2970366693607, 142.48739253539173, 62.31579180172173, 163.14457288610106, 73.1588137894345, 65.21023562143861, 139.98517418261338, 47.87337983302811, 128.13545837113173, 77.80250657650295, 152.1477095340813, 127.7956602217986, 80.04415252113748, 104.37910083978197, 13.279161804872725, 39.77447408114064, 34.64150925087744, 134.33006842542306, 130.093459485904, 101.41061705286859, 161.2922658491036, 57.56313147598827, 80.30462265201919, 121.85042602324484, 146.27387159907065, 84.20691791963071, 105.9518536499964, 79.2354775817785, 98.8951445587893, 146.01387850272084, 101.49874876993681, 146.63207035293408, 158.79861917646988, 33.73556785289328, 72.43254979920334, 140.21732573273079, 34.036071228198935, 112.8028831549646, 103.98686654530954, 72.47013096343271, 55.03648585584094, 81.57785430261934, 90.53996478706416, 69.69646919660985, 159.23506870087465, 46.97137062467504, 107.3275606151338, 53.311425661465435, 151.2189712197849, 49.57804771695399, 36.73278394665326, 144.5208593298035, 79.80618663622263, 79.16759071742062, 77.17791352341962, 101.43297624685762, 99.32313148903435, 80.76191539379874, 49.258876934525716, 22.402360913080777, 61.531232422176515, 82.91611585189038, 96.14943229458073, 105.50565135740248, 152.57734241468094, 71.81923685569313, 89.22224642673974, 74.22514595794723, 101.63562313017454, 35.46675223282628, 92.37368365664838, 87.30190687126536, 83.79886701200346, 28.694295007408556, 92.10931257996536, 108.24290368262311, 66.8461500217671, 58.42324302109924, 133.251471069913, 66.77295166112158, 105.1690657015385, 109.35606633236219, 63.55069620997121], "episode_lengths": [160, 38, 44, 198, 200, 98, 159, 123, 106, 70, 200, 188, 98, 200, 57, 200, 200, 200, 172, 200, 200, 189, 73, 200, 163, 77, 200, 62, 175, 191, 200, 25, 140, 42, 200, 56, 133, 200, 113, 131, 200, 127, 57, 200, 200, 197, 58, 66, 196, 180, 132, 151, 200, 119, 160, 200, 89, 132, 97, 194, 200, 79, 145, 157, 184, 200, 56, 100, 200, 200, 48, 199, 180, 136, 57, 32, 34, 132, 28, 168, 200, 200, 62, 200, 110, 120, 200, 159, 200, 126, 189, 197, 200, 106, 147, 125, 200, 49, 126, 119], "policy_agent_policy_reward": [67.12990300973887, 17.862080092944936, 43.957427071634214, 63.63115741795275, 54.318029333873156, 25.04389213396555, 82.5128240871574, 17.794346903141296, 7.068495930728959, 22.9343004818852, 16.14316950340501, 43.558669645685136, 60.19733168493859, 44.89331674998511, 29.23459834371492, 27.594832972074492, 63.76426193007943, 77.64851833468032, 71.24369626769584, 31.157895900860847, 81.57228644305061, 36.57940689471723, 32.605117810719285, 69.9925870913067, 23.936689916514034, 64.06772918556584, 38.90125328825146, 76.07385476704063, 63.89783011089934, 40.02207626056874, 52.18955041989099, 6.639580902436359, 19.88723704057031, 17.320754625438724, 67.1650342127115, 65.04672974295201, 50.70530852643434, 80.64613292455176, 28.78156573799411, 40.15231132600956, 60.925213011622375, 73.13693579953532, 42.10345895981537, 52.9759268249982, 39.61773879088922, 49.447572279394635, 73.00693925136044, 50.74937438496842, 73.31603517646703, 79.39930958823489, 16.86778392644661, 36.216274899601665, 70.10866286636538, 17.018035614099464, 56.40144157748234, 51.99343327265474, 36.23506548171636, 27.51824292792046, 40.78892715130968, 45.2699823935321, 34.84823459830487, 79.61753435043732, 23.48568531233752, 53.6637803075669, 26.65571283073276, 75.60948560989246, 24.789023858476988, 18.366391973326635, 72.26042966490175, 39.903093318111324, 39.58379535871031, 38.58895676170981, 50.7164881234288, 49.66156574451719, 40.38095769689936, 24.62943846726285, 11.201180456540389, 30.765616211088233, 41.458057925945184, 48.07471614729034, 52.75282567870126, 76.28867120734047, 35.90961842784656, 44.611123213369865, 37.112572978973645, 50.81781156508726, 17.73337611641314, 46.18684182832419, 43.65095343563267, 41.89943350600171, 14.347147503704251, 46.05465628998268, 54.12145184131156, 33.423075010883565, 29.211621510549623, 66.62573553495652, 33.386475830560784, 52.584532850769236, 54.6780331661811, 31.77534810498561], "policy_adversary_policy_reward": [33.39554290265609, 33.7343601070828, -4.693660399925953, 22.55574049287089, 13.282501147592177, 30.67492592404204, 40.50570784724387, 23.125449570708888, 31.791367271528863, 22.526662062344293, 9.708344165387858, 15.335547968577691, 46.516461847817766, 35.996362239339604, 6.332067470867723, 11.46227943227357, 12.711444007713908, -5.642948076984954, 7.884009336353424, 15.050291145531776, 8.531585816908924, 7.611583686496093, 25.853425502070007, 17.70524414361513, 38.044484401063855, 22.152847283874735, 18.318922354013495, 26.574394395971613, 22.8513437928612, 6.383254550853723, 18.5091125178472, 9.0857204542273, 36.7948766013697, 26.969385328709727, 27.663889377186635, 49.98462895749368, 31.556847672003443, 39.68684859569241, 16.957216729503944, 14.200679171356906, 40.232888880887074, 41.339397562163505, 20.612815441878187, 15.96659145283904, 48.10617909481976, -15.501061284100473, 24.446397474463645, 45.54618961684305, 8.683396523701632, 15.253293392812402, 35.57991920772733, 28.487809977838513, 20.040776609834282, 18.86047667841718, 44.584895175912095, 31.488959591128534, 29.19347758645997, 34.70435252443938, 19.759784138293313, 20.262292122275433, 12.39487406189087, 39.794676358000125, -16.84358173552193, 23.48316263795829, 35.2515221190035, -15.364285078433195, 17.658617445215455, -0.3378628197767348, 34.779106371291164, 32.38592784142034, 37.682415064054915, 27.364314678897113, 37.86791844231182, 12.83739008412251, 45.00054026631449, 35.645592658237305, 18.65994695402568, 10.121618783968431, 16.725179530833984, 23.42713179517561, 14.32673484434062, 46.59847816728176, 31.210698044620933, 41.92623775491441, 46.70438503682857, -4.600926077013195, 28.001487248791427, 24.974439576206763, 22.784769275776483, 16.832969515112744, 22.424090824926953, 27.023481454467692, 37.079740309142665, 35.927198942217764, 24.02590010984286, 26.723474275125565, 36.41058978808376, 36.90544538838326, 36.252915279731056, 43.146394308503844, 7.626080518141574, 9.241703408305032, 11.752582758407945, 24.463692141193718, 40.31111194465501, 29.797550921710368, 3.0093098846265676, 14.008725729472896, 20.74740458421244, 35.6540369932699, 28.769345380152124, 23.224087892502634, 7.481252867453918, 28.753812614262436, -14.2258167798682, 41.74405970778868, 16.6096035252998, 24.179323626009875, 24.299311218797936, 20.970671174734168, 19.261242589429553, 15.586992008875317, 35.921934330750794, 43.6956000196865, 12.703034018975545, 10.782651293361976, 25.536218934090424, 28.12756137347648, 7.784331939362147, 18.871380891370617, 37.88164132509283, 37.72784428479963, 28.255959518698962, -3.466935660221977, 8.962962502864723, 9.403429470461912, 34.70073039991537, 37.55969926498636, 33.05271891680695, 6.8503744013043715, 13.296052764258182, 26.287742594452126, 13.590403891926197, 24.998552869783616, 38.20121820417337, 12.515269919255427, 33.1404394478521, 16.521126296665084, 32.864469251461664, 7.5164884454376875, 24.040455456774513, 0.5889830104883336, -9.71352915240422, 20.914709608944605, 20.112837133429036, 10.6527790776592, 22.413592863460416, 19.04446506248477, 18.712548417296357, 29.362167729993985, 21.829443212372535, 30.92338246632873, 32.255382842846956, 44.03328836449352, 41.152920474914794, -5.243302047068237, 17.767440042537395, 26.84368317083247, 18.575662686522975, 18.53691029245067, 35.8763966141308, 14.941414950956474, 25.885854283939576, -8.152478167526432, 22.334093203381908, 23.85274862494228, 31.308146132067357, 12.34280730356532, 21.190656899709758, 20.70877660629194, -1.5930794475731247, 15.940226951277396, 29.551652627925545, 16.503003662057136, 23.08309503354794, 31.038356807763613, 20.678486188216166, 12.744588822667389, 6.057883530700035, 23.153737979849588, 29.523861076993178, 37.10187445796335, 16.455681770250965, 16.93079406030982, 13.832276794386683, 38.752256056382556, 28.776111844982616, 25.901921321198465, 26.18794739505215, 5.5874007099334655]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.392817112031712, "mean_inference_ms": 0.9761637558557489, "mean_action_processing_ms": 0.16660864854221924, "mean_env_wait_ms": 0.058284045806947356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037190914154052734, "StateBufferConnector_ms": 0.0025970935821533203, "ViewRequirementAgentConnector_ms": 0.07000100612640381}, "num_episodes": 28, "episode_return_max": 165.02564817431477, "episode_return_min": 13.279161804872725, "episode_return_mean": 90.08799179042475}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 479.0225815252988, "num_env_steps_trained_throughput_per_sec": 479.0225815252988, "timesteps_total": 616000, "num_env_steps_sampled_lifetime": 616000, "num_agent_steps_sampled_lifetime": 1848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1848000, "timers": {"training_iteration_time_ms": 8525.181, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8525.148, "sample_time_ms": 872.921, "learn_time_ms": 7640.522, "learn_throughput": 523.524, "synch_weights_time_ms": 11.119}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000}, "done": false, "training_iteration": 154, "trial_id": "eaa30_00000", "date": "2024-08-09_18-01-31", "timestamp": 1723240891, "time_this_iter_s": 8.354828119277954, "time_total_s": 1265.5554060935974, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1780fbc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1265.5554060935974, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 28.425, "ram_util_percent": 81.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.62689258749523, "cur_kl_coeff": 0.27399271152389687, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.891087537341647, "policy_loss": -0.0030257769531407764, "vf_loss": 6.893135201489484, "vf_explained_var": 0.15116423686976155, "kl": 0.0035698121938381403, "entropy": 0.6502957766333585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1815775067545475, "cur_kl_coeff": 0.1977205095459224, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.240300023555756, "policy_loss": 0.003976610608757861, "vf_loss": 8.23381259938081, "vf_explained_var": -0.10987484150876602, "kl": 0.012698840515804477, "entropy": 0.749398864991963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 148320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000}, "env_runners": {"episode_reward_max": 161.2922658491036, "episode_reward_min": 11.01296527947736, "episode_reward_mean": 85.6046775346611, "episode_len_mean": 137.7, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 13770, "policy_reward_min": {"agent_policy": 5.506482639738675, "adversary_policy": -16.84358173552193}, "policy_reward_max": {"agent_policy": 80.64613292455176, "adversary_policy": 54.91399814726481}, "policy_reward_mean": {"agent_policy": 42.80233876733055, "adversary_policy": 21.401169383665277}, "custom_metrics": {}, "hist_stats": {"episode_reward": [127.7956602217986, 80.04415252113748, 104.37910083978197, 13.279161804872725, 39.77447408114064, 34.64150925087744, 134.33006842542306, 130.093459485904, 101.41061705286859, 161.2922658491036, 57.56313147598827, 80.30462265201919, 121.85042602324484, 146.27387159907065, 84.20691791963071, 105.9518536499964, 79.2354775817785, 98.8951445587893, 146.01387850272084, 101.49874876993681, 146.63207035293408, 158.79861917646988, 33.73556785289328, 72.43254979920334, 140.21732573273079, 34.036071228198935, 112.8028831549646, 103.98686654530954, 72.47013096343271, 55.03648585584094, 81.57785430261934, 90.53996478706416, 69.69646919660985, 159.23506870087465, 46.97137062467504, 107.3275606151338, 53.311425661465435, 151.2189712197849, 49.57804771695399, 36.73278394665326, 144.5208593298035, 79.80618663622263, 79.16759071742062, 77.17791352341962, 101.43297624685762, 99.32313148903435, 80.76191539379874, 49.258876934525716, 22.402360913080777, 61.531232422176515, 82.91611585189038, 96.14943229458073, 105.50565135740248, 152.57734241468094, 71.81923685569313, 89.22224642673974, 74.22514595794723, 101.63562313017454, 35.46675223282628, 92.37368365664838, 87.30190687126536, 83.79886701200346, 28.694295007408556, 92.10931257996536, 108.24290368262311, 66.8461500217671, 58.42324302109924, 133.251471069913, 66.77295166112158, 105.1690657015385, 109.35606633236219, 63.55069620997121, 65.56216899090263, 136.45619393267583, 35.47660678811856, 156.123940663042, 110.9672771147883, 46.82306690210497, 50.65398103246734, 13.310331333190387, 66.30591185721853, 90.83706988880672, 121.3560368896978, 80.8237608299645, 119.73436854541339, 36.54722190246448, 146.1162104874051, 56.25801952625919, 83.90460057964451, 17.108052323322447, 42.26638792199531, 126.75092019565504, 56.15821032512919, 80.62155699174745, 46.132353426769924, 11.01296527947736, 118.84571978579899, 107.34986154478072, 72.65650651753603, 38.34461923387557], "episode_lengths": [175, 191, 200, 25, 140, 42, 200, 56, 133, 200, 113, 131, 200, 127, 57, 200, 200, 197, 58, 66, 196, 180, 132, 151, 200, 119, 160, 200, 89, 132, 97, 194, 200, 79, 145, 157, 184, 200, 56, 100, 200, 200, 48, 199, 180, 136, 57, 32, 34, 132, 28, 168, 200, 200, 62, 200, 110, 120, 200, 159, 200, 126, 189, 197, 200, 106, 147, 125, 200, 49, 126, 119, 200, 200, 76, 200, 109, 95, 159, 110, 160, 35, 131, 98, 103, 89, 48, 61, 200, 200, 153, 175, 57, 196, 106, 72, 200, 198, 115, 93], "policy_agent_policy_reward": [63.89783011089934, 40.02207626056874, 52.18955041989099, 6.639580902436359, 19.88723704057031, 17.320754625438724, 67.1650342127115, 65.04672974295201, 50.70530852643434, 80.64613292455176, 28.78156573799411, 40.15231132600956, 60.925213011622375, 73.13693579953532, 42.10345895981537, 52.9759268249982, 39.61773879088922, 49.447572279394635, 73.00693925136044, 50.74937438496842, 73.31603517646703, 79.39930958823489, 16.86778392644661, 36.216274899601665, 70.10866286636538, 17.018035614099464, 56.40144157748234, 51.99343327265474, 36.23506548171636, 27.51824292792046, 40.78892715130968, 45.2699823935321, 34.84823459830487, 79.61753435043732, 23.48568531233752, 53.6637803075669, 26.65571283073276, 75.60948560989246, 24.789023858476988, 18.366391973326635, 72.26042966490175, 39.903093318111324, 39.58379535871031, 38.58895676170981, 50.7164881234288, 49.66156574451719, 40.38095769689936, 24.62943846726285, 11.201180456540389, 30.765616211088233, 41.458057925945184, 48.07471614729034, 52.75282567870126, 76.28867120734047, 35.90961842784656, 44.611123213369865, 37.112572978973645, 50.81781156508726, 17.73337611641314, 46.18684182832419, 43.65095343563267, 41.89943350600171, 14.347147503704251, 46.05465628998268, 54.12145184131156, 33.423075010883565, 29.211621510549623, 66.62573553495652, 33.386475830560784, 52.584532850769236, 54.6780331661811, 31.77534810498561, 32.78108449545133, 68.22809696633787, 17.738303394059283, 78.06197033152104, 55.48363855739419, 23.411533451052478, 25.32699051623366, 6.655165666595192, 33.15295592860928, 45.41853494440336, 60.6780184448489, 40.411880414982235, 59.86718427270668, 18.273610951232243, 73.05810524370256, 28.129009763129602, 41.95230028982221, 8.55402616166121, 21.13319396099768, 63.37546009782751, 28.079105162564595, 40.31077849587372, 23.06617671338497, 5.506482639738675, 59.422859892899496, 53.674930772390354, 36.328253258768015, 19.172309616937785], "policy_adversary_policy_reward": [29.19347758645997, 34.70435252443938, 19.759784138293313, 20.262292122275433, 12.39487406189087, 39.794676358000125, -16.84358173552193, 23.48316263795829, 35.2515221190035, -15.364285078433195, 17.658617445215455, -0.3378628197767348, 34.779106371291164, 32.38592784142034, 37.682415064054915, 27.364314678897113, 37.86791844231182, 12.83739008412251, 45.00054026631449, 35.645592658237305, 18.65994695402568, 10.121618783968431, 16.725179530833984, 23.42713179517561, 14.32673484434062, 46.59847816728176, 31.210698044620933, 41.92623775491441, 46.70438503682857, -4.600926077013195, 28.001487248791427, 24.974439576206763, 22.784769275776483, 16.832969515112744, 22.424090824926953, 27.023481454467692, 37.079740309142665, 35.927198942217764, 24.02590010984286, 26.723474275125565, 36.41058978808376, 36.90544538838326, 36.252915279731056, 43.146394308503844, 7.626080518141574, 9.241703408305032, 11.752582758407945, 24.463692141193718, 40.31111194465501, 29.797550921710368, 3.0093098846265676, 14.008725729472896, 20.74740458421244, 35.6540369932699, 28.769345380152124, 23.224087892502634, 7.481252867453918, 28.753812614262436, -14.2258167798682, 41.74405970778868, 16.6096035252998, 24.179323626009875, 24.299311218797936, 20.970671174734168, 19.261242589429553, 15.586992008875317, 35.921934330750794, 43.6956000196865, 12.703034018975545, 10.782651293361976, 25.536218934090424, 28.12756137347648, 7.784331939362147, 18.871380891370617, 37.88164132509283, 37.72784428479963, 28.255959518698962, -3.466935660221977, 8.962962502864723, 9.403429470461912, 34.70073039991537, 37.55969926498636, 33.05271891680695, 6.8503744013043715, 13.296052764258182, 26.287742594452126, 13.590403891926197, 24.998552869783616, 38.20121820417337, 12.515269919255427, 33.1404394478521, 16.521126296665084, 32.864469251461664, 7.5164884454376875, 24.040455456774513, 0.5889830104883336, -9.71352915240422, 20.914709608944605, 20.112837133429036, 10.6527790776592, 22.413592863460416, 19.04446506248477, 18.712548417296357, 29.362167729993985, 21.829443212372535, 30.92338246632873, 32.255382842846956, 44.03328836449352, 41.152920474914794, -5.243302047068237, 17.767440042537395, 26.84368317083247, 18.575662686522975, 18.53691029245067, 35.8763966141308, 14.941414950956474, 25.885854283939576, -8.152478167526432, 22.334093203381908, 23.85274862494228, 31.308146132067357, 12.34280730356532, 21.190656899709758, 20.70877660629194, -1.5930794475731247, 15.940226951277396, 29.551652627925545, 16.503003662057136, 23.08309503354794, 31.038356807763613, 20.678486188216166, 12.744588822667389, 6.057883530700035, 23.153737979849588, 29.523861076993178, 37.10187445796335, 16.455681770250965, 16.93079406030982, 13.832276794386683, 38.752256056382556, 28.776111844982616, 25.901921321198465, 26.18794739505215, 5.5874007099334655, 19.346174426733, 13.434910068718331, 22.717811677819945, 45.510285288517935, -3.7090199253862615, 21.447323319445545, 23.147972184256226, 54.91399814726481, 5.887978062664651, 49.59566049472952, 5.594145701329255, 17.817387749723224, -0.9375371878058765, 26.264527704039537, -15.82683604659264, 22.48200171318783, 18.391552009075394, 14.76140391953388, 23.371407199939085, 22.047127744464266, 38.16434046131641, 22.513677983532496, -1.1894746838458659, 41.60135509882813, 23.69843023938805, 36.168754033318635, 11.532322799488565, 6.7412881517436745, 28.32841784373924, 44.729687399963325, -4.556904553198873, 32.68591431632847, 29.453793716987576, 12.498506572834636, 6.401595237313998, 2.152430924347218, 17.23935321620347, 3.893840744794211, 29.807276998371144, 33.56818309945637, 18.765732826445824, 9.31337233611877, 19.964068283802153, 20.346710212071567, 3.3314499840230543, 19.734726729361917, 20.274745224973785, -14.76826258523511, 24.63104566893179, 34.791814223967684, 32.78927269235825, 20.88565808003211, 30.092014543231997, 6.236238715536011, 23.83841970265124, -4.666110085713441]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39283202745711554, "mean_inference_ms": 0.9763239894763538, "mean_action_processing_ms": 0.16660149813745007, "mean_env_wait_ms": 0.05827882718253859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003608226776123047, "StateBufferConnector_ms": 0.0025243759155273438, "ViewRequirementAgentConnector_ms": 0.06824851036071777}, "num_episodes": 28, "episode_return_max": 161.2922658491036, "episode_return_min": 11.01296527947736, "episode_return_mean": 85.6046775346611}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.9746542728939, "num_env_steps_trained_throughput_per_sec": 485.9746542728939, "timesteps_total": 620000, "num_env_steps_sampled_lifetime": 620000, "num_agent_steps_sampled_lifetime": 1860000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1860000, "timers": {"training_iteration_time_ms": 8516.39, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8516.357, "sample_time_ms": 864.467, "learn_time_ms": 7640.163, "learn_throughput": 523.549, "synch_weights_time_ms": 11.112}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000}, "done": false, "training_iteration": 155, "trial_id": "eaa30_00000", "date": "2024-08-09_18-01-39", "timestamp": 1723240899, "time_this_iter_s": 8.23613691329956, "time_total_s": 1273.791543006897, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17807cb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1273.791543006897, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 29.308333333333334, "ram_util_percent": 81.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.687548397331641, "cur_kl_coeff": 0.13699635576194844, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.407210886667645, "policy_loss": -0.008864672033106365, "vf_loss": 6.410018366606778, "vf_explained_var": 0.06912339285567955, "kl": 0.04421424846529527, "entropy": 0.7448117592031993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.993300292935843, "cur_kl_coeff": 0.1977205095459224, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.006298759082954, "policy_loss": -0.00050732060141551, "vf_loss": 8.004135176042716, "vf_explained_var": -0.0036835646877686184, "kl": 0.013508509061648511, "entropy": 0.6423401065791646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 149280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "env_runners": {"episode_reward_max": 176.88105915890878, "episode_reward_min": -0.6683397849239299, "episode_reward_mean": 84.58361066354247, "episode_len_mean": 143.91, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 14391, "policy_reward_min": {"agent_policy": -0.3341698924619685, "adversary_policy": -15.82683604659264}, "policy_reward_max": {"agent_policy": 88.44052957945438, "adversary_policy": 54.91399814726481}, "policy_reward_mean": {"agent_policy": 42.291805331771236, "adversary_policy": 21.145902665885618}, "custom_metrics": {}, "hist_stats": {"episode_reward": [112.8028831549646, 103.98686654530954, 72.47013096343271, 55.03648585584094, 81.57785430261934, 90.53996478706416, 69.69646919660985, 159.23506870087465, 46.97137062467504, 107.3275606151338, 53.311425661465435, 151.2189712197849, 49.57804771695399, 36.73278394665326, 144.5208593298035, 79.80618663622263, 79.16759071742062, 77.17791352341962, 101.43297624685762, 99.32313148903435, 80.76191539379874, 49.258876934525716, 22.402360913080777, 61.531232422176515, 82.91611585189038, 96.14943229458073, 105.50565135740248, 152.57734241468094, 71.81923685569313, 89.22224642673974, 74.22514595794723, 101.63562313017454, 35.46675223282628, 92.37368365664838, 87.30190687126536, 83.79886701200346, 28.694295007408556, 92.10931257996536, 108.24290368262311, 66.8461500217671, 58.42324302109924, 133.251471069913, 66.77295166112158, 105.1690657015385, 109.35606633236219, 63.55069620997121, 65.56216899090263, 136.45619393267583, 35.47660678811856, 156.123940663042, 110.9672771147883, 46.82306690210497, 50.65398103246734, 13.310331333190387, 66.30591185721853, 90.83706988880672, 121.3560368896978, 80.8237608299645, 119.73436854541339, 36.54722190246448, 146.1162104874051, 56.25801952625919, 83.90460057964451, 17.108052323322447, 42.26638792199531, 126.75092019565504, 56.15821032512919, 80.62155699174745, 46.132353426769924, 11.01296527947736, 118.84571978579899, 107.34986154478072, 72.65650651753603, 38.34461923387557, 111.55605246734555, 43.519524779406595, 142.14239191912552, -0.6683397849239299, 50.92028491160784, 97.83881071619264, 176.88105915890878, 49.77942089047002, 99.18186219490252, 103.71442292405507, 50.80762598758342, 84.3122198811013, 96.87660417624087, 116.75317108700814, 151.54021195416098, 104.83069859002416, 156.82562932844772, 48.31541654607237, 48.89354213972711, 91.28029168536446, 103.55286086455783, 46.328095569006756, 96.61136117071078, 92.79414009616337, 106.79778345351706, 161.19491658987405], "episode_lengths": [160, 200, 89, 132, 97, 194, 200, 79, 145, 157, 184, 200, 56, 100, 200, 200, 48, 199, 180, 136, 57, 32, 34, 132, 28, 168, 200, 200, 62, 200, 110, 120, 200, 159, 200, 126, 189, 197, 200, 106, 147, 125, 200, 49, 126, 119, 200, 200, 76, 200, 109, 95, 159, 110, 160, 35, 131, 98, 103, 89, 48, 61, 200, 200, 153, 175, 57, 196, 106, 72, 200, 198, 115, 93, 200, 123, 200, 86, 200, 200, 200, 107, 159, 200, 92, 145, 200, 194, 200, 200, 200, 200, 200, 154, 192, 174, 160, 156, 44, 124], "policy_agent_policy_reward": [56.40144157748234, 51.99343327265474, 36.23506548171636, 27.51824292792046, 40.78892715130968, 45.2699823935321, 34.84823459830487, 79.61753435043732, 23.48568531233752, 53.6637803075669, 26.65571283073276, 75.60948560989246, 24.789023858476988, 18.366391973326635, 72.26042966490175, 39.903093318111324, 39.58379535871031, 38.58895676170981, 50.7164881234288, 49.66156574451719, 40.38095769689936, 24.62943846726285, 11.201180456540389, 30.765616211088233, 41.458057925945184, 48.07471614729034, 52.75282567870126, 76.28867120734047, 35.90961842784656, 44.611123213369865, 37.112572978973645, 50.81781156508726, 17.73337611641314, 46.18684182832419, 43.65095343563267, 41.89943350600171, 14.347147503704251, 46.05465628998268, 54.12145184131156, 33.423075010883565, 29.211621510549623, 66.62573553495652, 33.386475830560784, 52.584532850769236, 54.6780331661811, 31.77534810498561, 32.78108449545133, 68.22809696633787, 17.738303394059283, 78.06197033152104, 55.48363855739419, 23.411533451052478, 25.32699051623366, 6.655165666595192, 33.15295592860928, 45.41853494440336, 60.6780184448489, 40.411880414982235, 59.86718427270668, 18.273610951232243, 73.05810524370256, 28.129009763129602, 41.95230028982221, 8.55402616166121, 21.13319396099768, 63.37546009782751, 28.079105162564595, 40.31077849587372, 23.06617671338497, 5.506482639738675, 59.422859892899496, 53.674930772390354, 36.328253258768015, 19.172309616937785, 55.778026233672776, 21.759762389703297, 71.07119595956273, -0.3341698924619685, 25.460142455803922, 48.91940535809631, 88.44052957945438, 24.889710445235018, 49.59093109745125, 51.85721146202749, 25.403812993791718, 42.15610994055065, 48.43830208812041, 58.3765855435041, 75.77010597708046, 52.415349295012085, 78.4128146642239, 24.157708273036224, 24.446771069863587, 45.640145842682216, 51.776430432278936, 23.164047784503385, 48.30568058535539, 46.39707004808168, 53.39889172675853, 80.59745829493703], "policy_adversary_policy_reward": [20.74740458421244, 35.6540369932699, 28.769345380152124, 23.224087892502634, 7.481252867453918, 28.753812614262436, -14.2258167798682, 41.74405970778868, 16.6096035252998, 24.179323626009875, 24.299311218797936, 20.970671174734168, 19.261242589429553, 15.586992008875317, 35.921934330750794, 43.6956000196865, 12.703034018975545, 10.782651293361976, 25.536218934090424, 28.12756137347648, 7.784331939362147, 18.871380891370617, 37.88164132509283, 37.72784428479963, 28.255959518698962, -3.466935660221977, 8.962962502864723, 9.403429470461912, 34.70073039991537, 37.55969926498636, 33.05271891680695, 6.8503744013043715, 13.296052764258182, 26.287742594452126, 13.590403891926197, 24.998552869783616, 38.20121820417337, 12.515269919255427, 33.1404394478521, 16.521126296665084, 32.864469251461664, 7.5164884454376875, 24.040455456774513, 0.5889830104883336, -9.71352915240422, 20.914709608944605, 20.112837133429036, 10.6527790776592, 22.413592863460416, 19.04446506248477, 18.712548417296357, 29.362167729993985, 21.829443212372535, 30.92338246632873, 32.255382842846956, 44.03328836449352, 41.152920474914794, -5.243302047068237, 17.767440042537395, 26.84368317083247, 18.575662686522975, 18.53691029245067, 35.8763966141308, 14.941414950956474, 25.885854283939576, -8.152478167526432, 22.334093203381908, 23.85274862494228, 31.308146132067357, 12.34280730356532, 21.190656899709758, 20.70877660629194, -1.5930794475731247, 15.940226951277396, 29.551652627925545, 16.503003662057136, 23.08309503354794, 31.038356807763613, 20.678486188216166, 12.744588822667389, 6.057883530700035, 23.153737979849588, 29.523861076993178, 37.10187445796335, 16.455681770250965, 16.93079406030982, 13.832276794386683, 38.752256056382556, 28.776111844982616, 25.901921321198465, 26.18794739505215, 5.5874007099334655, 19.346174426733, 13.434910068718331, 22.717811677819945, 45.510285288517935, -3.7090199253862615, 21.447323319445545, 23.147972184256226, 54.91399814726481, 5.887978062664651, 49.59566049472952, 5.594145701329255, 17.817387749723224, -0.9375371878058765, 26.264527704039537, -15.82683604659264, 22.48200171318783, 18.391552009075394, 14.76140391953388, 23.371407199939085, 22.047127744464266, 38.16434046131641, 22.513677983532496, -1.1894746838458659, 41.60135509882813, 23.69843023938805, 36.168754033318635, 11.532322799488565, 6.7412881517436745, 28.32841784373924, 44.729687399963325, -4.556904553198873, 32.68591431632847, 29.453793716987576, 12.498506572834636, 6.401595237313998, 2.152430924347218, 17.23935321620347, 3.893840744794211, 29.807276998371144, 33.56818309945637, 18.765732826445824, 9.31337233611877, 19.964068283802153, 20.346710212071567, 3.3314499840230543, 19.734726729361917, 20.274745224973785, -14.76826258523511, 24.63104566893179, 34.791814223967684, 32.78927269235825, 20.88565808003211, 30.092014543231997, 6.236238715536011, 23.83841970265124, -4.666110085713441, 21.85259442724819, 33.925431806424584, 3.7851019793790073, 17.97466041032429, 30.29298093790493, 40.778215021657815, 1.3670648966246794, -1.701234789086655, 14.031000214593291, 11.429142241210629, 32.55663286275139, 16.36277249534492, 36.89471591672765, 51.54581366272677, 15.21887397697486, 9.670836468260152, 26.28109335686826, 23.309837740582985, 21.72520305542499, 30.132008406602505, 13.681604805579298, 11.722208188212415, 16.305204302329255, 25.85090563822139, 28.18195863003732, 20.256343458083116, 21.7377699701691, 36.638815573335, 29.957598578028353, 45.81250739905213, 43.326958579680834, 9.088390715331258, 38.430157157269925, 39.982657506953956, 9.161366571893609, 14.996341701142619, 6.989241797035643, 17.457529272827944, 1.9382929180361614, 43.701852924646055, 12.639988773165985, 39.13644165911295, -12.396761797135586, 35.56080958163896, 29.471392789929347, 18.83428779542605, 25.670172866680367, 20.726897181401306, 28.411575414986796, 24.987316311771743, 32.57405759684808, 48.023400698088935]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.392745386262749, "mean_inference_ms": 0.9766828295200063, "mean_action_processing_ms": 0.16665333327702522, "mean_env_wait_ms": 0.05828103321919043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035523176193237305, "StateBufferConnector_ms": 0.0025130510330200195, "ViewRequirementAgentConnector_ms": 0.06841349601745605}, "num_episodes": 26, "episode_return_max": 176.88105915890878, "episode_return_min": -0.6683397849239299, "episode_return_mean": 84.58361066354247}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 492.97230411060207, "num_env_steps_trained_throughput_per_sec": 492.97230411060207, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 1872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1872000, "timers": {"training_iteration_time_ms": 8328.343, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8328.31, "sample_time_ms": 813.124, "learn_time_ms": 7503.662, "learn_throughput": 533.073, "synch_weights_time_ms": 10.921}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "done": false, "training_iteration": 156, "trial_id": "eaa30_00000", "date": "2024-08-09_18-01-48", "timestamp": 1723240908, "time_this_iter_s": 8.11944031715393, "time_total_s": 1281.910983324051, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17807cee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1281.910983324051, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 27.46666666666667, "ram_util_percent": 81.01666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.193701965215975, "cur_kl_coeff": 0.2054945336429227, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.065554733377285, "policy_loss": 0.005442670111854871, "vf_loss": 6.051280891832221, "vf_explained_var": 0.0986224959136317, "kl": 0.04297532994280417, "entropy": 0.8810440471248021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.963607222090165, "cur_kl_coeff": 0.1977205095459224, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.731711445252101, "policy_loss": 0.0012425781120934214, "vf_loss": 7.729613480468591, "vf_explained_var": 0.021754022873938083, "kl": 0.004326142291392898, "entropy": 0.5655965555459261, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 150240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000}, "env_runners": {"episode_reward_max": 176.88105915890878, "episode_reward_min": -80.85589753199898, "episode_reward_mean": 75.57124997237509, "episode_len_mean": 149.54, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 14954, "policy_reward_min": {"agent_policy": -40.42794876599948, "adversary_policy": -34.542007277563854}, "policy_reward_max": {"agent_policy": 88.44052957945438, "adversary_policy": 54.91399814726481}, "policy_reward_mean": {"agent_policy": 37.78562498618754, "adversary_policy": 18.89281249309377}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.14943229458073, 105.50565135740248, 152.57734241468094, 71.81923685569313, 89.22224642673974, 74.22514595794723, 101.63562313017454, 35.46675223282628, 92.37368365664838, 87.30190687126536, 83.79886701200346, 28.694295007408556, 92.10931257996536, 108.24290368262311, 66.8461500217671, 58.42324302109924, 133.251471069913, 66.77295166112158, 105.1690657015385, 109.35606633236219, 63.55069620997121, 65.56216899090263, 136.45619393267583, 35.47660678811856, 156.123940663042, 110.9672771147883, 46.82306690210497, 50.65398103246734, 13.310331333190387, 66.30591185721853, 90.83706988880672, 121.3560368896978, 80.8237608299645, 119.73436854541339, 36.54722190246448, 146.1162104874051, 56.25801952625919, 83.90460057964451, 17.108052323322447, 42.26638792199531, 126.75092019565504, 56.15821032512919, 80.62155699174745, 46.132353426769924, 11.01296527947736, 118.84571978579899, 107.34986154478072, 72.65650651753603, 38.34461923387557, 111.55605246734555, 43.519524779406595, 142.14239191912552, -0.6683397849239299, 50.92028491160784, 97.83881071619264, 176.88105915890878, 49.77942089047002, 99.18186219490252, 103.71442292405507, 50.80762598758342, 84.3122198811013, 96.87660417624087, 116.75317108700814, 151.54021195416098, 104.83069859002416, 156.82562932844772, 48.31541654607237, 48.89354213972711, 91.28029168536446, 103.55286086455783, 46.328095569006756, 96.61136117071078, 92.79414009616337, 106.79778345351706, 161.19491658987405, 96.1475880357737, 47.70642761168804, 77.51997672432665, -26.019821172877066, 4.595389828776269, 95.39954827605213, 33.55718808227026, 6.199056915657241, 77.74529631618644, 11.817836587959803, 57.56921537515372, 80.87304062086022, 61.77617942244525, 28.34038108877572, 22.05940280493298, 109.25481511892266, 1.535294987518958, 61.34068704493068, 68.45954681003813, -80.85589753199898, 43.101594371380344, 90.30116227241658, 53.64530208725709, 169.74789542680386, -24.268133472376967], "episode_lengths": [168, 200, 200, 62, 200, 110, 120, 200, 159, 200, 126, 189, 197, 200, 106, 147, 125, 200, 49, 126, 119, 200, 200, 76, 200, 109, 95, 159, 110, 160, 35, 131, 98, 103, 89, 48, 61, 200, 200, 153, 175, 57, 196, 106, 72, 200, 198, 115, 93, 200, 123, 200, 86, 200, 200, 200, 107, 159, 200, 92, 145, 200, 194, 200, 200, 200, 200, 200, 154, 192, 174, 160, 156, 44, 124, 122, 200, 200, 200, 39, 200, 52, 200, 136, 200, 137, 185, 200, 200, 200, 148, 1, 47, 141, 200, 200, 116, 78, 200, 200], "policy_agent_policy_reward": [48.07471614729034, 52.75282567870126, 76.28867120734047, 35.90961842784656, 44.611123213369865, 37.112572978973645, 50.81781156508726, 17.73337611641314, 46.18684182832419, 43.65095343563267, 41.89943350600171, 14.347147503704251, 46.05465628998268, 54.12145184131156, 33.423075010883565, 29.211621510549623, 66.62573553495652, 33.386475830560784, 52.584532850769236, 54.6780331661811, 31.77534810498561, 32.78108449545133, 68.22809696633787, 17.738303394059283, 78.06197033152104, 55.48363855739419, 23.411533451052478, 25.32699051623366, 6.655165666595192, 33.15295592860928, 45.41853494440336, 60.6780184448489, 40.411880414982235, 59.86718427270668, 18.273610951232243, 73.05810524370256, 28.129009763129602, 41.95230028982221, 8.55402616166121, 21.13319396099768, 63.37546009782751, 28.079105162564595, 40.31077849587372, 23.06617671338497, 5.506482639738675, 59.422859892899496, 53.674930772390354, 36.328253258768015, 19.172309616937785, 55.778026233672776, 21.759762389703297, 71.07119595956273, -0.3341698924619685, 25.460142455803922, 48.91940535809631, 88.44052957945438, 24.889710445235018, 49.59093109745125, 51.85721146202749, 25.403812993791718, 42.15610994055065, 48.43830208812041, 58.3765855435041, 75.77010597708046, 52.415349295012085, 78.4128146642239, 24.157708273036224, 24.446771069863587, 45.640145842682216, 51.776430432278936, 23.164047784503385, 48.30568058535539, 46.39707004808168, 53.39889172675853, 80.59745829493703, 48.07379401788689, 23.853213805844018, 38.75998836216334, -13.009910586438526, 2.297694914388133, 47.69977413802606, 16.778594041135133, 3.099528457828635, 38.87264815809323, 5.908918293979905, 28.78460768757687, 40.436520310430126, 30.888089711222626, 14.170190544387847, 11.029701402466497, 54.62740755946132, 0.767647493759479, 30.67034352246535, 34.22977340501906, -40.42794876599948, 21.550797185690143, 45.150581136208274, 26.822651043628554, 84.87394771340193, -12.134066736188462], "policy_adversary_policy_reward": [18.712548417296357, 29.362167729993985, 21.829443212372535, 30.92338246632873, 32.255382842846956, 44.03328836449352, 41.152920474914794, -5.243302047068237, 17.767440042537395, 26.84368317083247, 18.575662686522975, 18.53691029245067, 35.8763966141308, 14.941414950956474, 25.885854283939576, -8.152478167526432, 22.334093203381908, 23.85274862494228, 31.308146132067357, 12.34280730356532, 21.190656899709758, 20.70877660629194, -1.5930794475731247, 15.940226951277396, 29.551652627925545, 16.503003662057136, 23.08309503354794, 31.038356807763613, 20.678486188216166, 12.744588822667389, 6.057883530700035, 23.153737979849588, 29.523861076993178, 37.10187445796335, 16.455681770250965, 16.93079406030982, 13.832276794386683, 38.752256056382556, 28.776111844982616, 25.901921321198465, 26.18794739505215, 5.5874007099334655, 19.346174426733, 13.434910068718331, 22.717811677819945, 45.510285288517935, -3.7090199253862615, 21.447323319445545, 23.147972184256226, 54.91399814726481, 5.887978062664651, 49.59566049472952, 5.594145701329255, 17.817387749723224, -0.9375371878058765, 26.264527704039537, -15.82683604659264, 22.48200171318783, 18.391552009075394, 14.76140391953388, 23.371407199939085, 22.047127744464266, 38.16434046131641, 22.513677983532496, -1.1894746838458659, 41.60135509882813, 23.69843023938805, 36.168754033318635, 11.532322799488565, 6.7412881517436745, 28.32841784373924, 44.729687399963325, -4.556904553198873, 32.68591431632847, 29.453793716987576, 12.498506572834636, 6.401595237313998, 2.152430924347218, 17.23935321620347, 3.893840744794211, 29.807276998371144, 33.56818309945637, 18.765732826445824, 9.31337233611877, 19.964068283802153, 20.346710212071567, 3.3314499840230543, 19.734726729361917, 20.274745224973785, -14.76826258523511, 24.63104566893179, 34.791814223967684, 32.78927269235825, 20.88565808003211, 30.092014543231997, 6.236238715536011, 23.83841970265124, -4.666110085713441, 21.85259442724819, 33.925431806424584, 3.7851019793790073, 17.97466041032429, 30.29298093790493, 40.778215021657815, 1.3670648966246794, -1.701234789086655, 14.031000214593291, 11.429142241210629, 32.55663286275139, 16.36277249534492, 36.89471591672765, 51.54581366272677, 15.21887397697486, 9.670836468260152, 26.28109335686826, 23.309837740582985, 21.72520305542499, 30.132008406602505, 13.681604805579298, 11.722208188212415, 16.305204302329255, 25.85090563822139, 28.18195863003732, 20.256343458083116, 21.7377699701691, 36.638815573335, 29.957598578028353, 45.81250739905213, 43.326958579680834, 9.088390715331258, 38.430157157269925, 39.982657506953956, 9.161366571893609, 14.996341701142619, 6.989241797035643, 17.457529272827944, 1.9382929180361614, 43.701852924646055, 12.639988773165985, 39.13644165911295, -12.396761797135586, 35.56080958163896, 29.471392789929347, 18.83428779542605, 25.670172866680367, 20.726897181401306, 28.411575414986796, 24.987316311771743, 32.57405759684808, 48.023400698088935, 29.92353419318085, 18.150259824706023, 14.664037690213583, 9.189176115630435, 13.191116258998054, 25.568872103165283, -10.845139492662287, -2.164771093776249, 13.484501176596934, -11.186806262208798, 17.795383206224773, 29.90439093180129, 42.5039158429541, -25.725321801818968, 5.109017984042552, -2.0094895262139314, 23.812805969071313, 15.059842189021918, -0.9241656139202803, 6.833083907900182, 18.05070639241206, 10.733901295164806, 23.04549429762362, 17.391026012806513, 13.06417588279696, 17.823913828425667, 5.733622800410249, 8.436567743977594, 14.976896983929596, -3.947195581463099, 28.712948404660963, 25.914459154800365, 0.0, 0.767647493759479, -14.493364472122142, 45.16370799458749, 17.963333190406317, 16.26644021461275, -34.542007277563854, -5.885941488435655, 1.2175491948814248, 20.333247990808722, 28.78193496921194, 16.36864616699634, 36.40287549836074, -9.580224454732193, 35.67250888281721, 49.20143883058472, -16.407903827007654, 4.273837090819189]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39267029014887134, "mean_inference_ms": 0.9751894928634826, "mean_action_processing_ms": 0.16679273559092994, "mean_env_wait_ms": 0.05828601132348295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031737089157104492, "StateBufferConnector_ms": 0.0025908946990966797, "ViewRequirementAgentConnector_ms": 0.06779801845550537}, "num_episodes": 25, "episode_return_max": 176.88105915890878, "episode_return_min": -80.85589753199898, "episode_return_mean": 75.57124997237509}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 475.10406873806767, "num_env_steps_trained_throughput_per_sec": 475.10406873806767, "timesteps_total": 628000, "num_env_steps_sampled_lifetime": 628000, "num_agent_steps_sampled_lifetime": 1884000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1884000, "timers": {"training_iteration_time_ms": 8258.246, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8258.214, "sample_time_ms": 785.232, "learn_time_ms": 7461.458, "learn_throughput": 536.088, "synch_weights_time_ms": 10.972}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000}, "done": false, "training_iteration": 157, "trial_id": "eaa30_00000", "date": "2024-08-09_18-01-56", "timestamp": 1723240916, "time_this_iter_s": 8.423817873001099, "time_total_s": 1290.334801197052, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x178129550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1290.334801197052, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 33.224999999999994, "ram_util_percent": 81.19166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.906035416340702, "cur_kl_coeff": 0.3082418004643842, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.695970002431718, "policy_loss": 0.006010545480740133, "vf_loss": 5.6801981923441405, "vf_explained_var": 0.06270795514974645, "kl": 0.03166757681402107, "entropy": 0.8124777031638635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.69400225430727, "cur_kl_coeff": 0.0988602547729612, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.021784741183122, "policy_loss": 0.003449447122208464, "vf_loss": 8.01772672533989, "vf_explained_var": 0.004750905372202396, "kl": 0.006155935940720762, "entropy": 0.48570545529946685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 151200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000}, "env_runners": {"episode_reward_max": 176.88105915890878, "episode_reward_min": -80.85589753199898, "episode_reward_mean": 63.569268869274126, "episode_len_mean": 150.35, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 15035, "policy_reward_min": {"agent_policy": -40.42794876599948, "adversary_policy": -35.93812486654127}, "policy_reward_max": {"agent_policy": 88.44052957945438, "adversary_policy": 51.54581366272677}, "policy_reward_mean": {"agent_policy": 31.784634434637063, "adversary_policy": 15.892317217318535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.82306690210497, 50.65398103246734, 13.310331333190387, 66.30591185721853, 90.83706988880672, 121.3560368896978, 80.8237608299645, 119.73436854541339, 36.54722190246448, 146.1162104874051, 56.25801952625919, 83.90460057964451, 17.108052323322447, 42.26638792199531, 126.75092019565504, 56.15821032512919, 80.62155699174745, 46.132353426769924, 11.01296527947736, 118.84571978579899, 107.34986154478072, 72.65650651753603, 38.34461923387557, 111.55605246734555, 43.519524779406595, 142.14239191912552, -0.6683397849239299, 50.92028491160784, 97.83881071619264, 176.88105915890878, 49.77942089047002, 99.18186219490252, 103.71442292405507, 50.80762598758342, 84.3122198811013, 96.87660417624087, 116.75317108700814, 151.54021195416098, 104.83069859002416, 156.82562932844772, 48.31541654607237, 48.89354213972711, 91.28029168536446, 103.55286086455783, 46.328095569006756, 96.61136117071078, 92.79414009616337, 106.79778345351706, 161.19491658987405, 96.1475880357737, 47.70642761168804, 77.51997672432665, -26.019821172877066, 4.595389828776269, 95.39954827605213, 33.55718808227026, 6.199056915657241, 77.74529631618644, 11.817836587959803, 57.56921537515372, 80.87304062086022, 61.77617942244525, 28.34038108877572, 22.05940280493298, 109.25481511892266, 1.535294987518958, 61.34068704493068, 68.45954681003813, -80.85589753199898, 43.101594371380344, 90.30116227241658, 53.64530208725709, 169.74789542680386, -24.268133472376967, 120.99477243308135, 56.017282139930465, 74.71136128173713, 64.43111484782753, 55.26061905487582, 51.15944459311589, 65.89060414839548, 38.94922409824432, 49.25396857419562, 4.80072522832274, 45.14074455479019, 30.99958389468828, 33.82181210427045, 17.047541628809878, 123.6637417011072, 80.75714417208117, -3.4639343707854025, 11.580252221675053, 16.750787660562786, -4.635666990364911, 98.13335599037256, 17.366187588806206, -28.668031627897456, 57.71399750607651, 28.703746141851646, 20.499742101393288], "episode_lengths": [95, 159, 110, 160, 35, 131, 98, 103, 89, 48, 61, 200, 200, 153, 175, 57, 196, 106, 72, 200, 198, 115, 93, 200, 123, 200, 86, 200, 200, 200, 107, 159, 200, 92, 145, 200, 194, 200, 200, 200, 200, 200, 154, 192, 174, 160, 156, 44, 124, 122, 200, 200, 200, 39, 200, 52, 200, 136, 200, 137, 185, 200, 200, 200, 148, 1, 47, 141, 200, 200, 116, 78, 200, 200, 200, 200, 19, 102, 200, 91, 160, 33, 148, 189, 198, 200, 200, 55, 128, 58, 200, 200, 200, 200, 88, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [23.411533451052478, 25.32699051623366, 6.655165666595192, 33.15295592860928, 45.41853494440336, 60.6780184448489, 40.411880414982235, 59.86718427270668, 18.273610951232243, 73.05810524370256, 28.129009763129602, 41.95230028982221, 8.55402616166121, 21.13319396099768, 63.37546009782751, 28.079105162564595, 40.31077849587372, 23.06617671338497, 5.506482639738675, 59.422859892899496, 53.674930772390354, 36.328253258768015, 19.172309616937785, 55.778026233672776, 21.759762389703297, 71.07119595956273, -0.3341698924619685, 25.460142455803922, 48.91940535809631, 88.44052957945438, 24.889710445235018, 49.59093109745125, 51.85721146202749, 25.403812993791718, 42.15610994055065, 48.43830208812041, 58.3765855435041, 75.77010597708046, 52.415349295012085, 78.4128146642239, 24.157708273036224, 24.446771069863587, 45.640145842682216, 51.776430432278936, 23.164047784503385, 48.30568058535539, 46.39707004808168, 53.39889172675853, 80.59745829493703, 48.07379401788689, 23.853213805844018, 38.75998836216334, -13.009910586438526, 2.297694914388133, 47.69977413802606, 16.778594041135133, 3.099528457828635, 38.87264815809323, 5.908918293979905, 28.78460768757687, 40.436520310430126, 30.888089711222626, 14.170190544387847, 11.029701402466497, 54.62740755946132, 0.767647493759479, 30.67034352246535, 34.22977340501906, -40.42794876599948, 21.550797185690143, 45.150581136208274, 26.822651043628554, 84.87394771340193, -12.134066736188462, 60.497386216540676, 28.008641069965236, 37.35568064086857, 32.215557423913765, 27.63030952743791, 25.57972229655796, 32.94530207419774, 19.474612049122165, 24.626984287097816, 2.400362614161363, 22.570372277395094, 15.49979194734414, 16.910906052135225, 8.523770814404939, 61.8318708505536, 40.37857208604055, -1.731967185392655, 5.790126110837527, 8.3753938302814, -2.3178334951824446, 49.06667799518631, 8.68309379440311, -14.33401581394877, 28.856998753038262, 14.351873070925823, 10.249871050696653], "policy_adversary_policy_reward": [5.594145701329255, 17.817387749723224, -0.9375371878058765, 26.264527704039537, -15.82683604659264, 22.48200171318783, 18.391552009075394, 14.76140391953388, 23.371407199939085, 22.047127744464266, 38.16434046131641, 22.513677983532496, -1.1894746838458659, 41.60135509882813, 23.69843023938805, 36.168754033318635, 11.532322799488565, 6.7412881517436745, 28.32841784373924, 44.729687399963325, -4.556904553198873, 32.68591431632847, 29.453793716987576, 12.498506572834636, 6.401595237313998, 2.152430924347218, 17.23935321620347, 3.893840744794211, 29.807276998371144, 33.56818309945637, 18.765732826445824, 9.31337233611877, 19.964068283802153, 20.346710212071567, 3.3314499840230543, 19.734726729361917, 20.274745224973785, -14.76826258523511, 24.63104566893179, 34.791814223967684, 32.78927269235825, 20.88565808003211, 30.092014543231997, 6.236238715536011, 23.83841970265124, -4.666110085713441, 21.85259442724819, 33.925431806424584, 3.7851019793790073, 17.97466041032429, 30.29298093790493, 40.778215021657815, 1.3670648966246794, -1.701234789086655, 14.031000214593291, 11.429142241210629, 32.55663286275139, 16.36277249534492, 36.89471591672765, 51.54581366272677, 15.21887397697486, 9.670836468260152, 26.28109335686826, 23.309837740582985, 21.72520305542499, 30.132008406602505, 13.681604805579298, 11.722208188212415, 16.305204302329255, 25.85090563822139, 28.18195863003732, 20.256343458083116, 21.7377699701691, 36.638815573335, 29.957598578028353, 45.81250739905213, 43.326958579680834, 9.088390715331258, 38.430157157269925, 39.982657506953956, 9.161366571893609, 14.996341701142619, 6.989241797035643, 17.457529272827944, 1.9382929180361614, 43.701852924646055, 12.639988773165985, 39.13644165911295, -12.396761797135586, 35.56080958163896, 29.471392789929347, 18.83428779542605, 25.670172866680367, 20.726897181401306, 28.411575414986796, 24.987316311771743, 32.57405759684808, 48.023400698088935, 29.92353419318085, 18.150259824706023, 14.664037690213583, 9.189176115630435, 13.191116258998054, 25.568872103165283, -10.845139492662287, -2.164771093776249, 13.484501176596934, -11.186806262208798, 17.795383206224773, 29.90439093180129, 42.5039158429541, -25.725321801818968, 5.109017984042552, -2.0094895262139314, 23.812805969071313, 15.059842189021918, -0.9241656139202803, 6.833083907900182, 18.05070639241206, 10.733901295164806, 23.04549429762362, 17.391026012806513, 13.06417588279696, 17.823913828425667, 5.733622800410249, 8.436567743977594, 14.976896983929596, -3.947195581463099, 28.712948404660963, 25.914459154800365, 0.0, 0.767647493759479, -14.493364472122142, 45.16370799458749, 17.963333190406317, 16.26644021461275, -34.542007277563854, -5.885941488435655, 1.2175491948814248, 20.333247990808722, 28.78193496921194, 16.36864616699634, 36.40287549836074, -9.580224454732193, 35.67250888281721, 49.20143883058472, -16.407903827007654, 4.273837090819189, 15.365991383612212, 45.13139483292846, 31.947229891175844, -3.9385888212106117, 20.335374152803777, 17.02030648806479, 23.74184901887658, 8.473708405037184, 16.193035909251876, 11.437273618186033, 18.709983979138947, 6.869738317419014, 31.2319400628162, 1.713362011381541, 16.031466087187887, 3.4431459619342775, 4.458007800702243, 20.168976486395575, 19.32716965939568, -16.92680704523433, 11.170302977323658, 11.400069300071436, 14.323918203492521, 1.1758737438516214, 8.694173043360374, 8.216733008774852, 44.46189568094621, -35.93812486654127, 23.130953798307242, 38.70091705224637, 8.659745171221903, 31.71882691481867, 15.084636182828962, -16.816603368221617, 6.967315993488334, -1.1771898826508078, -3.8772746130803704, 12.252668443361785, -3.0797023875271883, 0.7618688923447507, 37.83718849869584, 11.22948949649044, 2.462993778566549, 6.2201000158365645, 1.5447020977748132, -15.878717911723584, 23.110667471042927, 5.746331281995335, 3.164421409196798, 11.187451661729025, 8.338550345971985, 1.9113207047246679]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3927289366389099, "mean_inference_ms": 0.9752961442116944, "mean_action_processing_ms": 0.16683800623501924, "mean_env_wait_ms": 0.05831062244925283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031622648239135742, "StateBufferConnector_ms": 0.002535700798034668, "ViewRequirementAgentConnector_ms": 0.06706106662750244}, "num_episodes": 26, "episode_return_max": 176.88105915890878, "episode_return_min": -80.85589753199898, "episode_return_mean": 63.569268869274126}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.3978367702084, "num_env_steps_trained_throughput_per_sec": 491.3978367702084, "timesteps_total": 632000, "num_env_steps_sampled_lifetime": 632000, "num_agent_steps_sampled_lifetime": 1896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1896000, "timers": {"training_iteration_time_ms": 8243.021, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8242.988, "sample_time_ms": 774.417, "learn_time_ms": 7456.977, "learn_throughput": 536.41, "synch_weights_time_ms": 11.001}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000}, "done": false, "training_iteration": 158, "trial_id": "eaa30_00000", "date": "2024-08-09_18-02-05", "timestamp": 1723240925, "time_this_iter_s": 8.144271850585938, "time_total_s": 1298.479073047638, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781295e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1298.479073047638, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 27.73333333333333, "ram_util_percent": 81.25833333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.14878847592722, "cur_kl_coeff": 0.4623627006965761, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.274156579264888, "policy_loss": -0.0048368198279705316, "vf_loss": 5.267090598363725, "vf_explained_var": 0.12455908545741329, "kl": 0.02574342825208549, "entropy": 0.7722322370640184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.348527621819327, "cur_kl_coeff": 0.0988602547729612, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.4678797314564385, "policy_loss": 0.005477972145793804, "vf_loss": 7.4619156668583555, "vf_explained_var": 0.051895561069250105, "kl": 0.004917113543100034, "entropy": 0.45354066845029595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 152160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000}, "env_runners": {"episode_reward_max": 176.88105915890878, "episode_reward_min": -80.85589753199898, "episode_reward_mean": 59.917056422341005, "episode_len_mean": 163.1, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 16310, "policy_reward_min": {"agent_policy": -40.42794876599948, "adversary_policy": -35.93812486654127}, "policy_reward_max": {"agent_policy": 88.44052957945438, "adversary_policy": 54.87651802671376}, "policy_reward_mean": {"agent_policy": 29.958528211170506, "adversary_policy": 14.979264105585253}, "custom_metrics": {}, "hist_stats": {"episode_reward": [111.55605246734555, 43.519524779406595, 142.14239191912552, -0.6683397849239299, 50.92028491160784, 97.83881071619264, 176.88105915890878, 49.77942089047002, 99.18186219490252, 103.71442292405507, 50.80762598758342, 84.3122198811013, 96.87660417624087, 116.75317108700814, 151.54021195416098, 104.83069859002416, 156.82562932844772, 48.31541654607237, 48.89354213972711, 91.28029168536446, 103.55286086455783, 46.328095569006756, 96.61136117071078, 92.79414009616337, 106.79778345351706, 161.19491658987405, 96.1475880357737, 47.70642761168804, 77.51997672432665, -26.019821172877066, 4.595389828776269, 95.39954827605213, 33.55718808227026, 6.199056915657241, 77.74529631618644, 11.817836587959803, 57.56921537515372, 80.87304062086022, 61.77617942244525, 28.34038108877572, 22.05940280493298, 109.25481511892266, 1.535294987518958, 61.34068704493068, 68.45954681003813, -80.85589753199898, 43.101594371380344, 90.30116227241658, 53.64530208725709, 169.74789542680386, -24.268133472376967, 120.99477243308135, 56.017282139930465, 74.71136128173713, 64.43111484782753, 55.26061905487582, 51.15944459311589, 65.89060414839548, 38.94922409824432, 49.25396857419562, 4.80072522832274, 45.14074455479019, 30.99958389468828, 33.82181210427045, 17.047541628809878, 123.6637417011072, 80.75714417208117, -3.4639343707854025, 11.580252221675053, 16.750787660562786, -4.635666990364911, 98.13335599037256, 17.366187588806206, -28.668031627897456, 57.71399750607651, 28.703746141851646, 20.499742101393288, 88.3223655119576, 96.68330587286971, 57.88317025489533, 24.738059502996606, 0.762023026720648, 78.47317512626262, -2.684512613532906, 110.08174084025788, 36.655150410084275, 21.872674716984005, 94.59459469863623, 34.90625059829884, 94.82089377496669, 94.06160983040792, 78.1706927569844, 38.754221288828774, 11.795029369998495, 101.33018513238551, 96.05365200729554, 16.109751148119983, 43.5470790444614, -1.9143433104164558, 49.679719637948395], "episode_lengths": [200, 123, 200, 86, 200, 200, 200, 107, 159, 200, 92, 145, 200, 194, 200, 200, 200, 200, 200, 154, 192, 174, 160, 156, 44, 124, 122, 200, 200, 200, 39, 200, 52, 200, 136, 200, 137, 185, 200, 200, 200, 148, 1, 47, 141, 200, 200, 116, 78, 200, 200, 200, 200, 19, 102, 200, 91, 160, 33, 148, 189, 198, 200, 200, 55, 128, 58, 200, 200, 200, 200, 88, 200, 200, 200, 200, 200, 163, 139, 200, 200, 200, 200, 200, 150, 200, 200, 106, 200, 142, 77, 200, 200, 200, 200, 152, 200, 200, 200, 200], "policy_agent_policy_reward": [55.778026233672776, 21.759762389703297, 71.07119595956273, -0.3341698924619685, 25.460142455803922, 48.91940535809631, 88.44052957945438, 24.889710445235018, 49.59093109745125, 51.85721146202749, 25.403812993791718, 42.15610994055065, 48.43830208812041, 58.3765855435041, 75.77010597708046, 52.415349295012085, 78.4128146642239, 24.157708273036224, 24.446771069863587, 45.640145842682216, 51.776430432278936, 23.164047784503385, 48.30568058535539, 46.39707004808168, 53.39889172675853, 80.59745829493703, 48.07379401788689, 23.853213805844018, 38.75998836216334, -13.009910586438526, 2.297694914388133, 47.69977413802606, 16.778594041135133, 3.099528457828635, 38.87264815809323, 5.908918293979905, 28.78460768757687, 40.436520310430126, 30.888089711222626, 14.170190544387847, 11.029701402466497, 54.62740755946132, 0.767647493759479, 30.67034352246535, 34.22977340501906, -40.42794876599948, 21.550797185690143, 45.150581136208274, 26.822651043628554, 84.87394771340193, -12.134066736188462, 60.497386216540676, 28.008641069965236, 37.35568064086857, 32.215557423913765, 27.63030952743791, 25.57972229655796, 32.94530207419774, 19.474612049122165, 24.626984287097816, 2.400362614161363, 22.570372277395094, 15.49979194734414, 16.910906052135225, 8.523770814404939, 61.8318708505536, 40.37857208604055, -1.731967185392655, 5.790126110837527, 8.3753938302814, -2.3178334951824446, 49.06667799518631, 8.68309379440311, -14.33401581394877, 28.856998753038262, 14.351873070925823, 10.249871050696653, 44.16118275597882, 48.34165293643483, 28.941585127447674, 12.369029751498303, 0.381011513360324, 39.23658756313132, -1.3422563067665099, 55.040870420128925, 18.327575205042137, 10.936337358492011, 47.297297349318086, 17.453125299149413, 47.41044688748337, 47.03080491520397, 39.08534637849218, 19.377110644414394, 5.89751468499923, 50.66509256619277, 48.0268260036478, 8.054875574059952, 21.773539522230706, -0.9571716552082279, 24.839859818974197], "policy_adversary_policy_reward": [21.85259442724819, 33.925431806424584, 3.7851019793790073, 17.97466041032429, 30.29298093790493, 40.778215021657815, 1.3670648966246794, -1.701234789086655, 14.031000214593291, 11.429142241210629, 32.55663286275139, 16.36277249534492, 36.89471591672765, 51.54581366272677, 15.21887397697486, 9.670836468260152, 26.28109335686826, 23.309837740582985, 21.72520305542499, 30.132008406602505, 13.681604805579298, 11.722208188212415, 16.305204302329255, 25.85090563822139, 28.18195863003732, 20.256343458083116, 21.7377699701691, 36.638815573335, 29.957598578028353, 45.81250739905213, 43.326958579680834, 9.088390715331258, 38.430157157269925, 39.982657506953956, 9.161366571893609, 14.996341701142619, 6.989241797035643, 17.457529272827944, 1.9382929180361614, 43.701852924646055, 12.639988773165985, 39.13644165911295, -12.396761797135586, 35.56080958163896, 29.471392789929347, 18.83428779542605, 25.670172866680367, 20.726897181401306, 28.411575414986796, 24.987316311771743, 32.57405759684808, 48.023400698088935, 29.92353419318085, 18.150259824706023, 14.664037690213583, 9.189176115630435, 13.191116258998054, 25.568872103165283, -10.845139492662287, -2.164771093776249, 13.484501176596934, -11.186806262208798, 17.795383206224773, 29.90439093180129, 42.5039158429541, -25.725321801818968, 5.109017984042552, -2.0094895262139314, 23.812805969071313, 15.059842189021918, -0.9241656139202803, 6.833083907900182, 18.05070639241206, 10.733901295164806, 23.04549429762362, 17.391026012806513, 13.06417588279696, 17.823913828425667, 5.733622800410249, 8.436567743977594, 14.976896983929596, -3.947195581463099, 28.712948404660963, 25.914459154800365, 0.0, 0.767647493759479, -14.493364472122142, 45.16370799458749, 17.963333190406317, 16.26644021461275, -34.542007277563854, -5.885941488435655, 1.2175491948814248, 20.333247990808722, 28.78193496921194, 16.36864616699634, 36.40287549836074, -9.580224454732193, 35.67250888281721, 49.20143883058472, -16.407903827007654, 4.273837090819189, 15.365991383612212, 45.13139483292846, 31.947229891175844, -3.9385888212106117, 20.335374152803777, 17.02030648806479, 23.74184901887658, 8.473708405037184, 16.193035909251876, 11.437273618186033, 18.709983979138947, 6.869738317419014, 31.2319400628162, 1.713362011381541, 16.031466087187887, 3.4431459619342775, 4.458007800702243, 20.168976486395575, 19.32716965939568, -16.92680704523433, 11.170302977323658, 11.400069300071436, 14.323918203492521, 1.1758737438516214, 8.694173043360374, 8.216733008774852, 44.46189568094621, -35.93812486654127, 23.130953798307242, 38.70091705224637, 8.659745171221903, 31.71882691481867, 15.084636182828962, -16.816603368221617, 6.967315993488334, -1.1771898826508078, -3.8772746130803704, 12.252668443361785, -3.0797023875271883, 0.7618688923447507, 37.83718849869584, 11.22948949649044, 2.462993778566549, 6.2201000158365645, 1.5447020977748132, -15.878717911723584, 23.110667471042927, 5.746331281995335, 3.164421409196798, 11.187451661729025, 8.338550345971985, 1.9113207047246679, 21.530126198551546, 22.631056557427275, 29.109047485338184, 19.232605451096653, 24.760972300842866, 4.180612826604806, 13.379376774557173, -1.0103470230588698, 3.5996037344470047, -3.2185922210866806, 22.057717786881533, 17.178869776249783, 3.1619151521955295, -4.504171458962043, 33.40395118706911, 21.63691923305984, 4.508807505715211, 13.818767699326926, 6.3259340904429315, 4.61040326804908, -7.579220677395632, 54.87651802671376, 17.3137524807235, 0.13937281842591176, 20.819483608928476, 26.590963278554867, 31.88557242063706, 15.145232494566912, 15.581399464247003, 23.503946914245184, 10.245009214574615, 9.132101429839778, 8.39829854058652, -2.5007838555872866, 27.827861892125668, 22.83723067406709, 29.198962997319725, 18.827863006328077, 3.8130225816542236, 4.241852992405732, -4.916867837647935, 26.69040735987864, -4.6021062828675205, 3.6449346276592927, 26.753112371726708, -1.9132525527525104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39301486737153446, "mean_inference_ms": 0.9757119924803906, "mean_action_processing_ms": 0.166808407944533, "mean_env_wait_ms": 0.05834121129833143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003196120262145996, "StateBufferConnector_ms": 0.0025109052658081055, "ViewRequirementAgentConnector_ms": 0.06765735149383545}, "num_episodes": 23, "episode_return_max": 176.88105915890878, "episode_return_min": -80.85589753199898, "episode_return_mean": 59.917056422341005}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.14004017162256, "num_env_steps_trained_throughput_per_sec": 487.14004017162256, "timesteps_total": 636000, "num_env_steps_sampled_lifetime": 636000, "num_agent_steps_sampled_lifetime": 1908000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1908000, "timers": {"training_iteration_time_ms": 8232.516, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8232.482, "sample_time_ms": 774.37, "learn_time_ms": 7446.216, "learn_throughput": 537.186, "synch_weights_time_ms": 11.263}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000}, "done": false, "training_iteration": 159, "trial_id": "eaa30_00000", "date": "2024-08-09_18-02-13", "timestamp": 1723240933, "time_this_iter_s": 8.215984344482422, "time_total_s": 1306.6950573921204, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17807cd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1306.6950573921204, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 29.127272727272725, "ram_util_percent": 81.25454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.037723246327152, "cur_kl_coeff": 0.6935440510448643, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.851386842904268, "policy_loss": -0.007085302933279385, "vf_loss": 4.8489434422639315, "vf_explained_var": 0.16039307868039165, "kl": 0.013739129529881572, "entropy": 0.6580024574799512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.69935120207568, "cur_kl_coeff": 0.0494301273864806, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.2042741249005, "policy_loss": 0.0013955124906109026, "vf_loss": 7.202657677233219, "vf_explained_var": -0.0010746929173668226, "kl": 0.004469086667086231, "entropy": 0.3747746633676191, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 153120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 169.74789542680386, "episode_reward_min": -80.85589753199898, "episode_reward_mean": 48.738968820142716, "episode_len_mean": 162.78, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 16278, "policy_reward_min": {"agent_policy": -40.42794876599948, "adversary_policy": -35.93812486654127}, "policy_reward_max": {"agent_policy": 84.87394771340193, "adversary_policy": 54.87651802671376}, "policy_reward_mean": {"agent_policy": 24.369484410071355, "adversary_policy": 12.184742205035683}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.328095569006756, 96.61136117071078, 92.79414009616337, 106.79778345351706, 161.19491658987405, 96.1475880357737, 47.70642761168804, 77.51997672432665, -26.019821172877066, 4.595389828776269, 95.39954827605213, 33.55718808227026, 6.199056915657241, 77.74529631618644, 11.817836587959803, 57.56921537515372, 80.87304062086022, 61.77617942244525, 28.34038108877572, 22.05940280493298, 109.25481511892266, 1.535294987518958, 61.34068704493068, 68.45954681003813, -80.85589753199898, 43.101594371380344, 90.30116227241658, 53.64530208725709, 169.74789542680386, -24.268133472376967, 120.99477243308135, 56.017282139930465, 74.71136128173713, 64.43111484782753, 55.26061905487582, 51.15944459311589, 65.89060414839548, 38.94922409824432, 49.25396857419562, 4.80072522832274, 45.14074455479019, 30.99958389468828, 33.82181210427045, 17.047541628809878, 123.6637417011072, 80.75714417208117, -3.4639343707854025, 11.580252221675053, 16.750787660562786, -4.635666990364911, 98.13335599037256, 17.366187588806206, -28.668031627897456, 57.71399750607651, 28.703746141851646, 20.499742101393288, 88.3223655119576, 96.68330587286971, 57.88317025489533, 24.738059502996606, 0.762023026720648, 78.47317512626262, -2.684512613532906, 110.08174084025788, 36.655150410084275, 21.872674716984005, 94.59459469863623, 34.90625059829884, 94.82089377496669, 94.06160983040792, 78.1706927569844, 38.754221288828774, 11.795029369998495, 101.33018513238551, 96.05365200729554, 16.109751148119983, 43.5470790444614, -1.9143433104164558, 49.679719637948395, 47.30651560821215, 58.31663300686591, 16.344103506522313, -22.390597620806915, 37.72901510530286, 0.4795860104269707, 131.90589072674987, 6.1685957188469445, 108.31544101290285, 8.827602404586138, -3.936215167819518, 102.3433264799178, 38.39636430140898, -30.738320853413555, 41.01896468501843, 20.122093997171874, 115.61288293215301, 103.1462107284938, 18.466057975117813, 51.709424759265374, -38.09857311937235], "episode_lengths": [174, 160, 156, 44, 124, 122, 200, 200, 200, 39, 200, 52, 200, 136, 200, 137, 185, 200, 200, 200, 148, 1, 47, 141, 200, 200, 116, 78, 200, 200, 200, 200, 19, 102, 200, 91, 160, 33, 148, 189, 198, 200, 200, 55, 128, 58, 200, 200, 200, 200, 88, 200, 200, 200, 200, 200, 163, 139, 200, 200, 200, 200, 200, 150, 200, 200, 106, 200, 142, 77, 200, 200, 200, 200, 152, 200, 200, 200, 200, 178, 152, 200, 200, 180, 200, 170, 200, 200, 200, 5, 181, 200, 200, 200, 200, 200, 118, 200, 36, 200], "policy_agent_policy_reward": [23.164047784503385, 48.30568058535539, 46.39707004808168, 53.39889172675853, 80.59745829493703, 48.07379401788689, 23.853213805844018, 38.75998836216334, -13.009910586438526, 2.297694914388133, 47.69977413802606, 16.778594041135133, 3.099528457828635, 38.87264815809323, 5.908918293979905, 28.78460768757687, 40.436520310430126, 30.888089711222626, 14.170190544387847, 11.029701402466497, 54.62740755946132, 0.767647493759479, 30.67034352246535, 34.22977340501906, -40.42794876599948, 21.550797185690143, 45.150581136208274, 26.822651043628554, 84.87394771340193, -12.134066736188462, 60.497386216540676, 28.008641069965236, 37.35568064086857, 32.215557423913765, 27.63030952743791, 25.57972229655796, 32.94530207419774, 19.474612049122165, 24.626984287097816, 2.400362614161363, 22.570372277395094, 15.49979194734414, 16.910906052135225, 8.523770814404939, 61.8318708505536, 40.37857208604055, -1.731967185392655, 5.790126110837527, 8.3753938302814, -2.3178334951824446, 49.06667799518631, 8.68309379440311, -14.33401581394877, 28.856998753038262, 14.351873070925823, 10.249871050696653, 44.16118275597882, 48.34165293643483, 28.941585127447674, 12.369029751498303, 0.381011513360324, 39.23658756313132, -1.3422563067665099, 55.040870420128925, 18.327575205042137, 10.936337358492011, 47.297297349318086, 17.453125299149413, 47.41044688748337, 47.03080491520397, 39.08534637849218, 19.377110644414394, 5.89751468499923, 50.66509256619277, 48.0268260036478, 8.054875574059952, 21.773539522230706, -0.9571716552082279, 24.839859818974197, 23.65325780410607, 29.15831650343294, 8.172051753261165, -11.195298810403475, 18.86450755265142, 0.23979300521346403, 65.952945363375, 3.0842978594234864, 54.157720506451426, 4.413801202293051, -1.9681075839097593, 51.17166323995891, 19.198182150704504, -15.369160426706745, 20.509482342509216, 10.061046998585937, 57.80644146607651, 51.57310536424687, 9.23302898755892, 25.854712379632687, -19.049286559686124], "policy_adversary_policy_reward": [-12.396761797135586, 35.56080958163896, 29.471392789929347, 18.83428779542605, 25.670172866680367, 20.726897181401306, 28.411575414986796, 24.987316311771743, 32.57405759684808, 48.023400698088935, 29.92353419318085, 18.150259824706023, 14.664037690213583, 9.189176115630435, 13.191116258998054, 25.568872103165283, -10.845139492662287, -2.164771093776249, 13.484501176596934, -11.186806262208798, 17.795383206224773, 29.90439093180129, 42.5039158429541, -25.725321801818968, 5.109017984042552, -2.0094895262139314, 23.812805969071313, 15.059842189021918, -0.9241656139202803, 6.833083907900182, 18.05070639241206, 10.733901295164806, 23.04549429762362, 17.391026012806513, 13.06417588279696, 17.823913828425667, 5.733622800410249, 8.436567743977594, 14.976896983929596, -3.947195581463099, 28.712948404660963, 25.914459154800365, 0.0, 0.767647493759479, -14.493364472122142, 45.16370799458749, 17.963333190406317, 16.26644021461275, -34.542007277563854, -5.885941488435655, 1.2175491948814248, 20.333247990808722, 28.78193496921194, 16.36864616699634, 36.40287549836074, -9.580224454732193, 35.67250888281721, 49.20143883058472, -16.407903827007654, 4.273837090819189, 15.365991383612212, 45.13139483292846, 31.947229891175844, -3.9385888212106117, 20.335374152803777, 17.02030648806479, 23.74184901887658, 8.473708405037184, 16.193035909251876, 11.437273618186033, 18.709983979138947, 6.869738317419014, 31.2319400628162, 1.713362011381541, 16.031466087187887, 3.4431459619342775, 4.458007800702243, 20.168976486395575, 19.32716965939568, -16.92680704523433, 11.170302977323658, 11.400069300071436, 14.323918203492521, 1.1758737438516214, 8.694173043360374, 8.216733008774852, 44.46189568094621, -35.93812486654127, 23.130953798307242, 38.70091705224637, 8.659745171221903, 31.71882691481867, 15.084636182828962, -16.816603368221617, 6.967315993488334, -1.1771898826508078, -3.8772746130803704, 12.252668443361785, -3.0797023875271883, 0.7618688923447507, 37.83718849869584, 11.22948949649044, 2.462993778566549, 6.2201000158365645, 1.5447020977748132, -15.878717911723584, 23.110667471042927, 5.746331281995335, 3.164421409196798, 11.187451661729025, 8.338550345971985, 1.9113207047246679, 21.530126198551546, 22.631056557427275, 29.109047485338184, 19.232605451096653, 24.760972300842866, 4.180612826604806, 13.379376774557173, -1.0103470230588698, 3.5996037344470047, -3.2185922210866806, 22.057717786881533, 17.178869776249783, 3.1619151521955295, -4.504171458962043, 33.40395118706911, 21.63691923305984, 4.508807505715211, 13.818767699326926, 6.3259340904429315, 4.61040326804908, -7.579220677395632, 54.87651802671376, 17.3137524807235, 0.13937281842591176, 20.819483608928476, 26.590963278554867, 31.88557242063706, 15.145232494566912, 15.581399464247003, 23.503946914245184, 10.245009214574615, 9.132101429839778, 8.39829854058652, -2.5007838555872866, 27.827861892125668, 22.83723067406709, 29.198962997319725, 18.827863006328077, 3.8130225816542236, 4.241852992405732, -4.916867837647935, 26.69040735987864, -4.6021062828675205, 3.6449346276592927, 26.753112371726708, -1.9132525527525104, 11.075355292727544, 12.577902511378523, 19.238207930125387, 9.920108573307552, 7.155157077836121, 1.0168946754250427, -0.03494867866045581, -11.160350131742998, 4.270484534006304, 14.594023018645117, 5.654110032217854, -5.41431702700439, 22.297177451088118, 43.65576791228686, -9.44107427737541, 12.525372136798897, 23.030693446915997, 31.127027059535433, 1.708880744598769, 2.7049204576942785, 2.35421270978955, -4.32232029369931, 38.74254629631684, 12.429116943642093, 22.683899235342462, -3.485717084637958, -3.9956867830693987, -11.373473643637354, 17.60569037977116, 2.9037919627380546, -4.053390284665376, 14.114437283251313, 31.830977677005798, 25.975463789070712, 11.462642011713783, 40.1104633525331, 3.04368261624343, 6.1893463713154855, -9.77148771642705, 35.62620009605975, -0.5126659418581703, -18.53662061782792]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39297499682334214, "mean_inference_ms": 0.9761615822384014, "mean_action_processing_ms": 0.16670389707461727, "mean_env_wait_ms": 0.05832451873387159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003270387649536133, "StateBufferConnector_ms": 0.002611517906188965, "ViewRequirementAgentConnector_ms": 0.06800341606140137}, "num_episodes": 21, "episode_return_max": 169.74789542680386, "episode_return_min": -80.85589753199898, "episode_return_mean": 48.738968820142716}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.2724992879292, "num_env_steps_trained_throughput_per_sec": 494.2724992879292, "timesteps_total": 640000, "num_env_steps_sampled_lifetime": 640000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 8221.137, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8221.103, "sample_time_ms": 770.07, "learn_time_ms": 7439.066, "learn_throughput": 537.702, "synch_weights_time_ms": 11.331}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 160, "trial_id": "eaa30_00000", "date": "2024-08-09_18-02-21", "timestamp": 1723240941, "time_this_iter_s": 8.097219228744507, "time_total_s": 1314.7922766208649, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x178129c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1314.7922766208649, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 28.391666666666666, "ram_util_percent": 81.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.035747778731048, "cur_kl_coeff": 0.6935440510448643, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.949631392388117, "policy_loss": 0.0025369941478683837, "vf_loss": 4.937136437148644, "vf_explained_var": 0.08722064621234066, "kl": 0.01435806441943718, "entropy": 0.6462690355601134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.179682010908921, "cur_kl_coeff": 0.0247150636932403, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.446137782931328, "policy_loss": 0.0067240805064405626, "vf_loss": 7.43929124524196, "vf_explained_var": -0.023523001496990523, "kl": 0.004955400596979113, "entropy": 0.35502120067055026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 154080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000}, "env_runners": {"episode_reward_max": 169.74789542680386, "episode_reward_min": -80.85589753199898, "episode_reward_mean": 47.31693024279008, "episode_len_mean": 171.51, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 17151, "policy_reward_min": {"agent_policy": -40.42794876599948, "adversary_policy": -35.93812486654127}, "policy_reward_max": {"agent_policy": 84.87394771340193, "adversary_policy": 54.87651802671376}, "policy_reward_mean": {"agent_policy": 23.658465121395043, "adversary_policy": 11.829232560697521}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.34068704493068, 68.45954681003813, -80.85589753199898, 43.101594371380344, 90.30116227241658, 53.64530208725709, 169.74789542680386, -24.268133472376967, 120.99477243308135, 56.017282139930465, 74.71136128173713, 64.43111484782753, 55.26061905487582, 51.15944459311589, 65.89060414839548, 38.94922409824432, 49.25396857419562, 4.80072522832274, 45.14074455479019, 30.99958389468828, 33.82181210427045, 17.047541628809878, 123.6637417011072, 80.75714417208117, -3.4639343707854025, 11.580252221675053, 16.750787660562786, -4.635666990364911, 98.13335599037256, 17.366187588806206, -28.668031627897456, 57.71399750607651, 28.703746141851646, 20.499742101393288, 88.3223655119576, 96.68330587286971, 57.88317025489533, 24.738059502996606, 0.762023026720648, 78.47317512626262, -2.684512613532906, 110.08174084025788, 36.655150410084275, 21.872674716984005, 94.59459469863623, 34.90625059829884, 94.82089377496669, 94.06160983040792, 78.1706927569844, 38.754221288828774, 11.795029369998495, 101.33018513238551, 96.05365200729554, 16.109751148119983, 43.5470790444614, -1.9143433104164558, 49.679719637948395, 47.30651560821215, 58.31663300686591, 16.344103506522313, -22.390597620806915, 37.72901510530286, 0.4795860104269707, 131.90589072674987, 6.1685957188469445, 108.31544101290285, 8.827602404586138, -3.936215167819518, 102.3433264799178, 38.39636430140898, -30.738320853413555, 41.01896468501843, 20.122093997171874, 115.61288293215301, 103.1462107284938, 18.466057975117813, 51.709424759265374, -38.09857311937235, 165.63186899232954, 28.304346208434616, 118.38037986243836, 24.843923793591024, 47.58092723969395, 29.032404271000296, 36.325887803896066, 59.839410109686206, 133.09977908235948, 71.3091654118131, -54.61158152321359, 52.8623761999048, 17.704954019479075, 18.977406304455265, 86.14094565581571, 30.004263971153712, 22.641622020181018, 4.360403606618792, 49.38164320699657, 99.37021810217904, 45.607623889425696, 60.81128754019308], "episode_lengths": [47, 141, 200, 200, 116, 78, 200, 200, 200, 200, 19, 102, 200, 91, 160, 33, 148, 189, 198, 200, 200, 55, 128, 58, 200, 200, 200, 200, 88, 200, 200, 200, 200, 200, 163, 139, 200, 200, 200, 200, 200, 150, 200, 200, 106, 200, 142, 77, 200, 200, 200, 200, 152, 200, 200, 200, 200, 178, 152, 200, 200, 180, 200, 170, 200, 200, 200, 5, 181, 200, 200, 200, 200, 200, 118, 200, 36, 200, 200, 200, 124, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 185, 200, 200, 200, 200, 42, 200, 200], "policy_agent_policy_reward": [30.67034352246535, 34.22977340501906, -40.42794876599948, 21.550797185690143, 45.150581136208274, 26.822651043628554, 84.87394771340193, -12.134066736188462, 60.497386216540676, 28.008641069965236, 37.35568064086857, 32.215557423913765, 27.63030952743791, 25.57972229655796, 32.94530207419774, 19.474612049122165, 24.626984287097816, 2.400362614161363, 22.570372277395094, 15.49979194734414, 16.910906052135225, 8.523770814404939, 61.8318708505536, 40.37857208604055, -1.731967185392655, 5.790126110837527, 8.3753938302814, -2.3178334951824446, 49.06667799518631, 8.68309379440311, -14.33401581394877, 28.856998753038262, 14.351873070925823, 10.249871050696653, 44.16118275597882, 48.34165293643483, 28.941585127447674, 12.369029751498303, 0.381011513360324, 39.23658756313132, -1.3422563067665099, 55.040870420128925, 18.327575205042137, 10.936337358492011, 47.297297349318086, 17.453125299149413, 47.41044688748337, 47.03080491520397, 39.08534637849218, 19.377110644414394, 5.89751468499923, 50.66509256619277, 48.0268260036478, 8.054875574059952, 21.773539522230706, -0.9571716552082279, 24.839859818974197, 23.65325780410607, 29.15831650343294, 8.172051753261165, -11.195298810403475, 18.86450755265142, 0.23979300521346403, 65.952945363375, 3.0842978594234864, 54.157720506451426, 4.413801202293051, -1.9681075839097593, 51.17166323995891, 19.198182150704504, -15.369160426706745, 20.509482342509216, 10.061046998585937, 57.80644146607651, 51.57310536424687, 9.23302898755892, 25.854712379632687, -19.049286559686124, 82.8159344961648, 14.152173104217308, 59.19018993121918, 12.421961896795512, 23.79046361984698, 14.516202135500155, 18.162943901948026, 29.919705054843078, 66.54988954117975, 35.65458270590656, -27.305790761606772, 26.43118809995241, 8.852477009739516, 9.488703152227645, 43.07047282790785, 15.002131985576856, 11.320811010090509, 2.1802018033093873, 24.69082160349828, 49.68510905108951, 22.803811944712848, 30.40564377009651], "policy_adversary_policy_reward": [-14.493364472122142, 45.16370799458749, 17.963333190406317, 16.26644021461275, -34.542007277563854, -5.885941488435655, 1.2175491948814248, 20.333247990808722, 28.78193496921194, 16.36864616699634, 36.40287549836074, -9.580224454732193, 35.67250888281721, 49.20143883058472, -16.407903827007654, 4.273837090819189, 15.365991383612212, 45.13139483292846, 31.947229891175844, -3.9385888212106117, 20.335374152803777, 17.02030648806479, 23.74184901887658, 8.473708405037184, 16.193035909251876, 11.437273618186033, 18.709983979138947, 6.869738317419014, 31.2319400628162, 1.713362011381541, 16.031466087187887, 3.4431459619342775, 4.458007800702243, 20.168976486395575, 19.32716965939568, -16.92680704523433, 11.170302977323658, 11.400069300071436, 14.323918203492521, 1.1758737438516214, 8.694173043360374, 8.216733008774852, 44.46189568094621, -35.93812486654127, 23.130953798307242, 38.70091705224637, 8.659745171221903, 31.71882691481867, 15.084636182828962, -16.816603368221617, 6.967315993488334, -1.1771898826508078, -3.8772746130803704, 12.252668443361785, -3.0797023875271883, 0.7618688923447507, 37.83718849869584, 11.22948949649044, 2.462993778566549, 6.2201000158365645, 1.5447020977748132, -15.878717911723584, 23.110667471042927, 5.746331281995335, 3.164421409196798, 11.187451661729025, 8.338550345971985, 1.9113207047246679, 21.530126198551546, 22.631056557427275, 29.109047485338184, 19.232605451096653, 24.760972300842866, 4.180612826604806, 13.379376774557173, -1.0103470230588698, 3.5996037344470047, -3.2185922210866806, 22.057717786881533, 17.178869776249783, 3.1619151521955295, -4.504171458962043, 33.40395118706911, 21.63691923305984, 4.508807505715211, 13.818767699326926, 6.3259340904429315, 4.61040326804908, -7.579220677395632, 54.87651802671376, 17.3137524807235, 0.13937281842591176, 20.819483608928476, 26.590963278554867, 31.88557242063706, 15.145232494566912, 15.581399464247003, 23.503946914245184, 10.245009214574615, 9.132101429839778, 8.39829854058652, -2.5007838555872866, 27.827861892125668, 22.83723067406709, 29.198962997319725, 18.827863006328077, 3.8130225816542236, 4.241852992405732, -4.916867837647935, 26.69040735987864, -4.6021062828675205, 3.6449346276592927, 26.753112371726708, -1.9132525527525104, 11.075355292727544, 12.577902511378523, 19.238207930125387, 9.920108573307552, 7.155157077836121, 1.0168946754250427, -0.03494867866045581, -11.160350131742998, 4.270484534006304, 14.594023018645117, 5.654110032217854, -5.41431702700439, 22.297177451088118, 43.65576791228686, -9.44107427737541, 12.525372136798897, 23.030693446915997, 31.127027059535433, 1.708880744598769, 2.7049204576942785, 2.35421270978955, -4.32232029369931, 38.74254629631684, 12.429116943642093, 22.683899235342462, -3.485717084637958, -3.9956867830693987, -11.373473643637354, 17.60569037977116, 2.9037919627380546, -4.053390284665376, 14.114437283251313, 31.830977677005798, 25.975463789070712, 11.462642011713783, 40.1104633525331, 3.04368261624343, 6.1893463713154855, -9.77148771642705, 35.62620009605975, -0.5126659418581703, -18.53662061782792, 36.42742396112592, 46.38851053503891, 13.817152237618672, 0.3350208665986365, 10.311919372386011, 48.878270558833144, 3.1516748544731357, 9.270287042322376, 6.042439944763757, 17.748023675083225, 9.138023728381086, 5.37817840711907, 6.287850967639528, 11.875092934308498, 12.44665154977551, 17.47305350506756, 29.74283268672641, 36.80705685445332, 0.3573851487655766, 35.29719755714097, -14.97995840126232, -12.325832360344457, 13.647919321900972, 12.78326877805144, 12.537780453415625, -3.685303443676105, 3.4654598128059657, 6.023243339421679, 25.896293290049787, 17.174179537858063, 15.11387618235921, -0.11174419678235381, 4.145663809376323, 7.175147200714186, 9.908923834432674, -7.7287220311232865, 6.547125933232785, 18.143695670265494, 16.560573795490733, 33.12453525559881, 16.963690403452624, 5.840121541260224, 22.71774968832174, 7.687894081774765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39287513240194416, "mean_inference_ms": 0.9767097490443162, "mean_action_processing_ms": 0.16683158048153446, "mean_env_wait_ms": 0.05829329585945325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032657384872436523, "StateBufferConnector_ms": 0.002449512481689453, "ViewRequirementAgentConnector_ms": 0.06608998775482178}, "num_episodes": 22, "episode_return_max": 169.74789542680386, "episode_return_min": -80.85589753199898, "episode_return_mean": 47.31693024279008}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 476.8254367591726, "num_env_steps_trained_throughput_per_sec": 476.8254367591726, "timesteps_total": 644000, "num_env_steps_sampled_lifetime": 644000, "num_agent_steps_sampled_lifetime": 1932000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1932000, "timers": {"training_iteration_time_ms": 8261.424, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8261.39, "sample_time_ms": 779.683, "learn_time_ms": 7469.646, "learn_throughput": 535.501, "synch_weights_time_ms": 11.471}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000}, "done": false, "training_iteration": 161, "trial_id": "eaa30_00000", "date": "2024-08-09_18-02-30", "timestamp": 1723240950, "time_this_iter_s": 8.392443180084229, "time_total_s": 1323.184719800949, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x178129ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1323.184719800949, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 28.424999999999997, "ram_util_percent": 81.29166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.339037453308308, "cur_kl_coeff": 0.6935440510448643, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.737807179506493, "policy_loss": -0.002971050806870812, "vf_loss": 4.733316595592196, "vf_explained_var": 0.03736532447199342, "kl": 0.010758720121035974, "entropy": 0.66694056852154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.757934535605212, "cur_kl_coeff": 0.01235753184662015, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.17916718373696, "policy_loss": -0.00041036299905196453, "vf_loss": 7.179499049981435, "vf_explained_var": -0.03581386152654886, "kl": 0.0063516799449037835, "entropy": 0.4057000401740273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 155040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000}, "env_runners": {"episode_reward_max": 165.63186899232954, "episode_reward_min": -63.76245733705426, "episode_reward_mean": 44.81258912004051, "episode_len_mean": 178.64, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 17864, "policy_reward_min": {"agent_policy": -31.881228668527136, "adversary_policy": -19.525761470808373}, "policy_reward_max": {"agent_policy": 82.8159344961648, "adversary_policy": 54.87651802671376}, "policy_reward_mean": {"agent_policy": 22.40629456002026, "adversary_policy": 11.203147280010128}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.635666990364911, 98.13335599037256, 17.366187588806206, -28.668031627897456, 57.71399750607651, 28.703746141851646, 20.499742101393288, 88.3223655119576, 96.68330587286971, 57.88317025489533, 24.738059502996606, 0.762023026720648, 78.47317512626262, -2.684512613532906, 110.08174084025788, 36.655150410084275, 21.872674716984005, 94.59459469863623, 34.90625059829884, 94.82089377496669, 94.06160983040792, 78.1706927569844, 38.754221288828774, 11.795029369998495, 101.33018513238551, 96.05365200729554, 16.109751148119983, 43.5470790444614, -1.9143433104164558, 49.679719637948395, 47.30651560821215, 58.31663300686591, 16.344103506522313, -22.390597620806915, 37.72901510530286, 0.4795860104269707, 131.90589072674987, 6.1685957188469445, 108.31544101290285, 8.827602404586138, -3.936215167819518, 102.3433264799178, 38.39636430140898, -30.738320853413555, 41.01896468501843, 20.122093997171874, 115.61288293215301, 103.1462107284938, 18.466057975117813, 51.709424759265374, -38.09857311937235, 165.63186899232954, 28.304346208434616, 118.38037986243836, 24.843923793591024, 47.58092723969395, 29.032404271000296, 36.325887803896066, 59.839410109686206, 133.09977908235948, 71.3091654118131, -54.61158152321359, 52.8623761999048, 17.704954019479075, 18.977406304455265, 86.14094565581571, 30.004263971153712, 22.641622020181018, 4.360403606618792, 49.38164320699657, 99.37021810217904, 45.607623889425696, 60.81128754019308, 126.62824375443586, -63.76245733705426, 119.63265400218515, 2.0898432591150744, 24.355138534540536, -45.16008900198821, -6.217230282556947, -43.79722564618645, 10.341161303573479, 105.52279439195524, 95.64521918695091, -50.78198199262829, 71.26244524576336, 5.166180020959921, 92.3885428356673, 57.73648844536936, 88.8228146605347, 70.93604649895866, 74.75676959217637, 32.150007969061505, 33.809698397741116, 39.35782113206827, 68.176551384334, 91.41712091392083, 60.65098590505018, -2.3015794292548577, 9.97887095572666], "episode_lengths": [200, 88, 200, 200, 200, 200, 200, 163, 139, 200, 200, 200, 200, 200, 150, 200, 200, 106, 200, 142, 77, 200, 200, 200, 200, 152, 200, 200, 200, 200, 178, 152, 200, 200, 180, 200, 170, 200, 200, 200, 5, 181, 200, 200, 200, 200, 200, 118, 200, 36, 200, 200, 200, 124, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 185, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 31, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 15], "policy_agent_policy_reward": [-2.3178334951824446, 49.06667799518631, 8.68309379440311, -14.33401581394877, 28.856998753038262, 14.351873070925823, 10.249871050696653, 44.16118275597882, 48.34165293643483, 28.941585127447674, 12.369029751498303, 0.381011513360324, 39.23658756313132, -1.3422563067665099, 55.040870420128925, 18.327575205042137, 10.936337358492011, 47.297297349318086, 17.453125299149413, 47.41044688748337, 47.03080491520397, 39.08534637849218, 19.377110644414394, 5.89751468499923, 50.66509256619277, 48.0268260036478, 8.054875574059952, 21.773539522230706, -0.9571716552082279, 24.839859818974197, 23.65325780410607, 29.15831650343294, 8.172051753261165, -11.195298810403475, 18.86450755265142, 0.23979300521346403, 65.952945363375, 3.0842978594234864, 54.157720506451426, 4.413801202293051, -1.9681075839097593, 51.17166323995891, 19.198182150704504, -15.369160426706745, 20.509482342509216, 10.061046998585937, 57.80644146607651, 51.57310536424687, 9.23302898755892, 25.854712379632687, -19.049286559686124, 82.8159344961648, 14.152173104217308, 59.19018993121918, 12.421961896795512, 23.79046361984698, 14.516202135500155, 18.162943901948026, 29.919705054843078, 66.54988954117975, 35.65458270590656, -27.305790761606772, 26.43118809995241, 8.852477009739516, 9.488703152227645, 43.07047282790785, 15.002131985576856, 11.320811010090509, 2.1802018033093873, 24.69082160349828, 49.68510905108951, 22.803811944712848, 30.40564377009651, 63.3141218772179, -31.881228668527136, 59.816327001092525, 1.0449216295575372, 12.177569267270268, -22.580044500994084, -3.1086151412784986, -21.898612823093316, 5.170580651786739, 52.76139719597767, 47.82260959347545, -25.390990996314162, 35.63122262288168, 2.5830900104799426, 46.19427141783365, 28.868244222684694, 44.41140733026734, 35.46802324947933, 37.37838479608819, 16.075003984530767, 16.904849198870558, 19.678910566034137, 34.088275692166995, 45.70856045696042, 30.32549295252509, -1.1507897146274324, 4.9894354778633305], "policy_adversary_policy_reward": [-3.0797023875271883, 0.7618688923447507, 37.83718849869584, 11.22948949649044, 2.462993778566549, 6.2201000158365645, 1.5447020977748132, -15.878717911723584, 23.110667471042927, 5.746331281995335, 3.164421409196798, 11.187451661729025, 8.338550345971985, 1.9113207047246679, 21.530126198551546, 22.631056557427275, 29.109047485338184, 19.232605451096653, 24.760972300842866, 4.180612826604806, 13.379376774557173, -1.0103470230588698, 3.5996037344470047, -3.2185922210866806, 22.057717786881533, 17.178869776249783, 3.1619151521955295, -4.504171458962043, 33.40395118706911, 21.63691923305984, 4.508807505715211, 13.818767699326926, 6.3259340904429315, 4.61040326804908, -7.579220677395632, 54.87651802671376, 17.3137524807235, 0.13937281842591176, 20.819483608928476, 26.590963278554867, 31.88557242063706, 15.145232494566912, 15.581399464247003, 23.503946914245184, 10.245009214574615, 9.132101429839778, 8.39829854058652, -2.5007838555872866, 27.827861892125668, 22.83723067406709, 29.198962997319725, 18.827863006328077, 3.8130225816542236, 4.241852992405732, -4.916867837647935, 26.69040735987864, -4.6021062828675205, 3.6449346276592927, 26.753112371726708, -1.9132525527525104, 11.075355292727544, 12.577902511378523, 19.238207930125387, 9.920108573307552, 7.155157077836121, 1.0168946754250427, -0.03494867866045581, -11.160350131742998, 4.270484534006304, 14.594023018645117, 5.654110032217854, -5.41431702700439, 22.297177451088118, 43.65576791228686, -9.44107427737541, 12.525372136798897, 23.030693446915997, 31.127027059535433, 1.708880744598769, 2.7049204576942785, 2.35421270978955, -4.32232029369931, 38.74254629631684, 12.429116943642093, 22.683899235342462, -3.485717084637958, -3.9956867830693987, -11.373473643637354, 17.60569037977116, 2.9037919627380546, -4.053390284665376, 14.114437283251313, 31.830977677005798, 25.975463789070712, 11.462642011713783, 40.1104633525331, 3.04368261624343, 6.1893463713154855, -9.77148771642705, 35.62620009605975, -0.5126659418581703, -18.53662061782792, 36.42742396112592, 46.38851053503891, 13.817152237618672, 0.3350208665986365, 10.311919372386011, 48.878270558833144, 3.1516748544731357, 9.270287042322376, 6.042439944763757, 17.748023675083225, 9.138023728381086, 5.37817840711907, 6.287850967639528, 11.875092934308498, 12.44665154977551, 17.47305350506756, 29.74283268672641, 36.80705685445332, 0.3573851487655766, 35.29719755714097, -14.97995840126232, -12.325832360344457, 13.647919321900972, 12.78326877805144, 12.537780453415625, -3.685303443676105, 3.4654598128059657, 6.023243339421679, 25.896293290049787, 17.174179537858063, 15.11387618235921, -0.11174419678235381, 4.145663809376323, 7.175147200714186, 9.908923834432674, -7.7287220311232865, 6.547125933232785, 18.143695670265494, 16.560573795490733, 33.12453525559881, 16.963690403452624, 5.840121541260224, 22.71774968832174, 7.687894081774765, 37.04718152443407, 26.266940352783834, -18.94346445189303, -12.937764216634122, 21.203985140553584, 38.61234186053895, 3.0130156944683986, -1.9680940649108614, 1.963667198281577, 10.213902068988691, -9.064647722699043, -13.515396778295042, -8.360099234124554, 5.251484092846056, -2.372851352284961, -19.525761470808373, 5.381607879389145, -0.2110272276024059, 19.742538622552118, 33.01885857342556, 22.373199589399864, 25.449410004075574, -13.46178580724078, -11.929205189073382, 7.364321656822895, 28.266900966058785, -4.636192613317011, 7.219282623796953, 17.294737186122003, 28.899534231711634, 9.824300579099411, 19.04394364358528, 19.743867067996995, 24.667540262270343, 13.421411368155514, 22.04661188132382, 17.99722758305257, 19.38115721303562, 6.026105151064154, 10.048898833466613, 2.3251712386252166, 14.579677960245341, 10.896414654778283, 8.782495911255856, 15.608219951333385, 18.48005574083361, 8.228799511439108, 37.4797609455213, 23.728712928418076, 6.596780024107019, -3.2357862761440828, 2.0849965615166504, -8.969589974851992, 13.959025452715323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3928040502960722, "mean_inference_ms": 0.9762556143443725, "mean_action_processing_ms": 0.16679050892662442, "mean_env_wait_ms": 0.05828818923513964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034323930740356445, "StateBufferConnector_ms": 0.0026923418045043945, "ViewRequirementAgentConnector_ms": 0.06718564033508301}, "num_episodes": 27, "episode_return_max": 165.63186899232954, "episode_return_min": -63.76245733705426, "episode_return_mean": 44.81258912004051}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 479.38080467048104, "num_env_steps_trained_throughput_per_sec": 479.38080467048104, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 1944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1944000, "timers": {"training_iteration_time_ms": 8242.415, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8242.381, "sample_time_ms": 781.538, "learn_time_ms": 7448.771, "learn_throughput": 537.001, "synch_weights_time_ms": 11.478}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000}, "done": false, "training_iteration": 162, "trial_id": "eaa30_00000", "date": "2024-08-09_18-02-38", "timestamp": 1723240958, "time_this_iter_s": 8.348323106765747, "time_total_s": 1331.5330429077148, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781ff310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1331.5330429077148, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 27.41666666666666, "ram_util_percent": 81.27500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.23213070813941, "cur_kl_coeff": 0.6935440510448643, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.142852211124683, "policy_loss": -0.0017887129711982592, "vf_loss": 4.1387580225707365, "vf_explained_var": 0.06852485102320474, "kl": 0.008482376875099604, "entropy": 0.6551860896052507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.425905049219727, "cur_kl_coeff": 0.01235753184662015, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.794382677475611, "policy_loss": 0.00065114008175442, "vf_loss": 5.793618479619424, "vf_explained_var": -0.020481664252777896, "kl": 0.009148049876239383, "entropy": 0.37351472908630967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000}, "env_runners": {"episode_reward_max": 165.63186899232954, "episode_reward_min": -63.76245733705426, "episode_reward_mean": 45.84636968955841, "episode_len_mean": 175.72, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 17572, "policy_reward_min": {"agent_policy": -31.881228668527136, "adversary_policy": -19.525761470808373}, "policy_reward_max": {"agent_policy": 82.8159344961648, "adversary_policy": 48.878270558833144}, "policy_reward_mean": {"agent_policy": 22.923184844779204, "adversary_policy": 11.461592422389604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.754221288828774, 11.795029369998495, 101.33018513238551, 96.05365200729554, 16.109751148119983, 43.5470790444614, -1.9143433104164558, 49.679719637948395, 47.30651560821215, 58.31663300686591, 16.344103506522313, -22.390597620806915, 37.72901510530286, 0.4795860104269707, 131.90589072674987, 6.1685957188469445, 108.31544101290285, 8.827602404586138, -3.936215167819518, 102.3433264799178, 38.39636430140898, -30.738320853413555, 41.01896468501843, 20.122093997171874, 115.61288293215301, 103.1462107284938, 18.466057975117813, 51.709424759265374, -38.09857311937235, 165.63186899232954, 28.304346208434616, 118.38037986243836, 24.843923793591024, 47.58092723969395, 29.032404271000296, 36.325887803896066, 59.839410109686206, 133.09977908235948, 71.3091654118131, -54.61158152321359, 52.8623761999048, 17.704954019479075, 18.977406304455265, 86.14094565581571, 30.004263971153712, 22.641622020181018, 4.360403606618792, 49.38164320699657, 99.37021810217904, 45.607623889425696, 60.81128754019308, 126.62824375443586, -63.76245733705426, 119.63265400218515, 2.0898432591150744, 24.355138534540536, -45.16008900198821, -6.217230282556947, -43.79722564618645, 10.341161303573479, 105.52279439195524, 95.64521918695091, -50.78198199262829, 71.26244524576336, 5.166180020959921, 92.3885428356673, 57.73648844536936, 88.8228146605347, 70.93604649895866, 74.75676959217637, 32.150007969061505, 33.809698397741116, 39.35782113206827, 68.176551384334, 91.41712091392083, 60.65098590505018, -2.3015794292548577, 9.97887095572666, 8.402087677309197, 9.16927064361304, -15.779265298913216, 11.626246232337333, 71.57439937463593, 138.1060877467589, 114.76885500923794, 24.655197580952503, 91.44715836574804, 26.081758927302165, 155.79413576877562, -1.0429324379091582, -13.887133476554766, 18.715965923698306, 72.1621040969273, 59.76140703602975, 124.90152908214247, 30.851137184838862, 33.430376311103515, 102.53321544770374, 81.39433428760267, 57.16664648747718], "episode_lengths": [200, 200, 200, 152, 200, 200, 200, 200, 178, 152, 200, 200, 180, 200, 170, 200, 200, 200, 5, 181, 200, 200, 200, 200, 200, 118, 200, 36, 200, 200, 200, 124, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 185, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 31, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 11, 36, 158, 56, 200, 200, 13, 99, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [19.377110644414394, 5.89751468499923, 50.66509256619277, 48.0268260036478, 8.054875574059952, 21.773539522230706, -0.9571716552082279, 24.839859818974197, 23.65325780410607, 29.15831650343294, 8.172051753261165, -11.195298810403475, 18.86450755265142, 0.23979300521346403, 65.952945363375, 3.0842978594234864, 54.157720506451426, 4.413801202293051, -1.9681075839097593, 51.17166323995891, 19.198182150704504, -15.369160426706745, 20.509482342509216, 10.061046998585937, 57.80644146607651, 51.57310536424687, 9.23302898755892, 25.854712379632687, -19.049286559686124, 82.8159344961648, 14.152173104217308, 59.19018993121918, 12.421961896795512, 23.79046361984698, 14.516202135500155, 18.162943901948026, 29.919705054843078, 66.54988954117975, 35.65458270590656, -27.305790761606772, 26.43118809995241, 8.852477009739516, 9.488703152227645, 43.07047282790785, 15.002131985576856, 11.320811010090509, 2.1802018033093873, 24.69082160349828, 49.68510905108951, 22.803811944712848, 30.40564377009651, 63.3141218772179, -31.881228668527136, 59.816327001092525, 1.0449216295575372, 12.177569267270268, -22.580044500994084, -3.1086151412784986, -21.898612823093316, 5.170580651786739, 52.76139719597767, 47.82260959347545, -25.390990996314162, 35.63122262288168, 2.5830900104799426, 46.19427141783365, 28.868244222684694, 44.41140733026734, 35.46802324947933, 37.37838479608819, 16.075003984530767, 16.904849198870558, 19.678910566034137, 34.088275692166995, 45.70856045696042, 30.32549295252509, -1.1507897146274324, 4.9894354778633305, 4.201043838654588, 4.584635321806509, -7.8896326494566225, 5.813123116168666, 35.78719968731799, 69.05304387337947, 57.384427504618955, 12.327598790476209, 45.72357918287404, 13.040879463651084, 77.89706788438784, -0.5214662189545791, -6.94356673827744, 9.357982961849153, 36.081052048463626, 29.880703518014876, 62.45076454107124, 15.425568592419431, 16.715188155551758, 51.26660772385188, 40.69716714380134, 28.583323243738594], "policy_adversary_policy_reward": [10.245009214574615, 9.132101429839778, 8.39829854058652, -2.5007838555872866, 27.827861892125668, 22.83723067406709, 29.198962997319725, 18.827863006328077, 3.8130225816542236, 4.241852992405732, -4.916867837647935, 26.69040735987864, -4.6021062828675205, 3.6449346276592927, 26.753112371726708, -1.9132525527525104, 11.075355292727544, 12.577902511378523, 19.238207930125387, 9.920108573307552, 7.155157077836121, 1.0168946754250427, -0.03494867866045581, -11.160350131742998, 4.270484534006304, 14.594023018645117, 5.654110032217854, -5.41431702700439, 22.297177451088118, 43.65576791228686, -9.44107427737541, 12.525372136798897, 23.030693446915997, 31.127027059535433, 1.708880744598769, 2.7049204576942785, 2.35421270978955, -4.32232029369931, 38.74254629631684, 12.429116943642093, 22.683899235342462, -3.485717084637958, -3.9956867830693987, -11.373473643637354, 17.60569037977116, 2.9037919627380546, -4.053390284665376, 14.114437283251313, 31.830977677005798, 25.975463789070712, 11.462642011713783, 40.1104633525331, 3.04368261624343, 6.1893463713154855, -9.77148771642705, 35.62620009605975, -0.5126659418581703, -18.53662061782792, 36.42742396112592, 46.38851053503891, 13.817152237618672, 0.3350208665986365, 10.311919372386011, 48.878270558833144, 3.1516748544731357, 9.270287042322376, 6.042439944763757, 17.748023675083225, 9.138023728381086, 5.37817840711907, 6.287850967639528, 11.875092934308498, 12.44665154977551, 17.47305350506756, 29.74283268672641, 36.80705685445332, 0.3573851487655766, 35.29719755714097, -14.97995840126232, -12.325832360344457, 13.647919321900972, 12.78326877805144, 12.537780453415625, -3.685303443676105, 3.4654598128059657, 6.023243339421679, 25.896293290049787, 17.174179537858063, 15.11387618235921, -0.11174419678235381, 4.145663809376323, 7.175147200714186, 9.908923834432674, -7.7287220311232865, 6.547125933232785, 18.143695670265494, 16.560573795490733, 33.12453525559881, 16.963690403452624, 5.840121541260224, 22.71774968832174, 7.687894081774765, 37.04718152443407, 26.266940352783834, -18.94346445189303, -12.937764216634122, 21.203985140553584, 38.61234186053895, 3.0130156944683986, -1.9680940649108614, 1.963667198281577, 10.213902068988691, -9.064647722699043, -13.515396778295042, -8.360099234124554, 5.251484092846056, -2.372851352284961, -19.525761470808373, 5.381607879389145, -0.2110272276024059, 19.742538622552118, 33.01885857342556, 22.373199589399864, 25.449410004075574, -13.46178580724078, -11.929205189073382, 7.364321656822895, 28.266900966058785, -4.636192613317011, 7.219282623796953, 17.294737186122003, 28.899534231711634, 9.824300579099411, 19.04394364358528, 19.743867067996995, 24.667540262270343, 13.421411368155514, 22.04661188132382, 17.99722758305257, 19.38115721303562, 6.026105151064154, 10.048898833466613, 2.3251712386252166, 14.579677960245341, 10.896414654778283, 8.782495911255856, 15.608219951333385, 18.48005574083361, 8.228799511439108, 37.4797609455213, 23.728712928418076, 6.596780024107019, -3.2357862761440828, 2.0849965615166504, -8.969589974851992, 13.959025452715323, 16.106529916108585, -11.905486077454, -3.5937913461256468, 8.178426667932154, -18.343919720690963, 10.45428707123434, -1.542817524386038, 7.355940640554703, 37.84239657368238, -2.0551968863643957, 34.13678955711913, 34.91625431626034, 43.96556099004695, 13.41886651457201, 12.541474367322099, -0.21387557684588288, 36.66011259240623, 9.063466590467815, -0.07966999527040386, 13.12054945892149, 30.411065671762987, 47.48600221262484, -7.352544928398231, 6.831078709443652, -14.252277530479354, 7.308710792201911, 0.15954669424862544, 9.198436267600528, 9.604450562093765, 26.476601486369866, 14.02447460778664, 15.856228910228236, 32.605090442529374, 29.845674098541863, 6.737822681635755, 8.687745910783676, -2.812141183613228, 19.527329339164986, 40.57413045095633, 10.692477272895527, 19.850303238151934, 20.846863905649403, 4.321408257052892, 24.26191498668571]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39294812904402887, "mean_inference_ms": 0.975463754720549, "mean_action_processing_ms": 0.1668987257025929, "mean_env_wait_ms": 0.05833306093143212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003562331199645996, "StateBufferConnector_ms": 0.002752065658569336, "ViewRequirementAgentConnector_ms": 0.06769120693206787}, "num_episodes": 22, "episode_return_max": 165.63186899232954, "episode_return_min": -63.76245733705426, "episode_return_mean": 45.84636968955841}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.0139745528807, "num_env_steps_trained_throughput_per_sec": 494.0139745528807, "timesteps_total": 652000, "num_env_steps_sampled_lifetime": 652000, "num_agent_steps_sampled_lifetime": 1956000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1956000, "timers": {"training_iteration_time_ms": 8238.832, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8238.798, "sample_time_ms": 784.343, "learn_time_ms": 7442.452, "learn_throughput": 537.457, "synch_weights_time_ms": 11.408}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000}, "done": false, "training_iteration": 163, "trial_id": "eaa30_00000", "date": "2024-08-09_18-02-47", "timestamp": 1723240967, "time_this_iter_s": 8.102135181427002, "time_total_s": 1339.6351780891418, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781ff3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1339.6351780891418, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 28.825, "ram_util_percent": 80.95833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.12669972313775, "cur_kl_coeff": 0.6935440510448643, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.494321208782297, "policy_loss": 0.002430115117095214, "vf_loss": 4.48812664248956, "vf_explained_var": 0.14247995328020166, "kl": 0.005427850580099162, "entropy": 0.6450959479051923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.942316077401241, "cur_kl_coeff": 0.01235753184662015, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.7118084758520125, "policy_loss": -0.00951803936768556, "vf_loss": 5.721164835989475, "vf_explained_var": -0.04081430174410343, "kl": 0.013082108322123531, "entropy": 0.5013374036177993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "env_runners": {"episode_reward_max": 165.63186899232954, "episode_reward_min": -63.76245733705426, "episode_reward_mean": 45.542293015106644, "episode_len_mean": 177.51, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 17751, "policy_reward_min": {"agent_policy": -31.881228668527136, "adversary_policy": -27.471060248157876}, "policy_reward_max": {"agent_policy": 82.8159344961648, "adversary_policy": 48.878270558833144}, "policy_reward_mean": {"agent_policy": 22.771146507553325, "adversary_policy": 11.385573253776661}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.39636430140898, -30.738320853413555, 41.01896468501843, 20.122093997171874, 115.61288293215301, 103.1462107284938, 18.466057975117813, 51.709424759265374, -38.09857311937235, 165.63186899232954, 28.304346208434616, 118.38037986243836, 24.843923793591024, 47.58092723969395, 29.032404271000296, 36.325887803896066, 59.839410109686206, 133.09977908235948, 71.3091654118131, -54.61158152321359, 52.8623761999048, 17.704954019479075, 18.977406304455265, 86.14094565581571, 30.004263971153712, 22.641622020181018, 4.360403606618792, 49.38164320699657, 99.37021810217904, 45.607623889425696, 60.81128754019308, 126.62824375443586, -63.76245733705426, 119.63265400218515, 2.0898432591150744, 24.355138534540536, -45.16008900198821, -6.217230282556947, -43.79722564618645, 10.341161303573479, 105.52279439195524, 95.64521918695091, -50.78198199262829, 71.26244524576336, 5.166180020959921, 92.3885428356673, 57.73648844536936, 88.8228146605347, 70.93604649895866, 74.75676959217637, 32.150007969061505, 33.809698397741116, 39.35782113206827, 68.176551384334, 91.41712091392083, 60.65098590505018, -2.3015794292548577, 9.97887095572666, 8.402087677309197, 9.16927064361304, -15.779265298913216, 11.626246232337333, 71.57439937463593, 138.1060877467589, 114.76885500923794, 24.655197580952503, 91.44715836574804, 26.081758927302165, 155.79413576877562, -1.0429324379091582, -13.887133476554766, 18.715965923698306, 72.1621040969273, 59.76140703602975, 124.90152908214247, 30.851137184838862, 33.430376311103515, 102.53321544770374, 81.39433428760267, 57.16664648747718, 29.858517134347586, -3.744693211403572, 45.48518358184893, 95.22049217514999, 123.73825549134347, 71.11201421033576, 92.10974688371286, -5.277076586651546, -39.67119663838468, 6.9239637139529435, 41.7218698109409, 44.27702026083239, 43.07179145169545, 139.8255343554131, -35.7686002363872, -8.727215522071184, 46.47132039352313, 100.03851207322987, -34.745850051980234, 64.43793437570484], "episode_lengths": [200, 200, 200, 200, 200, 118, 200, 36, 200, 200, 200, 124, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 185, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 31, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 11, 36, 158, 56, 200, 200, 13, 99, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 44, 153, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [19.198182150704504, -15.369160426706745, 20.509482342509216, 10.061046998585937, 57.80644146607651, 51.57310536424687, 9.23302898755892, 25.854712379632687, -19.049286559686124, 82.8159344961648, 14.152173104217308, 59.19018993121918, 12.421961896795512, 23.79046361984698, 14.516202135500155, 18.162943901948026, 29.919705054843078, 66.54988954117975, 35.65458270590656, -27.305790761606772, 26.43118809995241, 8.852477009739516, 9.488703152227645, 43.07047282790785, 15.002131985576856, 11.320811010090509, 2.1802018033093873, 24.69082160349828, 49.68510905108951, 22.803811944712848, 30.40564377009651, 63.3141218772179, -31.881228668527136, 59.816327001092525, 1.0449216295575372, 12.177569267270268, -22.580044500994084, -3.1086151412784986, -21.898612823093316, 5.170580651786739, 52.76139719597767, 47.82260959347545, -25.390990996314162, 35.63122262288168, 2.5830900104799426, 46.19427141783365, 28.868244222684694, 44.41140733026734, 35.46802324947933, 37.37838479608819, 16.075003984530767, 16.904849198870558, 19.678910566034137, 34.088275692166995, 45.70856045696042, 30.32549295252509, -1.1507897146274324, 4.9894354778633305, 4.201043838654588, 4.584635321806509, -7.8896326494566225, 5.813123116168666, 35.78719968731799, 69.05304387337947, 57.384427504618955, 12.327598790476209, 45.72357918287404, 13.040879463651084, 77.89706788438784, -0.5214662189545791, -6.94356673827744, 9.357982961849153, 36.081052048463626, 29.880703518014876, 62.45076454107124, 15.425568592419431, 16.715188155551758, 51.26660772385188, 40.69716714380134, 28.583323243738594, 14.929258567173793, -1.8723466057017646, 22.742591790924465, 47.61024608757501, 61.869127745671754, 35.556007105167886, 46.054873441856444, -2.6385382933257873, -19.83559831919237, 3.4619818569764718, 20.86093490547045, 22.138510130416204, 21.535895725847727, 69.91276717770654, -17.88430011819358, -4.363607761035592, 23.235660196761565, 50.019256036614934, -17.372925025990064, 32.218967187852414], "policy_adversary_policy_reward": [22.683899235342462, -3.485717084637958, -3.9956867830693987, -11.373473643637354, 17.60569037977116, 2.9037919627380546, -4.053390284665376, 14.114437283251313, 31.830977677005798, 25.975463789070712, 11.462642011713783, 40.1104633525331, 3.04368261624343, 6.1893463713154855, -9.77148771642705, 35.62620009605975, -0.5126659418581703, -18.53662061782792, 36.42742396112592, 46.38851053503891, 13.817152237618672, 0.3350208665986365, 10.311919372386011, 48.878270558833144, 3.1516748544731357, 9.270287042322376, 6.042439944763757, 17.748023675083225, 9.138023728381086, 5.37817840711907, 6.287850967639528, 11.875092934308498, 12.44665154977551, 17.47305350506756, 29.74283268672641, 36.80705685445332, 0.3573851487655766, 35.29719755714097, -14.97995840126232, -12.325832360344457, 13.647919321900972, 12.78326877805144, 12.537780453415625, -3.685303443676105, 3.4654598128059657, 6.023243339421679, 25.896293290049787, 17.174179537858063, 15.11387618235921, -0.11174419678235381, 4.145663809376323, 7.175147200714186, 9.908923834432674, -7.7287220311232865, 6.547125933232785, 18.143695670265494, 16.560573795490733, 33.12453525559881, 16.963690403452624, 5.840121541260224, 22.71774968832174, 7.687894081774765, 37.04718152443407, 26.266940352783834, -18.94346445189303, -12.937764216634122, 21.203985140553584, 38.61234186053895, 3.0130156944683986, -1.9680940649108614, 1.963667198281577, 10.213902068988691, -9.064647722699043, -13.515396778295042, -8.360099234124554, 5.251484092846056, -2.372851352284961, -19.525761470808373, 5.381607879389145, -0.2110272276024059, 19.742538622552118, 33.01885857342556, 22.373199589399864, 25.449410004075574, -13.46178580724078, -11.929205189073382, 7.364321656822895, 28.266900966058785, -4.636192613317011, 7.219282623796953, 17.294737186122003, 28.899534231711634, 9.824300579099411, 19.04394364358528, 19.743867067996995, 24.667540262270343, 13.421411368155514, 22.04661188132382, 17.99722758305257, 19.38115721303562, 6.026105151064154, 10.048898833466613, 2.3251712386252166, 14.579677960245341, 10.896414654778283, 8.782495911255856, 15.608219951333385, 18.48005574083361, 8.228799511439108, 37.4797609455213, 23.728712928418076, 6.596780024107019, -3.2357862761440828, 2.0849965615166504, -8.969589974851992, 13.959025452715323, 16.106529916108585, -11.905486077454, -3.5937913461256468, 8.178426667932154, -18.343919720690963, 10.45428707123434, -1.542817524386038, 7.355940640554703, 37.84239657368238, -2.0551968863643957, 34.13678955711913, 34.91625431626034, 43.96556099004695, 13.41886651457201, 12.541474367322099, -0.21387557684588288, 36.66011259240623, 9.063466590467815, -0.07966999527040386, 13.12054945892149, 30.411065671762987, 47.48600221262484, -7.352544928398231, 6.831078709443652, -14.252277530479354, 7.308710792201911, 0.15954669424862544, 9.198436267600528, 9.604450562093765, 26.476601486369866, 14.02447460778664, 15.856228910228236, 32.605090442529374, 29.845674098541863, 6.737822681635755, 8.687745910783676, -2.812141183613228, 19.527329339164986, 40.57413045095633, 10.692477272895527, 19.850303238151934, 20.846863905649403, 4.321408257052892, 24.26191498668571, -2.899818290572348, 17.829076857746138, 7.009045354541165, -8.881391960242926, 14.769913149507545, 7.972678641416918, 15.492284086345819, 32.11796200122918, 16.312220442027815, 45.55690730364393, 24.04201184184521, 11.51399526332267, 26.289607340759087, 19.76526610109736, 2.5917929086334084, -5.230331201959199, 7.635461928965505, -27.471060248157876, 11.255164943076565, -7.79318308610009, 16.12104917961999, 4.73988572585046, 1.1235647246909757, 21.01494540572523, 16.290889415839057, 5.2450063100086695, 33.98646114707396, 35.926306030632574, -15.577752497344047, -2.306547620849532, -1.2822613422078533, -3.0813464188277386, 19.208230321688475, 4.0274298750730875, 17.790844020764407, 32.22841201585055, -11.77958288948297, -5.593342136507097, 25.032384433433805, 7.186582754418605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3929396993359023, "mean_inference_ms": 0.9755707157719972, "mean_action_processing_ms": 0.1669286775002597, "mean_env_wait_ms": 0.05835594937660584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00362551212310791, "StateBufferConnector_ms": 0.0027271509170532227, "ViewRequirementAgentConnector_ms": 0.06894552707672119}, "num_episodes": 20, "episode_return_max": 165.63186899232954, "episode_return_min": -63.76245733705426, "episode_return_mean": 45.542293015106644}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.00845364314654, "num_env_steps_trained_throughput_per_sec": 485.00845364314654, "timesteps_total": 656000, "num_env_steps_sampled_lifetime": 656000, "num_agent_steps_sampled_lifetime": 1968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1968000, "timers": {"training_iteration_time_ms": 8228.526, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8228.492, "sample_time_ms": 775.926, "learn_time_ms": 7440.695, "learn_throughput": 537.584, "synch_weights_time_ms": 11.346}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "done": false, "training_iteration": 164, "trial_id": "eaa30_00000", "date": "2024-08-09_18-02-55", "timestamp": 1723240975, "time_this_iter_s": 8.251785039901733, "time_total_s": 1347.8869631290436, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781ff700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1347.8869631290436, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 27.61666666666667, "ram_util_percent": 80.89166666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.217610720099596, "cur_kl_coeff": 0.6935440510448643, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.374341714066803, "policy_loss": 0.001820465925558613, "vf_loss": 4.369342962396208, "vf_explained_var": 0.09703101266628851, "kl": 0.004582687842945455, "entropy": 0.6028214403561183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.65648382715881, "cur_kl_coeff": 0.01235753184662015, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.537778689960638, "policy_loss": 0.0031531775634600005, "vf_loss": 6.534272268911203, "vf_explained_var": -0.08934262717763583, "kl": 0.02858453905112886, "entropy": 0.44136079531162975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 157920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000}, "env_runners": {"episode_reward_max": 193.56357517265602, "episode_reward_min": -63.76245733705426, "episode_reward_mean": 41.67193743441462, "episode_len_mean": 178.5, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 17850, "policy_reward_min": {"agent_policy": -31.881228668527136, "adversary_policy": -27.471060248157876}, "policy_reward_max": {"agent_policy": 96.78178758632795, "adversary_policy": 50.92521873473069}, "policy_reward_mean": {"agent_policy": 20.835968717207308, "adversary_policy": 10.417984358603656}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.704954019479075, 18.977406304455265, 86.14094565581571, 30.004263971153712, 22.641622020181018, 4.360403606618792, 49.38164320699657, 99.37021810217904, 45.607623889425696, 60.81128754019308, 126.62824375443586, -63.76245733705426, 119.63265400218515, 2.0898432591150744, 24.355138534540536, -45.16008900198821, -6.217230282556947, -43.79722564618645, 10.341161303573479, 105.52279439195524, 95.64521918695091, -50.78198199262829, 71.26244524576336, 5.166180020959921, 92.3885428356673, 57.73648844536936, 88.8228146605347, 70.93604649895866, 74.75676959217637, 32.150007969061505, 33.809698397741116, 39.35782113206827, 68.176551384334, 91.41712091392083, 60.65098590505018, -2.3015794292548577, 9.97887095572666, 8.402087677309197, 9.16927064361304, -15.779265298913216, 11.626246232337333, 71.57439937463593, 138.1060877467589, 114.76885500923794, 24.655197580952503, 91.44715836574804, 26.081758927302165, 155.79413576877562, -1.0429324379091582, -13.887133476554766, 18.715965923698306, 72.1621040969273, 59.76140703602975, 124.90152908214247, 30.851137184838862, 33.430376311103515, 102.53321544770374, 81.39433428760267, 57.16664648747718, 29.858517134347586, -3.744693211403572, 45.48518358184893, 95.22049217514999, 123.73825549134347, 71.11201421033576, 92.10974688371286, -5.277076586651546, -39.67119663838468, 6.9239637139529435, 41.7218698109409, 44.27702026083239, 43.07179145169545, 139.8255343554131, -35.7686002363872, -8.727215522071184, 46.47132039352313, 100.03851207322987, -34.745850051980234, 64.43793437570484, -19.022824517869516, 63.59396328816092, 10.461125097764366, 57.683963387572305, 11.970198327320734, 14.568596343416697, 12.296583718785568, -13.317262969975857, -4.9751511372710695, -8.545868112908153, 17.93307903557492, 113.40256124116866, 6.414215093612977, 52.51888012796563, 36.85941064975309, 28.544571478892607, 24.179431012636698, 1.5550482644427177, 16.50897036553603, 29.005368921339077, 193.56357517265602], "episode_lengths": [200, 200, 185, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 31, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 11, 36, 158, 56, 200, 200, 13, 99, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 44, 153, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 32, 200, 200, 200, 200, 200, 200, 200, 200, 200, 159, 200, 200, 200, 200, 200, 200, 200, 200, 186], "policy_agent_policy_reward": [8.852477009739516, 9.488703152227645, 43.07047282790785, 15.002131985576856, 11.320811010090509, 2.1802018033093873, 24.69082160349828, 49.68510905108951, 22.803811944712848, 30.40564377009651, 63.3141218772179, -31.881228668527136, 59.816327001092525, 1.0449216295575372, 12.177569267270268, -22.580044500994084, -3.1086151412784986, -21.898612823093316, 5.170580651786739, 52.76139719597767, 47.82260959347545, -25.390990996314162, 35.63122262288168, 2.5830900104799426, 46.19427141783365, 28.868244222684694, 44.41140733026734, 35.46802324947933, 37.37838479608819, 16.075003984530767, 16.904849198870558, 19.678910566034137, 34.088275692166995, 45.70856045696042, 30.32549295252509, -1.1507897146274324, 4.9894354778633305, 4.201043838654588, 4.584635321806509, -7.8896326494566225, 5.813123116168666, 35.78719968731799, 69.05304387337947, 57.384427504618955, 12.327598790476209, 45.72357918287404, 13.040879463651084, 77.89706788438784, -0.5214662189545791, -6.94356673827744, 9.357982961849153, 36.081052048463626, 29.880703518014876, 62.45076454107124, 15.425568592419431, 16.715188155551758, 51.26660772385188, 40.69716714380134, 28.583323243738594, 14.929258567173793, -1.8723466057017646, 22.742591790924465, 47.61024608757501, 61.869127745671754, 35.556007105167886, 46.054873441856444, -2.6385382933257873, -19.83559831919237, 3.4619818569764718, 20.86093490547045, 22.138510130416204, 21.535895725847727, 69.91276717770654, -17.88430011819358, -4.363607761035592, 23.235660196761565, 50.019256036614934, -17.372925025990064, 32.218967187852414, -9.511412258934719, 31.796981644080457, 5.230562548882183, 28.841981693786174, 5.985099163660379, 7.284298171708318, 6.148291859392787, -6.658631484987943, -2.4875755686355348, -4.272934056454044, 8.96653951778746, 56.70128062058436, 3.2071075468065153, 26.25944006398282, 18.429705324876544, 14.272285739446303, 12.089715506318363, 0.7775241322213731, 8.254485182768008, 14.502684460669538, 96.78178758632795], "policy_adversary_policy_reward": [12.537780453415625, -3.685303443676105, 3.4654598128059657, 6.023243339421679, 25.896293290049787, 17.174179537858063, 15.11387618235921, -0.11174419678235381, 4.145663809376323, 7.175147200714186, 9.908923834432674, -7.7287220311232865, 6.547125933232785, 18.143695670265494, 16.560573795490733, 33.12453525559881, 16.963690403452624, 5.840121541260224, 22.71774968832174, 7.687894081774765, 37.04718152443407, 26.266940352783834, -18.94346445189303, -12.937764216634122, 21.203985140553584, 38.61234186053895, 3.0130156944683986, -1.9680940649108614, 1.963667198281577, 10.213902068988691, -9.064647722699043, -13.515396778295042, -8.360099234124554, 5.251484092846056, -2.372851352284961, -19.525761470808373, 5.381607879389145, -0.2110272276024059, 19.742538622552118, 33.01885857342556, 22.373199589399864, 25.449410004075574, -13.46178580724078, -11.929205189073382, 7.364321656822895, 28.266900966058785, -4.636192613317011, 7.219282623796953, 17.294737186122003, 28.899534231711634, 9.824300579099411, 19.04394364358528, 19.743867067996995, 24.667540262270343, 13.421411368155514, 22.04661188132382, 17.99722758305257, 19.38115721303562, 6.026105151064154, 10.048898833466613, 2.3251712386252166, 14.579677960245341, 10.896414654778283, 8.782495911255856, 15.608219951333385, 18.48005574083361, 8.228799511439108, 37.4797609455213, 23.728712928418076, 6.596780024107019, -3.2357862761440828, 2.0849965615166504, -8.969589974851992, 13.959025452715323, 16.106529916108585, -11.905486077454, -3.5937913461256468, 8.178426667932154, -18.343919720690963, 10.45428707123434, -1.542817524386038, 7.355940640554703, 37.84239657368238, -2.0551968863643957, 34.13678955711913, 34.91625431626034, 43.96556099004695, 13.41886651457201, 12.541474367322099, -0.21387557684588288, 36.66011259240623, 9.063466590467815, -0.07966999527040386, 13.12054945892149, 30.411065671762987, 47.48600221262484, -7.352544928398231, 6.831078709443652, -14.252277530479354, 7.308710792201911, 0.15954669424862544, 9.198436267600528, 9.604450562093765, 26.476601486369866, 14.02447460778664, 15.856228910228236, 32.605090442529374, 29.845674098541863, 6.737822681635755, 8.687745910783676, -2.812141183613228, 19.527329339164986, 40.57413045095633, 10.692477272895527, 19.850303238151934, 20.846863905649403, 4.321408257052892, 24.26191498668571, -2.899818290572348, 17.829076857746138, 7.009045354541165, -8.881391960242926, 14.769913149507545, 7.972678641416918, 15.492284086345819, 32.11796200122918, 16.312220442027815, 45.55690730364393, 24.04201184184521, 11.51399526332267, 26.289607340759087, 19.76526610109736, 2.5917929086334084, -5.230331201959199, 7.635461928965505, -27.471060248157876, 11.255164943076565, -7.79318308610009, 16.12104917961999, 4.73988572585046, 1.1235647246909757, 21.01494540572523, 16.290889415839057, 5.2450063100086695, 33.98646114707396, 35.926306030632574, -15.577752497344047, -2.306547620849532, -1.2822613422078533, -3.0813464188277386, 19.208230321688475, 4.0274298750730875, 17.790844020764407, 32.22841201585055, -11.77958288948297, -5.593342136507097, 25.032384433433805, 7.186582754418605, -16.89748252942229, 7.386070270487597, 0.9089689927364155, 30.888012651344038, -6.41286749628425, 11.643430045166433, 23.851054532542072, 4.990927161244102, 9.26327432991539, -3.2781751662550107, 9.586051131494811, -2.3017529597864907, 4.796424575120096, 1.351867284272675, -21.483480751401153, 14.824849266413203, -12.8034511257422, 10.315875557106665, -2.717502398270163, -1.5554316581838847, 11.929078460599268, -2.9625389428118076, 44.83655255597838, 11.86472806460598, 6.964744506085228, -3.757636959278713, 6.045796143953501, 20.213643920029316, -0.3879222334560808, 18.81762755833264, 15.053019086355953, -0.7807333469096456, 3.7870614551952073, 8.302654051123156, -1.8812697185133977, 2.6587938507347673, 5.207823745852917, 3.046661436915091, -6.211460401147168, 20.714144861816706, 45.856568851597295, 50.92521873473069]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.392999067005481, "mean_inference_ms": 0.9756347271054179, "mean_action_processing_ms": 0.16692587402001244, "mean_env_wait_ms": 0.05837143438692505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00353240966796875, "StateBufferConnector_ms": 0.002724289894104004, "ViewRequirementAgentConnector_ms": 0.06797969341278076}, "num_episodes": 21, "episode_return_max": 193.56357517265602, "episode_return_min": -63.76245733705426, "episode_return_mean": 41.67193743441462}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.69218829953536, "num_env_steps_trained_throughput_per_sec": 491.69218829953536, "timesteps_total": 660000, "num_env_steps_sampled_lifetime": 660000, "num_agent_steps_sampled_lifetime": 1980000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1980000, "timers": {"training_iteration_time_ms": 8218.956, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8218.919, "sample_time_ms": 781.384, "learn_time_ms": 7425.908, "learn_throughput": 538.655, "synch_weights_time_ms": 11.136}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000}, "done": false, "training_iteration": 165, "trial_id": "eaa30_00000", "date": "2024-08-09_18-03-03", "timestamp": 1723240983, "time_this_iter_s": 8.139057874679565, "time_total_s": 1356.0260210037231, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x178129e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1356.0260210037231, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 27.758333333333336, "ram_util_percent": 80.99166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.1187700725737075, "cur_kl_coeff": 0.34677202552243214, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.544973699630253, "policy_loss": -0.0018357273212156046, "vf_loss": 5.544716911467295, "vf_explained_var": 0.11504650942232243, "kl": 0.006034271735155945, "entropy": 0.589973039948751, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.668808309609691, "cur_kl_coeff": 0.01853629776993023, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.48328604499499, "policy_loss": -0.007464742581214523, "vf_loss": 7.490296802918116, "vf_explained_var": 0.004681318874160448, "kl": 0.024491815642492535, "entropy": 0.5479581796874603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 158880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000}, "env_runners": {"episode_reward_max": 193.56357517265602, "episode_reward_min": -73.77359210958323, "episode_reward_mean": 44.40846055185491, "episode_len_mean": 176.83, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 17683, "policy_reward_min": {"agent_policy": -36.886796054791574, "adversary_policy": -27.471060248157876}, "policy_reward_max": {"agent_policy": 96.78178758632795, "adversary_policy": 50.92521873473069}, "policy_reward_mean": {"agent_policy": 22.204230275927454, "adversary_policy": 11.102115137963729}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.26244524576336, 5.166180020959921, 92.3885428356673, 57.73648844536936, 88.8228146605347, 70.93604649895866, 74.75676959217637, 32.150007969061505, 33.809698397741116, 39.35782113206827, 68.176551384334, 91.41712091392083, 60.65098590505018, -2.3015794292548577, 9.97887095572666, 8.402087677309197, 9.16927064361304, -15.779265298913216, 11.626246232337333, 71.57439937463593, 138.1060877467589, 114.76885500923794, 24.655197580952503, 91.44715836574804, 26.081758927302165, 155.79413576877562, -1.0429324379091582, -13.887133476554766, 18.715965923698306, 72.1621040969273, 59.76140703602975, 124.90152908214247, 30.851137184838862, 33.430376311103515, 102.53321544770374, 81.39433428760267, 57.16664648747718, 29.858517134347586, -3.744693211403572, 45.48518358184893, 95.22049217514999, 123.73825549134347, 71.11201421033576, 92.10974688371286, -5.277076586651546, -39.67119663838468, 6.9239637139529435, 41.7218698109409, 44.27702026083239, 43.07179145169545, 139.8255343554131, -35.7686002363872, -8.727215522071184, 46.47132039352313, 100.03851207322987, -34.745850051980234, 64.43793437570484, -19.022824517869516, 63.59396328816092, 10.461125097764366, 57.683963387572305, 11.970198327320734, 14.568596343416697, 12.296583718785568, -13.317262969975857, -4.9751511372710695, -8.545868112908153, 17.93307903557492, 113.40256124116866, 6.414215093612977, 52.51888012796563, 36.85941064975309, 28.544571478892607, 24.179431012636698, 1.5550482644427177, 16.50897036553603, 29.005368921339077, 193.56357517265602, -73.77359210958323, 57.55031051818892, 65.6467858848335, 14.218052409754094, -9.6609028707798, 44.983279512302786, 98.26099005746173, 58.01621708948795, 73.69877235001135, 80.55381449743003, 83.38678548098778, 61.82481938424988, 52.426073557886454, 33.35949666643552, -48.210972175443686, 29.382613292329644, 59.276349723914365, 108.56814240712683, 33.811532539593124, 137.63571784611332, 28.470957586297885, -6.27649341572992], "episode_lengths": [31, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 11, 36, 158, 56, 200, 200, 13, 99, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 44, 153, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 32, 200, 200, 200, 200, 200, 200, 200, 200, 200, 159, 200, 200, 200, 200, 200, 200, 200, 200, 186, 200, 200, 199, 200, 106, 200, 150, 200, 200, 200, 120, 200, 200, 158, 200, 200, 200, 180, 37, 115, 200, 200], "policy_agent_policy_reward": [35.63122262288168, 2.5830900104799426, 46.19427141783365, 28.868244222684694, 44.41140733026734, 35.46802324947933, 37.37838479608819, 16.075003984530767, 16.904849198870558, 19.678910566034137, 34.088275692166995, 45.70856045696042, 30.32549295252509, -1.1507897146274324, 4.9894354778633305, 4.201043838654588, 4.584635321806509, -7.8896326494566225, 5.813123116168666, 35.78719968731799, 69.05304387337947, 57.384427504618955, 12.327598790476209, 45.72357918287404, 13.040879463651084, 77.89706788438784, -0.5214662189545791, -6.94356673827744, 9.357982961849153, 36.081052048463626, 29.880703518014876, 62.45076454107124, 15.425568592419431, 16.715188155551758, 51.26660772385188, 40.69716714380134, 28.583323243738594, 14.929258567173793, -1.8723466057017646, 22.742591790924465, 47.61024608757501, 61.869127745671754, 35.556007105167886, 46.054873441856444, -2.6385382933257873, -19.83559831919237, 3.4619818569764718, 20.86093490547045, 22.138510130416204, 21.535895725847727, 69.91276717770654, -17.88430011819358, -4.363607761035592, 23.235660196761565, 50.019256036614934, -17.372925025990064, 32.218967187852414, -9.511412258934719, 31.796981644080457, 5.230562548882183, 28.841981693786174, 5.985099163660379, 7.284298171708318, 6.148291859392787, -6.658631484987943, -2.4875755686355348, -4.272934056454044, 8.96653951778746, 56.70128062058436, 3.2071075468065153, 26.25944006398282, 18.429705324876544, 14.272285739446303, 12.089715506318363, 0.7775241322213731, 8.254485182768008, 14.502684460669538, 96.78178758632795, -36.886796054791574, 28.77515525909446, 32.82339294241675, 7.109026204877047, -4.8304514353898895, 22.491639756151354, 49.13049502873084, 29.008108544743976, 36.84938617500567, 40.27690724871502, 41.693392740493906, 30.91240969212494, 26.213036778943213, 16.679748333217766, -24.105486087721815, 14.691306646164817, 29.638174861957175, 54.28407120356341, 16.905766269796565, 68.81785892305659, 14.23547879314895, -3.1382467078649334], "policy_adversary_policy_reward": [7.364321656822895, 28.266900966058785, -4.636192613317011, 7.219282623796953, 17.294737186122003, 28.899534231711634, 9.824300579099411, 19.04394364358528, 19.743867067996995, 24.667540262270343, 13.421411368155514, 22.04661188132382, 17.99722758305257, 19.38115721303562, 6.026105151064154, 10.048898833466613, 2.3251712386252166, 14.579677960245341, 10.896414654778283, 8.782495911255856, 15.608219951333385, 18.48005574083361, 8.228799511439108, 37.4797609455213, 23.728712928418076, 6.596780024107019, -3.2357862761440828, 2.0849965615166504, -8.969589974851992, 13.959025452715323, 16.106529916108585, -11.905486077454, -3.5937913461256468, 8.178426667932154, -18.343919720690963, 10.45428707123434, -1.542817524386038, 7.355940640554703, 37.84239657368238, -2.0551968863643957, 34.13678955711913, 34.91625431626034, 43.96556099004695, 13.41886651457201, 12.541474367322099, -0.21387557684588288, 36.66011259240623, 9.063466590467815, -0.07966999527040386, 13.12054945892149, 30.411065671762987, 47.48600221262484, -7.352544928398231, 6.831078709443652, -14.252277530479354, 7.308710792201911, 0.15954669424862544, 9.198436267600528, 9.604450562093765, 26.476601486369866, 14.02447460778664, 15.856228910228236, 32.605090442529374, 29.845674098541863, 6.737822681635755, 8.687745910783676, -2.812141183613228, 19.527329339164986, 40.57413045095633, 10.692477272895527, 19.850303238151934, 20.846863905649403, 4.321408257052892, 24.26191498668571, -2.899818290572348, 17.829076857746138, 7.009045354541165, -8.881391960242926, 14.769913149507545, 7.972678641416918, 15.492284086345819, 32.11796200122918, 16.312220442027815, 45.55690730364393, 24.04201184184521, 11.51399526332267, 26.289607340759087, 19.76526610109736, 2.5917929086334084, -5.230331201959199, 7.635461928965505, -27.471060248157876, 11.255164943076565, -7.79318308610009, 16.12104917961999, 4.73988572585046, 1.1235647246909757, 21.01494540572523, 16.290889415839057, 5.2450063100086695, 33.98646114707396, 35.926306030632574, -15.577752497344047, -2.306547620849532, -1.2822613422078533, -3.0813464188277386, 19.208230321688475, 4.0274298750730875, 17.790844020764407, 32.22841201585055, -11.77958288948297, -5.593342136507097, 25.032384433433805, 7.186582754418605, -16.89748252942229, 7.386070270487597, 0.9089689927364155, 30.888012651344038, -6.41286749628425, 11.643430045166433, 23.851054532542072, 4.990927161244102, 9.26327432991539, -3.2781751662550107, 9.586051131494811, -2.3017529597864907, 4.796424575120096, 1.351867284272675, -21.483480751401153, 14.824849266413203, -12.8034511257422, 10.315875557106665, -2.717502398270163, -1.5554316581838847, 11.929078460599268, -2.9625389428118076, 44.83655255597838, 11.86472806460598, 6.964744506085228, -3.757636959278713, 6.045796143953501, 20.213643920029316, -0.3879222334560808, 18.81762755833264, 15.053019086355953, -0.7807333469096456, 3.7870614551952073, 8.302654051123156, -1.8812697185133977, 2.6587938507347673, 5.207823745852917, 3.046661436915091, -6.211460401147168, 20.714144861816706, 45.856568851597295, 50.92521873473069, -19.858077091549177, -17.02871896324241, 12.345308273343079, 16.429846985751382, 28.02196527740199, 4.801427665014765, 16.09990708467162, -8.990880879794574, -19.206097950749808, 14.375646515359925, 26.70055869973193, -4.208918943580574, 21.79773260599984, 27.332762422730994, 15.185843610339443, 13.822264934404533, -1.9806522326552987, 38.830038407660965, 8.477653838676101, 31.799253410038915, 9.240974575477445, 32.452418165016454, 19.48155710489911, 11.430852587225829, 20.645970809914573, 5.567065969028642, 13.163039945813209, 3.5167083874045595, -19.396659164497347, -4.708826923224446, -8.205773857417789, 22.897080503582607, 24.92685117317787, 4.7113236887792995, 22.14182595619576, 32.14224524736764, -5.824927077923071, 22.73069334771964, 44.99141905098753, 23.82643987206906, 22.423211339307983, -8.187732546159037, -3.465701609772246, 0.3274549019073483]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3928734361684827, "mean_inference_ms": 0.9759680017521375, "mean_action_processing_ms": 0.16689263127955836, "mean_env_wait_ms": 0.058338871953731886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034062862396240234, "StateBufferConnector_ms": 0.0027065277099609375, "ViewRequirementAgentConnector_ms": 0.06809830665588379}, "num_episodes": 22, "episode_return_max": 193.56357517265602, "episode_return_min": -73.77359210958323, "episode_return_mean": 44.40846055185491}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 479.6141318569973, "num_env_steps_trained_throughput_per_sec": 479.6141318569973, "timesteps_total": 664000, "num_env_steps_sampled_lifetime": 664000, "num_agent_steps_sampled_lifetime": 1992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1992000, "timers": {"training_iteration_time_ms": 8241.555, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8241.519, "sample_time_ms": 785.021, "learn_time_ms": 7444.532, "learn_throughput": 537.307, "synch_weights_time_ms": 11.472}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000}, "done": false, "training_iteration": 166, "trial_id": "eaa30_00000", "date": "2024-08-09_18-03-12", "timestamp": 1723240992, "time_this_iter_s": 8.344115972518921, "time_total_s": 1364.370136976242, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x178023ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1364.370136976242, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 29.333333333333332, "ram_util_percent": 81.38333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.851130306783808, "cur_kl_coeff": 0.34677202552243214, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.29579839605503, "policy_loss": -0.001777031417275784, "vf_loss": 6.296136805872438, "vf_explained_var": 0.09052915954715991, "kl": 0.004148642277152883, "entropy": 0.555387684655568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.845451862861713, "cur_kl_coeff": 0.027804446654895346, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.11160002152125, "policy_loss": 0.023359823067100174, "vf_loss": 8.087101970116297, "vf_explained_var": 0.011185726150870323, "kl": 0.04093571909567496, "entropy": 0.5905737220620115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 159840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000}, "env_runners": {"episode_reward_max": 193.56357517265602, "episode_reward_min": -73.77359210958323, "episode_reward_mean": 47.82459767655393, "episode_len_mean": 182.19, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 18219, "policy_reward_min": {"agent_policy": -36.886796054791574, "adversary_policy": -27.471060248157876}, "policy_reward_max": {"agent_policy": 96.78178758632795, "adversary_policy": 52.112586315895975}, "policy_reward_mean": {"agent_policy": 23.912298838276964, "adversary_policy": 11.956149419138482}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0429324379091582, -13.887133476554766, 18.715965923698306, 72.1621040969273, 59.76140703602975, 124.90152908214247, 30.851137184838862, 33.430376311103515, 102.53321544770374, 81.39433428760267, 57.16664648747718, 29.858517134347586, -3.744693211403572, 45.48518358184893, 95.22049217514999, 123.73825549134347, 71.11201421033576, 92.10974688371286, -5.277076586651546, -39.67119663838468, 6.9239637139529435, 41.7218698109409, 44.27702026083239, 43.07179145169545, 139.8255343554131, -35.7686002363872, -8.727215522071184, 46.47132039352313, 100.03851207322987, -34.745850051980234, 64.43793437570484, -19.022824517869516, 63.59396328816092, 10.461125097764366, 57.683963387572305, 11.970198327320734, 14.568596343416697, 12.296583718785568, -13.317262969975857, -4.9751511372710695, -8.545868112908153, 17.93307903557492, 113.40256124116866, 6.414215093612977, 52.51888012796563, 36.85941064975309, 28.544571478892607, 24.179431012636698, 1.5550482644427177, 16.50897036553603, 29.005368921339077, 193.56357517265602, -73.77359210958323, 57.55031051818892, 65.6467858848335, 14.218052409754094, -9.6609028707798, 44.983279512302786, 98.26099005746173, 58.01621708948795, 73.69877235001135, 80.55381449743003, 83.38678548098778, 61.82481938424988, 52.426073557886454, 33.35949666643552, -48.210972175443686, 29.382613292329644, 59.276349723914365, 108.56814240712683, 33.811532539593124, 137.63571784611332, 28.470957586297885, -6.27649341572992, 124.85932226648026, 31.55872612525962, 124.65390512060466, 35.489573015937495, 12.474827650177447, 61.76933179555928, 50.65897535260268, 126.75149979759584, 187.96814358572388, 24.801695177637775, 89.08477203163524, 74.24671249979076, 58.1328847827678, 10.976152963526289, 49.11680386819934, 20.44616515358274, 53.334278572924234, 63.724191150066986, 24.57338098544254, 88.07001231459628, 147.24559544238775, 8.512761878046973, 5.758192975112756, 59.5200757069905, 84.23912496026155, 153.80130385282644], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 44, 153, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 32, 200, 200, 200, 200, 200, 200, 200, 200, 200, 159, 200, 200, 200, 200, 200, 200, 200, 200, 186, 200, 200, 199, 200, 106, 200, 150, 200, 200, 200, 120, 200, 200, 158, 200, 200, 200, 180, 37, 115, 200, 200, 200, 121, 200, 200, 79, 199, 183, 200, 107, 23, 200, 168, 85, 200, 200, 200, 200, 200, 200, 200, 200, 200, 177, 200, 200, 38], "policy_agent_policy_reward": [-0.5214662189545791, -6.94356673827744, 9.357982961849153, 36.081052048463626, 29.880703518014876, 62.45076454107124, 15.425568592419431, 16.715188155551758, 51.26660772385188, 40.69716714380134, 28.583323243738594, 14.929258567173793, -1.8723466057017646, 22.742591790924465, 47.61024608757501, 61.869127745671754, 35.556007105167886, 46.054873441856444, -2.6385382933257873, -19.83559831919237, 3.4619818569764718, 20.86093490547045, 22.138510130416204, 21.535895725847727, 69.91276717770654, -17.88430011819358, -4.363607761035592, 23.235660196761565, 50.019256036614934, -17.372925025990064, 32.218967187852414, -9.511412258934719, 31.796981644080457, 5.230562548882183, 28.841981693786174, 5.985099163660379, 7.284298171708318, 6.148291859392787, -6.658631484987943, -2.4875755686355348, -4.272934056454044, 8.96653951778746, 56.70128062058436, 3.2071075468065153, 26.25944006398282, 18.429705324876544, 14.272285739446303, 12.089715506318363, 0.7775241322213731, 8.254485182768008, 14.502684460669538, 96.78178758632795, -36.886796054791574, 28.77515525909446, 32.82339294241675, 7.109026204877047, -4.8304514353898895, 22.491639756151354, 49.13049502873084, 29.008108544743976, 36.84938617500567, 40.27690724871502, 41.693392740493906, 30.91240969212494, 26.213036778943213, 16.679748333217766, -24.105486087721815, 14.691306646164817, 29.638174861957175, 54.28407120356341, 16.905766269796565, 68.81785892305659, 14.23547879314895, -3.1382467078649334, 62.42966113324013, 15.779363062629807, 62.326952560302374, 17.744786507968765, 6.237413825088719, 30.884665897779648, 25.32948767630136, 63.375749898797885, 93.98407179286198, 12.400847588818888, 44.54238601581762, 37.12335624989539, 29.0664423913839, 5.488076481763123, 24.558401934099674, 10.223082576791342, 26.667139286462117, 31.862095575033514, 12.286690492721277, 44.03500615729816, 73.62279772119386, 4.2563809390234795, 2.8790964875563754, 29.76003785349524, 42.11956248013078, 76.90065192641322], "policy_adversary_policy_reward": [-7.352544928398231, 6.831078709443652, -14.252277530479354, 7.308710792201911, 0.15954669424862544, 9.198436267600528, 9.604450562093765, 26.476601486369866, 14.02447460778664, 15.856228910228236, 32.605090442529374, 29.845674098541863, 6.737822681635755, 8.687745910783676, -2.812141183613228, 19.527329339164986, 40.57413045095633, 10.692477272895527, 19.850303238151934, 20.846863905649403, 4.321408257052892, 24.26191498668571, -2.899818290572348, 17.829076857746138, 7.009045354541165, -8.881391960242926, 14.769913149507545, 7.972678641416918, 15.492284086345819, 32.11796200122918, 16.312220442027815, 45.55690730364393, 24.04201184184521, 11.51399526332267, 26.289607340759087, 19.76526610109736, 2.5917929086334084, -5.230331201959199, 7.635461928965505, -27.471060248157876, 11.255164943076565, -7.79318308610009, 16.12104917961999, 4.73988572585046, 1.1235647246909757, 21.01494540572523, 16.290889415839057, 5.2450063100086695, 33.98646114707396, 35.926306030632574, -15.577752497344047, -2.306547620849532, -1.2822613422078533, -3.0813464188277386, 19.208230321688475, 4.0274298750730875, 17.790844020764407, 32.22841201585055, -11.77958288948297, -5.593342136507097, 25.032384433433805, 7.186582754418605, -16.89748252942229, 7.386070270487597, 0.9089689927364155, 30.888012651344038, -6.41286749628425, 11.643430045166433, 23.851054532542072, 4.990927161244102, 9.26327432991539, -3.2781751662550107, 9.586051131494811, -2.3017529597864907, 4.796424575120096, 1.351867284272675, -21.483480751401153, 14.824849266413203, -12.8034511257422, 10.315875557106665, -2.717502398270163, -1.5554316581838847, 11.929078460599268, -2.9625389428118076, 44.83655255597838, 11.86472806460598, 6.964744506085228, -3.757636959278713, 6.045796143953501, 20.213643920029316, -0.3879222334560808, 18.81762755833264, 15.053019086355953, -0.7807333469096456, 3.7870614551952073, 8.302654051123156, -1.8812697185133977, 2.6587938507347673, 5.207823745852917, 3.046661436915091, -6.211460401147168, 20.714144861816706, 45.856568851597295, 50.92521873473069, -19.858077091549177, -17.02871896324241, 12.345308273343079, 16.429846985751382, 28.02196527740199, 4.801427665014765, 16.09990708467162, -8.990880879794574, -19.206097950749808, 14.375646515359925, 26.70055869973193, -4.208918943580574, 21.79773260599984, 27.332762422730994, 15.185843610339443, 13.822264934404533, -1.9806522326552987, 38.830038407660965, 8.477653838676101, 31.799253410038915, 9.240974575477445, 32.452418165016454, 19.48155710489911, 11.430852587225829, 20.645970809914573, 5.567065969028642, 13.163039945813209, 3.5167083874045595, -19.396659164497347, -4.708826923224446, -8.205773857417789, 22.897080503582607, 24.92685117317787, 4.7113236887792995, 22.14182595619576, 32.14224524736764, -5.824927077923071, 22.73069334771964, 44.99141905098753, 23.82643987206906, 22.423211339307983, -8.187732546159037, -3.465701609772246, 0.3274549019073483, 36.657076648471985, 25.77258448476816, 3.3194836103711935, 12.459879452258612, 35.92222500752965, 26.40472755277271, 6.279851979869335, 11.464934528099427, -21.42762102797593, 27.66503485306465, 28.01071868352914, 2.8739472142504994, 15.1556349191486, 10.173852757152757, 36.57470502901095, 26.801044869786935, 52.112586315895975, 41.871485476965994, 9.001844152712906, 3.399003436105982, 27.016724019018763, 17.525661996798867, 7.682323563223314, 29.441032686672074, 18.361881103654426, 10.704561287729476, 11.428228161408054, -5.940151679644931, 13.002778423359214, 11.55562351074046, 19.31952619139283, -9.096443614601476, 22.739891257297696, 3.927248029164417, 16.11707261405889, 15.745022960974623, 26.50535891190482, -14.218668419183558, 32.12095914198807, 11.91404701531009, 39.93480758140424, 33.687990139789626, 29.8774703847561, -25.621089445732622, 1.3104866580389825, 1.5686098295173823, 12.166689863910456, 17.593347989584785, 22.048893637942797, 20.070668842187985, 39.25721884803337, 37.64343307837982]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3927945457306032, "mean_inference_ms": 0.9763637760903867, "mean_action_processing_ms": 0.16687815667263886, "mean_env_wait_ms": 0.05835602895166864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003265380859375, "StateBufferConnector_ms": 0.0024911165237426758, "ViewRequirementAgentConnector_ms": 0.06773221492767334}, "num_episodes": 26, "episode_return_max": 193.56357517265602, "episode_return_min": -73.77359210958323, "episode_return_mean": 47.82459767655393}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.4417208307233, "num_env_steps_trained_throughput_per_sec": 494.4417208307233, "timesteps_total": 668000, "num_env_steps_sampled_lifetime": 668000, "num_agent_steps_sampled_lifetime": 2004000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2004000, "timers": {"training_iteration_time_ms": 8208.628, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8208.587, "sample_time_ms": 781.496, "learn_time_ms": 7414.472, "learn_throughput": 539.485, "synch_weights_time_ms": 12.115}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000}, "done": false, "training_iteration": 167, "trial_id": "eaa30_00000", "date": "2024-08-09_18-03-20", "timestamp": 1723241000, "time_this_iter_s": 8.096235036849976, "time_total_s": 1372.466372013092, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781ffdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1372.466372013092, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 28.25833333333333, "ram_util_percent": 82.425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.79280823179023, "cur_kl_coeff": 0.17338601276121607, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.940929977477543, "policy_loss": -0.005722051307007118, "vf_loss": 5.944081406618552, "vf_explained_var": 0.02988943299919209, "kl": 0.014826001611257356, "entropy": 0.5914583914494388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.716076845054825, "cur_kl_coeff": 0.041706669982343035, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.77802858899037, "policy_loss": 0.0367875496672544, "vf_loss": 7.737180665632089, "vf_explained_var": -0.03812377291421096, "kl": 0.0973550854367204, "entropy": 0.6665287445609768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "env_runners": {"episode_reward_max": 193.56357517265602, "episode_reward_min": -73.77359210958323, "episode_reward_mean": 50.571688424794914, "episode_len_mean": 172.16, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 17216, "policy_reward_min": {"agent_policy": -36.886796054791574, "adversary_policy": -25.621089445732622}, "policy_reward_max": {"agent_policy": 96.78178758632795, "adversary_policy": 52.112586315895975}, "policy_reward_mean": {"agent_policy": 25.28584421239746, "adversary_policy": 12.64292210619873}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.727215522071184, 46.47132039352313, 100.03851207322987, -34.745850051980234, 64.43793437570484, -19.022824517869516, 63.59396328816092, 10.461125097764366, 57.683963387572305, 11.970198327320734, 14.568596343416697, 12.296583718785568, -13.317262969975857, -4.9751511372710695, -8.545868112908153, 17.93307903557492, 113.40256124116866, 6.414215093612977, 52.51888012796563, 36.85941064975309, 28.544571478892607, 24.179431012636698, 1.5550482644427177, 16.50897036553603, 29.005368921339077, 193.56357517265602, -73.77359210958323, 57.55031051818892, 65.6467858848335, 14.218052409754094, -9.6609028707798, 44.983279512302786, 98.26099005746173, 58.01621708948795, 73.69877235001135, 80.55381449743003, 83.38678548098778, 61.82481938424988, 52.426073557886454, 33.35949666643552, -48.210972175443686, 29.382613292329644, 59.276349723914365, 108.56814240712683, 33.811532539593124, 137.63571784611332, 28.470957586297885, -6.27649341572992, 124.85932226648026, 31.55872612525962, 124.65390512060466, 35.489573015937495, 12.474827650177447, 61.76933179555928, 50.65897535260268, 126.75149979759584, 187.96814358572388, 24.801695177637775, 89.08477203163524, 74.24671249979076, 58.1328847827678, 10.976152963526289, 49.11680386819934, 20.44616515358274, 53.334278572924234, 63.724191150066986, 24.57338098544254, 88.07001231459628, 147.24559544238775, 8.512761878046973, 5.758192975112756, 59.5200757069905, 84.23912496026155, 153.80130385282644, 105.47326790791178, 24.127467076919245, 156.22252193830076, 16.006564203877396, 123.34262544938797, 26.973906796641103, 41.3037508710257, 59.485570791104976, 85.45536222051285, 52.076034586546534, 48.19966966569791, 47.31405492721932, 73.16052962234642, 146.79873629900058, 51.2958419880311, -16.63917866932136, 39.513961741569204, 36.91179381489367, 70.2695430634393, 41.448930827065034, -2.7402439936430483, 63.50214515778934, 91.01614090449269, 50.792946229960286, 43.56989678382516, 14.696706959310884], "episode_lengths": [200, 200, 200, 200, 200, 200, 32, 200, 200, 200, 200, 200, 200, 200, 200, 200, 159, 200, 200, 200, 200, 200, 200, 200, 200, 186, 200, 200, 199, 200, 106, 200, 150, 200, 200, 200, 120, 200, 200, 158, 200, 200, 200, 180, 37, 115, 200, 200, 200, 121, 200, 200, 79, 199, 183, 200, 107, 23, 200, 168, 85, 200, 200, 200, 200, 200, 200, 200, 200, 200, 177, 200, 200, 38, 200, 200, 180, 78, 200, 200, 149, 95, 200, 199, 181, 200, 102, 43, 148, 200, 200, 25, 33, 200, 200, 36, 152, 200, 185, 188], "policy_agent_policy_reward": [-4.363607761035592, 23.235660196761565, 50.019256036614934, -17.372925025990064, 32.218967187852414, -9.511412258934719, 31.796981644080457, 5.230562548882183, 28.841981693786174, 5.985099163660379, 7.284298171708318, 6.148291859392787, -6.658631484987943, -2.4875755686355348, -4.272934056454044, 8.96653951778746, 56.70128062058436, 3.2071075468065153, 26.25944006398282, 18.429705324876544, 14.272285739446303, 12.089715506318363, 0.7775241322213731, 8.254485182768008, 14.502684460669538, 96.78178758632795, -36.886796054791574, 28.77515525909446, 32.82339294241675, 7.109026204877047, -4.8304514353898895, 22.491639756151354, 49.13049502873084, 29.008108544743976, 36.84938617500567, 40.27690724871502, 41.693392740493906, 30.91240969212494, 26.213036778943213, 16.679748333217766, -24.105486087721815, 14.691306646164817, 29.638174861957175, 54.28407120356341, 16.905766269796565, 68.81785892305659, 14.23547879314895, -3.1382467078649334, 62.42966113324013, 15.779363062629807, 62.326952560302374, 17.744786507968765, 6.237413825088719, 30.884665897779648, 25.32948767630136, 63.375749898797885, 93.98407179286198, 12.400847588818888, 44.54238601581762, 37.12335624989539, 29.0664423913839, 5.488076481763123, 24.558401934099674, 10.223082576791342, 26.667139286462117, 31.862095575033514, 12.286690492721277, 44.03500615729816, 73.62279772119386, 4.2563809390234795, 2.8790964875563754, 29.76003785349524, 42.11956248013078, 76.90065192641322, 52.73663395395589, 12.06373353845963, 78.11126096915042, 8.003282101938698, 61.67131272469398, 13.486953398320548, 20.651875435512853, 29.742785395552485, 42.727681110256434, 26.038017293273242, 24.099834832848945, 23.657027463609644, 36.580264811173194, 73.39936814950028, 25.647920994015553, -8.319589334660805, 19.7569808707846, 18.45589690744683, 35.13477153171964, 20.724465413532492, -1.370121996821556, 31.751072578894682, 45.50807045224634, 25.396473114980143, 21.784948391912586, 7.3483534796554455], "policy_adversary_policy_reward": [-1.2822613422078533, -3.0813464188277386, 19.208230321688475, 4.0274298750730875, 17.790844020764407, 32.22841201585055, -11.77958288948297, -5.593342136507097, 25.032384433433805, 7.186582754418605, -16.89748252942229, 7.386070270487597, 0.9089689927364155, 30.888012651344038, -6.41286749628425, 11.643430045166433, 23.851054532542072, 4.990927161244102, 9.26327432991539, -3.2781751662550107, 9.586051131494811, -2.3017529597864907, 4.796424575120096, 1.351867284272675, -21.483480751401153, 14.824849266413203, -12.8034511257422, 10.315875557106665, -2.717502398270163, -1.5554316581838847, 11.929078460599268, -2.9625389428118076, 44.83655255597838, 11.86472806460598, 6.964744506085228, -3.757636959278713, 6.045796143953501, 20.213643920029316, -0.3879222334560808, 18.81762755833264, 15.053019086355953, -0.7807333469096456, 3.7870614551952073, 8.302654051123156, -1.8812697185133977, 2.6587938507347673, 5.207823745852917, 3.046661436915091, -6.211460401147168, 20.714144861816706, 45.856568851597295, 50.92521873473069, -19.858077091549177, -17.02871896324241, 12.345308273343079, 16.429846985751382, 28.02196527740199, 4.801427665014765, 16.09990708467162, -8.990880879794574, -19.206097950749808, 14.375646515359925, 26.70055869973193, -4.208918943580574, 21.79773260599984, 27.332762422730994, 15.185843610339443, 13.822264934404533, -1.9806522326552987, 38.830038407660965, 8.477653838676101, 31.799253410038915, 9.240974575477445, 32.452418165016454, 19.48155710489911, 11.430852587225829, 20.645970809914573, 5.567065969028642, 13.163039945813209, 3.5167083874045595, -19.396659164497347, -4.708826923224446, -8.205773857417789, 22.897080503582607, 24.92685117317787, 4.7113236887792995, 22.14182595619576, 32.14224524736764, -5.824927077923071, 22.73069334771964, 44.99141905098753, 23.82643987206906, 22.423211339307983, -8.187732546159037, -3.465701609772246, 0.3274549019073483, 36.657076648471985, 25.77258448476816, 3.3194836103711935, 12.459879452258612, 35.92222500752965, 26.40472755277271, 6.279851979869335, 11.464934528099427, -21.42762102797593, 27.66503485306465, 28.01071868352914, 2.8739472142504994, 15.1556349191486, 10.173852757152757, 36.57470502901095, 26.801044869786935, 52.112586315895975, 41.871485476965994, 9.001844152712906, 3.399003436105982, 27.016724019018763, 17.525661996798867, 7.682323563223314, 29.441032686672074, 18.361881103654426, 10.704561287729476, 11.428228161408054, -5.940151679644931, 13.002778423359214, 11.55562351074046, 19.31952619139283, -9.096443614601476, 22.739891257297696, 3.927248029164417, 16.11707261405889, 15.745022960974623, 26.50535891190482, -14.218668419183558, 32.12095914198807, 11.91404701531009, 39.93480758140424, 33.687990139789626, 29.8774703847561, -25.621089445732622, 1.3104866580389825, 1.5686098295173823, 12.166689863910456, 17.593347989584785, 22.048893637942797, 20.070668842187985, 39.25721884803337, 37.64343307837982, 27.339160609104148, 25.39747334485174, -0.5905602434707262, 12.654293781930356, 42.32323149734543, 35.788029471805004, -23.206130863721942, 31.20941296566064, 34.031115003826926, 27.640197720867057, 0.7828823284698139, 12.704071069850734, 11.36749404886855, 9.284381386644306, 15.63881896364778, 14.103966431904713, 24.349021355670004, 18.378659754586426, 23.209327460213864, 2.828689833059384, 6.085871591655691, 18.013963241193252, 10.003914474110296, 13.653112989499343, 30.605832936397384, 5.974431874775801, 38.62984642647697, 34.7695217230233, -2.929344910495537, 28.577265904511087, -6.412549560304289, -1.907039774356452, -5.139968225491401, 24.896949096276007, 2.2751224466143753, 16.180774460832456, 29.63397785886604, 5.500793672853607, 8.19044739508077, 12.534018018451725, 5.94152060543535, -7.311642602256896, -3.396001413295213, 35.1470739921899, 19.96718123168298, 25.540889220563372, 17.41400213722495, 7.982470977755192, 20.732722200747787, 1.052226191164788, 11.294569587855172, -3.94621610819973]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39276397907128296, "mean_inference_ms": 0.9760284134204469, "mean_action_processing_ms": 0.16698790687019557, "mean_env_wait_ms": 0.05833500060062066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003260374069213867, "StateBufferConnector_ms": 0.0024585723876953125, "ViewRequirementAgentConnector_ms": 0.06531357765197754}, "num_episodes": 26, "episode_return_max": 193.56357517265602, "episode_return_min": -73.77359210958323, "episode_return_mean": 50.571688424794914}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.37723763258225, "num_env_steps_trained_throughput_per_sec": 503.37723763258225, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 2016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2016000, "timers": {"training_iteration_time_ms": 8189.257, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8189.214, "sample_time_ms": 780.329, "learn_time_ms": 7396.37, "learn_throughput": 540.806, "synch_weights_time_ms": 12.031}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "done": false, "training_iteration": 168, "trial_id": "eaa30_00000", "date": "2024-08-09_18-03-28", "timestamp": 1723241008, "time_this_iter_s": 7.9504430294036865, "time_total_s": 1380.4168150424957, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781ec430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1380.4168150424957, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 24.827272727272728, "ram_util_percent": 82.0909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.779421103568303, "cur_kl_coeff": 0.17338601276121607, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.0209539547168385, "policy_loss": 0.0022198179873475243, "vf_loss": 6.016008074069149, "vf_explained_var": 0.1884776402402807, "kl": 0.015722547261606133, "entropy": 0.5544128604509212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.531005291019877, "cur_kl_coeff": 0.06256000497351454, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.631151038904985, "policy_loss": 0.02224739698091677, "vf_loss": 7.604279311498006, "vf_explained_var": 0.06426886493961016, "kl": 0.07391815309723218, "entropy": 0.7897853789851069, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 161760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000}, "env_runners": {"episode_reward_max": 187.96814358572388, "episode_reward_min": -48.210972175443686, "episode_reward_mean": 59.952066686600865, "episode_len_mean": 157.23, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 15723, "policy_reward_min": {"agent_policy": -24.105486087721815, "adversary_policy": -25.621089445732622}, "policy_reward_max": {"agent_policy": 93.98407179286198, "adversary_policy": 52.112586315895975}, "policy_reward_mean": {"agent_policy": 29.976033343300433, "adversary_policy": 14.988016671650216}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.6467858848335, 14.218052409754094, -9.6609028707798, 44.983279512302786, 98.26099005746173, 58.01621708948795, 73.69877235001135, 80.55381449743003, 83.38678548098778, 61.82481938424988, 52.426073557886454, 33.35949666643552, -48.210972175443686, 29.382613292329644, 59.276349723914365, 108.56814240712683, 33.811532539593124, 137.63571784611332, 28.470957586297885, -6.27649341572992, 124.85932226648026, 31.55872612525962, 124.65390512060466, 35.489573015937495, 12.474827650177447, 61.76933179555928, 50.65897535260268, 126.75149979759584, 187.96814358572388, 24.801695177637775, 89.08477203163524, 74.24671249979076, 58.1328847827678, 10.976152963526289, 49.11680386819934, 20.44616515358274, 53.334278572924234, 63.724191150066986, 24.57338098544254, 88.07001231459628, 147.24559544238775, 8.512761878046973, 5.758192975112756, 59.5200757069905, 84.23912496026155, 153.80130385282644, 105.47326790791178, 24.127467076919245, 156.22252193830076, 16.006564203877396, 123.34262544938797, 26.973906796641103, 41.3037508710257, 59.485570791104976, 85.45536222051285, 52.076034586546534, 48.19966966569791, 47.31405492721932, 73.16052962234642, 146.79873629900058, 51.2958419880311, -16.63917866932136, 39.513961741569204, 36.91179381489367, 70.2695430634393, 41.448930827065034, -2.7402439936430483, 63.50214515778934, 91.01614090449269, 50.792946229960286, 43.56989678382516, 14.696706959310884, 55.04200301548312, 23.829944343105566, 65.5710104733076, 33.643443933570666, 128.78966044014172, 53.999599674401885, 19.06734848666251, 16.910344822470897, 110.68924625860286, 31.145338705876185, 71.86821956709217, 39.14320297852056, 93.04448056474126, 86.42068354310976, 89.69579802729777, 52.98918847869345, 120.87429502370324, 22.701210885962595, 96.6658227618898, 14.839041216446962, 47.02112431293638, -32.95750425129772, 101.11691070070873, 141.5031967584062, 13.050220920330574, 125.90139163403217, 27.859844672599746, 84.06261269738569], "episode_lengths": [199, 200, 106, 200, 150, 200, 200, 200, 120, 200, 200, 158, 200, 200, 200, 180, 37, 115, 200, 200, 200, 121, 200, 200, 79, 199, 183, 200, 107, 23, 200, 168, 85, 200, 200, 200, 200, 200, 200, 200, 200, 200, 177, 200, 200, 38, 200, 200, 180, 78, 200, 200, 149, 95, 200, 199, 181, 200, 102, 43, 148, 200, 200, 25, 33, 200, 200, 36, 152, 200, 185, 188, 154, 70, 38, 200, 46, 20, 200, 142, 40, 82, 200, 137, 198, 200, 200, 48, 200, 200, 200, 109, 155, 200, 200, 149, 200, 174, 45, 77], "policy_agent_policy_reward": [32.82339294241675, 7.109026204877047, -4.8304514353898895, 22.491639756151354, 49.13049502873084, 29.008108544743976, 36.84938617500567, 40.27690724871502, 41.693392740493906, 30.91240969212494, 26.213036778943213, 16.679748333217766, -24.105486087721815, 14.691306646164817, 29.638174861957175, 54.28407120356341, 16.905766269796565, 68.81785892305659, 14.23547879314895, -3.1382467078649334, 62.42966113324013, 15.779363062629807, 62.326952560302374, 17.744786507968765, 6.237413825088719, 30.884665897779648, 25.32948767630136, 63.375749898797885, 93.98407179286198, 12.400847588818888, 44.54238601581762, 37.12335624989539, 29.0664423913839, 5.488076481763123, 24.558401934099674, 10.223082576791342, 26.667139286462117, 31.862095575033514, 12.286690492721277, 44.03500615729816, 73.62279772119386, 4.2563809390234795, 2.8790964875563754, 29.76003785349524, 42.11956248013078, 76.90065192641322, 52.73663395395589, 12.06373353845963, 78.11126096915042, 8.003282101938698, 61.67131272469398, 13.486953398320548, 20.651875435512853, 29.742785395552485, 42.727681110256434, 26.038017293273242, 24.099834832848945, 23.657027463609644, 36.580264811173194, 73.39936814950028, 25.647920994015553, -8.319589334660805, 19.7569808707846, 18.45589690744683, 35.13477153171964, 20.724465413532492, -1.370121996821556, 31.751072578894682, 45.50807045224634, 25.396473114980143, 21.784948391912586, 7.3483534796554455, 27.521001507741552, 11.914972171552783, 32.7855052366538, 16.82172196678528, 64.39483022007089, 26.999799837200943, 9.533674243331262, 8.45517241123546, 55.34462312930141, 15.572669352938092, 35.93410978354609, 19.571601489260274, 46.52224028237062, 43.21034177155488, 44.84789901364887, 26.494594239346718, 60.437147511851606, 11.350605442981312, 48.332911380944886, 7.419520608223516, 23.51056215646818, -16.478752125648832, 50.558455350354365, 70.75159837920313, 6.525110460165266, 62.950695817016076, 13.929922336299871, 42.03130634869284], "policy_adversary_policy_reward": [28.02196527740199, 4.801427665014765, 16.09990708467162, -8.990880879794574, -19.206097950749808, 14.375646515359925, 26.70055869973193, -4.208918943580574, 21.79773260599984, 27.332762422730994, 15.185843610339443, 13.822264934404533, -1.9806522326552987, 38.830038407660965, 8.477653838676101, 31.799253410038915, 9.240974575477445, 32.452418165016454, 19.48155710489911, 11.430852587225829, 20.645970809914573, 5.567065969028642, 13.163039945813209, 3.5167083874045595, -19.396659164497347, -4.708826923224446, -8.205773857417789, 22.897080503582607, 24.92685117317787, 4.7113236887792995, 22.14182595619576, 32.14224524736764, -5.824927077923071, 22.73069334771964, 44.99141905098753, 23.82643987206906, 22.423211339307983, -8.187732546159037, -3.465701609772246, 0.3274549019073483, 36.657076648471985, 25.77258448476816, 3.3194836103711935, 12.459879452258612, 35.92222500752965, 26.40472755277271, 6.279851979869335, 11.464934528099427, -21.42762102797593, 27.66503485306465, 28.01071868352914, 2.8739472142504994, 15.1556349191486, 10.173852757152757, 36.57470502901095, 26.801044869786935, 52.112586315895975, 41.871485476965994, 9.001844152712906, 3.399003436105982, 27.016724019018763, 17.525661996798867, 7.682323563223314, 29.441032686672074, 18.361881103654426, 10.704561287729476, 11.428228161408054, -5.940151679644931, 13.002778423359214, 11.55562351074046, 19.31952619139283, -9.096443614601476, 22.739891257297696, 3.927248029164417, 16.11707261405889, 15.745022960974623, 26.50535891190482, -14.218668419183558, 32.12095914198807, 11.91404701531009, 39.93480758140424, 33.687990139789626, 29.8774703847561, -25.621089445732622, 1.3104866580389825, 1.5686098295173823, 12.166689863910456, 17.593347989584785, 22.048893637942797, 20.070668842187985, 39.25721884803337, 37.64343307837982, 27.339160609104148, 25.39747334485174, -0.5905602434707262, 12.654293781930356, 42.32323149734543, 35.788029471805004, -23.206130863721942, 31.20941296566064, 34.031115003826926, 27.640197720867057, 0.7828823284698139, 12.704071069850734, 11.36749404886855, 9.284381386644306, 15.63881896364778, 14.103966431904713, 24.349021355670004, 18.378659754586426, 23.209327460213864, 2.828689833059384, 6.085871591655691, 18.013963241193252, 10.003914474110296, 13.653112989499343, 30.605832936397384, 5.974431874775801, 38.62984642647697, 34.7695217230233, -2.929344910495537, 28.577265904511087, -6.412549560304289, -1.907039774356452, -5.139968225491401, 24.896949096276007, 2.2751224466143753, 16.180774460832456, 29.63397785886604, 5.500793672853607, 8.19044739508077, 12.534018018451725, 5.94152060543535, -7.311642602256896, -3.396001413295213, 35.1470739921899, 19.96718123168298, 25.540889220563372, 17.41400213722495, 7.982470977755192, 20.732722200747787, 1.052226191164788, 11.294569587855172, -3.94621610819973, 5.977257280246066, 21.543744227495484, 3.100674188082168, 8.814297983470613, -7.80209183938663, 40.587597076040424, 17.720281669282574, -0.8985597024972947, 17.377238346223738, 47.017591873847145, 7.23764913427701, 19.762150702923936, 1.5043570405349094, 8.02931720279635, -11.06711004407121, 19.52228245530667, 15.52249729224732, 39.822125837054095, -5.984996635074928, 21.55766598801302, 30.736849028087242, 5.197260755458861, 38.58353486815915, -19.011933378898874, 25.132851393575177, 21.38938888879546, 12.848092444568454, 30.362249326986426, 23.162583973873875, 21.685315039775002, -0.549732627177212, 27.04432686652394, 31.968709524640044, 28.46843798721156, 4.152469218423807, 7.198136224557501, 36.82902773094935, 11.503883649995519, 2.87139670109622, 4.548123907127294, 14.319330512661239, 9.191231643806944, -20.323760279547507, 3.845008153898643, 21.84987168886135, 28.708583661493016, 30.695744874683797, 40.05585350451935, -10.10124306305303, 16.626353523218295, 21.927841891329866, 41.022853925686206, -9.513548127421974, 23.443470463721845, 35.79967437494055, 6.2316319737522665]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3928813480588613, "mean_inference_ms": 0.9755448333342507, "mean_action_processing_ms": 0.16698781099061263, "mean_env_wait_ms": 0.05839176985873551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003253340721130371, "StateBufferConnector_ms": 0.0023576021194458008, "ViewRequirementAgentConnector_ms": 0.0649946928024292}, "num_episodes": 28, "episode_return_max": 187.96814358572388, "episode_return_min": -48.210972175443686, "episode_return_mean": 59.952066686600865}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 507.9747558235814, "num_env_steps_trained_throughput_per_sec": 507.9747558235814, "timesteps_total": 676000, "num_env_steps_sampled_lifetime": 676000, "num_agent_steps_sampled_lifetime": 2028000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2028000, "timers": {"training_iteration_time_ms": 8155.579, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8155.536, "sample_time_ms": 779.805, "learn_time_ms": 7363.412, "learn_throughput": 543.226, "synch_weights_time_ms": 11.878}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000}, "done": false, "training_iteration": 169, "trial_id": "eaa30_00000", "date": "2024-08-09_18-03-36", "timestamp": 1723241016, "time_this_iter_s": 7.8790740966796875, "time_total_s": 1388.2958891391754, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781ec4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1388.2958891391754, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 23.858333333333334, "ram_util_percent": 81.88333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.881499055075267, "cur_kl_coeff": 0.17338601276121607, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.203280656930631, "policy_loss": 0.001348811966273441, "vf_loss": 5.199521553579461, "vf_explained_var": 0.11217501280169008, "kl": 0.013901283167223766, "entropy": 0.43046422946074653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.251788878192503, "cur_kl_coeff": 0.09384000746027181, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.9417025849223135, "policy_loss": 0.05401274284158717, "vf_loss": 6.874403098225594, "vf_explained_var": 0.04833496734499931, "kl": 0.14158945409193013, "entropy": 0.9536806733657917, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 162720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "env_runners": {"episode_reward_max": 187.96814358572388, "episode_reward_min": -32.95750425129772, "episode_reward_mean": 59.17227104612787, "episode_len_mean": 151.51, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 15151, "policy_reward_min": {"agent_policy": -16.478752125648832, "adversary_policy": -25.621089445732622}, "policy_reward_max": {"agent_policy": 93.98407179286198, "adversary_policy": 55.942043793322306}, "policy_reward_mean": {"agent_policy": 29.586135523063934, "adversary_policy": 14.793067761531967}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.65897535260268, 126.75149979759584, 187.96814358572388, 24.801695177637775, 89.08477203163524, 74.24671249979076, 58.1328847827678, 10.976152963526289, 49.11680386819934, 20.44616515358274, 53.334278572924234, 63.724191150066986, 24.57338098544254, 88.07001231459628, 147.24559544238775, 8.512761878046973, 5.758192975112756, 59.5200757069905, 84.23912496026155, 153.80130385282644, 105.47326790791178, 24.127467076919245, 156.22252193830076, 16.006564203877396, 123.34262544938797, 26.973906796641103, 41.3037508710257, 59.485570791104976, 85.45536222051285, 52.076034586546534, 48.19966966569791, 47.31405492721932, 73.16052962234642, 146.79873629900058, 51.2958419880311, -16.63917866932136, 39.513961741569204, 36.91179381489367, 70.2695430634393, 41.448930827065034, -2.7402439936430483, 63.50214515778934, 91.01614090449269, 50.792946229960286, 43.56989678382516, 14.696706959310884, 55.04200301548312, 23.829944343105566, 65.5710104733076, 33.643443933570666, 128.78966044014172, 53.999599674401885, 19.06734848666251, 16.910344822470897, 110.68924625860286, 31.145338705876185, 71.86821956709217, 39.14320297852056, 93.04448056474126, 86.42068354310976, 89.69579802729777, 52.98918847869345, 120.87429502370324, 22.701210885962595, 96.6658227618898, 14.839041216446962, 47.02112431293638, -32.95750425129772, 101.11691070070873, 141.5031967584062, 13.050220920330574, 125.90139163403217, 27.859844672599746, 84.06261269738569, 33.57186165779825, 72.83218505316555, 38.7279966732099, -9.67546557168275, 103.67779264291448, 33.70343901524084, 33.554528449876834, 6.671554583913013, 42.12134648894934, 55.73011555892958, -21.359888553585286, -25.115716977467372, 49.40169265248075, 48.79780320632489, 8.274304112532263, 51.20849136882021, 68.68391700113115, -6.032907228758248, 47.89084825832175, 76.50234978995395, 70.41119369286926, 55.05134527911814, 164.0722382596169, 148.24464851451785, 19.3003096606583, 145.95217016213212], "episode_lengths": [183, 200, 107, 23, 200, 168, 85, 200, 200, 200, 200, 200, 200, 200, 200, 200, 177, 200, 200, 38, 200, 200, 180, 78, 200, 200, 149, 95, 200, 199, 181, 200, 102, 43, 148, 200, 200, 25, 33, 200, 200, 36, 152, 200, 185, 188, 154, 70, 38, 200, 46, 20, 200, 142, 40, 82, 200, 137, 198, 200, 200, 48, 200, 200, 200, 109, 155, 200, 200, 149, 200, 174, 45, 77, 200, 200, 200, 200, 58, 7, 200, 71, 200, 200, 200, 200, 200, 200, 2, 124, 119, 200, 200, 18, 158, 200, 54, 81, 200, 200], "policy_agent_policy_reward": [25.32948767630136, 63.375749898797885, 93.98407179286198, 12.400847588818888, 44.54238601581762, 37.12335624989539, 29.0664423913839, 5.488076481763123, 24.558401934099674, 10.223082576791342, 26.667139286462117, 31.862095575033514, 12.286690492721277, 44.03500615729816, 73.62279772119386, 4.2563809390234795, 2.8790964875563754, 29.76003785349524, 42.11956248013078, 76.90065192641322, 52.73663395395589, 12.06373353845963, 78.11126096915042, 8.003282101938698, 61.67131272469398, 13.486953398320548, 20.651875435512853, 29.742785395552485, 42.727681110256434, 26.038017293273242, 24.099834832848945, 23.657027463609644, 36.580264811173194, 73.39936814950028, 25.647920994015553, -8.319589334660805, 19.7569808707846, 18.45589690744683, 35.13477153171964, 20.724465413532492, -1.370121996821556, 31.751072578894682, 45.50807045224634, 25.396473114980143, 21.784948391912586, 7.3483534796554455, 27.521001507741552, 11.914972171552783, 32.7855052366538, 16.82172196678528, 64.39483022007089, 26.999799837200943, 9.533674243331262, 8.45517241123546, 55.34462312930141, 15.572669352938092, 35.93410978354609, 19.571601489260274, 46.52224028237062, 43.21034177155488, 44.84789901364887, 26.494594239346718, 60.437147511851606, 11.350605442981312, 48.332911380944886, 7.419520608223516, 23.51056215646818, -16.478752125648832, 50.558455350354365, 70.75159837920313, 6.525110460165266, 62.950695817016076, 13.929922336299871, 42.03130634869284, 16.785930828899147, 36.41609252658278, 19.363998336604933, -4.837732785841325, 51.83889632145728, 16.851719507620416, 16.777264224938417, 3.335777291956502, 21.06067324447465, 27.8650577794648, -10.679944276792643, -12.55785848873365, 24.700846326240363, 24.39890160316245, 4.137152056266132, 25.604245684410113, 34.34195850056558, -3.0164536143791274, 23.945424129160884, 38.25117489497698, 35.205596846434624, 27.52567263955907, 82.03611912980844, 74.12232425725895, 9.65015483032915, 72.97608508106609], "policy_adversary_policy_reward": [15.1556349191486, 10.173852757152757, 36.57470502901095, 26.801044869786935, 52.112586315895975, 41.871485476965994, 9.001844152712906, 3.399003436105982, 27.016724019018763, 17.525661996798867, 7.682323563223314, 29.441032686672074, 18.361881103654426, 10.704561287729476, 11.428228161408054, -5.940151679644931, 13.002778423359214, 11.55562351074046, 19.31952619139283, -9.096443614601476, 22.739891257297696, 3.927248029164417, 16.11707261405889, 15.745022960974623, 26.50535891190482, -14.218668419183558, 32.12095914198807, 11.91404701531009, 39.93480758140424, 33.687990139789626, 29.8774703847561, -25.621089445732622, 1.3104866580389825, 1.5686098295173823, 12.166689863910456, 17.593347989584785, 22.048893637942797, 20.070668842187985, 39.25721884803337, 37.64343307837982, 27.339160609104148, 25.39747334485174, -0.5905602434707262, 12.654293781930356, 42.32323149734543, 35.788029471805004, -23.206130863721942, 31.20941296566064, 34.031115003826926, 27.640197720867057, 0.7828823284698139, 12.704071069850734, 11.36749404886855, 9.284381386644306, 15.63881896364778, 14.103966431904713, 24.349021355670004, 18.378659754586426, 23.209327460213864, 2.828689833059384, 6.085871591655691, 18.013963241193252, 10.003914474110296, 13.653112989499343, 30.605832936397384, 5.974431874775801, 38.62984642647697, 34.7695217230233, -2.929344910495537, 28.577265904511087, -6.412549560304289, -1.907039774356452, -5.139968225491401, 24.896949096276007, 2.2751224466143753, 16.180774460832456, 29.63397785886604, 5.500793672853607, 8.19044739508077, 12.534018018451725, 5.94152060543535, -7.311642602256896, -3.396001413295213, 35.1470739921899, 19.96718123168298, 25.540889220563372, 17.41400213722495, 7.982470977755192, 20.732722200747787, 1.052226191164788, 11.294569587855172, -3.94621610819973, 5.977257280246066, 21.543744227495484, 3.100674188082168, 8.814297983470613, -7.80209183938663, 40.587597076040424, 17.720281669282574, -0.8985597024972947, 17.377238346223738, 47.017591873847145, 7.23764913427701, 19.762150702923936, 1.5043570405349094, 8.02931720279635, -11.06711004407121, 19.52228245530667, 15.52249729224732, 39.822125837054095, -5.984996635074928, 21.55766598801302, 30.736849028087242, 5.197260755458861, 38.58353486815915, -19.011933378898874, 25.132851393575177, 21.38938888879546, 12.848092444568454, 30.362249326986426, 23.162583973873875, 21.685315039775002, -0.549732627177212, 27.04432686652394, 31.968709524640044, 28.46843798721156, 4.152469218423807, 7.198136224557501, 36.82902773094935, 11.503883649995519, 2.87139670109622, 4.548123907127294, 14.319330512661239, 9.191231643806944, -20.323760279547507, 3.845008153898643, 21.84987168886135, 28.708583661493016, 30.695744874683797, 40.05585350451935, -10.10124306305303, 16.626353523218295, 21.927841891329866, 41.022853925686206, -9.513548127421974, 23.443470463721845, 35.79967437494055, 6.2316319737522665, 9.373148509575906, 7.412782319323245, 11.096428363647597, 25.319664162935176, 36.33985784893836, -16.975859512333415, -8.430530962150641, 3.5927981763093015, 55.942043793322306, -4.103147471865068, 7.222640680211179, 9.629078827409238, -4.3710508802068055, 21.148315105145223, 10.850460142710944, -7.51468285075444, -4.9845042220735465, 26.04517746654819, 19.98615860134484, 7.878899178119958, -7.016273964773067, -3.663670312019576, 0.6075073087040117, -13.16536579743768, 3.83549388669708, 20.86535243954329, 4.232075501312938, 20.16682610184951, 2.688950462699232, 1.4482015935668997, 15.204123757695815, 10.400121926714299, 5.48333290996953, 28.858625590596052, 19.581473961690392, -22.59792757606951, 8.866894672920552, 15.078529456240332, 20.838304060999224, 17.41287083397775, 23.46295431145995, 11.742642534974683, 30.861297048358182, -3.335624408799113, 30.731568904144346, 51.304550225664116, 30.46002143577242, 43.66230282148652, 2.436485761597744, 7.213669068731406, 46.583286284565546, 26.392798796500532]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39262090983247583, "mean_inference_ms": 0.9754298758837501, "mean_action_processing_ms": 0.16698606037721242, "mean_env_wait_ms": 0.05834193777764371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033931732177734375, "StateBufferConnector_ms": 0.002429366111755371, "ViewRequirementAgentConnector_ms": 0.06536173820495605}, "num_episodes": 26, "episode_return_max": 187.96814358572388, "episode_return_min": -32.95750425129772, "episode_return_mean": 59.17227104612787}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.5789302310685, "num_env_steps_trained_throughput_per_sec": 503.5789302310685, "timesteps_total": 680000, "num_env_steps_sampled_lifetime": 680000, "num_agent_steps_sampled_lifetime": 2040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2040000, "timers": {"training_iteration_time_ms": 8140.623, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8140.58, "sample_time_ms": 772.652, "learn_time_ms": 7355.846, "learn_throughput": 543.785, "synch_weights_time_ms": 11.641}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "done": false, "training_iteration": 170, "trial_id": "eaa30_00000", "date": "2024-08-09_18-03-44", "timestamp": 1723241024, "time_this_iter_s": 7.947649955749512, "time_total_s": 1396.243539094925, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781ec820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1396.243539094925, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 24.200000000000003, "ram_util_percent": 81.67272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.345417020812867, "cur_kl_coeff": 0.17338601276121607, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.608835273192673, "policy_loss": -0.022469309953943133, "vf_loss": 4.618126164542304, "vf_explained_var": 0.1254012113525754, "kl": 0.07600624997799517, "entropy": 0.5342448705876315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.96653291285038, "cur_kl_coeff": 0.14076001119040768, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.942169459660848, "policy_loss": 0.17214216643648494, "vf_loss": 6.746060506006082, "vf_explained_var": 0.062447857670485975, "kl": 0.17026686614068845, "entropy": 0.9490223191057642, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 163680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000}, "env_runners": {"episode_reward_max": 164.0722382596169, "episode_reward_min": -73.8134025739133, "episode_reward_mean": 46.11507470791242, "episode_len_mean": 152.73, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 15273, "policy_reward_min": {"agent_policy": -36.906701286956675, "adversary_policy": -36.083529426628026}, "policy_reward_max": {"agent_policy": 82.03611912980844, "adversary_policy": 55.942043793322306}, "policy_reward_mean": {"agent_policy": 23.057537353956203, "adversary_policy": 11.528768676978101}, "custom_metrics": {}, "hist_stats": {"episode_reward": [123.34262544938797, 26.973906796641103, 41.3037508710257, 59.485570791104976, 85.45536222051285, 52.076034586546534, 48.19966966569791, 47.31405492721932, 73.16052962234642, 146.79873629900058, 51.2958419880311, -16.63917866932136, 39.513961741569204, 36.91179381489367, 70.2695430634393, 41.448930827065034, -2.7402439936430483, 63.50214515778934, 91.01614090449269, 50.792946229960286, 43.56989678382516, 14.696706959310884, 55.04200301548312, 23.829944343105566, 65.5710104733076, 33.643443933570666, 128.78966044014172, 53.999599674401885, 19.06734848666251, 16.910344822470897, 110.68924625860286, 31.145338705876185, 71.86821956709217, 39.14320297852056, 93.04448056474126, 86.42068354310976, 89.69579802729777, 52.98918847869345, 120.87429502370324, 22.701210885962595, 96.6658227618898, 14.839041216446962, 47.02112431293638, -32.95750425129772, 101.11691070070873, 141.5031967584062, 13.050220920330574, 125.90139163403217, 27.859844672599746, 84.06261269738569, 33.57186165779825, 72.83218505316555, 38.7279966732099, -9.67546557168275, 103.67779264291448, 33.70343901524084, 33.554528449876834, 6.671554583913013, 42.12134648894934, 55.73011555892958, -21.359888553585286, -25.115716977467372, 49.40169265248075, 48.79780320632489, 8.274304112532263, 51.20849136882021, 68.68391700113115, -6.032907228758248, 47.89084825832175, 76.50234978995395, 70.41119369286926, 55.05134527911814, 164.0722382596169, 148.24464851451785, 19.3003096606583, 145.95217016213212, -15.287570405809038, 63.21365999394707, 72.19564653594469, -59.20655902032094, 12.191276906605545, 23.68725368826884, -40.675796846296905, 0.35809512743137617, 81.37560247678448, -46.478329457120665, 4.615917500719853, 43.889871971602766, 42.003565728054866, 9.271164931932448, -10.575415049258424, 33.96334860312072, 57.74076159506984, -38.54212187055292, -73.8134025739133, -17.252907867926467, -31.027689118518936, 109.06108888879142, 34.337771269718466, 122.02767734890688], "episode_lengths": [200, 200, 149, 95, 200, 199, 181, 200, 102, 43, 148, 200, 200, 25, 33, 200, 200, 36, 152, 200, 185, 188, 154, 70, 38, 200, 46, 20, 200, 142, 40, 82, 200, 137, 198, 200, 200, 48, 200, 200, 200, 109, 155, 200, 200, 149, 200, 174, 45, 77, 200, 200, 200, 200, 58, 7, 200, 71, 200, 200, 200, 200, 200, 200, 2, 124, 119, 200, 200, 18, 158, 200, 54, 81, 200, 200, 200, 158, 151, 200, 169, 200, 200, 200, 200, 200, 200, 24, 200, 76, 200, 200, 23, 200, 200, 200, 200, 160, 200, 200], "policy_agent_policy_reward": [61.67131272469398, 13.486953398320548, 20.651875435512853, 29.742785395552485, 42.727681110256434, 26.038017293273242, 24.099834832848945, 23.657027463609644, 36.580264811173194, 73.39936814950028, 25.647920994015553, -8.319589334660805, 19.7569808707846, 18.45589690744683, 35.13477153171964, 20.724465413532492, -1.370121996821556, 31.751072578894682, 45.50807045224634, 25.396473114980143, 21.784948391912586, 7.3483534796554455, 27.521001507741552, 11.914972171552783, 32.7855052366538, 16.82172196678528, 64.39483022007089, 26.999799837200943, 9.533674243331262, 8.45517241123546, 55.34462312930141, 15.572669352938092, 35.93410978354609, 19.571601489260274, 46.52224028237062, 43.21034177155488, 44.84789901364887, 26.494594239346718, 60.437147511851606, 11.350605442981312, 48.332911380944886, 7.419520608223516, 23.51056215646818, -16.478752125648832, 50.558455350354365, 70.75159837920313, 6.525110460165266, 62.950695817016076, 13.929922336299871, 42.03130634869284, 16.785930828899147, 36.41609252658278, 19.363998336604933, -4.837732785841325, 51.83889632145728, 16.851719507620416, 16.777264224938417, 3.335777291956502, 21.06067324447465, 27.8650577794648, -10.679944276792643, -12.55785848873365, 24.700846326240363, 24.39890160316245, 4.137152056266132, 25.604245684410113, 34.34195850056558, -3.0164536143791274, 23.945424129160884, 38.25117489497698, 35.205596846434624, 27.52567263955907, 82.03611912980844, 74.12232425725895, 9.65015483032915, 72.97608508106609, -7.643785202904445, 31.60682999697353, 36.09782326797234, -29.60327951016048, 6.095638453302758, 11.84362684413442, -20.337898423148438, 0.17904756371568809, 40.68780123839226, -23.23916472856036, 2.3079587503599335, 21.944935985801383, 21.001782864027426, 4.635582465966219, -5.287707524629212, 16.981674301560357, 28.870380797534917, -19.271060935276466, -36.906701286956675, -8.626453933963269, -15.513844559259418, 54.53054444439566, 17.168885634859233, 61.0138386744534], "policy_adversary_policy_reward": [34.031115003826926, 27.640197720867057, 0.7828823284698139, 12.704071069850734, 11.36749404886855, 9.284381386644306, 15.63881896364778, 14.103966431904713, 24.349021355670004, 18.378659754586426, 23.209327460213864, 2.828689833059384, 6.085871591655691, 18.013963241193252, 10.003914474110296, 13.653112989499343, 30.605832936397384, 5.974431874775801, 38.62984642647697, 34.7695217230233, -2.929344910495537, 28.577265904511087, -6.412549560304289, -1.907039774356452, -5.139968225491401, 24.896949096276007, 2.2751224466143753, 16.180774460832456, 29.63397785886604, 5.500793672853607, 8.19044739508077, 12.534018018451725, 5.94152060543535, -7.311642602256896, -3.396001413295213, 35.1470739921899, 19.96718123168298, 25.540889220563372, 17.41400213722495, 7.982470977755192, 20.732722200747787, 1.052226191164788, 11.294569587855172, -3.94621610819973, 5.977257280246066, 21.543744227495484, 3.100674188082168, 8.814297983470613, -7.80209183938663, 40.587597076040424, 17.720281669282574, -0.8985597024972947, 17.377238346223738, 47.017591873847145, 7.23764913427701, 19.762150702923936, 1.5043570405349094, 8.02931720279635, -11.06711004407121, 19.52228245530667, 15.52249729224732, 39.822125837054095, -5.984996635074928, 21.55766598801302, 30.736849028087242, 5.197260755458861, 38.58353486815915, -19.011933378898874, 25.132851393575177, 21.38938888879546, 12.848092444568454, 30.362249326986426, 23.162583973873875, 21.685315039775002, -0.549732627177212, 27.04432686652394, 31.968709524640044, 28.46843798721156, 4.152469218423807, 7.198136224557501, 36.82902773094935, 11.503883649995519, 2.87139670109622, 4.548123907127294, 14.319330512661239, 9.191231643806944, -20.323760279547507, 3.845008153898643, 21.84987168886135, 28.708583661493016, 30.695744874683797, 40.05585350451935, -10.10124306305303, 16.626353523218295, 21.927841891329866, 41.022853925686206, -9.513548127421974, 23.443470463721845, 35.79967437494055, 6.2316319737522665, 9.373148509575906, 7.412782319323245, 11.096428363647597, 25.319664162935176, 36.33985784893836, -16.975859512333415, -8.430530962150641, 3.5927981763093015, 55.942043793322306, -4.103147471865068, 7.222640680211179, 9.629078827409238, -4.3710508802068055, 21.148315105145223, 10.850460142710944, -7.51468285075444, -4.9845042220735465, 26.04517746654819, 19.98615860134484, 7.878899178119958, -7.016273964773067, -3.663670312019576, 0.6075073087040117, -13.16536579743768, 3.83549388669708, 20.86535243954329, 4.232075501312938, 20.16682610184951, 2.688950462699232, 1.4482015935668997, 15.204123757695815, 10.400121926714299, 5.48333290996953, 28.858625590596052, 19.581473961690392, -22.59792757606951, 8.866894672920552, 15.078529456240332, 20.838304060999224, 17.41287083397775, 23.46295431145995, 11.742642534974683, 30.861297048358182, -3.335624408799113, 30.731568904144346, 51.304550225664116, 30.46002143577242, 43.66230282148652, 2.436485761597744, 7.213669068731406, 46.583286284565546, 26.392798796500532, -10.54781790858922, 2.904032705684772, 20.984627737956856, 10.622202259016671, 4.568845033692902, 31.528978234279453, -15.837404265600355, -13.76587524456015, 24.970148095775894, -18.87450964247314, 8.191429462954687, 3.6521973811797324, 7.953703425509566, -28.29160184865801, 16.747546828092126, -16.568499264376435, 27.75586368335154, 12.931937555040712, -16.70438181087645, -6.534782917683895, 1.6943289684037772, 0.6136297819561563, 5.024797690522313, 16.920138295279074, 8.834751282972032, 12.167031581055394, 2.7947047206040834, 1.8408777453621354, -2.6198934361710613, -2.667814088458151, -2.052804500468408, 19.034478802028765, 3.134163659002784, 25.736217138532133, -5.628674302942471, -13.642386632333988, -15.192642531967877, -21.7140587549888, 3.1129413584946093, -11.739395292457882, 20.569684867368608, -36.083529426628026, 22.822105472386763, 31.708438972008896, 18.32410580786102, -1.155220173001787, 26.598993798567847, 34.41484487588555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3925789043965215, "mean_inference_ms": 0.9755015255974149, "mean_action_processing_ms": 0.16682562126368733, "mean_env_wait_ms": 0.058317045699940076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034732818603515625, "StateBufferConnector_ms": 0.0023876428604125977, "ViewRequirementAgentConnector_ms": 0.06321418285369873}, "num_episodes": 24, "episode_return_max": 164.0722382596169, "episode_return_min": -73.8134025739133, "episode_return_mean": 46.11507470791242}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.42229458862056, "num_env_steps_trained_throughput_per_sec": 499.42229458862056, "timesteps_total": 684000, "num_env_steps_sampled_lifetime": 684000, "num_agent_steps_sampled_lifetime": 2052000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2052000, "timers": {"training_iteration_time_ms": 8102.667, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8102.624, "sample_time_ms": 755.494, "learn_time_ms": 7335.103, "learn_throughput": 545.323, "synch_weights_time_ms": 11.584}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000}, "done": false, "training_iteration": 171, "trial_id": "eaa30_00000", "date": "2024-08-09_18-03-53", "timestamp": 1723241033, "time_this_iter_s": 8.014060735702515, "time_total_s": 1404.2575998306274, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781ff0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1404.2575998306274, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 28.441666666666666, "ram_util_percent": 81.45833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.438650139551314, "cur_kl_coeff": 0.2600790191418242, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.491729284720446, "policy_loss": -0.008497367837409632, "vf_loss": 4.4930474379706, "vf_explained_var": 0.19010776539958973, "kl": 0.027603950198227294, "entropy": 0.4704466575194919, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.27463863057395, "cur_kl_coeff": 0.21114001678561148, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.795158053437869, "policy_loss": 0.11203472334163962, "vf_loss": 6.65842836946249, "vf_explained_var": 0.06319712859888872, "kl": 0.1169601633407486, "entropy": 1.0709045954048633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 164640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "env_runners": {"episode_reward_max": 164.0722382596169, "episode_reward_min": -73.8134025739133, "episode_reward_mean": 37.251410651281006, "episode_len_mean": 159.77, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 15977, "policy_reward_min": {"agent_policy": -36.906701286956675, "adversary_policy": -36.083529426628026}, "policy_reward_max": {"agent_policy": 82.03611912980844, "adversary_policy": 55.942043793322306}, "policy_reward_mean": {"agent_policy": 18.625705325640503, "adversary_policy": 9.31285266282025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.56989678382516, 14.696706959310884, 55.04200301548312, 23.829944343105566, 65.5710104733076, 33.643443933570666, 128.78966044014172, 53.999599674401885, 19.06734848666251, 16.910344822470897, 110.68924625860286, 31.145338705876185, 71.86821956709217, 39.14320297852056, 93.04448056474126, 86.42068354310976, 89.69579802729777, 52.98918847869345, 120.87429502370324, 22.701210885962595, 96.6658227618898, 14.839041216446962, 47.02112431293638, -32.95750425129772, 101.11691070070873, 141.5031967584062, 13.050220920330574, 125.90139163403217, 27.859844672599746, 84.06261269738569, 33.57186165779825, 72.83218505316555, 38.7279966732099, -9.67546557168275, 103.67779264291448, 33.70343901524084, 33.554528449876834, 6.671554583913013, 42.12134648894934, 55.73011555892958, -21.359888553585286, -25.115716977467372, 49.40169265248075, 48.79780320632489, 8.274304112532263, 51.20849136882021, 68.68391700113115, -6.032907228758248, 47.89084825832175, 76.50234978995395, 70.41119369286926, 55.05134527911814, 164.0722382596169, 148.24464851451785, 19.3003096606583, 145.95217016213212, -15.287570405809038, 63.21365999394707, 72.19564653594469, -59.20655902032094, 12.191276906605545, 23.68725368826884, -40.675796846296905, 0.35809512743137617, 81.37560247678448, -46.478329457120665, 4.615917500719853, 43.889871971602766, 42.003565728054866, 9.271164931932448, -10.575415049258424, 33.96334860312072, 57.74076159506984, -38.54212187055292, -73.8134025739133, -17.252907867926467, -31.027689118518936, 109.06108888879142, 34.337771269718466, 122.02767734890688, -47.324002870699815, 30.27570505270755, -8.67833017303468, -49.12318979156038, 12.875254892677624, 102.01202830530417, 62.97702506620142, 47.49366958010535, -46.97392158899052, 4.751363859332287, 19.327670876752492, -24.18088881213533, -22.48454499749497, -4.18377996280234, 47.425061862670105, 33.198429657013094, 12.935495328902366, 32.252985762648606, -6.777522022054853, 47.317206605075775], "episode_lengths": [185, 188, 154, 70, 38, 200, 46, 20, 200, 142, 40, 82, 200, 137, 198, 200, 200, 48, 200, 200, 200, 109, 155, 200, 200, 149, 200, 174, 45, 77, 200, 200, 200, 200, 58, 7, 200, 71, 200, 200, 200, 200, 200, 200, 2, 124, 119, 200, 200, 18, 158, 200, 54, 81, 200, 200, 200, 158, 151, 200, 169, 200, 200, 200, 200, 200, 200, 24, 200, 76, 200, 200, 23, 200, 200, 200, 200, 160, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 160, 138, 200, 200, 200, 95, 200, 74], "policy_agent_policy_reward": [21.784948391912586, 7.3483534796554455, 27.521001507741552, 11.914972171552783, 32.7855052366538, 16.82172196678528, 64.39483022007089, 26.999799837200943, 9.533674243331262, 8.45517241123546, 55.34462312930141, 15.572669352938092, 35.93410978354609, 19.571601489260274, 46.52224028237062, 43.21034177155488, 44.84789901364887, 26.494594239346718, 60.437147511851606, 11.350605442981312, 48.332911380944886, 7.419520608223516, 23.51056215646818, -16.478752125648832, 50.558455350354365, 70.75159837920313, 6.525110460165266, 62.950695817016076, 13.929922336299871, 42.03130634869284, 16.785930828899147, 36.41609252658278, 19.363998336604933, -4.837732785841325, 51.83889632145728, 16.851719507620416, 16.777264224938417, 3.335777291956502, 21.06067324447465, 27.8650577794648, -10.679944276792643, -12.55785848873365, 24.700846326240363, 24.39890160316245, 4.137152056266132, 25.604245684410113, 34.34195850056558, -3.0164536143791274, 23.945424129160884, 38.25117489497698, 35.205596846434624, 27.52567263955907, 82.03611912980844, 74.12232425725895, 9.65015483032915, 72.97608508106609, -7.643785202904445, 31.60682999697353, 36.09782326797234, -29.60327951016048, 6.095638453302758, 11.84362684413442, -20.337898423148438, 0.17904756371568809, 40.68780123839226, -23.23916472856036, 2.3079587503599335, 21.944935985801383, 21.001782864027426, 4.635582465966219, -5.287707524629212, 16.981674301560357, 28.870380797534917, -19.271060935276466, -36.906701286956675, -8.626453933963269, -15.513844559259418, 54.53054444439566, 17.168885634859233, 61.0138386744534, -23.662001435349893, 15.137852526353775, -4.339165086517292, -24.561594895780175, 6.437627446338844, 51.006014152652085, 31.48851253310071, 23.746834790052652, -23.486960794495296, 2.3756819296661504, 9.663835438376246, -12.090444406067697, -11.242272498747482, -2.091889981401156, 23.712530931335056, 16.59921482850655, 6.467747664451203, 16.126492881324307, -3.3887610110274338, 23.658603302537887], "policy_adversary_policy_reward": [20.732722200747787, 1.052226191164788, 11.294569587855172, -3.94621610819973, 5.977257280246066, 21.543744227495484, 3.100674188082168, 8.814297983470613, -7.80209183938663, 40.587597076040424, 17.720281669282574, -0.8985597024972947, 17.377238346223738, 47.017591873847145, 7.23764913427701, 19.762150702923936, 1.5043570405349094, 8.02931720279635, -11.06711004407121, 19.52228245530667, 15.52249729224732, 39.822125837054095, -5.984996635074928, 21.55766598801302, 30.736849028087242, 5.197260755458861, 38.58353486815915, -19.011933378898874, 25.132851393575177, 21.38938888879546, 12.848092444568454, 30.362249326986426, 23.162583973873875, 21.685315039775002, -0.549732627177212, 27.04432686652394, 31.968709524640044, 28.46843798721156, 4.152469218423807, 7.198136224557501, 36.82902773094935, 11.503883649995519, 2.87139670109622, 4.548123907127294, 14.319330512661239, 9.191231643806944, -20.323760279547507, 3.845008153898643, 21.84987168886135, 28.708583661493016, 30.695744874683797, 40.05585350451935, -10.10124306305303, 16.626353523218295, 21.927841891329866, 41.022853925686206, -9.513548127421974, 23.443470463721845, 35.79967437494055, 6.2316319737522665, 9.373148509575906, 7.412782319323245, 11.096428363647597, 25.319664162935176, 36.33985784893836, -16.975859512333415, -8.430530962150641, 3.5927981763093015, 55.942043793322306, -4.103147471865068, 7.222640680211179, 9.629078827409238, -4.3710508802068055, 21.148315105145223, 10.850460142710944, -7.51468285075444, -4.9845042220735465, 26.04517746654819, 19.98615860134484, 7.878899178119958, -7.016273964773067, -3.663670312019576, 0.6075073087040117, -13.16536579743768, 3.83549388669708, 20.86535243954329, 4.232075501312938, 20.16682610184951, 2.688950462699232, 1.4482015935668997, 15.204123757695815, 10.400121926714299, 5.48333290996953, 28.858625590596052, 19.581473961690392, -22.59792757606951, 8.866894672920552, 15.078529456240332, 20.838304060999224, 17.41287083397775, 23.46295431145995, 11.742642534974683, 30.861297048358182, -3.335624408799113, 30.731568904144346, 51.304550225664116, 30.46002143577242, 43.66230282148652, 2.436485761597744, 7.213669068731406, 46.583286284565546, 26.392798796500532, -10.54781790858922, 2.904032705684772, 20.984627737956856, 10.622202259016671, 4.568845033692902, 31.528978234279453, -15.837404265600355, -13.76587524456015, 24.970148095775894, -18.87450964247314, 8.191429462954687, 3.6521973811797324, 7.953703425509566, -28.29160184865801, 16.747546828092126, -16.568499264376435, 27.75586368335154, 12.931937555040712, -16.70438181087645, -6.534782917683895, 1.6943289684037772, 0.6136297819561563, 5.024797690522313, 16.920138295279074, 8.834751282972032, 12.167031581055394, 2.7947047206040834, 1.8408777453621354, -2.6198934361710613, -2.667814088458151, -2.052804500468408, 19.034478802028765, 3.134163659002784, 25.736217138532133, -5.628674302942471, -13.642386632333988, -15.192642531967877, -21.7140587549888, 3.1129413584946093, -11.739395292457882, 20.569684867368608, -36.083529426628026, 22.822105472386763, 31.708438972008896, 18.32410580786102, -1.155220173001787, 26.598993798567847, 34.41484487588555, -7.343696736957183, -16.318304698392726, 6.177134429554236, 8.960718096799539, 12.394954176423187, -16.734119262940485, -14.26457666497005, -10.297018230810128, 3.8290570166048816, 2.608570429733959, 24.064687814693116, 26.941326337958962, 13.930653491994438, 17.557859041106276, 17.068314331595566, 6.6785204584570845, -8.722041678791161, -14.764919115704132, 2.2743386413399573, 0.10134328832619133, -12.615149486269548, 22.278984924645798, 1.974410015472177, -14.06485442153987, 17.361166302083426, -28.603438800830897, 8.386368002909174, -10.478257984310332, 24.20026377347078, -0.4877328421357241, 22.153022480288712, -5.5538076517821615, 30.251793501660046, -23.784045837208836, -16.463110411367115, 32.58960329269142, -3.84898437455071, 0.46022336352327997, 7.489404507310913, 16.169198795226976]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3928912508902599, "mean_inference_ms": 0.9758713943065471, "mean_action_processing_ms": 0.16672322286734098, "mean_env_wait_ms": 0.05837929895907332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035363435745239258, "StateBufferConnector_ms": 0.0024918317794799805, "ViewRequirementAgentConnector_ms": 0.06901240348815918}, "num_episodes": 20, "episode_return_max": 164.0722382596169, "episode_return_min": -73.8134025739133, "episode_return_mean": 37.251410651281006}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 456.137953568598, "num_env_steps_trained_throughput_per_sec": 456.137953568598, "timesteps_total": 688000, "num_env_steps_sampled_lifetime": 688000, "num_agent_steps_sampled_lifetime": 2064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2064000, "timers": {"training_iteration_time_ms": 8145.191, "restore_workers_time_ms": 0.021, "training_step_time_ms": 8145.134, "sample_time_ms": 781.979, "learn_time_ms": 7350.603, "learn_throughput": 544.173, "synch_weights_time_ms": 11.863}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "done": false, "training_iteration": 172, "trial_id": "eaa30_00000", "date": "2024-08-09_18-04-02", "timestamp": 1723241042, "time_this_iter_s": 8.812196016311646, "time_total_s": 1413.069795846939, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781ece50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1413.069795846939, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 31.623076923076926, "ram_util_percent": 82.33076923076922}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.320541911150412, "cur_kl_coeff": 0.3901185287127361, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.838609345123251, "policy_loss": 0.002220062728140937, "vf_loss": 4.82877557201991, "vf_explained_var": 0.22935244901470406, "kl": 0.019516405955981957, "entropy": 0.39952034485087823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.596279553758603, "cur_kl_coeff": 0.3167100251784173, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.204623015224934, "policy_loss": 0.03764718617458129, "vf_loss": 7.144457181294759, "vf_explained_var": 0.06999002359807491, "kl": 0.07110178423269341, "entropy": 1.0599021257211765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 165600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000}, "env_runners": {"episode_reward_max": 195.948696958116, "episode_reward_min": -88.13814751958247, "episode_reward_mean": 29.81446928679314, "episode_len_mean": 166.28, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 16628, "policy_reward_min": {"agent_policy": -44.06907375979124, "adversary_policy": -36.083529426628026}, "policy_reward_max": {"agent_policy": 97.97434847905802, "adversary_policy": 55.942043793322306}, "policy_reward_mean": {"agent_policy": 14.90723464339657, "adversary_policy": 7.453617321698284}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.90139163403217, 27.859844672599746, 84.06261269738569, 33.57186165779825, 72.83218505316555, 38.7279966732099, -9.67546557168275, 103.67779264291448, 33.70343901524084, 33.554528449876834, 6.671554583913013, 42.12134648894934, 55.73011555892958, -21.359888553585286, -25.115716977467372, 49.40169265248075, 48.79780320632489, 8.274304112532263, 51.20849136882021, 68.68391700113115, -6.032907228758248, 47.89084825832175, 76.50234978995395, 70.41119369286926, 55.05134527911814, 164.0722382596169, 148.24464851451785, 19.3003096606583, 145.95217016213212, -15.287570405809038, 63.21365999394707, 72.19564653594469, -59.20655902032094, 12.191276906605545, 23.68725368826884, -40.675796846296905, 0.35809512743137617, 81.37560247678448, -46.478329457120665, 4.615917500719853, 43.889871971602766, 42.003565728054866, 9.271164931932448, -10.575415049258424, 33.96334860312072, 57.74076159506984, -38.54212187055292, -73.8134025739133, -17.252907867926467, -31.027689118518936, 109.06108888879142, 34.337771269718466, 122.02767734890688, -47.324002870699815, 30.27570505270755, -8.67833017303468, -49.12318979156038, 12.875254892677624, 102.01202830530417, 62.97702506620142, 47.49366958010535, -46.97392158899052, 4.751363859332287, 19.327670876752492, -24.18088881213533, -22.48454499749497, -4.18377996280234, 47.425061862670105, 33.198429657013094, 12.935495328902366, 32.252985762648606, -6.777522022054853, 47.317206605075775, -88.13814751958247, 43.421375682561845, 42.207580862861406, 195.948696958116, 112.37274474152849, 9.859795401965734, 24.4041867997783, 24.096337358429697, -75.31846360944978, -9.153766674551555, 99.3292896905565, 5.890483547299368, 41.71926594497067, 76.5825234269954, 25.249002716207265, 50.75071461215215, 64.5876282976274, 44.59915531668278, 3.540809687221377, 15.049362894568123, -15.116445498171103, 30.028125352132555, -7.240187000088554, 51.24012078372829, -24.631223412167532, 76.64896048233956, -6.691627907197152], "episode_lengths": [174, 45, 77, 200, 200, 200, 200, 58, 7, 200, 71, 200, 200, 200, 200, 200, 200, 2, 124, 119, 200, 200, 18, 158, 200, 54, 81, 200, 200, 200, 158, 151, 200, 169, 200, 200, 200, 200, 200, 200, 24, 200, 76, 200, 200, 23, 200, 200, 200, 200, 160, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 160, 138, 200, 200, 200, 95, 200, 74, 200, 27, 176, 62, 200, 200, 190, 200, 200, 200, 200, 200, 137, 16, 200, 200, 200, 33, 200, 200, 200, 171, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [62.950695817016076, 13.929922336299871, 42.03130634869284, 16.785930828899147, 36.41609252658278, 19.363998336604933, -4.837732785841325, 51.83889632145728, 16.851719507620416, 16.777264224938417, 3.335777291956502, 21.06067324447465, 27.8650577794648, -10.679944276792643, -12.55785848873365, 24.700846326240363, 24.39890160316245, 4.137152056266132, 25.604245684410113, 34.34195850056558, -3.0164536143791274, 23.945424129160884, 38.25117489497698, 35.205596846434624, 27.52567263955907, 82.03611912980844, 74.12232425725895, 9.65015483032915, 72.97608508106609, -7.643785202904445, 31.60682999697353, 36.09782326797234, -29.60327951016048, 6.095638453302758, 11.84362684413442, -20.337898423148438, 0.17904756371568809, 40.68780123839226, -23.23916472856036, 2.3079587503599335, 21.944935985801383, 21.001782864027426, 4.635582465966219, -5.287707524629212, 16.981674301560357, 28.870380797534917, -19.271060935276466, -36.906701286956675, -8.626453933963269, -15.513844559259418, 54.53054444439566, 17.168885634859233, 61.0138386744534, -23.662001435349893, 15.137852526353775, -4.339165086517292, -24.561594895780175, 6.437627446338844, 51.006014152652085, 31.48851253310071, 23.746834790052652, -23.486960794495296, 2.3756819296661504, 9.663835438376246, -12.090444406067697, -11.242272498747482, -2.091889981401156, 23.712530931335056, 16.59921482850655, 6.467747664451203, 16.126492881324307, -3.3887610110274338, 23.658603302537887, -44.06907375979124, 21.710687841280937, 21.10379043143071, 97.97434847905802, 56.18637237076425, 4.929897700982874, 12.202093399889158, 12.048168679214847, -37.65923180472484, -4.576883337275776, 49.664644845278254, 2.945241773649684, 20.859632972485336, 38.291261713497676, 12.62450135810362, 25.375357306076076, 32.29381414881371, 22.29957765834138, 1.7704048436107427, 7.5246814472840455, -7.558222749085562, 15.014062676066278, -3.620093500044277, 25.620060391864143, -12.315611706083729, 38.3244802411698, -3.3458139535985616], "policy_adversary_policy_reward": [21.927841891329866, 41.022853925686206, -9.513548127421974, 23.443470463721845, 35.79967437494055, 6.2316319737522665, 9.373148509575906, 7.412782319323245, 11.096428363647597, 25.319664162935176, 36.33985784893836, -16.975859512333415, -8.430530962150641, 3.5927981763093015, 55.942043793322306, -4.103147471865068, 7.222640680211179, 9.629078827409238, -4.3710508802068055, 21.148315105145223, 10.850460142710944, -7.51468285075444, -4.9845042220735465, 26.04517746654819, 19.98615860134484, 7.878899178119958, -7.016273964773067, -3.663670312019576, 0.6075073087040117, -13.16536579743768, 3.83549388669708, 20.86535243954329, 4.232075501312938, 20.16682610184951, 2.688950462699232, 1.4482015935668997, 15.204123757695815, 10.400121926714299, 5.48333290996953, 28.858625590596052, 19.581473961690392, -22.59792757606951, 8.866894672920552, 15.078529456240332, 20.838304060999224, 17.41287083397775, 23.46295431145995, 11.742642534974683, 30.861297048358182, -3.335624408799113, 30.731568904144346, 51.304550225664116, 30.46002143577242, 43.66230282148652, 2.436485761597744, 7.213669068731406, 46.583286284565546, 26.392798796500532, -10.54781790858922, 2.904032705684772, 20.984627737956856, 10.622202259016671, 4.568845033692902, 31.528978234279453, -15.837404265600355, -13.76587524456015, 24.970148095775894, -18.87450964247314, 8.191429462954687, 3.6521973811797324, 7.953703425509566, -28.29160184865801, 16.747546828092126, -16.568499264376435, 27.75586368335154, 12.931937555040712, -16.70438181087645, -6.534782917683895, 1.6943289684037772, 0.6136297819561563, 5.024797690522313, 16.920138295279074, 8.834751282972032, 12.167031581055394, 2.7947047206040834, 1.8408777453621354, -2.6198934361710613, -2.667814088458151, -2.052804500468408, 19.034478802028765, 3.134163659002784, 25.736217138532133, -5.628674302942471, -13.642386632333988, -15.192642531967877, -21.7140587549888, 3.1129413584946093, -11.739395292457882, 20.569684867368608, -36.083529426628026, 22.822105472386763, 31.708438972008896, 18.32410580786102, -1.155220173001787, 26.598993798567847, 34.41484487588555, -7.343696736957183, -16.318304698392726, 6.177134429554236, 8.960718096799539, 12.394954176423187, -16.734119262940485, -14.26457666497005, -10.297018230810128, 3.8290570166048816, 2.608570429733959, 24.064687814693116, 26.941326337958962, 13.930653491994438, 17.557859041106276, 17.068314331595566, 6.6785204584570845, -8.722041678791161, -14.764919115704132, 2.2743386413399573, 0.10134328832619133, -12.615149486269548, 22.278984924645798, 1.974410015472177, -14.06485442153987, 17.361166302083426, -28.603438800830897, 8.386368002909174, -10.478257984310332, 24.20026377347078, -0.4877328421357241, 22.153022480288712, -5.5538076517821615, 30.251793501660046, -23.784045837208836, -16.463110411367115, 32.58960329269142, -3.84898437455071, 0.46022336352327997, 7.489404507310913, 16.169198795226976, -23.222249916743635, -20.846823843047602, -5.200881556935155, 26.91156939821609, 17.977227155567714, 3.1265632758630044, 55.60501004298182, 42.36933843607621, 17.688733431508957, 38.49763893925531, -4.918672802791246, 9.848570503774123, 22.897955455377478, -10.69586205548832, -2.3712197464467017, 14.419388425661552, -25.455229849687207, -12.204001955037633, 4.521585632080511, -9.098468969356293, 22.56052864561302, 27.104116199665228, -2.5292004443200575, 5.474442217969742, 16.12208929273741, 4.73754367974793, 18.85785798016884, 19.433403733328834, 19.977821463549105, -7.35332010544548, 21.178839409747795, 4.196517896328281, 13.7887321962538, 18.505081952559905, -18.63068888893066, 40.93026654727203, -1.5585813646578668, 3.3289862082685953, -1.9422278615199993, 9.466909308804048, 0.48165949389241547, -8.039882242977978, 20.16152736599044, -5.147464689924163, 2.3754055648872168, -5.995499064931494, 8.764097378983791, 16.855963012880352, -4.165581363163405, -8.150030342920317, 11.495982176856106, 26.828498064313685, -4.518111869506868, 1.172297915908306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3928582301574821, "mean_inference_ms": 0.9763703775934843, "mean_action_processing_ms": 0.16669169503364878, "mean_env_wait_ms": 0.058362746725789866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003656625747680664, "StateBufferConnector_ms": 0.002745509147644043, "ViewRequirementAgentConnector_ms": 0.07399213314056396}, "num_episodes": 27, "episode_return_max": 195.948696958116, "episode_return_min": -88.13814751958247, "episode_return_mean": 29.81446928679314}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.6468151106203, "num_env_steps_trained_throughput_per_sec": 491.6468151106203, "timesteps_total": 692000, "num_env_steps_sampled_lifetime": 692000, "num_agent_steps_sampled_lifetime": 2076000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2076000, "timers": {"training_iteration_time_ms": 8149.09, "restore_workers_time_ms": 0.02, "training_step_time_ms": 8149.033, "sample_time_ms": 790.572, "learn_time_ms": 7345.875, "learn_throughput": 544.523, "synch_weights_time_ms": 11.898}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000}, "done": false, "training_iteration": 173, "trial_id": "eaa30_00000", "date": "2024-08-09_18-04-10", "timestamp": 1723241050, "time_this_iter_s": 8.140223026275635, "time_total_s": 1421.2100188732147, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781ecee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1421.2100188732147, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 26.63333333333333, "ram_util_percent": 81.09166666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.501215000001212, "cur_kl_coeff": 0.3901185287127361, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.0286176826588065, "policy_loss": -0.014697111934847223, "vf_loss": 5.0309759903206395, "vf_explained_var": 0.16968645876046842, "kl": 0.03162833828843696, "entropy": 0.38982362598969195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.09104058407247, "cur_kl_coeff": 0.47506503776762615, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.26410128424565, "policy_loss": 0.018409944367400993, "vf_loss": 7.222760156790415, "vf_explained_var": 0.15639848647018273, "kl": 0.048269511935844396, "entropy": 1.0009906648347775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 166560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000}, "env_runners": {"episode_reward_max": 195.948696958116, "episode_reward_min": -88.13814751958247, "episode_reward_mean": 25.925028576570504, "episode_len_mean": 170.96, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 17096, "policy_reward_min": {"agent_policy": -44.06907375979124, "adversary_policy": -36.083529426628026}, "policy_reward_max": {"agent_policy": 97.97434847905802, "adversary_policy": 55.60501004298182}, "policy_reward_mean": {"agent_policy": 12.962514288285254, "adversary_policy": 6.481257144142626}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.41119369286926, 55.05134527911814, 164.0722382596169, 148.24464851451785, 19.3003096606583, 145.95217016213212, -15.287570405809038, 63.21365999394707, 72.19564653594469, -59.20655902032094, 12.191276906605545, 23.68725368826884, -40.675796846296905, 0.35809512743137617, 81.37560247678448, -46.478329457120665, 4.615917500719853, 43.889871971602766, 42.003565728054866, 9.271164931932448, -10.575415049258424, 33.96334860312072, 57.74076159506984, -38.54212187055292, -73.8134025739133, -17.252907867926467, -31.027689118518936, 109.06108888879142, 34.337771269718466, 122.02767734890688, -47.324002870699815, 30.27570505270755, -8.67833017303468, -49.12318979156038, 12.875254892677624, 102.01202830530417, 62.97702506620142, 47.49366958010535, -46.97392158899052, 4.751363859332287, 19.327670876752492, -24.18088881213533, -22.48454499749497, -4.18377996280234, 47.425061862670105, 33.198429657013094, 12.935495328902366, 32.252985762648606, -6.777522022054853, 47.317206605075775, -88.13814751958247, 43.421375682561845, 42.207580862861406, 195.948696958116, 112.37274474152849, 9.859795401965734, 24.4041867997783, 24.096337358429697, -75.31846360944978, -9.153766674551555, 99.3292896905565, 5.890483547299368, 41.71926594497067, 76.5825234269954, 25.249002716207265, 50.75071461215215, 64.5876282976274, 44.59915531668278, 3.540809687221377, 15.049362894568123, -15.116445498171103, 30.028125352132555, -7.240187000088554, 51.24012078372829, -24.631223412167532, 76.64896048233956, -6.691627907197152, -25.726843550282055, -21.91282298287124, 65.12651519915674, 73.30010458547405, -48.06829552541814, 55.21193383404608, 7.941841065765246, -16.210735932692998, 29.797306650024098, 21.489416573841922, 34.64690407715996, 18.247393475954595, 6.975618386192675, 46.70858721741055, -38.44670723511628, -21.890415310709884, 59.661068392557596, -17.91631514710575, 98.51237859186494, 2.4505283076093036, 87.88738874818665, 51.33675614750926, 88.92442059526581], "episode_lengths": [158, 200, 54, 81, 200, 200, 200, 158, 151, 200, 169, 200, 200, 200, 200, 200, 200, 24, 200, 76, 200, 200, 23, 200, 200, 200, 200, 160, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 160, 138, 200, 200, 200, 95, 200, 74, 200, 27, 176, 62, 200, 200, 190, 200, 200, 200, 200, 200, 137, 16, 200, 200, 200, 33, 200, 200, 200, 171, 200, 200, 200, 200, 200, 200, 200, 92, 200, 200, 189, 200, 181, 200, 200, 200, 43, 12, 49, 200, 200, 200, 165, 197, 200, 168, 152, 115], "policy_agent_policy_reward": [35.205596846434624, 27.52567263955907, 82.03611912980844, 74.12232425725895, 9.65015483032915, 72.97608508106609, -7.643785202904445, 31.60682999697353, 36.09782326797234, -29.60327951016048, 6.095638453302758, 11.84362684413442, -20.337898423148438, 0.17904756371568809, 40.68780123839226, -23.23916472856036, 2.3079587503599335, 21.944935985801383, 21.001782864027426, 4.635582465966219, -5.287707524629212, 16.981674301560357, 28.870380797534917, -19.271060935276466, -36.906701286956675, -8.626453933963269, -15.513844559259418, 54.53054444439566, 17.168885634859233, 61.0138386744534, -23.662001435349893, 15.137852526353775, -4.339165086517292, -24.561594895780175, 6.437627446338844, 51.006014152652085, 31.48851253310071, 23.746834790052652, -23.486960794495296, 2.3756819296661504, 9.663835438376246, -12.090444406067697, -11.242272498747482, -2.091889981401156, 23.712530931335056, 16.59921482850655, 6.467747664451203, 16.126492881324307, -3.3887610110274338, 23.658603302537887, -44.06907375979124, 21.710687841280937, 21.10379043143071, 97.97434847905802, 56.18637237076425, 4.929897700982874, 12.202093399889158, 12.048168679214847, -37.65923180472484, -4.576883337275776, 49.664644845278254, 2.945241773649684, 20.859632972485336, 38.291261713497676, 12.62450135810362, 25.375357306076076, 32.29381414881371, 22.29957765834138, 1.7704048436107427, 7.5246814472840455, -7.558222749085562, 15.014062676066278, -3.620093500044277, 25.620060391864143, -12.315611706083729, 38.3244802411698, -3.3458139535985616, -12.863421775140992, -10.956411491435592, 32.56325759957837, 36.650052292737016, -24.034147762709054, 27.60596691702304, 3.9709205328826016, -8.105367966346492, 14.898653325012038, 10.744708286920961, 17.323452038579976, 9.123696737977298, 3.4878091930963375, 23.354293608705277, -19.223353617558125, -10.945207655354928, 29.830534196278798, -8.958157573552871, 49.256189295932465, 1.2252641538046376, 43.94369437409331, 25.668378073754646, 44.46221029763291], "policy_adversary_policy_reward": [23.46295431145995, 11.742642534974683, 30.861297048358182, -3.335624408799113, 30.731568904144346, 51.304550225664116, 30.46002143577242, 43.66230282148652, 2.436485761597744, 7.213669068731406, 46.583286284565546, 26.392798796500532, -10.54781790858922, 2.904032705684772, 20.984627737956856, 10.622202259016671, 4.568845033692902, 31.528978234279453, -15.837404265600355, -13.76587524456015, 24.970148095775894, -18.87450964247314, 8.191429462954687, 3.6521973811797324, 7.953703425509566, -28.29160184865801, 16.747546828092126, -16.568499264376435, 27.75586368335154, 12.931937555040712, -16.70438181087645, -6.534782917683895, 1.6943289684037772, 0.6136297819561563, 5.024797690522313, 16.920138295279074, 8.834751282972032, 12.167031581055394, 2.7947047206040834, 1.8408777453621354, -2.6198934361710613, -2.667814088458151, -2.052804500468408, 19.034478802028765, 3.134163659002784, 25.736217138532133, -5.628674302942471, -13.642386632333988, -15.192642531967877, -21.7140587549888, 3.1129413584946093, -11.739395292457882, 20.569684867368608, -36.083529426628026, 22.822105472386763, 31.708438972008896, 18.32410580786102, -1.155220173001787, 26.598993798567847, 34.41484487588555, -7.343696736957183, -16.318304698392726, 6.177134429554236, 8.960718096799539, 12.394954176423187, -16.734119262940485, -14.26457666497005, -10.297018230810128, 3.8290570166048816, 2.608570429733959, 24.064687814693116, 26.941326337958962, 13.930653491994438, 17.557859041106276, 17.068314331595566, 6.6785204584570845, -8.722041678791161, -14.764919115704132, 2.2743386413399573, 0.10134328832619133, -12.615149486269548, 22.278984924645798, 1.974410015472177, -14.06485442153987, 17.361166302083426, -28.603438800830897, 8.386368002909174, -10.478257984310332, 24.20026377347078, -0.4877328421357241, 22.153022480288712, -5.5538076517821615, 30.251793501660046, -23.784045837208836, -16.463110411367115, 32.58960329269142, -3.84898437455071, 0.46022336352327997, 7.489404507310913, 16.169198795226976, -23.222249916743635, -20.846823843047602, -5.200881556935155, 26.91156939821609, 17.977227155567714, 3.1265632758630044, 55.60501004298182, 42.36933843607621, 17.688733431508957, 38.49763893925531, -4.918672802791246, 9.848570503774123, 22.897955455377478, -10.69586205548832, -2.3712197464467017, 14.419388425661552, -25.455229849687207, -12.204001955037633, 4.521585632080511, -9.098468969356293, 22.56052864561302, 27.104116199665228, -2.5292004443200575, 5.474442217969742, 16.12208929273741, 4.73754367974793, 18.85785798016884, 19.433403733328834, 19.977821463549105, -7.35332010544548, 21.178839409747795, 4.196517896328281, 13.7887321962538, 18.505081952559905, -18.63068888893066, 40.93026654727203, -1.5585813646578668, 3.3289862082685953, -1.9422278615199993, 9.466909308804048, 0.48165949389241547, -8.039882242977978, 20.16152736599044, -5.147464689924163, 2.3754055648872168, -5.995499064931494, 8.764097378983791, 16.855963012880352, -4.165581363163405, -8.150030342920317, 11.495982176856106, 26.828498064313685, -4.518111869506868, 1.172297915908306, -22.120920401037093, 9.257498625896108, -12.272600395994967, 1.3161889045593718, 17.870769795729412, 14.692487803848966, 3.1079953006061203, 33.542056992130895, -6.630037559479533, -17.404110203229532, 12.319164379995541, 15.286802537027498, -1.5875546267598146, 5.55847515964242, -26.560434626799562, 18.45506666045307, -1.2082760230979979, 16.106929348110036, 7.153696258566953, 3.591012028354008, 2.1646187783572266, 15.15883326022275, 22.72675483736044, -13.603058099383144, -10.189002771461066, 13.676811964557404, -17.237468254835072, 40.59176186354035, -6.782738554601988, -12.440615062956102, 6.875076902101554, -17.820284557456482, 14.681006294331219, 15.149527901947579, 18.29659672850482, -27.25475430205769, 29.59051183909587, 19.665677456836598, 10.327248359717998, -9.10198420591336, 38.93678949693938, 5.006904877153936, 5.721537319809631, 19.94684075394502, 14.708987057570258, 29.753223240062642]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3930386419939909, "mean_inference_ms": 0.9765640119103574, "mean_action_processing_ms": 0.16662276523197236, "mean_env_wait_ms": 0.05838441706514649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036128759384155273, "StateBufferConnector_ms": 0.002696394920349121, "ViewRequirementAgentConnector_ms": 0.07414567470550537}, "num_episodes": 23, "episode_return_max": 195.948696958116, "episode_return_min": -88.13814751958247, "episode_return_mean": 25.925028576570504}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.5725913405667, "num_env_steps_trained_throughput_per_sec": 500.5725913405667, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 2088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2088000, "timers": {"training_iteration_time_ms": 8123.447, "restore_workers_time_ms": 0.02, "training_step_time_ms": 8123.391, "sample_time_ms": 785.57, "learn_time_ms": 7325.267, "learn_throughput": 546.055, "synch_weights_time_ms": 11.867}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000}, "done": false, "training_iteration": 174, "trial_id": "eaa30_00000", "date": "2024-08-09_18-04-18", "timestamp": 1723241058, "time_this_iter_s": 7.99440598487854, "time_total_s": 1429.2044248580933, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781bf280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1429.2044248580933, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 26.15454545454546, "ram_util_percent": 80.60909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.007498933020091, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.956655647514989, "policy_loss": 0.0021592795501448334, "vf_loss": 4.944905665438011, "vf_explained_var": 0.3230938201228147, "kl": 0.016389363258584307, "entropy": 0.33962367859782366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.96241883089145, "cur_kl_coeff": 0.712597556651439, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.139725074668726, "policy_loss": 0.01099364382729012, "vf_loss": 7.097740358114242, "vf_explained_var": 0.05311673513303201, "kl": 0.043490343011217195, "entropy": 1.0374855724473795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 167520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000}, "env_runners": {"episode_reward_max": 195.948696958116, "episode_reward_min": -88.13814751958247, "episode_reward_mean": 22.74354669648265, "episode_len_mean": 171.39, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 17139, "policy_reward_min": {"agent_policy": -44.06907375979124, "adversary_policy": -36.083529426628026}, "policy_reward_max": {"agent_policy": 97.97434847905802, "adversary_policy": 55.60501004298182}, "policy_reward_mean": {"agent_policy": 11.371773348241325, "adversary_policy": 5.685886674120662}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73.8134025739133, -17.252907867926467, -31.027689118518936, 109.06108888879142, 34.337771269718466, 122.02767734890688, -47.324002870699815, 30.27570505270755, -8.67833017303468, -49.12318979156038, 12.875254892677624, 102.01202830530417, 62.97702506620142, 47.49366958010535, -46.97392158899052, 4.751363859332287, 19.327670876752492, -24.18088881213533, -22.48454499749497, -4.18377996280234, 47.425061862670105, 33.198429657013094, 12.935495328902366, 32.252985762648606, -6.777522022054853, 47.317206605075775, -88.13814751958247, 43.421375682561845, 42.207580862861406, 195.948696958116, 112.37274474152849, 9.859795401965734, 24.4041867997783, 24.096337358429697, -75.31846360944978, -9.153766674551555, 99.3292896905565, 5.890483547299368, 41.71926594497067, 76.5825234269954, 25.249002716207265, 50.75071461215215, 64.5876282976274, 44.59915531668278, 3.540809687221377, 15.049362894568123, -15.116445498171103, 30.028125352132555, -7.240187000088554, 51.24012078372829, -24.631223412167532, 76.64896048233956, -6.691627907197152, -25.726843550282055, -21.91282298287124, 65.12651519915674, 73.30010458547405, -48.06829552541814, 55.21193383404608, 7.941841065765246, -16.210735932692998, 29.797306650024098, 21.489416573841922, 34.64690407715996, 18.247393475954595, 6.975618386192675, 46.70858721741055, -38.44670723511628, -21.890415310709884, 59.661068392557596, -17.91631514710575, 98.51237859186494, 2.4505283076093036, 87.88738874818665, 51.33675614750926, 88.92442059526581, -68.48473157918235, -3.280162099915529, -2.52619378397268, 13.99509066271052, 14.457423916541497, -55.28431799447115, 10.272579471646045, 12.53641883853252, 32.66312118802085, 29.0505354248426, 44.57054725612356, 19.721728703076607, 8.408164772024207, 109.22636491727289, 45.61695885988311, -55.39927337222099, -14.444666273153338, 11.795693655299374, -1.684660426445653, 129.65723324668411, 67.82568666646951, 75.3984090083982, 156.70315941049859, -62.17102049841199], "episode_lengths": [200, 200, 200, 160, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 160, 138, 200, 200, 200, 95, 200, 74, 200, 27, 176, 62, 200, 200, 190, 200, 200, 200, 200, 200, 137, 16, 200, 200, 200, 33, 200, 200, 200, 171, 200, 200, 200, 200, 200, 200, 200, 92, 200, 200, 189, 200, 181, 200, 200, 200, 43, 12, 49, 200, 200, 200, 165, 197, 200, 168, 152, 115, 200, 200, 48, 200, 112, 200, 145, 200, 90, 200, 200, 200, 200, 200, 97, 200, 200, 200, 200, 200, 82, 49, 114, 200], "policy_agent_policy_reward": [-36.906701286956675, -8.626453933963269, -15.513844559259418, 54.53054444439566, 17.168885634859233, 61.0138386744534, -23.662001435349893, 15.137852526353775, -4.339165086517292, -24.561594895780175, 6.437627446338844, 51.006014152652085, 31.48851253310071, 23.746834790052652, -23.486960794495296, 2.3756819296661504, 9.663835438376246, -12.090444406067697, -11.242272498747482, -2.091889981401156, 23.712530931335056, 16.59921482850655, 6.467747664451203, 16.126492881324307, -3.3887610110274338, 23.658603302537887, -44.06907375979124, 21.710687841280937, 21.10379043143071, 97.97434847905802, 56.18637237076425, 4.929897700982874, 12.202093399889158, 12.048168679214847, -37.65923180472484, -4.576883337275776, 49.664644845278254, 2.945241773649684, 20.859632972485336, 38.291261713497676, 12.62450135810362, 25.375357306076076, 32.29381414881371, 22.29957765834138, 1.7704048436107427, 7.5246814472840455, -7.558222749085562, 15.014062676066278, -3.620093500044277, 25.620060391864143, -12.315611706083729, 38.3244802411698, -3.3458139535985616, -12.863421775140992, -10.956411491435592, 32.56325759957837, 36.650052292737016, -24.034147762709054, 27.60596691702304, 3.9709205328826016, -8.105367966346492, 14.898653325012038, 10.744708286920961, 17.323452038579976, 9.123696737977298, 3.4878091930963375, 23.354293608705277, -19.223353617558125, -10.945207655354928, 29.830534196278798, -8.958157573552871, 49.256189295932465, 1.2252641538046376, 43.94369437409331, 25.668378073754646, 44.46221029763291, -34.24236578959118, -1.6400810499577645, -1.26309689198634, 6.99754533135525, 7.228711958270749, -27.642158997235573, 5.136289735823027, 6.26820941926626, 16.33156059401043, 14.525267712421297, 22.285273628061777, 9.8608643515383, 4.204082386012104, 54.613182458636444, 22.808479429941546, -27.699636686110463, -7.222333136576669, 5.89784682764968, -0.8423302132228123, 64.82861662334201, 33.91284333323476, 37.69920450419912, 78.3515797052493, -31.08551024920598], "policy_adversary_policy_reward": [-15.192642531967877, -21.7140587549888, 3.1129413584946093, -11.739395292457882, 20.569684867368608, -36.083529426628026, 22.822105472386763, 31.708438972008896, 18.32410580786102, -1.155220173001787, 26.598993798567847, 34.41484487588555, -7.343696736957183, -16.318304698392726, 6.177134429554236, 8.960718096799539, 12.394954176423187, -16.734119262940485, -14.26457666497005, -10.297018230810128, 3.8290570166048816, 2.608570429733959, 24.064687814693116, 26.941326337958962, 13.930653491994438, 17.557859041106276, 17.068314331595566, 6.6785204584570845, -8.722041678791161, -14.764919115704132, 2.2743386413399573, 0.10134328832619133, -12.615149486269548, 22.278984924645798, 1.974410015472177, -14.06485442153987, 17.361166302083426, -28.603438800830897, 8.386368002909174, -10.478257984310332, 24.20026377347078, -0.4877328421357241, 22.153022480288712, -5.5538076517821615, 30.251793501660046, -23.784045837208836, -16.463110411367115, 32.58960329269142, -3.84898437455071, 0.46022336352327997, 7.489404507310913, 16.169198795226976, -23.222249916743635, -20.846823843047602, -5.200881556935155, 26.91156939821609, 17.977227155567714, 3.1265632758630044, 55.60501004298182, 42.36933843607621, 17.688733431508957, 38.49763893925531, -4.918672802791246, 9.848570503774123, 22.897955455377478, -10.69586205548832, -2.3712197464467017, 14.419388425661552, -25.455229849687207, -12.204001955037633, 4.521585632080511, -9.098468969356293, 22.56052864561302, 27.104116199665228, -2.5292004443200575, 5.474442217969742, 16.12208929273741, 4.73754367974793, 18.85785798016884, 19.433403733328834, 19.977821463549105, -7.35332010544548, 21.178839409747795, 4.196517896328281, 13.7887321962538, 18.505081952559905, -18.63068888893066, 40.93026654727203, -1.5585813646578668, 3.3289862082685953, -1.9422278615199993, 9.466909308804048, 0.48165949389241547, -8.039882242977978, 20.16152736599044, -5.147464689924163, 2.3754055648872168, -5.995499064931494, 8.764097378983791, 16.855963012880352, -4.165581363163405, -8.150030342920317, 11.495982176856106, 26.828498064313685, -4.518111869506868, 1.172297915908306, -22.120920401037093, 9.257498625896108, -12.272600395994967, 1.3161889045593718, 17.870769795729412, 14.692487803848966, 3.1079953006061203, 33.542056992130895, -6.630037559479533, -17.404110203229532, 12.319164379995541, 15.286802537027498, -1.5875546267598146, 5.55847515964242, -26.560434626799562, 18.45506666045307, -1.2082760230979979, 16.106929348110036, 7.153696258566953, 3.591012028354008, 2.1646187783572266, 15.15883326022275, 22.72675483736044, -13.603058099383144, -10.189002771461066, 13.676811964557404, -17.237468254835072, 40.59176186354035, -6.782738554601988, -12.440615062956102, 6.875076902101554, -17.820284557456482, 14.681006294331219, 15.149527901947579, 18.29659672850482, -27.25475430205769, 29.59051183909587, 19.665677456836598, 10.327248359717998, -9.10198420591336, 38.93678949693938, 5.006904877153936, 5.721537319809631, 19.94684075394502, 14.708987057570258, 29.753223240062642, -13.85085898800454, -20.391506801586644, -4.443784765651635, 2.803703715693871, -27.664188141833705, 26.40109124984736, 5.762408826129892, 1.2351365052253573, -6.017695452373154, 13.2464074106439, 7.5631701831985225, -35.20532918043408, -5.998472196580295, 11.13476193240332, 31.086994766219142, -24.818785346952883, 4.0561570859426, 12.275403508067829, 7.9916786701027505, 6.533589042318546, 18.22641299253344, 4.058860635528337, 13.623199020009146, -3.762334668470846, 2.6287362927008573, 1.5753460933112464, 21.26971574100028, 33.34346671763616, 26.45636469954369, -3.6478852696021526, -12.074705980332176, -15.624930705778294, 0.40726755767790834, -7.629600694254577, -18.848393855824405, 24.746240683474092, 0.7241608881678232, -1.5664911013906355, 30.88329129872325, 33.94532532461879, 31.687819614451886, 2.2250237187828787, 10.032110199830786, 27.66709430436833, 36.366173919754694, 41.98540578549462, -16.34434898125979, -14.74116126794619]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3932242843277568, "mean_inference_ms": 0.9774798965160835, "mean_action_processing_ms": 0.16668663738933842, "mean_env_wait_ms": 0.058440530234507515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035774707794189453, "StateBufferConnector_ms": 0.0027506351470947266, "ViewRequirementAgentConnector_ms": 0.07432591915130615}, "num_episodes": 24, "episode_return_max": 195.948696958116, "episode_return_min": -88.13814751958247, "episode_return_mean": 22.74354669648265}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.2056699804365, "num_env_steps_trained_throughput_per_sec": 494.2056699804365, "timesteps_total": 700000, "num_env_steps_sampled_lifetime": 700000, "num_agent_steps_sampled_lifetime": 2100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2100000, "timers": {"training_iteration_time_ms": 8119.308, "restore_workers_time_ms": 0.019, "training_step_time_ms": 8119.254, "sample_time_ms": 781.362, "learn_time_ms": 7325.172, "learn_throughput": 546.062, "synch_weights_time_ms": 12.03}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000}, "done": false, "training_iteration": 175, "trial_id": "eaa30_00000", "date": "2024-08-09_18-04-26", "timestamp": 1723241066, "time_this_iter_s": 8.098887205123901, "time_total_s": 1437.3033120632172, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781bf5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1437.3033120632172, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 25.316666666666666, "ram_util_percent": 80.325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.638294480591224, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.444585170569243, "policy_loss": -0.000256397184132347, "vf_loss": 4.441616733742769, "vf_explained_var": 0.329645768643687, "kl": 0.005510889569965127, "entropy": 0.28102977939699064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.77034537071983, "cur_kl_coeff": 1.068896334977158, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.256359432637692, "policy_loss": -0.002645268374180887, "vf_loss": 6.242979387442271, "vf_explained_var": 0.2662221486990651, "kl": 0.01499242281667345, "entropy": 1.0245806159451605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 168480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "env_runners": {"episode_reward_max": 195.948696958116, "episode_reward_min": -88.13814751958247, "episode_reward_mean": 24.4131308402585, "episode_len_mean": 166.24, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 16624, "policy_reward_min": {"agent_policy": -44.06907375979124, "adversary_policy": -42.36798975708148}, "policy_reward_max": {"agent_policy": 97.97434847905802, "adversary_policy": 55.60501004298182}, "policy_reward_mean": {"agent_policy": 12.206565420129252, "adversary_policy": 6.103282710064626}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.317206605075775, -88.13814751958247, 43.421375682561845, 42.207580862861406, 195.948696958116, 112.37274474152849, 9.859795401965734, 24.4041867997783, 24.096337358429697, -75.31846360944978, -9.153766674551555, 99.3292896905565, 5.890483547299368, 41.71926594497067, 76.5825234269954, 25.249002716207265, 50.75071461215215, 64.5876282976274, 44.59915531668278, 3.540809687221377, 15.049362894568123, -15.116445498171103, 30.028125352132555, -7.240187000088554, 51.24012078372829, -24.631223412167532, 76.64896048233956, -6.691627907197152, -25.726843550282055, -21.91282298287124, 65.12651519915674, 73.30010458547405, -48.06829552541814, 55.21193383404608, 7.941841065765246, -16.210735932692998, 29.797306650024098, 21.489416573841922, 34.64690407715996, 18.247393475954595, 6.975618386192675, 46.70858721741055, -38.44670723511628, -21.890415310709884, 59.661068392557596, -17.91631514710575, 98.51237859186494, 2.4505283076093036, 87.88738874818665, 51.33675614750926, 88.92442059526581, -68.48473157918235, -3.280162099915529, -2.52619378397268, 13.99509066271052, 14.457423916541497, -55.28431799447115, 10.272579471646045, 12.53641883853252, 32.66312118802085, 29.0505354248426, 44.57054725612356, 19.721728703076607, 8.408164772024207, 109.22636491727289, 45.61695885988311, -55.39927337222099, -14.444666273153338, 11.795693655299374, -1.684660426445653, 129.65723324668411, 67.82568666646951, 75.3984090083982, 156.70315941049859, -62.17102049841199, 35.83215767911051, 48.54316366118094, 50.05514113215921, -29.384304724249674, -25.17667636295323, -1.656961791376446, 71.36403565001149, 31.888729851850954, 12.624271308372068, -81.37772902025307, 58.610034600714734, 112.70808772397756, 37.93084952390858, 11.516781776725718, 36.14788468051227, 0.2769402943870616, 50.36691408064532, -57.3438369121282, -17.15278584770708, 9.129425951913074, 28.07968268786906, 74.76008558208554, 10.869393233418414, -1.7460932901726807, 39.224270880183305], "episode_lengths": [74, 200, 27, 176, 62, 200, 200, 190, 200, 200, 200, 200, 200, 137, 16, 200, 200, 200, 33, 200, 200, 200, 171, 200, 200, 200, 200, 200, 200, 200, 92, 200, 200, 189, 200, 181, 200, 200, 200, 43, 12, 49, 200, 200, 200, 165, 197, 200, 168, 152, 115, 200, 200, 48, 200, 112, 200, 145, 200, 90, 200, 200, 200, 200, 200, 97, 200, 200, 200, 200, 200, 82, 49, 114, 200, 53, 172, 200, 200, 200, 200, 200, 200, 200, 200, 200, 43, 200, 200, 12, 1, 200, 200, 200, 200, 157, 200, 200, 200, 200], "policy_agent_policy_reward": [23.658603302537887, -44.06907375979124, 21.710687841280937, 21.10379043143071, 97.97434847905802, 56.18637237076425, 4.929897700982874, 12.202093399889158, 12.048168679214847, -37.65923180472484, -4.576883337275776, 49.664644845278254, 2.945241773649684, 20.859632972485336, 38.291261713497676, 12.62450135810362, 25.375357306076076, 32.29381414881371, 22.29957765834138, 1.7704048436107427, 7.5246814472840455, -7.558222749085562, 15.014062676066278, -3.620093500044277, 25.620060391864143, -12.315611706083729, 38.3244802411698, -3.3458139535985616, -12.863421775140992, -10.956411491435592, 32.56325759957837, 36.650052292737016, -24.034147762709054, 27.60596691702304, 3.9709205328826016, -8.105367966346492, 14.898653325012038, 10.744708286920961, 17.323452038579976, 9.123696737977298, 3.4878091930963375, 23.354293608705277, -19.223353617558125, -10.945207655354928, 29.830534196278798, -8.958157573552871, 49.256189295932465, 1.2252641538046376, 43.94369437409331, 25.668378073754646, 44.46221029763291, -34.24236578959118, -1.6400810499577645, -1.26309689198634, 6.99754533135525, 7.228711958270749, -27.642158997235573, 5.136289735823027, 6.26820941926626, 16.33156059401043, 14.525267712421297, 22.285273628061777, 9.8608643515383, 4.204082386012104, 54.613182458636444, 22.808479429941546, -27.699636686110463, -7.222333136576669, 5.89784682764968, -0.8423302132228123, 64.82861662334201, 33.91284333323476, 37.69920450419912, 78.3515797052493, -31.08551024920598, 17.91607883955528, 24.271581830590463, 25.027570566079557, -14.692152362124844, -12.588338181476583, -0.828480895688223, 35.68201782500573, 15.94436492592548, 6.312135654186026, -40.68886451012653, 29.305017300357388, 56.3540438619888, 18.965424761954296, 5.75839088836286, 18.073942340256135, 0.1384701471935308, 25.183457040322658, -28.67191845606404, -8.576392923853554, 4.564712975956551, 14.039841343934519, 37.38004279104281, 5.434696616709223, -0.8730466450863261, 19.61213544009165], "policy_adversary_policy_reward": [7.489404507310913, 16.169198795226976, -23.222249916743635, -20.846823843047602, -5.200881556935155, 26.91156939821609, 17.977227155567714, 3.1265632758630044, 55.60501004298182, 42.36933843607621, 17.688733431508957, 38.49763893925531, -4.918672802791246, 9.848570503774123, 22.897955455377478, -10.69586205548832, -2.3712197464467017, 14.419388425661552, -25.455229849687207, -12.204001955037633, 4.521585632080511, -9.098468969356293, 22.56052864561302, 27.104116199665228, -2.5292004443200575, 5.474442217969742, 16.12208929273741, 4.73754367974793, 18.85785798016884, 19.433403733328834, 19.977821463549105, -7.35332010544548, 21.178839409747795, 4.196517896328281, 13.7887321962538, 18.505081952559905, -18.63068888893066, 40.93026654727203, -1.5585813646578668, 3.3289862082685953, -1.9422278615199993, 9.466909308804048, 0.48165949389241547, -8.039882242977978, 20.16152736599044, -5.147464689924163, 2.3754055648872168, -5.995499064931494, 8.764097378983791, 16.855963012880352, -4.165581363163405, -8.150030342920317, 11.495982176856106, 26.828498064313685, -4.518111869506868, 1.172297915908306, -22.120920401037093, 9.257498625896108, -12.272600395994967, 1.3161889045593718, 17.870769795729412, 14.692487803848966, 3.1079953006061203, 33.542056992130895, -6.630037559479533, -17.404110203229532, 12.319164379995541, 15.286802537027498, -1.5875546267598146, 5.55847515964242, -26.560434626799562, 18.45506666045307, -1.2082760230979979, 16.106929348110036, 7.153696258566953, 3.591012028354008, 2.1646187783572266, 15.15883326022275, 22.72675483736044, -13.603058099383144, -10.189002771461066, 13.676811964557404, -17.237468254835072, 40.59176186354035, -6.782738554601988, -12.440615062956102, 6.875076902101554, -17.820284557456482, 14.681006294331219, 15.149527901947579, 18.29659672850482, -27.25475430205769, 29.59051183909587, 19.665677456836598, 10.327248359717998, -9.10198420591336, 38.93678949693938, 5.006904877153936, 5.721537319809631, 19.94684075394502, 14.708987057570258, 29.753223240062642, -13.85085898800454, -20.391506801586644, -4.443784765651635, 2.803703715693871, -27.664188141833705, 26.40109124984736, 5.762408826129892, 1.2351365052253573, -6.017695452373154, 13.2464074106439, 7.5631701831985225, -35.20532918043408, -5.998472196580295, 11.13476193240332, 31.086994766219142, -24.818785346952883, 4.0561570859426, 12.275403508067829, 7.9916786701027505, 6.533589042318546, 18.22641299253344, 4.058860635528337, 13.623199020009146, -3.762334668470846, 2.6287362927008573, 1.5753460933112464, 21.26971574100028, 33.34346671763616, 26.45636469954369, -3.6478852696021526, -12.074705980332176, -15.624930705778294, 0.40726755767790834, -7.629600694254577, -18.848393855824405, 24.746240683474092, 0.7241608881678232, -1.5664911013906355, 30.88329129872325, 33.94532532461879, 31.687819614451886, 2.2250237187828787, 10.032110199830786, 27.66709430436833, 36.366173919754694, 41.98540578549462, -16.34434898125979, -14.74116126794619, 36.01029273464955, -18.094213895094278, 11.228730484800144, 13.042851345790323, 21.7614517389101, 3.266118827169457, 27.675837394956638, -42.36798975708148, -17.69459677394003, 5.106258592463449, -3.505916438562373, 2.67743554287415, 28.0598134323862, 7.622204392619533, 8.731516527699679, 7.212848398225802, -16.679723266859828, 22.991858921045853, -21.24759920762946, -19.441265302497065, 18.008424454636224, 11.296592845721158, 22.409316238532945, 33.94472762345585, 26.624534247545007, -7.659109485590715, 8.962964932353966, -3.204574043991105, 2.7926631227442122, 15.281279217511923, 0.010315531441769776, 0.12815461575176101, 18.750412392944877, 6.433044647377782, -5.887701344556408, -22.784217111507644, -3.915993888952311, -4.660399034901246, 4.289671033637886, 0.27504194231866563, 9.563308876415043, 4.476532467519476, 17.745996601413097, 19.634046189629707, -23.366096283382632, 28.80079290009185, -3.42442645286895, 2.5513798077826237, 21.936025633476298, -2.323890193384649]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39324412477122267, "mean_inference_ms": 0.977360949977104, "mean_action_processing_ms": 0.16659540116103777, "mean_env_wait_ms": 0.05845980084004662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033353567123413086, "StateBufferConnector_ms": 0.002782106399536133, "ViewRequirementAgentConnector_ms": 0.06924331188201904}, "num_episodes": 25, "episode_return_max": 195.948696958116, "episode_return_min": -88.13814751958247, "episode_return_mean": 24.4131308402585}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.25878418704684, "num_env_steps_trained_throughput_per_sec": 499.25878418704684, "timesteps_total": 704000, "num_env_steps_sampled_lifetime": 704000, "num_agent_steps_sampled_lifetime": 2112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2112000, "timers": {"training_iteration_time_ms": 8086.492, "restore_workers_time_ms": 0.019, "training_step_time_ms": 8086.438, "sample_time_ms": 778.649, "learn_time_ms": 7295.078, "learn_throughput": 548.315, "synch_weights_time_ms": 11.969}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "done": false, "training_iteration": 176, "trial_id": "eaa30_00000", "date": "2024-08-09_18-04-34", "timestamp": 1723241074, "time_this_iter_s": 8.017245054244995, "time_total_s": 1445.3205571174622, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781bfc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1445.3205571174622, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 24.091666666666665, "ram_util_percent": 80.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.916114778115006, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.42019888761813, "policy_loss": 0.0006235160874744887, "vf_loss": 4.413554572932934, "vf_explained_var": 0.38438061617669605, "kl": 0.010288826595479377, "entropy": 0.3118986227209606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.07316137899955, "cur_kl_coeff": 1.068896334977158, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.665110484759013, "policy_loss": 0.01512856245196114, "vf_loss": 6.6245960056781765, "vf_explained_var": 0.07193144137660662, "kl": 0.02374966362064394, "entropy": 0.9684012848262985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 169440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000}, "env_runners": {"episode_reward_max": 156.70315941049859, "episode_reward_min": -100.32607312301488, "episode_reward_mean": 26.46165718021185, "episode_len_mean": 167.24, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 16724, "policy_reward_min": {"agent_policy": -50.16303656150748, "adversary_policy": -42.36798975708148}, "policy_reward_max": {"agent_policy": 78.3515797052493, "adversary_policy": 43.92581038161869}, "policy_reward_mean": {"agent_policy": 13.23082859010593, "adversary_policy": 6.615414295052965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.240187000088554, 51.24012078372829, -24.631223412167532, 76.64896048233956, -6.691627907197152, -25.726843550282055, -21.91282298287124, 65.12651519915674, 73.30010458547405, -48.06829552541814, 55.21193383404608, 7.941841065765246, -16.210735932692998, 29.797306650024098, 21.489416573841922, 34.64690407715996, 18.247393475954595, 6.975618386192675, 46.70858721741055, -38.44670723511628, -21.890415310709884, 59.661068392557596, -17.91631514710575, 98.51237859186494, 2.4505283076093036, 87.88738874818665, 51.33675614750926, 88.92442059526581, -68.48473157918235, -3.280162099915529, -2.52619378397268, 13.99509066271052, 14.457423916541497, -55.28431799447115, 10.272579471646045, 12.53641883853252, 32.66312118802085, 29.0505354248426, 44.57054725612356, 19.721728703076607, 8.408164772024207, 109.22636491727289, 45.61695885988311, -55.39927337222099, -14.444666273153338, 11.795693655299374, -1.684660426445653, 129.65723324668411, 67.82568666646951, 75.3984090083982, 156.70315941049859, -62.17102049841199, 35.83215767911051, 48.54316366118094, 50.05514113215921, -29.384304724249674, -25.17667636295323, -1.656961791376446, 71.36403565001149, 31.888729851850954, 12.624271308372068, -81.37772902025307, 58.610034600714734, 112.70808772397756, 37.93084952390858, 11.516781776725718, 36.14788468051227, 0.2769402943870616, 50.36691408064532, -57.3438369121282, -17.15278584770708, 9.129425951913074, 28.07968268786906, 74.76008558208554, 10.869393233418414, -1.7460932901726807, 39.224270880183305, 13.160499754502524, 130.23209355044736, 92.49275450216263, 102.96616123200192, 116.22463914119557, -5.178501490066061, 99.47891096570842, -7.5349749926317315, 85.77943651319521, 36.8939624141171, 16.022866721732264, 30.11999282585478, 38.67323003784769, 107.88258666090098, 53.34527125402686, 33.659665583648604, 22.57597677359981, 34.3121020564993, -100.32607312301488, 27.73295895409808, -50.76294305930844, 52.60234982160152, 43.727130492191904], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 92, 200, 200, 189, 200, 181, 200, 200, 200, 43, 12, 49, 200, 200, 200, 165, 197, 200, 168, 152, 115, 200, 200, 48, 200, 112, 200, 145, 200, 90, 200, 200, 200, 200, 200, 97, 200, 200, 200, 200, 200, 82, 49, 114, 200, 53, 172, 200, 200, 200, 200, 200, 200, 200, 200, 200, 43, 200, 200, 12, 1, 200, 200, 200, 200, 157, 200, 200, 200, 200, 50, 57, 200, 64, 59, 173, 200, 165, 155, 200, 200, 200, 200, 166, 97, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-3.620093500044277, 25.620060391864143, -12.315611706083729, 38.3244802411698, -3.3458139535985616, -12.863421775140992, -10.956411491435592, 32.56325759957837, 36.650052292737016, -24.034147762709054, 27.60596691702304, 3.9709205328826016, -8.105367966346492, 14.898653325012038, 10.744708286920961, 17.323452038579976, 9.123696737977298, 3.4878091930963375, 23.354293608705277, -19.223353617558125, -10.945207655354928, 29.830534196278798, -8.958157573552871, 49.256189295932465, 1.2252641538046376, 43.94369437409331, 25.668378073754646, 44.46221029763291, -34.24236578959118, -1.6400810499577645, -1.26309689198634, 6.99754533135525, 7.228711958270749, -27.642158997235573, 5.136289735823027, 6.26820941926626, 16.33156059401043, 14.525267712421297, 22.285273628061777, 9.8608643515383, 4.204082386012104, 54.613182458636444, 22.808479429941546, -27.699636686110463, -7.222333136576669, 5.89784682764968, -0.8423302132228123, 64.82861662334201, 33.91284333323476, 37.69920450419912, 78.3515797052493, -31.08551024920598, 17.91607883955528, 24.271581830590463, 25.027570566079557, -14.692152362124844, -12.588338181476583, -0.828480895688223, 35.68201782500573, 15.94436492592548, 6.312135654186026, -40.68886451012653, 29.305017300357388, 56.3540438619888, 18.965424761954296, 5.75839088836286, 18.073942340256135, 0.1384701471935308, 25.183457040322658, -28.67191845606404, -8.576392923853554, 4.564712975956551, 14.039841343934519, 37.38004279104281, 5.434696616709223, -0.8730466450863261, 19.61213544009165, 6.580249877251264, 65.11604677522368, 46.24637725108131, 51.48308061600096, 58.11231957059778, -2.58925074503302, 49.73945548285422, -3.767487496315855, 42.889718256597575, 18.44698120705856, 8.011433360866132, 15.05999641292739, 19.336615018923858, 53.94129333045048, 26.672635627013413, 16.829832791824295, 11.28798838679991, 17.156051028249642, -50.16303656150748, 13.86647947704904, -25.3814715296542, 26.301174910800764, 21.863565246095956], "policy_adversary_policy_reward": [2.3754055648872168, -5.995499064931494, 8.764097378983791, 16.855963012880352, -4.165581363163405, -8.150030342920317, 11.495982176856106, 26.828498064313685, -4.518111869506868, 1.172297915908306, -22.120920401037093, 9.257498625896108, -12.272600395994967, 1.3161889045593718, 17.870769795729412, 14.692487803848966, 3.1079953006061203, 33.542056992130895, -6.630037559479533, -17.404110203229532, 12.319164379995541, 15.286802537027498, -1.5875546267598146, 5.55847515964242, -26.560434626799562, 18.45506666045307, -1.2082760230979979, 16.106929348110036, 7.153696258566953, 3.591012028354008, 2.1646187783572266, 15.15883326022275, 22.72675483736044, -13.603058099383144, -10.189002771461066, 13.676811964557404, -17.237468254835072, 40.59176186354035, -6.782738554601988, -12.440615062956102, 6.875076902101554, -17.820284557456482, 14.681006294331219, 15.149527901947579, 18.29659672850482, -27.25475430205769, 29.59051183909587, 19.665677456836598, 10.327248359717998, -9.10198420591336, 38.93678949693938, 5.006904877153936, 5.721537319809631, 19.94684075394502, 14.708987057570258, 29.753223240062642, -13.85085898800454, -20.391506801586644, -4.443784765651635, 2.803703715693871, -27.664188141833705, 26.40109124984736, 5.762408826129892, 1.2351365052253573, -6.017695452373154, 13.2464074106439, 7.5631701831985225, -35.20532918043408, -5.998472196580295, 11.13476193240332, 31.086994766219142, -24.818785346952883, 4.0561570859426, 12.275403508067829, 7.9916786701027505, 6.533589042318546, 18.22641299253344, 4.058860635528337, 13.623199020009146, -3.762334668470846, 2.6287362927008573, 1.5753460933112464, 21.26971574100028, 33.34346671763616, 26.45636469954369, -3.6478852696021526, -12.074705980332176, -15.624930705778294, 0.40726755767790834, -7.629600694254577, -18.848393855824405, 24.746240683474092, 0.7241608881678232, -1.5664911013906355, 30.88329129872325, 33.94532532461879, 31.687819614451886, 2.2250237187828787, 10.032110199830786, 27.66709430436833, 36.366173919754694, 41.98540578549462, -16.34434898125979, -14.74116126794619, 36.01029273464955, -18.094213895094278, 11.228730484800144, 13.042851345790323, 21.7614517389101, 3.266118827169457, 27.675837394956638, -42.36798975708148, -17.69459677394003, 5.106258592463449, -3.505916438562373, 2.67743554287415, 28.0598134323862, 7.622204392619533, 8.731516527699679, 7.212848398225802, -16.679723266859828, 22.991858921045853, -21.24759920762946, -19.441265302497065, 18.008424454636224, 11.296592845721158, 22.409316238532945, 33.94472762345585, 26.624534247545007, -7.659109485590715, 8.962964932353966, -3.204574043991105, 2.7926631227442122, 15.281279217511923, 0.010315531441769776, 0.12815461575176101, 18.750412392944877, 6.433044647377782, -5.887701344556408, -22.784217111507644, -3.915993888952311, -4.660399034901246, 4.289671033637886, 0.27504194231866563, 9.563308876415043, 4.476532467519476, 17.745996601413097, 19.634046189629707, -23.366096283382632, 28.80079290009185, -3.42442645286895, 2.5513798077826237, 21.936025633476298, -2.323890193384649, 1.0205343538324412, 5.559715523418822, 28.438567838144728, 36.67747893707896, 30.16208807429271, 16.0842891767886, 7.557270234382273, 43.92581038161869, 16.778981985436715, 41.3333375851611, 32.172100872173196, -34.76135161720621, 16.60747594692598, 33.13197953592824, -18.647978361258705, 14.880490864942846, -0.9204294506955364, 43.81014770729311, 23.13217107294176, -4.685189865883199, 3.352334231402331, 4.659099129463801, 5.396762227630198, 9.663234185297192, 6.761816459001899, 12.574798559921957, 21.67282521672537, 32.26846811372511, -2.5126347239930453, 29.18527035100645, 13.252855593026723, 3.5769771987975805, 17.73326708633607, -6.445278699536157, 20.146783585243057, -2.9907325569934144, -26.285477359540604, -23.87755920196688, 5.665286987529733, 8.201192489519308, -8.50987849894452, -16.87159303070968, 28.85812165641758, -2.5569467456168162, 7.036910631602989, 14.826654614492966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39327755797268077, "mean_inference_ms": 0.9777797840035748, "mean_action_processing_ms": 0.16660636722644998, "mean_env_wait_ms": 0.05846277611404177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032749176025390625, "StateBufferConnector_ms": 0.0025968551635742188, "ViewRequirementAgentConnector_ms": 0.06882131099700928}, "num_episodes": 23, "episode_return_max": 156.70315941049859, "episode_return_min": -100.32607312301488, "episode_return_mean": 26.46165718021185}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 481.72799409747955, "num_env_steps_trained_throughput_per_sec": 481.72799409747955, "timesteps_total": 708000, "num_env_steps_sampled_lifetime": 708000, "num_agent_steps_sampled_lifetime": 2124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2124000, "timers": {"training_iteration_time_ms": 8107.843, "restore_workers_time_ms": 0.019, "training_step_time_ms": 8107.79, "sample_time_ms": 810.717, "learn_time_ms": 7284.606, "learn_throughput": 549.103, "synch_weights_time_ms": 11.682}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000}, "done": false, "training_iteration": 177, "trial_id": "eaa30_00000", "date": "2024-08-09_18-04-43", "timestamp": 1723241083, "time_this_iter_s": 8.30852198600769, "time_total_s": 1453.6290791034698, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781ecee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1453.6290791034698, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 27.275000000000006, "ram_util_percent": 79.01666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.581256976455608, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.3540957931488276, "policy_loss": -0.00032493411033616336, "vf_loss": 4.352006536186057, "vf_explained_var": 0.34017880098529596, "kl": 0.004125567647276161, "entropy": 0.2592587560415268, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 59.2495591049393, "cur_kl_coeff": 1.603344502465738, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.843702577302853, "policy_loss": 0.0014829173480393365, "vf_loss": 5.820063083867232, "vf_explained_var": 0.2900961519529422, "kl": 0.013818976434413344, "entropy": 0.9494172984113296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 170400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000}, "env_runners": {"episode_reward_max": 156.70315941049859, "episode_reward_min": -100.32607312301488, "episode_reward_mean": 24.24870312357264, "episode_len_mean": 169.99, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 16999, "policy_reward_min": {"agent_policy": -50.16303656150748, "adversary_policy": -42.36798975708148}, "policy_reward_max": {"agent_policy": 78.3515797052493, "adversary_policy": 43.92581038161869}, "policy_reward_mean": {"agent_policy": 12.12435156178632, "adversary_policy": 6.06217578089316}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.91631514710575, 98.51237859186494, 2.4505283076093036, 87.88738874818665, 51.33675614750926, 88.92442059526581, -68.48473157918235, -3.280162099915529, -2.52619378397268, 13.99509066271052, 14.457423916541497, -55.28431799447115, 10.272579471646045, 12.53641883853252, 32.66312118802085, 29.0505354248426, 44.57054725612356, 19.721728703076607, 8.408164772024207, 109.22636491727289, 45.61695885988311, -55.39927337222099, -14.444666273153338, 11.795693655299374, -1.684660426445653, 129.65723324668411, 67.82568666646951, 75.3984090083982, 156.70315941049859, -62.17102049841199, 35.83215767911051, 48.54316366118094, 50.05514113215921, -29.384304724249674, -25.17667636295323, -1.656961791376446, 71.36403565001149, 31.888729851850954, 12.624271308372068, -81.37772902025307, 58.610034600714734, 112.70808772397756, 37.93084952390858, 11.516781776725718, 36.14788468051227, 0.2769402943870616, 50.36691408064532, -57.3438369121282, -17.15278584770708, 9.129425951913074, 28.07968268786906, 74.76008558208554, 10.869393233418414, -1.7460932901726807, 39.224270880183305, 13.160499754502524, 130.23209355044736, 92.49275450216263, 102.96616123200192, 116.22463914119557, -5.178501490066061, 99.47891096570842, -7.5349749926317315, 85.77943651319521, 36.8939624141171, 16.022866721732264, 30.11999282585478, 38.67323003784769, 107.88258666090098, 53.34527125402686, 33.659665583648604, 22.57597677359981, 34.3121020564993, -100.32607312301488, 27.73295895409808, -50.76294305930844, 52.60234982160152, 43.727130492191904, 51.94059562278545, -19.331891522413514, 53.650215373085956, -23.005449964958075, 11.654721749873246, -80.99441126965343, -8.893338753422789, 64.04700370829714, 41.970469377182255, 10.842068513235674, 58.29095213437722, -13.172939767567783, -4.129632625071039, 10.894927248232023, -75.26955047847056, -28.57584087475687, -24.88831167467324, 38.169588464581025, -18.06778873654018, 65.22553698502637, 46.01734211825482, -41.492759424217454], "episode_lengths": [165, 197, 200, 168, 152, 115, 200, 200, 48, 200, 112, 200, 145, 200, 90, 200, 200, 200, 200, 200, 97, 200, 200, 200, 200, 200, 82, 49, 114, 200, 53, 172, 200, 200, 200, 200, 200, 200, 200, 200, 200, 43, 200, 200, 12, 1, 200, 200, 200, 200, 157, 200, 200, 200, 200, 50, 57, 200, 64, 59, 173, 200, 165, 155, 200, 200, 200, 200, 166, 97, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 83, 200, 200, 200, 140, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200], "policy_agent_policy_reward": [-8.958157573552871, 49.256189295932465, 1.2252641538046376, 43.94369437409331, 25.668378073754646, 44.46221029763291, -34.24236578959118, -1.6400810499577645, -1.26309689198634, 6.99754533135525, 7.228711958270749, -27.642158997235573, 5.136289735823027, 6.26820941926626, 16.33156059401043, 14.525267712421297, 22.285273628061777, 9.8608643515383, 4.204082386012104, 54.613182458636444, 22.808479429941546, -27.699636686110463, -7.222333136576669, 5.89784682764968, -0.8423302132228123, 64.82861662334201, 33.91284333323476, 37.69920450419912, 78.3515797052493, -31.08551024920598, 17.91607883955528, 24.271581830590463, 25.027570566079557, -14.692152362124844, -12.588338181476583, -0.828480895688223, 35.68201782500573, 15.94436492592548, 6.312135654186026, -40.68886451012653, 29.305017300357388, 56.3540438619888, 18.965424761954296, 5.75839088836286, 18.073942340256135, 0.1384701471935308, 25.183457040322658, -28.67191845606404, -8.576392923853554, 4.564712975956551, 14.039841343934519, 37.38004279104281, 5.434696616709223, -0.8730466450863261, 19.61213544009165, 6.580249877251264, 65.11604677522368, 46.24637725108131, 51.48308061600096, 58.11231957059778, -2.58925074503302, 49.73945548285422, -3.767487496315855, 42.889718256597575, 18.44698120705856, 8.011433360866132, 15.05999641292739, 19.336615018923858, 53.94129333045048, 26.672635627013413, 16.829832791824295, 11.28798838679991, 17.156051028249642, -50.16303656150748, 13.86647947704904, -25.3814715296542, 26.301174910800764, 21.863565246095956, 25.970297811392715, -9.665945761206766, 26.825107686542978, -11.502724982479052, 5.827360874936625, -40.49720563482669, -4.446669376711419, 32.023501854148556, 20.98523468859112, 5.421034256617837, 29.145476067188618, -6.586469883783927, -2.0648163125354912, 5.447463624116036, -37.63477523923532, -14.287920437378475, -12.444155837336634, 19.08479423229051, -9.033894368270087, 32.61276849251318, 23.0086710591274, -20.746379712108727], "policy_adversary_policy_reward": [18.29659672850482, -27.25475430205769, 29.59051183909587, 19.665677456836598, 10.327248359717998, -9.10198420591336, 38.93678949693938, 5.006904877153936, 5.721537319809631, 19.94684075394502, 14.708987057570258, 29.753223240062642, -13.85085898800454, -20.391506801586644, -4.443784765651635, 2.803703715693871, -27.664188141833705, 26.40109124984736, 5.762408826129892, 1.2351365052253573, -6.017695452373154, 13.2464074106439, 7.5631701831985225, -35.20532918043408, -5.998472196580295, 11.13476193240332, 31.086994766219142, -24.818785346952883, 4.0561570859426, 12.275403508067829, 7.9916786701027505, 6.533589042318546, 18.22641299253344, 4.058860635528337, 13.623199020009146, -3.762334668470846, 2.6287362927008573, 1.5753460933112464, 21.26971574100028, 33.34346671763616, 26.45636469954369, -3.6478852696021526, -12.074705980332176, -15.624930705778294, 0.40726755767790834, -7.629600694254577, -18.848393855824405, 24.746240683474092, 0.7241608881678232, -1.5664911013906355, 30.88329129872325, 33.94532532461879, 31.687819614451886, 2.2250237187828787, 10.032110199830786, 27.66709430436833, 36.366173919754694, 41.98540578549462, -16.34434898125979, -14.74116126794619, 36.01029273464955, -18.094213895094278, 11.228730484800144, 13.042851345790323, 21.7614517389101, 3.266118827169457, 27.675837394956638, -42.36798975708148, -17.69459677394003, 5.106258592463449, -3.505916438562373, 2.67743554287415, 28.0598134323862, 7.622204392619533, 8.731516527699679, 7.212848398225802, -16.679723266859828, 22.991858921045853, -21.24759920762946, -19.441265302497065, 18.008424454636224, 11.296592845721158, 22.409316238532945, 33.94472762345585, 26.624534247545007, -7.659109485590715, 8.962964932353966, -3.204574043991105, 2.7926631227442122, 15.281279217511923, 0.010315531441769776, 0.12815461575176101, 18.750412392944877, 6.433044647377782, -5.887701344556408, -22.784217111507644, -3.915993888952311, -4.660399034901246, 4.289671033637886, 0.27504194231866563, 9.563308876415043, 4.476532467519476, 17.745996601413097, 19.634046189629707, -23.366096283382632, 28.80079290009185, -3.42442645286895, 2.5513798077826237, 21.936025633476298, -2.323890193384649, 1.0205343538324412, 5.559715523418822, 28.438567838144728, 36.67747893707896, 30.16208807429271, 16.0842891767886, 7.557270234382273, 43.92581038161869, 16.778981985436715, 41.3333375851611, 32.172100872173196, -34.76135161720621, 16.60747594692598, 33.13197953592824, -18.647978361258705, 14.880490864942846, -0.9204294506955364, 43.81014770729311, 23.13217107294176, -4.685189865883199, 3.352334231402331, 4.659099129463801, 5.396762227630198, 9.663234185297192, 6.761816459001899, 12.574798559921957, 21.67282521672537, 32.26846811372511, -2.5126347239930453, 29.18527035100645, 13.252855593026723, 3.5769771987975805, 17.73326708633607, -6.445278699536157, 20.146783585243057, -2.9907325569934144, -26.285477359540604, -23.87755920196688, 5.665286987529733, 8.201192489519308, -8.50987849894452, -16.87159303070968, 28.85812165641758, -2.5569467456168162, 7.036910631602989, 14.826654614492966, 1.625472838986152, 24.344824972406563, 12.714487162905106, -22.380432924111872, 9.916035019798066, 16.909072666744912, 24.970880306129587, -36.47360528860863, 37.85820120269633, -32.03084032775971, -33.0682804514621, -7.428925183364591, -12.268675002189283, 7.822005625477864, 23.316765947665402, 8.70673590648316, 6.737386940644859, 14.247847747946249, 7.656344162740545, -2.2353099061227084, 1.4713724330720979, 27.67410363411652, -3.6157222389643096, -2.970747644819614, 4.017955289963417, -6.082771602498912, 3.4679698951208735, 1.979493728995159, -23.501830371958253, -14.132944867277065, -9.658529135887981, -4.6293913014904895, -22.221151614135707, 9.776995776799073, -10.452501597936227, 29.537295830226743, -7.709671680575042, -1.3242226876950447, 18.12833179328431, 14.484436699228876, 20.736475911453205, 2.2721951476741964, -18.310024254974703, -2.436355457134024]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39314729048895886, "mean_inference_ms": 0.9784830453720147, "mean_action_processing_ms": 0.16672071391535642, "mean_env_wait_ms": 0.05844557631778657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032271146774291992, "StateBufferConnector_ms": 0.002562880516052246, "ViewRequirementAgentConnector_ms": 0.06466364860534668}, "num_episodes": 22, "episode_return_max": 156.70315941049859, "episode_return_min": -100.32607312301488, "episode_return_mean": 24.24870312357264}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.1136545305951, "num_env_steps_trained_throughput_per_sec": 501.1136545305951, "timesteps_total": 712000, "num_env_steps_sampled_lifetime": 712000, "num_agent_steps_sampled_lifetime": 2136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2136000, "timers": {"training_iteration_time_ms": 8111.432, "restore_workers_time_ms": 0.019, "training_step_time_ms": 8111.38, "sample_time_ms": 815.831, "learn_time_ms": 7283.165, "learn_throughput": 549.212, "synch_weights_time_ms": 11.531}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000}, "done": false, "training_iteration": 178, "trial_id": "eaa30_00000", "date": "2024-08-09_18-04-51", "timestamp": 1723241091, "time_this_iter_s": 7.986996412277222, "time_total_s": 1461.616075515747, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781bff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1461.616075515747, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 24.96363636363636, "ram_util_percent": 78.94545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.682324934005738, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.62313535188241, "policy_loss": 0.0015539724718552654, "vf_loss": 4.619568342001981, "vf_explained_var": 0.1898774612517584, "kl": 0.006880090270861589, "entropy": 0.23990704325771836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 59.51072293619315, "cur_kl_coeff": 1.603344502465738, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.109895730515321, "policy_loss": 0.0024407839320095565, "vf_loss": 6.09754703193903, "vf_explained_var": -0.022183673332134883, "kl": 0.0061795261213167885, "entropy": 0.9033112106844783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 171360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000}, "env_runners": {"episode_reward_max": 156.70315941049859, "episode_reward_min": -100.32607312301488, "episode_reward_mean": 21.95542414959898, "episode_len_mean": 168.82, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 16882, "policy_reward_min": {"agent_policy": -50.16303656150748, "adversary_policy": -42.36798975708148}, "policy_reward_max": {"agent_policy": 78.3515797052493, "adversary_policy": 49.62799140279669}, "policy_reward_mean": {"agent_policy": 10.977712074799491, "adversary_policy": 5.488856037399746}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.795693655299374, -1.684660426445653, 129.65723324668411, 67.82568666646951, 75.3984090083982, 156.70315941049859, -62.17102049841199, 35.83215767911051, 48.54316366118094, 50.05514113215921, -29.384304724249674, -25.17667636295323, -1.656961791376446, 71.36403565001149, 31.888729851850954, 12.624271308372068, -81.37772902025307, 58.610034600714734, 112.70808772397756, 37.93084952390858, 11.516781776725718, 36.14788468051227, 0.2769402943870616, 50.36691408064532, -57.3438369121282, -17.15278584770708, 9.129425951913074, 28.07968268786906, 74.76008558208554, 10.869393233418414, -1.7460932901726807, 39.224270880183305, 13.160499754502524, 130.23209355044736, 92.49275450216263, 102.96616123200192, 116.22463914119557, -5.178501490066061, 99.47891096570842, -7.5349749926317315, 85.77943651319521, 36.8939624141171, 16.022866721732264, 30.11999282585478, 38.67323003784769, 107.88258666090098, 53.34527125402686, 33.659665583648604, 22.57597677359981, 34.3121020564993, -100.32607312301488, 27.73295895409808, -50.76294305930844, 52.60234982160152, 43.727130492191904, 51.94059562278545, -19.331891522413514, 53.650215373085956, -23.005449964958075, 11.654721749873246, -80.99441126965343, -8.893338753422789, 64.04700370829714, 41.970469377182255, 10.842068513235674, 58.29095213437722, -13.172939767567783, -4.129632625071039, 10.894927248232023, -75.26955047847056, -28.57584087475687, -24.88831167467324, 38.169588464581025, -18.06778873654018, 65.22553698502637, 46.01734211825482, -41.492759424217454, 8.395265367500244, 25.352286655037815, -14.872421158074488, 109.06477975155377, -94.28613158601758, -35.441925399658075, 16.759683441510823, 39.310249023567664, -34.33939576174849, -13.556207286541479, -56.36363317246614, -54.43223173418278, 14.826577322715181, 26.556447724517874, 42.172714596231934, 124.82304052654112, -62.15922012137595, 52.835273899465726, -15.926767241043786, 20.352438494902586, 50.91243046432868, 55.25259480322635, 17.731000143731656], "episode_lengths": [200, 200, 200, 82, 49, 114, 200, 53, 172, 200, 200, 200, 200, 200, 200, 200, 200, 200, 43, 200, 200, 12, 1, 200, 200, 200, 200, 157, 200, 200, 200, 200, 50, 57, 200, 64, 59, 173, 200, 165, 155, 200, 200, 200, 200, 166, 97, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 83, 200, 200, 200, 140, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 26, 118, 200, 50, 200, 142, 200, 200, 200], "policy_agent_policy_reward": [5.89784682764968, -0.8423302132228123, 64.82861662334201, 33.91284333323476, 37.69920450419912, 78.3515797052493, -31.08551024920598, 17.91607883955528, 24.271581830590463, 25.027570566079557, -14.692152362124844, -12.588338181476583, -0.828480895688223, 35.68201782500573, 15.94436492592548, 6.312135654186026, -40.68886451012653, 29.305017300357388, 56.3540438619888, 18.965424761954296, 5.75839088836286, 18.073942340256135, 0.1384701471935308, 25.183457040322658, -28.67191845606404, -8.576392923853554, 4.564712975956551, 14.039841343934519, 37.38004279104281, 5.434696616709223, -0.8730466450863261, 19.61213544009165, 6.580249877251264, 65.11604677522368, 46.24637725108131, 51.48308061600096, 58.11231957059778, -2.58925074503302, 49.73945548285422, -3.767487496315855, 42.889718256597575, 18.44698120705856, 8.011433360866132, 15.05999641292739, 19.336615018923858, 53.94129333045048, 26.672635627013413, 16.829832791824295, 11.28798838679991, 17.156051028249642, -50.16303656150748, 13.86647947704904, -25.3814715296542, 26.301174910800764, 21.863565246095956, 25.970297811392715, -9.665945761206766, 26.825107686542978, -11.502724982479052, 5.827360874936625, -40.49720563482669, -4.446669376711419, 32.023501854148556, 20.98523468859112, 5.421034256617837, 29.145476067188618, -6.586469883783927, -2.0648163125354912, 5.447463624116036, -37.63477523923532, -14.287920437378475, -12.444155837336634, 19.08479423229051, -9.033894368270087, 32.61276849251318, 23.0086710591274, -20.746379712108727, 4.197632683750115, 12.67614332751891, -7.436210579037244, 54.53238987577691, -47.14306579300881, -17.720962699829037, 8.379841720755428, 19.655124511783846, -17.169697880874214, -6.778103643270729, -28.18181658623302, -27.216115867091347, 7.413288661357591, 13.278223862258933, 21.086357298115956, 62.41152026327053, -31.079610060687983, 26.417636949732852, -7.963383620521849, 10.176219247451293, 25.456215232164347, 27.626297401613186, 8.865500071865814], "policy_adversary_policy_reward": [-18.848393855824405, 24.746240683474092, 0.7241608881678232, -1.5664911013906355, 30.88329129872325, 33.94532532461879, 31.687819614451886, 2.2250237187828787, 10.032110199830786, 27.66709430436833, 36.366173919754694, 41.98540578549462, -16.34434898125979, -14.74116126794619, 36.01029273464955, -18.094213895094278, 11.228730484800144, 13.042851345790323, 21.7614517389101, 3.266118827169457, 27.675837394956638, -42.36798975708148, -17.69459677394003, 5.106258592463449, -3.505916438562373, 2.67743554287415, 28.0598134323862, 7.622204392619533, 8.731516527699679, 7.212848398225802, -16.679723266859828, 22.991858921045853, -21.24759920762946, -19.441265302497065, 18.008424454636224, 11.296592845721158, 22.409316238532945, 33.94472762345585, 26.624534247545007, -7.659109485590715, 8.962964932353966, -3.204574043991105, 2.7926631227442122, 15.281279217511923, 0.010315531441769776, 0.12815461575176101, 18.750412392944877, 6.433044647377782, -5.887701344556408, -22.784217111507644, -3.915993888952311, -4.660399034901246, 4.289671033637886, 0.27504194231866563, 9.563308876415043, 4.476532467519476, 17.745996601413097, 19.634046189629707, -23.366096283382632, 28.80079290009185, -3.42442645286895, 2.5513798077826237, 21.936025633476298, -2.323890193384649, 1.0205343538324412, 5.559715523418822, 28.438567838144728, 36.67747893707896, 30.16208807429271, 16.0842891767886, 7.557270234382273, 43.92581038161869, 16.778981985436715, 41.3333375851611, 32.172100872173196, -34.76135161720621, 16.60747594692598, 33.13197953592824, -18.647978361258705, 14.880490864942846, -0.9204294506955364, 43.81014770729311, 23.13217107294176, -4.685189865883199, 3.352334231402331, 4.659099129463801, 5.396762227630198, 9.663234185297192, 6.761816459001899, 12.574798559921957, 21.67282521672537, 32.26846811372511, -2.5126347239930453, 29.18527035100645, 13.252855593026723, 3.5769771987975805, 17.73326708633607, -6.445278699536157, 20.146783585243057, -2.9907325569934144, -26.285477359540604, -23.87755920196688, 5.665286987529733, 8.201192489519308, -8.50987849894452, -16.87159303070968, 28.85812165641758, -2.5569467456168162, 7.036910631602989, 14.826654614492966, 1.625472838986152, 24.344824972406563, 12.714487162905106, -22.380432924111872, 9.916035019798066, 16.909072666744912, 24.970880306129587, -36.47360528860863, 37.85820120269633, -32.03084032775971, -33.0682804514621, -7.428925183364591, -12.268675002189283, 7.822005625477864, 23.316765947665402, 8.70673590648316, 6.737386940644859, 14.247847747946249, 7.656344162740545, -2.2353099061227084, 1.4713724330720979, 27.67410363411652, -3.6157222389643096, -2.970747644819614, 4.017955289963417, -6.082771602498912, 3.4679698951208735, 1.979493728995159, -23.501830371958253, -14.132944867277065, -9.658529135887981, -4.6293913014904895, -22.221151614135707, 9.776995776799073, -10.452501597936227, 29.537295830226743, -7.709671680575042, -1.3242226876950447, 18.12833179328431, 14.484436699228876, 20.736475911453205, 2.2721951476741964, -18.310024254974703, -2.436355457134024, 12.55128850574604, -8.353655821995908, -7.809286599713161, 20.48542992723207, 3.7737333808051545, -11.209943959842402, 21.8656693147229, 32.66672056105401, -29.322868798943468, -17.82019699406534, -9.689923346454894, -8.031039353374144, 14.013707644369333, -5.633865923613913, 8.49879065928567, 11.156333852498177, -9.79906636268174, -7.370631518192489, 2.464209546233138, -9.242313189503868, -17.850304584548574, -10.331512001684438, -3.191050423944695, -24.02506544314666, 8.761966511923298, -1.3486778505657089, 10.505043291148827, 2.7731805711101067, -4.865528433049803, 25.951885731165763, 49.62799140279669, 12.783528860473835, -5.624293309165994, -25.455316751521984, 15.768225017192659, 10.649411932540193, -1.5925971811139252, -6.3707864394079206, 42.89059230196594, -32.714373054514645, 31.682357898187565, -6.226142666023225, 20.155092634218814, 7.471204767394372, -2.0915660282232835, 10.957066100089094]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3930368382821278, "mean_inference_ms": 0.9787493452713945, "mean_action_processing_ms": 0.1667266728162965, "mean_env_wait_ms": 0.05842002533369021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033391714096069336, "StateBufferConnector_ms": 0.0024809837341308594, "ViewRequirementAgentConnector_ms": 0.0642094612121582}, "num_episodes": 23, "episode_return_max": 156.70315941049859, "episode_return_min": -100.32607312301488, "episode_return_mean": 21.95542414959898}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.15385939429956, "num_env_steps_trained_throughput_per_sec": 504.15385939429956, "timesteps_total": 716000, "num_env_steps_sampled_lifetime": 716000, "num_agent_steps_sampled_lifetime": 2148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2148000, "timers": {"training_iteration_time_ms": 8117.4, "restore_workers_time_ms": 0.019, "training_step_time_ms": 8117.348, "sample_time_ms": 814.685, "learn_time_ms": 7290.184, "learn_throughput": 548.683, "synch_weights_time_ms": 11.624}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000}, "done": false, "training_iteration": 179, "trial_id": "eaa30_00000", "date": "2024-08-09_18-04-59", "timestamp": 1723241099, "time_this_iter_s": 7.938591003417969, "time_total_s": 1469.554666519165, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17819f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1469.554666519165, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 23.91666666666666, "ram_util_percent": 78.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.754610101003495, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.486754447820956, "policy_loss": -0.00017598682851900185, "vf_loss": 5.486505593193902, "vf_explained_var": 0.11345783834734922, "kl": 0.0014519905364732185, "entropy": 0.2537836668037233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.88280977482597, "cur_kl_coeff": 1.603344502465738, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.539180605113506, "policy_loss": 0.004472694055827257, "vf_loss": 6.522201056281726, "vf_explained_var": 0.21493467669934035, "kl": 0.007800469802168664, "entropy": 0.8778543666005134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 172320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 145.40007274059406, "episode_reward_min": -100.32607312301488, "episode_reward_mean": 20.907734769307073, "episode_len_mean": 170.76, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 17076, "policy_reward_min": {"agent_policy": -50.16303656150748, "adversary_policy": -36.47360528860863}, "policy_reward_max": {"agent_policy": 72.70003637029704, "adversary_policy": 49.62799140279669}, "policy_reward_mean": {"agent_policy": 10.453867384653538, "adversary_policy": 5.22693369232677}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-57.3438369121282, -17.15278584770708, 9.129425951913074, 28.07968268786906, 74.76008558208554, 10.869393233418414, -1.7460932901726807, 39.224270880183305, 13.160499754502524, 130.23209355044736, 92.49275450216263, 102.96616123200192, 116.22463914119557, -5.178501490066061, 99.47891096570842, -7.5349749926317315, 85.77943651319521, 36.8939624141171, 16.022866721732264, 30.11999282585478, 38.67323003784769, 107.88258666090098, 53.34527125402686, 33.659665583648604, 22.57597677359981, 34.3121020564993, -100.32607312301488, 27.73295895409808, -50.76294305930844, 52.60234982160152, 43.727130492191904, 51.94059562278545, -19.331891522413514, 53.650215373085956, -23.005449964958075, 11.654721749873246, -80.99441126965343, -8.893338753422789, 64.04700370829714, 41.970469377182255, 10.842068513235674, 58.29095213437722, -13.172939767567783, -4.129632625071039, 10.894927248232023, -75.26955047847056, -28.57584087475687, -24.88831167467324, 38.169588464581025, -18.06778873654018, 65.22553698502637, 46.01734211825482, -41.492759424217454, 8.395265367500244, 25.352286655037815, -14.872421158074488, 109.06477975155377, -94.28613158601758, -35.441925399658075, 16.759683441510823, 39.310249023567664, -34.33939576174849, -13.556207286541479, -56.36363317246614, -54.43223173418278, 14.826577322715181, 26.556447724517874, 42.172714596231934, 124.82304052654112, -62.15922012137595, 52.835273899465726, -15.926767241043786, 20.352438494902586, 50.91243046432868, 55.25259480322635, 17.731000143731656, 97.05162791428471, 66.49151138443011, 62.0474397467011, 76.71415254737326, 1.1123810717926297, 25.16895826307063, 86.37084521765158, 86.39610292347825, -65.59508895058104, 122.54073298241093, 145.40007274059406, 45.88999390004353, -94.13210187363333, 9.81536441762887, -34.098272979906454, -0.8965123373427843, 69.9028370459697, 14.828549556559643, 14.907048652824479, 27.13472801314743, -30.485379821123942, -17.375846658730374, -43.18433698629883, 27.02007632768172], "episode_lengths": [200, 200, 200, 157, 200, 200, 200, 200, 50, 57, 200, 64, 59, 173, 200, 165, 155, 200, 200, 200, 200, 166, 97, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 83, 200, 200, 200, 140, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 26, 118, 200, 50, 200, 142, 200, 200, 200, 170, 28, 81, 97, 1, 200, 197, 167, 200, 200, 42, 176, 200, 200, 200, 200, 195, 200, 166, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [-28.67191845606404, -8.576392923853554, 4.564712975956551, 14.039841343934519, 37.38004279104281, 5.434696616709223, -0.8730466450863261, 19.61213544009165, 6.580249877251264, 65.11604677522368, 46.24637725108131, 51.48308061600096, 58.11231957059778, -2.58925074503302, 49.73945548285422, -3.767487496315855, 42.889718256597575, 18.44698120705856, 8.011433360866132, 15.05999641292739, 19.336615018923858, 53.94129333045048, 26.672635627013413, 16.829832791824295, 11.28798838679991, 17.156051028249642, -50.16303656150748, 13.86647947704904, -25.3814715296542, 26.301174910800764, 21.863565246095956, 25.970297811392715, -9.665945761206766, 26.825107686542978, -11.502724982479052, 5.827360874936625, -40.49720563482669, -4.446669376711419, 32.023501854148556, 20.98523468859112, 5.421034256617837, 29.145476067188618, -6.586469883783927, -2.0648163125354912, 5.447463624116036, -37.63477523923532, -14.287920437378475, -12.444155837336634, 19.08479423229051, -9.033894368270087, 32.61276849251318, 23.0086710591274, -20.746379712108727, 4.197632683750115, 12.67614332751891, -7.436210579037244, 54.53238987577691, -47.14306579300881, -17.720962699829037, 8.379841720755428, 19.655124511783846, -17.169697880874214, -6.778103643270729, -28.18181658623302, -27.216115867091347, 7.413288661357591, 13.278223862258933, 21.086357298115956, 62.41152026327053, -31.079610060687983, 26.417636949732852, -7.963383620521849, 10.176219247451293, 25.456215232164347, 27.626297401613186, 8.865500071865814, 48.52581395714237, 33.245755692215056, 31.023719873350533, 38.35707627368659, 0.5561905358963148, 12.584479131535296, 43.18542260882576, 43.198051461739176, -32.797544475290536, 61.270366491205465, 72.70003637029704, 22.944996950021757, -47.06605093681658, 4.907682208814446, -17.04913648995323, -0.4482561686713815, 34.95141852298485, 7.414274778279829, 7.453524326412237, 13.567364006573715, -15.242689910561928, -8.687923329365201, -21.592168493149437, 13.510038163840871], "policy_adversary_policy_reward": [-5.887701344556408, -22.784217111507644, -3.915993888952311, -4.660399034901246, 4.289671033637886, 0.27504194231866563, 9.563308876415043, 4.476532467519476, 17.745996601413097, 19.634046189629707, -23.366096283382632, 28.80079290009185, -3.42442645286895, 2.5513798077826237, 21.936025633476298, -2.323890193384649, 1.0205343538324412, 5.559715523418822, 28.438567838144728, 36.67747893707896, 30.16208807429271, 16.0842891767886, 7.557270234382273, 43.92581038161869, 16.778981985436715, 41.3333375851611, 32.172100872173196, -34.76135161720621, 16.60747594692598, 33.13197953592824, -18.647978361258705, 14.880490864942846, -0.9204294506955364, 43.81014770729311, 23.13217107294176, -4.685189865883199, 3.352334231402331, 4.659099129463801, 5.396762227630198, 9.663234185297192, 6.761816459001899, 12.574798559921957, 21.67282521672537, 32.26846811372511, -2.5126347239930453, 29.18527035100645, 13.252855593026723, 3.5769771987975805, 17.73326708633607, -6.445278699536157, 20.146783585243057, -2.9907325569934144, -26.285477359540604, -23.87755920196688, 5.665286987529733, 8.201192489519308, -8.50987849894452, -16.87159303070968, 28.85812165641758, -2.5569467456168162, 7.036910631602989, 14.826654614492966, 1.625472838986152, 24.344824972406563, 12.714487162905106, -22.380432924111872, 9.916035019798066, 16.909072666744912, 24.970880306129587, -36.47360528860863, 37.85820120269633, -32.03084032775971, -33.0682804514621, -7.428925183364591, -12.268675002189283, 7.822005625477864, 23.316765947665402, 8.70673590648316, 6.737386940644859, 14.247847747946249, 7.656344162740545, -2.2353099061227084, 1.4713724330720979, 27.67410363411652, -3.6157222389643096, -2.970747644819614, 4.017955289963417, -6.082771602498912, 3.4679698951208735, 1.979493728995159, -23.501830371958253, -14.132944867277065, -9.658529135887981, -4.6293913014904895, -22.221151614135707, 9.776995776799073, -10.452501597936227, 29.537295830226743, -7.709671680575042, -1.3242226876950447, 18.12833179328431, 14.484436699228876, 20.736475911453205, 2.2721951476741964, -18.310024254974703, -2.436355457134024, 12.55128850574604, -8.353655821995908, -7.809286599713161, 20.48542992723207, 3.7737333808051545, -11.209943959842402, 21.8656693147229, 32.66672056105401, -29.322868798943468, -17.82019699406534, -9.689923346454894, -8.031039353374144, 14.013707644369333, -5.633865923613913, 8.49879065928567, 11.156333852498177, -9.79906636268174, -7.370631518192489, 2.464209546233138, -9.242313189503868, -17.850304584548574, -10.331512001684438, -3.191050423944695, -24.02506544314666, 8.761966511923298, -1.3486778505657089, 10.505043291148827, 2.7731805711101067, -4.865528433049803, 25.951885731165763, 49.62799140279669, 12.783528860473835, -5.624293309165994, -25.455316751521984, 15.768225017192659, 10.649411932540193, -1.5925971811139252, -6.3707864394079206, 42.89059230196594, -32.714373054514645, 31.682357898187565, -6.226142666023225, 20.155092634218814, 7.471204767394372, -2.0915660282232835, 10.957066100089094, 28.44083349607164, 20.084980461070725, 22.022663686139275, 11.22309200607578, -0.4955022666366631, 31.519222139987196, 37.12651928669406, 1.2305569869925161, 1.3323328101903176, -0.7761422742940027, 5.460500878811871, 7.123978252723426, 9.95350172678464, 33.23192088204112, 2.746518118225282, 40.45153334351388, -28.519830262703167, -4.277714212587334, 37.550660919546345, 23.719705571659134, 44.518937125944134, 28.181099244352918, 12.00707513893973, 10.937921811082031, -36.20897052702354, -10.857080409793056, 9.14763288523707, -4.239950676422627, -10.72726919212904, -6.321867297824188, -26.374317221334806, 25.926061052663428, 14.827573480541314, 20.123845042443534, 2.9372185366234618, 4.477056241656367, 9.231981528115, -1.7784572017027607, -0.3631256882219631, 13.930489694795678, -12.245860162937035, -2.996829747624913, -28.428395445475545, 19.74047211611035, -3.489126332066675, -18.10304216108276, 10.776372042259567, 2.7336661215813045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3931645478954489, "mean_inference_ms": 0.9792410503873462, "mean_action_processing_ms": 0.16685250901316145, "mean_env_wait_ms": 0.058452557608079964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545522689819336, "StateBufferConnector_ms": 0.002491474151611328, "ViewRequirementAgentConnector_ms": 0.06491386890411377}, "num_episodes": 24, "episode_return_max": 145.40007274059406, "episode_return_min": -100.32607312301488, "episode_return_mean": 20.907734769307073}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.66337376759236, "num_env_steps_trained_throughput_per_sec": 501.66337376759236, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 8120.433, "restore_workers_time_ms": 0.019, "training_step_time_ms": 8120.381, "sample_time_ms": 819.142, "learn_time_ms": 7288.58, "learn_throughput": 548.804, "synch_weights_time_ms": 11.804}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 180, "trial_id": "eaa30_00000", "date": "2024-08-09_18-05-07", "timestamp": 1723241107, "time_this_iter_s": 7.9790239334106445, "time_total_s": 1477.5336904525757, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17819f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1477.5336904525757, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 24.6, "ram_util_percent": 78.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.334413003164624, "cur_kl_coeff": 0.14629444826727606, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.61363485515433, "policy_loss": -0.0033504264852988025, "vf_loss": 4.616472643519205, "vf_explained_var": 0.16376460226124556, "kl": 0.003504138294497761, "entropy": 0.28587734780456653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 61.36942230289181, "cur_kl_coeff": 1.603344502465738, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.996515532334645, "policy_loss": 0.001982133173199448, "vf_loss": 5.987333513299624, "vf_explained_var": 0.18459567725658416, "kl": 0.00449054650113491, "entropy": 0.880185144332548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 173280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000}, "env_runners": {"episode_reward_max": 145.40007274059406, "episode_reward_min": -100.32607312301488, "episode_reward_mean": 17.709660742102816, "episode_len_mean": 174.12, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 17412, "policy_reward_min": {"agent_policy": -50.16303656150748, "adversary_policy": -36.47360528860863}, "policy_reward_max": {"agent_policy": 72.70003637029704, "adversary_policy": 49.62799140279669}, "policy_reward_mean": {"agent_policy": 8.854830371051408, "adversary_policy": 4.427415185525704}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.57597677359981, 34.3121020564993, -100.32607312301488, 27.73295895409808, -50.76294305930844, 52.60234982160152, 43.727130492191904, 51.94059562278545, -19.331891522413514, 53.650215373085956, -23.005449964958075, 11.654721749873246, -80.99441126965343, -8.893338753422789, 64.04700370829714, 41.970469377182255, 10.842068513235674, 58.29095213437722, -13.172939767567783, -4.129632625071039, 10.894927248232023, -75.26955047847056, -28.57584087475687, -24.88831167467324, 38.169588464581025, -18.06778873654018, 65.22553698502637, 46.01734211825482, -41.492759424217454, 8.395265367500244, 25.352286655037815, -14.872421158074488, 109.06477975155377, -94.28613158601758, -35.441925399658075, 16.759683441510823, 39.310249023567664, -34.33939576174849, -13.556207286541479, -56.36363317246614, -54.43223173418278, 14.826577322715181, 26.556447724517874, 42.172714596231934, 124.82304052654112, -62.15922012137595, 52.835273899465726, -15.926767241043786, 20.352438494902586, 50.91243046432868, 55.25259480322635, 17.731000143731656, 97.05162791428471, 66.49151138443011, 62.0474397467011, 76.71415254737326, 1.1123810717926297, 25.16895826307063, 86.37084521765158, 86.39610292347825, -65.59508895058104, 122.54073298241093, 145.40007274059406, 45.88999390004353, -94.13210187363333, 9.81536441762887, -34.098272979906454, -0.8965123373427843, 69.9028370459697, 14.828549556559643, 14.907048652824479, 27.13472801314743, -30.485379821123942, -17.375846658730374, -43.18433698629883, 27.02007632768172, -2.5467731286696385, -39.9041225042415, 83.5429837690227, -12.651517519355323, 68.39696331454854, 53.44594051624958, 38.53630924064356, 85.01418029295621, 121.38004047007269, -72.44001532546346, 27.267111195813456, -25.462594865038184, 7.940689239415089, 82.09253750467548, 3.4922829056001774, 4.925614124391522, 52.924735957325325, -48.32045923795741, 39.016763357843615, 50.17104796983734, 15.7100571628633, 78.9361841495218, 38.60221447872735, 60.161161170897344], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 83, 200, 200, 200, 140, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 26, 118, 200, 50, 200, 142, 200, 200, 200, 170, 28, 81, 97, 1, 200, 197, 167, 200, 200, 42, 176, 200, 200, 200, 200, 195, 200, 166, 200, 200, 200, 200, 200, 200, 200, 200, 200, 51, 200, 200, 167, 154, 200, 200, 200, 41, 200, 200, 200, 200, 200, 200, 200, 200, 200, 66, 200], "policy_agent_policy_reward": [11.28798838679991, 17.156051028249642, -50.16303656150748, 13.86647947704904, -25.3814715296542, 26.301174910800764, 21.863565246095956, 25.970297811392715, -9.665945761206766, 26.825107686542978, -11.502724982479052, 5.827360874936625, -40.49720563482669, -4.446669376711419, 32.023501854148556, 20.98523468859112, 5.421034256617837, 29.145476067188618, -6.586469883783927, -2.0648163125354912, 5.447463624116036, -37.63477523923532, -14.287920437378475, -12.444155837336634, 19.08479423229051, -9.033894368270087, 32.61276849251318, 23.0086710591274, -20.746379712108727, 4.197632683750115, 12.67614332751891, -7.436210579037244, 54.53238987577691, -47.14306579300881, -17.720962699829037, 8.379841720755428, 19.655124511783846, -17.169697880874214, -6.778103643270729, -28.18181658623302, -27.216115867091347, 7.413288661357591, 13.278223862258933, 21.086357298115956, 62.41152026327053, -31.079610060687983, 26.417636949732852, -7.963383620521849, 10.176219247451293, 25.456215232164347, 27.626297401613186, 8.865500071865814, 48.52581395714237, 33.245755692215056, 31.023719873350533, 38.35707627368659, 0.5561905358963148, 12.584479131535296, 43.18542260882576, 43.198051461739176, -32.797544475290536, 61.270366491205465, 72.70003637029704, 22.944996950021757, -47.06605093681658, 4.907682208814446, -17.04913648995323, -0.4482561686713815, 34.95141852298485, 7.414274778279829, 7.453524326412237, 13.567364006573715, -15.242689910561928, -8.687923329365201, -21.592168493149437, 13.510038163840871, -1.2733865643348246, -19.95206125212075, 41.771491884511356, -6.325758759677676, 34.19848165727426, 26.722970258124775, 19.26815462032179, 42.5070901464781, 60.690020235036364, -36.22000766273173, 13.633555597906728, -12.7312974325191, 3.9703446197075447, 41.04626875233776, 1.746141452800094, 2.462807062195722, 26.462367978662666, -24.160229618978654, 19.50838167892181, 25.085523984918666, 7.8550285814316645, 39.46809207476089, 19.301107239363667, 30.080580585448665], "policy_adversary_policy_reward": [17.73326708633607, -6.445278699536157, 20.146783585243057, -2.9907325569934144, -26.285477359540604, -23.87755920196688, 5.665286987529733, 8.201192489519308, -8.50987849894452, -16.87159303070968, 28.85812165641758, -2.5569467456168162, 7.036910631602989, 14.826654614492966, 1.625472838986152, 24.344824972406563, 12.714487162905106, -22.380432924111872, 9.916035019798066, 16.909072666744912, 24.970880306129587, -36.47360528860863, 37.85820120269633, -32.03084032775971, -33.0682804514621, -7.428925183364591, -12.268675002189283, 7.822005625477864, 23.316765947665402, 8.70673590648316, 6.737386940644859, 14.247847747946249, 7.656344162740545, -2.2353099061227084, 1.4713724330720979, 27.67410363411652, -3.6157222389643096, -2.970747644819614, 4.017955289963417, -6.082771602498912, 3.4679698951208735, 1.979493728995159, -23.501830371958253, -14.132944867277065, -9.658529135887981, -4.6293913014904895, -22.221151614135707, 9.776995776799073, -10.452501597936227, 29.537295830226743, -7.709671680575042, -1.3242226876950447, 18.12833179328431, 14.484436699228876, 20.736475911453205, 2.2721951476741964, -18.310024254974703, -2.436355457134024, 12.55128850574604, -8.353655821995908, -7.809286599713161, 20.48542992723207, 3.7737333808051545, -11.209943959842402, 21.8656693147229, 32.66672056105401, -29.322868798943468, -17.82019699406534, -9.689923346454894, -8.031039353374144, 14.013707644369333, -5.633865923613913, 8.49879065928567, 11.156333852498177, -9.79906636268174, -7.370631518192489, 2.464209546233138, -9.242313189503868, -17.850304584548574, -10.331512001684438, -3.191050423944695, -24.02506544314666, 8.761966511923298, -1.3486778505657089, 10.505043291148827, 2.7731805711101067, -4.865528433049803, 25.951885731165763, 49.62799140279669, 12.783528860473835, -5.624293309165994, -25.455316751521984, 15.768225017192659, 10.649411932540193, -1.5925971811139252, -6.3707864394079206, 42.89059230196594, -32.714373054514645, 31.682357898187565, -6.226142666023225, 20.155092634218814, 7.471204767394372, -2.0915660282232835, 10.957066100089094, 28.44083349607164, 20.084980461070725, 22.022663686139275, 11.22309200607578, -0.4955022666366631, 31.519222139987196, 37.12651928669406, 1.2305569869925161, 1.3323328101903176, -0.7761422742940027, 5.460500878811871, 7.123978252723426, 9.95350172678464, 33.23192088204112, 2.746518118225282, 40.45153334351388, -28.519830262703167, -4.277714212587334, 37.550660919546345, 23.719705571659134, 44.518937125944134, 28.181099244352918, 12.00707513893973, 10.937921811082031, -36.20897052702354, -10.857080409793056, 9.14763288523707, -4.239950676422627, -10.72726919212904, -6.321867297824188, -26.374317221334806, 25.926061052663428, 14.827573480541314, 20.123845042443534, 2.9372185366234618, 4.477056241656367, 9.231981528115, -1.7784572017027607, -0.3631256882219631, 13.930489694795678, -12.245860162937035, -2.996829747624913, -28.428395445475545, 19.74047211611035, -3.489126332066675, -18.10304216108276, 10.776372042259567, 2.7336661215813045, 3.000432297339433, -4.273818861674254, -9.178623894071052, -10.77343735804971, 20.711746905737428, 21.059744978773928, 4.49677647590255, -10.822535235580226, 42.80665468259194, -8.608173025317681, 24.676310223763885, 2.0466600343609045, 24.597065833348257, -5.3289112130264655, 21.959905485590447, 20.547184660887655, 20.17062645715916, 40.5193937778772, -15.948783559993732, -20.271224102738024, 21.818264010894886, -8.184708412988158, 13.103340712797426, -25.834638145316525, 16.066156570523244, -12.0958119508157, 14.000534741631448, 27.04573401070632, 10.601760537246724, -8.85561908444663, 10.117968557220081, -7.655161495024359, 15.30470366649103, 11.157664312171637, -20.751262732893622, -3.408966886085029, 10.797085928143836, 8.711295750777964, 14.138925226327746, 10.946598758590916, 3.7849338767547387, 4.070094704676915, 33.114253463828796, 6.3538386109320975, -9.135302290047871, 28.43640952941154, 5.2302216116472575, 24.85035897380141]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39306167139629417, "mean_inference_ms": 0.9790987275496893, "mean_action_processing_ms": 0.1668045480489665, "mean_env_wait_ms": 0.05844406471157392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035338401794433594, "StateBufferConnector_ms": 0.0024319887161254883, "ViewRequirementAgentConnector_ms": 0.06335079669952393}, "num_episodes": 24, "episode_return_max": 145.40007274059406, "episode_return_min": -100.32607312301488, "episode_return_mean": 17.709660742102816}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.3011279523269, "num_env_steps_trained_throughput_per_sec": 504.3011279523269, "timesteps_total": 724000, "num_env_steps_sampled_lifetime": 724000, "num_agent_steps_sampled_lifetime": 2172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2172000, "timers": {"training_iteration_time_ms": 8112.685, "restore_workers_time_ms": 0.019, "training_step_time_ms": 8112.632, "sample_time_ms": 817.847, "learn_time_ms": 7282.109, "learn_throughput": 549.291, "synch_weights_time_ms": 11.824}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000}, "done": false, "training_iteration": 181, "trial_id": "eaa30_00000", "date": "2024-08-09_18-05-15", "timestamp": 1723241115, "time_this_iter_s": 7.937000036239624, "time_total_s": 1485.4706904888153, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17819f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1485.4706904888153, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 23.90833333333333, "ram_util_percent": 78.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.048586649995633, "cur_kl_coeff": 0.07314722413363803, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.944698413465389, "policy_loss": -0.0032096413974329907, "vf_loss": 4.945367908225489, "vf_explained_var": 0.0723317005962291, "kl": 0.03472644582060634, "entropy": 0.4267189940762898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 77.21361216927568, "cur_kl_coeff": 0.801672251232869, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.556635298331579, "policy_loss": -0.00043598028666262206, "vf_loss": 6.5518998419245085, "vf_explained_var": 0.09540073548754056, "kl": 0.0064507746283197775, "entropy": 0.8660388487080733, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 174240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000}, "env_runners": {"episode_reward_max": 166.41816394801714, "episode_reward_min": -94.28613158601758, "episode_reward_mean": 26.530421253090605, "episode_len_mean": 172.87, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 17287, "policy_reward_min": {"agent_policy": -47.14306579300881, "adversary_policy": -36.20897052702354}, "policy_reward_max": {"agent_policy": 83.20908197400857, "adversary_policy": 49.62799140279669}, "policy_reward_mean": {"agent_policy": 13.265210626545306, "adversary_policy": 6.632605313272652}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.57584087475687, -24.88831167467324, 38.169588464581025, -18.06778873654018, 65.22553698502637, 46.01734211825482, -41.492759424217454, 8.395265367500244, 25.352286655037815, -14.872421158074488, 109.06477975155377, -94.28613158601758, -35.441925399658075, 16.759683441510823, 39.310249023567664, -34.33939576174849, -13.556207286541479, -56.36363317246614, -54.43223173418278, 14.826577322715181, 26.556447724517874, 42.172714596231934, 124.82304052654112, -62.15922012137595, 52.835273899465726, -15.926767241043786, 20.352438494902586, 50.91243046432868, 55.25259480322635, 17.731000143731656, 97.05162791428471, 66.49151138443011, 62.0474397467011, 76.71415254737326, 1.1123810717926297, 25.16895826307063, 86.37084521765158, 86.39610292347825, -65.59508895058104, 122.54073298241093, 145.40007274059406, 45.88999390004353, -94.13210187363333, 9.81536441762887, -34.098272979906454, -0.8965123373427843, 69.9028370459697, 14.828549556559643, 14.907048652824479, 27.13472801314743, -30.485379821123942, -17.375846658730374, -43.18433698629883, 27.02007632768172, -2.5467731286696385, -39.9041225042415, 83.5429837690227, -12.651517519355323, 68.39696331454854, 53.44594051624958, 38.53630924064356, 85.01418029295621, 121.38004047007269, -72.44001532546346, 27.267111195813456, -25.462594865038184, 7.940689239415089, 82.09253750467548, 3.4922829056001774, 4.925614124391522, 52.924735957325325, -48.32045923795741, 39.016763357843615, 50.17104796983734, 15.7100571628633, 78.9361841495218, 38.60221447872735, 60.161161170897344, 68.38303098255591, 35.63036110815429, 15.239464711825018, -4.758121775297425, 34.01064901521646, 23.435406951111062, 58.48067078864203, -34.15986330659021, 75.57485668483656, 166.41816394801714, 36.389200710150575, 19.47690675174235, -5.25594323932269, 3.4170211049011776, 128.4625700214491, 63.26931104015405, 44.74716658625972, 26.388806976557213, 64.3619563431646, 92.33306229268042, 84.07140828463811, -5.484793620887537], "episode_lengths": [200, 200, 200, 200, 18, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 26, 118, 200, 50, 200, 142, 200, 200, 200, 170, 28, 81, 97, 1, 200, 197, 167, 200, 200, 42, 176, 200, 200, 200, 200, 195, 200, 166, 200, 200, 200, 200, 200, 200, 200, 200, 200, 51, 200, 200, 167, 154, 200, 200, 200, 41, 200, 200, 200, 200, 200, 200, 200, 200, 200, 66, 200, 156, 200, 200, 200, 200, 200, 126, 200, 200, 196, 200, 200, 200, 200, 199, 114, 200, 200, 200, 107, 200, 200], "policy_agent_policy_reward": [-14.287920437378475, -12.444155837336634, 19.08479423229051, -9.033894368270087, 32.61276849251318, 23.0086710591274, -20.746379712108727, 4.197632683750115, 12.67614332751891, -7.436210579037244, 54.53238987577691, -47.14306579300881, -17.720962699829037, 8.379841720755428, 19.655124511783846, -17.169697880874214, -6.778103643270729, -28.18181658623302, -27.216115867091347, 7.413288661357591, 13.278223862258933, 21.086357298115956, 62.41152026327053, -31.079610060687983, 26.417636949732852, -7.963383620521849, 10.176219247451293, 25.456215232164347, 27.626297401613186, 8.865500071865814, 48.52581395714237, 33.245755692215056, 31.023719873350533, 38.35707627368659, 0.5561905358963148, 12.584479131535296, 43.18542260882576, 43.198051461739176, -32.797544475290536, 61.270366491205465, 72.70003637029704, 22.944996950021757, -47.06605093681658, 4.907682208814446, -17.04913648995323, -0.4482561686713815, 34.95141852298485, 7.414274778279829, 7.453524326412237, 13.567364006573715, -15.242689910561928, -8.687923329365201, -21.592168493149437, 13.510038163840871, -1.2733865643348246, -19.95206125212075, 41.771491884511356, -6.325758759677676, 34.19848165727426, 26.722970258124775, 19.26815462032179, 42.5070901464781, 60.690020235036364, -36.22000766273173, 13.633555597906728, -12.7312974325191, 3.9703446197075447, 41.04626875233776, 1.746141452800094, 2.462807062195722, 26.462367978662666, -24.160229618978654, 19.50838167892181, 25.085523984918666, 7.8550285814316645, 39.46809207476089, 19.301107239363667, 30.080580585448665, 34.191515491277954, 17.81518055407718, 7.619732355912513, -2.3790608876487482, 17.00532450760823, 11.717703475555524, 29.24033539432102, -17.079931653295056, 37.78742834241828, 83.20908197400857, 18.194600355075284, 9.73845337587117, -2.6279716196613236, 1.7085105524506137, 64.23128501072453, 31.634655520077036, 22.373583293129887, 13.1944034882786, 32.1809781715823, 46.16653114634021, 42.03570414231906, -2.742396810443754], "policy_adversary_policy_reward": [-9.658529135887981, -4.6293913014904895, -22.221151614135707, 9.776995776799073, -10.452501597936227, 29.537295830226743, -7.709671680575042, -1.3242226876950447, 18.12833179328431, 14.484436699228876, 20.736475911453205, 2.2721951476741964, -18.310024254974703, -2.436355457134024, 12.55128850574604, -8.353655821995908, -7.809286599713161, 20.48542992723207, 3.7737333808051545, -11.209943959842402, 21.8656693147229, 32.66672056105401, -29.322868798943468, -17.82019699406534, -9.689923346454894, -8.031039353374144, 14.013707644369333, -5.633865923613913, 8.49879065928567, 11.156333852498177, -9.79906636268174, -7.370631518192489, 2.464209546233138, -9.242313189503868, -17.850304584548574, -10.331512001684438, -3.191050423944695, -24.02506544314666, 8.761966511923298, -1.3486778505657089, 10.505043291148827, 2.7731805711101067, -4.865528433049803, 25.951885731165763, 49.62799140279669, 12.783528860473835, -5.624293309165994, -25.455316751521984, 15.768225017192659, 10.649411932540193, -1.5925971811139252, -6.3707864394079206, 42.89059230196594, -32.714373054514645, 31.682357898187565, -6.226142666023225, 20.155092634218814, 7.471204767394372, -2.0915660282232835, 10.957066100089094, 28.44083349607164, 20.084980461070725, 22.022663686139275, 11.22309200607578, -0.4955022666366631, 31.519222139987196, 37.12651928669406, 1.2305569869925161, 1.3323328101903176, -0.7761422742940027, 5.460500878811871, 7.123978252723426, 9.95350172678464, 33.23192088204112, 2.746518118225282, 40.45153334351388, -28.519830262703167, -4.277714212587334, 37.550660919546345, 23.719705571659134, 44.518937125944134, 28.181099244352918, 12.00707513893973, 10.937921811082031, -36.20897052702354, -10.857080409793056, 9.14763288523707, -4.239950676422627, -10.72726919212904, -6.321867297824188, -26.374317221334806, 25.926061052663428, 14.827573480541314, 20.123845042443534, 2.9372185366234618, 4.477056241656367, 9.231981528115, -1.7784572017027607, -0.3631256882219631, 13.930489694795678, -12.245860162937035, -2.996829747624913, -28.428395445475545, 19.74047211611035, -3.489126332066675, -18.10304216108276, 10.776372042259567, 2.7336661215813045, 3.000432297339433, -4.273818861674254, -9.178623894071052, -10.77343735804971, 20.711746905737428, 21.059744978773928, 4.49677647590255, -10.822535235580226, 42.80665468259194, -8.608173025317681, 24.676310223763885, 2.0466600343609045, 24.597065833348257, -5.3289112130264655, 21.959905485590447, 20.547184660887655, 20.17062645715916, 40.5193937778772, -15.948783559993732, -20.271224102738024, 21.818264010894886, -8.184708412988158, 13.103340712797426, -25.834638145316525, 16.066156570523244, -12.0958119508157, 14.000534741631448, 27.04573401070632, 10.601760537246724, -8.85561908444663, 10.117968557220081, -7.655161495024359, 15.30470366649103, 11.157664312171637, -20.751262732893622, -3.408966886085029, 10.797085928143836, 8.711295750777964, 14.138925226327746, 10.946598758590916, 3.7849338767547387, 4.070094704676915, 33.114253463828796, 6.3538386109320975, -9.135302290047871, 28.43640952941154, 5.2302216116472575, 24.85035897380141, 34.90595986264455, -0.7144443713666035, 10.468525336499152, 7.346655217578025, -5.5265320758916445, 13.146264431804145, 7.258918573315352, -9.637979460964093, 7.882624667110928, 9.122699840497301, -4.7886667021780625, 16.506370177733587, 21.74008398291638, 7.500251411404637, -7.05773099781311, -10.022200655481946, 21.39693949138513, 16.390488851033155, 43.815730184694345, 39.39335178931426, -5.526747198044241, 23.721347553119525, -14.963511977115616, 24.70196535298678, 3.397469451142996, -6.02544107080432, -7.252109403956904, 8.960619956407518, 39.54249622192955, 24.688788788794987, 30.48092365651373, 1.1537318635632943, 24.37774654405848, -2.004163250928592, 10.165602413982494, 3.028801074296105, 17.482628890225875, 14.698349281356421, 4.336396601652396, 41.830134544687816, 10.451141423763026, 31.58456271855603, 20.061026334804207, -22.80342314524796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39296406843006154, "mean_inference_ms": 0.9784217718392526, "mean_action_processing_ms": 0.16681726792035306, "mean_env_wait_ms": 0.05842418954718638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036427974700927734, "StateBufferConnector_ms": 0.0024657249450683594, "ViewRequirementAgentConnector_ms": 0.07065117359161377}, "num_episodes": 22, "episode_return_max": 166.41816394801714, "episode_return_min": -94.28613158601758, "episode_return_mean": 26.530421253090605}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.73288359183306, "num_env_steps_trained_throughput_per_sec": 500.73288359183306, "timesteps_total": 728000, "num_env_steps_sampled_lifetime": 728000, "num_agent_steps_sampled_lifetime": 2184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2184000, "timers": {"training_iteration_time_ms": 8034.58, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8034.542, "sample_time_ms": 786.811, "learn_time_ms": 7235.858, "learn_throughput": 552.802, "synch_weights_time_ms": 11.271}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000}, "done": false, "training_iteration": 182, "trial_id": "eaa30_00000", "date": "2024-08-09_18-05-24", "timestamp": 1723241124, "time_this_iter_s": 7.992111921310425, "time_total_s": 1493.4628024101257, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781bfe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1493.4628024101257, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 25.936363636363637, "ram_util_percent": 78.74545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.245059031279629, "cur_kl_coeff": 0.10972083620045708, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.25333385530603, "policy_loss": -0.0072312952982626424, "vf_loss": 5.25419135724426, "vf_explained_var": 0.1318359671131013, "kl": 0.05809088475588295, "entropy": 0.6149700085164378, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 55.13706633249919, "cur_kl_coeff": 0.801672251232869, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.176497057080269, "policy_loss": 0.0023730676689107592, "vf_loss": 7.160089385509491, "vf_explained_var": 0.2557521514594555, "kl": 0.01750662804309589, "entropy": 0.9470075732717912, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 175200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000}, "env_runners": {"episode_reward_max": 166.41816394801714, "episode_reward_min": -94.13210187363333, "episode_reward_mean": 35.41543195448012, "episode_len_mean": 170.17, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 17017, "policy_reward_min": {"agent_policy": -47.06605093681658, "adversary_policy": -36.20897052702354}, "policy_reward_max": {"agent_policy": 83.20908197400857, "adversary_policy": 46.21230587837164}, "policy_reward_mean": {"agent_policy": 17.707715977240063, "adversary_policy": 8.85385798862003}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.835273899465726, -15.926767241043786, 20.352438494902586, 50.91243046432868, 55.25259480322635, 17.731000143731656, 97.05162791428471, 66.49151138443011, 62.0474397467011, 76.71415254737326, 1.1123810717926297, 25.16895826307063, 86.37084521765158, 86.39610292347825, -65.59508895058104, 122.54073298241093, 145.40007274059406, 45.88999390004353, -94.13210187363333, 9.81536441762887, -34.098272979906454, -0.8965123373427843, 69.9028370459697, 14.828549556559643, 14.907048652824479, 27.13472801314743, -30.485379821123942, -17.375846658730374, -43.18433698629883, 27.02007632768172, -2.5467731286696385, -39.9041225042415, 83.5429837690227, -12.651517519355323, 68.39696331454854, 53.44594051624958, 38.53630924064356, 85.01418029295621, 121.38004047007269, -72.44001532546346, 27.267111195813456, -25.462594865038184, 7.940689239415089, 82.09253750467548, 3.4922829056001774, 4.925614124391522, 52.924735957325325, -48.32045923795741, 39.016763357843615, 50.17104796983734, 15.7100571628633, 78.9361841495218, 38.60221447872735, 60.161161170897344, 68.38303098255591, 35.63036110815429, 15.239464711825018, -4.758121775297425, 34.01064901521646, 23.435406951111062, 58.48067078864203, -34.15986330659021, 75.57485668483656, 166.41816394801714, 36.389200710150575, 19.47690675174235, -5.25594323932269, 3.4170211049011776, 128.4625700214491, 63.26931104015405, 44.74716658625972, 26.388806976557213, 64.3619563431646, 92.33306229268042, 84.07140828463811, -5.484793620887537, 19.90373024034804, 8.462076786657903, 18.677164513311368, -3.686546830035759, 1.9935614869333236, 77.96227516309634, -0.0964447041095795, 58.39912124027046, 123.7379725962916, 136.8686171627297, 6.768003511509972, 57.98566305454101, 15.041426625952408, 23.040459152766232, 51.07661026686445, 94.95061072677134, 3.3761427142390907, 29.004796996027608, 25.56782639591303, 96.98579941596722, 30.241132195390065, 76.23016125900637, 17.783016716430026, -3.5744615011347527], "episode_lengths": [50, 200, 142, 200, 200, 200, 170, 28, 81, 97, 1, 200, 197, 167, 200, 200, 42, 176, 200, 200, 200, 200, 195, 200, 166, 200, 200, 200, 200, 200, 200, 200, 200, 200, 51, 200, 200, 167, 154, 200, 200, 200, 41, 200, 200, 200, 200, 200, 200, 200, 200, 200, 66, 200, 156, 200, 200, 200, 200, 200, 126, 200, 200, 196, 200, 200, 200, 200, 199, 114, 200, 200, 200, 107, 200, 200, 124, 200, 200, 200, 200, 165, 200, 94, 155, 200, 134, 200, 29, 200, 200, 29, 200, 23, 200, 150, 200, 200, 25, 200], "policy_agent_policy_reward": [26.417636949732852, -7.963383620521849, 10.176219247451293, 25.456215232164347, 27.626297401613186, 8.865500071865814, 48.52581395714237, 33.245755692215056, 31.023719873350533, 38.35707627368659, 0.5561905358963148, 12.584479131535296, 43.18542260882576, 43.198051461739176, -32.797544475290536, 61.270366491205465, 72.70003637029704, 22.944996950021757, -47.06605093681658, 4.907682208814446, -17.04913648995323, -0.4482561686713815, 34.95141852298485, 7.414274778279829, 7.453524326412237, 13.567364006573715, -15.242689910561928, -8.687923329365201, -21.592168493149437, 13.510038163840871, -1.2733865643348246, -19.95206125212075, 41.771491884511356, -6.325758759677676, 34.19848165727426, 26.722970258124775, 19.26815462032179, 42.5070901464781, 60.690020235036364, -36.22000766273173, 13.633555597906728, -12.7312974325191, 3.9703446197075447, 41.04626875233776, 1.746141452800094, 2.462807062195722, 26.462367978662666, -24.160229618978654, 19.50838167892181, 25.085523984918666, 7.8550285814316645, 39.46809207476089, 19.301107239363667, 30.080580585448665, 34.191515491277954, 17.81518055407718, 7.619732355912513, -2.3790608876487482, 17.00532450760823, 11.717703475555524, 29.24033539432102, -17.079931653295056, 37.78742834241828, 83.20908197400857, 18.194600355075284, 9.73845337587117, -2.6279716196613236, 1.7085105524506137, 64.23128501072453, 31.634655520077036, 22.373583293129887, 13.1944034882786, 32.1809781715823, 46.16653114634021, 42.03570414231906, -2.742396810443754, 9.95186512017402, 4.2310383933289515, 9.338582256655677, -1.8432734150178618, 0.996780743466676, 38.981137581548175, -0.04822235205478442, 29.19956062013525, 61.8689862981458, 68.43430858136483, 3.3840017557549853, 28.99283152727051, 7.520713312976206, 11.520229576383098, 25.538305133432218, 47.47530536338567, 1.6880713571195685, 14.502398498013806, 12.783913197956519, 48.4928997079836, 15.120566097695033, 38.11508062950317, 8.89150835821501, -1.7872307505673497], "policy_adversary_policy_reward": [15.768225017192659, 10.649411932540193, -1.5925971811139252, -6.3707864394079206, 42.89059230196594, -32.714373054514645, 31.682357898187565, -6.226142666023225, 20.155092634218814, 7.471204767394372, -2.0915660282232835, 10.957066100089094, 28.44083349607164, 20.084980461070725, 22.022663686139275, 11.22309200607578, -0.4955022666366631, 31.519222139987196, 37.12651928669406, 1.2305569869925161, 1.3323328101903176, -0.7761422742940027, 5.460500878811871, 7.123978252723426, 9.95350172678464, 33.23192088204112, 2.746518118225282, 40.45153334351388, -28.519830262703167, -4.277714212587334, 37.550660919546345, 23.719705571659134, 44.518937125944134, 28.181099244352918, 12.00707513893973, 10.937921811082031, -36.20897052702354, -10.857080409793056, 9.14763288523707, -4.239950676422627, -10.72726919212904, -6.321867297824188, -26.374317221334806, 25.926061052663428, 14.827573480541314, 20.123845042443534, 2.9372185366234618, 4.477056241656367, 9.231981528115, -1.7784572017027607, -0.3631256882219631, 13.930489694795678, -12.245860162937035, -2.996829747624913, -28.428395445475545, 19.74047211611035, -3.489126332066675, -18.10304216108276, 10.776372042259567, 2.7336661215813045, 3.000432297339433, -4.273818861674254, -9.178623894071052, -10.77343735804971, 20.711746905737428, 21.059744978773928, 4.49677647590255, -10.822535235580226, 42.80665468259194, -8.608173025317681, 24.676310223763885, 2.0466600343609045, 24.597065833348257, -5.3289112130264655, 21.959905485590447, 20.547184660887655, 20.17062645715916, 40.5193937778772, -15.948783559993732, -20.271224102738024, 21.818264010894886, -8.184708412988158, 13.103340712797426, -25.834638145316525, 16.066156570523244, -12.0958119508157, 14.000534741631448, 27.04573401070632, 10.601760537246724, -8.85561908444663, 10.117968557220081, -7.655161495024359, 15.30470366649103, 11.157664312171637, -20.751262732893622, -3.408966886085029, 10.797085928143836, 8.711295750777964, 14.138925226327746, 10.946598758590916, 3.7849338767547387, 4.070094704676915, 33.114253463828796, 6.3538386109320975, -9.135302290047871, 28.43640952941154, 5.2302216116472575, 24.85035897380141, 34.90595986264455, -0.7144443713666035, 10.468525336499152, 7.346655217578025, -5.5265320758916445, 13.146264431804145, 7.258918573315352, -9.637979460964093, 7.882624667110928, 9.122699840497301, -4.7886667021780625, 16.506370177733587, 21.74008398291638, 7.500251411404637, -7.05773099781311, -10.022200655481946, 21.39693949138513, 16.390488851033155, 43.815730184694345, 39.39335178931426, -5.526747198044241, 23.721347553119525, -14.963511977115616, 24.70196535298678, 3.397469451142996, -6.02544107080432, -7.252109403956904, 8.960619956407518, 39.54249622192955, 24.688788788794987, 30.48092365651373, 1.1537318635632943, 24.37774654405848, -2.004163250928592, 10.165602413982494, 3.028801074296105, 17.482628890225875, 14.698349281356421, 4.336396601652396, 41.830134544687816, 10.451141423763026, 31.58456271855603, 20.061026334804207, -22.80342314524796, -21.147557465645924, 31.099422585819944, -9.82877474861466, 14.05981314194361, 22.050075688747633, -12.711493432091956, -9.214142298862178, 7.370868883844318, 0.2644424533204912, 0.7323382901461883, 17.67467473625868, 21.306462845289495, 2.941817223925483, -2.990039575980264, 19.11822830366988, 10.081332316465367, 32.027683544436066, 29.841302753709755, 46.21230587837164, 22.222002702993183, 25.790629503414337, -22.406627747659357, 15.67698810315785, 13.31584342411266, 17.18050046749634, -9.659787154520139, 16.006262056818752, -4.486032480435657, 15.391813074065016, 10.146492059367201, 25.45369315871334, 22.02161220467234, 2.4468139648657505, -0.7587426077461892, 1.7604753228242984, 12.741923175189507, 10.625150814971025, 2.1587623829854934, 18.021913842057337, 30.47098586592627, -7.907342010752014, 23.027908108447047, 18.890282123246422, 19.224798506256747, 17.46899862966729, -8.57749027145228, 0.907390979743461, -2.6946217303108106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39285342417345265, "mean_inference_ms": 0.9784877767586387, "mean_action_processing_ms": 0.16674665619011703, "mean_env_wait_ms": 0.058426807791181555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003546476364135742, "StateBufferConnector_ms": 0.002463817596435547, "ViewRequirementAgentConnector_ms": 0.07049727439880371}, "num_episodes": 24, "episode_return_max": 166.41816394801714, "episode_return_min": -94.13210187363333, "episode_return_mean": 35.41543195448012}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.7988946209867, "num_env_steps_trained_throughput_per_sec": 501.7988946209867, "timesteps_total": 732000, "num_env_steps_sampled_lifetime": 732000, "num_agent_steps_sampled_lifetime": 2196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2196000, "timers": {"training_iteration_time_ms": 8018.12, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8018.081, "sample_time_ms": 768.945, "learn_time_ms": 7237.196, "learn_throughput": 552.7, "synch_weights_time_ms": 11.34}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000}, "done": false, "training_iteration": 183, "trial_id": "eaa30_00000", "date": "2024-08-09_18-05-32", "timestamp": 1723241132, "time_this_iter_s": 7.975536823272705, "time_total_s": 1501.4383392333984, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17819fd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1501.4383392333984, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 24.13333333333333, "ram_util_percent": 78.90833333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.33542290352009, "cur_kl_coeff": 0.16458125430068554, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.059556881965153, "policy_loss": 0.01364894604985479, "vf_loss": 5.034048261339702, "vf_explained_var": 0.03412512266446674, "kl": 0.07205975159371972, "entropy": 0.6538647876214729, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.44415277590354, "cur_kl_coeff": 0.801672251232869, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.881913903852304, "policy_loss": -0.0023118893790524454, "vf_loss": 6.8695738315582275, "vf_explained_var": 0.07733820074548324, "kl": 0.01827672851504758, "entropy": 1.0329040742168825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 176160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "env_runners": {"episode_reward_max": 166.41816394801714, "episode_reward_min": -72.44001532546346, "episode_reward_mean": 43.26848398843785, "episode_len_mean": 169.83, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 16983, "policy_reward_min": {"agent_policy": -36.22000766273173, "adversary_policy": -28.428395445475545}, "policy_reward_max": {"agent_policy": 83.20908197400857, "adversary_policy": 46.21230587837164}, "policy_reward_mean": {"agent_policy": 21.634241994218932, "adversary_policy": 10.817120997109466}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.375846658730374, -43.18433698629883, 27.02007632768172, -2.5467731286696385, -39.9041225042415, 83.5429837690227, -12.651517519355323, 68.39696331454854, 53.44594051624958, 38.53630924064356, 85.01418029295621, 121.38004047007269, -72.44001532546346, 27.267111195813456, -25.462594865038184, 7.940689239415089, 82.09253750467548, 3.4922829056001774, 4.925614124391522, 52.924735957325325, -48.32045923795741, 39.016763357843615, 50.17104796983734, 15.7100571628633, 78.9361841495218, 38.60221447872735, 60.161161170897344, 68.38303098255591, 35.63036110815429, 15.239464711825018, -4.758121775297425, 34.01064901521646, 23.435406951111062, 58.48067078864203, -34.15986330659021, 75.57485668483656, 166.41816394801714, 36.389200710150575, 19.47690675174235, -5.25594323932269, 3.4170211049011776, 128.4625700214491, 63.26931104015405, 44.74716658625972, 26.388806976557213, 64.3619563431646, 92.33306229268042, 84.07140828463811, -5.484793620887537, 19.90373024034804, 8.462076786657903, 18.677164513311368, -3.686546830035759, 1.9935614869333236, 77.96227516309634, -0.0964447041095795, 58.39912124027046, 123.7379725962916, 136.8686171627297, 6.768003511509972, 57.98566305454101, 15.041426625952408, 23.040459152766232, 51.07661026686445, 94.95061072677134, 3.3761427142390907, 29.004796996027608, 25.56782639591303, 96.98579941596722, 30.241132195390065, 76.23016125900637, 17.783016716430026, -3.5744615011347527, -17.778628764797432, -2.4423360267489826, 147.79180087235014, 72.33860880124178, 90.96413720473426, 64.48773361544404, 49.284090382160755, 125.74167419754794, 8.840435512650007, 91.39542209410571, 46.58311139184741, 74.64003836093862, 11.908378387418091, 32.967723734440625, 11.585271617558558, 60.4132229226493, 162.6596062424388, 18.634177395998805, 129.15512129343958, 73.64547393956019, 7.030918875446916, 52.37684103450283, 88.10255320048071, 101.09412747114239, 122.74671434943423, 14.811142738873187, 54.04980353090055], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 51, 200, 200, 167, 154, 200, 200, 200, 41, 200, 200, 200, 200, 200, 200, 200, 200, 200, 66, 200, 156, 200, 200, 200, 200, 200, 126, 200, 200, 196, 200, 200, 200, 200, 199, 114, 200, 200, 200, 107, 200, 200, 124, 200, 200, 200, 200, 165, 200, 94, 155, 200, 134, 200, 29, 200, 200, 29, 200, 23, 200, 150, 200, 200, 25, 200, 200, 200, 200, 200, 142, 174, 27, 200, 200, 200, 200, 66, 16, 122, 200, 171, 157, 200, 200, 200, 4, 200, 200, 200, 162, 200, 37], "policy_agent_policy_reward": [-8.687923329365201, -21.592168493149437, 13.510038163840871, -1.2733865643348246, -19.95206125212075, 41.771491884511356, -6.325758759677676, 34.19848165727426, 26.722970258124775, 19.26815462032179, 42.5070901464781, 60.690020235036364, -36.22000766273173, 13.633555597906728, -12.7312974325191, 3.9703446197075447, 41.04626875233776, 1.746141452800094, 2.462807062195722, 26.462367978662666, -24.160229618978654, 19.50838167892181, 25.085523984918666, 7.8550285814316645, 39.46809207476089, 19.301107239363667, 30.080580585448665, 34.191515491277954, 17.81518055407718, 7.619732355912513, -2.3790608876487482, 17.00532450760823, 11.717703475555524, 29.24033539432102, -17.079931653295056, 37.78742834241828, 83.20908197400857, 18.194600355075284, 9.73845337587117, -2.6279716196613236, 1.7085105524506137, 64.23128501072453, 31.634655520077036, 22.373583293129887, 13.1944034882786, 32.1809781715823, 46.16653114634021, 42.03570414231906, -2.742396810443754, 9.95186512017402, 4.2310383933289515, 9.338582256655677, -1.8432734150178618, 0.996780743466676, 38.981137581548175, -0.04822235205478442, 29.19956062013525, 61.8689862981458, 68.43430858136483, 3.3840017557549853, 28.99283152727051, 7.520713312976206, 11.520229576383098, 25.538305133432218, 47.47530536338567, 1.6880713571195685, 14.502398498013806, 12.783913197956519, 48.4928997079836, 15.120566097695033, 38.11508062950317, 8.89150835821501, -1.7872307505673497, -8.889314382398759, -1.221168013374509, 73.89590043617514, 36.169304400620895, 45.48206860236711, 32.243866807722014, 24.642045191080378, 62.870837098774025, 4.420217756325016, 45.69771104705282, 23.2915556959237, 37.320019180469295, 5.954189193709046, 16.483861867220323, 5.792635808779261, 30.206611461324645, 81.32980312121934, 9.317088697999402, 64.57756064671982, 36.82273696978009, 3.5154594377234574, 26.188420517251423, 44.0512766002403, 50.54706373557119, 61.37335717471709, 7.4055713694365295, 27.02490176545026], "policy_adversary_policy_reward": [-28.428395445475545, 19.74047211611035, -3.489126332066675, -18.10304216108276, 10.776372042259567, 2.7336661215813045, 3.000432297339433, -4.273818861674254, -9.178623894071052, -10.77343735804971, 20.711746905737428, 21.059744978773928, 4.49677647590255, -10.822535235580226, 42.80665468259194, -8.608173025317681, 24.676310223763885, 2.0466600343609045, 24.597065833348257, -5.3289112130264655, 21.959905485590447, 20.547184660887655, 20.17062645715916, 40.5193937778772, -15.948783559993732, -20.271224102738024, 21.818264010894886, -8.184708412988158, 13.103340712797426, -25.834638145316525, 16.066156570523244, -12.0958119508157, 14.000534741631448, 27.04573401070632, 10.601760537246724, -8.85561908444663, 10.117968557220081, -7.655161495024359, 15.30470366649103, 11.157664312171637, -20.751262732893622, -3.408966886085029, 10.797085928143836, 8.711295750777964, 14.138925226327746, 10.946598758590916, 3.7849338767547387, 4.070094704676915, 33.114253463828796, 6.3538386109320975, -9.135302290047871, 28.43640952941154, 5.2302216116472575, 24.85035897380141, 34.90595986264455, -0.7144443713666035, 10.468525336499152, 7.346655217578025, -5.5265320758916445, 13.146264431804145, 7.258918573315352, -9.637979460964093, 7.882624667110928, 9.122699840497301, -4.7886667021780625, 16.506370177733587, 21.74008398291638, 7.500251411404637, -7.05773099781311, -10.022200655481946, 21.39693949138513, 16.390488851033155, 43.815730184694345, 39.39335178931426, -5.526747198044241, 23.721347553119525, -14.963511977115616, 24.70196535298678, 3.397469451142996, -6.02544107080432, -7.252109403956904, 8.960619956407518, 39.54249622192955, 24.688788788794987, 30.48092365651373, 1.1537318635632943, 24.37774654405848, -2.004163250928592, 10.165602413982494, 3.028801074296105, 17.482628890225875, 14.698349281356421, 4.336396601652396, 41.830134544687816, 10.451141423763026, 31.58456271855603, 20.061026334804207, -22.80342314524796, -21.147557465645924, 31.099422585819944, -9.82877474861466, 14.05981314194361, 22.050075688747633, -12.711493432091956, -9.214142298862178, 7.370868883844318, 0.2644424533204912, 0.7323382901461883, 17.67467473625868, 21.306462845289495, 2.941817223925483, -2.990039575980264, 19.11822830366988, 10.081332316465367, 32.027683544436066, 29.841302753709755, 46.21230587837164, 22.222002702993183, 25.790629503414337, -22.406627747659357, 15.67698810315785, 13.31584342411266, 17.18050046749634, -9.659787154520139, 16.006262056818752, -4.486032480435657, 15.391813074065016, 10.146492059367201, 25.45369315871334, 22.02161220467234, 2.4468139648657505, -0.7587426077461892, 1.7604753228242984, 12.741923175189507, 10.625150814971025, 2.1587623829854934, 18.021913842057337, 30.47098586592627, -7.907342010752014, 23.027908108447047, 18.890282123246422, 19.224798506256747, 17.46899862966729, -8.57749027145228, 0.907390979743461, -2.6946217303108106, 8.870843837808167, -17.760158220206925, -13.657944604674217, 12.436776591299715, 32.49712084314059, 41.3987795930345, 16.55812936556292, 19.61117503505797, 19.60220414854234, 25.879864453824776, 17.951795720720476, 14.292071087001542, 17.280840638045852, 7.361204553034529, 24.04755545429386, 38.82328164448015, 6.968777529660834, -2.548559773335814, 22.936789525757977, 22.760921521294836, 10.86515701821536, 12.426398677708342, 18.154560422229647, 19.16545875823965, 6.102438775670486, -0.14824958196144067, 12.342852872072505, 4.141008995147814, 3.9751157508207573, 1.8175200579585038, -1.6132756105410913, 31.819887071865736, 38.31133090776414, 43.018472213455226, 9.93513268370852, -0.618043985709118, 33.5164964716456, 31.061064175074197, 28.970908705321314, 7.851828264458778, -0.9182108579957067, 4.433670295719164, 2.502281089431804, 23.68613942781961, 31.63469031384886, 12.416586286391464, 26.826813703293148, 23.72025003227803, 42.922957418290984, 18.450399756426126, -2.1399086685981032, 9.545480038034633, 26.851024580727934, 0.17387718472232905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39264022373983304, "mean_inference_ms": 0.9780908210459067, "mean_action_processing_ms": 0.1665821237987414, "mean_env_wait_ms": 0.0583964143402889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003388643264770508, "StateBufferConnector_ms": 0.002393364906311035, "ViewRequirementAgentConnector_ms": 0.07006406784057617}, "num_episodes": 27, "episode_return_max": 166.41816394801714, "episode_return_min": -72.44001532546346, "episode_return_mean": 43.26848398843785}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 506.3721880324034, "num_env_steps_trained_throughput_per_sec": 506.3721880324034, "timesteps_total": 736000, "num_env_steps_sampled_lifetime": 736000, "num_agent_steps_sampled_lifetime": 2208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2208000, "timers": {"training_iteration_time_ms": 8008.968, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8008.929, "sample_time_ms": 769.158, "learn_time_ms": 7227.894, "learn_throughput": 553.412, "synch_weights_time_ms": 11.231}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "done": false, "training_iteration": 184, "trial_id": "eaa30_00000", "date": "2024-08-09_18-05-40", "timestamp": 1723241140, "time_this_iter_s": 7.903767108917236, "time_total_s": 1509.3421063423157, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17819fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1509.3421063423157, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 23.881818181818186, "ram_util_percent": 78.8090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.377076093071983, "cur_kl_coeff": 0.24687188145102834, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.8985267021037915, "policy_loss": 0.023484675239564642, "vf_loss": 5.853010042382296, "vf_explained_var": 0.024174809960461167, "kl": 0.08924463282896097, "entropy": 0.6892183357130283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.2760440868636, "cur_kl_coeff": 0.801672251232869, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.3086499159534775, "policy_loss": -0.003219721871088647, "vf_loss": 7.305313881735007, "vf_explained_var": 0.08890571196873982, "kl": 0.008177589574673523, "entropy": 1.0461912845571837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 177120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000}, "env_runners": {"episode_reward_max": 166.41816394801714, "episode_reward_min": -34.15986330659021, "episode_reward_mean": 55.15330888896084, "episode_len_mean": 165.13, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 16513, "policy_reward_min": {"agent_policy": -17.079931653295056, "adversary_policy": -22.80342314524796}, "policy_reward_max": {"agent_policy": 83.20908197400857, "adversary_policy": 46.21230587837164}, "policy_reward_mean": {"agent_policy": 27.576654444480415, "adversary_policy": 13.788327222240207}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.9361841495218, 38.60221447872735, 60.161161170897344, 68.38303098255591, 35.63036110815429, 15.239464711825018, -4.758121775297425, 34.01064901521646, 23.435406951111062, 58.48067078864203, -34.15986330659021, 75.57485668483656, 166.41816394801714, 36.389200710150575, 19.47690675174235, -5.25594323932269, 3.4170211049011776, 128.4625700214491, 63.26931104015405, 44.74716658625972, 26.388806976557213, 64.3619563431646, 92.33306229268042, 84.07140828463811, -5.484793620887537, 19.90373024034804, 8.462076786657903, 18.677164513311368, -3.686546830035759, 1.9935614869333236, 77.96227516309634, -0.0964447041095795, 58.39912124027046, 123.7379725962916, 136.8686171627297, 6.768003511509972, 57.98566305454101, 15.041426625952408, 23.040459152766232, 51.07661026686445, 94.95061072677134, 3.3761427142390907, 29.004796996027608, 25.56782639591303, 96.98579941596722, 30.241132195390065, 76.23016125900637, 17.783016716430026, -3.5744615011347527, -17.778628764797432, -2.4423360267489826, 147.79180087235014, 72.33860880124178, 90.96413720473426, 64.48773361544404, 49.284090382160755, 125.74167419754794, 8.840435512650007, 91.39542209410571, 46.58311139184741, 74.64003836093862, 11.908378387418091, 32.967723734440625, 11.585271617558558, 60.4132229226493, 162.6596062424388, 18.634177395998805, 129.15512129343958, 73.64547393956019, 7.030918875446916, 52.37684103450283, 88.10255320048071, 101.09412747114239, 122.74671434943423, 14.811142738873187, 54.04980353090055, 88.01579868657184, 34.91382520369373, 78.1438499572429, -6.121322814123836, 130.97588283612578, 125.54580813253719, 130.94160203543757, 83.22510175448554, 68.86401262717526, 10.615205434057117, 46.96575367884434, 95.6180808263448, -33.87613635892713, -4.445858551612936, 149.5611165534851, 102.61417413782075, 58.5008462962803, 96.16971594927679, 43.66355094642962, 84.08378311027724, 133.96313898097821, 68.7139468390896, 42.97371656688169, 57.84856434711044], "episode_lengths": [200, 66, 200, 156, 200, 200, 200, 200, 200, 126, 200, 200, 196, 200, 200, 200, 200, 199, 114, 200, 200, 200, 107, 200, 200, 124, 200, 200, 200, 200, 165, 200, 94, 155, 200, 134, 200, 29, 200, 200, 29, 200, 23, 200, 150, 200, 200, 25, 200, 200, 200, 200, 200, 142, 174, 27, 200, 200, 200, 200, 66, 16, 122, 200, 171, 157, 200, 200, 200, 4, 200, 200, 200, 162, 200, 37, 121, 151, 200, 200, 200, 178, 200, 200, 186, 200, 28, 181, 200, 200, 200, 187, 200, 56, 200, 200, 78, 125, 52, 200], "policy_agent_policy_reward": [39.46809207476089, 19.301107239363667, 30.080580585448665, 34.191515491277954, 17.81518055407718, 7.619732355912513, -2.3790608876487482, 17.00532450760823, 11.717703475555524, 29.24033539432102, -17.079931653295056, 37.78742834241828, 83.20908197400857, 18.194600355075284, 9.73845337587117, -2.6279716196613236, 1.7085105524506137, 64.23128501072453, 31.634655520077036, 22.373583293129887, 13.1944034882786, 32.1809781715823, 46.16653114634021, 42.03570414231906, -2.742396810443754, 9.95186512017402, 4.2310383933289515, 9.338582256655677, -1.8432734150178618, 0.996780743466676, 38.981137581548175, -0.04822235205478442, 29.19956062013525, 61.8689862981458, 68.43430858136483, 3.3840017557549853, 28.99283152727051, 7.520713312976206, 11.520229576383098, 25.538305133432218, 47.47530536338567, 1.6880713571195685, 14.502398498013806, 12.783913197956519, 48.4928997079836, 15.120566097695033, 38.11508062950317, 8.89150835821501, -1.7872307505673497, -8.889314382398759, -1.221168013374509, 73.89590043617514, 36.169304400620895, 45.48206860236711, 32.243866807722014, 24.642045191080378, 62.870837098774025, 4.420217756325016, 45.69771104705282, 23.2915556959237, 37.320019180469295, 5.954189193709046, 16.483861867220323, 5.792635808779261, 30.206611461324645, 81.32980312121934, 9.317088697999402, 64.57756064671982, 36.82273696978009, 3.5154594377234574, 26.188420517251423, 44.0512766002403, 50.54706373557119, 61.37335717471709, 7.4055713694365295, 27.02490176545026, 44.00789934328593, 17.456912601846856, 39.07192497862143, -3.060661407061911, 65.48794141806289, 62.77290406626858, 65.47080101771874, 41.61255087724276, 34.43200631358762, 5.3076027170285585, 23.482876839422175, 47.809040413172404, -16.93806817946358, -2.2229292758064503, 74.78055827674251, 51.30708706891042, 29.25042314814014, 48.08485797463836, 21.83177547321482, 42.04189155513865, 66.98156949048911, 34.35697341954479, 21.48685828344083, 28.924282173555255], "policy_adversary_policy_reward": [33.114253463828796, 6.3538386109320975, -9.135302290047871, 28.43640952941154, 5.2302216116472575, 24.85035897380141, 34.90595986264455, -0.7144443713666035, 10.468525336499152, 7.346655217578025, -5.5265320758916445, 13.146264431804145, 7.258918573315352, -9.637979460964093, 7.882624667110928, 9.122699840497301, -4.7886667021780625, 16.506370177733587, 21.74008398291638, 7.500251411404637, -7.05773099781311, -10.022200655481946, 21.39693949138513, 16.390488851033155, 43.815730184694345, 39.39335178931426, -5.526747198044241, 23.721347553119525, -14.963511977115616, 24.70196535298678, 3.397469451142996, -6.02544107080432, -7.252109403956904, 8.960619956407518, 39.54249622192955, 24.688788788794987, 30.48092365651373, 1.1537318635632943, 24.37774654405848, -2.004163250928592, 10.165602413982494, 3.028801074296105, 17.482628890225875, 14.698349281356421, 4.336396601652396, 41.830134544687816, 10.451141423763026, 31.58456271855603, 20.061026334804207, -22.80342314524796, -21.147557465645924, 31.099422585819944, -9.82877474861466, 14.05981314194361, 22.050075688747633, -12.711493432091956, -9.214142298862178, 7.370868883844318, 0.2644424533204912, 0.7323382901461883, 17.67467473625868, 21.306462845289495, 2.941817223925483, -2.990039575980264, 19.11822830366988, 10.081332316465367, 32.027683544436066, 29.841302753709755, 46.21230587837164, 22.222002702993183, 25.790629503414337, -22.406627747659357, 15.67698810315785, 13.31584342411266, 17.18050046749634, -9.659787154520139, 16.006262056818752, -4.486032480435657, 15.391813074065016, 10.146492059367201, 25.45369315871334, 22.02161220467234, 2.4468139648657505, -0.7587426077461892, 1.7604753228242984, 12.741923175189507, 10.625150814971025, 2.1587623829854934, 18.021913842057337, 30.47098586592627, -7.907342010752014, 23.027908108447047, 18.890282123246422, 19.224798506256747, 17.46899862966729, -8.57749027145228, 0.907390979743461, -2.6946217303108106, 8.870843837808167, -17.760158220206925, -13.657944604674217, 12.436776591299715, 32.49712084314059, 41.3987795930345, 16.55812936556292, 19.61117503505797, 19.60220414854234, 25.879864453824776, 17.951795720720476, 14.292071087001542, 17.280840638045852, 7.361204553034529, 24.04755545429386, 38.82328164448015, 6.968777529660834, -2.548559773335814, 22.936789525757977, 22.760921521294836, 10.86515701821536, 12.426398677708342, 18.154560422229647, 19.16545875823965, 6.102438775670486, -0.14824958196144067, 12.342852872072505, 4.141008995147814, 3.9751157508207573, 1.8175200579585038, -1.6132756105410913, 31.819887071865736, 38.31133090776414, 43.018472213455226, 9.93513268370852, -0.618043985709118, 33.5164964716456, 31.061064175074197, 28.970908705321314, 7.851828264458778, -0.9182108579957067, 4.433670295719164, 2.502281089431804, 23.68613942781961, 31.63469031384886, 12.416586286391464, 26.826813703293148, 23.72025003227803, 42.922957418290984, 18.450399756426126, -2.1399086685981032, 9.545480038034633, 26.851024580727934, 0.17387718472232905, 15.33018821908297, 28.677711124202958, 6.878368991692536, 10.578543610154318, 27.461850639856507, 11.610074338764935, 10.78669196841689, -13.847353375478818, 34.34877518110131, 31.1391662369616, 29.92503657400857, 32.84786749225999, 40.25464967808596, 25.216151339632788, 17.329336987941883, 24.283213889300896, 15.225447137559124, 19.20655917602849, 8.115282222997887, -2.807679505969329, 17.349307563405638, 6.1335692760165355, 9.013195004184151, 38.79584540898827, -9.601970568743809, -7.336097610719769, -4.995113509659255, 2.772184233852805, 35.71859243931755, 39.06196583742499, 27.28817970223315, 24.018907366677233, 4.743453915286835, 24.506969232853304, 34.014411700219505, 14.070446274418874, 8.20695540450025, 13.624820068714563, 2.4761339056706397, 39.56575764946802, 32.59184373294204, 34.389725757547076, 0.8093341968378693, 33.54763922270691, 5.479392941535984, 16.00746534190486, 30.23705285513875, -1.3127706815834888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39249430241696887, "mean_inference_ms": 0.9779545299700928, "mean_action_processing_ms": 0.16645413329756592, "mean_env_wait_ms": 0.058377172555697535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033265352249145508, "StateBufferConnector_ms": 0.0031412839889526367, "ViewRequirementAgentConnector_ms": 0.07091069221496582}, "num_episodes": 24, "episode_return_max": 166.41816394801714, "episode_return_min": -34.15986330659021, "episode_return_mean": 55.15330888896084}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.5630809968104, "num_env_steps_trained_throughput_per_sec": 505.5630809968104, "timesteps_total": 740000, "num_env_steps_sampled_lifetime": 740000, "num_agent_steps_sampled_lifetime": 2220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2220000, "timers": {"training_iteration_time_ms": 7990.785, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7990.746, "sample_time_ms": 766.158, "learn_time_ms": 7212.577, "learn_throughput": 554.587, "synch_weights_time_ms": 11.335}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000}, "done": false, "training_iteration": 185, "trial_id": "eaa30_00000", "date": "2024-08-09_18-05-48", "timestamp": 1723241148, "time_this_iter_s": 7.916946887969971, "time_total_s": 1517.2590532302856, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17818a160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1517.2590532302856, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 24.249999999999996, "ram_util_percent": 79.01666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.349468433163153, "cur_kl_coeff": 0.37030782217654246, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.462921462235627, "policy_loss": 0.011121050367210672, "vf_loss": 6.4405216068187086, "vf_explained_var": 0.022372021813872, "kl": 0.030457940932225296, "entropy": 0.7265285643004866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.09721418370803, "cur_kl_coeff": 0.801672251232869, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.911750134825707, "policy_loss": -0.0013441963761579244, "vf_loss": 7.905520736177762, "vf_explained_var": -0.00949497874826193, "kl": 0.009447234645388864, "entropy": 1.0342171834781766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 178080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000}, "env_runners": {"episode_reward_max": 177.01612780385426, "episode_reward_min": -33.87613635892713, "episode_reward_mean": 62.466128344775036, "episode_len_mean": 157.64, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 15764, "policy_reward_min": {"agent_policy": -16.93806817946358, "adversary_policy": -22.406627747659357}, "policy_reward_max": {"agent_policy": 88.5080639019271, "adversary_policy": 46.3606282328126}, "policy_reward_mean": {"agent_policy": 31.23306417238752, "adversary_policy": 15.616532086193763}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.90373024034804, 8.462076786657903, 18.677164513311368, -3.686546830035759, 1.9935614869333236, 77.96227516309634, -0.0964447041095795, 58.39912124027046, 123.7379725962916, 136.8686171627297, 6.768003511509972, 57.98566305454101, 15.041426625952408, 23.040459152766232, 51.07661026686445, 94.95061072677134, 3.3761427142390907, 29.004796996027608, 25.56782639591303, 96.98579941596722, 30.241132195390065, 76.23016125900637, 17.783016716430026, -3.5744615011347527, -17.778628764797432, -2.4423360267489826, 147.79180087235014, 72.33860880124178, 90.96413720473426, 64.48773361544404, 49.284090382160755, 125.74167419754794, 8.840435512650007, 91.39542209410571, 46.58311139184741, 74.64003836093862, 11.908378387418091, 32.967723734440625, 11.585271617558558, 60.4132229226493, 162.6596062424388, 18.634177395998805, 129.15512129343958, 73.64547393956019, 7.030918875446916, 52.37684103450283, 88.10255320048071, 101.09412747114239, 122.74671434943423, 14.811142738873187, 54.04980353090055, 88.01579868657184, 34.91382520369373, 78.1438499572429, -6.121322814123836, 130.97588283612578, 125.54580813253719, 130.94160203543757, 83.22510175448554, 68.86401262717526, 10.615205434057117, 46.96575367884434, 95.6180808263448, -33.87613635892713, -4.445858551612936, 149.5611165534851, 102.61417413782075, 58.5008462962803, 96.16971594927679, 43.66355094642962, 84.08378311027724, 133.96313898097821, 68.7139468390896, 42.97371656688169, 57.84856434711044, 129.47310699886745, 87.68230179293235, 68.42650986895018, 40.8628124744165, 58.67909707555604, 156.63811063508908, 11.34757360426687, 94.96763587963741, 98.55579919025564, 38.10486017254869, 41.943377788500484, 63.84848842110722, 177.01612780385426, 89.25095325387703, 92.78281365243038, 58.8514129571063, 160.7168774864049, 66.04374873005135, 82.22771667102987, 73.63343216715195, 76.6490734325653, 78.21798058059584, 63.92271062781288, 23.262117568864824, -33.69184109334667], "episode_lengths": [124, 200, 200, 200, 200, 165, 200, 94, 155, 200, 134, 200, 29, 200, 200, 29, 200, 23, 200, 150, 200, 200, 25, 200, 200, 200, 200, 200, 142, 174, 27, 200, 200, 200, 200, 66, 16, 122, 200, 171, 157, 200, 200, 200, 4, 200, 200, 200, 162, 200, 37, 121, 151, 200, 200, 200, 178, 200, 200, 186, 200, 28, 181, 200, 200, 200, 187, 200, 56, 200, 200, 78, 125, 52, 200, 200, 200, 61, 200, 138, 95, 200, 149, 146, 97, 42, 177, 86, 45, 200, 169, 200, 64, 200, 153, 200, 193, 200, 200, 200], "policy_agent_policy_reward": [9.95186512017402, 4.2310383933289515, 9.338582256655677, -1.8432734150178618, 0.996780743466676, 38.981137581548175, -0.04822235205478442, 29.19956062013525, 61.8689862981458, 68.43430858136483, 3.3840017557549853, 28.99283152727051, 7.520713312976206, 11.520229576383098, 25.538305133432218, 47.47530536338567, 1.6880713571195685, 14.502398498013806, 12.783913197956519, 48.4928997079836, 15.120566097695033, 38.11508062950317, 8.89150835821501, -1.7872307505673497, -8.889314382398759, -1.221168013374509, 73.89590043617514, 36.169304400620895, 45.48206860236711, 32.243866807722014, 24.642045191080378, 62.870837098774025, 4.420217756325016, 45.69771104705282, 23.2915556959237, 37.320019180469295, 5.954189193709046, 16.483861867220323, 5.792635808779261, 30.206611461324645, 81.32980312121934, 9.317088697999402, 64.57756064671982, 36.82273696978009, 3.5154594377234574, 26.188420517251423, 44.0512766002403, 50.54706373557119, 61.37335717471709, 7.4055713694365295, 27.02490176545026, 44.00789934328593, 17.456912601846856, 39.07192497862143, -3.060661407061911, 65.48794141806289, 62.77290406626858, 65.47080101771874, 41.61255087724276, 34.43200631358762, 5.3076027170285585, 23.482876839422175, 47.809040413172404, -16.93806817946358, -2.2229292758064503, 74.78055827674251, 51.30708706891042, 29.25042314814014, 48.08485797463836, 21.83177547321482, 42.04189155513865, 66.98156949048911, 34.35697341954479, 21.48685828344083, 28.924282173555255, 64.73655349943371, 43.84115089646618, 34.21325493447507, 20.43140623720825, 29.33954853777802, 78.31905531754454, 5.673786802133463, 47.48381793981871, 49.27789959512781, 19.052430086274335, 20.971688894250256, 31.924244210553613, 88.5080639019271, 44.62547662693853, 46.39140682621519, 29.425706478553153, 80.35843874320251, 33.02187436502567, 41.11385833551492, 36.816716083576, 38.324536716282665, 39.10899029029794, 31.96135531390643, 11.631058784432419, -16.84592054667337], "policy_adversary_policy_reward": [-21.147557465645924, 31.099422585819944, -9.82877474861466, 14.05981314194361, 22.050075688747633, -12.711493432091956, -9.214142298862178, 7.370868883844318, 0.2644424533204912, 0.7323382901461883, 17.67467473625868, 21.306462845289495, 2.941817223925483, -2.990039575980264, 19.11822830366988, 10.081332316465367, 32.027683544436066, 29.841302753709755, 46.21230587837164, 22.222002702993183, 25.790629503414337, -22.406627747659357, 15.67698810315785, 13.31584342411266, 17.18050046749634, -9.659787154520139, 16.006262056818752, -4.486032480435657, 15.391813074065016, 10.146492059367201, 25.45369315871334, 22.02161220467234, 2.4468139648657505, -0.7587426077461892, 1.7604753228242984, 12.741923175189507, 10.625150814971025, 2.1587623829854934, 18.021913842057337, 30.47098586592627, -7.907342010752014, 23.027908108447047, 18.890282123246422, 19.224798506256747, 17.46899862966729, -8.57749027145228, 0.907390979743461, -2.6946217303108106, 8.870843837808167, -17.760158220206925, -13.657944604674217, 12.436776591299715, 32.49712084314059, 41.3987795930345, 16.55812936556292, 19.61117503505797, 19.60220414854234, 25.879864453824776, 17.951795720720476, 14.292071087001542, 17.280840638045852, 7.361204553034529, 24.04755545429386, 38.82328164448015, 6.968777529660834, -2.548559773335814, 22.936789525757977, 22.760921521294836, 10.86515701821536, 12.426398677708342, 18.154560422229647, 19.16545875823965, 6.102438775670486, -0.14824958196144067, 12.342852872072505, 4.141008995147814, 3.9751157508207573, 1.8175200579585038, -1.6132756105410913, 31.819887071865736, 38.31133090776414, 43.018472213455226, 9.93513268370852, -0.618043985709118, 33.5164964716456, 31.061064175074197, 28.970908705321314, 7.851828264458778, -0.9182108579957067, 4.433670295719164, 2.502281089431804, 23.68613942781961, 31.63469031384886, 12.416586286391464, 26.826813703293148, 23.72025003227803, 42.922957418290984, 18.450399756426126, -2.1399086685981032, 9.545480038034633, 26.851024580727934, 0.17387718472232905, 15.33018821908297, 28.677711124202958, 6.878368991692536, 10.578543610154318, 27.461850639856507, 11.610074338764935, 10.78669196841689, -13.847353375478818, 34.34877518110131, 31.1391662369616, 29.92503657400857, 32.84786749225999, 40.25464967808596, 25.216151339632788, 17.329336987941883, 24.283213889300896, 15.225447137559124, 19.20655917602849, 8.115282222997887, -2.807679505969329, 17.349307563405638, 6.1335692760165355, 9.013195004184151, 38.79584540898827, -9.601970568743809, -7.336097610719769, -4.995113509659255, 2.772184233852805, 35.71859243931755, 39.06196583742499, 27.28817970223315, 24.018907366677233, 4.743453915286835, 24.506969232853304, 34.014411700219505, 14.070446274418874, 8.20695540450025, 13.624820068714563, 2.4761339056706397, 39.56575764946802, 32.59184373294204, 34.389725757547076, 0.8093341968378693, 33.54763922270691, 5.479392941535984, 16.00746534190486, 30.23705285513875, -1.3127706815834888, 26.653085336529642, 38.08346816290407, 27.650012215859004, 16.191138680607164, 20.819023783792616, 13.39423115068246, 13.81444597315684, 6.616960264051411, 7.0605440957475825, 22.279004442030434, 43.04220181014679, 35.27685350739773, 17.915646919943626, -12.241860117810162, 24.10403889522287, 23.37977904459583, 31.455863419605034, 17.82203617552278, 7.137765118963239, 11.914664967311097, 21.635486848559946, -0.663797954309695, 23.678362765240337, 8.24588144531328, 46.3606282328126, 42.147435669114515, 16.51855205677726, 28.10692457016126, 10.07208320489464, 36.31932362132055, 26.04548279056907, 3.3802236879840777, 37.518491943112245, 42.83994680009027, 24.19172418032114, 8.830150184704534, 20.54701773372434, 20.566840601790574, 13.626847706442502, 23.189868377133493, 21.228603434074845, 17.09593328220782, 5.4422544402864546, 33.666735850011484, 26.21537589765689, 5.7459794162495434, 17.12232876971117, -5.491269985278748, 2.413045579355753, -19.25896612602913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3924300911562257, "mean_inference_ms": 0.9779313887310954, "mean_action_processing_ms": 0.16644459926779795, "mean_env_wait_ms": 0.05836733323295661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031952857971191406, "StateBufferConnector_ms": 0.003063678741455078, "ViewRequirementAgentConnector_ms": 0.06249082088470459}, "num_episodes": 25, "episode_return_max": 177.01612780385426, "episode_return_min": -33.87613635892713, "episode_return_mean": 62.466128344775036}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 519.8552269705737, "num_env_steps_trained_throughput_per_sec": 519.8552269705737, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 2232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2232000, "timers": {"training_iteration_time_ms": 7959.043, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7959.004, "sample_time_ms": 767.042, "learn_time_ms": 7180.116, "learn_throughput": 557.094, "synch_weights_time_ms": 11.215}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000}, "done": false, "training_iteration": 186, "trial_id": "eaa30_00000", "date": "2024-08-09_18-05-56", "timestamp": 1723241156, "time_this_iter_s": 7.698946952819824, "time_total_s": 1524.9580001831055, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17818a790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1524.9580001831055, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 29.990909090909085, "ram_util_percent": 79.72727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.563993331364223, "cur_kl_coeff": 0.5554617332648139, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.838367728329209, "policy_loss": 0.007425469723801133, "vf_loss": 5.821613858742689, "vf_explained_var": 0.040105684314455305, "kl": 0.016793942408606648, "entropy": 0.719434940373456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.96752608418465, "cur_kl_coeff": 0.801672251232869, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.801897297799587, "policy_loss": 0.002045452588693782, "vf_loss": 6.79372048129638, "vf_explained_var": 0.08943297322839498, "kl": 0.007648202292815162, "entropy": 0.968365328013897, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 179040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000}, "env_runners": {"episode_reward_max": 177.01612780385426, "episode_reward_min": -62.36541143694683, "episode_reward_mean": 68.36527211974828, "episode_len_mean": 152.18, "episode_media": {}, "episodes_this_iter": 31, "episodes_timesteps_total": 15218, "policy_reward_min": {"agent_policy": -31.182705718473464, "adversary_policy": -20.002174325345326}, "policy_reward_max": {"agent_policy": 88.5080639019271, "adversary_policy": 46.3606282328126}, "policy_reward_mean": {"agent_policy": 34.182636059874135, "adversary_policy": 17.091318029937067}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.74167419754794, 8.840435512650007, 91.39542209410571, 46.58311139184741, 74.64003836093862, 11.908378387418091, 32.967723734440625, 11.585271617558558, 60.4132229226493, 162.6596062424388, 18.634177395998805, 129.15512129343958, 73.64547393956019, 7.030918875446916, 52.37684103450283, 88.10255320048071, 101.09412747114239, 122.74671434943423, 14.811142738873187, 54.04980353090055, 88.01579868657184, 34.91382520369373, 78.1438499572429, -6.121322814123836, 130.97588283612578, 125.54580813253719, 130.94160203543757, 83.22510175448554, 68.86401262717526, 10.615205434057117, 46.96575367884434, 95.6180808263448, -33.87613635892713, -4.445858551612936, 149.5611165534851, 102.61417413782075, 58.5008462962803, 96.16971594927679, 43.66355094642962, 84.08378311027724, 133.96313898097821, 68.7139468390896, 42.97371656688169, 57.84856434711044, 129.47310699886745, 87.68230179293235, 68.42650986895018, 40.8628124744165, 58.67909707555604, 156.63811063508908, 11.34757360426687, 94.96763587963741, 98.55579919025564, 38.10486017254869, 41.943377788500484, 63.84848842110722, 177.01612780385426, 89.25095325387703, 92.78281365243038, 58.8514129571063, 160.7168774864049, 66.04374873005135, 82.22771667102987, 73.63343216715195, 76.6490734325653, 78.21798058059584, 63.92271062781288, 23.262117568864824, -33.69184109334667, 71.80732185459573, 8.982731441352172, 24.903028256056672, 128.68588769072895, 17.92134882609332, 124.04537632604826, 89.12829524728258, 72.24148198089182, -62.36541143694683, 18.157587582820774, 82.96183977863213, 74.59401419264081, 69.35035788266394, 45.634717831722284, 87.91407575013841, 72.76612159245857, 73.61674438574966, -13.21441833721218, 32.528948534132795, 47.87581345508242, 68.17274083176156, 51.43231257623876, 12.102328247419752, 124.0141174647784, 86.35252071074552, 145.73051992593815, 44.945694742814226, 21.879739034627192, 129.57467520196136, 105.51349663067381, 104.00449056555402], "episode_lengths": [200, 200, 200, 200, 66, 16, 122, 200, 171, 157, 200, 200, 200, 4, 200, 200, 200, 162, 200, 37, 121, 151, 200, 200, 200, 178, 200, 200, 186, 200, 28, 181, 200, 200, 200, 187, 200, 56, 200, 200, 78, 125, 52, 200, 200, 200, 61, 200, 138, 95, 200, 149, 146, 97, 42, 177, 86, 45, 200, 169, 200, 64, 200, 153, 200, 193, 200, 200, 200, 153, 21, 200, 148, 35, 91, 200, 56, 200, 200, 109, 170, 98, 87, 127, 65, 167, 200, 20, 200, 200, 191, 20, 89, 131, 147, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [62.870837098774025, 4.420217756325016, 45.69771104705282, 23.2915556959237, 37.320019180469295, 5.954189193709046, 16.483861867220323, 5.792635808779261, 30.206611461324645, 81.32980312121934, 9.317088697999402, 64.57756064671982, 36.82273696978009, 3.5154594377234574, 26.188420517251423, 44.0512766002403, 50.54706373557119, 61.37335717471709, 7.4055713694365295, 27.02490176545026, 44.00789934328593, 17.456912601846856, 39.07192497862143, -3.060661407061911, 65.48794141806289, 62.77290406626858, 65.47080101771874, 41.61255087724276, 34.43200631358762, 5.3076027170285585, 23.482876839422175, 47.809040413172404, -16.93806817946358, -2.2229292758064503, 74.78055827674251, 51.30708706891042, 29.25042314814014, 48.08485797463836, 21.83177547321482, 42.04189155513865, 66.98156949048911, 34.35697341954479, 21.48685828344083, 28.924282173555255, 64.73655349943371, 43.84115089646618, 34.21325493447507, 20.43140623720825, 29.33954853777802, 78.31905531754454, 5.673786802133463, 47.48381793981871, 49.27789959512781, 19.052430086274335, 20.971688894250256, 31.924244210553613, 88.5080639019271, 44.62547662693853, 46.39140682621519, 29.425706478553153, 80.35843874320251, 33.02187436502567, 41.11385833551492, 36.816716083576, 38.324536716282665, 39.10899029029794, 31.96135531390643, 11.631058784432419, -16.84592054667337, 35.90366092729785, 4.491365720676085, 12.451514128028334, 64.3429438453645, 8.96067441304666, 62.022688163024135, 44.5641476236413, 36.120740990445896, -31.182705718473464, 9.078793791410405, 41.48091988931609, 37.297007096320414, 34.67517894133198, 22.81735891586114, 43.95703787506922, 36.3830607962293, 36.80837219287482, -6.6072091686060865, 16.2644742670664, 23.93790672754121, 34.08637041588076, 25.71615628811938, 6.051164123709875, 62.00705873238923, 43.17626035537276, 72.86525996296905, 22.472847371407113, 10.939869517313618, 64.78733760098069, 52.756748315336864, 52.002245282777054], "policy_adversary_policy_reward": [24.04755545429386, 38.82328164448015, 6.968777529660834, -2.548559773335814, 22.936789525757977, 22.760921521294836, 10.86515701821536, 12.426398677708342, 18.154560422229647, 19.16545875823965, 6.102438775670486, -0.14824958196144067, 12.342852872072505, 4.141008995147814, 3.9751157508207573, 1.8175200579585038, -1.6132756105410913, 31.819887071865736, 38.31133090776414, 43.018472213455226, 9.93513268370852, -0.618043985709118, 33.5164964716456, 31.061064175074197, 28.970908705321314, 7.851828264458778, -0.9182108579957067, 4.433670295719164, 2.502281089431804, 23.68613942781961, 31.63469031384886, 12.416586286391464, 26.826813703293148, 23.72025003227803, 42.922957418290984, 18.450399756426126, -2.1399086685981032, 9.545480038034633, 26.851024580727934, 0.17387718472232905, 15.33018821908297, 28.677711124202958, 6.878368991692536, 10.578543610154318, 27.461850639856507, 11.610074338764935, 10.78669196841689, -13.847353375478818, 34.34877518110131, 31.1391662369616, 29.92503657400857, 32.84786749225999, 40.25464967808596, 25.216151339632788, 17.329336987941883, 24.283213889300896, 15.225447137559124, 19.20655917602849, 8.115282222997887, -2.807679505969329, 17.349307563405638, 6.1335692760165355, 9.013195004184151, 38.79584540898827, -9.601970568743809, -7.336097610719769, -4.995113509659255, 2.772184233852805, 35.71859243931755, 39.06196583742499, 27.28817970223315, 24.018907366677233, 4.743453915286835, 24.506969232853304, 34.014411700219505, 14.070446274418874, 8.20695540450025, 13.624820068714563, 2.4761339056706397, 39.56575764946802, 32.59184373294204, 34.389725757547076, 0.8093341968378693, 33.54763922270691, 5.479392941535984, 16.00746534190486, 30.23705285513875, -1.3127706815834888, 26.653085336529642, 38.08346816290407, 27.650012215859004, 16.191138680607164, 20.819023783792616, 13.39423115068246, 13.81444597315684, 6.616960264051411, 7.0605440957475825, 22.279004442030434, 43.04220181014679, 35.27685350739773, 17.915646919943626, -12.241860117810162, 24.10403889522287, 23.37977904459583, 31.455863419605034, 17.82203617552278, 7.137765118963239, 11.914664967311097, 21.635486848559946, -0.663797954309695, 23.678362765240337, 8.24588144531328, 46.3606282328126, 42.147435669114515, 16.51855205677726, 28.10692457016126, 10.07208320489464, 36.31932362132055, 26.04548279056907, 3.3802236879840777, 37.518491943112245, 42.83994680009027, 24.19172418032114, 8.830150184704534, 20.54701773372434, 20.566840601790574, 13.626847706442502, 23.189868377133493, 21.228603434074845, 17.09593328220782, 5.4422544402864546, 33.666735850011484, 26.21537589765689, 5.7459794162495434, 17.12232876971117, -5.491269985278748, 2.413045579355753, -19.25896612602913, 22.550511774269005, 13.353149153028843, 10.524331747973964, -6.032966027297878, 6.429377013413543, 6.022137114614791, 33.291219991789625, 31.051723853574874, 6.356640961018195, 2.604033452028464, 34.83981877907623, 27.182869383947903, 24.335927906796073, 20.228219716845224, 9.318555669631728, 26.802185320814175, -20.002174325345326, -11.180531393128142, 0.14655037907720825, 8.9322434123332, 24.556963059644467, 16.923956829671614, 7.985604985477195, 29.311402110843225, 18.36243380632258, 16.312745135009393, 3.8553672171535434, 18.961991698707596, 25.711618513175186, 18.245419361894022, 19.515307863483578, 16.867752932745724, 16.20372080298775, 20.604651389887067, 9.689522415210398, -16.296731583816484, 9.211254258747102, 7.053220008319299, 10.743500392297964, 13.194406335243247, 5.947929205681825, 28.138441210198934, 22.92528993662298, 2.7908663514963905, -2.178377738268987, 8.229541861978861, 17.53443661243889, 44.47262211995035, 27.834327977872995, 15.341932377499766, 36.646696101442714, 36.21856386152636, 24.890018390074736, -2.41717101866762, 21.294308594396085, -10.35443907708246, 38.65969184064173, 26.127645760338936, 24.258739810325746, 28.498008505011125, 21.779214077982083, 30.223031204794978]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39216469582121166, "mean_inference_ms": 0.9778936675333803, "mean_action_processing_ms": 0.16643571121730832, "mean_env_wait_ms": 0.05832324373079574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033565759658813477, "StateBufferConnector_ms": 0.0034412145614624023, "ViewRequirementAgentConnector_ms": 0.0641254186630249}, "num_episodes": 31, "episode_return_max": 177.01612780385426, "episode_return_min": -62.36541143694683, "episode_return_mean": 68.36527211974828}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 517.3274401255236, "num_env_steps_trained_throughput_per_sec": 517.3274401255236, "timesteps_total": 748000, "num_env_steps_sampled_lifetime": 748000, "num_agent_steps_sampled_lifetime": 2244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2244000, "timers": {"training_iteration_time_ms": 7901.904, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7901.867, "sample_time_ms": 733.768, "learn_time_ms": 7156.783, "learn_throughput": 558.91, "synch_weights_time_ms": 10.739}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000}, "done": false, "training_iteration": 187, "trial_id": "eaa30_00000", "date": "2024-08-09_18-06-04", "timestamp": 1723241164, "time_this_iter_s": 7.736663103103638, "time_total_s": 1532.694663286209, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc920d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1532.694663286209, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 24.236363636363638, "ram_util_percent": 79.69090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.184332492805662, "cur_kl_coeff": 0.5554617332648139, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.506442870286406, "policy_loss": 0.0006061835830449742, "vf_loss": 5.500916422485674, "vf_explained_var": -0.016405177116394044, "kl": 0.008857987639518878, "entropy": 0.7182461377174135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.06410780499379, "cur_kl_coeff": 0.801672251232869, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.142380853494008, "policy_loss": -0.0016515837739765023, "vf_loss": 7.1378697256247206, "vf_explained_var": -0.0842200230807066, "kl": 0.0076873093125565594, "entropy": 0.9311526728173097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "env_runners": {"episode_reward_max": 177.01612780385426, "episode_reward_min": -62.36541143694683, "episode_reward_mean": 68.95765587442742, "episode_len_mean": 140.36, "episode_media": {}, "episodes_this_iter": 31, "episodes_timesteps_total": 14036, "policy_reward_min": {"agent_policy": -31.182705718473464, "adversary_policy": -20.002174325345326}, "policy_reward_max": {"agent_policy": 88.5080639019271, "adversary_policy": 47.09578000931534}, "policy_reward_mean": {"agent_policy": 34.47882793721371, "adversary_policy": 17.239413968606854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.6180808263448, -33.87613635892713, -4.445858551612936, 149.5611165534851, 102.61417413782075, 58.5008462962803, 96.16971594927679, 43.66355094642962, 84.08378311027724, 133.96313898097821, 68.7139468390896, 42.97371656688169, 57.84856434711044, 129.47310699886745, 87.68230179293235, 68.42650986895018, 40.8628124744165, 58.67909707555604, 156.63811063508908, 11.34757360426687, 94.96763587963741, 98.55579919025564, 38.10486017254869, 41.943377788500484, 63.84848842110722, 177.01612780385426, 89.25095325387703, 92.78281365243038, 58.8514129571063, 160.7168774864049, 66.04374873005135, 82.22771667102987, 73.63343216715195, 76.6490734325653, 78.21798058059584, 63.92271062781288, 23.262117568864824, -33.69184109334667, 71.80732185459573, 8.982731441352172, 24.903028256056672, 128.68588769072895, 17.92134882609332, 124.04537632604826, 89.12829524728258, 72.24148198089182, -62.36541143694683, 18.157587582820774, 82.96183977863213, 74.59401419264081, 69.35035788266394, 45.634717831722284, 87.91407575013841, 72.76612159245857, 73.61674438574966, -13.21441833721218, 32.528948534132795, 47.87581345508242, 68.17274083176156, 51.43231257623876, 12.102328247419752, 124.0141174647784, 86.35252071074552, 145.73051992593815, 44.945694742814226, 21.879739034627192, 129.57467520196136, 105.51349663067381, 104.00449056555402, 124.63471385782007, 89.9484104028003, 135.08747233509592, 59.74761322508053, 87.0468774743147, 78.7865890781064, 104.43289220749054, 68.58246716192033, 40.78960242807973, 71.78401461711019, 116.09268307751856, 71.25979278561236, 100.88396885119025, 129.8697481867225, 27.099985229981137, 76.6831940591286, 52.86182180440768, 151.5282338346315, 24.62068942833887, 81.43074391467827, 27.459499221350328, 74.0247375102777, 1.3841537285670213, 112.71199131186943, -48.87773868131276, 101.19069212538176, 23.497773983551767, 12.415465918394162, 20.241212701655563, 117.5684471144455, 4.917902397126118], "episode_lengths": [181, 200, 200, 200, 187, 200, 56, 200, 200, 78, 125, 52, 200, 200, 200, 61, 200, 138, 95, 200, 149, 146, 97, 42, 177, 86, 45, 200, 169, 200, 64, 200, 153, 200, 193, 200, 200, 200, 153, 21, 200, 148, 35, 91, 200, 56, 200, 200, 109, 170, 98, 87, 127, 65, 167, 200, 20, 200, 200, 191, 20, 89, 131, 147, 200, 200, 200, 200, 200, 200, 106, 102, 200, 81, 54, 51, 200, 200, 200, 75, 40, 111, 107, 200, 37, 200, 107, 28, 55, 200, 80, 200, 140, 200, 82, 200, 200, 62, 98, 1], "policy_agent_policy_reward": [47.809040413172404, -16.93806817946358, -2.2229292758064503, 74.78055827674251, 51.30708706891042, 29.25042314814014, 48.08485797463836, 21.83177547321482, 42.04189155513865, 66.98156949048911, 34.35697341954479, 21.48685828344083, 28.924282173555255, 64.73655349943371, 43.84115089646618, 34.21325493447507, 20.43140623720825, 29.33954853777802, 78.31905531754454, 5.673786802133463, 47.48381793981871, 49.27789959512781, 19.052430086274335, 20.971688894250256, 31.924244210553613, 88.5080639019271, 44.62547662693853, 46.39140682621519, 29.425706478553153, 80.35843874320251, 33.02187436502567, 41.11385833551492, 36.816716083576, 38.324536716282665, 39.10899029029794, 31.96135531390643, 11.631058784432419, -16.84592054667337, 35.90366092729785, 4.491365720676085, 12.451514128028334, 64.3429438453645, 8.96067441304666, 62.022688163024135, 44.5641476236413, 36.120740990445896, -31.182705718473464, 9.078793791410405, 41.48091988931609, 37.297007096320414, 34.67517894133198, 22.81735891586114, 43.95703787506922, 36.3830607962293, 36.80837219287482, -6.6072091686060865, 16.2644742670664, 23.93790672754121, 34.08637041588076, 25.71615628811938, 6.051164123709875, 62.00705873238923, 43.17626035537276, 72.86525996296905, 22.472847371407113, 10.939869517313618, 64.78733760098069, 52.756748315336864, 52.002245282777054, 62.3173569289101, 44.974205201400125, 67.54373616754798, 29.873806612540257, 43.52343873715738, 39.3932945390532, 52.216446103745255, 34.291233580960174, 20.394801214039852, 35.89200730855511, 58.04634153875927, 35.629896392806174, 50.441984425595116, 64.93487409336129, 13.549992614990567, 38.34159702956428, 26.430910902203834, 75.76411691731573, 12.310344714169435, 40.715371957339116, 13.729749610675164, 37.01236875513885, 0.6920768642835107, 56.35599565593469, -24.438869340656424, 50.59534606269089, 11.748886991775894, 6.207732959197081, 10.120606350827783, 58.78422355722273, 2.458951198563059], "policy_adversary_policy_reward": [9.013195004184151, 38.79584540898827, -9.601970568743809, -7.336097610719769, -4.995113509659255, 2.772184233852805, 35.71859243931755, 39.06196583742499, 27.28817970223315, 24.018907366677233, 4.743453915286835, 24.506969232853304, 34.014411700219505, 14.070446274418874, 8.20695540450025, 13.624820068714563, 2.4761339056706397, 39.56575764946802, 32.59184373294204, 34.389725757547076, 0.8093341968378693, 33.54763922270691, 5.479392941535984, 16.00746534190486, 30.23705285513875, -1.3127706815834888, 26.653085336529642, 38.08346816290407, 27.650012215859004, 16.191138680607164, 20.819023783792616, 13.39423115068246, 13.81444597315684, 6.616960264051411, 7.0605440957475825, 22.279004442030434, 43.04220181014679, 35.27685350739773, 17.915646919943626, -12.241860117810162, 24.10403889522287, 23.37977904459583, 31.455863419605034, 17.82203617552278, 7.137765118963239, 11.914664967311097, 21.635486848559946, -0.663797954309695, 23.678362765240337, 8.24588144531328, 46.3606282328126, 42.147435669114515, 16.51855205677726, 28.10692457016126, 10.07208320489464, 36.31932362132055, 26.04548279056907, 3.3802236879840777, 37.518491943112245, 42.83994680009027, 24.19172418032114, 8.830150184704534, 20.54701773372434, 20.566840601790574, 13.626847706442502, 23.189868377133493, 21.228603434074845, 17.09593328220782, 5.4422544402864546, 33.666735850011484, 26.21537589765689, 5.7459794162495434, 17.12232876971117, -5.491269985278748, 2.413045579355753, -19.25896612602913, 22.550511774269005, 13.353149153028843, 10.524331747973964, -6.032966027297878, 6.429377013413543, 6.022137114614791, 33.291219991789625, 31.051723853574874, 6.356640961018195, 2.604033452028464, 34.83981877907623, 27.182869383947903, 24.335927906796073, 20.228219716845224, 9.318555669631728, 26.802185320814175, -20.002174325345326, -11.180531393128142, 0.14655037907720825, 8.9322434123332, 24.556963059644467, 16.923956829671614, 7.985604985477195, 29.311402110843225, 18.36243380632258, 16.312745135009393, 3.8553672171535434, 18.961991698707596, 25.711618513175186, 18.245419361894022, 19.515307863483578, 16.867752932745724, 16.20372080298775, 20.604651389887067, 9.689522415210398, -16.296731583816484, 9.211254258747102, 7.053220008319299, 10.743500392297964, 13.194406335243247, 5.947929205681825, 28.138441210198934, 22.92528993662298, 2.7908663514963905, -2.178377738268987, 8.229541861978861, 17.53443661243889, 44.47262211995035, 27.834327977872995, 15.341932377499766, 36.646696101442714, 36.21856386152636, 24.890018390074736, -2.41717101866762, 21.294308594396085, -10.35443907708246, 38.65969184064173, 26.127645760338936, 24.258739810325746, 28.498008505011125, 21.779214077982083, 30.223031204794978, 32.02691340416572, 30.290443524744383, 22.772264529803895, 22.201940671596233, 44.856736699341326, 22.686999468206658, 17.09848053784346, 12.775326074696796, 17.505061639119436, 26.018377098037917, 32.09871171360462, 7.294582825448577, 22.184640836080135, 30.031805267665135, 23.422982856940934, 10.868250724019244, 28.646660417378456, -8.251859203338597, 14.864131853540119, 21.02787545501499, 22.990035307421046, 35.05630623133822, 11.966189160172028, 23.663707232634145, 26.96498949868236, 23.476994926912756, 44.087996955558054, 20.846877137803236, 6.541159135131359, 7.008833479859197, 22.272647744942844, 16.068949284621432, 15.026614486916316, 11.404296415287519, 35.066994166281226, 40.69712275103451, 14.486960738272149, -2.17661602410271, 25.326101047301908, 15.389270910037194, 6.63401069398072, 7.095738916694444, 19.42314662898294, 17.589222126155924, 10.172037941554976, -9.479961077271465, 47.09578000931534, 9.260215646619347, -9.486364526100385, -14.952504814556033, 14.315044208054218, 36.28030185463667, -4.228723108264784, 15.977610100040676, 3.369648232152006, 2.838084727045075, 1.5614236334514473, 8.559182717376334, 36.796816149992885, 21.98740740722985, 1.3157209833554155, 1.1432302152076437]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39211462184703394, "mean_inference_ms": 0.978212271248877, "mean_action_processing_ms": 0.1663952600256409, "mean_env_wait_ms": 0.0583070049054812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003362298011779785, "StateBufferConnector_ms": 0.0034471750259399414, "ViewRequirementAgentConnector_ms": 0.06516897678375244}, "num_episodes": 31, "episode_return_max": 177.01612780385426, "episode_return_min": -62.36541143694683, "episode_return_mean": 68.95765587442742}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 509.75823362736094, "num_env_steps_trained_throughput_per_sec": 509.75823362736094, "timesteps_total": 752000, "num_env_steps_sampled_lifetime": 752000, "num_agent_steps_sampled_lifetime": 2256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2256000, "timers": {"training_iteration_time_ms": 7888.367, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7888.332, "sample_time_ms": 727.005, "learn_time_ms": 7149.908, "learn_throughput": 559.448, "synch_weights_time_ms": 10.93}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "done": false, "training_iteration": 188, "trial_id": "eaa30_00000", "date": "2024-08-09_18-06-12", "timestamp": 1723241172, "time_this_iter_s": 7.851505756378174, "time_total_s": 1540.5461690425873, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17818aaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1540.5461690425873, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 23.900000000000002, "ram_util_percent": 79.52499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.13472842820107, "cur_kl_coeff": 0.5554617332648139, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.577801718913689, "policy_loss": -0.0015807944898143726, "vf_loss": 4.5762284551348005, "vf_explained_var": 0.07489034722721766, "kl": 0.005678254458190942, "entropy": 0.7168480960464982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.37275775099794, "cur_kl_coeff": 0.801672251232869, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.7394158308704695, "policy_loss": -0.002803401606555174, "vf_loss": 6.734846643110116, "vf_explained_var": 0.015870376490056515, "kl": 0.009196514963211182, "entropy": 0.9504245057081183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000}, "env_runners": {"episode_reward_max": 182.03865713171675, "episode_reward_min": -62.36541143694683, "episode_reward_mean": 62.632182797280095, "episode_len_mean": 139.64, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 13964, "policy_reward_min": {"agent_policy": -31.182705718473464, "adversary_policy": -20.002174325345326}, "policy_reward_max": {"agent_policy": 91.01932856585837, "adversary_policy": 47.09578000931534}, "policy_reward_mean": {"agent_policy": 31.316091398640054, "adversary_policy": 15.658045699320025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.25095325387703, 92.78281365243038, 58.8514129571063, 160.7168774864049, 66.04374873005135, 82.22771667102987, 73.63343216715195, 76.6490734325653, 78.21798058059584, 63.92271062781288, 23.262117568864824, -33.69184109334667, 71.80732185459573, 8.982731441352172, 24.903028256056672, 128.68588769072895, 17.92134882609332, 124.04537632604826, 89.12829524728258, 72.24148198089182, -62.36541143694683, 18.157587582820774, 82.96183977863213, 74.59401419264081, 69.35035788266394, 45.634717831722284, 87.91407575013841, 72.76612159245857, 73.61674438574966, -13.21441833721218, 32.528948534132795, 47.87581345508242, 68.17274083176156, 51.43231257623876, 12.102328247419752, 124.0141174647784, 86.35252071074552, 145.73051992593815, 44.945694742814226, 21.879739034627192, 129.57467520196136, 105.51349663067381, 104.00449056555402, 124.63471385782007, 89.9484104028003, 135.08747233509592, 59.74761322508053, 87.0468774743147, 78.7865890781064, 104.43289220749054, 68.58246716192033, 40.78960242807973, 71.78401461711019, 116.09268307751856, 71.25979278561236, 100.88396885119025, 129.8697481867225, 27.099985229981137, 76.6831940591286, 52.86182180440768, 151.5282338346315, 24.62068942833887, 81.43074391467827, 27.459499221350328, 74.0247375102777, 1.3841537285670213, 112.71199131186943, -48.87773868131276, 101.19069212538176, 23.497773983551767, 12.415465918394162, 20.241212701655563, 117.5684471144455, 4.917902397126118, 56.863798246015264, 25.618968430237892, 32.809963314214215, 18.181130954149396, 81.98456338612047, 6.068238392552665, 63.54297405661161, 104.5065991911301, 132.00816660651398, 24.788869900525974, 52.609985247035226, 10.06645043178974, 48.28839887017904, 47.655803094896825, 182.03865713171675, 31.48997190953562, 41.49238013722055, 12.210013932627284, 135.92782109949997, 43.797516233931304, 71.21444607469046, 41.36431726856347, -52.733013921993944, 8.551550108548867, 55.821189686999986, 54.21837385137327], "episode_lengths": [45, 200, 169, 200, 64, 200, 153, 200, 193, 200, 200, 200, 153, 21, 200, 148, 35, 91, 200, 56, 200, 200, 109, 170, 98, 87, 127, 65, 167, 200, 20, 200, 200, 191, 20, 89, 131, 147, 200, 200, 200, 200, 200, 200, 106, 102, 200, 81, 54, 51, 200, 200, 200, 75, 40, 111, 107, 200, 37, 200, 107, 28, 55, 200, 80, 200, 140, 200, 82, 200, 200, 62, 98, 1, 160, 25, 200, 40, 200, 200, 200, 200, 200, 21, 89, 4, 200, 200, 86, 200, 200, 200, 67, 200, 54, 200, 200, 200, 52, 200], "policy_agent_policy_reward": [44.62547662693853, 46.39140682621519, 29.425706478553153, 80.35843874320251, 33.02187436502567, 41.11385833551492, 36.816716083576, 38.324536716282665, 39.10899029029794, 31.96135531390643, 11.631058784432419, -16.84592054667337, 35.90366092729785, 4.491365720676085, 12.451514128028334, 64.3429438453645, 8.96067441304666, 62.022688163024135, 44.5641476236413, 36.120740990445896, -31.182705718473464, 9.078793791410405, 41.48091988931609, 37.297007096320414, 34.67517894133198, 22.81735891586114, 43.95703787506922, 36.3830607962293, 36.80837219287482, -6.6072091686060865, 16.2644742670664, 23.93790672754121, 34.08637041588076, 25.71615628811938, 6.051164123709875, 62.00705873238923, 43.17626035537276, 72.86525996296905, 22.472847371407113, 10.939869517313618, 64.78733760098069, 52.756748315336864, 52.002245282777054, 62.3173569289101, 44.974205201400125, 67.54373616754798, 29.873806612540257, 43.52343873715738, 39.3932945390532, 52.216446103745255, 34.291233580960174, 20.394801214039852, 35.89200730855511, 58.04634153875927, 35.629896392806174, 50.441984425595116, 64.93487409336129, 13.549992614990567, 38.34159702956428, 26.430910902203834, 75.76411691731573, 12.310344714169435, 40.715371957339116, 13.729749610675164, 37.01236875513885, 0.6920768642835107, 56.35599565593469, -24.438869340656424, 50.59534606269089, 11.748886991775894, 6.207732959197081, 10.120606350827783, 58.78422355722273, 2.458951198563059, 28.431899123007636, 12.809484215118943, 16.404981657107108, 9.090565477074696, 40.99228169306023, 3.034119196276311, 31.771487028305792, 52.25329959556508, 66.00408330325699, 12.394434950262989, 26.304992623517606, 5.033225215894871, 24.14419943508952, 23.827901547448413, 91.01932856585837, 15.74498595476781, 20.74619006861028, 6.105006966313667, 67.96391054974995, 21.89875811696565, 35.607223037345236, 20.68215863428173, -26.366506960996908, 4.27577505427443, 27.910594843499982, 27.109186925686643], "policy_adversary_policy_reward": [16.51855205677726, 28.10692457016126, 10.07208320489464, 36.31932362132055, 26.04548279056907, 3.3802236879840777, 37.518491943112245, 42.83994680009027, 24.19172418032114, 8.830150184704534, 20.54701773372434, 20.566840601790574, 13.626847706442502, 23.189868377133493, 21.228603434074845, 17.09593328220782, 5.4422544402864546, 33.666735850011484, 26.21537589765689, 5.7459794162495434, 17.12232876971117, -5.491269985278748, 2.413045579355753, -19.25896612602913, 22.550511774269005, 13.353149153028843, 10.524331747973964, -6.032966027297878, 6.429377013413543, 6.022137114614791, 33.291219991789625, 31.051723853574874, 6.356640961018195, 2.604033452028464, 34.83981877907623, 27.182869383947903, 24.335927906796073, 20.228219716845224, 9.318555669631728, 26.802185320814175, -20.002174325345326, -11.180531393128142, 0.14655037907720825, 8.9322434123332, 24.556963059644467, 16.923956829671614, 7.985604985477195, 29.311402110843225, 18.36243380632258, 16.312745135009393, 3.8553672171535434, 18.961991698707596, 25.711618513175186, 18.245419361894022, 19.515307863483578, 16.867752932745724, 16.20372080298775, 20.604651389887067, 9.689522415210398, -16.296731583816484, 9.211254258747102, 7.053220008319299, 10.743500392297964, 13.194406335243247, 5.947929205681825, 28.138441210198934, 22.92528993662298, 2.7908663514963905, -2.178377738268987, 8.229541861978861, 17.53443661243889, 44.47262211995035, 27.834327977872995, 15.341932377499766, 36.646696101442714, 36.21856386152636, 24.890018390074736, -2.41717101866762, 21.294308594396085, -10.35443907708246, 38.65969184064173, 26.127645760338936, 24.258739810325746, 28.498008505011125, 21.779214077982083, 30.223031204794978, 32.02691340416572, 30.290443524744383, 22.772264529803895, 22.201940671596233, 44.856736699341326, 22.686999468206658, 17.09848053784346, 12.775326074696796, 17.505061639119436, 26.018377098037917, 32.09871171360462, 7.294582825448577, 22.184640836080135, 30.031805267665135, 23.422982856940934, 10.868250724019244, 28.646660417378456, -8.251859203338597, 14.864131853540119, 21.02787545501499, 22.990035307421046, 35.05630623133822, 11.966189160172028, 23.663707232634145, 26.96498949868236, 23.476994926912756, 44.087996955558054, 20.846877137803236, 6.541159135131359, 7.008833479859197, 22.272647744942844, 16.068949284621432, 15.026614486916316, 11.404296415287519, 35.066994166281226, 40.69712275103451, 14.486960738272149, -2.17661602410271, 25.326101047301908, 15.389270910037194, 6.63401069398072, 7.095738916694444, 19.42314662898294, 17.589222126155924, 10.172037941554976, -9.479961077271465, 47.09578000931534, 9.260215646619347, -9.486364526100385, -14.952504814556033, 14.315044208054218, 36.28030185463667, -4.228723108264784, 15.977610100040676, 3.369648232152006, 2.838084727045075, 1.5614236334514473, 8.559182717376334, 36.796816149992885, 21.98740740722985, 1.3157209833554155, 1.1432302152076437, 22.999110850723156, 5.4327882722844825, -3.5738513305917152, 16.383335545710658, 11.351922324155488, 5.053059332951619, 5.4649151802705385, 3.6256502968041575, 8.36127123691664, 32.6310104561436, 0.48533195851309685, 2.5487872377632144, 16.117147303341735, 15.65433972496406, 26.23804517197423, 26.015254423590854, 22.716153887534276, 43.28792941572271, 8.552527626301588, 3.8419073239614008, -4.976110011015368, 31.281102634532974, 1.90748278978342, 3.125742426111451, 1.3667201883695252, 22.77747924672, 11.89154273509136, 11.936358812357053, 44.49568408340208, 46.523644482456234, -0.666905557185693, 16.411891511953502, 15.05496584625594, 5.6912242223543394, -11.074040185737774, 17.17904715205143, 36.1417779146712, 31.82213263507878, 7.511424557275399, 14.38733355969025, 27.998465150768624, 7.60875788657661, 11.527955709377444, 9.154202924904286, -17.46093216314199, -8.905574797854921, -7.85209043788576, 12.12786549216019, 24.458695994580058, 3.4518988489199245, 7.601786373263003, 19.50740055242364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39197771880524374, "mean_inference_ms": 0.9782474346193806, "mean_action_processing_ms": 0.16642009930906818, "mean_env_wait_ms": 0.05829677169976615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034875869750976562, "StateBufferConnector_ms": 0.0027942657470703125, "ViewRequirementAgentConnector_ms": 0.06704413890838623}, "num_episodes": 26, "episode_return_max": 182.03865713171675, "episode_return_min": -62.36541143694683, "episode_return_mean": 62.632182797280095}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 511.4460375133233, "num_env_steps_trained_throughput_per_sec": 511.4460375133233, "timesteps_total": 756000, "num_env_steps_sampled_lifetime": 756000, "num_agent_steps_sampled_lifetime": 2268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2268000, "timers": {"training_iteration_time_ms": 7877.054, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7877.02, "sample_time_ms": 728.985, "learn_time_ms": 7136.656, "learn_throughput": 560.487, "synch_weights_time_ms": 10.893}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000}, "done": false, "training_iteration": 189, "trial_id": "eaa30_00000", "date": "2024-08-09_18-06-20", "timestamp": 1723241180, "time_this_iter_s": 7.825446128845215, "time_total_s": 1548.3716151714325, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17818ae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1548.3716151714325, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 24.572727272727267, "ram_util_percent": 79.49090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.8111007941463, "cur_kl_coeff": 0.5554617332648139, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.287319619062717, "policy_loss": 0.0008502805662198514, "vf_loss": 5.281925046507013, "vf_explained_var": 0.09181123388507378, "kl": 0.00818112502170224, "entropy": 0.6825951799513802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.77998914793134, "cur_kl_coeff": 0.801672251232869, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.179805455605189, "policy_loss": 0.0019858634991881748, "vf_loss": 7.163217777013779, "vf_explained_var": 0.02132234616825978, "kl": 0.018214205477852373, "entropy": 0.9560898343722025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 181920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "env_runners": {"episode_reward_max": 183.0047160875753, "episode_reward_min": -52.733013921993944, "episode_reward_mean": 61.116876990693164, "episode_len_mean": 144.22, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 14422, "policy_reward_min": {"agent_policy": -26.366506960996908, "adversary_policy": -17.46093216314199}, "policy_reward_max": {"agent_policy": 91.50235804378767, "adversary_policy": 47.09578000931534}, "policy_reward_mean": {"agent_policy": 30.558438495346582, "adversary_policy": 15.279219247673291}, "custom_metrics": {}, "hist_stats": {"episode_reward": [87.91407575013841, 72.76612159245857, 73.61674438574966, -13.21441833721218, 32.528948534132795, 47.87581345508242, 68.17274083176156, 51.43231257623876, 12.102328247419752, 124.0141174647784, 86.35252071074552, 145.73051992593815, 44.945694742814226, 21.879739034627192, 129.57467520196136, 105.51349663067381, 104.00449056555402, 124.63471385782007, 89.9484104028003, 135.08747233509592, 59.74761322508053, 87.0468774743147, 78.7865890781064, 104.43289220749054, 68.58246716192033, 40.78960242807973, 71.78401461711019, 116.09268307751856, 71.25979278561236, 100.88396885119025, 129.8697481867225, 27.099985229981137, 76.6831940591286, 52.86182180440768, 151.5282338346315, 24.62068942833887, 81.43074391467827, 27.459499221350328, 74.0247375102777, 1.3841537285670213, 112.71199131186943, -48.87773868131276, 101.19069212538176, 23.497773983551767, 12.415465918394162, 20.241212701655563, 117.5684471144455, 4.917902397126118, 56.863798246015264, 25.618968430237892, 32.809963314214215, 18.181130954149396, 81.98456338612047, 6.068238392552665, 63.54297405661161, 104.5065991911301, 132.00816660651398, 24.788869900525974, 52.609985247035226, 10.06645043178974, 48.28839887017904, 47.655803094896825, 182.03865713171675, 31.48997190953562, 41.49238013722055, 12.210013932627284, 135.92782109949997, 43.797516233931304, 71.21444607469046, 41.36431726856347, -52.733013921993944, 8.551550108548867, 55.821189686999986, 54.21837385137327, 65.37906900492749, 72.11283012810296, 22.46847766766254, -16.140568984886897, 85.6251801352602, 100.82447285379502, 32.63044035282965, 81.02873191852646, 24.93632034824379, 75.32817971373993, 59.129589173704545, 183.0047160875753, 63.920712095338196, 75.86373945052121, 102.36076413418175, 46.261640486583346, 18.888668962269104, -6.6060767464667975, 81.60794841062578, -31.797668896395624, 22.414471649716923, 66.64045203622089, 40.43023985938987, 114.23761962513969, 28.339113068423863, 37.4959302954029], "episode_lengths": [127, 65, 167, 200, 20, 200, 200, 191, 20, 89, 131, 147, 200, 200, 200, 200, 200, 200, 106, 102, 200, 81, 54, 51, 200, 200, 200, 75, 40, 111, 107, 200, 37, 200, 107, 28, 55, 200, 80, 200, 140, 200, 82, 200, 200, 62, 98, 1, 160, 25, 200, 40, 200, 200, 200, 200, 200, 21, 89, 4, 200, 200, 86, 200, 200, 200, 67, 200, 54, 200, 200, 200, 52, 200, 200, 200, 200, 200, 200, 80, 200, 95, 7, 168, 200, 142, 72, 200, 112, 160, 21, 200, 200, 200, 200, 193, 200, 200, 200, 200], "policy_agent_policy_reward": [43.95703787506922, 36.3830607962293, 36.80837219287482, -6.6072091686060865, 16.2644742670664, 23.93790672754121, 34.08637041588076, 25.71615628811938, 6.051164123709875, 62.00705873238923, 43.17626035537276, 72.86525996296905, 22.472847371407113, 10.939869517313618, 64.78733760098069, 52.756748315336864, 52.002245282777054, 62.3173569289101, 44.974205201400125, 67.54373616754798, 29.873806612540257, 43.52343873715738, 39.3932945390532, 52.216446103745255, 34.291233580960174, 20.394801214039852, 35.89200730855511, 58.04634153875927, 35.629896392806174, 50.441984425595116, 64.93487409336129, 13.549992614990567, 38.34159702956428, 26.430910902203834, 75.76411691731573, 12.310344714169435, 40.715371957339116, 13.729749610675164, 37.01236875513885, 0.6920768642835107, 56.35599565593469, -24.438869340656424, 50.59534606269089, 11.748886991775894, 6.207732959197081, 10.120606350827783, 58.78422355722273, 2.458951198563059, 28.431899123007636, 12.809484215118943, 16.404981657107108, 9.090565477074696, 40.99228169306023, 3.034119196276311, 31.771487028305792, 52.25329959556508, 66.00408330325699, 12.394434950262989, 26.304992623517606, 5.033225215894871, 24.14419943508952, 23.827901547448413, 91.01932856585837, 15.74498595476781, 20.74619006861028, 6.105006966313667, 67.96391054974995, 21.89875811696565, 35.607223037345236, 20.68215863428173, -26.366506960996908, 4.27577505427443, 27.910594843499982, 27.109186925686643, 32.689534502463744, 36.056415064051464, 11.234238833831274, -8.070284492443427, 42.8125900676301, 50.41223642689751, 16.315220176414837, 40.51436595926322, 12.468160174121893, 37.66408985686998, 29.564794586852273, 91.50235804378767, 31.960356047669094, 37.93186972526061, 51.180382067090854, 23.13082024329169, 9.44433448113455, -3.3030383732334023, 40.803974205312905, -15.898834448197817, 11.207235824858461, 33.32022601811045, 20.215119929694957, 57.118809812569864, 14.169556534211925, 18.74796514770145], "policy_adversary_policy_reward": [25.711618513175186, 18.245419361894022, 19.515307863483578, 16.867752932745724, 16.20372080298775, 20.604651389887067, 9.689522415210398, -16.296731583816484, 9.211254258747102, 7.053220008319299, 10.743500392297964, 13.194406335243247, 5.947929205681825, 28.138441210198934, 22.92528993662298, 2.7908663514963905, -2.178377738268987, 8.229541861978861, 17.53443661243889, 44.47262211995035, 27.834327977872995, 15.341932377499766, 36.646696101442714, 36.21856386152636, 24.890018390074736, -2.41717101866762, 21.294308594396085, -10.35443907708246, 38.65969184064173, 26.127645760338936, 24.258739810325746, 28.498008505011125, 21.779214077982083, 30.223031204794978, 32.02691340416572, 30.290443524744383, 22.772264529803895, 22.201940671596233, 44.856736699341326, 22.686999468206658, 17.09848053784346, 12.775326074696796, 17.505061639119436, 26.018377098037917, 32.09871171360462, 7.294582825448577, 22.184640836080135, 30.031805267665135, 23.422982856940934, 10.868250724019244, 28.646660417378456, -8.251859203338597, 14.864131853540119, 21.02787545501499, 22.990035307421046, 35.05630623133822, 11.966189160172028, 23.663707232634145, 26.96498949868236, 23.476994926912756, 44.087996955558054, 20.846877137803236, 6.541159135131359, 7.008833479859197, 22.272647744942844, 16.068949284621432, 15.026614486916316, 11.404296415287519, 35.066994166281226, 40.69712275103451, 14.486960738272149, -2.17661602410271, 25.326101047301908, 15.389270910037194, 6.63401069398072, 7.095738916694444, 19.42314662898294, 17.589222126155924, 10.172037941554976, -9.479961077271465, 47.09578000931534, 9.260215646619347, -9.486364526100385, -14.952504814556033, 14.315044208054218, 36.28030185463667, -4.228723108264784, 15.977610100040676, 3.369648232152006, 2.838084727045075, 1.5614236334514473, 8.559182717376334, 36.796816149992885, 21.98740740722985, 1.3157209833554155, 1.1432302152076437, 22.999110850723156, 5.4327882722844825, -3.5738513305917152, 16.383335545710658, 11.351922324155488, 5.053059332951619, 5.4649151802705385, 3.6256502968041575, 8.36127123691664, 32.6310104561436, 0.48533195851309685, 2.5487872377632144, 16.117147303341735, 15.65433972496406, 26.23804517197423, 26.015254423590854, 22.716153887534276, 43.28792941572271, 8.552527626301588, 3.8419073239614008, -4.976110011015368, 31.281102634532974, 1.90748278978342, 3.125742426111451, 1.3667201883695252, 22.77747924672, 11.89154273509136, 11.936358812357053, 44.49568408340208, 46.523644482456234, -0.666905557185693, 16.411891511953502, 15.05496584625594, 5.6912242223543394, -11.074040185737774, 17.17904715205143, 36.1417779146712, 31.82213263507878, 7.511424557275399, 14.38733355969025, 27.998465150768624, 7.60875788657661, 11.527955709377444, 9.154202924904286, -17.46093216314199, -8.905574797854921, -7.85209043788576, 12.12786549216019, 24.458695994580058, 3.4518988489199245, 7.601786373263003, 19.50740055242364, 11.808582100730298, 20.880952401733445, 15.648724074285656, 20.407690989765808, 0.9350928788432054, 10.299145954988068, -4.251109223981249, -3.819175268462182, 35.92553918807566, 6.88705087955444, 37.29418074546358, 13.118055681433937, 5.445168022122402, 10.870052154292434, 24.45028126015115, 16.064084699112072, 4.505448566765526, 7.962711607356367, 16.95801274240307, 20.7060771144669, 18.102393055485244, 11.46240153136702, 45.88897829577205, 45.61337974801563, 16.493554903603496, 15.466801144065599, 18.526604892640425, 19.405264832620176, 37.45726389933601, 13.723118167754826, 3.088778028573108, 20.042042214718588, 11.339747779357076, -1.8954132982225254, -6.56376906313605, 3.2607306899026476, 13.654498390839144, 27.149475814473764, -12.680494765007623, -3.218339683190198, -0.5197539888078353, 11.726989813666297, 26.54410418725824, 6.776121830852219, 11.62244810587115, 8.592671823823808, 20.177630204154447, 36.9411796084154, 19.225062001218234, -5.055505467006309, 15.258273803823784, 3.4896913438776664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39186814544641096, "mean_inference_ms": 0.9777825732106732, "mean_action_processing_ms": 0.1662894045294921, "mean_env_wait_ms": 0.05827036720287402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033752918243408203, "StateBufferConnector_ms": 0.0027598142623901367, "ViewRequirementAgentConnector_ms": 0.06487905979156494}, "num_episodes": 26, "episode_return_max": 183.0047160875753, "episode_return_min": -52.733013921993944, "episode_return_mean": 61.116876990693164}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 507.05014884149585, "num_env_steps_trained_throughput_per_sec": 507.05014884149585, "timesteps_total": 760000, "num_env_steps_sampled_lifetime": 760000, "num_agent_steps_sampled_lifetime": 2280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2280000, "timers": {"training_iteration_time_ms": 7868.583, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7868.548, "sample_time_ms": 728.206, "learn_time_ms": 7128.899, "learn_throughput": 561.096, "synch_weights_time_ms": 10.957}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "done": false, "training_iteration": 190, "trial_id": "eaa30_00000", "date": "2024-08-09_18-06-28", "timestamp": 1723241188, "time_this_iter_s": 7.894195795059204, "time_total_s": 1556.2658109664917, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc6f5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1556.2658109664917, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 25.808333333333337, "ram_util_percent": 79.35833333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.287348427532843, "cur_kl_coeff": 0.5554617332648139, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.357446194451953, "policy_loss": -0.001042608639210581, "vf_loss": 5.35638460583157, "vf_explained_var": 0.08724150493662193, "kl": 0.0037882108639225994, "entropy": 0.672814071872247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.41600700120131, "cur_kl_coeff": 0.801672251232869, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.368731247882049, "policy_loss": 0.0025388897134689613, "vf_loss": 7.358460412919522, "vf_explained_var": 0.0774332795292139, "kl": 0.009644810418103588, "entropy": 0.9048038142422835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 182880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000}, "env_runners": {"episode_reward_max": 183.0047160875753, "episode_reward_min": -52.733013921993944, "episode_reward_mean": 56.107199632741214, "episode_len_mean": 143.76, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 14376, "policy_reward_min": {"agent_policy": -26.366506960996908, "adversary_policy": -21.871695326203426}, "policy_reward_max": {"agent_policy": 91.50235804378767, "adversary_policy": 47.09578000931534}, "policy_reward_mean": {"agent_policy": 28.053599816370607, "adversary_policy": 14.026799908185302}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.09268307751856, 71.25979278561236, 100.88396885119025, 129.8697481867225, 27.099985229981137, 76.6831940591286, 52.86182180440768, 151.5282338346315, 24.62068942833887, 81.43074391467827, 27.459499221350328, 74.0247375102777, 1.3841537285670213, 112.71199131186943, -48.87773868131276, 101.19069212538176, 23.497773983551767, 12.415465918394162, 20.241212701655563, 117.5684471144455, 4.917902397126118, 56.863798246015264, 25.618968430237892, 32.809963314214215, 18.181130954149396, 81.98456338612047, 6.068238392552665, 63.54297405661161, 104.5065991911301, 132.00816660651398, 24.788869900525974, 52.609985247035226, 10.06645043178974, 48.28839887017904, 47.655803094896825, 182.03865713171675, 31.48997190953562, 41.49238013722055, 12.210013932627284, 135.92782109949997, 43.797516233931304, 71.21444607469046, 41.36431726856347, -52.733013921993944, 8.551550108548867, 55.821189686999986, 54.21837385137327, 65.37906900492749, 72.11283012810296, 22.46847766766254, -16.140568984886897, 85.6251801352602, 100.82447285379502, 32.63044035282965, 81.02873191852646, 24.93632034824379, 75.32817971373993, 59.129589173704545, 183.0047160875753, 63.920712095338196, 75.86373945052121, 102.36076413418175, 46.261640486583346, 18.888668962269104, -6.6060767464667975, 81.60794841062578, -31.797668896395624, 22.414471649716923, 66.64045203622089, 40.43023985938987, 114.23761962513969, 28.339113068423863, 37.4959302954029, 50.495871403195636, 36.10183629818213, 31.081188427001706, 68.13771354192204, 106.24578160278571, 42.147581752414645, -23.774290883393505, 87.72327414362817, 115.59389914224775, 80.6370865911273, 89.72911339835366, 18.65305149949448, 72.05932322510029, 69.98978358869576, 125.19688279760031, 124.94858814784844, 51.821995076547225, 110.72991327952005, 46.5574261982525, 82.77933700819538, 8.982531389373904, -1.2301664611648206, -8.6215641319438, 47.89746729655652, 91.60736657560365, 22.281824542826822, 7.310022855513893], "episode_lengths": [75, 40, 111, 107, 200, 37, 200, 107, 28, 55, 200, 80, 200, 140, 200, 82, 200, 200, 62, 98, 1, 160, 25, 200, 40, 200, 200, 200, 200, 200, 21, 89, 4, 200, 200, 86, 200, 200, 200, 67, 200, 54, 200, 200, 200, 52, 200, 200, 200, 200, 200, 200, 80, 200, 95, 7, 168, 200, 142, 72, 200, 112, 160, 21, 200, 200, 200, 200, 193, 200, 200, 200, 200, 200, 200, 200, 200, 192, 200, 200, 99, 35, 200, 162, 10, 149, 200, 178, 89, 25, 200, 200, 119, 200, 4, 200, 71, 142, 30, 200], "policy_agent_policy_reward": [58.04634153875927, 35.629896392806174, 50.441984425595116, 64.93487409336129, 13.549992614990567, 38.34159702956428, 26.430910902203834, 75.76411691731573, 12.310344714169435, 40.715371957339116, 13.729749610675164, 37.01236875513885, 0.6920768642835107, 56.35599565593469, -24.438869340656424, 50.59534606269089, 11.748886991775894, 6.207732959197081, 10.120606350827783, 58.78422355722273, 2.458951198563059, 28.431899123007636, 12.809484215118943, 16.404981657107108, 9.090565477074696, 40.99228169306023, 3.034119196276311, 31.771487028305792, 52.25329959556508, 66.00408330325699, 12.394434950262989, 26.304992623517606, 5.033225215894871, 24.14419943508952, 23.827901547448413, 91.01932856585837, 15.74498595476781, 20.74619006861028, 6.105006966313667, 67.96391054974995, 21.89875811696565, 35.607223037345236, 20.68215863428173, -26.366506960996908, 4.27577505427443, 27.910594843499982, 27.109186925686643, 32.689534502463744, 36.056415064051464, 11.234238833831274, -8.070284492443427, 42.8125900676301, 50.41223642689751, 16.315220176414837, 40.51436595926322, 12.468160174121893, 37.66408985686998, 29.564794586852273, 91.50235804378767, 31.960356047669094, 37.93186972526061, 51.180382067090854, 23.13082024329169, 9.44433448113455, -3.3030383732334023, 40.803974205312905, -15.898834448197817, 11.207235824858461, 33.32022601811045, 20.215119929694957, 57.118809812569864, 14.169556534211925, 18.74796514770145, 25.247935701597818, 18.050918149091068, 15.540594213500846, 34.06885677096104, 53.122890801392835, 21.073790876207312, -11.887145441696767, 43.861637071814094, 57.79694957112388, 40.31854329556367, 44.8645566991768, 9.326525749747237, 36.02966161255014, 34.99489179434789, 62.598441398800134, 62.47429407392423, 25.91099753827361, 55.36495663976007, 23.278713099126243, 41.389668504097685, 4.491265694686952, -0.6150832305824103, -4.3107820659718925, 23.948733648278242, 45.803683287801846, 11.140912271413413, 3.6550114277569534], "policy_adversary_policy_reward": [22.990035307421046, 35.05630623133822, 11.966189160172028, 23.663707232634145, 26.96498949868236, 23.476994926912756, 44.087996955558054, 20.846877137803236, 6.541159135131359, 7.008833479859197, 22.272647744942844, 16.068949284621432, 15.026614486916316, 11.404296415287519, 35.066994166281226, 40.69712275103451, 14.486960738272149, -2.17661602410271, 25.326101047301908, 15.389270910037194, 6.63401069398072, 7.095738916694444, 19.42314662898294, 17.589222126155924, 10.172037941554976, -9.479961077271465, 47.09578000931534, 9.260215646619347, -9.486364526100385, -14.952504814556033, 14.315044208054218, 36.28030185463667, -4.228723108264784, 15.977610100040676, 3.369648232152006, 2.838084727045075, 1.5614236334514473, 8.559182717376334, 36.796816149992885, 21.98740740722985, 1.3157209833554155, 1.1432302152076437, 22.999110850723156, 5.4327882722844825, -3.5738513305917152, 16.383335545710658, 11.351922324155488, 5.053059332951619, 5.4649151802705385, 3.6256502968041575, 8.36127123691664, 32.6310104561436, 0.48533195851309685, 2.5487872377632144, 16.117147303341735, 15.65433972496406, 26.23804517197423, 26.015254423590854, 22.716153887534276, 43.28792941572271, 8.552527626301588, 3.8419073239614008, -4.976110011015368, 31.281102634532974, 1.90748278978342, 3.125742426111451, 1.3667201883695252, 22.77747924672, 11.89154273509136, 11.936358812357053, 44.49568408340208, 46.523644482456234, -0.666905557185693, 16.411891511953502, 15.05496584625594, 5.6912242223543394, -11.074040185737774, 17.17904715205143, 36.1417779146712, 31.82213263507878, 7.511424557275399, 14.38733355969025, 27.998465150768624, 7.60875788657661, 11.527955709377444, 9.154202924904286, -17.46093216314199, -8.905574797854921, -7.85209043788576, 12.12786549216019, 24.458695994580058, 3.4518988489199245, 7.601786373263003, 19.50740055242364, 11.808582100730298, 20.880952401733445, 15.648724074285656, 20.407690989765808, 0.9350928788432054, 10.299145954988068, -4.251109223981249, -3.819175268462182, 35.92553918807566, 6.88705087955444, 37.29418074546358, 13.118055681433937, 5.445168022122402, 10.870052154292434, 24.45028126015115, 16.064084699112072, 4.505448566765526, 7.962711607356367, 16.95801274240307, 20.7060771144669, 18.102393055485244, 11.46240153136702, 45.88897829577205, 45.61337974801563, 16.493554903603496, 15.466801144065599, 18.526604892640425, 19.405264832620176, 37.45726389933601, 13.723118167754826, 3.088778028573108, 20.042042214718588, 11.339747779357076, -1.8954132982225254, -6.56376906313605, 3.2607306899026476, 13.654498390839144, 27.149475814473764, -12.680494765007623, -3.218339683190198, -0.5197539888078353, 11.726989813666297, 26.54410418725824, 6.776121830852219, 11.62244810587115, 8.592671823823808, 20.177630204154447, 36.9411796084154, 19.225062001218234, -5.055505467006309, 15.258273803823784, 3.4896913438776664, 7.624629277070412, 17.6233064245274, 29.401295471152842, -11.350377322061782, 3.7527908660658946, 11.787803347434956, 8.804669172055227, 25.264187598905817, 19.5338389828496, 33.58905181854323, 5.613895924850066, 15.459894951357247, 9.98454988450666, -21.871695326203426, 3.120311576391188, 40.7413254954229, 26.845446343851858, 30.951503227272024, 5.492185542752765, 34.8263577528109, 23.65474381609523, 21.209812883081568, 3.8584224504793854, 5.468103299267852, 14.728505476042354, 21.301156136507792, 18.32585741100999, 16.669034383337895, 27.584533311457363, 35.013908087342784, 39.92801717936878, 22.54627689455544, 16.300003129900315, 9.61099440837329, 27.559674913240293, 27.805281726519766, 5.670666911108018, 17.60804618801822, 13.704972368649372, 27.684696135448313, 2.563895332020895, 1.927370362666057, -2.479313224296199, 1.8642299937137885, 7.654635257918258, -11.965417323890158, 12.849177987555354, 11.099555660722892, 8.393670771790411, 37.41001251601143, -9.02521063852578, 20.16612290993919, 3.373268913491099, 0.2817425142658543]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39159288736183634, "mean_inference_ms": 0.9776208289899978, "mean_action_processing_ms": 0.16622376566836486, "mean_env_wait_ms": 0.05822643372374489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003481268882751465, "StateBufferConnector_ms": 0.0024756193161010742, "ViewRequirementAgentConnector_ms": 0.06495487689971924}, "num_episodes": 27, "episode_return_max": 183.0047160875753, "episode_return_min": -52.733013921993944, "episode_return_mean": 56.107199632741214}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 508.1663125722641, "num_env_steps_trained_throughput_per_sec": 508.1663125722641, "timesteps_total": 764000, "num_env_steps_sampled_lifetime": 764000, "num_agent_steps_sampled_lifetime": 2292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2292000, "timers": {"training_iteration_time_ms": 7862.551, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7862.515, "sample_time_ms": 729.186, "learn_time_ms": 7121.899, "learn_throughput": 561.648, "synch_weights_time_ms": 10.916}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000}, "done": false, "training_iteration": 191, "trial_id": "eaa30_00000", "date": "2024-08-09_18-06-36", "timestamp": 1723241196, "time_this_iter_s": 7.875458002090454, "time_total_s": 1564.1412689685822, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc6f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1564.1412689685822, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 24.436363636363637, "ram_util_percent": 79.37272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.896909047813012, "cur_kl_coeff": 0.2777308666324069, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.47134444448683, "policy_loss": -0.001678740476607961, "vf_loss": 5.470961384041599, "vf_explained_var": 0.06893624638123487, "kl": 0.007423778518383938, "entropy": 0.6564276667814406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.157136483242116, "cur_kl_coeff": 0.801672251232869, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.260024877885978, "policy_loss": 0.00662125905121987, "vf_loss": 7.247700737416745, "vf_explained_var": 0.02445891040066878, "kl": 0.007113720698301526, "entropy": 0.8816530081753929, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 183840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "env_runners": {"episode_reward_max": 183.0047160875753, "episode_reward_min": -63.63939086243175, "episode_reward_mean": 55.4572011688287, "episode_len_mean": 147.87, "episode_media": {}, "episodes_this_iter": 29, "episodes_timesteps_total": 14787, "policy_reward_min": {"agent_policy": -31.819695431215905, "adversary_policy": -21.971188725516654}, "policy_reward_max": {"agent_policy": 91.50235804378767, "adversary_policy": 46.523644482456234}, "policy_reward_mean": {"agent_policy": 27.72860058441435, "adversary_policy": 13.864300292207176}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.00816660651398, 24.788869900525974, 52.609985247035226, 10.06645043178974, 48.28839887017904, 47.655803094896825, 182.03865713171675, 31.48997190953562, 41.49238013722055, 12.210013932627284, 135.92782109949997, 43.797516233931304, 71.21444607469046, 41.36431726856347, -52.733013921993944, 8.551550108548867, 55.821189686999986, 54.21837385137327, 65.37906900492749, 72.11283012810296, 22.46847766766254, -16.140568984886897, 85.6251801352602, 100.82447285379502, 32.63044035282965, 81.02873191852646, 24.93632034824379, 75.32817971373993, 59.129589173704545, 183.0047160875753, 63.920712095338196, 75.86373945052121, 102.36076413418175, 46.261640486583346, 18.888668962269104, -6.6060767464667975, 81.60794841062578, -31.797668896395624, 22.414471649716923, 66.64045203622089, 40.43023985938987, 114.23761962513969, 28.339113068423863, 37.4959302954029, 50.495871403195636, 36.10183629818213, 31.081188427001706, 68.13771354192204, 106.24578160278571, 42.147581752414645, -23.774290883393505, 87.72327414362817, 115.59389914224775, 80.6370865911273, 89.72911339835366, 18.65305149949448, 72.05932322510029, 69.98978358869576, 125.19688279760031, 124.94858814784844, 51.821995076547225, 110.72991327952005, 46.5574261982525, 82.77933700819538, 8.982531389373904, -1.2301664611648206, -8.6215641319438, 47.89746729655652, 91.60736657560365, 22.281824542826822, 7.310022855513893, 53.476843860558716, 89.0381392057737, 84.76474290899776, 1.3425722891349494, 4.609044497522859, -63.63939086243175, 92.28232196582155, 68.87468276629497, 56.3131708188876, 24.335089630398652, 91.472297976412, 4.746880060767974, 109.93868835077903, 157.95029390114428, 39.41600462799155, 139.6167993861666, 116.54678015600945, 105.440278226999, 66.55813126364596, 105.77759174428272, 47.88236617641006, -23.283990399080935, -30.173008453707382, 113.86080232470107, 11.853272734653217, 25.000612586143177, 52.32312364531897, 53.10805243845353, 4.009194255248929], "episode_lengths": [200, 21, 89, 4, 200, 200, 86, 200, 200, 200, 67, 200, 54, 200, 200, 200, 52, 200, 200, 200, 200, 200, 200, 80, 200, 95, 7, 168, 200, 142, 72, 200, 112, 160, 21, 200, 200, 200, 200, 193, 200, 200, 200, 200, 200, 200, 200, 200, 192, 200, 200, 99, 35, 200, 162, 10, 149, 200, 178, 89, 25, 200, 200, 119, 200, 4, 200, 71, 142, 30, 200, 101, 200, 83, 200, 200, 200, 84, 200, 46, 35, 200, 8, 51, 56, 104, 76, 102, 54, 73, 186, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [66.00408330325699, 12.394434950262989, 26.304992623517606, 5.033225215894871, 24.14419943508952, 23.827901547448413, 91.01932856585837, 15.74498595476781, 20.74619006861028, 6.105006966313667, 67.96391054974995, 21.89875811696565, 35.607223037345236, 20.68215863428173, -26.366506960996908, 4.27577505427443, 27.910594843499982, 27.109186925686643, 32.689534502463744, 36.056415064051464, 11.234238833831274, -8.070284492443427, 42.8125900676301, 50.41223642689751, 16.315220176414837, 40.51436595926322, 12.468160174121893, 37.66408985686998, 29.564794586852273, 91.50235804378767, 31.960356047669094, 37.93186972526061, 51.180382067090854, 23.13082024329169, 9.44433448113455, -3.3030383732334023, 40.803974205312905, -15.898834448197817, 11.207235824858461, 33.32022601811045, 20.215119929694957, 57.118809812569864, 14.169556534211925, 18.74796514770145, 25.247935701597818, 18.050918149091068, 15.540594213500846, 34.06885677096104, 53.122890801392835, 21.073790876207312, -11.887145441696767, 43.861637071814094, 57.79694957112388, 40.31854329556367, 44.8645566991768, 9.326525749747237, 36.02966161255014, 34.99489179434789, 62.598441398800134, 62.47429407392423, 25.91099753827361, 55.36495663976007, 23.278713099126243, 41.389668504097685, 4.491265694686952, -0.6150832305824103, -4.3107820659718925, 23.948733648278242, 45.803683287801846, 11.140912271413413, 3.6550114277569534, 26.738421930279358, 44.51906960288686, 42.38237145449888, 0.6712861445674747, 2.304522248761419, -31.819695431215905, 46.14116098291078, 34.43734138314748, 28.1565854094438, 12.16754481519933, 45.736148988206054, 2.373440030383987, 54.96934417538952, 78.97514695057211, 19.70800231399578, 69.8083996930833, 58.273390078004695, 52.72013911349947, 33.27906563182299, 52.888795872141344, 23.941183088205037, -11.64199519954046, -15.086504226853663, 56.93040116235052, 5.926636367326587, 12.500306293071588, 26.161561822659486, 26.554026219226774, 2.0045971276244643], "policy_adversary_policy_reward": [22.716153887534276, 43.28792941572271, 8.552527626301588, 3.8419073239614008, -4.976110011015368, 31.281102634532974, 1.90748278978342, 3.125742426111451, 1.3667201883695252, 22.77747924672, 11.89154273509136, 11.936358812357053, 44.49568408340208, 46.523644482456234, -0.666905557185693, 16.411891511953502, 15.05496584625594, 5.6912242223543394, -11.074040185737774, 17.17904715205143, 36.1417779146712, 31.82213263507878, 7.511424557275399, 14.38733355969025, 27.998465150768624, 7.60875788657661, 11.527955709377444, 9.154202924904286, -17.46093216314199, -8.905574797854921, -7.85209043788576, 12.12786549216019, 24.458695994580058, 3.4518988489199245, 7.601786373263003, 19.50740055242364, 11.808582100730298, 20.880952401733445, 15.648724074285656, 20.407690989765808, 0.9350928788432054, 10.299145954988068, -4.251109223981249, -3.819175268462182, 35.92553918807566, 6.88705087955444, 37.29418074546358, 13.118055681433937, 5.445168022122402, 10.870052154292434, 24.45028126015115, 16.064084699112072, 4.505448566765526, 7.962711607356367, 16.95801274240307, 20.7060771144669, 18.102393055485244, 11.46240153136702, 45.88897829577205, 45.61337974801563, 16.493554903603496, 15.466801144065599, 18.526604892640425, 19.405264832620176, 37.45726389933601, 13.723118167754826, 3.088778028573108, 20.042042214718588, 11.339747779357076, -1.8954132982225254, -6.56376906313605, 3.2607306899026476, 13.654498390839144, 27.149475814473764, -12.680494765007623, -3.218339683190198, -0.5197539888078353, 11.726989813666297, 26.54410418725824, 6.776121830852219, 11.62244810587115, 8.592671823823808, 20.177630204154447, 36.9411796084154, 19.225062001218234, -5.055505467006309, 15.258273803823784, 3.4896913438776664, 7.624629277070412, 17.6233064245274, 29.401295471152842, -11.350377322061782, 3.7527908660658946, 11.787803347434956, 8.804669172055227, 25.264187598905817, 19.5338389828496, 33.58905181854323, 5.613895924850066, 15.459894951357247, 9.98454988450666, -21.871695326203426, 3.120311576391188, 40.7413254954229, 26.845446343851858, 30.951503227272024, 5.492185542752765, 34.8263577528109, 23.65474381609523, 21.209812883081568, 3.8584224504793854, 5.468103299267852, 14.728505476042354, 21.301156136507792, 18.32585741100999, 16.669034383337895, 27.584533311457363, 35.013908087342784, 39.92801717936878, 22.54627689455544, 16.300003129900315, 9.61099440837329, 27.559674913240293, 27.805281726519766, 5.670666911108018, 17.60804618801822, 13.704972368649372, 27.684696135448313, 2.563895332020895, 1.927370362666057, -2.479313224296199, 1.8642299937137885, 7.654635257918258, -11.965417323890158, 12.849177987555354, 11.099555660722892, 8.393670771790411, 37.41001251601143, -9.02521063852578, 20.16612290993919, 3.373268913491099, 0.2817425142658543, 14.50684345590511, 12.231578474374249, 23.05436124646744, 21.46470835641943, 21.273094392897296, 21.109277061601585, -1.9863450147475206, 2.6576311593149953, 2.279772685857399, 0.024749562904020195, -21.971188725516654, -9.848506705699243, 21.254983886278218, 24.88617709663258, 19.271037137349595, 15.166304245797885, 16.80612500396417, 11.350460405479637, 22.190495785736534, -10.02295097053721, 26.082089167118053, 19.654059821087973, 4.390242885315557, -2.0168028549315693, 9.860861868081384, 45.10848230730814, 41.89780149377352, 37.07734545679861, 14.088030398571277, 5.619971915424505, 46.34749689191379, 23.46090280116951, 19.524629293119084, 38.7487607848856, 17.814806216065346, 34.905332897434114, 22.942016518366668, 10.337049113456317, 16.54562876456849, 36.34316710757285, 11.106036717325193, 12.835146370879844, -12.484074111556449, 0.8420789120159853, -6.261133484118847, -8.825370742734819, 36.067469376172454, 20.862931786178066, 15.201921394644263, -9.275285027317683, 21.57745576323296, -9.077149470161373, 15.63895362032373, 10.522608202335757, 17.853200341610783, 8.700825877615996, 1.9344809513757042, 0.0701161762487601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3915235347995331, "mean_inference_ms": 0.976148681455257, "mean_action_processing_ms": 0.16622872119788623, "mean_env_wait_ms": 0.058230095376891305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035881996154785156, "StateBufferConnector_ms": 0.0024459362030029297, "ViewRequirementAgentConnector_ms": 0.064308762550354}, "num_episodes": 29, "episode_return_max": 183.0047160875753, "episode_return_min": -63.63939086243175, "episode_return_mean": 55.4572011688287}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 507.12390031747657, "num_env_steps_trained_throughput_per_sec": 507.12390031747657, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 2304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2304000, "timers": {"training_iteration_time_ms": 7852.483, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7852.448, "sample_time_ms": 733.606, "learn_time_ms": 7107.214, "learn_throughput": 562.808, "synch_weights_time_ms": 11.067}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "done": false, "training_iteration": 192, "trial_id": "eaa30_00000", "date": "2024-08-09_18-06-44", "timestamp": 1723241204, "time_this_iter_s": 7.892438888549805, "time_total_s": 1572.033707857132, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc920d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1572.033707857132, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 23.8, "ram_util_percent": 78.94545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.624164586723166, "cur_kl_coeff": 0.2777308666324069, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.745860140916531, "policy_loss": -0.0006636309970869984, "vf_loss": 5.744656462644143, "vf_explained_var": 0.06324141236840101, "kl": 0.006723468387425537, "entropy": 0.6896092311415092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.67884753483037, "cur_kl_coeff": 0.801672251232869, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.450362638632456, "policy_loss": 0.005889861746497142, "vf_loss": 7.436497334142526, "vf_explained_var": 0.0499497052282095, "kl": 0.009948507989368712, "entropy": 0.8297219997892777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 184800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000}, "env_runners": {"episode_reward_max": 157.95029390114428, "episode_reward_min": -63.63939086243175, "episode_reward_mean": 59.52675178897983, "episode_len_mean": 142.68, "episode_media": {}, "episodes_this_iter": 31, "episodes_timesteps_total": 14268, "policy_reward_min": {"agent_policy": -31.819695431215905, "adversary_policy": -21.971188725516654}, "policy_reward_max": {"agent_policy": 78.97514695057211, "adversary_policy": 47.303794702423644}, "policy_reward_mean": {"agent_policy": 29.763375894489915, "adversary_policy": 14.881687947244954}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.86373945052121, 102.36076413418175, 46.261640486583346, 18.888668962269104, -6.6060767464667975, 81.60794841062578, -31.797668896395624, 22.414471649716923, 66.64045203622089, 40.43023985938987, 114.23761962513969, 28.339113068423863, 37.4959302954029, 50.495871403195636, 36.10183629818213, 31.081188427001706, 68.13771354192204, 106.24578160278571, 42.147581752414645, -23.774290883393505, 87.72327414362817, 115.59389914224775, 80.6370865911273, 89.72911339835366, 18.65305149949448, 72.05932322510029, 69.98978358869576, 125.19688279760031, 124.94858814784844, 51.821995076547225, 110.72991327952005, 46.5574261982525, 82.77933700819538, 8.982531389373904, -1.2301664611648206, -8.6215641319438, 47.89746729655652, 91.60736657560365, 22.281824542826822, 7.310022855513893, 53.476843860558716, 89.0381392057737, 84.76474290899776, 1.3425722891349494, 4.609044497522859, -63.63939086243175, 92.28232196582155, 68.87468276629497, 56.3131708188876, 24.335089630398652, 91.472297976412, 4.746880060767974, 109.93868835077903, 157.95029390114428, 39.41600462799155, 139.6167993861666, 116.54678015600945, 105.440278226999, 66.55813126364596, 105.77759174428272, 47.88236617641006, -23.283990399080935, -30.173008453707382, 113.86080232470107, 11.853272734653217, 25.000612586143177, 52.32312364531897, 53.10805243845353, 4.009194255248929, 110.27323997037868, 100.6851119058654, 21.07372854459352, 138.1547566462473, 77.37572901147118, 39.28078796904706, -8.248549708720297, 73.7397846482831, 111.771448295385, 114.4525218678146, 36.09093729333712, 82.38922244729092, 87.8299097828602, 81.30694255642483, 125.53435250225, 84.26642452335896, 106.70246671963835, 30.609290463394387, 45.30807999133141, 0.6548878944025045, 122.88842696334602, 11.919021727961045, -20.98548427076026, 98.5677197365228, 134.6148495725, 55.66360974420059, 153.6797593693588, 24.427115654208748, 59.39978646546922, 101.38674514110505, -2.79851325498141], "episode_lengths": [200, 112, 160, 21, 200, 200, 200, 200, 193, 200, 200, 200, 200, 200, 200, 200, 200, 192, 200, 200, 99, 35, 200, 162, 10, 149, 200, 178, 89, 25, 200, 200, 119, 200, 4, 200, 71, 142, 30, 200, 101, 200, 83, 200, 200, 200, 84, 200, 46, 35, 200, 8, 51, 56, 104, 76, 102, 54, 73, 186, 200, 200, 200, 200, 200, 200, 200, 200, 200, 149, 45, 29, 145, 200, 200, 200, 200, 200, 122, 25, 200, 200, 66, 42, 120, 200, 13, 63, 20, 56, 200, 200, 200, 61, 195, 61, 200, 200, 200, 6], "policy_agent_policy_reward": [37.93186972526061, 51.180382067090854, 23.13082024329169, 9.44433448113455, -3.3030383732334023, 40.803974205312905, -15.898834448197817, 11.207235824858461, 33.32022601811045, 20.215119929694957, 57.118809812569864, 14.169556534211925, 18.74796514770145, 25.247935701597818, 18.050918149091068, 15.540594213500846, 34.06885677096104, 53.122890801392835, 21.073790876207312, -11.887145441696767, 43.861637071814094, 57.79694957112388, 40.31854329556367, 44.8645566991768, 9.326525749747237, 36.02966161255014, 34.99489179434789, 62.598441398800134, 62.47429407392423, 25.91099753827361, 55.36495663976007, 23.278713099126243, 41.389668504097685, 4.491265694686952, -0.6150832305824103, -4.3107820659718925, 23.948733648278242, 45.803683287801846, 11.140912271413413, 3.6550114277569534, 26.738421930279358, 44.51906960288686, 42.38237145449888, 0.6712861445674747, 2.304522248761419, -31.819695431215905, 46.14116098291078, 34.43734138314748, 28.1565854094438, 12.16754481519933, 45.736148988206054, 2.373440030383987, 54.96934417538952, 78.97514695057211, 19.70800231399578, 69.8083996930833, 58.273390078004695, 52.72013911349947, 33.27906563182299, 52.888795872141344, 23.941183088205037, -11.64199519954046, -15.086504226853663, 56.93040116235052, 5.926636367326587, 12.500306293071588, 26.161561822659486, 26.554026219226774, 2.0045971276244643, 55.136619985189355, 50.34255595293271, 10.53686427229676, 69.07737832312365, 38.687864505735604, 19.64039398452354, -4.124274854360166, 36.869892324141546, 55.8857241476925, 57.2262609339073, 18.045468646668546, 41.19461122364548, 43.914954891430085, 40.65347127821242, 62.76717625112501, 42.133212261679446, 53.351233359819176, 15.304645231697195, 22.654039995665713, 0.3274439472012536, 61.44421348167301, 5.95951086398054, -10.492742135380134, 49.283859868261445, 67.30742478624998, 27.8318048721003, 76.83987968467936, 12.213557827104356, 29.69989323273461, 50.69337257055254, -1.3992566274907055], "policy_adversary_policy_reward": [18.526604892640425, 19.405264832620176, 37.45726389933601, 13.723118167754826, 3.088778028573108, 20.042042214718588, 11.339747779357076, -1.8954132982225254, -6.56376906313605, 3.2607306899026476, 13.654498390839144, 27.149475814473764, -12.680494765007623, -3.218339683190198, -0.5197539888078353, 11.726989813666297, 26.54410418725824, 6.776121830852219, 11.62244810587115, 8.592671823823808, 20.177630204154447, 36.9411796084154, 19.225062001218234, -5.055505467006309, 15.258273803823784, 3.4896913438776664, 7.624629277070412, 17.6233064245274, 29.401295471152842, -11.350377322061782, 3.7527908660658946, 11.787803347434956, 8.804669172055227, 25.264187598905817, 19.5338389828496, 33.58905181854323, 5.613895924850066, 15.459894951357247, 9.98454988450666, -21.871695326203426, 3.120311576391188, 40.7413254954229, 26.845446343851858, 30.951503227272024, 5.492185542752765, 34.8263577528109, 23.65474381609523, 21.209812883081568, 3.8584224504793854, 5.468103299267852, 14.728505476042354, 21.301156136507792, 18.32585741100999, 16.669034383337895, 27.584533311457363, 35.013908087342784, 39.92801717936878, 22.54627689455544, 16.300003129900315, 9.61099440837329, 27.559674913240293, 27.805281726519766, 5.670666911108018, 17.60804618801822, 13.704972368649372, 27.684696135448313, 2.563895332020895, 1.927370362666057, -2.479313224296199, 1.8642299937137885, 7.654635257918258, -11.965417323890158, 12.849177987555354, 11.099555660722892, 8.393670771790411, 37.41001251601143, -9.02521063852578, 20.16612290993919, 3.373268913491099, 0.2817425142658543, 14.50684345590511, 12.231578474374249, 23.05436124646744, 21.46470835641943, 21.273094392897296, 21.109277061601585, -1.9863450147475206, 2.6576311593149953, 2.279772685857399, 0.024749562904020195, -21.971188725516654, -9.848506705699243, 21.254983886278218, 24.88617709663258, 19.271037137349595, 15.166304245797885, 16.80612500396417, 11.350460405479637, 22.190495785736534, -10.02295097053721, 26.082089167118053, 19.654059821087973, 4.390242885315557, -2.0168028549315693, 9.860861868081384, 45.10848230730814, 41.89780149377352, 37.07734545679861, 14.088030398571277, 5.619971915424505, 46.34749689191379, 23.46090280116951, 19.524629293119084, 38.7487607848856, 17.814806216065346, 34.905332897434114, 22.942016518366668, 10.337049113456317, 16.54562876456849, 36.34316710757285, 11.106036717325193, 12.835146370879844, -12.484074111556449, 0.8420789120159853, -6.261133484118847, -8.825370742734819, 36.067469376172454, 20.862931786178066, 15.201921394644263, -9.275285027317683, 21.57745576323296, -9.077149470161373, 15.63895362032373, 10.522608202335757, 17.853200341610783, 8.700825877615996, 1.9344809513757042, 0.0701161762487601, 33.46317054219036, 21.673449442998955, 26.006829024802474, 24.33572692813022, -14.58225316057139, 25.119117432868144, 24.39329857526258, 44.68407974786108, 21.087712521227502, 17.6001519845081, 11.064150312826591, 8.576243671696949, -4.794614487962278, 0.6703396336021115, 8.326334510736933, 28.543557813404618, 28.008658190049434, 27.877065957643065, 29.11414751105177, 28.112113422855522, 20.548409858455898, -2.502941211787352, 12.965604797041745, 28.229006426603732, 18.71958860535641, 25.19536628607367, 23.81027484114659, 16.843196437065828, 45.736894184872355, 17.03028206625264, 20.177768123312852, 21.95544413836661, 33.08852373413633, 20.262709625682835, 6.929289567697331, 8.375355663999866, -19.437857529887495, 42.09189752555321, 8.069075927272653, -7.7416319800714, 47.202918334726846, 14.241295146946154, -6.734081673351419, 12.693592537331963, -11.114739064128191, 0.6219969287480644, 17.053830955765257, 32.23002891249619, 47.303794702423644, 20.003630083826327, 9.116719273507897, 18.715085598592395, 34.829577618027876, 42.01030206665153, 2.7458040762155314, 9.467753750888825, 14.892305399534568, 14.807587833200042, 30.987638030028407, 19.705734540524126, -5.6229168442323285, 4.223660216741623]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3916308180761417, "mean_inference_ms": 0.9761060781343321, "mean_action_processing_ms": 0.1661314591518712, "mean_env_wait_ms": 0.05822975391440341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035039186477661133, "StateBufferConnector_ms": 0.0024003982543945312, "ViewRequirementAgentConnector_ms": 0.06561660766601562}, "num_episodes": 31, "episode_return_max": 157.95029390114428, "episode_return_min": -63.63939086243175, "episode_return_mean": 59.52675178897983}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.81552745163316, "num_env_steps_trained_throughput_per_sec": 500.81552745163316, "timesteps_total": 772000, "num_env_steps_sampled_lifetime": 772000, "num_agent_steps_sampled_lifetime": 2316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2316000, "timers": {"training_iteration_time_ms": 7854.048, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7854.013, "sample_time_ms": 741.834, "learn_time_ms": 7100.523, "learn_throughput": 563.339, "synch_weights_time_ms": 11.066}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000}, "done": false, "training_iteration": 193, "trial_id": "eaa30_00000", "date": "2024-08-09_18-06-52", "timestamp": 1723241212, "time_this_iter_s": 7.991789102554321, "time_total_s": 1580.0254969596863, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781a09d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1580.0254969596863, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 24.641666666666666, "ram_util_percent": 78.25833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.523704182281696, "cur_kl_coeff": 0.2777308666324069, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.610420541914682, "policy_loss": -0.0035840159798257803, "vf_loss": 5.6039074060147405, "vf_explained_var": 0.4015096719618197, "kl": 0.0363558942225402, "entropy": 0.9547465043723898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.19649306659897, "cur_kl_coeff": 0.801672251232869, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.543223377565543, "policy_loss": -0.0019503442158262867, "vf_loss": 7.541705504059792, "vf_explained_var": 0.1314680806050698, "kl": 0.004326223901928946, "entropy": 0.8283132481078307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 185760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000}, "env_runners": {"episode_reward_max": 164.48693693801198, "episode_reward_min": -76.8804810436975, "episode_reward_mean": 53.43845474330367, "episode_len_mean": 141.29, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 14129, "policy_reward_min": {"agent_policy": -38.44024052184885, "adversary_policy": -37.592949564859836}, "policy_reward_max": {"agent_policy": 82.24346846900602, "adversary_policy": 47.303794702423644}, "policy_reward_mean": {"agent_policy": 26.719227371651836, "adversary_policy": 13.359613685825916}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.65305149949448, 72.05932322510029, 69.98978358869576, 125.19688279760031, 124.94858814784844, 51.821995076547225, 110.72991327952005, 46.5574261982525, 82.77933700819538, 8.982531389373904, -1.2301664611648206, -8.6215641319438, 47.89746729655652, 91.60736657560365, 22.281824542826822, 7.310022855513893, 53.476843860558716, 89.0381392057737, 84.76474290899776, 1.3425722891349494, 4.609044497522859, -63.63939086243175, 92.28232196582155, 68.87468276629497, 56.3131708188876, 24.335089630398652, 91.472297976412, 4.746880060767974, 109.93868835077903, 157.95029390114428, 39.41600462799155, 139.6167993861666, 116.54678015600945, 105.440278226999, 66.55813126364596, 105.77759174428272, 47.88236617641006, -23.283990399080935, -30.173008453707382, 113.86080232470107, 11.853272734653217, 25.000612586143177, 52.32312364531897, 53.10805243845353, 4.009194255248929, 110.27323997037868, 100.6851119058654, 21.07372854459352, 138.1547566462473, 77.37572901147118, 39.28078796904706, -8.248549708720297, 73.7397846482831, 111.771448295385, 114.4525218678146, 36.09093729333712, 82.38922244729092, 87.8299097828602, 81.30694255642483, 125.53435250225, 84.26642452335896, 106.70246671963835, 30.609290463394387, 45.30807999133141, 0.6548878944025045, 122.88842696334602, 11.919021727961045, -20.98548427076026, 98.5677197365228, 134.6148495725, 55.66360974420059, 153.6797593693588, 24.427115654208748, 59.39978646546922, 101.38674514110505, -2.79851325498141, -35.1728221510975, 11.941606329399448, 4.122538633936713, 4.467234132725455, 18.417615163031094, 138.39697152947048, -35.243050394076946, 38.192385623547764, 164.48693693801198, 80.09446819773792, -10.628655113058706, 96.09131168355466, 58.98369361078585, -27.555796945109464, -76.8804810436975, 48.20113487323219, -24.367224858809593, 20.53629061972682, 18.981508307349326, 30.4508530893792, 29.435520169595776, 75.60834560168516, 14.833737583226593, 28.03207160491654], "episode_lengths": [10, 149, 200, 178, 89, 25, 200, 200, 119, 200, 4, 200, 71, 142, 30, 200, 101, 200, 83, 200, 200, 200, 84, 200, 46, 35, 200, 8, 51, 56, 104, 76, 102, 54, 73, 186, 200, 200, 200, 200, 200, 200, 200, 200, 200, 149, 45, 29, 145, 200, 200, 200, 200, 200, 122, 25, 200, 200, 66, 42, 120, 200, 13, 63, 20, 56, 200, 200, 200, 61, 195, 61, 200, 200, 200, 6, 181, 200, 200, 21, 200, 185, 200, 24, 60, 189, 70, 200, 200, 200, 200, 200, 200, 146, 200, 194, 200, 165, 200, 200], "policy_agent_policy_reward": [9.326525749747237, 36.02966161255014, 34.99489179434789, 62.598441398800134, 62.47429407392423, 25.91099753827361, 55.36495663976007, 23.278713099126243, 41.389668504097685, 4.491265694686952, -0.6150832305824103, -4.3107820659718925, 23.948733648278242, 45.803683287801846, 11.140912271413413, 3.6550114277569534, 26.738421930279358, 44.51906960288686, 42.38237145449888, 0.6712861445674747, 2.304522248761419, -31.819695431215905, 46.14116098291078, 34.43734138314748, 28.1565854094438, 12.16754481519933, 45.736148988206054, 2.373440030383987, 54.96934417538952, 78.97514695057211, 19.70800231399578, 69.8083996930833, 58.273390078004695, 52.72013911349947, 33.27906563182299, 52.888795872141344, 23.941183088205037, -11.64199519954046, -15.086504226853663, 56.93040116235052, 5.926636367326587, 12.500306293071588, 26.161561822659486, 26.554026219226774, 2.0045971276244643, 55.136619985189355, 50.34255595293271, 10.53686427229676, 69.07737832312365, 38.687864505735604, 19.64039398452354, -4.124274854360166, 36.869892324141546, 55.8857241476925, 57.2262609339073, 18.045468646668546, 41.19461122364548, 43.914954891430085, 40.65347127821242, 62.76717625112501, 42.133212261679446, 53.351233359819176, 15.304645231697195, 22.654039995665713, 0.3274439472012536, 61.44421348167301, 5.95951086398054, -10.492742135380134, 49.283859868261445, 67.30742478624998, 27.8318048721003, 76.83987968467936, 12.213557827104356, 29.69989323273461, 50.69337257055254, -1.3992566274907055, -17.586411075548753, 5.970803164699724, 2.0612693169683567, 2.2336170663627275, 9.208807581515547, 69.19848576473524, -17.621525197038473, 19.096192811773882, 82.24346846900602, 40.04723409886897, -5.314327556529346, 48.045655841777275, 29.491846805392917, -13.777898472554732, -38.44024052184885, 24.10056743661609, -12.183612429404796, 10.268145309863412, 9.49075415367465, 15.225426544689594, 14.717760084797886, 37.8041728008426, 7.4168687916133, 14.01603580245828], "policy_adversary_policy_reward": [3.8584224504793854, 5.468103299267852, 14.728505476042354, 21.301156136507792, 18.32585741100999, 16.669034383337895, 27.584533311457363, 35.013908087342784, 39.92801717936878, 22.54627689455544, 16.300003129900315, 9.61099440837329, 27.559674913240293, 27.805281726519766, 5.670666911108018, 17.60804618801822, 13.704972368649372, 27.684696135448313, 2.563895332020895, 1.927370362666057, -2.479313224296199, 1.8642299937137885, 7.654635257918258, -11.965417323890158, 12.849177987555354, 11.099555660722892, 8.393670771790411, 37.41001251601143, -9.02521063852578, 20.16612290993919, 3.373268913491099, 0.2817425142658543, 14.50684345590511, 12.231578474374249, 23.05436124646744, 21.46470835641943, 21.273094392897296, 21.109277061601585, -1.9863450147475206, 2.6576311593149953, 2.279772685857399, 0.024749562904020195, -21.971188725516654, -9.848506705699243, 21.254983886278218, 24.88617709663258, 19.271037137349595, 15.166304245797885, 16.80612500396417, 11.350460405479637, 22.190495785736534, -10.02295097053721, 26.082089167118053, 19.654059821087973, 4.390242885315557, -2.0168028549315693, 9.860861868081384, 45.10848230730814, 41.89780149377352, 37.07734545679861, 14.088030398571277, 5.619971915424505, 46.34749689191379, 23.46090280116951, 19.524629293119084, 38.7487607848856, 17.814806216065346, 34.905332897434114, 22.942016518366668, 10.337049113456317, 16.54562876456849, 36.34316710757285, 11.106036717325193, 12.835146370879844, -12.484074111556449, 0.8420789120159853, -6.261133484118847, -8.825370742734819, 36.067469376172454, 20.862931786178066, 15.201921394644263, -9.275285027317683, 21.57745576323296, -9.077149470161373, 15.63895362032373, 10.522608202335757, 17.853200341610783, 8.700825877615996, 1.9344809513757042, 0.0701161762487601, 33.46317054219036, 21.673449442998955, 26.006829024802474, 24.33572692813022, -14.58225316057139, 25.119117432868144, 24.39329857526258, 44.68407974786108, 21.087712521227502, 17.6001519845081, 11.064150312826591, 8.576243671696949, -4.794614487962278, 0.6703396336021115, 8.326334510736933, 28.543557813404618, 28.008658190049434, 27.877065957643065, 29.11414751105177, 28.112113422855522, 20.548409858455898, -2.502941211787352, 12.965604797041745, 28.229006426603732, 18.71958860535641, 25.19536628607367, 23.81027484114659, 16.843196437065828, 45.736894184872355, 17.03028206625264, 20.177768123312852, 21.95544413836661, 33.08852373413633, 20.262709625682835, 6.929289567697331, 8.375355663999866, -19.437857529887495, 42.09189752555321, 8.069075927272653, -7.7416319800714, 47.202918334726846, 14.241295146946154, -6.734081673351419, 12.693592537331963, -11.114739064128191, 0.6219969287480644, 17.053830955765257, 32.23002891249619, 47.303794702423644, 20.003630083826327, 9.116719273507897, 18.715085598592395, 34.829577618027876, 42.01030206665153, 2.7458040762155314, 9.467753750888825, 14.892305399534568, 14.807587833200042, 30.987638030028407, 19.705734540524126, -5.6229168442323285, 4.223660216741623, 20.006538489311087, -37.592949564859836, 16.00932278636064, -10.038519621660917, -0.8265451069682399, 2.8878144239365966, 14.859140767822371, -12.625523701459645, -2.7935309784038935, 12.00233855991944, 36.33120138756577, 32.86728437716948, -1.4178124941060446, -16.203712702932428, 17.857707158469793, 1.2384856533040889, 39.99094921397775, 42.25251925502824, 11.498327938273482, 28.548906160595504, -22.616803178196253, 17.302475621666908, 18.077675210329325, 29.96798063144798, 16.709574732575497, 12.78227207281742, -0.27190295631968553, -13.505995516235046, -37.4181615676286, -1.0220789542202304, 15.821261102493331, 8.279306334122758, 5.311544439453726, -17.495156868858523, 27.14640071715053, -16.878255407287117, 12.38302185789069, -2.8922677042160423, 29.615597525498664, -14.390170980809067, 13.938635364879385, 0.7791247199185012, 23.426471893754268, 14.377700907088329, -4.014840544172994, 11.431709335786294, 5.025409739434011, 8.99062606302427]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3918045811782676, "mean_inference_ms": 0.9752213488426229, "mean_action_processing_ms": 0.16629555037169677, "mean_env_wait_ms": 0.05827633917743076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004310965538024902, "StateBufferConnector_ms": 0.0026264190673828125, "ViewRequirementAgentConnector_ms": 0.07127416133880615}, "num_episodes": 24, "episode_return_max": 164.48693693801198, "episode_return_min": -76.8804810436975, "episode_return_mean": 53.43845474330367}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 475.7711209938699, "num_env_steps_trained_throughput_per_sec": 475.7711209938699, "timesteps_total": 776000, "num_env_steps_sampled_lifetime": 776000, "num_agent_steps_sampled_lifetime": 2328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2328000, "timers": {"training_iteration_time_ms": 7904.855, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7904.821, "sample_time_ms": 762.831, "learn_time_ms": 7130.289, "learn_throughput": 560.987, "synch_weights_time_ms": 11.159}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000}, "done": false, "training_iteration": 194, "trial_id": "eaa30_00000", "date": "2024-08-09_18-07-01", "timestamp": 1723241221, "time_this_iter_s": 8.411520004272461, "time_total_s": 1588.4370169639587, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781a0a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1588.4370169639587, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 28.025000000000002, "ram_util_percent": 79.06666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.193609079355916, "cur_kl_coeff": 0.4165962999486102, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.8067691149535, "policy_loss": 0.00408699041067391, "vf_loss": 5.786609706424532, "vf_explained_var": -0.00029676534511424875, "kl": 0.03858030182679021, "entropy": 1.0585234773852839, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 47.891101806859176, "cur_kl_coeff": 0.4008361256164345, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.349159863591194, "policy_loss": 0.0013203159639184985, "vf_loss": 7.3393587321043015, "vf_explained_var": -0.03335953950881958, "kl": 0.021157827136145595, "entropy": 0.8862187398597599, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 186720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000}, "env_runners": {"episode_reward_max": 164.48693693801198, "episode_reward_min": -76.8804810436975, "episode_reward_mean": 48.09384224763546, "episode_len_mean": 147.9, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 14790, "policy_reward_min": {"agent_policy": -38.44024052184885, "adversary_policy": -37.592949564859836}, "policy_reward_max": {"agent_policy": 82.24346846900602, "adversary_policy": 47.303794702423644}, "policy_reward_mean": {"agent_policy": 24.04692112381773, "adversary_policy": 12.02346056190887}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.335089630398652, 91.472297976412, 4.746880060767974, 109.93868835077903, 157.95029390114428, 39.41600462799155, 139.6167993861666, 116.54678015600945, 105.440278226999, 66.55813126364596, 105.77759174428272, 47.88236617641006, -23.283990399080935, -30.173008453707382, 113.86080232470107, 11.853272734653217, 25.000612586143177, 52.32312364531897, 53.10805243845353, 4.009194255248929, 110.27323997037868, 100.6851119058654, 21.07372854459352, 138.1547566462473, 77.37572901147118, 39.28078796904706, -8.248549708720297, 73.7397846482831, 111.771448295385, 114.4525218678146, 36.09093729333712, 82.38922244729092, 87.8299097828602, 81.30694255642483, 125.53435250225, 84.26642452335896, 106.70246671963835, 30.609290463394387, 45.30807999133141, 0.6548878944025045, 122.88842696334602, 11.919021727961045, -20.98548427076026, 98.5677197365228, 134.6148495725, 55.66360974420059, 153.6797593693588, 24.427115654208748, 59.39978646546922, 101.38674514110505, -2.79851325498141, -35.1728221510975, 11.941606329399448, 4.122538633936713, 4.467234132725455, 18.417615163031094, 138.39697152947048, -35.243050394076946, 38.192385623547764, 164.48693693801198, 80.09446819773792, -10.628655113058706, 96.09131168355466, 58.98369361078585, -27.555796945109464, -76.8804810436975, 48.20113487323219, -24.367224858809593, 20.53629061972682, 18.981508307349326, 30.4508530893792, 29.435520169595776, 75.60834560168516, 14.833737583226593, 28.03207160491654, 65.51312585365113, 24.932338518254454, 13.946268994582354, 40.88096783889367, 49.815462868521905, -7.429634405183393, -25.00369389490973, 96.76938725151635, 82.3683294330053, 31.912585165382296, 135.6370034990956, -15.322854786326147, 54.70348314060411, 42.39940293289114, 13.496651125212766, -58.134480861821885, 40.27782468051197, -29.964376596542348, 17.545738477161073, 36.68471905956906, 54.061843107688375, 14.983278535457632, 43.24710792222497, -25.79872715991921, 26.042910072239895], "episode_lengths": [35, 200, 8, 51, 56, 104, 76, 102, 54, 73, 186, 200, 200, 200, 200, 200, 200, 200, 200, 200, 149, 45, 29, 145, 200, 200, 200, 200, 200, 122, 25, 200, 200, 66, 42, 120, 200, 13, 63, 20, 56, 200, 200, 200, 61, 195, 61, 200, 200, 200, 6, 181, 200, 200, 21, 200, 185, 200, 24, 60, 189, 70, 200, 200, 200, 200, 200, 200, 146, 200, 194, 200, 165, 200, 200, 200, 200, 200, 31, 200, 200, 200, 85, 200, 200, 64, 200, 62, 200, 10, 200, 66, 200, 200, 200, 200, 200, 200, 200, 74], "policy_agent_policy_reward": [12.16754481519933, 45.736148988206054, 2.373440030383987, 54.96934417538952, 78.97514695057211, 19.70800231399578, 69.8083996930833, 58.273390078004695, 52.72013911349947, 33.27906563182299, 52.888795872141344, 23.941183088205037, -11.64199519954046, -15.086504226853663, 56.93040116235052, 5.926636367326587, 12.500306293071588, 26.161561822659486, 26.554026219226774, 2.0045971276244643, 55.136619985189355, 50.34255595293271, 10.53686427229676, 69.07737832312365, 38.687864505735604, 19.64039398452354, -4.124274854360166, 36.869892324141546, 55.8857241476925, 57.2262609339073, 18.045468646668546, 41.19461122364548, 43.914954891430085, 40.65347127821242, 62.76717625112501, 42.133212261679446, 53.351233359819176, 15.304645231697195, 22.654039995665713, 0.3274439472012536, 61.44421348167301, 5.95951086398054, -10.492742135380134, 49.283859868261445, 67.30742478624998, 27.8318048721003, 76.83987968467936, 12.213557827104356, 29.69989323273461, 50.69337257055254, -1.3992566274907055, -17.586411075548753, 5.970803164699724, 2.0612693169683567, 2.2336170663627275, 9.208807581515547, 69.19848576473524, -17.621525197038473, 19.096192811773882, 82.24346846900602, 40.04723409886897, -5.314327556529346, 48.045655841777275, 29.491846805392917, -13.777898472554732, -38.44024052184885, 24.10056743661609, -12.183612429404796, 10.268145309863412, 9.49075415367465, 15.225426544689594, 14.717760084797886, 37.8041728008426, 7.4168687916133, 14.01603580245828, 32.75656292682555, 12.46616925912723, 6.973134497291181, 20.440483919446834, 24.907731434260953, -3.7148172025917177, -12.501846947454851, 48.38469362575821, 41.18416471650262, 15.956292582691152, 67.8185017495478, -7.661427393163077, 27.351741570302046, 21.199701466445585, 6.748325562606383, -29.06724043091091, 20.138912340255985, -14.982188298271184, 8.77286923858053, 18.342359529784524, 27.03092155384419, 7.491639267728813, 21.62355396111248, -12.89936357995962, 13.02145503611995], "policy_adversary_policy_reward": [22.190495785736534, -10.02295097053721, 26.082089167118053, 19.654059821087973, 4.390242885315557, -2.0168028549315693, 9.860861868081384, 45.10848230730814, 41.89780149377352, 37.07734545679861, 14.088030398571277, 5.619971915424505, 46.34749689191379, 23.46090280116951, 19.524629293119084, 38.7487607848856, 17.814806216065346, 34.905332897434114, 22.942016518366668, 10.337049113456317, 16.54562876456849, 36.34316710757285, 11.106036717325193, 12.835146370879844, -12.484074111556449, 0.8420789120159853, -6.261133484118847, -8.825370742734819, 36.067469376172454, 20.862931786178066, 15.201921394644263, -9.275285027317683, 21.57745576323296, -9.077149470161373, 15.63895362032373, 10.522608202335757, 17.853200341610783, 8.700825877615996, 1.9344809513757042, 0.0701161762487601, 33.46317054219036, 21.673449442998955, 26.006829024802474, 24.33572692813022, -14.58225316057139, 25.119117432868144, 24.39329857526258, 44.68407974786108, 21.087712521227502, 17.6001519845081, 11.064150312826591, 8.576243671696949, -4.794614487962278, 0.6703396336021115, 8.326334510736933, 28.543557813404618, 28.008658190049434, 27.877065957643065, 29.11414751105177, 28.112113422855522, 20.548409858455898, -2.502941211787352, 12.965604797041745, 28.229006426603732, 18.71958860535641, 25.19536628607367, 23.81027484114659, 16.843196437065828, 45.736894184872355, 17.03028206625264, 20.177768123312852, 21.95544413836661, 33.08852373413633, 20.262709625682835, 6.929289567697331, 8.375355663999866, -19.437857529887495, 42.09189752555321, 8.069075927272653, -7.7416319800714, 47.202918334726846, 14.241295146946154, -6.734081673351419, 12.693592537331963, -11.114739064128191, 0.6219969287480644, 17.053830955765257, 32.23002891249619, 47.303794702423644, 20.003630083826327, 9.116719273507897, 18.715085598592395, 34.829577618027876, 42.01030206665153, 2.7458040762155314, 9.467753750888825, 14.892305399534568, 14.807587833200042, 30.987638030028407, 19.705734540524126, -5.6229168442323285, 4.223660216741623, 20.006538489311087, -37.592949564859836, 16.00932278636064, -10.038519621660917, -0.8265451069682399, 2.8878144239365966, 14.859140767822371, -12.625523701459645, -2.7935309784038935, 12.00233855991944, 36.33120138756577, 32.86728437716948, -1.4178124941060446, -16.203712702932428, 17.857707158469793, 1.2384856533040889, 39.99094921397775, 42.25251925502824, 11.498327938273482, 28.548906160595504, -22.616803178196253, 17.302475621666908, 18.077675210329325, 29.96798063144798, 16.709574732575497, 12.78227207281742, -0.27190295631968553, -13.505995516235046, -37.4181615676286, -1.0220789542202304, 15.821261102493331, 8.279306334122758, 5.311544439453726, -17.495156868858523, 27.14640071715053, -16.878255407287117, 12.38302185789069, -2.8922677042160423, 29.615597525498664, -14.390170980809067, 13.938635364879385, 0.7791247199185012, 23.426471893754268, 14.377700907088329, -4.014840544172994, 11.431709335786294, 5.025409739434011, 8.99062606302427, 20.35846675536377, 12.39809617146179, 25.271177720909996, -12.805008461782755, 19.10101259973904, -12.127878102447859, -3.29473039014065, 23.735214309587484, 13.305526966202201, 11.602204468058751, 4.811250092233234, -8.526067294824951, -8.293984221240734, -4.207862726214117, 18.91006019794758, 29.474633427810602, 39.24402159891889, 1.9401431175837303, 6.377772311771908, 9.578520270919242, 25.18651566476334, 42.63198608478447, -16.39779656055551, 8.736369167392432, -2.440820855965189, 29.792562426267235, 5.3005424702398045, 15.899158996205777, 2.34731112805828, 4.401014434548103, -24.732073165446103, -4.335167265464824, 5.153203267292238, 14.985709072963742, -1.6750864566646424, -13.307101841606535, -5.482395006510313, 14.255264245090842, 19.461133041115104, -1.1187735113305841, 14.986512874474503, 12.044408679369683, -4.1328079487459615, 11.624447216474772, 13.4329945573846, 8.190559403727882, -24.176389102262092, 11.277025522302473, -12.445037858972984, 25.46649289509293]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3918072790027585, "mean_inference_ms": 0.9760957462891304, "mean_action_processing_ms": 0.16626680758660192, "mean_env_wait_ms": 0.058326365366680226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004300117492675781, "StateBufferConnector_ms": 0.002557992935180664, "ViewRequirementAgentConnector_ms": 0.06872642040252686}, "num_episodes": 25, "episode_return_max": 164.48693693801198, "episode_return_min": -76.8804810436975, "episode_return_mean": 48.09384224763546}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.7988796124106, "num_env_steps_trained_throughput_per_sec": 501.7988796124106, "timesteps_total": 780000, "num_env_steps_sampled_lifetime": 780000, "num_agent_steps_sampled_lifetime": 2340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2340000, "timers": {"training_iteration_time_ms": 7910.791, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7910.756, "sample_time_ms": 765.34, "learn_time_ms": 7133.878, "learn_throughput": 560.705, "synch_weights_time_ms": 11.029}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000}, "done": false, "training_iteration": 195, "trial_id": "eaa30_00000", "date": "2024-08-09_18-07-09", "timestamp": 1723241229, "time_this_iter_s": 7.975198984146118, "time_total_s": 1596.4122159481049, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1781a0dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1596.4122159481049, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 23.958333333333332, "ram_util_percent": 79.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.886477742497883, "cur_kl_coeff": 0.6248944499229157, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.000111729505831, "policy_loss": -0.0012789770447102094, "vf_loss": 5.989386562064842, "vf_explained_var": 0.1285820759793438, "kl": 0.019209865993135188, "entropy": 1.1424279221781979, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.32350077976783, "cur_kl_coeff": 0.6012541884246516, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.685589427749316, "policy_loss": -0.0010728287568781524, "vf_loss": 7.681157698730628, "vf_explained_var": 8.1133966644605e-05, "kl": 0.009155078384113342, "entropy": 0.8794214651609461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 187680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "env_runners": {"episode_reward_max": 188.61251264624156, "episode_reward_min": -94.15612361010088, "episode_reward_mean": 43.61721030966433, "episode_len_mean": 157.85, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 15785, "policy_reward_min": {"agent_policy": -47.078061805050474, "adversary_policy": -37.592949564859836}, "policy_reward_max": {"agent_policy": 94.30625632312083, "adversary_policy": 52.6079518546709}, "policy_reward_mean": {"agent_policy": 21.808605154832165, "adversary_policy": 10.904302577416082}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.37572901147118, 39.28078796904706, -8.248549708720297, 73.7397846482831, 111.771448295385, 114.4525218678146, 36.09093729333712, 82.38922244729092, 87.8299097828602, 81.30694255642483, 125.53435250225, 84.26642452335896, 106.70246671963835, 30.609290463394387, 45.30807999133141, 0.6548878944025045, 122.88842696334602, 11.919021727961045, -20.98548427076026, 98.5677197365228, 134.6148495725, 55.66360974420059, 153.6797593693588, 24.427115654208748, 59.39978646546922, 101.38674514110505, -2.79851325498141, -35.1728221510975, 11.941606329399448, 4.122538633936713, 4.467234132725455, 18.417615163031094, 138.39697152947048, -35.243050394076946, 38.192385623547764, 164.48693693801198, 80.09446819773792, -10.628655113058706, 96.09131168355466, 58.98369361078585, -27.555796945109464, -76.8804810436975, 48.20113487323219, -24.367224858809593, 20.53629061972682, 18.981508307349326, 30.4508530893792, 29.435520169595776, 75.60834560168516, 14.833737583226593, 28.03207160491654, 65.51312585365113, 24.932338518254454, 13.946268994582354, 40.88096783889367, 49.815462868521905, -7.429634405183393, -25.00369389490973, 96.76938725151635, 82.3683294330053, 31.912585165382296, 135.6370034990956, -15.322854786326147, 54.70348314060411, 42.39940293289114, 13.496651125212766, -58.134480861821885, 40.27782468051197, -29.964376596542348, 17.545738477161073, 36.68471905956906, 54.061843107688375, 14.983278535457632, 43.24710792222497, -25.79872715991921, 26.042910072239895, 11.319010497780589, 188.61251264624156, 67.8986732391945, -94.15612361010088, -31.008690675710966, 76.79152752991487, -1.2151462690059773, 101.23625303673536, -5.576934601591333, 100.81487425917128, 152.83295102458075, 75.93773197794454, 151.75210370577082, -43.170609987192265, -1.9631117187313585, 26.669543160161233, 8.6795774408648, -0.7138025311873406, 13.530661776944001, 104.31187600162903, 44.800042486311895, 50.06397515165004, 98.10448835269816, 43.35152100863546], "episode_lengths": [200, 200, 200, 200, 200, 122, 25, 200, 200, 66, 42, 120, 200, 13, 63, 20, 56, 200, 200, 200, 61, 195, 61, 200, 200, 200, 6, 181, 200, 200, 21, 200, 185, 200, 24, 60, 189, 70, 200, 200, 200, 200, 200, 200, 146, 200, 194, 200, 165, 200, 200, 200, 200, 200, 31, 200, 200, 200, 85, 200, 200, 64, 200, 62, 200, 10, 200, 66, 200, 200, 200, 200, 200, 200, 200, 74, 200, 125, 200, 200, 200, 200, 8, 200, 200, 200, 115, 200, 85, 200, 200, 200, 200, 200, 200, 119, 200, 200, 200, 56], "policy_agent_policy_reward": [38.687864505735604, 19.64039398452354, -4.124274854360166, 36.869892324141546, 55.8857241476925, 57.2262609339073, 18.045468646668546, 41.19461122364548, 43.914954891430085, 40.65347127821242, 62.76717625112501, 42.133212261679446, 53.351233359819176, 15.304645231697195, 22.654039995665713, 0.3274439472012536, 61.44421348167301, 5.95951086398054, -10.492742135380134, 49.283859868261445, 67.30742478624998, 27.8318048721003, 76.83987968467936, 12.213557827104356, 29.69989323273461, 50.69337257055254, -1.3992566274907055, -17.586411075548753, 5.970803164699724, 2.0612693169683567, 2.2336170663627275, 9.208807581515547, 69.19848576473524, -17.621525197038473, 19.096192811773882, 82.24346846900602, 40.04723409886897, -5.314327556529346, 48.045655841777275, 29.491846805392917, -13.777898472554732, -38.44024052184885, 24.10056743661609, -12.183612429404796, 10.268145309863412, 9.49075415367465, 15.225426544689594, 14.717760084797886, 37.8041728008426, 7.4168687916133, 14.01603580245828, 32.75656292682555, 12.46616925912723, 6.973134497291181, 20.440483919446834, 24.907731434260953, -3.7148172025917177, -12.501846947454851, 48.38469362575821, 41.18416471650262, 15.956292582691152, 67.8185017495478, -7.661427393163077, 27.351741570302046, 21.199701466445585, 6.748325562606383, -29.06724043091091, 20.138912340255985, -14.982188298271184, 8.77286923858053, 18.342359529784524, 27.03092155384419, 7.491639267728813, 21.62355396111248, -12.89936357995962, 13.02145503611995, 5.659505248890294, 94.30625632312083, 33.94933661959727, -47.078061805050474, -15.504345337855497, 38.39576376495743, -0.6075731345029894, 50.618126518367625, -2.7884673007956593, 50.40743712958566, 76.41647551229042, 37.9688659889723, 75.87605185288534, -21.58530499359615, -0.9815558593656739, 13.334771580080613, 4.3397887204324, -0.3569012655936703, 6.7653308884720005, 52.155938000814544, 22.40002124315597, 25.031987575825024, 49.05224417634912, 21.67576050431773], "policy_adversary_policy_reward": [21.087712521227502, 17.6001519845081, 11.064150312826591, 8.576243671696949, -4.794614487962278, 0.6703396336021115, 8.326334510736933, 28.543557813404618, 28.008658190049434, 27.877065957643065, 29.11414751105177, 28.112113422855522, 20.548409858455898, -2.502941211787352, 12.965604797041745, 28.229006426603732, 18.71958860535641, 25.19536628607367, 23.81027484114659, 16.843196437065828, 45.736894184872355, 17.03028206625264, 20.177768123312852, 21.95544413836661, 33.08852373413633, 20.262709625682835, 6.929289567697331, 8.375355663999866, -19.437857529887495, 42.09189752555321, 8.069075927272653, -7.7416319800714, 47.202918334726846, 14.241295146946154, -6.734081673351419, 12.693592537331963, -11.114739064128191, 0.6219969287480644, 17.053830955765257, 32.23002891249619, 47.303794702423644, 20.003630083826327, 9.116719273507897, 18.715085598592395, 34.829577618027876, 42.01030206665153, 2.7458040762155314, 9.467753750888825, 14.892305399534568, 14.807587833200042, 30.987638030028407, 19.705734540524126, -5.6229168442323285, 4.223660216741623, 20.006538489311087, -37.592949564859836, 16.00932278636064, -10.038519621660917, -0.8265451069682399, 2.8878144239365966, 14.859140767822371, -12.625523701459645, -2.7935309784038935, 12.00233855991944, 36.33120138756577, 32.86728437716948, -1.4178124941060446, -16.203712702932428, 17.857707158469793, 1.2384856533040889, 39.99094921397775, 42.25251925502824, 11.498327938273482, 28.548906160595504, -22.616803178196253, 17.302475621666908, 18.077675210329325, 29.96798063144798, 16.709574732575497, 12.78227207281742, -0.27190295631968553, -13.505995516235046, -37.4181615676286, -1.0220789542202304, 15.821261102493331, 8.279306334122758, 5.311544439453726, -17.495156868858523, 27.14640071715053, -16.878255407287117, 12.38302185789069, -2.8922677042160423, 29.615597525498664, -14.390170980809067, 13.938635364879385, 0.7791247199185012, 23.426471893754268, 14.377700907088329, -4.014840544172994, 11.431709335786294, 5.025409739434011, 8.99062606302427, 20.35846675536377, 12.39809617146179, 25.271177720909996, -12.805008461782755, 19.10101259973904, -12.127878102447859, -3.29473039014065, 23.735214309587484, 13.305526966202201, 11.602204468058751, 4.811250092233234, -8.526067294824951, -8.293984221240734, -4.207862726214117, 18.91006019794758, 29.474633427810602, 39.24402159891889, 1.9401431175837303, 6.377772311771908, 9.578520270919242, 25.18651566476334, 42.63198608478447, -16.39779656055551, 8.736369167392432, -2.440820855965189, 29.792562426267235, 5.3005424702398045, 15.899158996205777, 2.34731112805828, 4.401014434548103, -24.732073165446103, -4.335167265464824, 5.153203267292238, 14.985709072963742, -1.6750864566646424, -13.307101841606535, -5.482395006510313, 14.255264245090842, 19.461133041115104, -1.1187735113305841, 14.986512874474503, 12.044408679369683, -4.1328079487459615, 11.624447216474772, 13.4329945573846, 8.190559403727882, -24.176389102262092, 11.277025522302473, -12.445037858972984, 25.46649289509293, -19.682985218015812, 25.342490466906106, 47.625164391651055, 46.681091931469794, 30.212016711035936, 3.737319908561336, -11.62073316763339, -35.45732863741709, -11.105054271966438, -4.399291065889049, 33.43116408909649, 4.964599675860928, -1.1785048123417567, 0.5709316778387673, 13.483205872862602, 37.13492064550502, 10.091840150920717, -12.880307451716376, 21.178240645802347, 29.2291964837833, 40.053852722546175, 36.362622789744236, 25.515171984791458, 12.453694004180843, 23.26809999821443, 52.6079518546709, -18.755203966797797, -2.83010102679836, -13.703676522529253, 12.72212066316358, 19.595870467157873, -6.261098887077253, -3.976608816190902, 8.316397536623302, 6.201127358938315, -6.558028624531985, 0.7714663316546044, 5.993864556817396, 36.466373833707046, 15.689564167107502, 18.569651478561653, 3.8303697645943053, 7.677435641161768, 17.354551934663256, 29.469732258763273, 19.58251191758582, -3.0280127343839567, 24.70377323870168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39202844568238326, "mean_inference_ms": 0.9749572342894269, "mean_action_processing_ms": 0.16652821196492504, "mean_env_wait_ms": 0.05836618275785823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004077911376953125, "StateBufferConnector_ms": 0.0025583505630493164, "ViewRequirementAgentConnector_ms": 0.06845366954803467}, "num_episodes": 24, "episode_return_max": 188.61251264624156, "episode_return_min": -94.15612361010088, "episode_return_mean": 43.61721030966433}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.9507479859412, "num_env_steps_trained_throughput_per_sec": 505.9507479859412, "timesteps_total": 784000, "num_env_steps_sampled_lifetime": 784000, "num_agent_steps_sampled_lifetime": 2352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2352000, "timers": {"training_iteration_time_ms": 7931.936, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7931.902, "sample_time_ms": 767.722, "learn_time_ms": 7152.615, "learn_throughput": 559.236, "synch_weights_time_ms": 11.019}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "done": false, "training_iteration": 196, "trial_id": "eaa30_00000", "date": "2024-08-09_18-07-17", "timestamp": 1723241237, "time_this_iter_s": 7.910210132598877, "time_total_s": 1604.3224260807037, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fb55310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1604.3224260807037, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 25.427272727272733, "ram_util_percent": 79.05454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.01981891507194, "cur_kl_coeff": 0.6248944499229157, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.382873450385199, "policy_loss": -0.0053323174908106764, "vf_loss": 5.384122760459859, "vf_explained_var": 0.10193482050820002, "kl": 0.006533904697391249, "entropy": 1.1404918201385983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.076083098724485, "cur_kl_coeff": 0.6012541884246516, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.134628334641457, "policy_loss": 0.001577995568610883, "vf_loss": 7.125092305243015, "vf_explained_var": 0.05496468730270863, "kl": 0.013235746269735197, "entropy": 0.9687296916420262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 188640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000}, "env_runners": {"episode_reward_max": 188.61251264624156, "episode_reward_min": -94.15612361010088, "episode_reward_mean": 33.935937835376905, "episode_len_mean": 162.55, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 16255, "policy_reward_min": {"agent_policy": -47.078061805050474, "adversary_policy": -37.592949564859836}, "policy_reward_max": {"agent_policy": 94.30625632312083, "adversary_policy": 52.6079518546709}, "policy_reward_mean": {"agent_policy": 16.96796891768845, "adversary_policy": 8.483984458844224}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.38674514110505, -2.79851325498141, -35.1728221510975, 11.941606329399448, 4.122538633936713, 4.467234132725455, 18.417615163031094, 138.39697152947048, -35.243050394076946, 38.192385623547764, 164.48693693801198, 80.09446819773792, -10.628655113058706, 96.09131168355466, 58.98369361078585, -27.555796945109464, -76.8804810436975, 48.20113487323219, -24.367224858809593, 20.53629061972682, 18.981508307349326, 30.4508530893792, 29.435520169595776, 75.60834560168516, 14.833737583226593, 28.03207160491654, 65.51312585365113, 24.932338518254454, 13.946268994582354, 40.88096783889367, 49.815462868521905, -7.429634405183393, -25.00369389490973, 96.76938725151635, 82.3683294330053, 31.912585165382296, 135.6370034990956, -15.322854786326147, 54.70348314060411, 42.39940293289114, 13.496651125212766, -58.134480861821885, 40.27782468051197, -29.964376596542348, 17.545738477161073, 36.68471905956906, 54.061843107688375, 14.983278535457632, 43.24710792222497, -25.79872715991921, 26.042910072239895, 11.319010497780589, 188.61251264624156, 67.8986732391945, -94.15612361010088, -31.008690675710966, 76.79152752991487, -1.2151462690059773, 101.23625303673536, -5.576934601591333, 100.81487425917128, 152.83295102458075, 75.93773197794454, 151.75210370577082, -43.170609987192265, -1.9631117187313585, 26.669543160161233, 8.6795774408648, -0.7138025311873406, 13.530661776944001, 104.31187600162903, 44.800042486311895, 50.06397515165004, 98.10448835269816, 43.35152100863546, 33.82391738566916, 38.38238135157039, 26.412070219456723, -24.2690490362102, 140.94930692638786, 72.78847625140023, 28.248238745913653, 0.29551001491930506, 91.05506397811774, -18.988553798810784, 48.69060151380096, 20.02563382441953, 22.449758123007943, 50.52843171278407, 22.96607770187954, 24.56534023621019, 15.216575902470154, 23.430172578700734, 11.772870374157224, 56.80370393719802, 14.343444528835292, -72.49152704197991, 36.9574267143887, 47.986807012456055, 49.16911463489053], "episode_lengths": [200, 6, 181, 200, 200, 21, 200, 185, 200, 24, 60, 189, 70, 200, 200, 200, 200, 200, 200, 146, 200, 194, 200, 165, 200, 200, 200, 200, 200, 31, 200, 200, 200, 85, 200, 200, 64, 200, 62, 200, 10, 200, 66, 200, 200, 200, 200, 200, 200, 200, 74, 200, 125, 200, 200, 200, 200, 8, 200, 200, 200, 115, 200, 85, 200, 200, 200, 200, 200, 200, 119, 200, 200, 200, 56, 200, 200, 200, 200, 126, 133, 200, 200, 200, 200, 107, 25, 200, 71, 200, 200, 200, 200, 6, 138, 45, 200, 63, 200, 200], "policy_agent_policy_reward": [50.69337257055254, -1.3992566274907055, -17.586411075548753, 5.970803164699724, 2.0612693169683567, 2.2336170663627275, 9.208807581515547, 69.19848576473524, -17.621525197038473, 19.096192811773882, 82.24346846900602, 40.04723409886897, -5.314327556529346, 48.045655841777275, 29.491846805392917, -13.777898472554732, -38.44024052184885, 24.10056743661609, -12.183612429404796, 10.268145309863412, 9.49075415367465, 15.225426544689594, 14.717760084797886, 37.8041728008426, 7.4168687916133, 14.01603580245828, 32.75656292682555, 12.46616925912723, 6.973134497291181, 20.440483919446834, 24.907731434260953, -3.7148172025917177, -12.501846947454851, 48.38469362575821, 41.18416471650262, 15.956292582691152, 67.8185017495478, -7.661427393163077, 27.351741570302046, 21.199701466445585, 6.748325562606383, -29.06724043091091, 20.138912340255985, -14.982188298271184, 8.77286923858053, 18.342359529784524, 27.03092155384419, 7.491639267728813, 21.62355396111248, -12.89936357995962, 13.02145503611995, 5.659505248890294, 94.30625632312083, 33.94933661959727, -47.078061805050474, -15.504345337855497, 38.39576376495743, -0.6075731345029894, 50.618126518367625, -2.7884673007956593, 50.40743712958566, 76.41647551229042, 37.9688659889723, 75.87605185288534, -21.58530499359615, -0.9815558593656739, 13.334771580080613, 4.3397887204324, -0.3569012655936703, 6.7653308884720005, 52.155938000814544, 22.40002124315597, 25.031987575825024, 49.05224417634912, 21.67576050431773, 16.91195869283458, 19.191190675785187, 13.206035109728361, -12.1345245181051, 70.47465346319396, 36.3942381257001, 14.124119372956823, 0.1477550074596614, 45.52753198905884, -9.494276899405413, 24.34530075690047, 10.012816912209763, 11.224879061503962, 25.264215856392042, 11.48303885093977, 12.28267011810509, 7.608287951235054, 11.715086289350364, 5.886435187078613, 28.401851968599008, 7.171722264417646, -36.24576352098988, 18.478713357194344, 23.993403506228024, 24.584557317445274], "policy_adversary_policy_reward": [30.987638030028407, 19.705734540524126, -5.6229168442323285, 4.223660216741623, 20.006538489311087, -37.592949564859836, 16.00932278636064, -10.038519621660917, -0.8265451069682399, 2.8878144239365966, 14.859140767822371, -12.625523701459645, -2.7935309784038935, 12.00233855991944, 36.33120138756577, 32.86728437716948, -1.4178124941060446, -16.203712702932428, 17.857707158469793, 1.2384856533040889, 39.99094921397775, 42.25251925502824, 11.498327938273482, 28.548906160595504, -22.616803178196253, 17.302475621666908, 18.077675210329325, 29.96798063144798, 16.709574732575497, 12.78227207281742, -0.27190295631968553, -13.505995516235046, -37.4181615676286, -1.0220789542202304, 15.821261102493331, 8.279306334122758, 5.311544439453726, -17.495156868858523, 27.14640071715053, -16.878255407287117, 12.38302185789069, -2.8922677042160423, 29.615597525498664, -14.390170980809067, 13.938635364879385, 0.7791247199185012, 23.426471893754268, 14.377700907088329, -4.014840544172994, 11.431709335786294, 5.025409739434011, 8.99062606302427, 20.35846675536377, 12.39809617146179, 25.271177720909996, -12.805008461782755, 19.10101259973904, -12.127878102447859, -3.29473039014065, 23.735214309587484, 13.305526966202201, 11.602204468058751, 4.811250092233234, -8.526067294824951, -8.293984221240734, -4.207862726214117, 18.91006019794758, 29.474633427810602, 39.24402159891889, 1.9401431175837303, 6.377772311771908, 9.578520270919242, 25.18651566476334, 42.63198608478447, -16.39779656055551, 8.736369167392432, -2.440820855965189, 29.792562426267235, 5.3005424702398045, 15.899158996205777, 2.34731112805828, 4.401014434548103, -24.732073165446103, -4.335167265464824, 5.153203267292238, 14.985709072963742, -1.6750864566646424, -13.307101841606535, -5.482395006510313, 14.255264245090842, 19.461133041115104, -1.1187735113305841, 14.986512874474503, 12.044408679369683, -4.1328079487459615, 11.624447216474772, 13.4329945573846, 8.190559403727882, -24.176389102262092, 11.277025522302473, -12.445037858972984, 25.46649289509293, -19.682985218015812, 25.342490466906106, 47.625164391651055, 46.681091931469794, 30.212016711035936, 3.737319908561336, -11.62073316763339, -35.45732863741709, -11.105054271966438, -4.399291065889049, 33.43116408909649, 4.964599675860928, -1.1785048123417567, 0.5709316778387673, 13.483205872862602, 37.13492064550502, 10.091840150920717, -12.880307451716376, 21.178240645802347, 29.2291964837833, 40.053852722546175, 36.362622789744236, 25.515171984791458, 12.453694004180843, 23.26809999821443, 52.6079518546709, -18.755203966797797, -2.83010102679836, -13.703676522529253, 12.72212066316358, 19.595870467157873, -6.261098887077253, -3.976608816190902, 8.316397536623302, 6.201127358938315, -6.558028624531985, 0.7714663316546044, 5.993864556817396, 36.466373833707046, 15.689564167107502, 18.569651478561653, 3.8303697645943053, 7.677435641161768, 17.354551934663256, 29.469732258763273, 19.58251191758582, -3.0280127343839567, 24.70377323870168, -0.31466109336063397, 17.226619786195215, 12.422681616645129, 6.768509059140058, 9.381505972899639, 3.8245291368287226, -11.640298107358436, -0.49422641074666274, 45.9168290884744, 24.557824374719544, 28.442557525825535, 7.951680599874566, 24.23701964705571, -10.112900274098887, 11.77313534631455, -11.625380338854889, 21.759476085788236, 23.76805590327064, -6.305871690156193, -3.188405209249238, 34.09148680504769, -9.746186048147239, 0.20209664843305575, 9.810720263776707, -8.772169184290913, 19.997048245794872, 45.28259995453275, -20.018384098140704, 10.322480921989552, 1.1605579289502188, -2.3760692076607466, 14.658739325765836, -0.728950176605279, 8.337238127840331, 21.95640358980817, -10.241317300457805, 3.867048631277102, 2.0193865558015105, 14.15697128743361, 14.244880681165402, -0.9357671728141064, 8.107489437231752, -21.61953297478608, -14.626230546203807, -4.5335265410546555, 23.012239898249007, 4.29763674745055, 19.695766758777474, 8.804385036461184, 15.780172280984088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39218554259365457, "mean_inference_ms": 0.9749903815984707, "mean_action_processing_ms": 0.16654802662247087, "mean_env_wait_ms": 0.05836311832974221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040138959884643555, "StateBufferConnector_ms": 0.0025931596755981445, "ViewRequirementAgentConnector_ms": 0.06778931617736816}, "num_episodes": 25, "episode_return_max": 188.61251264624156, "episode_return_min": -94.15612361010088, "episode_return_mean": 33.935937835376905}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.43991829414483, "num_env_steps_trained_throughput_per_sec": 502.43991829414483, "timesteps_total": 788000, "num_env_steps_sampled_lifetime": 788000, "num_agent_steps_sampled_lifetime": 2364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2364000, "timers": {"training_iteration_time_ms": 7954.847, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7954.812, "sample_time_ms": 762.547, "learn_time_ms": 7180.915, "learn_throughput": 557.032, "synch_weights_time_ms": 10.805}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000}, "done": false, "training_iteration": 197, "trial_id": "eaa30_00000", "date": "2024-08-09_18-07-25", "timestamp": 1723241245, "time_this_iter_s": 7.964899063110352, "time_total_s": 1612.287325143814, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fcaa0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1612.287325143814, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 24.224999999999998, "ram_util_percent": 79.08333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.3243246997475, "cur_kl_coeff": 0.6248944499229157, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.775773614802689, "policy_loss": -0.0015192364603675232, "vf_loss": 5.773145985477185, "vf_explained_var": 0.08203697469499376, "kl": 0.006636102592188215, "entropy": 1.130303078416794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.819657349586485, "cur_kl_coeff": 0.6012541884246516, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.318741194407145, "policy_loss": 0.010422405687859283, "vf_loss": 7.298255979518095, "vf_explained_var": 0.09371102619916201, "kl": 0.01673636211101742, "entropy": 0.9889781568199396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 189600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000}, "env_runners": {"episode_reward_max": 188.61251264624156, "episode_reward_min": -94.15612361010088, "episode_reward_mean": 37.56030227551377, "episode_len_mean": 169.56, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 16956, "policy_reward_min": {"agent_policy": -47.078061805050474, "adversary_policy": -35.45732863741709}, "policy_reward_max": {"agent_policy": 94.30625632312083, "adversary_policy": 52.6079518546709}, "policy_reward_mean": {"agent_policy": 18.780151137756885, "adversary_policy": 9.39007556887844}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.4508530893792, 29.435520169595776, 75.60834560168516, 14.833737583226593, 28.03207160491654, 65.51312585365113, 24.932338518254454, 13.946268994582354, 40.88096783889367, 49.815462868521905, -7.429634405183393, -25.00369389490973, 96.76938725151635, 82.3683294330053, 31.912585165382296, 135.6370034990956, -15.322854786326147, 54.70348314060411, 42.39940293289114, 13.496651125212766, -58.134480861821885, 40.27782468051197, -29.964376596542348, 17.545738477161073, 36.68471905956906, 54.061843107688375, 14.983278535457632, 43.24710792222497, -25.79872715991921, 26.042910072239895, 11.319010497780589, 188.61251264624156, 67.8986732391945, -94.15612361010088, -31.008690675710966, 76.79152752991487, -1.2151462690059773, 101.23625303673536, -5.576934601591333, 100.81487425917128, 152.83295102458075, 75.93773197794454, 151.75210370577082, -43.170609987192265, -1.9631117187313585, 26.669543160161233, 8.6795774408648, -0.7138025311873406, 13.530661776944001, 104.31187600162903, 44.800042486311895, 50.06397515165004, 98.10448835269816, 43.35152100863546, 33.82391738566916, 38.38238135157039, 26.412070219456723, -24.2690490362102, 140.94930692638786, 72.78847625140023, 28.248238745913653, 0.29551001491930506, 91.05506397811774, -18.988553798810784, 48.69060151380096, 20.02563382441953, 22.449758123007943, 50.52843171278407, 22.96607770187954, 24.56534023621019, 15.216575902470154, 23.430172578700734, 11.772870374157224, 56.80370393719802, 14.343444528835292, -72.49152704197991, 36.9574267143887, 47.986807012456055, 49.16911463489053, 2.214668412412763, 99.71676461085255, -13.331426336402357, 13.753819494328624, 35.207774692678186, -49.53540609899876, 115.91633545638945, 129.01105942227957, -17.235413713640817, -11.371736858617062, 61.784564938048206, 50.59569418134433, 2.646865751654012, 44.42329879732621, 33.86529346282448, 86.87589784384095, 82.0186253353985, 119.29699659473499, 66.30317251856408, 64.32331663798632, 37.61017589346619], "episode_lengths": [194, 200, 165, 200, 200, 200, 200, 200, 31, 200, 200, 200, 85, 200, 200, 64, 200, 62, 200, 10, 200, 66, 200, 200, 200, 200, 200, 200, 200, 74, 200, 125, 200, 200, 200, 200, 8, 200, 200, 200, 115, 200, 85, 200, 200, 200, 200, 200, 200, 119, 200, 200, 200, 56, 200, 200, 200, 200, 126, 133, 200, 200, 200, 200, 107, 25, 200, 71, 200, 200, 200, 200, 6, 138, 45, 200, 63, 200, 200, 200, 200, 200, 200, 200, 200, 200, 127, 200, 200, 200, 200, 200, 200, 200, 200, 200, 172, 106, 200, 178], "policy_agent_policy_reward": [15.225426544689594, 14.717760084797886, 37.8041728008426, 7.4168687916133, 14.01603580245828, 32.75656292682555, 12.46616925912723, 6.973134497291181, 20.440483919446834, 24.907731434260953, -3.7148172025917177, -12.501846947454851, 48.38469362575821, 41.18416471650262, 15.956292582691152, 67.8185017495478, -7.661427393163077, 27.351741570302046, 21.199701466445585, 6.748325562606383, -29.06724043091091, 20.138912340255985, -14.982188298271184, 8.77286923858053, 18.342359529784524, 27.03092155384419, 7.491639267728813, 21.62355396111248, -12.89936357995962, 13.02145503611995, 5.659505248890294, 94.30625632312083, 33.94933661959727, -47.078061805050474, -15.504345337855497, 38.39576376495743, -0.6075731345029894, 50.618126518367625, -2.7884673007956593, 50.40743712958566, 76.41647551229042, 37.9688659889723, 75.87605185288534, -21.58530499359615, -0.9815558593656739, 13.334771580080613, 4.3397887204324, -0.3569012655936703, 6.7653308884720005, 52.155938000814544, 22.40002124315597, 25.031987575825024, 49.05224417634912, 21.67576050431773, 16.91195869283458, 19.191190675785187, 13.206035109728361, -12.1345245181051, 70.47465346319396, 36.3942381257001, 14.124119372956823, 0.1477550074596614, 45.52753198905884, -9.494276899405413, 24.34530075690047, 10.012816912209763, 11.224879061503962, 25.264215856392042, 11.48303885093977, 12.28267011810509, 7.608287951235054, 11.715086289350364, 5.886435187078613, 28.401851968599008, 7.171722264417646, -36.24576352098988, 18.478713357194344, 23.993403506228024, 24.584557317445274, 1.1073342062063887, 49.85838230542632, -6.665713168201156, 6.876909747164312, 17.60388734633908, -24.767703049499378, 57.958167728194674, 64.50552971113979, -8.617706856820408, -5.685868429308535, 30.892282469024114, 25.297847090672157, 1.323432875827006, 22.21164939866308, 16.932646731412234, 43.43794892192054, 41.00931266769919, 59.6484982973675, 33.151586259282055, 32.161658318993176, 18.805087946733085], "policy_adversary_policy_reward": [29.615597525498664, -14.390170980809067, 13.938635364879385, 0.7791247199185012, 23.426471893754268, 14.377700907088329, -4.014840544172994, 11.431709335786294, 5.025409739434011, 8.99062606302427, 20.35846675536377, 12.39809617146179, 25.271177720909996, -12.805008461782755, 19.10101259973904, -12.127878102447859, -3.29473039014065, 23.735214309587484, 13.305526966202201, 11.602204468058751, 4.811250092233234, -8.526067294824951, -8.293984221240734, -4.207862726214117, 18.91006019794758, 29.474633427810602, 39.24402159891889, 1.9401431175837303, 6.377772311771908, 9.578520270919242, 25.18651566476334, 42.63198608478447, -16.39779656055551, 8.736369167392432, -2.440820855965189, 29.792562426267235, 5.3005424702398045, 15.899158996205777, 2.34731112805828, 4.401014434548103, -24.732073165446103, -4.335167265464824, 5.153203267292238, 14.985709072963742, -1.6750864566646424, -13.307101841606535, -5.482395006510313, 14.255264245090842, 19.461133041115104, -1.1187735113305841, 14.986512874474503, 12.044408679369683, -4.1328079487459615, 11.624447216474772, 13.4329945573846, 8.190559403727882, -24.176389102262092, 11.277025522302473, -12.445037858972984, 25.46649289509293, -19.682985218015812, 25.342490466906106, 47.625164391651055, 46.681091931469794, 30.212016711035936, 3.737319908561336, -11.62073316763339, -35.45732863741709, -11.105054271966438, -4.399291065889049, 33.43116408909649, 4.964599675860928, -1.1785048123417567, 0.5709316778387673, 13.483205872862602, 37.13492064550502, 10.091840150920717, -12.880307451716376, 21.178240645802347, 29.2291964837833, 40.053852722546175, 36.362622789744236, 25.515171984791458, 12.453694004180843, 23.26809999821443, 52.6079518546709, -18.755203966797797, -2.83010102679836, -13.703676522529253, 12.72212066316358, 19.595870467157873, -6.261098887077253, -3.976608816190902, 8.316397536623302, 6.201127358938315, -6.558028624531985, 0.7714663316546044, 5.993864556817396, 36.466373833707046, 15.689564167107502, 18.569651478561653, 3.8303697645943053, 7.677435641161768, 17.354551934663256, 29.469732258763273, 19.58251191758582, -3.0280127343839567, 24.70377323870168, -0.31466109336063397, 17.226619786195215, 12.422681616645129, 6.768509059140058, 9.381505972899639, 3.8245291368287226, -11.640298107358436, -0.49422641074666274, 45.9168290884744, 24.557824374719544, 28.442557525825535, 7.951680599874566, 24.23701964705571, -10.112900274098887, 11.77313534631455, -11.625380338854889, 21.759476085788236, 23.76805590327064, -6.305871690156193, -3.188405209249238, 34.09148680504769, -9.746186048147239, 0.20209664843305575, 9.810720263776707, -8.772169184290913, 19.997048245794872, 45.28259995453275, -20.018384098140704, 10.322480921989552, 1.1605579289502188, -2.3760692076607466, 14.658739325765836, -0.728950176605279, 8.337238127840331, 21.95640358980817, -10.241317300457805, 3.867048631277102, 2.0193865558015105, 14.15697128743361, 14.244880681165402, -0.9357671728141064, 8.107489437231752, -21.61953297478608, -14.626230546203807, -4.5335265410546555, 23.012239898249007, 4.29763674745055, 19.695766758777474, 8.804385036461184, 15.780172280984088, -1.5471565935716, 2.6544907997779923, 29.798514255128055, 20.059868050298242, -5.7840789042592, -0.8816342639419634, 12.384948954077288, -5.508039206912976, 5.383448927910514, 12.220438418428564, -1.6036343632827368, -23.16406868621664, 23.992228930587586, 33.965938797607066, 30.596468513539648, 33.909061197600145, -0.8117463836694228, -7.805960473150986, -12.3354567806586, 6.649588351350065, 10.833840913502517, 20.058441555521597, 9.6576203025956, 15.64022678807656, -6.402409689778807, 7.725842565605813, 19.833118206684098, 2.3785311919789827, 4.745078722575315, 12.18756800883692, 25.371537944124043, 18.066410977796487, 6.030567017092906, 34.9787456506063, 28.697983701151998, 30.950514596215534, 16.639216254975008, 16.512370004307037, 13.041130868528906, 19.12052745046427, 17.543349809811772, 1.261738136921311]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3920426955987745, "mean_inference_ms": 0.9755538296357439, "mean_action_processing_ms": 0.16655649177151324, "mean_env_wait_ms": 0.05831534168714254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036684274673461914, "StateBufferConnector_ms": 0.0024406909942626953, "ViewRequirementAgentConnector_ms": 0.06416630744934082}, "num_episodes": 21, "episode_return_max": 188.61251264624156, "episode_return_min": -94.15612361010088, "episode_return_mean": 37.56030227551377}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 512.292323054702, "num_env_steps_trained_throughput_per_sec": 512.292323054702, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 2376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2376000, "timers": {"training_iteration_time_ms": 7950.965, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7950.931, "sample_time_ms": 762.348, "learn_time_ms": 7177.27, "learn_throughput": 557.315, "synch_weights_time_ms": 10.772}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000}, "done": false, "training_iteration": 198, "trial_id": "eaa30_00000", "date": "2024-08-09_18-07-33", "timestamp": 1723241253, "time_this_iter_s": 7.811545133590698, "time_total_s": 1620.0988702774048, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a282f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1620.0988702774048, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 24.11818181818182, "ram_util_percent": 79.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.129418081328982, "cur_kl_coeff": 0.6248944499229157, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.863019160366563, "policy_loss": -0.0022692589269132997, "vf_loss": 5.861762572596313, "vf_explained_var": 0.005525973612669283, "kl": 0.005642312054433638, "entropy": 1.1133535737713809, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.41770066122214, "cur_kl_coeff": 0.6012541884246516, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.227075760066509, "policy_loss": 0.0060538823020275835, "vf_loss": 7.21052496979634, "vf_explained_var": 0.05141496527940035, "kl": 0.017458346611238084, "entropy": 0.9685895056774219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 190560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000}, "env_runners": {"episode_reward_max": 188.61251264624156, "episode_reward_min": -94.15612361010088, "episode_reward_mean": 40.41971198731656, "episode_len_mean": 164.95, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 16495, "policy_reward_min": {"agent_policy": -47.078061805050474, "adversary_policy": -35.45732863741709}, "policy_reward_max": {"agent_policy": 94.30625632312083, "adversary_policy": 52.6079518546709}, "policy_reward_mean": {"agent_policy": 20.209855993658277, "adversary_policy": 10.104927996829138}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.24710792222497, -25.79872715991921, 26.042910072239895, 11.319010497780589, 188.61251264624156, 67.8986732391945, -94.15612361010088, -31.008690675710966, 76.79152752991487, -1.2151462690059773, 101.23625303673536, -5.576934601591333, 100.81487425917128, 152.83295102458075, 75.93773197794454, 151.75210370577082, -43.170609987192265, -1.9631117187313585, 26.669543160161233, 8.6795774408648, -0.7138025311873406, 13.530661776944001, 104.31187600162903, 44.800042486311895, 50.06397515165004, 98.10448835269816, 43.35152100863546, 33.82391738566916, 38.38238135157039, 26.412070219456723, -24.2690490362102, 140.94930692638786, 72.78847625140023, 28.248238745913653, 0.29551001491930506, 91.05506397811774, -18.988553798810784, 48.69060151380096, 20.02563382441953, 22.449758123007943, 50.52843171278407, 22.96607770187954, 24.56534023621019, 15.216575902470154, 23.430172578700734, 11.772870374157224, 56.80370393719802, 14.343444528835292, -72.49152704197991, 36.9574267143887, 47.986807012456055, 49.16911463489053, 2.214668412412763, 99.71676461085255, -13.331426336402357, 13.753819494328624, 35.207774692678186, -49.53540609899876, 115.91633545638945, 129.01105942227957, -17.235413713640817, -11.371736858617062, 61.784564938048206, 50.59569418134433, 2.646865751654012, 44.42329879732621, 33.86529346282448, 86.87589784384095, 82.0186253353985, 119.29699659473499, 66.30317251856408, 64.32331663798632, 37.61017589346619, 0.7912659794444963, -45.057725388575605, 66.68008006356162, -11.204306133557978, 60.854626927013626, 59.576120816612544, 84.39733111688233, 97.25713339405759, 36.59472836327972, 74.25567494918764, 33.619977484701515, 41.666836145924876, 74.83272436727778, 85.0614877246962, 4.9681316627154075, 31.698460252810563, 16.037728000534223, 36.33459660356378, 76.49752457842442, -63.31603462481432, 107.33547050579784, 42.098173886672555, -15.787018617020916, -45.13725484203786, 129.2292513798764, 160.44192230536083, 4.647962263908177], "episode_lengths": [200, 200, 74, 200, 125, 200, 200, 200, 200, 8, 200, 200, 200, 115, 200, 85, 200, 200, 200, 200, 200, 200, 119, 200, 200, 200, 56, 200, 200, 200, 200, 126, 133, 200, 200, 200, 200, 107, 25, 200, 71, 200, 200, 200, 200, 6, 138, 45, 200, 63, 200, 200, 200, 200, 200, 200, 200, 200, 200, 127, 200, 200, 200, 200, 200, 200, 200, 200, 200, 172, 106, 200, 178, 200, 200, 68, 200, 200, 58, 200, 81, 200, 90, 101, 200, 119, 116, 200, 200, 200, 68, 200, 200, 111, 63, 200, 200, 58, 83, 200], "policy_agent_policy_reward": [21.62355396111248, -12.89936357995962, 13.02145503611995, 5.659505248890294, 94.30625632312083, 33.94933661959727, -47.078061805050474, -15.504345337855497, 38.39576376495743, -0.6075731345029894, 50.618126518367625, -2.7884673007956593, 50.40743712958566, 76.41647551229042, 37.9688659889723, 75.87605185288534, -21.58530499359615, -0.9815558593656739, 13.334771580080613, 4.3397887204324, -0.3569012655936703, 6.7653308884720005, 52.155938000814544, 22.40002124315597, 25.031987575825024, 49.05224417634912, 21.67576050431773, 16.91195869283458, 19.191190675785187, 13.206035109728361, -12.1345245181051, 70.47465346319396, 36.3942381257001, 14.124119372956823, 0.1477550074596614, 45.52753198905884, -9.494276899405413, 24.34530075690047, 10.012816912209763, 11.224879061503962, 25.264215856392042, 11.48303885093977, 12.28267011810509, 7.608287951235054, 11.715086289350364, 5.886435187078613, 28.401851968599008, 7.171722264417646, -36.24576352098988, 18.478713357194344, 23.993403506228024, 24.584557317445274, 1.1073342062063887, 49.85838230542632, -6.665713168201156, 6.876909747164312, 17.60388734633908, -24.767703049499378, 57.958167728194674, 64.50552971113979, -8.617706856820408, -5.685868429308535, 30.892282469024114, 25.297847090672157, 1.323432875827006, 22.21164939866308, 16.932646731412234, 43.43794892192054, 41.00931266769919, 59.6484982973675, 33.151586259282055, 32.161658318993176, 18.805087946733085, 0.3956329897222304, -22.52886269428786, 33.34004003178081, -5.602153066778985, 30.427313463506806, 29.788060408306265, 42.19866555844121, 48.62856669702879, 18.297364181639857, 37.12783747459381, 16.809988742350754, 20.833418072962456, 37.416362183638896, 42.530743862348075, 2.4840658313577038, 15.849230126405288, 8.018864000267133, 18.167298301781887, 38.24876228921222, -31.658017312407168, 53.66773525289894, 21.04908694333628, -7.89350930851047, -22.56862742101889, 64.6146256899382, 80.22096115268036, 2.3239811319540884], "policy_adversary_policy_reward": [13.4329945573846, 8.190559403727882, -24.176389102262092, 11.277025522302473, -12.445037858972984, 25.46649289509293, -19.682985218015812, 25.342490466906106, 47.625164391651055, 46.681091931469794, 30.212016711035936, 3.737319908561336, -11.62073316763339, -35.45732863741709, -11.105054271966438, -4.399291065889049, 33.43116408909649, 4.964599675860928, -1.1785048123417567, 0.5709316778387673, 13.483205872862602, 37.13492064550502, 10.091840150920717, -12.880307451716376, 21.178240645802347, 29.2291964837833, 40.053852722546175, 36.362622789744236, 25.515171984791458, 12.453694004180843, 23.26809999821443, 52.6079518546709, -18.755203966797797, -2.83010102679836, -13.703676522529253, 12.72212066316358, 19.595870467157873, -6.261098887077253, -3.976608816190902, 8.316397536623302, 6.201127358938315, -6.558028624531985, 0.7714663316546044, 5.993864556817396, 36.466373833707046, 15.689564167107502, 18.569651478561653, 3.8303697645943053, 7.677435641161768, 17.354551934663256, 29.469732258763273, 19.58251191758582, -3.0280127343839567, 24.70377323870168, -0.31466109336063397, 17.226619786195215, 12.422681616645129, 6.768509059140058, 9.381505972899639, 3.8245291368287226, -11.640298107358436, -0.49422641074666274, 45.9168290884744, 24.557824374719544, 28.442557525825535, 7.951680599874566, 24.23701964705571, -10.112900274098887, 11.77313534631455, -11.625380338854889, 21.759476085788236, 23.76805590327064, -6.305871690156193, -3.188405209249238, 34.09148680504769, -9.746186048147239, 0.20209664843305575, 9.810720263776707, -8.772169184290913, 19.997048245794872, 45.28259995453275, -20.018384098140704, 10.322480921989552, 1.1605579289502188, -2.3760692076607466, 14.658739325765836, -0.728950176605279, 8.337238127840331, 21.95640358980817, -10.241317300457805, 3.867048631277102, 2.0193865558015105, 14.15697128743361, 14.244880681165402, -0.9357671728141064, 8.107489437231752, -21.61953297478608, -14.626230546203807, -4.5335265410546555, 23.012239898249007, 4.29763674745055, 19.695766758777474, 8.804385036461184, 15.780172280984088, -1.5471565935716, 2.6544907997779923, 29.798514255128055, 20.059868050298242, -5.7840789042592, -0.8816342639419634, 12.384948954077288, -5.508039206912976, 5.383448927910514, 12.220438418428564, -1.6036343632827368, -23.16406868621664, 23.992228930587586, 33.965938797607066, 30.596468513539648, 33.909061197600145, -0.8117463836694228, -7.805960473150986, -12.3354567806586, 6.649588351350065, 10.833840913502517, 20.058441555521597, 9.6576203025956, 15.64022678807656, -6.402409689778807, 7.725842565605813, 19.833118206684098, 2.3785311919789827, 4.745078722575315, 12.18756800883692, 25.371537944124043, 18.066410977796487, 6.030567017092906, 34.9787456506063, 28.697983701151998, 30.950514596215534, 16.639216254975008, 16.512370004307037, 13.041130868528906, 19.12052745046427, 17.543349809811772, 1.261738136921311, 2.4502580440061443, -2.054625054283914, -5.7163406371705285, -16.81252205711733, 5.4509930637796025, 27.88904696800121, -19.940121426293953, 14.337968359514967, 31.063903784753585, -0.6365903212467785, 4.329862471568717, 25.458197936737555, 20.55567854330117, 21.642987015140022, 22.576807373138784, 26.05175932389001, -3.395724369117417, 21.693088550757274, 29.349172030636787, 7.7786654439570135, 33.9272809662377, -17.11729222388694, 12.735225134197332, 8.098192938765123, 40.45219424375933, -3.035832060120441, 6.796174439502003, 35.73456942284608, 10.784349701057963, -8.300283869700259, 11.58574580278821, 4.263484323617076, 6.599414424301951, 1.419449575965178, 11.948917243106962, 6.218381058674925, 27.97497811482038, 10.2737841743918, -16.817935778521687, -14.840081533885492, 39.6984243006051, 13.969310952293828, -8.413973422839259, 29.463060366175533, -6.672557410948858, -1.220951897561612, -5.901057801122505, -16.667569619896387, 28.051931866306724, 36.562693823631456, 34.51999183140392, 45.700969321276425, -2.6176341890695944, 4.941615321023683]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39198833268267225, "mean_inference_ms": 0.9755669460642793, "mean_action_processing_ms": 0.16642942236720615, "mean_env_wait_ms": 0.05830900468927172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031801462173461914, "StateBufferConnector_ms": 0.0024280548095703125, "ViewRequirementAgentConnector_ms": 0.0639183521270752}, "num_episodes": 27, "episode_return_max": 188.61251264624156, "episode_return_min": -94.15612361010088, "episode_return_mean": 40.41971198731656}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.7052662187545, "num_env_steps_trained_throughput_per_sec": 497.7052662187545, "timesteps_total": 796000, "num_env_steps_sampled_lifetime": 796000, "num_agent_steps_sampled_lifetime": 2388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2388000, "timers": {"training_iteration_time_ms": 7972.558, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7972.523, "sample_time_ms": 759.944, "learn_time_ms": 7201.379, "learn_throughput": 555.449, "synch_weights_time_ms": 10.661}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000}, "done": false, "training_iteration": 199, "trial_id": "eaa30_00000", "date": "2024-08-09_18-07-41", "timestamp": 1723241261, "time_this_iter_s": 8.040442943572998, "time_total_s": 1628.1393132209778, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fb559d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1628.1393132209778, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 24.63333333333333, "ram_util_percent": 79.12500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.556316998459044, "cur_kl_coeff": 0.6248944499229157, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.827735472734643, "policy_loss": -0.0039036965709692115, "vf_loss": 5.825770169465, "vf_explained_var": -0.003618905216297775, "kl": 0.009391987717725219, "entropy": 1.124292805522838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.44422800739606, "cur_kl_coeff": 0.6012541884246516, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.0834941700100895, "policy_loss": 0.009544429159480691, "vf_loss": 7.064358725150426, "vf_explained_var": 0.010197494613627593, "kl": 0.015951706625249546, "entropy": 0.8823482354482015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 191520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 160.44192230536083, "episode_reward_min": -72.49152704197991, "episode_reward_mean": 41.87080192375055, "episode_len_mean": 157.37, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 15737, "policy_reward_min": {"agent_policy": -36.24576352098988, "adversary_policy": -23.16406868621664}, "policy_reward_max": {"agent_policy": 80.22096115268036, "adversary_policy": 45.9168290884744}, "policy_reward_mean": {"agent_policy": 20.93540096187528, "adversary_policy": 10.467700480937637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.38238135157039, 26.412070219456723, -24.2690490362102, 140.94930692638786, 72.78847625140023, 28.248238745913653, 0.29551001491930506, 91.05506397811774, -18.988553798810784, 48.69060151380096, 20.02563382441953, 22.449758123007943, 50.52843171278407, 22.96607770187954, 24.56534023621019, 15.216575902470154, 23.430172578700734, 11.772870374157224, 56.80370393719802, 14.343444528835292, -72.49152704197991, 36.9574267143887, 47.986807012456055, 49.16911463489053, 2.214668412412763, 99.71676461085255, -13.331426336402357, 13.753819494328624, 35.207774692678186, -49.53540609899876, 115.91633545638945, 129.01105942227957, -17.235413713640817, -11.371736858617062, 61.784564938048206, 50.59569418134433, 2.646865751654012, 44.42329879732621, 33.86529346282448, 86.87589784384095, 82.0186253353985, 119.29699659473499, 66.30317251856408, 64.32331663798632, 37.61017589346619, 0.7912659794444963, -45.057725388575605, 66.68008006356162, -11.204306133557978, 60.854626927013626, 59.576120816612544, 84.39733111688233, 97.25713339405759, 36.59472836327972, 74.25567494918764, 33.619977484701515, 41.666836145924876, 74.83272436727778, 85.0614877246962, 4.9681316627154075, 31.698460252810563, 16.037728000534223, 36.33459660356378, 76.49752457842442, -63.31603462481432, 107.33547050579784, 42.098173886672555, -15.787018617020916, -45.13725484203786, 129.2292513798764, 160.44192230536083, 4.647962263908177, 30.15633360114056, 81.54504013594777, 47.9357495248773, -5.900002102485587, 83.14407395115421, 72.66274731539049, 128.06700781687735, 57.12215096813479, 94.39736628240547, 32.41125298052603, 43.3492369880927, 45.46926319692085, 22.663375914364586, 19.08675204170688, 69.781533893963, 101.60241285259579, 78.34175812005597, 100.3549093340574, 48.94102470773862, 81.51677716400283, 4.944519977601161, 60.975566906195425, -9.927820368661667, 62.72372792138994, -26.161623519783692, -6.663975647190647, 41.0862207051913, 1.7017251041140824], "episode_lengths": [200, 200, 200, 126, 133, 200, 200, 200, 200, 107, 25, 200, 71, 200, 200, 200, 200, 6, 138, 45, 200, 63, 200, 200, 200, 200, 200, 200, 200, 200, 200, 127, 200, 200, 200, 200, 200, 200, 200, 200, 200, 172, 106, 200, 178, 200, 200, 68, 200, 200, 58, 200, 81, 200, 90, 101, 200, 119, 116, 200, 200, 200, 68, 200, 200, 111, 63, 200, 200, 58, 83, 200, 200, 61, 46, 29, 158, 65, 64, 200, 75, 200, 200, 200, 200, 22, 98, 174, 200, 200, 200, 75, 200, 50, 200, 200, 200, 200, 107, 200], "policy_agent_policy_reward": [19.191190675785187, 13.206035109728361, -12.1345245181051, 70.47465346319396, 36.3942381257001, 14.124119372956823, 0.1477550074596614, 45.52753198905884, -9.494276899405413, 24.34530075690047, 10.012816912209763, 11.224879061503962, 25.264215856392042, 11.48303885093977, 12.28267011810509, 7.608287951235054, 11.715086289350364, 5.886435187078613, 28.401851968599008, 7.171722264417646, -36.24576352098988, 18.478713357194344, 23.993403506228024, 24.584557317445274, 1.1073342062063887, 49.85838230542632, -6.665713168201156, 6.876909747164312, 17.60388734633908, -24.767703049499378, 57.958167728194674, 64.50552971113979, -8.617706856820408, -5.685868429308535, 30.892282469024114, 25.297847090672157, 1.323432875827006, 22.21164939866308, 16.932646731412234, 43.43794892192054, 41.00931266769919, 59.6484982973675, 33.151586259282055, 32.161658318993176, 18.805087946733085, 0.3956329897222304, -22.52886269428786, 33.34004003178081, -5.602153066778985, 30.427313463506806, 29.788060408306265, 42.19866555844121, 48.62856669702879, 18.297364181639857, 37.12783747459381, 16.809988742350754, 20.833418072962456, 37.416362183638896, 42.530743862348075, 2.4840658313577038, 15.849230126405288, 8.018864000267133, 18.167298301781887, 38.24876228921222, -31.658017312407168, 53.66773525289894, 21.04908694333628, -7.89350930851047, -22.56862742101889, 64.6146256899382, 80.22096115268036, 2.3239811319540884, 15.07816680057028, 40.772520067973886, 23.967874762438647, -2.9500010512427948, 41.57203697557707, 36.331373657695266, 64.03350390843868, 28.561075484067374, 47.19868314120273, 16.205626490263015, 21.674618494046364, 22.734631598460393, 11.331687957182293, 9.543376020853437, 34.89076694698149, 50.8012064262979, 39.170879060028014, 50.177454667028684, 24.470512353869317, 40.7583885820014, 2.472259988800573, 30.487783453097723, -4.963910184330807, 31.361863960694965, -13.080811759891862, -3.3319878235953198, 20.543110352595658, 0.8508625520570448], "policy_adversary_policy_reward": [12.422681616645129, 6.768509059140058, 9.381505972899639, 3.8245291368287226, -11.640298107358436, -0.49422641074666274, 45.9168290884744, 24.557824374719544, 28.442557525825535, 7.951680599874566, 24.23701964705571, -10.112900274098887, 11.77313534631455, -11.625380338854889, 21.759476085788236, 23.76805590327064, -6.305871690156193, -3.188405209249238, 34.09148680504769, -9.746186048147239, 0.20209664843305575, 9.810720263776707, -8.772169184290913, 19.997048245794872, 45.28259995453275, -20.018384098140704, 10.322480921989552, 1.1605579289502188, -2.3760692076607466, 14.658739325765836, -0.728950176605279, 8.337238127840331, 21.95640358980817, -10.241317300457805, 3.867048631277102, 2.0193865558015105, 14.15697128743361, 14.244880681165402, -0.9357671728141064, 8.107489437231752, -21.61953297478608, -14.626230546203807, -4.5335265410546555, 23.012239898249007, 4.29763674745055, 19.695766758777474, 8.804385036461184, 15.780172280984088, -1.5471565935716, 2.6544907997779923, 29.798514255128055, 20.059868050298242, -5.7840789042592, -0.8816342639419634, 12.384948954077288, -5.508039206912976, 5.383448927910514, 12.220438418428564, -1.6036343632827368, -23.16406868621664, 23.992228930587586, 33.965938797607066, 30.596468513539648, 33.909061197600145, -0.8117463836694228, -7.805960473150986, -12.3354567806586, 6.649588351350065, 10.833840913502517, 20.058441555521597, 9.6576203025956, 15.64022678807656, -6.402409689778807, 7.725842565605813, 19.833118206684098, 2.3785311919789827, 4.745078722575315, 12.18756800883692, 25.371537944124043, 18.066410977796487, 6.030567017092906, 34.9787456506063, 28.697983701151998, 30.950514596215534, 16.639216254975008, 16.512370004307037, 13.041130868528906, 19.12052745046427, 17.543349809811772, 1.261738136921311, 2.4502580440061443, -2.054625054283914, -5.7163406371705285, -16.81252205711733, 5.4509930637796025, 27.88904696800121, -19.940121426293953, 14.337968359514967, 31.063903784753585, -0.6365903212467785, 4.329862471568717, 25.458197936737555, 20.55567854330117, 21.642987015140022, 22.576807373138784, 26.05175932389001, -3.395724369117417, 21.693088550757274, 29.349172030636787, 7.7786654439570135, 33.9272809662377, -17.11729222388694, 12.735225134197332, 8.098192938765123, 40.45219424375933, -3.035832060120441, 6.796174439502003, 35.73456942284608, 10.784349701057963, -8.300283869700259, 11.58574580278821, 4.263484323617076, 6.599414424301951, 1.419449575965178, 11.948917243106962, 6.218381058674925, 27.97497811482038, 10.2737841743918, -16.817935778521687, -14.840081533885492, 39.6984243006051, 13.969310952293828, -8.413973422839259, 29.463060366175533, -6.672557410948858, -1.220951897561612, -5.901057801122505, -16.667569619896387, 28.051931866306724, 36.562693823631456, 34.51999183140392, 45.700969321276425, -2.6176341890695944, 4.941615321023683, 9.705360265064975, 5.372806535505305, 19.158274802816692, 21.614245265157194, 3.1468429973148204, 20.821031765123827, -19.99225905131297, 17.042258000070177, 27.135636951623265, 14.436400023953814, 29.88776033427283, 6.443613323422419, 35.89140301553146, 28.142100892907237, 19.815185760689758, 8.745889723377626, 24.00177041423021, 23.19691272697254, 11.100322633753084, 5.105303856509931, 25.711643258936945, -4.037024764890582, 10.578049068306168, 12.156582530154235, 11.157386064115329, 0.1743018930669642, 17.112246962676505, -7.568870941823067, 12.23969850822575, 22.651068438755754, 41.65260578137719, 9.148600644920695, 23.046307934543023, 16.12457112548499, 34.75969716829469, 15.41775749873403, 5.436448126846361, 19.03406422702296, 25.252759554219057, 15.50562902778234, 13.400656513333235, -10.928396524532662, 14.018706530608135, 16.469076922489577, 1.9763063098338236, -6.940216494164627, 26.9485300579165, 4.4133339027784615, 6.487452775014219, -19.56826453490608, 1.7287584428104452, -5.060746266405765, 30.641202548405854, -10.098092195810196, -3.5113120049902697, 4.3621745570473145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3919345916219972, "mean_inference_ms": 0.9752344567952552, "mean_action_processing_ms": 0.16643259008036712, "mean_env_wait_ms": 0.058304720689691274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033092498779296875, "StateBufferConnector_ms": 0.0024836063385009766, "ViewRequirementAgentConnector_ms": 0.06593239307403564}, "num_episodes": 28, "episode_return_max": 160.44192230536083, "episode_return_min": -72.49152704197991, "episode_return_mean": 41.87080192375055}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 508.7669357968775, "num_env_steps_trained_throughput_per_sec": 508.7669357968775, "timesteps_total": 800000, "num_env_steps_sampled_lifetime": 800000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 7969.896, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7969.861, "sample_time_ms": 761.84, "learn_time_ms": 7196.958, "learn_throughput": 555.79, "synch_weights_time_ms": 10.524}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": true, "training_iteration": 200, "trial_id": "eaa30_00000", "date": "2024-08-09_18-07-49", "timestamp": 1723241269, "time_this_iter_s": 7.8673646450042725, "time_total_s": 1636.006677865982, "pid": 32293, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fb55d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1636.006677865982, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 24.781818181818178, "ram_util_percent": 79.05454545454546}}
