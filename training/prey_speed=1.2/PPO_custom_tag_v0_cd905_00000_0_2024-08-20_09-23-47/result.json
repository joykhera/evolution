{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0711785450104683, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0001, "total_loss": 8.409195016679309, "policy_loss": -0.0008674870426249173, "vf_loss": 8.409776131312052, "vf_explained_var": 0.0006286377944643535, "kl": 0.0014319153342747931, "entropy": 1.6080203307999505, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.272707647723811, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0001, "total_loss": 6.768428511846633, "policy_loss": -0.0004139470254322366, "vf_loss": 6.7687977518354145, "vf_explained_var": -0.000163801700349838, "kl": 0.0002235591723175521, "entropy": 1.609217401345571, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 237.4633034962182, "num_env_steps_trained_throughput_per_sec": 237.4633034962182, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 33690.592, "restore_workers_time_ms": 0.018, "training_step_time_ms": 33688.691, "sample_time_ms": 1729.228, "learn_time_ms": 31916.757, "learn_throughput": 250.652, "synch_weights_time_ms": 28.145}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 1, "trial_id": "cd905_00000", "date": "2024-08-20_09-24-31", "timestamp": 1724126071, "time_this_iter_s": 33.73365879058838, "time_total_s": 33.73365879058838, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f255e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.73365879058838, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 43.49387755102041, "ram_util_percent": 82.48163265306123}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.968530240755469, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.0001, "total_loss": 7.177496272798568, "policy_loss": -0.0004365375483526833, "vf_loss": 7.177882485162645, "vf_explained_var": 0.0027511555997152175, "kl": 0.0005030164217914933, "entropy": 1.6047857821933806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4895073514668241, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.0001, "total_loss": 5.039126278105236, "policy_loss": -0.0011226710785801211, "vf_loss": 5.040063195379954, "vf_explained_var": -0.00015489042751372806, "kl": 0.001857251257834356, "entropy": 1.6062564344633192, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 251.59999999999937, "episode_reward_min": -35.67820482306133, "episode_reward_mean": 81.8170336061254, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -552.8744926157972, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 136.71520032220093, "predator_policy": 514.5207465747707}, "policy_reward_mean": {"prey_policy": -92.77413781132192, "predator_policy": 133.68265461438463}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.100000000000172, 113.59999999999982, 179.85279853684497, 128.19999999999953, 251.59999999999937, 103.85733253497214, 101.90000000000003, 75.19999999999993, 64.2000000000001, 23.60000000000003, 146.69999999999956, 87.74870802986538, 29.600000000000144, 165.5408708168671, 125.21587175598306, 93.1, 35.47277783078676, 52.20000000000008, 32.9000000000001, 173.19999999999982, 45.569691768556574, 84.60643779247897, 27.800000000000132, 23.200000000000003, -17.14455385480637, 169.09999999999928, 164.85604644720323, 126.19999999999985, -35.67820482306133, 104.38847864358601, 98.66106663571733, 21.100407595485393, -26.702704670558823, 51.56700816205467, 50.6244474620001, 27.1000000000001, 143.14023084112844, 31.400000000000137, 45.30000000000013, 112.42622704191095, 100.6966519638654, 80.60000000000024, 98.76843970240606, 24.020585634213994, 25.500000000000096, 77.49999999999997, 137.69999999999914, 33.40000000000021, 112.83305875575275, 14.853893135031248, 52.50000000000023, 110.09999999999955, 95.41348120209275, -0.8200752752070243, -0.10257593431517087, 92.28415769390425, 52.80204824828002, 207.08067980748027, 104.90176543552435, 67.99999999999987, 17.999999999999993, 87.2999999999991, 44.100000000000215, 129.2999999999996, 86.10000000000024, 34.03639519013095, 75.69999999999959, 235.3999999999995, 146.63722873703796, 120.09999999999994, 110.15983555924313, 53.65791123857705], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-115.90188016935548, -77.1056195043788, -123.11073773416695, -10.034209704429506, -44.474014626839704, 17.085834953792023, -145.40814931583319, 82.10474713204944, 64.51172525227962, 125.86679304489732, 65.76502302052245, -83.35815118556094, 41.43036088521265, -87.28205960103963, -144.59534628043195, -115.04347012005874, -228.57423219346032, 58.700000000000074, -287.30601199473244, -51.49548085322601, 41.91259303383902, -32.93743083251089, -291.0328331499896, -79.86969384295621, -26.619090298555797, -153.11587457047082, -46.25746720462417, 95.25264820496818, -93.72079892619107, -26.05400237957368, -139.40132101876102, -179.91822289567898, -217.0340125185261, -74.78391623571179, -162.22890376151324, -148.67990852919877, -70.49661794717075, -102.88117919894025, 13.704817999789023, 52.23401093705162, -138.56335660713478, -305.1225268001084, -156.7095177658455, -241.15995404606227, 17.691996119390065, -213.62492892859942, -220.5599346301866, -129.49708096512597, -320.91198239975137, -329.76279472572423, -37.24965499779699, 126.02298446978766, 47.9503351818162, -121.75777501711792, -10.856780521514189, -54.56416709234649, -170.0792434456779, -224.94040961184564, -79.56693770391045, 39.48125129000266, -22.850226789515155, -85.10751320352995, -137.92042270237027, -20.766900597910077, -127.7975603724881, -95.61044812639402, 4.326228065121034, -214.17737508742985, -112.25152369953909, -23.68639970641206, -182.70316143242422, -21.62031814947355, -45.946557200434526, -54.892284902020805, 18.963222391090927, -272.2941920518331, -111.90523095263333, -276.2948204659152, 32.74592680607392, -233.14760983101667, -41.46177508504444, -552.8744926157972, 10.916360298205584, 31.81864824623771, 18.133113172427247, -22.92119563044443, -278.15157938644165, -8.547318577211866, -117.4491906542828, -168.36186688066465, -319.59572598337405, -186.25312547747095, 52.51785297640658, 81.1757622939015, -41.225071636431885, -13.899985028429892, -334.1500020463539, -156.89546531535967, -269.5828030279167, -199.35290151370535, -53.5179387318049, 14.381004175241841, 42.475495104498336, -36.129639647497314, -30.989603318821946, -33.556264000533986, -138.787019469115, -180.88055019022792, -129.03103334662404, -184.28662275079796, -68.52256259153366, -11.97124104963675, -156.4997260172407, 20.22837250797317, 136.71520032220093, -24.61681105203188, -50.67047098400403, -260.5786897136976, -49.72417471985246, -137.1068181304719, -106.98322515874463, -314.1500156046692, 47.804401651511874, -266.5859541900282, -220.05018082935396, -7.376865855743047, -35.3146440459439, 30.977729544170607, -33.57363791016852, -131.11637321302146, -197.32672775246235, -265.99479382616937, -167.00364892683976, -99.6298959663075, 130.2694787877467, 47.93786126587373, -41.18997681077637, -150.58615857011648, -42.984633146776595, -290.2838803121177, -77.58861260248669, -22.262431202766784, -94.40612664890386, 4.042050305757655], "policy_predator_policy_reward": [128.7018801693556, 95.40561950437792, 190.5107377341668, 56.23420970442967, 56.81573003839473, 150.42524817149868, 157.40814931583319, 34.0952528679502, 34.48827474772046, 26.733206955102535, 7.533660259215094, 113.91680044079558, 5.920379644581329, 141.83131907124553, 190.13319927662317, 144.70561712386643, 234.07423219346018, 0.0, 293.6060119947323, 68.79548085322608, 74.08740696616101, 63.637430832511036, 169.35973477105122, 289.29150025176, 44.719090298556054, 164.61587457047023, 74.71341603446857, 41.83227378205525, 195.40698112518837, 49.58369193655976, 152.501321018761, 259.91822289567943, 245.81673241814386, 81.47397416688017, 177.2289037615129, 185.8799085291985, 84.0966179471709, 122.18117919894014, 41.795182000211035, 65.4659890629484, 303.7767726903035, 185.47880248549566, 236.25129363498476, 246.2246159694019, 3.9528744378330867, 219.78005837137582, 230.559934630186, 142.69708096512565, 399.6376815224089, 233.89254174825982, 69.42032357398152, 10.906346954027914, 110.43479712574678, 128.22868915675846, 104.25678052151402, 87.36416709234601, 335.0544451773311, 24.28700305713057, 114.1541157301862, 30.320049327308528, 140.28248635283254, 66.33632027593023, 163.01093905271543, 16.776791843050145, 11.200036853727937, 185.5052669745939, 138.8468811198308, 122.57127406453213, 0.8257465718630717, 185.73662429608802, 192.90316143242381, 38.520318149473795, 120.01714832968732, 123.96192461389697, 3.43677760890906, 281.2941920518342, 127.99991273070725, 305.500138687841, 135.2858976022534, 177.54201246460065, 180.51217308993637, 514.5207465747707, 3.0457069351639565, 34.819284520392955, 13.267111905759613, 90.28941025466389, 297.5458981131471, 13.173585484721444, 131.349190654282, 179.96186688066402, 332.59572598337536, 250.75312547747086, 3.182147023593455, 0.8242377060979771, 28.698885317023205, 59.82617134783878, 257.18270006156115, 346.69582605590625, 269.2216349400608, 214.5679627365926, 86.41793873180478, 5.218995824758123, 29.623030534718257, 74.13111400828096, 44.14831421661337, 115.81103430483618, 234.1111984548819, 84.73629592925283, 25.304485696961468, 287.9105944661443, 133.74709389754767, 39.03086743752706, 51.50388364309443, 137.56951811445288, 43.29474979892683, 51.68754073838494, 193.27270901024787, 222.87821712298089, 73.5241747198524, 181.3068181304719, 118.6832251587445, 320.45001560466915, 32.095598348488295, 273.98595419002794, 246.3501808293537, 25.176865855743102, 91.61464404594389, 42.022270455829506, 95.47363791016845, 155.31637321302117, 227.74925850653386, 269.6086582622301, 201.73120914460674, 140.6023357485401, 25.630521212253203, 31.56213873412637, 163.6986757417014, 174.71468837622987, 154.2846331467765, 299.0838803121177, 77.7093944743593, 132.3014848901381, 42.194269195821356, 101.8277183859012]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.98141831575039, "mean_inference_ms": 4.857623016280549, "mean_action_processing_ms": 2.139660253389091, "mean_env_wait_ms": 1.5507344582386666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018239849143558078, "StateBufferConnector_ms": 0.02092421054840088, "ViewRequirementAgentConnector_ms": 0.14668868647681343}, "num_episodes": 72, "episode_return_max": 251.59999999999937, "episode_return_min": -35.67820482306133, "episode_return_mean": 81.8170336061254, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 241.59575099933448, "num_env_steps_trained_throughput_per_sec": 241.59575099933448, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 33401.911, "restore_workers_time_ms": 0.061, "training_step_time_ms": 33400.846, "sample_time_ms": 1754.19, "learn_time_ms": 31615.774, "learn_throughput": 253.038, "synch_weights_time_ms": 20.414}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 2, "trial_id": "cd905_00000", "date": "2024-08-20_09-25-07", "timestamp": 1724126107, "time_this_iter_s": 33.16492414474487, "time_total_s": 66.89858293533325, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f0d9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 66.89858293533325, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 44.35882352941176, "ram_util_percent": 82.5313725490196}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.113309507474067, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 7.295164418598962, "policy_loss": -0.001795030322428497, "vf_loss": 7.296787719121055, "vf_explained_var": 0.006979366521986704, "kl": 0.003435140494648899, "entropy": 1.6050924902870543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5389576073913347, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 5.460996375765119, "policy_loss": -0.0011820539274060772, "vf_loss": 5.462040689256456, "vf_explained_var": -0.0003158292127034021, "kl": 0.0027548392234209695, "entropy": 1.5954604943593342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 251.59999999999937, "episode_reward_min": -35.67820482306133, "episode_reward_mean": 81.8170336061254, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -552.8744926157972, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 136.71520032220093, "predator_policy": 514.5207465747707}, "policy_reward_mean": {"prey_policy": -92.77413781132192, "predator_policy": 133.68265461438463}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.100000000000172, 113.59999999999982, 179.85279853684497, 128.19999999999953, 251.59999999999937, 103.85733253497214, 101.90000000000003, 75.19999999999993, 64.2000000000001, 23.60000000000003, 146.69999999999956, 87.74870802986538, 29.600000000000144, 165.5408708168671, 125.21587175598306, 93.1, 35.47277783078676, 52.20000000000008, 32.9000000000001, 173.19999999999982, 45.569691768556574, 84.60643779247897, 27.800000000000132, 23.200000000000003, -17.14455385480637, 169.09999999999928, 164.85604644720323, 126.19999999999985, -35.67820482306133, 104.38847864358601, 98.66106663571733, 21.100407595485393, -26.702704670558823, 51.56700816205467, 50.6244474620001, 27.1000000000001, 143.14023084112844, 31.400000000000137, 45.30000000000013, 112.42622704191095, 100.6966519638654, 80.60000000000024, 98.76843970240606, 24.020585634213994, 25.500000000000096, 77.49999999999997, 137.69999999999914, 33.40000000000021, 112.83305875575275, 14.853893135031248, 52.50000000000023, 110.09999999999955, 95.41348120209275, -0.8200752752070243, -0.10257593431517087, 92.28415769390425, 52.80204824828002, 207.08067980748027, 104.90176543552435, 67.99999999999987, 17.999999999999993, 87.2999999999991, 44.100000000000215, 129.2999999999996, 86.10000000000024, 34.03639519013095, 75.69999999999959, 235.3999999999995, 146.63722873703796, 120.09999999999994, 110.15983555924313, 53.65791123857705], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-115.90188016935548, -77.1056195043788, -123.11073773416695, -10.034209704429506, -44.474014626839704, 17.085834953792023, -145.40814931583319, 82.10474713204944, 64.51172525227962, 125.86679304489732, 65.76502302052245, -83.35815118556094, 41.43036088521265, -87.28205960103963, -144.59534628043195, -115.04347012005874, -228.57423219346032, 58.700000000000074, -287.30601199473244, -51.49548085322601, 41.91259303383902, -32.93743083251089, -291.0328331499896, -79.86969384295621, -26.619090298555797, -153.11587457047082, -46.25746720462417, 95.25264820496818, -93.72079892619107, -26.05400237957368, -139.40132101876102, -179.91822289567898, -217.0340125185261, -74.78391623571179, -162.22890376151324, -148.67990852919877, -70.49661794717075, -102.88117919894025, 13.704817999789023, 52.23401093705162, -138.56335660713478, -305.1225268001084, -156.7095177658455, -241.15995404606227, 17.691996119390065, -213.62492892859942, -220.5599346301866, -129.49708096512597, -320.91198239975137, -329.76279472572423, -37.24965499779699, 126.02298446978766, 47.9503351818162, -121.75777501711792, -10.856780521514189, -54.56416709234649, -170.0792434456779, -224.94040961184564, -79.56693770391045, 39.48125129000266, -22.850226789515155, -85.10751320352995, -137.92042270237027, -20.766900597910077, -127.7975603724881, -95.61044812639402, 4.326228065121034, -214.17737508742985, -112.25152369953909, -23.68639970641206, -182.70316143242422, -21.62031814947355, -45.946557200434526, -54.892284902020805, 18.963222391090927, -272.2941920518331, -111.90523095263333, -276.2948204659152, 32.74592680607392, -233.14760983101667, -41.46177508504444, -552.8744926157972, 10.916360298205584, 31.81864824623771, 18.133113172427247, -22.92119563044443, -278.15157938644165, -8.547318577211866, -117.4491906542828, -168.36186688066465, -319.59572598337405, -186.25312547747095, 52.51785297640658, 81.1757622939015, -41.225071636431885, -13.899985028429892, -334.1500020463539, -156.89546531535967, -269.5828030279167, -199.35290151370535, -53.5179387318049, 14.381004175241841, 42.475495104498336, -36.129639647497314, -30.989603318821946, -33.556264000533986, -138.787019469115, -180.88055019022792, -129.03103334662404, -184.28662275079796, -68.52256259153366, -11.97124104963675, -156.4997260172407, 20.22837250797317, 136.71520032220093, -24.61681105203188, -50.67047098400403, -260.5786897136976, -49.72417471985246, -137.1068181304719, -106.98322515874463, -314.1500156046692, 47.804401651511874, -266.5859541900282, -220.05018082935396, -7.376865855743047, -35.3146440459439, 30.977729544170607, -33.57363791016852, -131.11637321302146, -197.32672775246235, -265.99479382616937, -167.00364892683976, -99.6298959663075, 130.2694787877467, 47.93786126587373, -41.18997681077637, -150.58615857011648, -42.984633146776595, -290.2838803121177, -77.58861260248669, -22.262431202766784, -94.40612664890386, 4.042050305757655], "policy_predator_policy_reward": [128.7018801693556, 95.40561950437792, 190.5107377341668, 56.23420970442967, 56.81573003839473, 150.42524817149868, 157.40814931583319, 34.0952528679502, 34.48827474772046, 26.733206955102535, 7.533660259215094, 113.91680044079558, 5.920379644581329, 141.83131907124553, 190.13319927662317, 144.70561712386643, 234.07423219346018, 0.0, 293.6060119947323, 68.79548085322608, 74.08740696616101, 63.637430832511036, 169.35973477105122, 289.29150025176, 44.719090298556054, 164.61587457047023, 74.71341603446857, 41.83227378205525, 195.40698112518837, 49.58369193655976, 152.501321018761, 259.91822289567943, 245.81673241814386, 81.47397416688017, 177.2289037615129, 185.8799085291985, 84.0966179471709, 122.18117919894014, 41.795182000211035, 65.4659890629484, 303.7767726903035, 185.47880248549566, 236.25129363498476, 246.2246159694019, 3.9528744378330867, 219.78005837137582, 230.559934630186, 142.69708096512565, 399.6376815224089, 233.89254174825982, 69.42032357398152, 10.906346954027914, 110.43479712574678, 128.22868915675846, 104.25678052151402, 87.36416709234601, 335.0544451773311, 24.28700305713057, 114.1541157301862, 30.320049327308528, 140.28248635283254, 66.33632027593023, 163.01093905271543, 16.776791843050145, 11.200036853727937, 185.5052669745939, 138.8468811198308, 122.57127406453213, 0.8257465718630717, 185.73662429608802, 192.90316143242381, 38.520318149473795, 120.01714832968732, 123.96192461389697, 3.43677760890906, 281.2941920518342, 127.99991273070725, 305.500138687841, 135.2858976022534, 177.54201246460065, 180.51217308993637, 514.5207465747707, 3.0457069351639565, 34.819284520392955, 13.267111905759613, 90.28941025466389, 297.5458981131471, 13.173585484721444, 131.349190654282, 179.96186688066402, 332.59572598337536, 250.75312547747086, 3.182147023593455, 0.8242377060979771, 28.698885317023205, 59.82617134783878, 257.18270006156115, 346.69582605590625, 269.2216349400608, 214.5679627365926, 86.41793873180478, 5.218995824758123, 29.623030534718257, 74.13111400828096, 44.14831421661337, 115.81103430483618, 234.1111984548819, 84.73629592925283, 25.304485696961468, 287.9105944661443, 133.74709389754767, 39.03086743752706, 51.50388364309443, 137.56951811445288, 43.29474979892683, 51.68754073838494, 193.27270901024787, 222.87821712298089, 73.5241747198524, 181.3068181304719, 118.6832251587445, 320.45001560466915, 32.095598348488295, 273.98595419002794, 246.3501808293537, 25.176865855743102, 91.61464404594389, 42.022270455829506, 95.47363791016845, 155.31637321302117, 227.74925850653386, 269.6086582622301, 201.73120914460674, 140.6023357485401, 25.630521212253203, 31.56213873412637, 163.6986757417014, 174.71468837622987, 154.2846331467765, 299.0838803121177, 77.7093944743593, 132.3014848901381, 42.194269195821356, 101.8277183859012]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.98141831575039, "mean_inference_ms": 4.857623016280549, "mean_action_processing_ms": 2.139660253389091, "mean_env_wait_ms": 1.5507344582386666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018239849143558078, "StateBufferConnector_ms": 0.02092421054840088, "ViewRequirementAgentConnector_ms": 0.14668868647681343}, "num_episodes": 0, "episode_return_max": 251.59999999999937, "episode_return_min": -35.67820482306133, "episode_return_mean": 81.8170336061254, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 241.08712815004023, "num_env_steps_trained_throughput_per_sec": 241.08712815004023, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 33328.975, "restore_workers_time_ms": 0.046, "training_step_time_ms": 33327.811, "sample_time_ms": 1678.558, "learn_time_ms": 31615.862, "learn_throughput": 253.038, "synch_weights_time_ms": 24.332}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 3, "trial_id": "cd905_00000", "date": "2024-08-20_09-25-40", "timestamp": 1724126140, "time_this_iter_s": 33.20946717262268, "time_total_s": 100.10805010795593, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f68430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 100.10805010795593, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 42.78936170212766, "ram_util_percent": 82.61702127659574}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.02169972331751, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 0.0001, "total_loss": 6.6591490669855995, "policy_loss": -5.1801719347990694e-05, "vf_loss": 6.659165446720426, "vf_explained_var": 0.008516711658901638, "kl": 0.0014155081237111026, "entropy": 1.5952782748237488, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 2205.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6197356403406177, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 0.0001, "total_loss": 4.45793595162649, "policy_loss": -0.0015950546097306033, "vf_loss": 4.459399994214376, "vf_explained_var": 0.0005621718981909373, "kl": 0.005240560459071911, "entropy": 1.5780710280887664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 2205.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 288.92913646224224, "episode_reward_min": -124.10637563417316, "episode_reward_mean": 86.80506685007654, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -374.5672412397589, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.41230328644872, "predator_policy": 455.7630217558212}, "policy_reward_mean": {"prey_policy": -73.74685801982605, "predator_policy": 117.14939144486429}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.500000000000096, 77.49999999999997, 137.69999999999914, 33.40000000000021, 112.83305875575275, 14.853893135031248, 52.50000000000023, 110.09999999999955, 95.41348120209275, -0.8200752752070243, -0.10257593431517087, 92.28415769390425, 52.80204824828002, 207.08067980748027, 104.90176543552435, 67.99999999999987, 17.999999999999993, 87.2999999999991, 44.100000000000215, 129.2999999999996, 86.10000000000024, 34.03639519013095, 75.69999999999959, 235.3999999999995, 146.63722873703796, 120.09999999999994, 110.15983555924313, 53.65791123857705, 114.09621087859101, 63.31072633477795, 234.9540263176631, 113.20000000000002, 110.91318595522348, 28.500000000000057, 84.52647129833852, 196.0999999999995, 146.29999999999959, 155.3999999999995, 40.927130611680724, 55.900000000000134, 219.69999999999916, 38.045252066153004, 22.746941969306278, 50.391281596323616, 96.87467021170656, 55.200000000000294, 29.13714613745018, 43.80000000000012, 138.19999999999965, 45.30000000000025, 59.536461044703216, 42.600000000000186, 53.700000000000166, 48.02425055440496, 89.44841545618408, 86.30892994651286, 72.39760037057295, 78.09999999999937, 288.92913646224224, 182.30196377644808, 162.8130957629252, 156.48644100001016, 127.69999999999959, 49.90145232140156, 153.92744961973082, 75.23213055128052, 132.2811925962208, 49.69069468061068, 28.200667724308072, 117.19999999999987, 70.79999999999974, 107.00000000000003, 86.09999999999971, 102.10000000000021, 41.900000000000276, 236.29759415855324, 25.064806914511866, 157.99999999999918, 73.00000000000014, 36.10000000000009, 63.62285222836394, 138.39244335951764, 77.99999999999986, 34.200000000000124, 59.00000000000011, 76.43197080683858, 51.800000000000445, 54.241286956416, 42.10000000000013, 103.28853246855994, 124.37369126578969, 140.29999999999967, -11.407875866112455, 123.02226742260966, 59.544761888483215, 97.39999999999921, 70.50000000000026, -124.10637563417316, 53.60000000000027, 47.100000000000186], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-117.4491906542828, -168.36186688066465, -319.59572598337405, -186.25312547747095, 52.51785297640658, 81.1757622939015, -41.225071636431885, -13.899985028429892, -334.1500020463539, -156.89546531535967, -269.5828030279167, -199.35290151370535, -53.5179387318049, 14.381004175241841, 42.475495104498336, -36.129639647497314, -30.989603318821946, -33.556264000533986, -138.787019469115, -180.88055019022792, -129.03103334662404, -184.28662275079796, -68.52256259153366, -11.97124104963675, -156.4997260172407, 20.22837250797317, 136.71520032220093, -24.61681105203188, -50.67047098400403, -260.5786897136976, -49.72417471985246, -137.1068181304719, -106.98322515874463, -314.1500156046692, 47.804401651511874, -266.5859541900282, -220.05018082935396, -7.376865855743047, -35.3146440459439, 30.977729544170607, -33.57363791016852, -131.11637321302146, -197.32672775246235, -265.99479382616937, -167.00364892683976, -99.6298959663075, 130.2694787877467, 47.93786126587373, -41.18997681077637, -150.58615857011648, -42.984633146776595, -290.2838803121177, -77.58861260248669, -22.262431202766784, -94.40612664890386, 4.042050305757655, -13.756894284094663, -44.15879685573444, 2.9840337460608084, -57.546251285427, -71.26678926070826, 158.51167866126494, -89.52901115440147, -11.994698012916174, -196.3454671202625, -1.3360708368475365, -178.7460453506432, -311.6633258678961, -48.0339059061539, -186.0486202308065, 148.60170211178425, -139.50773466258602, 55.80933748013535, 17.45365162956542, -64.74743217591451, 99.3501902093218, -136.07329122646945, -110.8312783447864, -41.91767004258553, -374.5672412397589, 117.95809072939531, 44.36523325906381, -82.82057111222856, -136.53194865883057, -215.79402791537163, -250.75853972248765, -71.0758136611596, -28.5660525740712, 0.5386185752432355, -90.53480190024985, -62.38040959340979, -47.896216805800194, -76.48883232973812, -40.456144228413095, -107.95655327333884, -255.55001027822502, -95.83075955599593, 109.32190391994756, -39.22809341046681, -80.51434785702058, -142.03504733354143, -103.28230744263084, -99.50853326899052, -235.23690519812484, 5.035689980087747, -73.67897640319391, -13.30040374398629, -115.68624283390233, -57.0626875120347, 10.30644709877976, -30.069153414543166, -28.459989450548946, -70.75901175548083, -220.55298057513124, -237.74313604946377, -26.17570127927456, 83.3078516341123, 171.41230328644872, 99.14027015885328, -14.217314360226762, 62.04181601322718, -135.96781062987725, -138.48747958744184, 29.41819641145255, -280.5593209899287, 32.4431955739048, -109.60412115860875, -161.70475592306815, -42.14952880797598, -86.77378311047565, -36.12156380800714, -31.336795564941603, -50.8264246519387, 16.693932192324105, -82.42278608312193, -241.01146111972784, -42.92491731829379, -66.29327224496194, -220.63539423773273, 86.89309235686247, -48.833207832604174, -112.34253010990905, 66.35704340756791, -290.59697143593274, 15.959849342442794, -49.57212726842854, 0.8488332627143098, -5.2155548578059765, -133.19525353126159, -32.73649961884832, 98.4818944146887, 89.400496997678, -78.16063621423503, -144.628034608063, -29.96979436900145, 52.59703782661663, -45.30047500506129, -3.6415424473456337, -88.93659736275394, -148.23014402443735, -180.22551283448453, 19.852702350889054, -47.94164584125528, 39.800000000000196, 22.70000000000001, -130.87227725000895, -156.02027159684246, 15.549057848998991, -128.15763540860354, 12.968813224578707, -115.78799638232277, 19.305668671018495, 13.675729429253591, 14.050495496547747, -40.88430533835528, -169.84960669100613, -202.46690849555748, -105.92712349354883, -111.50575691798481, -94.68580237084183, -85.15520355138528, 46.5520995831993, 78.75671940624915, -309.8155627769405, -201.254319087989, -157.62239238245198, -2.8044694468468645, -155.4111810945674, -118.85363264593377, -50.42611589799786, 18.369302728103023, 68.4710963921922, -21.151614415769387, 18.406441844279243, -239.82852288435123, -368.0455055187578, -36.892631580014964, 20.000000000000014, 20.900000000000027, -146.45742912258572], "policy_predator_policy_reward": [131.349190654282, 179.96186688066402, 332.59572598337536, 250.75312547747086, 3.182147023593455, 0.8242377060979771, 28.698885317023205, 59.82617134783878, 257.18270006156115, 346.69582605590625, 269.2216349400608, 214.5679627365926, 86.41793873180478, 5.218995824758123, 29.623030534718257, 74.13111400828096, 44.14831421661337, 115.81103430483618, 234.1111984548819, 84.73629592925283, 25.304485696961468, 287.9105944661443, 133.74709389754767, 39.03086743752706, 51.50388364309443, 137.56951811445288, 43.29474979892683, 51.68754073838494, 193.27270901024787, 222.87821712298089, 73.5241747198524, 181.3068181304719, 118.6832251587445, 320.45001560466915, 32.095598348488295, 273.98595419002794, 246.3501808293537, 25.176865855743102, 91.61464404594389, 42.022270455829506, 95.47363791016845, 155.31637321302117, 227.74925850653386, 269.6086582622301, 201.73120914460674, 140.6023357485401, 25.630521212253203, 31.56213873412637, 163.6986757417014, 174.71468837622987, 154.2846331467765, 299.0838803121177, 77.7093944743593, 132.3014848901381, 42.194269195821356, 101.8277183859012, 96.88667827557731, 75.12522374284265, 93.581892884335, 24.29105098980851, 138.02990665287788, 9.679230264228536, 146.99958532468483, 67.7241238426325, 250.12700702322383, 58.467716889109454, 199.72283270720914, 319.18653851132933, 112.37528037299221, 206.23371706230628, 24.79829788821571, 162.20773466258544, 70.69066251986472, 2.346348370434561, 78.64743217591419, 42.14980979067807, 67.45243125375768, 220.37926892917832, 94.71767004258568, 377.66724123975894, 28.34190927060452, 29.03476674093636, 109.20706074949497, 148.19071108771573, 227.8409698846773, 261.4585397224873, 139.97160695528953, 10.061540876264194, 83.6577318982959, 103.21312163841698, 81.98040959340908, 83.49621680580029, 146.08212269560073, 0.0, 146.45655327333878, 260.8500102782249, 110.03075955599536, 14.678096080052438, 56.32809341046699, 108.71434785702027, 169.2350473335408, 135.61876848733385, 135.60853326899021, 241.73690519812448, 14.564310019912229, 107.77897640319323, 177.0108971322925, 0.0, 117.43362820964178, 18.77102765979661, 89.6691534145433, 55.16891939706202, 133.33613546282888, 230.3734572383554, 248.19015286837694, 93.82868446036076, 12.306555941377669, 21.902425600302713, 39.234066600953454, 58.14494137686878, 40.43772495538375, 196.30136542419143, 196.36369461283, 69.19202956316956, 289.9593209899301, 85.85680442609524, 217.11898175318188, 104.09134764989594, 94.67176115416093, 188.17900038402215, 76.50704474417341, 66.18344518005591, 41.008253062803966, 125.40543199303238, 124.40919303107475, 248.7157488523845, 113.2820512234682, 24.136806064095417, 229.63539423773224, 21.306907643137524, 104.60358794555735, 127.372149996955, 27.742956592432066, 303.49697143593283, 38.54015065755719, 81.17212726842872, 47.63662235299036, 58.8300992421015, 45.297487769449944, 162.5342653806603, 20.906342628183182, 27.508860118003533, 110.19350010358959, 137.65997763321994, 67.46979436900163, 67.90296217338336, 96.00047500506085, 25.941542447345675, 112.83659736275315, 160.4301440244373, 133.7178869946935, 90.27777571726553, 23.226923356538535, 123.30716584423483, 0.0, 186.17227725000865, 169.7202715968422, 4.9509421510009695, 160.60469390765155, 13.584128276373145, 49.187248186337825, 123.72705033180486, 5.724270570746379, 18.34950450345222, 63.625592294771266, 201.34960669100576, 228.76690849555735, 121.72712349354843, 14.191288042502718, 295.28880371488367, 8.26842671708724, 154.70836851688907, 53.743280593750896, 317.6155627769416, 153.97887780526173, 193.48995779906696, 172.2897209804119, 108.94819698361229, 176.4131672950285, 52.411343137385416, 9.630697271896954, 0.9289036078076964, 61.651614415769565, 11.59355815572076, 28.004631013114746, 455.7630217558212, 8.0157433947883, 62.47688818522676, 1.7932033750937775, 170.8642257474918]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.772571969302423, "mean_inference_ms": 4.630460459850194, "mean_action_processing_ms": 2.0503115273848596, "mean_env_wait_ms": 1.500216733298477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010062694549560547, "StateBufferConnector_ms": 0.021904587745666504, "ViewRequirementAgentConnector_ms": 0.1414470672607422}, "num_episodes": 72, "episode_return_max": 288.92913646224224, "episode_return_min": -124.10637563417316, "episode_return_mean": 86.80506685007654, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 237.2533338458177, "num_env_steps_trained_throughput_per_sec": 237.2533338458177, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 33426.55, "restore_workers_time_ms": 0.041, "training_step_time_ms": 33425.527, "sample_time_ms": 1648.707, "learn_time_ms": 31739.302, "learn_throughput": 252.053, "synch_weights_time_ms": 27.404}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 4, "trial_id": "cd905_00000", "date": "2024-08-20_09-26-14", "timestamp": 1724126174, "time_this_iter_s": 33.7695369720459, "time_total_s": 133.87758708000183, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f7e3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 133.87758708000183, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 41.3125, "ram_util_percent": 81.84791666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5333157881739594, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 0.0001, "total_loss": 5.492873400733584, "policy_loss": -0.0034181465875239127, "vf_loss": 5.496113184520176, "vf_explained_var": 0.006279127843796261, "kl": 0.014268235850523336, "entropy": 1.5612592241120717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4839691221240967, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 0.0001, "total_loss": 3.0871806784281657, "policy_loss": -0.0028061869140300487, "vf_loss": 3.0898868034756375, "vf_explained_var": 2.4652670300196088e-06, "kl": 0.004002580132730925, "entropy": 1.567829848849584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 288.92913646224224, "episode_reward_min": -124.10637563417316, "episode_reward_mean": 86.80506685007654, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -374.5672412397589, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.41230328644872, "predator_policy": 455.7630217558212}, "policy_reward_mean": {"prey_policy": -73.74685801982605, "predator_policy": 117.14939144486429}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.500000000000096, 77.49999999999997, 137.69999999999914, 33.40000000000021, 112.83305875575275, 14.853893135031248, 52.50000000000023, 110.09999999999955, 95.41348120209275, -0.8200752752070243, -0.10257593431517087, 92.28415769390425, 52.80204824828002, 207.08067980748027, 104.90176543552435, 67.99999999999987, 17.999999999999993, 87.2999999999991, 44.100000000000215, 129.2999999999996, 86.10000000000024, 34.03639519013095, 75.69999999999959, 235.3999999999995, 146.63722873703796, 120.09999999999994, 110.15983555924313, 53.65791123857705, 114.09621087859101, 63.31072633477795, 234.9540263176631, 113.20000000000002, 110.91318595522348, 28.500000000000057, 84.52647129833852, 196.0999999999995, 146.29999999999959, 155.3999999999995, 40.927130611680724, 55.900000000000134, 219.69999999999916, 38.045252066153004, 22.746941969306278, 50.391281596323616, 96.87467021170656, 55.200000000000294, 29.13714613745018, 43.80000000000012, 138.19999999999965, 45.30000000000025, 59.536461044703216, 42.600000000000186, 53.700000000000166, 48.02425055440496, 89.44841545618408, 86.30892994651286, 72.39760037057295, 78.09999999999937, 288.92913646224224, 182.30196377644808, 162.8130957629252, 156.48644100001016, 127.69999999999959, 49.90145232140156, 153.92744961973082, 75.23213055128052, 132.2811925962208, 49.69069468061068, 28.200667724308072, 117.19999999999987, 70.79999999999974, 107.00000000000003, 86.09999999999971, 102.10000000000021, 41.900000000000276, 236.29759415855324, 25.064806914511866, 157.99999999999918, 73.00000000000014, 36.10000000000009, 63.62285222836394, 138.39244335951764, 77.99999999999986, 34.200000000000124, 59.00000000000011, 76.43197080683858, 51.800000000000445, 54.241286956416, 42.10000000000013, 103.28853246855994, 124.37369126578969, 140.29999999999967, -11.407875866112455, 123.02226742260966, 59.544761888483215, 97.39999999999921, 70.50000000000026, -124.10637563417316, 53.60000000000027, 47.100000000000186], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-117.4491906542828, -168.36186688066465, -319.59572598337405, -186.25312547747095, 52.51785297640658, 81.1757622939015, -41.225071636431885, -13.899985028429892, -334.1500020463539, -156.89546531535967, -269.5828030279167, -199.35290151370535, -53.5179387318049, 14.381004175241841, 42.475495104498336, -36.129639647497314, -30.989603318821946, -33.556264000533986, -138.787019469115, -180.88055019022792, -129.03103334662404, -184.28662275079796, -68.52256259153366, -11.97124104963675, -156.4997260172407, 20.22837250797317, 136.71520032220093, -24.61681105203188, -50.67047098400403, -260.5786897136976, -49.72417471985246, -137.1068181304719, -106.98322515874463, -314.1500156046692, 47.804401651511874, -266.5859541900282, -220.05018082935396, -7.376865855743047, -35.3146440459439, 30.977729544170607, -33.57363791016852, -131.11637321302146, -197.32672775246235, -265.99479382616937, -167.00364892683976, -99.6298959663075, 130.2694787877467, 47.93786126587373, -41.18997681077637, -150.58615857011648, -42.984633146776595, -290.2838803121177, -77.58861260248669, -22.262431202766784, -94.40612664890386, 4.042050305757655, -13.756894284094663, -44.15879685573444, 2.9840337460608084, -57.546251285427, -71.26678926070826, 158.51167866126494, -89.52901115440147, -11.994698012916174, -196.3454671202625, -1.3360708368475365, -178.7460453506432, -311.6633258678961, -48.0339059061539, -186.0486202308065, 148.60170211178425, -139.50773466258602, 55.80933748013535, 17.45365162956542, -64.74743217591451, 99.3501902093218, -136.07329122646945, -110.8312783447864, -41.91767004258553, -374.5672412397589, 117.95809072939531, 44.36523325906381, -82.82057111222856, -136.53194865883057, -215.79402791537163, -250.75853972248765, -71.0758136611596, -28.5660525740712, 0.5386185752432355, -90.53480190024985, -62.38040959340979, -47.896216805800194, -76.48883232973812, -40.456144228413095, -107.95655327333884, -255.55001027822502, -95.83075955599593, 109.32190391994756, -39.22809341046681, -80.51434785702058, -142.03504733354143, -103.28230744263084, -99.50853326899052, -235.23690519812484, 5.035689980087747, -73.67897640319391, -13.30040374398629, -115.68624283390233, -57.0626875120347, 10.30644709877976, -30.069153414543166, -28.459989450548946, -70.75901175548083, -220.55298057513124, -237.74313604946377, -26.17570127927456, 83.3078516341123, 171.41230328644872, 99.14027015885328, -14.217314360226762, 62.04181601322718, -135.96781062987725, -138.48747958744184, 29.41819641145255, -280.5593209899287, 32.4431955739048, -109.60412115860875, -161.70475592306815, -42.14952880797598, -86.77378311047565, -36.12156380800714, -31.336795564941603, -50.8264246519387, 16.693932192324105, -82.42278608312193, -241.01146111972784, -42.92491731829379, -66.29327224496194, -220.63539423773273, 86.89309235686247, -48.833207832604174, -112.34253010990905, 66.35704340756791, -290.59697143593274, 15.959849342442794, -49.57212726842854, 0.8488332627143098, -5.2155548578059765, -133.19525353126159, -32.73649961884832, 98.4818944146887, 89.400496997678, -78.16063621423503, -144.628034608063, -29.96979436900145, 52.59703782661663, -45.30047500506129, -3.6415424473456337, -88.93659736275394, -148.23014402443735, -180.22551283448453, 19.852702350889054, -47.94164584125528, 39.800000000000196, 22.70000000000001, -130.87227725000895, -156.02027159684246, 15.549057848998991, -128.15763540860354, 12.968813224578707, -115.78799638232277, 19.305668671018495, 13.675729429253591, 14.050495496547747, -40.88430533835528, -169.84960669100613, -202.46690849555748, -105.92712349354883, -111.50575691798481, -94.68580237084183, -85.15520355138528, 46.5520995831993, 78.75671940624915, -309.8155627769405, -201.254319087989, -157.62239238245198, -2.8044694468468645, -155.4111810945674, -118.85363264593377, -50.42611589799786, 18.369302728103023, 68.4710963921922, -21.151614415769387, 18.406441844279243, -239.82852288435123, -368.0455055187578, -36.892631580014964, 20.000000000000014, 20.900000000000027, -146.45742912258572], "policy_predator_policy_reward": [131.349190654282, 179.96186688066402, 332.59572598337536, 250.75312547747086, 3.182147023593455, 0.8242377060979771, 28.698885317023205, 59.82617134783878, 257.18270006156115, 346.69582605590625, 269.2216349400608, 214.5679627365926, 86.41793873180478, 5.218995824758123, 29.623030534718257, 74.13111400828096, 44.14831421661337, 115.81103430483618, 234.1111984548819, 84.73629592925283, 25.304485696961468, 287.9105944661443, 133.74709389754767, 39.03086743752706, 51.50388364309443, 137.56951811445288, 43.29474979892683, 51.68754073838494, 193.27270901024787, 222.87821712298089, 73.5241747198524, 181.3068181304719, 118.6832251587445, 320.45001560466915, 32.095598348488295, 273.98595419002794, 246.3501808293537, 25.176865855743102, 91.61464404594389, 42.022270455829506, 95.47363791016845, 155.31637321302117, 227.74925850653386, 269.6086582622301, 201.73120914460674, 140.6023357485401, 25.630521212253203, 31.56213873412637, 163.6986757417014, 174.71468837622987, 154.2846331467765, 299.0838803121177, 77.7093944743593, 132.3014848901381, 42.194269195821356, 101.8277183859012, 96.88667827557731, 75.12522374284265, 93.581892884335, 24.29105098980851, 138.02990665287788, 9.679230264228536, 146.99958532468483, 67.7241238426325, 250.12700702322383, 58.467716889109454, 199.72283270720914, 319.18653851132933, 112.37528037299221, 206.23371706230628, 24.79829788821571, 162.20773466258544, 70.69066251986472, 2.346348370434561, 78.64743217591419, 42.14980979067807, 67.45243125375768, 220.37926892917832, 94.71767004258568, 377.66724123975894, 28.34190927060452, 29.03476674093636, 109.20706074949497, 148.19071108771573, 227.8409698846773, 261.4585397224873, 139.97160695528953, 10.061540876264194, 83.6577318982959, 103.21312163841698, 81.98040959340908, 83.49621680580029, 146.08212269560073, 0.0, 146.45655327333878, 260.8500102782249, 110.03075955599536, 14.678096080052438, 56.32809341046699, 108.71434785702027, 169.2350473335408, 135.61876848733385, 135.60853326899021, 241.73690519812448, 14.564310019912229, 107.77897640319323, 177.0108971322925, 0.0, 117.43362820964178, 18.77102765979661, 89.6691534145433, 55.16891939706202, 133.33613546282888, 230.3734572383554, 248.19015286837694, 93.82868446036076, 12.306555941377669, 21.902425600302713, 39.234066600953454, 58.14494137686878, 40.43772495538375, 196.30136542419143, 196.36369461283, 69.19202956316956, 289.9593209899301, 85.85680442609524, 217.11898175318188, 104.09134764989594, 94.67176115416093, 188.17900038402215, 76.50704474417341, 66.18344518005591, 41.008253062803966, 125.40543199303238, 124.40919303107475, 248.7157488523845, 113.2820512234682, 24.136806064095417, 229.63539423773224, 21.306907643137524, 104.60358794555735, 127.372149996955, 27.742956592432066, 303.49697143593283, 38.54015065755719, 81.17212726842872, 47.63662235299036, 58.8300992421015, 45.297487769449944, 162.5342653806603, 20.906342628183182, 27.508860118003533, 110.19350010358959, 137.65997763321994, 67.46979436900163, 67.90296217338336, 96.00047500506085, 25.941542447345675, 112.83659736275315, 160.4301440244373, 133.7178869946935, 90.27777571726553, 23.226923356538535, 123.30716584423483, 0.0, 186.17227725000865, 169.7202715968422, 4.9509421510009695, 160.60469390765155, 13.584128276373145, 49.187248186337825, 123.72705033180486, 5.724270570746379, 18.34950450345222, 63.625592294771266, 201.34960669100576, 228.76690849555735, 121.72712349354843, 14.191288042502718, 295.28880371488367, 8.26842671708724, 154.70836851688907, 53.743280593750896, 317.6155627769416, 153.97887780526173, 193.48995779906696, 172.2897209804119, 108.94819698361229, 176.4131672950285, 52.411343137385416, 9.630697271896954, 0.9289036078076964, 61.651614415769565, 11.59355815572076, 28.004631013114746, 455.7630217558212, 8.0157433947883, 62.47688818522676, 1.7932033750937775, 170.8642257474918]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.772571969302423, "mean_inference_ms": 4.630460459850194, "mean_action_processing_ms": 2.0503115273848596, "mean_env_wait_ms": 1.500216733298477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010062694549560547, "StateBufferConnector_ms": 0.021904587745666504, "ViewRequirementAgentConnector_ms": 0.1414470672607422}, "num_episodes": 0, "episode_return_max": 288.92913646224224, "episode_return_min": -124.10637563417316, "episode_return_mean": 86.80506685007654, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 240.02952481089602, "num_env_steps_trained_throughput_per_sec": 240.02952481089602, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 33407.156, "restore_workers_time_ms": 0.037, "training_step_time_ms": 33406.137, "sample_time_ms": 1629.877, "learn_time_ms": 31740.841, "learn_throughput": 252.041, "synch_weights_time_ms": 26.78}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 5, "trial_id": "cd905_00000", "date": "2024-08-20_09-26-48", "timestamp": 1724126208, "time_this_iter_s": 33.37542510032654, "time_total_s": 167.25301218032837, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f0de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 167.25301218032837, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 38.56595744680851, "ram_util_percent": 82.38510638297873}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7552665638308675, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 0.0001, "total_loss": 4.580576662790207, "policy_loss": -0.005240094240769625, "vf_loss": 4.585584264331394, "vf_explained_var": 0.0016439126597510444, "kl": 0.01860123752099493, "entropy": 1.4776173811110238, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 3465.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.48267735540275536, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 0.0001, "total_loss": 3.8338491292226884, "policy_loss": -0.001858890547032749, "vf_loss": 3.835656539977543, "vf_explained_var": -0.0006132895984346904, "kl": 0.0041189735007849644, "entropy": 1.5478169361750285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 3465.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 245.99999999999957, "episode_reward_min": -124.10637563417316, "episode_reward_mean": 71.9390658233836, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -552.8938293249705, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 109.42231784074795, "predator_policy": 553.8938293249704}, "policy_reward_mean": {"prey_policy": -59.56093731794812, "predator_policy": 95.53047022963987}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.09999999999971, 102.10000000000021, 41.900000000000276, 236.29759415855324, 25.064806914511866, 157.99999999999918, 73.00000000000014, 36.10000000000009, 63.62285222836394, 138.39244335951764, 77.99999999999986, 34.200000000000124, 59.00000000000011, 76.43197080683858, 51.800000000000445, 54.241286956416, 42.10000000000013, 103.28853246855994, 124.37369126578969, 140.29999999999967, -11.407875866112455, 123.02226742260966, 59.544761888483215, 97.39999999999921, 70.50000000000026, -124.10637563417316, 53.60000000000027, 47.100000000000186, 103.19999999999851, 7.2973131295969615, 74.39999999999972, 54.700000000000195, 32.40000000000019, 69.74250397008777, 54.70000000000024, 37.2000000000001, 71.69999999999983, 245.99999999999957, 62.341214838972746, 7.382258507989315, 72.49999999999984, 29.700000000000156, 106.46647889304265, 77.40000000000006, 27.200000000000117, 95.29999999999863, 117.63924946002896, 121.81138950316253, 123.29999999999919, 44.90000000000015, 34.10000000000024, 48.00000000000032, 31.44170914251813, 105.79999999999944, 119.59999999999928, 11.255542456441363, 109.99999999999886, 55.10000000000034, 33.70000000000019, 77.49999999999946, 29.62144434872582, 49.07332761603657, 15.190264770079107, 28.48019685624142, 99.54222732637857, 117.5999999999994, 35.90000000000024, 11.194479711328626, 75.79999999999954, -62.333511155687994, 96.37309823399563, 31.300000000000175, 57.10000000000039, 109.59999999999889, 73.00000000000009, 78.90000000000009, 128.79999999999944, 124.99999999999946, 110.1999999999997, 149.57886005353225, 103.58296835134948, 52.20000000000022, 0.670054972648655, 66.11162286002704, 44.53613360428936, 92.39999999999864, 112.99999999999943, 47.700000000000124, 118.81224552488749, 44.27781630609333, 62.500000000000206, 112.49999999999876, 85.99999999999959, 123.72398294203873, 76.89999999999941, 89.29375072958443, 133.69999999999973, 20.324656967599704, 63.50000000000032, 78.50934644802518], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.959849342442794, -49.57212726842854, 0.8488332627143098, -5.2155548578059765, -133.19525353126159, -32.73649961884832, 98.4818944146887, 89.400496997678, -78.16063621423503, -144.628034608063, -29.96979436900145, 52.59703782661663, -45.30047500506129, -3.6415424473456337, -88.93659736275394, -148.23014402443735, -180.22551283448453, 19.852702350889054, -47.94164584125528, 39.800000000000196, 22.70000000000001, -130.87227725000895, -156.02027159684246, 15.549057848998991, -128.15763540860354, 12.968813224578707, -115.78799638232277, 19.305668671018495, 13.675729429253591, 14.050495496547747, -40.88430533835528, -169.84960669100613, -202.46690849555748, -105.92712349354883, -111.50575691798481, -94.68580237084183, -85.15520355138528, 46.5520995831993, 78.75671940624915, -309.8155627769405, -201.254319087989, -157.62239238245198, -2.8044694468468645, -155.4111810945674, -118.85363264593377, -50.42611589799786, 18.369302728103023, 68.4710963921922, -21.151614415769387, 18.406441844279243, -239.82852288435123, -368.0455055187578, -36.892631580014964, 20.000000000000014, 20.900000000000027, -146.45742912258572, 45.20301594226224, 15.847947610953629, -80.79549552200385, -166.40713699256264, -42.813031881836594, 50.689633270925356, -16.57631680774066, -28.579991148501882, -74.55502379125146, -10.48721758493852, -118.214451210748, -63.99200919286918, -393.86985725208393, 21.815895579403332, -23.978553415269417, -227.90181731133617, -1.4987885460767645, -41.40772841391783, 109.42231784074795, -52.44815474789178, -71.83704699262418, 22.33792989069888, -73.63222270039837, -95.68336751702459, 18.70017562286639, 43.55491781391524, -71.4431601529895, -70.8892106264694, 10.38515798157508, -165.3157371213662, 5.121485329346079, -36.57049101103814, -136.9513816778562, -0.9774104380355096, 77.61436768108423, -83.11677741057294, 54.66947106974097, 4.6299568861495, -9.49446130833454, -37.70041052027303, 37.5504090549518, 7.461475651427266, -135.46063028250808, 9.067474801521255, 1.7653694371720448, -211.94338073349584, -121.73089020138208, -86.63138164570306, -34.60009067522352, -51.159257430437215, 50.41463496668036, 23.400653381196253, 90.78665559374187, -85.65675950935555, -148.7162545412358, -200.67622979920571, 19.156294206504338, 28.54938596115413, -75.82965930851691, 1.2845339302256777, -101.06691373491775, -40.412816753510164, 14.993156324041651, -86.30805029742763, -272.4599726459327, -16.429673158011788, -44.008071548921116, -49.439915327569594, -127.81014309691437, -312.47775398833966, -11.258218747761347, -4.44138739300999, 13.89864956924758, -119.00469372661254, 65.58430168155886, 26.013392829820354, -53.67314317578129, 6.398075961889166, -390.33093363128376, -94.44816536996836, -92.46219967366642, -16.90721303413324, -232.52081679189138, -167.83102815358154, -97.74820956390025, -182.68431262324958, 5.459258319318481, -152.7075077292103, 13.406573822437974, -66.37390626338295, -38.168595814454456, 72.91296100702863, -21.700309002135764, -31.587285392359142, 40.19286746547607, -11.668744373751942, 54.00209517214957, -159.78003013775833, -53.324932901448484, 55.69640545210843, -552.8938293249705, 3.0178442381207584, -51.29567789877321, 45.175429991950004, 80.70168370408331, -2.845043992327641, -8.036135306395742, -71.03614237804244, -146.24847016629076, -253.60466632749043, -98.87425630329389, -45.312400805149316, -144.67849631174278, -114.25117106145328, 4.324864082220925, 55.47361125831958, -63.53229270286379, 5.738567868231039, -83.53715452261314, -117.39565578288003, 13.297914366534721, -24.109914828509993, -95.37971314102244, -118.0518702750358, -197.7591807903285, 11.175747251909085, 83.43382425981657, 6.499339943885323, -39.93111100626256, -119.22968463963917, 1.9940190651602898, -64.82276542357754, 33.19847517316487, -49.11402245882186, -239.9378408358996, -56.3257001588168, -50.600997806814505, -81.98037125694285, -191.77046877033123, -113.95878251379263, -163.98076862529135, 35.42062423326362, -250.36498216257084, 50.79383443049716], "policy_predator_policy_reward": [38.54015065755719, 81.17212726842872, 47.63662235299036, 58.8300992421015, 45.297487769449944, 162.5342653806603, 20.906342628183182, 27.508860118003533, 110.19350010358959, 137.65997763321994, 67.46979436900163, 67.90296217338336, 96.00047500506085, 25.941542447345675, 112.83659736275315, 160.4301440244373, 133.7178869946935, 90.27777571726553, 23.226923356538535, 123.30716584423483, 0.0, 186.17227725000865, 169.7202715968422, 4.9509421510009695, 160.60469390765155, 13.584128276373145, 49.187248186337825, 123.72705033180486, 5.724270570746379, 18.34950450345222, 63.625592294771266, 201.34960669100576, 228.76690849555735, 121.72712349354843, 14.191288042502718, 295.28880371488367, 8.26842671708724, 154.70836851688907, 53.743280593750896, 317.6155627769416, 153.97887780526173, 193.48995779906696, 172.2897209804119, 108.94819698361229, 176.4131672950285, 52.411343137385416, 9.630697271896954, 0.9289036078076964, 61.651614415769565, 11.59355815572076, 28.004631013114746, 455.7630217558212, 8.0157433947883, 62.47688818522676, 1.7932033750937775, 170.8642257474918, 9.796984057737957, 32.35205238904634, 111.2022620360102, 143.29768360815257, 60.86963864423932, 5.653759966672375, 53.276316807740855, 46.57999114850214, 89.65502379125071, 27.787217584938585, 72.01494689688977, 179.9340174768144, 407.51594795664624, 19.238013716034754, 56.198484603881774, 232.88188612272347, 56.298788546076736, 58.30772841391807, 11.977682159251783, 177.0481547478917, 105.29615041392466, 6.544181526972715, 6.925188306525897, 169.7726604188849, 1.1998243771336112, 9.045082186084963, 85.44316015298882, 86.58921062646851, 55.16698735517672, 206.23007067765735, 73.83475399475826, 35.01425168693387, 146.151381677856, 18.977410438035463, 82.98089398606174, 17.82151574342562, 20.298838432021434, 38.040983072117875, 121.58894471606878, 47.41731661570255, 36.971400027980195, 41.31671526564088, 147.86063028250769, 23.432525198478775, 24.03463056282798, 220.24338073349554, 137.23089020138187, 119.13138164570229, 50.041799817741705, 67.15925743043724, 9.787183816553794, 22.197527835569694, 15.713344406257749, 98.7567595093555, 79.85226884813254, 280.7957579487491, 61.043705793495675, 1.2506140388458638, 107.4296593085165, 22.21546606977429, 117.76691373491747, 57.412816753510405, 4.606843675958314, 144.20805029742723, 102.53975288265362, 215.971337270017, 107.91970803757724, 34.60160645495008, 321.44146631682963, 134.03669553850276, 35.21137978770272, 8.968423209310144, 112.72418430685299, 91.92408717689113, 24.11569831844116, 1.886607170179774, 70.47314317578108, 12.7019240381108, 33.78380536253425, 462.1897733500456, 140.25137313162816, 44.918039576170855, 60.62178758454674, 277.3965462052373, 285.88923689428015, 90.91638352686518, 13.440741680681485, 165.1075077292096, 97.13254575875325, 12.934786682191833, 61.86859581445459, 12.98703899297089, 117.37446004603994, 8.913134348455168, 4.707132534523933, 45.66874437375209, 42.097904827850556, 192.48003013775826, 83.22493290144843, 39.40359454789165, 553.8938293249704, 106.18215576187924, 58.028748646208854, 97.67035931414767, 2.9976408201782423, 22.72868781941576, 32.86727395640808, 98.40500372802983, 332.70644128244044, 67.81675018398889, 74.28202287881498, 136.0162570896544, 21.479752533330654, 281.9860484441533, 20.986281127244652, 11.615243532214981, 79.63229270286296, 91.16143213176895, 173.72479395420115, 74.90801635129063, 46.99170838263655, 82.63253760422754, 214.89037169524582, 42.81902802690592, 231.35918079032828, 17.724252748090894, 2.2622174276414864, 20.304618368656044, 110.03111100626266, 135.12968463963827, 6.210053977659762, 180.342675322796, 28.301524826835287, 64.51402245882188, 314.8212899378799, 70.73600178642137, 69.88876438368892, 196.39260468006754, 200.57046877033073, 125.48343948139161, 175.58076862529074, 16.479375766736567, 268.751515985098, 9.328978195000872]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.652506652129651, "mean_inference_ms": 4.502512354005188, "mean_action_processing_ms": 1.9463840380542299, "mean_env_wait_ms": 1.413554966239066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004192471504211426, "StateBufferConnector_ms": 0.03173935413360596, "ViewRequirementAgentConnector_ms": 0.1591721773147583}, "num_episodes": 72, "episode_return_max": 245.99999999999957, "episode_return_min": -124.10637563417316, "episode_return_mean": 71.9390658233836, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 238.11067142739952, "num_env_steps_trained_throughput_per_sec": 238.11067142739952, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 33438.941, "restore_workers_time_ms": 0.035, "training_step_time_ms": 33438.024, "sample_time_ms": 1598.073, "learn_time_ms": 31805.601, "learn_throughput": 251.528, "synch_weights_time_ms": 26.46}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 6, "trial_id": "cd905_00000", "date": "2024-08-20_09-27-21", "timestamp": 1724126241, "time_this_iter_s": 33.64994931221008, "time_total_s": 200.90296149253845, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f70f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 200.90296149253845, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 41.77708333333333, "ram_util_percent": 82.15833333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.017302217192593, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 0.0001, "total_loss": 3.293134925478981, "policy_loss": -0.0007063166234671833, "vf_loss": 3.293792514195518, "vf_explained_var": -0.0015074078998868427, "kl": 0.0038976004959699316, "entropy": 1.4286956804139272, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 4095.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3883498083740946, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 0.0001, "total_loss": 2.0918584974985275, "policy_loss": -0.0026190294706750486, "vf_loss": 2.094447341797844, "vf_explained_var": -0.0006386654717581612, "kl": 0.004829661305562977, "entropy": 1.511687813675593, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 4095.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 245.99999999999957, "episode_reward_min": -124.10637563417316, "episode_reward_mean": 71.9390658233836, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -552.8938293249705, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 109.42231784074795, "predator_policy": 553.8938293249704}, "policy_reward_mean": {"prey_policy": -59.56093731794812, "predator_policy": 95.53047022963987}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.09999999999971, 102.10000000000021, 41.900000000000276, 236.29759415855324, 25.064806914511866, 157.99999999999918, 73.00000000000014, 36.10000000000009, 63.62285222836394, 138.39244335951764, 77.99999999999986, 34.200000000000124, 59.00000000000011, 76.43197080683858, 51.800000000000445, 54.241286956416, 42.10000000000013, 103.28853246855994, 124.37369126578969, 140.29999999999967, -11.407875866112455, 123.02226742260966, 59.544761888483215, 97.39999999999921, 70.50000000000026, -124.10637563417316, 53.60000000000027, 47.100000000000186, 103.19999999999851, 7.2973131295969615, 74.39999999999972, 54.700000000000195, 32.40000000000019, 69.74250397008777, 54.70000000000024, 37.2000000000001, 71.69999999999983, 245.99999999999957, 62.341214838972746, 7.382258507989315, 72.49999999999984, 29.700000000000156, 106.46647889304265, 77.40000000000006, 27.200000000000117, 95.29999999999863, 117.63924946002896, 121.81138950316253, 123.29999999999919, 44.90000000000015, 34.10000000000024, 48.00000000000032, 31.44170914251813, 105.79999999999944, 119.59999999999928, 11.255542456441363, 109.99999999999886, 55.10000000000034, 33.70000000000019, 77.49999999999946, 29.62144434872582, 49.07332761603657, 15.190264770079107, 28.48019685624142, 99.54222732637857, 117.5999999999994, 35.90000000000024, 11.194479711328626, 75.79999999999954, -62.333511155687994, 96.37309823399563, 31.300000000000175, 57.10000000000039, 109.59999999999889, 73.00000000000009, 78.90000000000009, 128.79999999999944, 124.99999999999946, 110.1999999999997, 149.57886005353225, 103.58296835134948, 52.20000000000022, 0.670054972648655, 66.11162286002704, 44.53613360428936, 92.39999999999864, 112.99999999999943, 47.700000000000124, 118.81224552488749, 44.27781630609333, 62.500000000000206, 112.49999999999876, 85.99999999999959, 123.72398294203873, 76.89999999999941, 89.29375072958443, 133.69999999999973, 20.324656967599704, 63.50000000000032, 78.50934644802518], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.959849342442794, -49.57212726842854, 0.8488332627143098, -5.2155548578059765, -133.19525353126159, -32.73649961884832, 98.4818944146887, 89.400496997678, -78.16063621423503, -144.628034608063, -29.96979436900145, 52.59703782661663, -45.30047500506129, -3.6415424473456337, -88.93659736275394, -148.23014402443735, -180.22551283448453, 19.852702350889054, -47.94164584125528, 39.800000000000196, 22.70000000000001, -130.87227725000895, -156.02027159684246, 15.549057848998991, -128.15763540860354, 12.968813224578707, -115.78799638232277, 19.305668671018495, 13.675729429253591, 14.050495496547747, -40.88430533835528, -169.84960669100613, -202.46690849555748, -105.92712349354883, -111.50575691798481, -94.68580237084183, -85.15520355138528, 46.5520995831993, 78.75671940624915, -309.8155627769405, -201.254319087989, -157.62239238245198, -2.8044694468468645, -155.4111810945674, -118.85363264593377, -50.42611589799786, 18.369302728103023, 68.4710963921922, -21.151614415769387, 18.406441844279243, -239.82852288435123, -368.0455055187578, -36.892631580014964, 20.000000000000014, 20.900000000000027, -146.45742912258572, 45.20301594226224, 15.847947610953629, -80.79549552200385, -166.40713699256264, -42.813031881836594, 50.689633270925356, -16.57631680774066, -28.579991148501882, -74.55502379125146, -10.48721758493852, -118.214451210748, -63.99200919286918, -393.86985725208393, 21.815895579403332, -23.978553415269417, -227.90181731133617, -1.4987885460767645, -41.40772841391783, 109.42231784074795, -52.44815474789178, -71.83704699262418, 22.33792989069888, -73.63222270039837, -95.68336751702459, 18.70017562286639, 43.55491781391524, -71.4431601529895, -70.8892106264694, 10.38515798157508, -165.3157371213662, 5.121485329346079, -36.57049101103814, -136.9513816778562, -0.9774104380355096, 77.61436768108423, -83.11677741057294, 54.66947106974097, 4.6299568861495, -9.49446130833454, -37.70041052027303, 37.5504090549518, 7.461475651427266, -135.46063028250808, 9.067474801521255, 1.7653694371720448, -211.94338073349584, -121.73089020138208, -86.63138164570306, -34.60009067522352, -51.159257430437215, 50.41463496668036, 23.400653381196253, 90.78665559374187, -85.65675950935555, -148.7162545412358, -200.67622979920571, 19.156294206504338, 28.54938596115413, -75.82965930851691, 1.2845339302256777, -101.06691373491775, -40.412816753510164, 14.993156324041651, -86.30805029742763, -272.4599726459327, -16.429673158011788, -44.008071548921116, -49.439915327569594, -127.81014309691437, -312.47775398833966, -11.258218747761347, -4.44138739300999, 13.89864956924758, -119.00469372661254, 65.58430168155886, 26.013392829820354, -53.67314317578129, 6.398075961889166, -390.33093363128376, -94.44816536996836, -92.46219967366642, -16.90721303413324, -232.52081679189138, -167.83102815358154, -97.74820956390025, -182.68431262324958, 5.459258319318481, -152.7075077292103, 13.406573822437974, -66.37390626338295, -38.168595814454456, 72.91296100702863, -21.700309002135764, -31.587285392359142, 40.19286746547607, -11.668744373751942, 54.00209517214957, -159.78003013775833, -53.324932901448484, 55.69640545210843, -552.8938293249705, 3.0178442381207584, -51.29567789877321, 45.175429991950004, 80.70168370408331, -2.845043992327641, -8.036135306395742, -71.03614237804244, -146.24847016629076, -253.60466632749043, -98.87425630329389, -45.312400805149316, -144.67849631174278, -114.25117106145328, 4.324864082220925, 55.47361125831958, -63.53229270286379, 5.738567868231039, -83.53715452261314, -117.39565578288003, 13.297914366534721, -24.109914828509993, -95.37971314102244, -118.0518702750358, -197.7591807903285, 11.175747251909085, 83.43382425981657, 6.499339943885323, -39.93111100626256, -119.22968463963917, 1.9940190651602898, -64.82276542357754, 33.19847517316487, -49.11402245882186, -239.9378408358996, -56.3257001588168, -50.600997806814505, -81.98037125694285, -191.77046877033123, -113.95878251379263, -163.98076862529135, 35.42062423326362, -250.36498216257084, 50.79383443049716], "policy_predator_policy_reward": [38.54015065755719, 81.17212726842872, 47.63662235299036, 58.8300992421015, 45.297487769449944, 162.5342653806603, 20.906342628183182, 27.508860118003533, 110.19350010358959, 137.65997763321994, 67.46979436900163, 67.90296217338336, 96.00047500506085, 25.941542447345675, 112.83659736275315, 160.4301440244373, 133.7178869946935, 90.27777571726553, 23.226923356538535, 123.30716584423483, 0.0, 186.17227725000865, 169.7202715968422, 4.9509421510009695, 160.60469390765155, 13.584128276373145, 49.187248186337825, 123.72705033180486, 5.724270570746379, 18.34950450345222, 63.625592294771266, 201.34960669100576, 228.76690849555735, 121.72712349354843, 14.191288042502718, 295.28880371488367, 8.26842671708724, 154.70836851688907, 53.743280593750896, 317.6155627769416, 153.97887780526173, 193.48995779906696, 172.2897209804119, 108.94819698361229, 176.4131672950285, 52.411343137385416, 9.630697271896954, 0.9289036078076964, 61.651614415769565, 11.59355815572076, 28.004631013114746, 455.7630217558212, 8.0157433947883, 62.47688818522676, 1.7932033750937775, 170.8642257474918, 9.796984057737957, 32.35205238904634, 111.2022620360102, 143.29768360815257, 60.86963864423932, 5.653759966672375, 53.276316807740855, 46.57999114850214, 89.65502379125071, 27.787217584938585, 72.01494689688977, 179.9340174768144, 407.51594795664624, 19.238013716034754, 56.198484603881774, 232.88188612272347, 56.298788546076736, 58.30772841391807, 11.977682159251783, 177.0481547478917, 105.29615041392466, 6.544181526972715, 6.925188306525897, 169.7726604188849, 1.1998243771336112, 9.045082186084963, 85.44316015298882, 86.58921062646851, 55.16698735517672, 206.23007067765735, 73.83475399475826, 35.01425168693387, 146.151381677856, 18.977410438035463, 82.98089398606174, 17.82151574342562, 20.298838432021434, 38.040983072117875, 121.58894471606878, 47.41731661570255, 36.971400027980195, 41.31671526564088, 147.86063028250769, 23.432525198478775, 24.03463056282798, 220.24338073349554, 137.23089020138187, 119.13138164570229, 50.041799817741705, 67.15925743043724, 9.787183816553794, 22.197527835569694, 15.713344406257749, 98.7567595093555, 79.85226884813254, 280.7957579487491, 61.043705793495675, 1.2506140388458638, 107.4296593085165, 22.21546606977429, 117.76691373491747, 57.412816753510405, 4.606843675958314, 144.20805029742723, 102.53975288265362, 215.971337270017, 107.91970803757724, 34.60160645495008, 321.44146631682963, 134.03669553850276, 35.21137978770272, 8.968423209310144, 112.72418430685299, 91.92408717689113, 24.11569831844116, 1.886607170179774, 70.47314317578108, 12.7019240381108, 33.78380536253425, 462.1897733500456, 140.25137313162816, 44.918039576170855, 60.62178758454674, 277.3965462052373, 285.88923689428015, 90.91638352686518, 13.440741680681485, 165.1075077292096, 97.13254575875325, 12.934786682191833, 61.86859581445459, 12.98703899297089, 117.37446004603994, 8.913134348455168, 4.707132534523933, 45.66874437375209, 42.097904827850556, 192.48003013775826, 83.22493290144843, 39.40359454789165, 553.8938293249704, 106.18215576187924, 58.028748646208854, 97.67035931414767, 2.9976408201782423, 22.72868781941576, 32.86727395640808, 98.40500372802983, 332.70644128244044, 67.81675018398889, 74.28202287881498, 136.0162570896544, 21.479752533330654, 281.9860484441533, 20.986281127244652, 11.615243532214981, 79.63229270286296, 91.16143213176895, 173.72479395420115, 74.90801635129063, 46.99170838263655, 82.63253760422754, 214.89037169524582, 42.81902802690592, 231.35918079032828, 17.724252748090894, 2.2622174276414864, 20.304618368656044, 110.03111100626266, 135.12968463963827, 6.210053977659762, 180.342675322796, 28.301524826835287, 64.51402245882188, 314.8212899378799, 70.73600178642137, 69.88876438368892, 196.39260468006754, 200.57046877033073, 125.48343948139161, 175.58076862529074, 16.479375766736567, 268.751515985098, 9.328978195000872]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.652506652129651, "mean_inference_ms": 4.502512354005188, "mean_action_processing_ms": 1.9463840380542299, "mean_env_wait_ms": 1.413554966239066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004192471504211426, "StateBufferConnector_ms": 0.03173935413360596, "ViewRequirementAgentConnector_ms": 0.1591721773147583}, "num_episodes": 0, "episode_return_max": 245.99999999999957, "episode_return_min": -124.10637563417316, "episode_return_mean": 71.9390658233836, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 235.07476604007678, "num_env_steps_trained_throughput_per_sec": 235.07476604007678, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 33523.633, "restore_workers_time_ms": 0.034, "training_step_time_ms": 33522.737, "sample_time_ms": 1583.112, "learn_time_ms": 31904.028, "learn_throughput": 250.752, "synch_weights_time_ms": 26.302}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 7, "trial_id": "cd905_00000", "date": "2024-08-20_09-27-55", "timestamp": 1724126275, "time_this_iter_s": 34.061424016952515, "time_total_s": 234.96438550949097, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f7eee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 234.96438550949097, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 44.98571428571428, "ram_util_percent": 82.78571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.516360804958949, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 0.0001, "total_loss": 5.0209835960751485, "policy_loss": -0.0013112426971987126, "vf_loss": 5.022282591698661, "vf_explained_var": -0.0009591491449446905, "kl": 0.0019561603660566192, "entropy": 1.391291117857373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3394107313324062, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 0.0001, "total_loss": 3.734264092218308, "policy_loss": -0.0029186978167484675, "vf_loss": 3.7371560596284414, "vf_explained_var": -0.0002970927291446262, "kl": 0.00855257650177657, "entropy": 1.4469599712462653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 149.57886005353225, "episode_reward_min": -287.67984721727396, "episode_reward_mean": 30.549410901116794, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -750.8115753641936, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 83.43382425981657, "predator_policy": 807.5456407128278}, "policy_reward_mean": {"prey_policy": -83.44881237460866, "predator_policy": 98.72351782516692}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.10000000000039, 109.59999999999889, 73.00000000000009, 78.90000000000009, 128.79999999999944, 124.99999999999946, 110.1999999999997, 149.57886005353225, 103.58296835134948, 52.20000000000022, 0.670054972648655, 66.11162286002704, 44.53613360428936, 92.39999999999864, 112.99999999999943, 47.700000000000124, 118.81224552488749, 44.27781630609333, 62.500000000000206, 112.49999999999876, 85.99999999999959, 123.72398294203873, 76.89999999999941, 89.29375072958443, 133.69999999999973, 20.324656967599704, 63.50000000000032, 78.50934644802518, -94.88425261637002, 80.13371569261564, 36.900000000000254, 47.08389675878719, -268.09400027354474, 25.820359968024206, 86.0018925548923, 32.50000000000019, 44.20000000000038, -125.9360640123855, 49.30000000000045, 62.488169786957464, 73.29999999999966, 69.9388389122846, 37.20000000000026, 61.70000000000036, 44.200000000000315, -163.47315242820372, -287.67984721727396, 52.600000000000485, 60.90000000000049, -174.76972084204124, 24.5108639038123, -5.184363235148966, 30.70000000000017, -174.57892349346457, 45.93961310551257, 35.500000000000234, 61.90104703173431, -17.313311000829298, 51.400000000000475, -170.65118131331442, -195.57795489969934, -12.528964590106277, 32.200000000000195, 93.68903873816, -63.170081833455185, 106.7999999999987, 27.52356865798084, 27.800000000000125, 59.97080081713833, -25.56548336568857, 70.00000000000001, 35.520897906936256, 15.61328610300165, 88.59999999999874, 30.600000000000165, 70.99999999999994, 70.5069936830237, 62.26997787823464, 50.90000000000046, 67.30000000000022, 72.49999999999987, 31.500000000000178, 32.50000000000019, 57.37037512510368, -22.987441508749754, 64.80000000000034, 33.70000000000021, 57.70000000000041, 34.90000000000023, 49.60000000000046, 39.40000000000029, 76.08993019658185, -80.96624129341295, 53.10000000000031, 70.15224235439226, 92.39999999999861, 36.200000000000244, -211.548723145147, -54.62972007416412, 15.633569319431363], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.406573822437974, -66.37390626338295, -38.168595814454456, 72.91296100702863, -21.700309002135764, -31.587285392359142, 40.19286746547607, -11.668744373751942, 54.00209517214957, -159.78003013775833, -53.324932901448484, 55.69640545210843, -552.8938293249705, 3.0178442381207584, -51.29567789877321, 45.175429991950004, 80.70168370408331, -2.845043992327641, -8.036135306395742, -71.03614237804244, -146.24847016629076, -253.60466632749043, -98.87425630329389, -45.312400805149316, -144.67849631174278, -114.25117106145328, 4.324864082220925, 55.47361125831958, -63.53229270286379, 5.738567868231039, -83.53715452261314, -117.39565578288003, 13.297914366534721, -24.109914828509993, -95.37971314102244, -118.0518702750358, -197.7591807903285, 11.175747251909085, 83.43382425981657, 6.499339943885323, -39.93111100626256, -119.22968463963917, 1.9940190651602898, -64.82276542357754, 33.19847517316487, -49.11402245882186, -239.9378408358996, -56.3257001588168, -50.600997806814505, -81.98037125694285, -191.77046877033123, -113.95878251379263, -163.98076862529135, 35.42062423326362, -250.36498216257084, 50.79383443049716, -155.61173170973433, -251.08685432087944, -192.71471579911983, 16.784971761157166, -80.54456491528364, -26.38101171876879, -15.531316912859504, 15.480241921214196, -750.8115753641936, -365.9344708074847, -104.41427438377892, -62.16596782086814, -25.12257472439407, 50.8826383602107, -69.31367981292802, -60.44151531866888, 9.744810657021628, 3.791384709408366, -308.5531116780552, -335.29161993436276, -42.88454793653009, 12.939771127635947, -97.82564037786706, 33.2655760495272, -115.1376168220092, 23.901581970771964, -21.27832951172114, 0.2996117836108621, -49.2740415749102, 9.325198292384849, -1.0782193607635162, 15.854861204679695, -93.64439671576154, -18.24627988254369, -243.57330048613076, -389.4555367609762, -409.9531506019068, -454.588003133142, 21.82220819849346, 14.102991486955322, 35.82901437073313, 5.898523411627892, -303.4904648480883, -528.2401495385815, -19.97316235972103, -115.630694022743, -166.51076193765147, -126.95233949695918, -42.73596281310918, -95.31111473123725, -372.84090651171834, -330.33303437657867, 2.815624101583159, -78.3830012580829, -21.27411704162781, -3.1695018803463397, -131.64502626803787, -24.550403024815772, -149.0001917614656, -119.44436085882833, 2.234285718208997, 25.486950942709633, -297.44690870485323, -289.44345400263694, -412.0607573067789, -278.88242560280247, -123.91624355731008, -53.08127905407243, -180.48976324157906, 10.918990948010164, -151.46379781670197, 47.362250934052675, -381.17372042538875, -267.73529061486045, 75.95587866872458, 0.8207878410802255, -46.987744034463574, -122.95714831336133, -64.35209150767237, -184.82173201800197, -87.18445068890821, -31.682730187129827, -152.57759331741593, -156.95642291344654, 33.51368532329403, -9.292306638999683, -110.32700808048453, -99.89829526827268, -30.567995105845583, -19.7959079563475, 7.401255432294935, 29.338370907361984, -46.10118277145477, -199.66140982133888, -76.89785121038236, 50.85891180071854, 19.3562341267831, -44.71205894564019, 16.816993807521218, -117.4597600405649, -22.257121510075073, -15.032066156448753, 8.615275083974613, 31.187973801939325, -4.327045601183274, 29.90000000000018, -10.400649774687707, -84.77427994288982, 12.37597334359103, -141.76168137982893, -131.09144141248507, 10.954231195550484, -54.92267595706354, -85.89058035576618, 30.936189325084516, -59.483788871616426, -37.46866261291904, -52.81639279995407, 23.290207835060706, -5.742239298733322, -76.65864769881303, 10.211115248791504, 9.32325514673976, 15.339536455740213, 8.053822701402597, -41.38865616778702, 14.747862680149256, 25.040349086878447, -217.9223607301516, -176.4511537317497, -46.64476587158101, -18.88244839278947, -21.12983804437701, -142.8630626772279, 71.6917677702982, -11.491291724098303, -49.04049013558108, 7.928743691646318, -386.9040664662152, -407.4224908451061, -195.37035520908927, -189.96720871946022, -104.14547521229709, -64.63418790755095], "policy_predator_policy_reward": [97.13254575875325, 12.934786682191833, 61.86859581445459, 12.98703899297089, 117.37446004603994, 8.913134348455168, 4.707132534523933, 45.66874437375209, 42.097904827850556, 192.48003013775826, 83.22493290144843, 39.40359454789165, 553.8938293249704, 106.18215576187924, 58.028748646208854, 97.67035931414767, 2.9976408201782423, 22.72868781941576, 32.86727395640808, 98.40500372802983, 332.70644128244044, 67.81675018398889, 74.28202287881498, 136.0162570896544, 21.479752533330654, 281.9860484441533, 20.986281127244652, 11.615243532214981, 79.63229270286296, 91.16143213176895, 173.72479395420115, 74.90801635129063, 46.99170838263655, 82.63253760422754, 214.89037169524582, 42.81902802690592, 231.35918079032828, 17.724252748090894, 2.2622174276414864, 20.304618368656044, 110.03111100626266, 135.12968463963827, 6.210053977659762, 180.342675322796, 28.301524826835287, 64.51402245882188, 314.8212899378799, 70.73600178642137, 69.88876438368892, 196.39260468006754, 200.57046877033073, 125.48343948139161, 175.58076862529074, 16.479375766736567, 268.751515985098, 9.328978195000872, 32.83460576003538, 278.97972765420803, 127.58889358377796, 128.47456614680013, 77.69761792909267, 66.12795870495917, 32.43514847458736, 14.699823275844922, 807.5456407128278, 41.10640518530583, 157.56866061119084, 34.83194156147941, 36.666239922819265, 23.575588996257938, 26.432472661918826, 135.82272246967773, 15.055189342978343, 15.608615290591597, 58.8088482922925, 459.0998193077389, 59.68454793653033, 19.56022887236402, 59.427014034575144, 67.62122008072122, 129.33761682200853, 35.19841802922815, 42.731553463179665, 48.18600317721549, 71.6386238344675, 5.5102194480579065, 38.104254943525284, 8.819103212558497, 95.04831701130136, 61.042359587003496, 43.021594583442635, 426.53409023546084, 33.645937120677495, 543.2153693970974, 11.377791801506582, 5.297008513044649, 2.7322397830280063, 16.440222434611186, 39.8656885798993, 617.0952049647289, 42.269078724807585, 117.8456415614682, 223.71528399757608, 64.56345420188453, 59.135962813109415, 109.61111473123647, 438.94814126413803, 89.64687613069376, 40.55553173606734, 80.95145852594389, 37.87411704162802, 22.069501880346383, 68.2890587491791, 149.80741757540792, 193.7263857394828, 57.40485587998121, 17.065714281790978, 6.613049057290474, 393.60132261682577, 22.637858777349873, 466.01971984909926, 29.34550816078244, 21.72951010935513, 142.73904791192078, 193.5897632415784, 8.181009051989815, 170.57100271435354, 27.21958290645658, 281.76073853821873, 303.9781906685754, 12.244121331274789, 17.779212158919727, 60.03684178432897, 137.43161922147607, 79.75209150767157, 197.2217320180013, 56.742674448821575, 122.09530724435382, 9.583416372747589, 274.3851164924264, 17.406817714132444, 28.371803601573557, 131.96474851990342, 113.78145273578842, 61.698890350527826, 4.278298814667463, 12.498744567705032, 39.361629092638196, 64.70118277145498, 211.6614098213382, 93.19785121038163, 3.8410881992816885, 21.28099881720909, 74.58181968467217, 61.433531634265364, 101.47921247701187, 40.55712151007533, 47.63206615644897, 7.503313194026394, 19.993437920059858, 46.92704560118329, 0.0, 28.000649774687783, 98.67427994288907, 6.92402665640894, 154.96168137982818, 135.39366202358883, 42.113923318448315, 102.41294657309223, 15.412868230987455, 19.963810674915695, 73.3837888716161, 54.16866261291928, 69.81639279995392, 3.5784515618107764, 36.573579901862, 92.05864769881215, 9.28888475120846, 4.138919283373487, 20.79828911414648, 10.846177298597382, 61.88865616778727, 9.765066851341073, 26.53665157821362, 39.08465957621699, 274.322613592271, 30.498625723037833, 88.12858854133303, 132.65080895089977, 101.4943341250968, 2.9082322297014276, 29.29129172409846, 66.24049013558131, 11.07125630835367, 45.09060483759042, 537.6872293285837, 246.15043546857996, 84.55740838580482, 146.46558155615836, 37.94765088311973]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.628805851430798, "mean_inference_ms": 4.494993693690673, "mean_action_processing_ms": 2.339590612454748, "mean_env_wait_ms": 1.3962508951389418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004158377647399902, "StateBufferConnector_ms": 0.0182417631149292, "ViewRequirementAgentConnector_ms": 0.1453561782836914}, "num_episodes": 72, "episode_return_max": 149.57886005353225, "episode_return_min": -287.67984721727396, "episode_return_mean": 30.549410901116794, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 234.21617819080376, "num_env_steps_trained_throughput_per_sec": 234.21617819080376, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 33602.744, "restore_workers_time_ms": 0.033, "training_step_time_ms": 33601.949, "sample_time_ms": 1668.94, "learn_time_ms": 31899.581, "learn_throughput": 250.787, "synch_weights_time_ms": 24.881}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 8, "trial_id": "cd905_00000", "date": "2024-08-20_09-28-30", "timestamp": 1724126310, "time_this_iter_s": 34.20171117782593, "time_total_s": 269.1660966873169, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f6af70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 269.1660966873169, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 40.99375, "ram_util_percent": 82.06458333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4165428297682887, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 0.0001, "total_loss": 7.224193805361551, "policy_loss": -0.0007651341550554784, "vf_loss": 7.224948500073145, "vf_explained_var": -0.0005115393608335465, "kl": 0.0033456140430745207, "entropy": 1.4307486954189481, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 5355.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3578462049483307, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 0.0001, "total_loss": 4.931094881844899, "policy_loss": -0.0021555028064915585, "vf_loss": 4.933233306521461, "vf_explained_var": -4.08187745109437e-05, "kl": 0.005460165065549081, "entropy": 1.3771065032671368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 5355.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 133.69999999999973, "episode_reward_min": -405.60934959497337, "episode_reward_mean": 6.032348919393123, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -750.8115753641936, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 83.43382425981657, "predator_policy": 844.0686022493643}, "policy_reward_mean": {"prey_policy": -108.53622472228318, "predator_policy": 111.55239918197958}, "custom_metrics": {}, "hist_stats": {"episode_reward": [103.58296835134948, 52.20000000000022, 0.670054972648655, 66.11162286002704, 44.53613360428936, 92.39999999999864, 112.99999999999943, 47.700000000000124, 118.81224552488749, 44.27781630609333, 62.500000000000206, 112.49999999999876, 85.99999999999959, 123.72398294203873, 76.89999999999941, 89.29375072958443, 133.69999999999973, 20.324656967599704, 63.50000000000032, 78.50934644802518, -94.88425261637002, 80.13371569261564, 36.900000000000254, 47.08389675878719, -268.09400027354474, 25.820359968024206, 86.0018925548923, 32.50000000000019, 44.20000000000038, -125.9360640123855, 49.30000000000045, 62.488169786957464, 73.29999999999966, 69.9388389122846, 37.20000000000026, 61.70000000000036, 44.200000000000315, -163.47315242820372, -287.67984721727396, 52.600000000000485, 60.90000000000049, -174.76972084204124, 24.5108639038123, -5.184363235148966, 30.70000000000017, -174.57892349346457, 45.93961310551257, 35.500000000000234, 61.90104703173431, -17.313311000829298, 51.400000000000475, -170.65118131331442, -195.57795489969934, -12.528964590106277, 32.200000000000195, 93.68903873816, -63.170081833455185, 106.7999999999987, 27.52356865798084, 27.800000000000125, 59.97080081713833, -25.56548336568857, 70.00000000000001, 35.520897906936256, 15.61328610300165, 88.59999999999874, 30.600000000000165, 70.99999999999994, 70.5069936830237, 62.26997787823464, 50.90000000000046, 67.30000000000022, 72.49999999999987, 31.500000000000178, 32.50000000000019, 57.37037512510368, -22.987441508749754, 64.80000000000034, 33.70000000000021, 57.70000000000041, 34.90000000000023, 49.60000000000046, 39.40000000000029, 76.08993019658185, -80.96624129341295, 53.10000000000031, 70.15224235439226, 92.39999999999861, 36.200000000000244, -211.548723145147, -54.62972007416412, 15.633569319431363, -127.74856295271243, -83.69545470084356, -11.159498792445651, -359.4887538909257, -332.1834855836829, -354.8422326032534, -405.60934959497337, 55.20000000000048], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [80.70168370408331, -2.845043992327641, -8.036135306395742, -71.03614237804244, -146.24847016629076, -253.60466632749043, -98.87425630329389, -45.312400805149316, -144.67849631174278, -114.25117106145328, 4.324864082220925, 55.47361125831958, -63.53229270286379, 5.738567868231039, -83.53715452261314, -117.39565578288003, 13.297914366534721, -24.109914828509993, -95.37971314102244, -118.0518702750358, -197.7591807903285, 11.175747251909085, 83.43382425981657, 6.499339943885323, -39.93111100626256, -119.22968463963917, 1.9940190651602898, -64.82276542357754, 33.19847517316487, -49.11402245882186, -239.9378408358996, -56.3257001588168, -50.600997806814505, -81.98037125694285, -191.77046877033123, -113.95878251379263, -163.98076862529135, 35.42062423326362, -250.36498216257084, 50.79383443049716, -155.61173170973433, -251.08685432087944, -192.71471579911983, 16.784971761157166, -80.54456491528364, -26.38101171876879, -15.531316912859504, 15.480241921214196, -750.8115753641936, -365.9344708074847, -104.41427438377892, -62.16596782086814, -25.12257472439407, 50.8826383602107, -69.31367981292802, -60.44151531866888, 9.744810657021628, 3.791384709408366, -308.5531116780552, -335.29161993436276, -42.88454793653009, 12.939771127635947, -97.82564037786706, 33.2655760495272, -115.1376168220092, 23.901581970771964, -21.27832951172114, 0.2996117836108621, -49.2740415749102, 9.325198292384849, -1.0782193607635162, 15.854861204679695, -93.64439671576154, -18.24627988254369, -243.57330048613076, -389.4555367609762, -409.9531506019068, -454.588003133142, 21.82220819849346, 14.102991486955322, 35.82901437073313, 5.898523411627892, -303.4904648480883, -528.2401495385815, -19.97316235972103, -115.630694022743, -166.51076193765147, -126.95233949695918, -42.73596281310918, -95.31111473123725, -372.84090651171834, -330.33303437657867, 2.815624101583159, -78.3830012580829, -21.27411704162781, -3.1695018803463397, -131.64502626803787, -24.550403024815772, -149.0001917614656, -119.44436085882833, 2.234285718208997, 25.486950942709633, -297.44690870485323, -289.44345400263694, -412.0607573067789, -278.88242560280247, -123.91624355731008, -53.08127905407243, -180.48976324157906, 10.918990948010164, -151.46379781670197, 47.362250934052675, -381.17372042538875, -267.73529061486045, 75.95587866872458, 0.8207878410802255, -46.987744034463574, -122.95714831336133, -64.35209150767237, -184.82173201800197, -87.18445068890821, -31.682730187129827, -152.57759331741593, -156.95642291344654, 33.51368532329403, -9.292306638999683, -110.32700808048453, -99.89829526827268, -30.567995105845583, -19.7959079563475, 7.401255432294935, 29.338370907361984, -46.10118277145477, -199.66140982133888, -76.89785121038236, 50.85891180071854, 19.3562341267831, -44.71205894564019, 16.816993807521218, -117.4597600405649, -22.257121510075073, -15.032066156448753, 8.615275083974613, 31.187973801939325, -4.327045601183274, 29.90000000000018, -10.400649774687707, -84.77427994288982, 12.37597334359103, -141.76168137982893, -131.09144141248507, 10.954231195550484, -54.92267595706354, -85.89058035576618, 30.936189325084516, -59.483788871616426, -37.46866261291904, -52.81639279995407, 23.290207835060706, -5.742239298733322, -76.65864769881303, 10.211115248791504, 9.32325514673976, 15.339536455740213, 8.053822701402597, -41.38865616778702, 14.747862680149256, 25.040349086878447, -217.9223607301516, -176.4511537317497, -46.64476587158101, -18.88244839278947, -21.12983804437701, -142.8630626772279, 71.6917677702982, -11.491291724098303, -49.04049013558108, 7.928743691646318, -386.9040664662152, -407.4224908451061, -195.37035520908927, -189.96720871946022, -104.14547521229709, -64.63418790755095, -285.0361343467896, -347.62971501439733, -144.7835238320525, -157.17278497058854, -28.759470900294485, -223.7900632331937, -643.176133555119, -749.8434617828071, -460.6319271963531, -428.90177846479776, -690.3838060133342, -470.6205960494706, -473.22641200752787, -644.5765063396816, 8.773313698577326, 19.887396513164806], "policy_predator_policy_reward": [2.9976408201782423, 22.72868781941576, 32.86727395640808, 98.40500372802983, 332.70644128244044, 67.81675018398889, 74.28202287881498, 136.0162570896544, 21.479752533330654, 281.9860484441533, 20.986281127244652, 11.615243532214981, 79.63229270286296, 91.16143213176895, 173.72479395420115, 74.90801635129063, 46.99170838263655, 82.63253760422754, 214.89037169524582, 42.81902802690592, 231.35918079032828, 17.724252748090894, 2.2622174276414864, 20.304618368656044, 110.03111100626266, 135.12968463963827, 6.210053977659762, 180.342675322796, 28.301524826835287, 64.51402245882188, 314.8212899378799, 70.73600178642137, 69.88876438368892, 196.39260468006754, 200.57046877033073, 125.48343948139161, 175.58076862529074, 16.479375766736567, 268.751515985098, 9.328978195000872, 32.83460576003538, 278.97972765420803, 127.58889358377796, 128.47456614680013, 77.69761792909267, 66.12795870495917, 32.43514847458736, 14.699823275844922, 807.5456407128278, 41.10640518530583, 157.56866061119084, 34.83194156147941, 36.666239922819265, 23.575588996257938, 26.432472661918826, 135.82272246967773, 15.055189342978343, 15.608615290591597, 58.8088482922925, 459.0998193077389, 59.68454793653033, 19.56022887236402, 59.427014034575144, 67.62122008072122, 129.33761682200853, 35.19841802922815, 42.731553463179665, 48.18600317721549, 71.6386238344675, 5.5102194480579065, 38.104254943525284, 8.819103212558497, 95.04831701130136, 61.042359587003496, 43.021594583442635, 426.53409023546084, 33.645937120677495, 543.2153693970974, 11.377791801506582, 5.297008513044649, 2.7322397830280063, 16.440222434611186, 39.8656885798993, 617.0952049647289, 42.269078724807585, 117.8456415614682, 223.71528399757608, 64.56345420188453, 59.135962813109415, 109.61111473123647, 438.94814126413803, 89.64687613069376, 40.55553173606734, 80.95145852594389, 37.87411704162802, 22.069501880346383, 68.2890587491791, 149.80741757540792, 193.7263857394828, 57.40485587998121, 17.065714281790978, 6.613049057290474, 393.60132261682577, 22.637858777349873, 466.01971984909926, 29.34550816078244, 21.72951010935513, 142.73904791192078, 193.5897632415784, 8.181009051989815, 170.57100271435354, 27.21958290645658, 281.76073853821873, 303.9781906685754, 12.244121331274789, 17.779212158919727, 60.03684178432897, 137.43161922147607, 79.75209150767157, 197.2217320180013, 56.742674448821575, 122.09530724435382, 9.583416372747589, 274.3851164924264, 17.406817714132444, 28.371803601573557, 131.96474851990342, 113.78145273578842, 61.698890350527826, 4.278298814667463, 12.498744567705032, 39.361629092638196, 64.70118277145498, 211.6614098213382, 93.19785121038163, 3.8410881992816885, 21.28099881720909, 74.58181968467217, 61.433531634265364, 101.47921247701187, 40.55712151007533, 47.63206615644897, 7.503313194026394, 19.993437920059858, 46.92704560118329, 0.0, 28.000649774687783, 98.67427994288907, 6.92402665640894, 154.96168137982818, 135.39366202358883, 42.113923318448315, 102.41294657309223, 15.412868230987455, 19.963810674915695, 73.3837888716161, 54.16866261291928, 69.81639279995392, 3.5784515618107764, 36.573579901862, 92.05864769881215, 9.28888475120846, 4.138919283373487, 20.79828911414648, 10.846177298597382, 61.88865616778727, 9.765066851341073, 26.53665157821362, 39.08465957621699, 274.322613592271, 30.498625723037833, 88.12858854133303, 132.65080895089977, 101.4943341250968, 2.9082322297014276, 29.29129172409846, 66.24049013558131, 11.07125630835367, 45.09060483759042, 537.6872293285837, 246.15043546857996, 84.55740838580482, 146.46558155615836, 37.94765088311973, 110.80504163829883, 394.11224477017504, 193.04996098019114, 25.210893121605938, 0.0, 241.3900353410421, 189.4622391976359, 844.0686022493643, 554.4969364579215, 2.853283619546519, 790.1398468464254, 16.02232261312557, 8.240610721830398, 703.9529580304054, 10.42668630142264, 16.11260348683521]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.623244009335769, "mean_inference_ms": 4.493996452452313, "mean_action_processing_ms": 2.361466732637591, "mean_env_wait_ms": 1.3832289515711649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004111766815185547, "StateBufferConnector_ms": 0.01557016372680664, "ViewRequirementAgentConnector_ms": 0.14518940448760986}, "num_episodes": 8, "episode_return_max": 133.69999999999973, "episode_return_min": -405.60934959497337, "episode_return_mean": 6.032348919393123, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 240.90263592365307, "num_env_steps_trained_throughput_per_sec": 240.90263592365307, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 33558.934, "restore_workers_time_ms": 0.031, "training_step_time_ms": 33558.199, "sample_time_ms": 1641.096, "learn_time_ms": 31883.971, "learn_throughput": 250.91, "synch_weights_time_ms": 24.989}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 9, "trial_id": "cd905_00000", "date": "2024-08-20_09-29-03", "timestamp": 1724126343, "time_this_iter_s": 33.244932889938354, "time_total_s": 302.41102957725525, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f70e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 302.41102957725525, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 40.30833333333334, "ram_util_percent": 82.63125000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.257600510906842, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 0.0001, "total_loss": 7.662823752751426, "policy_loss": -0.0025975304552250437, "vf_loss": 7.665411092364599, "vf_explained_var": 0.0010983056492275662, "kl": 0.006534891547701028, "entropy": 1.4856594399800376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 5985.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.33922301773868857, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 0.0001, "total_loss": 5.789986724702139, "policy_loss": -0.0015657714800909161, "vf_loss": 5.791544093026055, "vf_explained_var": -1.18210202171689e-05, "kl": 0.0026937227924306744, "entropy": 1.3417853313779073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 5985.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 92.39999999999861, "episode_reward_min": -877.6907989557153, "episode_reward_mean": -98.52103144799288, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1121.485540251311, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 71.6917677702982, "predator_policy": 1353.9184166572682}, "policy_reward_mean": {"prey_policy": -243.2009410019726, "predator_policy": 193.94042527797603}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.61328610300165, 88.59999999999874, 30.600000000000165, 70.99999999999994, 70.5069936830237, 62.26997787823464, 50.90000000000046, 67.30000000000022, 72.49999999999987, 31.500000000000178, 32.50000000000019, 57.37037512510368, -22.987441508749754, 64.80000000000034, 33.70000000000021, 57.70000000000041, 34.90000000000023, 49.60000000000046, 39.40000000000029, 76.08993019658185, -80.96624129341295, 53.10000000000031, 70.15224235439226, 92.39999999999861, 36.200000000000244, -211.548723145147, -54.62972007416412, 15.633569319431363, -127.74856295271243, -83.69545470084356, -11.159498792445651, -359.4887538909257, -332.1834855836829, -354.8422326032534, -405.60934959497337, 55.20000000000048, -62.9189365826567, -251.4560714198968, 24.657679130206198, -312.66609068850835, -187.87567920297852, -27.47231938262376, 36.80000000000025, -85.47746785831197, 54.202108690376456, -396.5423850284097, 33.382749603740656, -299.4388005317962, 36.900000000000254, 25.800375481075328, 60.034101849143774, -33.69349594018827, -312.93884349863606, -488.75622766598053, 36.28090944750004, 79.75563218776337, 15.623441103298463, -518.3909475787444, -171.8467933354662, -27.655008270227434, 38.50000000000028, -318.6925151541124, -877.6907989557153, -346.20454680998955, 43.2299381218386, -88.69859394833878, 55.182920758886176, 57.60000000000046, -334.05053463891613, -57.967120126571466, 38.90000000000028, 70.065235718442, 27.95037277290091, -50.15278269354158, 66.48597312736013, -135.39445415695502, -626.7919653010575, 18.9735350039537, -38.900654911367894, -427.8973905010048, -3.3530124720448606, 20.550424266172534, -492.30691032041335, 63.20000000000046, -248.0987302935453, 45.19225102743493, -693.6028291873841, 86.49999999999885, 60.2000000000005, -78.27853576278716, -495.0038950075954, -354.94635784425407, -258.9592340704522, -179.02119766275104, -75.35789371271915, -77.54401164543496, 10.90099467688945, 46.76709732004865, -312.53694564548357, -541.8358177989206], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-30.567995105845583, -19.7959079563475, 7.401255432294935, 29.338370907361984, -46.10118277145477, -199.66140982133888, -76.89785121038236, 50.85891180071854, 19.3562341267831, -44.71205894564019, 16.816993807521218, -117.4597600405649, -22.257121510075073, -15.032066156448753, 8.615275083974613, 31.187973801939325, -4.327045601183274, 29.90000000000018, -10.400649774687707, -84.77427994288982, 12.37597334359103, -141.76168137982893, -131.09144141248507, 10.954231195550484, -54.92267595706354, -85.89058035576618, 30.936189325084516, -59.483788871616426, -37.46866261291904, -52.81639279995407, 23.290207835060706, -5.742239298733322, -76.65864769881303, 10.211115248791504, 9.32325514673976, 15.339536455740213, 8.053822701402597, -41.38865616778702, 14.747862680149256, 25.040349086878447, -217.9223607301516, -176.4511537317497, -46.64476587158101, -18.88244839278947, -21.12983804437701, -142.8630626772279, 71.6917677702982, -11.491291724098303, -49.04049013558108, 7.928743691646318, -386.9040664662152, -407.4224908451061, -195.37035520908927, -189.96720871946022, -104.14547521229709, -64.63418790755095, -285.0361343467896, -347.62971501439733, -144.7835238320525, -157.17278497058854, -28.759470900294485, -223.7900632331937, -643.176133555119, -749.8434617828071, -460.6319271963531, -428.90177846479776, -690.3838060133342, -470.6205960494706, -473.22641200752787, -644.5765063396816, 8.773313698577326, 19.887396513164806, -101.22531929854053, -281.87373597190003, -738.7115654239225, -652.2693276534347, -751.2132172240243, -830.2988768130992, -412.5925275265205, -406.665250767215, -912.7572744861124, -281.37588035045223, -73.64653072413307, -106.91460293368104, -63.29681281876229, 18.88265282905646, -548.801454034092, -597.9025347686832, 8.825398569830194, -13.637953524220592, -1106.8383713984672, -453.7990841403636, -25.920094217763307, -9.135014600744263, -386.8847360269395, -473.2703688092911, 3.0857019158974337, -11.221250902243213, -65.93747925109027, -23.798333708793635, 21.948947244875363, -26.66087166847751, -262.95009487853054, -599.3361466163485, -610.9689372598211, -554.4881413434534, -643.8786411429024, -805.188530594459, -141.5769506001449, -9.051488838062454, -28.473651604233332, 0.42855814995000585, -152.4554697111802, -62.05688204383158, -638.7750201213621, -751.390761911547, -667.5089447299387, -319.0649405906113, -85.43965792507011, -161.7064802572707, -24.561889853021412, 18.936862036802456, -634.6772431700564, -568.273464438795, -1113.3547219900775, -1121.485540251311, -454.1323368031728, -472.524417927486, 10.220083861003424, -2.017764181712435, -199.67770353094426, -228.30412177671028, 18.867237243930226, -34.325364380637694, -1.2121182500231544, 1.7107736387007697, -536.6488686737455, -499.4497599915999, -127.89734620968052, -135.71907170278487, 8.788732402089966, 4.288577990210038, -14.500667512389233, -94.65939448181597, -143.25092548696014, -14.763131545784839, -776.0663850281406, -427.9759679656871, 22.65184222889028, -24.912895061760807, -211.01058162444193, -176.26254589649284, -712.9975967558229, -868.245900457667, -25.29795515379415, -48.34144212455849, -147.66202197441655, -93.41628864893492, -592.2454087943304, -635.6358029180702, -153.7988066198412, -58.06671829933305, -131.17360538545793, -8.688633598741696, -746.8680589466895, -757.414939779316, 22.786826891230632, 5.001827398868007, -338.8301856125625, -409.94460340831773, -83.51096711266658, 5.131574557049474, -860.2471996313378, -940.4429077183393, 21.347292462314552, 38.27415898819591, -22.62101554916658, 35.441503818718886, -606.2746599840814, -737.4592641647673, -774.20383409024, -640.0136057178429, -664.5994225957852, -476.29899573582685, -369.1474035423982, -368.91506241162483, -380.6167305032719, -263.01103326577055, -123.592949074351, -159.5316052663538, -157.58991729818362, -237.91084049398918, -76.79555777743157, -68.5366168240339, -77.27311333089605, -34.264937427583774, -438.6197594118457, -600.4569121697878, -710.7637990697417, -738.2724119177559], "policy_predator_policy_reward": [61.698890350527826, 4.278298814667463, 12.498744567705032, 39.361629092638196, 64.70118277145498, 211.6614098213382, 93.19785121038163, 3.8410881992816885, 21.28099881720909, 74.58181968467217, 61.433531634265364, 101.47921247701187, 40.55712151007533, 47.63206615644897, 7.503313194026394, 19.993437920059858, 46.92704560118329, 0.0, 28.000649774687783, 98.67427994288907, 6.92402665640894, 154.96168137982818, 135.39366202358883, 42.113923318448315, 102.41294657309223, 15.412868230987455, 19.963810674915695, 73.3837888716161, 54.16866261291928, 69.81639279995392, 3.5784515618107764, 36.573579901862, 92.05864769881215, 9.28888475120846, 4.138919283373487, 20.79828911414648, 10.846177298597382, 61.88865616778727, 9.765066851341073, 26.53665157821362, 39.08465957621699, 274.322613592271, 30.498625723037833, 88.12858854133303, 132.65080895089977, 101.4943341250968, 2.9082322297014276, 29.29129172409846, 66.24049013558131, 11.07125630835367, 45.09060483759042, 537.6872293285837, 246.15043546857996, 84.55740838580482, 146.46558155615836, 37.94765088311973, 110.80504163829883, 394.11224477017504, 193.04996098019114, 25.210893121605938, 0.0, 241.3900353410421, 189.4622391976359, 844.0686022493643, 554.4969364579215, 2.853283619546519, 790.1398468464254, 16.02232261312557, 8.240610721830398, 703.9529580304054, 10.42668630142264, 16.11260348683521, 9.033995467246259, 311.1461232205374, 561.5654577685092, 577.9593638889513, 840.7410426921213, 765.4287304752083, 495.42158411984803, 11.170103485379373, 984.0398627013869, 22.217612932199096, 24.33269394942788, 128.75612032576262, 31.396721054725397, 49.81743893497965, 495.36660906166924, 565.8599118827939, 50.80178255451898, 8.21288109024756, 1154.301220596508, 9.793849913913437, 55.475441787921994, 12.962416634325983, 48.703678754224065, 512.0126255502105, 15.51429808410253, 29.521250902243388, 11.4350828998998, 104.10110554105886, 31.651635110071716, 33.09439116267415, 208.19358208030627, 620.3991634743844, 69.5469671975727, 782.9712679070649, 81.9569191125714, 878.3540249588093, 36.40732260755185, 150.5020262781547, 49.19617860289885, 58.60454703914878, 200.72070440264397, 29.41508845566527, 9.372865579168318, 862.4019688749967, 789.7813226959421, 24.945769289141943, 31.662008489640204, 187.8291214224731, 43.16188985302168, 0.9631379631975477, 30.746063722066054, 853.5121287326726, 3.2310466284047115, 1353.9184166572682, 29.794744750025224, 550.6574631706442, 10.26721543387824, 24.760403008669005, 59.47112003883544, 279.81211132048054, 52.22536438063795, 18.415683514955425, 42.29735238836555, 14.80399222295678, 24.735303659609123, 677.3127903668199, 183.67055273847902, 21.978745047414613, 12.052934223184552, 13.76975538451538, 98.1778322869187, 81.04746542572776, 41.520477589642894, 144.44395221600226, 794.5937146659867, 359.29585563429885, 53.92270281157118, 14.824323148659465, 37.2313739431733, 214.64729942080646, 9.749348512145742, 944.7021834002862, 73.31243727575719, 19.300495006549067, 145.11991348619273, 57.057742225790356, 640.763805141951, 159.22001606944426, 35.16112817392171, 173.3513842732078, 126.04103786654153, 34.371625383829716, 981.0001670416038, 30.97592136398805, 7.684141069117871, 27.7272046407836, 32.97125761725284, 467.7048011100819, 37.96285299194225, 85.60879059110853, 0.0, 1107.087278162293, 17.01104091241095, 9.867507637078866, 40.721015549166836, 6.658496181281359, 570.9895354306686, 694.465852955392, 904.1813183827943, 15.03222641769242, 767.8883726273392, 18.063687860018593, 44.91058553639407, 434.192646347177, 422.14386020399064, 42.462705902300435, 162.04162017383297, 45.72504045415272, 219.560715131996, 98.39603101474121, 43.8099229734153, 112.42324630493823, 37.71987451569813, 120.58527356283011, 681.6780965978304, 44.86162933831917, 75.8263501611446, 831.374043027432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.4974960138509275, "mean_inference_ms": 4.386702287926514, "mean_action_processing_ms": 2.3999092698178606, "mean_env_wait_ms": 1.3639332739395176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008553624153137207, "StateBufferConnector_ms": 0.02896416187286377, "ViewRequirementAgentConnector_ms": 0.19236183166503906}, "num_episodes": 64, "episode_return_max": 92.39999999999861, "episode_return_min": -877.6907989557153, "episode_return_mean": -98.52103144799288, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 239.75712602858923, "num_env_steps_trained_throughput_per_sec": 239.75712602858923, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 33539.761, "restore_workers_time_ms": 0.031, "training_step_time_ms": 33538.989, "sample_time_ms": 1607.17, "learn_time_ms": 31899.377, "learn_throughput": 250.789, "synch_weights_time_ms": 24.645}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 10, "trial_id": "cd905_00000", "date": "2024-08-20_09-29-36", "timestamp": 1724126376, "time_this_iter_s": 33.40408706665039, "time_total_s": 335.81511664390564, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f68a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 335.81511664390564, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 39.94042553191489, "ram_util_percent": 82.35106382978722}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4507876407414202, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 0.0001, "total_loss": 8.914828939286489, "policy_loss": -0.004977798127450995, "vf_loss": 8.91979305025131, "vf_explained_var": 0.00205762575543116, "kl": 0.008774091191030276, "entropy": 1.5412986596425375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.45399075960592616, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 0.0001, "total_loss": 7.9310683492630245, "policy_loss": -0.0018276885055774261, "vf_loss": 7.932887034189133, "vf_explained_var": -0.00014994428271339054, "kl": 0.005776282053692927, "entropy": 1.2625438090354677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 335.5051510863539, "episode_reward_min": -693.6028291873841, "episode_reward_mean": -127.73555474670769, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1240.0014776339972, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 38.27415898819591, "predator_policy": 1319.8962238883666}, "policy_reward_mean": {"prey_policy": -460.7850538260406, "predator_policy": 396.9172764526866}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.95037277290091, -50.15278269354158, 66.48597312736013, -135.39445415695502, -626.7919653010575, 18.9735350039537, -38.900654911367894, -427.8973905010048, -3.3530124720448606, 20.550424266172534, -492.30691032041335, 63.20000000000046, -248.0987302935453, 45.19225102743493, -693.6028291873841, 86.49999999999885, 60.2000000000005, -78.27853576278716, -495.0038950075954, -354.94635784425407, -258.9592340704522, -179.02119766275104, -75.35789371271915, -77.54401164543496, 10.90099467688945, 46.76709732004865, -312.53694564548357, -541.8358177989206, 77.49894265961983, -181.81069059494382, -89.45578248577937, 6.854295017787176, -547.6189702992846, -460.86079859179756, -15.289568248860775, -98.81770173903314, -119.25502791490707, -238.45257740454176, 6.5277091274746, -354.2594375437681, -575.7882698521371, -73.97343176221477, 15.211255380067685, 117.27424415522383, 51.76668375489441, 35.600000000000236, 3.0742926158314714, -245.22665539575786, -5.905453723137574, -226.53143146578952, -53.224070078859214, -418.80851592474795, -13.15244859727347, -363.4825544989689, -2.2006432437578396, 236.89867972334312, 67.53999208143772, 1.348892941129601, -374.52674562869305, -402.1942525942701, -335.99075589996886, -31.341491875553896, 114.21986041230453, -318.1155039793007, -17.634842273812065, 335.5051510863539, 56.800000000000445, 246.83390206364183, -249.9727534189733, -425.28168445702846, -362.2071421572271, -288.57356311384336, 26.684118549446275, 67.33270362325415, -480.2898718985629, -562.4363239629424, -256.59035837459527, -488.1215820179698, -3.9737328496721425, 74.4498940905196, -22.332450683380223, 22.091256970824105, -351.2518394575739, 314.9368150148824, -107.59979210883387, -8.629159261478708, -22.953771869426262, -42.73493963267745, -18.072553297598134, 197.54670055650436, 1.63200925523536, 298.37757664493967, -2.683806105644138, -359.8239655342261, -111.30616245749735, 22.950907961140945, -143.32980553976404, -340.55576241264856, -216.36417799116361, -100.24656734378988], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-143.25092548696014, -14.763131545784839, -776.0663850281406, -427.9759679656871, 22.65184222889028, -24.912895061760807, -211.01058162444193, -176.26254589649284, -712.9975967558229, -868.245900457667, -25.29795515379415, -48.34144212455849, -147.66202197441655, -93.41628864893492, -592.2454087943304, -635.6358029180702, -153.7988066198412, -58.06671829933305, -131.17360538545793, -8.688633598741696, -746.8680589466895, -757.414939779316, 22.786826891230632, 5.001827398868007, -338.8301856125625, -409.94460340831773, -83.51096711266658, 5.131574557049474, -860.2471996313378, -940.4429077183393, 21.347292462314552, 38.27415898819591, -22.62101554916658, 35.441503818718886, -606.2746599840814, -737.4592641647673, -774.20383409024, -640.0136057178429, -664.5994225957852, -476.29899573582685, -369.1474035423982, -368.91506241162483, -380.6167305032719, -263.01103326577055, -123.592949074351, -159.5316052663538, -157.58991729818362, -237.91084049398918, -76.79555777743157, -68.5366168240339, -77.27311333089605, -34.264937427583774, -438.6197594118457, -600.4569121697878, -710.7637990697417, -738.2724119177559, -101.10887812222637, -87.89623792521868, -506.2402415113152, -324.91315843551325, -721.6813504977177, -931.5005568236671, -56.796521888907655, -60.30391536049798, -939.2811476193377, -815.9464455498864, -744.5360061528423, -774.8376206903456, -365.1512418156792, -308.22481923661485, -476.1251794067133, -417.297399573326, -622.0824076177786, -625.4862600695435, -325.303766924995, -364.84699563672353, -104.46952427994592, -151.16997906163812, -815.8379679183616, -707.8438443082903, -818.392991121038, -886.4899496361629, -145.61673830543137, -345.169408683852, -908.3789914416824, -625.8894446277102, -140.41970139418243, -305.41723994672367, -7.9215687530282795, -30.217294303622054, -113.02328209961362, 7.47336500006843, -128.20956318821825, -223.01004885054192, -657.4856496227825, -651.1228817068579, -13.02516814510179, -656.5378942766104, -847.4732334666514, -1135.9705036054615, -353.1513845944259, -276.786162608555, -552.7176555578371, -1118.4139578731438, -413.1788927696398, -693.171916979074, -800.5856871923171, -506.5355545824432, -761.5064432577818, -9.641094413476248, -364.5685436231326, -922.9260412897391, -74.85827946015412, -37.123415143331904, -39.04050877398406, -20.127571060754953, -672.3370154880687, -665.7240700049731, -702.5988805087446, -705.2222788541419, -526.6310982014951, -573.173573878392, -98.22462966549823, -176.8642388777502, -375.9617216550083, -6.455223113608774, -855.0593078509243, -560.5511191608379, -36.84929407248588, -302.3572181403854, -643.5060234924761, -1105.7219054045336, -2.159258039548867, -28.171998827691326, -1091.1343679919223, -362.94450490538645, -566.5867135644536, -456.71385586631357, -772.4639600198512, -915.943506638129, -849.0168896310961, -819.3553344263235, -488.7407563692914, -528.3526553515953, -12.67740175627386, -26.96559233503655, 37.426901363441495, -14.019473869887811, -773.7470125565969, -743.4540888791803, -986.8066090420767, -896.2741189364123, -623.2271260733244, -700.7795550742139, -739.8779874908638, -730.6312598344604, -288.375156060239, -115.94178527592948, -556.7443977554594, -336.92162383296113, -990.6130915216953, -843.3262324046898, -1240.0014776339972, -665.5711336933225, -1156.8575955989868, -1003.4054138117662, -929.563886241676, -100.23666859780538, -537.0532131885952, -504.3199552695297, -774.4216603431332, -615.6882543643378, -431.64328714658956, -273.6588038796495, -581.9777945921306, -992.8791584296288, -546.50675476361, -828.9403513745855, -776.2880667243528, -274.6926150814604, -158.65160660207775, -37.3893383579775, -639.7422240141933, -1067.5006869863087, -321.58390829003383, -544.6070982492727, -629.9013264468479, -999.9302286970913, -1090.8442770527915, -1073.22990261795, -100.53314185505947, -64.60805617756421, -353.8233982712944, -308.6425198003488, -485.85616053172345, -696.519846261797, -655.9649014002945, -566.9357819409095, -540.6221762258899, -465.92242274773173], "policy_predator_policy_reward": [41.520477589642894, 144.44395221600226, 794.5937146659867, 359.29585563429885, 53.92270281157118, 14.824323148659465, 37.2313739431733, 214.64729942080646, 9.749348512145742, 944.7021834002862, 73.31243727575719, 19.300495006549067, 145.11991348619273, 57.057742225790356, 640.763805141951, 159.22001606944426, 35.16112817392171, 173.3513842732078, 126.04103786654153, 34.371625383829716, 981.0001670416038, 30.97592136398805, 7.684141069117871, 27.7272046407836, 32.97125761725284, 467.7048011100819, 37.96285299194225, 85.60879059110853, 0.0, 1107.087278162293, 17.01104091241095, 9.867507637078866, 40.721015549166836, 6.658496181281359, 570.9895354306686, 694.465852955392, 904.1813183827943, 15.03222641769242, 767.8883726273392, 18.063687860018593, 44.91058553639407, 434.192646347177, 422.14386020399064, 42.462705902300435, 162.04162017383297, 45.72504045415272, 219.560715131996, 98.39603101474121, 43.8099229734153, 112.42324630493823, 37.71987451569813, 120.58527356283011, 681.6780965978304, 44.86162933831917, 75.8263501611446, 831.374043027432, 129.15892918349613, 137.3451295235694, 595.6084687415995, 53.73424061028574, 537.0547256222858, 1026.67139921332, 27.941917105444453, 96.01281516174802, 40.46994505488054, 1167.138677815059, 991.5601286397472, 66.95269961164249, 492.413265678168, 165.67322712526502, 205.6400363477059, 588.9648408932999, 260.24566246143587, 868.067977310979, 432.14083348505216, 19.5573516721246, 148.2536785518593, 113.91353391719787, 304.7891005850707, 864.6332740978132, 34.79749971723958, 1094.297171187823, 411.90444207017174, 4.90827315689653, 1047.6695785925442, 501.8101128569155, 246.92292594948714, 316.1882595466434, 42.288252507922245, 47.61729430362229, 128.52328209961277, 12.626634999931536, 208.392832870793, 145.90107178379876, 252.80333648709907, 810.5785394467831, 5.71971442196433, 657.9378942766105, 533.8836848573883, 1223.0286207489353, 251.24506644368353, 325.4684106804384, 28.625503632318136, 1223.6975938739151, 392.97864906679627, 700.219712084644, 904.6606761149891, 38.97801116080229, 17.569714242810807, 751.3771801846895, 559.2197111504614, 965.173553485753, 109.49087804452365, 70.03080864039994, 57.68693424276835, 2.830038533099971, 821.4461789264494, 142.08816093789903, 968.1686412431458, 37.45826552547093, 712.3088676236498, 51.50504855626852, 0.991275176134672, 242.75610149155975, 88.92507774895857, 407.71172743196297, 987.460893185511, 110.03402984694984, 0.0, 321.57166993905906, 971.635156982518, 1113.097923000847, 20.559258039548876, 66.57199882769154, 1089.8740388646609, 611.0387360962897, 6.727284003627409, 766.6005320081657, 149.33824839401493, 1113.7875338069368, 262.33388135796787, 1043.831200542225, 8.436871878502814, 720.0829767285402, 11.065673359705738, 55.261439281050436, 5.0916506412355576, 38.83362548846535, 95.5670537964082, 941.3441757408059, 123.88550669295586, 1196.758897322591, 912.1963861046811, 155.2199366682613, 982.3876653073545, 0.0, 297.80028924974545, 102.5429192367506, 601.0265383404508, 367.08937733848944, 936.2460360897509, 875.3608371532538, 1199.755196798029, 727.9086715001148, 1319.8962238883666, 489.11494606481074, 737.4621344159598, 607.2752354384041, 546.8054051705719, 386.96797117871824, 866.9099947824019, 514.5707606635909, 472.6920408092824, 209.65627834753073, 994.4663737888328, 537.6556396002495, 376.56493253232253, 980.8096203082748, 559.4779035472876, 689.0494788150306, 17.995602389193106, 179.67735182609695, 980.4623682406717, 1025.1581194047703, 445.47061364437235, 418.03658678928997, 295.50530872005635, 974.5022808896582, 745.6944733691802, 1307.0735438440652, 156.02302927321213, 32.06907672055208, 16.798557036690603, 502.3375554951882, 824.1674525440471, 17.65279183682451, 157.94454396664796, 848.5919613833925, 587.8748682053626, 318.42316342446895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.397849700623019, "mean_inference_ms": 4.276892909027826, "mean_action_processing_ms": 2.2902772516727024, "mean_env_wait_ms": 1.3384649386500433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006590604782104492, "StateBufferConnector_ms": 0.018367409706115723, "ViewRequirementAgentConnector_ms": 0.13915276527404785}, "num_episodes": 72, "episode_return_max": 335.5051510863539, "episode_return_min": -693.6028291873841, "episode_return_mean": -127.73555474670769, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 246.091775692926, "num_env_steps_trained_throughput_per_sec": 246.091775692926, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 33421.53, "restore_workers_time_ms": 0.031, "training_step_time_ms": 33420.748, "sample_time_ms": 1565.007, "learn_time_ms": 31825.14, "learn_throughput": 251.374, "synch_weights_time_ms": 23.956}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 11, "trial_id": "cd905_00000", "date": "2024-08-20_09-30-09", "timestamp": 1724126409, "time_this_iter_s": 32.5524480342865, "time_total_s": 368.36756467819214, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169eab790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 368.36756467819214, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 36.55106382978723, "ram_util_percent": 81.84042553191489}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.557165716659455, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 0.0001, "total_loss": 6.0311816192808605, "policy_loss": -0.004443134040763927, "vf_loss": 6.035608734403338, "vf_explained_var": 0.0022927943676237074, "kl": 0.010248796441352884, "entropy": 1.5832619869519793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 7245.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49252277962745183, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 0.0001, "total_loss": 6.31267081896464, "policy_loss": -0.0018064641452852695, "vf_loss": 6.314469526684474, "vf_explained_var": -4.043011438278925e-05, "kl": 0.004959217552176676, "entropy": 1.300592849557362, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 7245.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 335.5051510863539, "episode_reward_min": -693.6028291873841, "episode_reward_mean": -127.73555474670769, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1240.0014776339972, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 38.27415898819591, "predator_policy": 1319.8962238883666}, "policy_reward_mean": {"prey_policy": -460.7850538260406, "predator_policy": 396.9172764526866}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.95037277290091, -50.15278269354158, 66.48597312736013, -135.39445415695502, -626.7919653010575, 18.9735350039537, -38.900654911367894, -427.8973905010048, -3.3530124720448606, 20.550424266172534, -492.30691032041335, 63.20000000000046, -248.0987302935453, 45.19225102743493, -693.6028291873841, 86.49999999999885, 60.2000000000005, -78.27853576278716, -495.0038950075954, -354.94635784425407, -258.9592340704522, -179.02119766275104, -75.35789371271915, -77.54401164543496, 10.90099467688945, 46.76709732004865, -312.53694564548357, -541.8358177989206, 77.49894265961983, -181.81069059494382, -89.45578248577937, 6.854295017787176, -547.6189702992846, -460.86079859179756, -15.289568248860775, -98.81770173903314, -119.25502791490707, -238.45257740454176, 6.5277091274746, -354.2594375437681, -575.7882698521371, -73.97343176221477, 15.211255380067685, 117.27424415522383, 51.76668375489441, 35.600000000000236, 3.0742926158314714, -245.22665539575786, -5.905453723137574, -226.53143146578952, -53.224070078859214, -418.80851592474795, -13.15244859727347, -363.4825544989689, -2.2006432437578396, 236.89867972334312, 67.53999208143772, 1.348892941129601, -374.52674562869305, -402.1942525942701, -335.99075589996886, -31.341491875553896, 114.21986041230453, -318.1155039793007, -17.634842273812065, 335.5051510863539, 56.800000000000445, 246.83390206364183, -249.9727534189733, -425.28168445702846, -362.2071421572271, -288.57356311384336, 26.684118549446275, 67.33270362325415, -480.2898718985629, -562.4363239629424, -256.59035837459527, -488.1215820179698, -3.9737328496721425, 74.4498940905196, -22.332450683380223, 22.091256970824105, -351.2518394575739, 314.9368150148824, -107.59979210883387, -8.629159261478708, -22.953771869426262, -42.73493963267745, -18.072553297598134, 197.54670055650436, 1.63200925523536, 298.37757664493967, -2.683806105644138, -359.8239655342261, -111.30616245749735, 22.950907961140945, -143.32980553976404, -340.55576241264856, -216.36417799116361, -100.24656734378988], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-143.25092548696014, -14.763131545784839, -776.0663850281406, -427.9759679656871, 22.65184222889028, -24.912895061760807, -211.01058162444193, -176.26254589649284, -712.9975967558229, -868.245900457667, -25.29795515379415, -48.34144212455849, -147.66202197441655, -93.41628864893492, -592.2454087943304, -635.6358029180702, -153.7988066198412, -58.06671829933305, -131.17360538545793, -8.688633598741696, -746.8680589466895, -757.414939779316, 22.786826891230632, 5.001827398868007, -338.8301856125625, -409.94460340831773, -83.51096711266658, 5.131574557049474, -860.2471996313378, -940.4429077183393, 21.347292462314552, 38.27415898819591, -22.62101554916658, 35.441503818718886, -606.2746599840814, -737.4592641647673, -774.20383409024, -640.0136057178429, -664.5994225957852, -476.29899573582685, -369.1474035423982, -368.91506241162483, -380.6167305032719, -263.01103326577055, -123.592949074351, -159.5316052663538, -157.58991729818362, -237.91084049398918, -76.79555777743157, -68.5366168240339, -77.27311333089605, -34.264937427583774, -438.6197594118457, -600.4569121697878, -710.7637990697417, -738.2724119177559, -101.10887812222637, -87.89623792521868, -506.2402415113152, -324.91315843551325, -721.6813504977177, -931.5005568236671, -56.796521888907655, -60.30391536049798, -939.2811476193377, -815.9464455498864, -744.5360061528423, -774.8376206903456, -365.1512418156792, -308.22481923661485, -476.1251794067133, -417.297399573326, -622.0824076177786, -625.4862600695435, -325.303766924995, -364.84699563672353, -104.46952427994592, -151.16997906163812, -815.8379679183616, -707.8438443082903, -818.392991121038, -886.4899496361629, -145.61673830543137, -345.169408683852, -908.3789914416824, -625.8894446277102, -140.41970139418243, -305.41723994672367, -7.9215687530282795, -30.217294303622054, -113.02328209961362, 7.47336500006843, -128.20956318821825, -223.01004885054192, -657.4856496227825, -651.1228817068579, -13.02516814510179, -656.5378942766104, -847.4732334666514, -1135.9705036054615, -353.1513845944259, -276.786162608555, -552.7176555578371, -1118.4139578731438, -413.1788927696398, -693.171916979074, -800.5856871923171, -506.5355545824432, -761.5064432577818, -9.641094413476248, -364.5685436231326, -922.9260412897391, -74.85827946015412, -37.123415143331904, -39.04050877398406, -20.127571060754953, -672.3370154880687, -665.7240700049731, -702.5988805087446, -705.2222788541419, -526.6310982014951, -573.173573878392, -98.22462966549823, -176.8642388777502, -375.9617216550083, -6.455223113608774, -855.0593078509243, -560.5511191608379, -36.84929407248588, -302.3572181403854, -643.5060234924761, -1105.7219054045336, -2.159258039548867, -28.171998827691326, -1091.1343679919223, -362.94450490538645, -566.5867135644536, -456.71385586631357, -772.4639600198512, -915.943506638129, -849.0168896310961, -819.3553344263235, -488.7407563692914, -528.3526553515953, -12.67740175627386, -26.96559233503655, 37.426901363441495, -14.019473869887811, -773.7470125565969, -743.4540888791803, -986.8066090420767, -896.2741189364123, -623.2271260733244, -700.7795550742139, -739.8779874908638, -730.6312598344604, -288.375156060239, -115.94178527592948, -556.7443977554594, -336.92162383296113, -990.6130915216953, -843.3262324046898, -1240.0014776339972, -665.5711336933225, -1156.8575955989868, -1003.4054138117662, -929.563886241676, -100.23666859780538, -537.0532131885952, -504.3199552695297, -774.4216603431332, -615.6882543643378, -431.64328714658956, -273.6588038796495, -581.9777945921306, -992.8791584296288, -546.50675476361, -828.9403513745855, -776.2880667243528, -274.6926150814604, -158.65160660207775, -37.3893383579775, -639.7422240141933, -1067.5006869863087, -321.58390829003383, -544.6070982492727, -629.9013264468479, -999.9302286970913, -1090.8442770527915, -1073.22990261795, -100.53314185505947, -64.60805617756421, -353.8233982712944, -308.6425198003488, -485.85616053172345, -696.519846261797, -655.9649014002945, -566.9357819409095, -540.6221762258899, -465.92242274773173], "policy_predator_policy_reward": [41.520477589642894, 144.44395221600226, 794.5937146659867, 359.29585563429885, 53.92270281157118, 14.824323148659465, 37.2313739431733, 214.64729942080646, 9.749348512145742, 944.7021834002862, 73.31243727575719, 19.300495006549067, 145.11991348619273, 57.057742225790356, 640.763805141951, 159.22001606944426, 35.16112817392171, 173.3513842732078, 126.04103786654153, 34.371625383829716, 981.0001670416038, 30.97592136398805, 7.684141069117871, 27.7272046407836, 32.97125761725284, 467.7048011100819, 37.96285299194225, 85.60879059110853, 0.0, 1107.087278162293, 17.01104091241095, 9.867507637078866, 40.721015549166836, 6.658496181281359, 570.9895354306686, 694.465852955392, 904.1813183827943, 15.03222641769242, 767.8883726273392, 18.063687860018593, 44.91058553639407, 434.192646347177, 422.14386020399064, 42.462705902300435, 162.04162017383297, 45.72504045415272, 219.560715131996, 98.39603101474121, 43.8099229734153, 112.42324630493823, 37.71987451569813, 120.58527356283011, 681.6780965978304, 44.86162933831917, 75.8263501611446, 831.374043027432, 129.15892918349613, 137.3451295235694, 595.6084687415995, 53.73424061028574, 537.0547256222858, 1026.67139921332, 27.941917105444453, 96.01281516174802, 40.46994505488054, 1167.138677815059, 991.5601286397472, 66.95269961164249, 492.413265678168, 165.67322712526502, 205.6400363477059, 588.9648408932999, 260.24566246143587, 868.067977310979, 432.14083348505216, 19.5573516721246, 148.2536785518593, 113.91353391719787, 304.7891005850707, 864.6332740978132, 34.79749971723958, 1094.297171187823, 411.90444207017174, 4.90827315689653, 1047.6695785925442, 501.8101128569155, 246.92292594948714, 316.1882595466434, 42.288252507922245, 47.61729430362229, 128.52328209961277, 12.626634999931536, 208.392832870793, 145.90107178379876, 252.80333648709907, 810.5785394467831, 5.71971442196433, 657.9378942766105, 533.8836848573883, 1223.0286207489353, 251.24506644368353, 325.4684106804384, 28.625503632318136, 1223.6975938739151, 392.97864906679627, 700.219712084644, 904.6606761149891, 38.97801116080229, 17.569714242810807, 751.3771801846895, 559.2197111504614, 965.173553485753, 109.49087804452365, 70.03080864039994, 57.68693424276835, 2.830038533099971, 821.4461789264494, 142.08816093789903, 968.1686412431458, 37.45826552547093, 712.3088676236498, 51.50504855626852, 0.991275176134672, 242.75610149155975, 88.92507774895857, 407.71172743196297, 987.460893185511, 110.03402984694984, 0.0, 321.57166993905906, 971.635156982518, 1113.097923000847, 20.559258039548876, 66.57199882769154, 1089.8740388646609, 611.0387360962897, 6.727284003627409, 766.6005320081657, 149.33824839401493, 1113.7875338069368, 262.33388135796787, 1043.831200542225, 8.436871878502814, 720.0829767285402, 11.065673359705738, 55.261439281050436, 5.0916506412355576, 38.83362548846535, 95.5670537964082, 941.3441757408059, 123.88550669295586, 1196.758897322591, 912.1963861046811, 155.2199366682613, 982.3876653073545, 0.0, 297.80028924974545, 102.5429192367506, 601.0265383404508, 367.08937733848944, 936.2460360897509, 875.3608371532538, 1199.755196798029, 727.9086715001148, 1319.8962238883666, 489.11494606481074, 737.4621344159598, 607.2752354384041, 546.8054051705719, 386.96797117871824, 866.9099947824019, 514.5707606635909, 472.6920408092824, 209.65627834753073, 994.4663737888328, 537.6556396002495, 376.56493253232253, 980.8096203082748, 559.4779035472876, 689.0494788150306, 17.995602389193106, 179.67735182609695, 980.4623682406717, 1025.1581194047703, 445.47061364437235, 418.03658678928997, 295.50530872005635, 974.5022808896582, 745.6944733691802, 1307.0735438440652, 156.02302927321213, 32.06907672055208, 16.798557036690603, 502.3375554951882, 824.1674525440471, 17.65279183682451, 157.94454396664796, 848.5919613833925, 587.8748682053626, 318.42316342446895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.397849700623019, "mean_inference_ms": 4.276892909027826, "mean_action_processing_ms": 2.2902772516727024, "mean_env_wait_ms": 1.3384649386500433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006590604782104492, "StateBufferConnector_ms": 0.018367409706115723, "ViewRequirementAgentConnector_ms": 0.13915276527404785}, "num_episodes": 0, "episode_return_max": 335.5051510863539, "episode_return_min": -693.6028291873841, "episode_return_mean": -127.73555474670769, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 244.2115905998307, "num_env_steps_trained_throughput_per_sec": 244.2115905998307, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 33386.06, "restore_workers_time_ms": 0.023, "training_step_time_ms": 33385.281, "sample_time_ms": 1511.06, "learn_time_ms": 31842.07, "learn_throughput": 251.24, "synch_weights_time_ms": 25.214}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 12, "trial_id": "cd905_00000", "date": "2024-08-20_09-30-42", "timestamp": 1724126442, "time_this_iter_s": 32.802144050598145, "time_total_s": 401.1697087287903, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169e6d430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 401.1697087287903, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 51.75652173913043, "ram_util_percent": 82.6608695652174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8472635298376046, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 0.0001, "total_loss": 6.116193779688033, "policy_loss": -0.006523695735571285, "vf_loss": 6.1227050410376656, "vf_explained_var": 0.006090661836048913, "kl": 0.007968289524425624, "entropy": 1.6047279091108413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 7875.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.531210501551155, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 0.0001, "total_loss": 6.312724712159898, "policy_loss": -8.780617148630203e-06, "vf_loss": 6.31273324754503, "vf_explained_var": -9.794651515900142e-05, "kl": 0.00039084553091295256, "entropy": 1.331457825690981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 7875.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 612.4166491026488, "episode_reward_min": -562.4363239629424, "episode_reward_mean": 51.34158941155111, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1240.0014776339972, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 129.7999999999997, "predator_policy": 1319.8962238883666}, "policy_reward_mean": {"prey_policy": -317.6404987980659, "predator_policy": 343.31129350384145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.684118549446275, 67.33270362325415, -480.2898718985629, -562.4363239629424, -256.59035837459527, -488.1215820179698, -3.9737328496721425, 74.4498940905196, -22.332450683380223, 22.091256970824105, -351.2518394575739, 314.9368150148824, -107.59979210883387, -8.629159261478708, -22.953771869426262, -42.73493963267745, -18.072553297598134, 197.54670055650436, 1.63200925523536, 298.37757664493967, -2.683806105644138, -359.8239655342261, -111.30616245749735, 22.950907961140945, -143.32980553976404, -340.55576241264856, -216.36417799116361, -100.24656734378988, 438.3670464172283, 173.48888012607554, 230.70267961312362, 104.28383051143284, 55.51870536181101, 80.31750345142882, 75.79957972192518, 161.8842135366622, 138.93455009874845, -193.2154188560011, -241.25121590961183, 89.44866912681684, 101.79801397838581, 55.83629825811782, 196.69956448920124, 197.5463610875641, 310.401565557474, 612.4166491026488, 212.38476468189953, 36.200000000000294, 90.23508584519413, 77.32008239332413, 56.5551260926926, 137.64159441812433, 48.467444778588956, 40.91573226143499, 7.725904493114377, 180.8059779579308, 116.33831468930842, 67.19493863549468, 52.78296795420682, 356.6406322135068, 80.7703787038989, 262.3567861413234, -242.16364032559358, -0.823501984471255, 24.400000000000077, -96.43365239604799, 87.59489683440982, 167.19742167278827, 179.4103467976686, 251.10468885847948, 186.10204818433368, 239.92339707020525, 39.04275827866485, 47.900000000000375, -67.80831707718038, -1.770481256991546, 75.60000000000008, 109.85189191832045, 410.02259359738844, 51.600000000000435, 44.30108921288131, -211.28560704573084, 94.3415102640309, 92.37315429911447, 81.91355950346619, 21.22680297237739, 246.0471218198506, 44.675701436697736, 109.70789565226315, 58.95139486543525, 56.60000000000047, 37.00000000000026, 2.7263997050916338, 25.409394915867168, 566.4921704100293, 278.85576527872814, 50.94999462429399, 106.12738012281679, 40.63699727324061, 126.33919887230458], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.67740175627386, -26.96559233503655, 37.426901363441495, -14.019473869887811, -773.7470125565969, -743.4540888791803, -986.8066090420767, -896.2741189364123, -623.2271260733244, -700.7795550742139, -739.8779874908638, -730.6312598344604, -288.375156060239, -115.94178527592948, -556.7443977554594, -336.92162383296113, -990.6130915216953, -843.3262324046898, -1240.0014776339972, -665.5711336933225, -1156.8575955989868, -1003.4054138117662, -929.563886241676, -100.23666859780538, -537.0532131885952, -504.3199552695297, -774.4216603431332, -615.6882543643378, -431.64328714658956, -273.6588038796495, -581.9777945921306, -992.8791584296288, -546.50675476361, -828.9403513745855, -776.2880667243528, -274.6926150814604, -158.65160660207775, -37.3893383579775, -639.7422240141933, -1067.5006869863087, -321.58390829003383, -544.6070982492727, -629.9013264468479, -999.9302286970913, -1090.8442770527915, -1073.22990261795, -100.53314185505947, -64.60805617756421, -353.8233982712944, -308.6425198003488, -485.85616053172345, -696.519846261797, -655.9649014002945, -566.9357819409095, -540.6221762258899, -465.92242274773173, -864.3492479405373, -197.10025959082023, 9.264903644119817, -391.44682539713455, -54.69156722933623, -526.6600233547808, -26.682538218250457, -375.79905470668064, -42.23306106153607, -1.9828314404103202, 14.804586462654317, -39.21324230158206, 15.746200774766878, -286.90784897743214, -120.31527643514858, 19.404230497488165, -229.32165719244685, -396.20779452436574, -529.1322922948553, -387.316613897505, -578.3933652362642, -503.1549455248823, -295.5954672036031, 0.6446831699447731, -129.20001082486505, -41.83692996107459, -217.68710588613783, -133.69627436382294, -28.65064772319424, -383.5427772381249, -557.8028354396091, -272.7954593112299, -458.9204313115623, -94.44450140144012, 52.58527110437451, -829.9056217982892, -702.7013155185218, -22.275987258643994, 16.83146953150708, -391.865192666104, 26.96115135465127, 4.7046294691223505, -164.9668679928707, -70.80103218670843, -177.67816587741308, 46.30553433245192, -169.25277242645373, 12.346578342728998, -84.52427215927877, -154.29494862705496, -17.420910438279527, -22.22935178949796, -165.48770910821054, -21.54806825513146, 11.640464455443608, -171.16315127172726, -332.3619938504138, -270.80888377720976, -20.903446456421285, -310.21451017293583, -34.05284671350009, -89.12050425093838, -488.04966134443225, -250.04737670797377, 36.69968780012687, -210.01748887980435, -146.40247990669263, -307.9746998497727, -498.012195767455, -439.91511256506675, -462.6109384991903, -498.70057515679406, 18.836082900285394, -273.6552577787771, -758.0649649344022, -499.38764449649364, -838.6550396583641, -506.31523476123425, 1.874491363742336, -307.18659834368714, -646.7486742612971, -37.27127877564976, -500.40972255457535, -8.306717937064233, -440.9643151934562, -191.8107549367569, -776.5105683460175, -631.1088644668149, -149.67383786041614, -253.56847917420768, -8.8892761466307, 6.924268775019064, -266.15754239305994, -249.63625346249844, -91.42296241780741, -464.64894674151174, 32.561908911025505, -59.24271790404694, -163.7744091944748, -7.4558313293428355, -80.2574897782013, -498.46143503077406, 13.46463099741593, 7.740407314586761, -255.90416212173633, -23.72358050195401, -740.7118003586027, -663.2054883197397, -70.47912292969737, 11.458150730839128, -135.16900860748356, -444.14602356293733, -82.48286814065747, -427.58380296629866, -326.05178503675836, -331.2825357615218, 27.814521218105902, 129.7999999999997, -13.778458461346117, -56.854438238169934, -463.2363048566132, -65.98430835331655, -9.156670965585468, -360.699645273613, 15.546397074899671, 14.90523873149661, 9.113255316103565, -58.34890581949724, -400.89400534321607, -59.74466822399539, -17.059527162001142, -399.56910793773864, -894.5562605276655, -17.540886054443725, -52.15580068397329, -376.187642942919, 28.64540488666742, -138.00856028184123, -133.6860007415954, 67.74432240951322, 9.051707237107793, -217.3282560585254, -71.52297661170476, -105.0228458370652], "policy_predator_policy_reward": [11.065673359705738, 55.261439281050436, 5.0916506412355576, 38.83362548846535, 95.5670537964082, 941.3441757408059, 123.88550669295586, 1196.758897322591, 912.1963861046811, 155.2199366682613, 982.3876653073545, 0.0, 297.80028924974545, 102.5429192367506, 601.0265383404508, 367.08937733848944, 936.2460360897509, 875.3608371532538, 1199.755196798029, 727.9086715001148, 1319.8962238883666, 489.11494606481074, 737.4621344159598, 607.2752354384041, 546.8054051705719, 386.96797117871824, 866.9099947824019, 514.5707606635909, 472.6920408092824, 209.65627834753073, 994.4663737888328, 537.6556396002495, 376.56493253232253, 980.8096203082748, 559.4779035472876, 689.0494788150306, 17.995602389193106, 179.67735182609695, 980.4623682406717, 1025.1581194047703, 445.47061364437235, 418.03658678928997, 295.50530872005635, 974.5022808896582, 745.6944733691802, 1307.0735438440652, 156.02302927321213, 32.06907672055208, 16.798557036690603, 502.3375554951882, 824.1674525440471, 17.65279183682451, 157.94454396664796, 848.5919613833925, 587.8748682053626, 318.42316342446895, 768.6780961994739, 731.1384577491121, 367.2748090024784, 188.39599287661287, 513.9865219253047, 298.06774827193635, 372.395783817211, 134.3696396191545, 62.602508848095724, 37.13208901566165, 58.55097702779865, 46.175182262557506, 122.78686184710524, 224.1743660774854, 115.7820974317469, 147.0131620425754, 395.2668768698834, 369.1971249456779, 76.43807423674994, 646.7954130996092, 753.0513595645638, 87.245735286971, 142.5704128660743, 241.8290402944007, 156.5877150903411, 116.2472396739849, 283.2805549114608, 123.93912359661635, 293.9876055747321, 314.90538387578863, 662.3555774195088, 365.7890784188974, 431.25173707991667, 432.51476119056025, 652.5436980825523, 737.1933017140104, 653.2425728151175, 284.11949464394786, 261.21299703352037, 150.02072610107638, 4.841131880113862, 53.7281731413081, 33.821428164338094, 279.26655440856507, 186.31331935702664, 1.6144382806268198, 100.83184706488551, 193.71594143696433, 85.38150114487611, 201.90516442004585, 48.942956199442904, 31.62303828976974, 180.77748547148818, 13.984196384967476, 174.1414840544345, 166.18718071978006, 378.9197597814781, 340.5894325354551, 325.8319793231393, 72.4809159417129, 58.61146624585413, 117.34485267279048, 435.7004899278335, 659.037180338079, 84.76547109919372, 169.3227086843825, 347.0153540976387, 369.7186118001524, 24.821210784440513, 670.9424572224881, 619.6425954261476, 340.84541624536575, 88.24838927620233, 190.9707856022896, 884.3173800885531, 276.7015769462949, 964.0154194051661, 468.5497518488422, 168.65290510932655, 303.8566235434062, 180.0742705810078, 683.3560292536081, 335.83898910792954, 423.98214024218976, 364.53573106685513, 454.341387247692, 897.8562151126284, 749.6866147704122, 203.83900196693315, 238.44607334635606, 3.7308277873954823, 46.13417958421607, 46.549961238858046, 401.43551753952, 11.46224518377586, 542.8391827185529, 20.838091088974533, 81.4427179040461, 118.63056008161406, 162.45157236052424, 516.7234471607256, 472.01807124563607, 19.335369002584056, 11.059592685413207, 0.733905242712045, 323.1949265938596, 1016.053969085777, 176.57771254683547, 93.79998923797851, 59.56249322491063, 599.7203706903352, 71.96781577919958, 129.6038410991135, 462.3763895113094, 450.2215268948175, 228.33959687584053, 32.71994878849046, 55.712651813254936, 35.67845846134608, 79.63013967486707, 410.19897064512713, 228.72953821706474, 64.85358961264875, 363.95412149198563, 8.771455111868466, 17.376909081735217, 11.0867446838964, 75.14890581949669, 7.709124617841602, 455.65594865446144, 23.98343749087444, 418.0545925247326, 826.5969034436916, 651.992413548445, 350.8034162858235, 356.39579261979674, 9.704589737626339, 150.60856028184062, 138.74668504504496, 33.32237340985441, 239.7752132944959, 9.138332800162043, 163.1253326146876, 139.75968870638616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.284650925633303, "mean_inference_ms": 4.154663944911638, "mean_action_processing_ms": 2.1859821792339815, "mean_env_wait_ms": 1.3033866856486855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046950578689575195, "StateBufferConnector_ms": 0.014374613761901855, "ViewRequirementAgentConnector_ms": 0.11417055130004883}, "num_episodes": 72, "episode_return_max": 612.4166491026488, "episode_return_min": -562.4363239629424, "episode_return_mean": 51.34158941155111, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 244.9777881950364, "num_env_steps_trained_throughput_per_sec": 244.9777881950364, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 33333.355, "restore_workers_time_ms": 0.025, "training_step_time_ms": 33332.704, "sample_time_ms": 1483.832, "learn_time_ms": 31818.293, "learn_throughput": 251.428, "synch_weights_time_ms": 23.628}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 13, "trial_id": "cd905_00000", "date": "2024-08-20_09-31-15", "timestamp": 1724126475, "time_this_iter_s": 32.68929719924927, "time_total_s": 433.85900592803955, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f0dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 433.85900592803955, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 51.16382978723403, "ram_util_percent": 82.52340425531914}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0737171557805842, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 0.0001, "total_loss": 4.801385993806143, "policy_loss": -0.0019243908500934522, "vf_loss": 4.803308298095824, "vf_explained_var": 0.035006540919107106, "kl": 0.0013243785156363166, "entropy": 1.6019893228061615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4791337524555505, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.0001, "total_loss": 2.3032932614523265, "policy_loss": -0.0003012269927513978, "vf_loss": 2.303593325993371, "vf_explained_var": -1.2240239552089146e-05, "kl": 0.003008460681401572, "entropy": 1.3827128864469982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 612.4166491026488, "episode_reward_min": -562.4363239629424, "episode_reward_mean": 51.34158941155111, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1240.0014776339972, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 129.7999999999997, "predator_policy": 1319.8962238883666}, "policy_reward_mean": {"prey_policy": -317.6404987980659, "predator_policy": 343.31129350384145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.684118549446275, 67.33270362325415, -480.2898718985629, -562.4363239629424, -256.59035837459527, -488.1215820179698, -3.9737328496721425, 74.4498940905196, -22.332450683380223, 22.091256970824105, -351.2518394575739, 314.9368150148824, -107.59979210883387, -8.629159261478708, -22.953771869426262, -42.73493963267745, -18.072553297598134, 197.54670055650436, 1.63200925523536, 298.37757664493967, -2.683806105644138, -359.8239655342261, -111.30616245749735, 22.950907961140945, -143.32980553976404, -340.55576241264856, -216.36417799116361, -100.24656734378988, 438.3670464172283, 173.48888012607554, 230.70267961312362, 104.28383051143284, 55.51870536181101, 80.31750345142882, 75.79957972192518, 161.8842135366622, 138.93455009874845, -193.2154188560011, -241.25121590961183, 89.44866912681684, 101.79801397838581, 55.83629825811782, 196.69956448920124, 197.5463610875641, 310.401565557474, 612.4166491026488, 212.38476468189953, 36.200000000000294, 90.23508584519413, 77.32008239332413, 56.5551260926926, 137.64159441812433, 48.467444778588956, 40.91573226143499, 7.725904493114377, 180.8059779579308, 116.33831468930842, 67.19493863549468, 52.78296795420682, 356.6406322135068, 80.7703787038989, 262.3567861413234, -242.16364032559358, -0.823501984471255, 24.400000000000077, -96.43365239604799, 87.59489683440982, 167.19742167278827, 179.4103467976686, 251.10468885847948, 186.10204818433368, 239.92339707020525, 39.04275827866485, 47.900000000000375, -67.80831707718038, -1.770481256991546, 75.60000000000008, 109.85189191832045, 410.02259359738844, 51.600000000000435, 44.30108921288131, -211.28560704573084, 94.3415102640309, 92.37315429911447, 81.91355950346619, 21.22680297237739, 246.0471218198506, 44.675701436697736, 109.70789565226315, 58.95139486543525, 56.60000000000047, 37.00000000000026, 2.7263997050916338, 25.409394915867168, 566.4921704100293, 278.85576527872814, 50.94999462429399, 106.12738012281679, 40.63699727324061, 126.33919887230458], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.67740175627386, -26.96559233503655, 37.426901363441495, -14.019473869887811, -773.7470125565969, -743.4540888791803, -986.8066090420767, -896.2741189364123, -623.2271260733244, -700.7795550742139, -739.8779874908638, -730.6312598344604, -288.375156060239, -115.94178527592948, -556.7443977554594, -336.92162383296113, -990.6130915216953, -843.3262324046898, -1240.0014776339972, -665.5711336933225, -1156.8575955989868, -1003.4054138117662, -929.563886241676, -100.23666859780538, -537.0532131885952, -504.3199552695297, -774.4216603431332, -615.6882543643378, -431.64328714658956, -273.6588038796495, -581.9777945921306, -992.8791584296288, -546.50675476361, -828.9403513745855, -776.2880667243528, -274.6926150814604, -158.65160660207775, -37.3893383579775, -639.7422240141933, -1067.5006869863087, -321.58390829003383, -544.6070982492727, -629.9013264468479, -999.9302286970913, -1090.8442770527915, -1073.22990261795, -100.53314185505947, -64.60805617756421, -353.8233982712944, -308.6425198003488, -485.85616053172345, -696.519846261797, -655.9649014002945, -566.9357819409095, -540.6221762258899, -465.92242274773173, -864.3492479405373, -197.10025959082023, 9.264903644119817, -391.44682539713455, -54.69156722933623, -526.6600233547808, -26.682538218250457, -375.79905470668064, -42.23306106153607, -1.9828314404103202, 14.804586462654317, -39.21324230158206, 15.746200774766878, -286.90784897743214, -120.31527643514858, 19.404230497488165, -229.32165719244685, -396.20779452436574, -529.1322922948553, -387.316613897505, -578.3933652362642, -503.1549455248823, -295.5954672036031, 0.6446831699447731, -129.20001082486505, -41.83692996107459, -217.68710588613783, -133.69627436382294, -28.65064772319424, -383.5427772381249, -557.8028354396091, -272.7954593112299, -458.9204313115623, -94.44450140144012, 52.58527110437451, -829.9056217982892, -702.7013155185218, -22.275987258643994, 16.83146953150708, -391.865192666104, 26.96115135465127, 4.7046294691223505, -164.9668679928707, -70.80103218670843, -177.67816587741308, 46.30553433245192, -169.25277242645373, 12.346578342728998, -84.52427215927877, -154.29494862705496, -17.420910438279527, -22.22935178949796, -165.48770910821054, -21.54806825513146, 11.640464455443608, -171.16315127172726, -332.3619938504138, -270.80888377720976, -20.903446456421285, -310.21451017293583, -34.05284671350009, -89.12050425093838, -488.04966134443225, -250.04737670797377, 36.69968780012687, -210.01748887980435, -146.40247990669263, -307.9746998497727, -498.012195767455, -439.91511256506675, -462.6109384991903, -498.70057515679406, 18.836082900285394, -273.6552577787771, -758.0649649344022, -499.38764449649364, -838.6550396583641, -506.31523476123425, 1.874491363742336, -307.18659834368714, -646.7486742612971, -37.27127877564976, -500.40972255457535, -8.306717937064233, -440.9643151934562, -191.8107549367569, -776.5105683460175, -631.1088644668149, -149.67383786041614, -253.56847917420768, -8.8892761466307, 6.924268775019064, -266.15754239305994, -249.63625346249844, -91.42296241780741, -464.64894674151174, 32.561908911025505, -59.24271790404694, -163.7744091944748, -7.4558313293428355, -80.2574897782013, -498.46143503077406, 13.46463099741593, 7.740407314586761, -255.90416212173633, -23.72358050195401, -740.7118003586027, -663.2054883197397, -70.47912292969737, 11.458150730839128, -135.16900860748356, -444.14602356293733, -82.48286814065747, -427.58380296629866, -326.05178503675836, -331.2825357615218, 27.814521218105902, 129.7999999999997, -13.778458461346117, -56.854438238169934, -463.2363048566132, -65.98430835331655, -9.156670965585468, -360.699645273613, 15.546397074899671, 14.90523873149661, 9.113255316103565, -58.34890581949724, -400.89400534321607, -59.74466822399539, -17.059527162001142, -399.56910793773864, -894.5562605276655, -17.540886054443725, -52.15580068397329, -376.187642942919, 28.64540488666742, -138.00856028184123, -133.6860007415954, 67.74432240951322, 9.051707237107793, -217.3282560585254, -71.52297661170476, -105.0228458370652], "policy_predator_policy_reward": [11.065673359705738, 55.261439281050436, 5.0916506412355576, 38.83362548846535, 95.5670537964082, 941.3441757408059, 123.88550669295586, 1196.758897322591, 912.1963861046811, 155.2199366682613, 982.3876653073545, 0.0, 297.80028924974545, 102.5429192367506, 601.0265383404508, 367.08937733848944, 936.2460360897509, 875.3608371532538, 1199.755196798029, 727.9086715001148, 1319.8962238883666, 489.11494606481074, 737.4621344159598, 607.2752354384041, 546.8054051705719, 386.96797117871824, 866.9099947824019, 514.5707606635909, 472.6920408092824, 209.65627834753073, 994.4663737888328, 537.6556396002495, 376.56493253232253, 980.8096203082748, 559.4779035472876, 689.0494788150306, 17.995602389193106, 179.67735182609695, 980.4623682406717, 1025.1581194047703, 445.47061364437235, 418.03658678928997, 295.50530872005635, 974.5022808896582, 745.6944733691802, 1307.0735438440652, 156.02302927321213, 32.06907672055208, 16.798557036690603, 502.3375554951882, 824.1674525440471, 17.65279183682451, 157.94454396664796, 848.5919613833925, 587.8748682053626, 318.42316342446895, 768.6780961994739, 731.1384577491121, 367.2748090024784, 188.39599287661287, 513.9865219253047, 298.06774827193635, 372.395783817211, 134.3696396191545, 62.602508848095724, 37.13208901566165, 58.55097702779865, 46.175182262557506, 122.78686184710524, 224.1743660774854, 115.7820974317469, 147.0131620425754, 395.2668768698834, 369.1971249456779, 76.43807423674994, 646.7954130996092, 753.0513595645638, 87.245735286971, 142.5704128660743, 241.8290402944007, 156.5877150903411, 116.2472396739849, 283.2805549114608, 123.93912359661635, 293.9876055747321, 314.90538387578863, 662.3555774195088, 365.7890784188974, 431.25173707991667, 432.51476119056025, 652.5436980825523, 737.1933017140104, 653.2425728151175, 284.11949464394786, 261.21299703352037, 150.02072610107638, 4.841131880113862, 53.7281731413081, 33.821428164338094, 279.26655440856507, 186.31331935702664, 1.6144382806268198, 100.83184706488551, 193.71594143696433, 85.38150114487611, 201.90516442004585, 48.942956199442904, 31.62303828976974, 180.77748547148818, 13.984196384967476, 174.1414840544345, 166.18718071978006, 378.9197597814781, 340.5894325354551, 325.8319793231393, 72.4809159417129, 58.61146624585413, 117.34485267279048, 435.7004899278335, 659.037180338079, 84.76547109919372, 169.3227086843825, 347.0153540976387, 369.7186118001524, 24.821210784440513, 670.9424572224881, 619.6425954261476, 340.84541624536575, 88.24838927620233, 190.9707856022896, 884.3173800885531, 276.7015769462949, 964.0154194051661, 468.5497518488422, 168.65290510932655, 303.8566235434062, 180.0742705810078, 683.3560292536081, 335.83898910792954, 423.98214024218976, 364.53573106685513, 454.341387247692, 897.8562151126284, 749.6866147704122, 203.83900196693315, 238.44607334635606, 3.7308277873954823, 46.13417958421607, 46.549961238858046, 401.43551753952, 11.46224518377586, 542.8391827185529, 20.838091088974533, 81.4427179040461, 118.63056008161406, 162.45157236052424, 516.7234471607256, 472.01807124563607, 19.335369002584056, 11.059592685413207, 0.733905242712045, 323.1949265938596, 1016.053969085777, 176.57771254683547, 93.79998923797851, 59.56249322491063, 599.7203706903352, 71.96781577919958, 129.6038410991135, 462.3763895113094, 450.2215268948175, 228.33959687584053, 32.71994878849046, 55.712651813254936, 35.67845846134608, 79.63013967486707, 410.19897064512713, 228.72953821706474, 64.85358961264875, 363.95412149198563, 8.771455111868466, 17.376909081735217, 11.0867446838964, 75.14890581949669, 7.709124617841602, 455.65594865446144, 23.98343749087444, 418.0545925247326, 826.5969034436916, 651.992413548445, 350.8034162858235, 356.39579261979674, 9.704589737626339, 150.60856028184062, 138.74668504504496, 33.32237340985441, 239.7752132944959, 9.138332800162043, 163.1253326146876, 139.75968870638616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.284650925633303, "mean_inference_ms": 4.154663944911638, "mean_action_processing_ms": 2.1859821792339815, "mean_env_wait_ms": 1.3033866856486855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046950578689575195, "StateBufferConnector_ms": 0.014374613761901855, "ViewRequirementAgentConnector_ms": 0.11417055130004883}, "num_episodes": 0, "episode_return_max": 612.4166491026488, "episode_return_min": -562.4363239629424, "episode_return_mean": 51.34158941155111, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 246.745694229457, "num_env_steps_trained_throughput_per_sec": 246.745694229457, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 33203.636, "restore_workers_time_ms": 0.023, "training_step_time_ms": 33202.993, "sample_time_ms": 1449.985, "learn_time_ms": 31723.321, "learn_throughput": 252.18, "synch_weights_time_ms": 23.704}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 14, "trial_id": "cd905_00000", "date": "2024-08-20_09-31-47", "timestamp": 1724126507, "time_this_iter_s": 32.44521903991699, "time_total_s": 466.30422496795654, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f7e0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 466.30422496795654, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 49.14782608695651, "ram_util_percent": 82.7304347826087}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3882449724607997, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 0.0001, "total_loss": 4.219610756919497, "policy_loss": -0.0015093465165663806, "vf_loss": 4.221118919054667, "vf_explained_var": 0.051321621830501256, "kl": 0.001521030486404084, "entropy": 1.5895403462743003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 9135.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3580712411789194, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 0.0001, "total_loss": 2.024064238487728, "policy_loss": -0.0019273341468919718, "vf_loss": 2.0259905924872745, "vf_explained_var": 8.030533790588379e-05, "kl": 0.005016060193645986, "entropy": 1.45241997090597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 9135.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 566.4921704100293, "episode_reward_min": -211.28560704573084, "episode_reward_mean": 116.09348394537516, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -894.5562605276655, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.7, "predator_policy": 1016.053969085777}, "policy_reward_mean": {"prey_policy": -53.71733674712228, "predator_policy": 111.76407871980994}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.04275827866485, 47.900000000000375, -67.80831707718038, -1.770481256991546, 75.60000000000008, 109.85189191832045, 410.02259359738844, 51.600000000000435, 44.30108921288131, -211.28560704573084, 94.3415102640309, 92.37315429911447, 81.91355950346619, 21.22680297237739, 246.0471218198506, 44.675701436697736, 109.70789565226315, 58.95139486543525, 56.60000000000047, 37.00000000000026, 2.7263997050916338, 25.409394915867168, 566.4921704100293, 278.85576527872814, 50.94999462429399, 106.12738012281679, 40.63699727324061, 126.33919887230458, 159.76541236693924, 80.85706800625208, 153.56996760898633, 180.75741874838812, 63.02295636005184, 143.522141351708, 89.80000000000022, 166.2752971260633, 82.68707471679247, 201.8639666981788, 65.26575745065364, 182.7805474025905, 106.09999999999883, 111.69697944322692, 99.71622702995191, 103.19999999999861, 79.29999999999983, 236.06748243793857, 174.79999999999964, 143.3999999999991, 208.39999999999992, 187.26577799017292, 156.30946872469414, 55.276066329679075, 53.19672320742531, 165.61152741377123, 69.00000000000045, 83.0364760746139, 210.8999999999993, 116.08584787536802, 249.1999999999992, 154.399999999999, 97.79999999999856, 68.24315678253228, 164.2999999999992, 8.595662599844546, 7.337135775013282, 38.300000000000274, 111.49999999999861, 159.92466231090435, 133.29999999999959, 92.80000000000007, 282.1999999999998, 102.39999999999914, 98.29999999999885, 236.66898292589715, 137.4012692773888, 114.70655267557287, 213.96902624979757, 160.89999999999907, 116.62558748755438, 179.7999999999991, 50.70000000000034, 224.8583439760754, 52.80000000000045, 267.2200409927582, 120.3999999999992, 83.2197056158059, 35.861700074825634, 52.71162399915024, 63.200000000000216, 125.4987635788443, 105.03864280865596, 108.99999999999912, 178.91220911651317, 63.170866741299626, 261.5277338094389, 75.00000000000026, 37.30000000000027, 110.19999999999989, 81.49999999999986, 115.19817373324749], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-149.67383786041614, -253.56847917420768, -8.8892761466307, 6.924268775019064, -266.15754239305994, -249.63625346249844, -91.42296241780741, -464.64894674151174, 32.561908911025505, -59.24271790404694, -163.7744091944748, -7.4558313293428355, -80.2574897782013, -498.46143503077406, 13.46463099741593, 7.740407314586761, -255.90416212173633, -23.72358050195401, -740.7118003586027, -663.2054883197397, -70.47912292969737, 11.458150730839128, -135.16900860748356, -444.14602356293733, -82.48286814065747, -427.58380296629866, -326.05178503675836, -331.2825357615218, 27.814521218105902, 129.7999999999997, -13.778458461346117, -56.854438238169934, -463.2363048566132, -65.98430835331655, -9.156670965585468, -360.699645273613, 15.546397074899671, 14.90523873149661, 9.113255316103565, -58.34890581949724, -400.89400534321607, -59.74466822399539, -17.059527162001142, -399.56910793773864, -894.5562605276655, -17.540886054443725, -52.15580068397329, -376.187642942919, 28.64540488666742, -138.00856028184123, -133.6860007415954, 67.74432240951322, 9.051707237107793, -217.3282560585254, -71.52297661170476, -105.0228458370652, -4.676713811736375, 67.39455090182574, -29.809753939544088, 5.050819877066786, 34.14798029801061, -326.11943370804437, -259.6169259869233, 57.30755121608486, -19.293924349111002, 4.898925795089669, -264.2692036192748, 10.778390392555742, 57.417908978161186, 17.497615199962176, -27.469350020226486, 144.35730554322078, -49.2801309385932, -498.0357686329204, -90.25524749866469, -294.3793471109618, 24.500000000000092, -289.88739848554894, -281.4079008686756, 97.39999999999965, 53.284732194339405, -8.327969765334869, 11.715278006062142, -154.40870713501872, -262.6902162529743, -13.186456240882565, 16.96660329269544, 11.323786592098765, 0.36331377289605316, 27.631172167603886, 153.04342135943062, 64.3760832237839, 86.60915502974791, 32.05006827052539, 110.98323114719942, -1.6185038354909196, 104.88976821171426, 36.85513525637389, 28.81097066822963, 22.76578637162145, -150.15243765394885, 3.936972371996791, -82.72003570510145, -39.84513727771367, 41.60000000000018, -205.8658757530643, -78.44817164410655, 114.10477182175549, 20.000000000000014, 38.618371872435866, -322.6108668309953, 13.945728948753109, 193.7, -41.80950994752138, -157.58638490766572, -3.525532069798174, 98.66444696635537, 135.7419974628505, -55.18863955738353, 112.60548993874667, 71.32564026717458, 8.838828687874399, -166.8929862906992, -67.93231249267376, 21.80000000000004, 67.74107234169533, -17.7268714376437, -55.69898868117522, -20.15683722414198, -108.57626164530063, -8.365574253170989, 16.927203473455016, 87.4002405564527, 18.722908761946407, 90.71039431631249, 21.80000000000004, 55.10000000000003, 75.13995183433079, 61.87928958748316, 18.2318090418474, 109.96544591825001, 163.99999999999977, 72.68583931425586, -10.214533490877294, -2.8703417952373744, 36.434272358025254, 61.40000000000021, -169.88677049404123, -108.41559567138805, -28.864155818222358, 7.858029489829658, 74.53184626344473, 118.30287934682922, 13.892450906271593, -71.43331378207525, 140.365679906164, -42.73564819083941, 46.66885660095146, 11.94494893133524, 151.26262110363092, 24.40114962280541, 1.8879115995685858, 74.89999999999978, -59.72600034855601, 20.000000000000014, 25.681597336433995, 134.14510384977177, 113.38811502006875, 18.701998630764727, 72.65403817475219, -82.8193063741837, -7.704970704637956, -0.36110976481406387, 9.985569581027697, -37.563250992756146, 5.324945123292721, -18.26239257182519, 20.000000000000014, -89.69590932274696, 9.616800709944512, 59.62131390644958, 14.964784157041429, 32.178292220487016, 65.6418709006598, -268.8739346500496, -415.85953876636205, -10.123453625806716, 16.169183193652312, 177.49999999999991, 74.7799735401379, -68.80513938232362, 33.30619685772272, 13.436135405085313, -17.68524302742027, 39.706587385355, -9.123145000735025, 50.150014796311304, -55.99373745493504, -173.03071567533595, 6.501525397061951], "policy_predator_policy_reward": [203.83900196693315, 238.44607334635606, 3.7308277873954823, 46.13417958421607, 46.549961238858046, 401.43551753952, 11.46224518377586, 542.8391827185529, 20.838091088974533, 81.4427179040461, 118.63056008161406, 162.45157236052424, 516.7234471607256, 472.01807124563607, 19.335369002584056, 11.059592685413207, 0.733905242712045, 323.1949265938596, 1016.053969085777, 176.57771254683547, 93.79998923797851, 59.56249322491063, 599.7203706903352, 71.96781577919958, 129.6038410991135, 462.3763895113094, 450.2215268948175, 228.33959687584053, 32.71994878849046, 55.712651813254936, 35.67845846134608, 79.63013967486707, 410.19897064512713, 228.72953821706474, 64.85358961264875, 363.95412149198563, 8.771455111868466, 17.376909081735217, 11.0867446838964, 75.14890581949669, 7.709124617841602, 455.65594865446144, 23.98343749087444, 418.0545925247326, 826.5969034436916, 651.992413548445, 350.8034162858235, 356.39579261979674, 9.704589737626339, 150.60856028184062, 138.74668504504496, 33.32237340985441, 239.7752132944959, 9.138332800162043, 163.1253326146876, 139.75968870638616, 46.311707867803136, 50.73586740904719, 46.509753939544325, 59.106248129185296, 338.02003758515633, 107.52138343386568, 250.70424743349932, 132.36254608572938, 54.56070675843778, 22.857248155635297, 192.50363367038167, 204.50932090804613, 12.582091021838936, 2.302384800037807, 46.3404122249954, 3.0469293780745077, 116.38970745973442, 513.6132668285724, 307.38389952481015, 279.1146617829956, 87.68232087849245, 242.97083505771013, 160.45499820782572, 206.3334500634406, 33.81526780566073, 27.327969765335002, 50.528653149152376, 203.8617554230307, 215.11426677216596, 160.4786327516455, 33.833396707304544, 41.07621340790125, 32.540976104358435, 18.764537955141645, 3.1949518984625507, 15.45302595626226, 49.690844970252115, 6.44993172947463, 13.21676885280027, 20.818503835490947, 12.910231788285662, 53.74486474362623, 104.8890293317704, 30.799991618552347, 153.23780294081712, 149.2871310658295, 113.59592977803385, 64.24530953445986, 3.0144919384706093, 214.4481070220182, 12.474045786112729, 117.48088145000925, 0.0, 10.381628127564321, 188.88465006443033, 202.81696389242688, 0.0, 59.00950994752162, 242.13548035057931, 35.062284502252396, 11.514929825064254, 3.278625745729073, 75.08863955738326, 21.894510061253058, 7.374359732825087, 10.26117131212557, 202.39298629069884, 100.67546927520503, 0.0, 74.75892765830461, 0.0, 82.02152271866328, 135.24419260255897, 0.8260420418963417, 26.965574253171116, 2.77279652654496, 4.199759443546633, 1.1770912380535936, 9.466482925748132, 37.947785068844325, 0.0, 3.0600481656691594, 7.720710412516829, 4.968190958152583, 8.234554081750005, 0.0, 12.014160685743906, 27.91453349087744, 21.870341795237415, 42.8657276419749, 195.391596929828, 149.76415649011102, 152.0063993421178, 122.67462142488021, 15.436977789643443, 16.87969913265558, 75.54675566013215, 6.226940336564584, 90.93331378207439, 1.0343200938357187, 32.17936215309585, 80.51301692434691, 7.355051068664733, 9.237378896368883, 0.8988503771946861, 23.512088400431487, 59.86137276776271, 149.8229715568692, 0.0, 7.118402663566118, 14.687292876004594, 4.999529246911687, 12.698001369235259, 16.345961825247496, 116.1143370789777, 57.62964561564985, 0.0, 26.237240258611706, 83.19610650086165, 1.7538233677517125, 61.46239257182537, 0.0, 171.76215519624753, 33.815716995399754, 18.554000119490695, 11.898544625675425, 2.0217077795131067, 9.158129099340162, 426.52018559337506, 437.12549693955424, 40.45322084721963, 16.67191632623432, 5.725358491199474, 3.5224017781010053, 6.856435660516086, 103.64250686408415, 6.0638645949146515, 35.48524302742051, 38.893412614645, 40.723145000735165, 0.7642482237104764, 86.57947443491294, 157.87571289699733, 123.85165111452449]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.280857183529418, "mean_inference_ms": 4.108507482815891, "mean_action_processing_ms": 2.124831945302772, "mean_env_wait_ms": 1.2959730596127625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004484891891479492, "StateBufferConnector_ms": 0.013614892959594727, "ViewRequirementAgentConnector_ms": 0.1290513277053833}, "num_episodes": 72, "episode_return_max": 566.4921704100293, "episode_return_min": -211.28560704573084, "episode_return_mean": 116.09348394537516, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 237.71665276591673, "num_env_steps_trained_throughput_per_sec": 237.71665276591673, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 33236.049, "restore_workers_time_ms": 0.031, "training_step_time_ms": 33235.45, "sample_time_ms": 1485.644, "learn_time_ms": 31720.336, "learn_throughput": 252.204, "synch_weights_time_ms": 23.36}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 15, "trial_id": "cd905_00000", "date": "2024-08-20_09-32-21", "timestamp": 1724126541, "time_this_iter_s": 33.68631029129028, "time_total_s": 499.9905352592468, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f758b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 499.9905352592468, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 44.275, "ram_util_percent": 82.82708333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7047611812159182, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.0001, "total_loss": 1.676617047332582, "policy_loss": -0.0018258139221293348, "vf_loss": 1.678441575784532, "vf_explained_var": 0.1525270917112865, "kl": 0.003284102350504298, "entropy": 1.5896511058958749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2562774322660906, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 0.0001, "total_loss": 0.21437463380751157, "policy_loss": -0.0009442704204942972, "vf_loss": 0.21531837083813216, "vf_explained_var": -7.316451224069747e-05, "kl": 0.0027258437523678077, "entropy": 1.4445504765661936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 566.4921704100293, "episode_reward_min": -211.28560704573084, "episode_reward_mean": 116.09348394537516, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -894.5562605276655, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.7, "predator_policy": 1016.053969085777}, "policy_reward_mean": {"prey_policy": -53.71733674712228, "predator_policy": 111.76407871980994}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.04275827866485, 47.900000000000375, -67.80831707718038, -1.770481256991546, 75.60000000000008, 109.85189191832045, 410.02259359738844, 51.600000000000435, 44.30108921288131, -211.28560704573084, 94.3415102640309, 92.37315429911447, 81.91355950346619, 21.22680297237739, 246.0471218198506, 44.675701436697736, 109.70789565226315, 58.95139486543525, 56.60000000000047, 37.00000000000026, 2.7263997050916338, 25.409394915867168, 566.4921704100293, 278.85576527872814, 50.94999462429399, 106.12738012281679, 40.63699727324061, 126.33919887230458, 159.76541236693924, 80.85706800625208, 153.56996760898633, 180.75741874838812, 63.02295636005184, 143.522141351708, 89.80000000000022, 166.2752971260633, 82.68707471679247, 201.8639666981788, 65.26575745065364, 182.7805474025905, 106.09999999999883, 111.69697944322692, 99.71622702995191, 103.19999999999861, 79.29999999999983, 236.06748243793857, 174.79999999999964, 143.3999999999991, 208.39999999999992, 187.26577799017292, 156.30946872469414, 55.276066329679075, 53.19672320742531, 165.61152741377123, 69.00000000000045, 83.0364760746139, 210.8999999999993, 116.08584787536802, 249.1999999999992, 154.399999999999, 97.79999999999856, 68.24315678253228, 164.2999999999992, 8.595662599844546, 7.337135775013282, 38.300000000000274, 111.49999999999861, 159.92466231090435, 133.29999999999959, 92.80000000000007, 282.1999999999998, 102.39999999999914, 98.29999999999885, 236.66898292589715, 137.4012692773888, 114.70655267557287, 213.96902624979757, 160.89999999999907, 116.62558748755438, 179.7999999999991, 50.70000000000034, 224.8583439760754, 52.80000000000045, 267.2200409927582, 120.3999999999992, 83.2197056158059, 35.861700074825634, 52.71162399915024, 63.200000000000216, 125.4987635788443, 105.03864280865596, 108.99999999999912, 178.91220911651317, 63.170866741299626, 261.5277338094389, 75.00000000000026, 37.30000000000027, 110.19999999999989, 81.49999999999986, 115.19817373324749], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-149.67383786041614, -253.56847917420768, -8.8892761466307, 6.924268775019064, -266.15754239305994, -249.63625346249844, -91.42296241780741, -464.64894674151174, 32.561908911025505, -59.24271790404694, -163.7744091944748, -7.4558313293428355, -80.2574897782013, -498.46143503077406, 13.46463099741593, 7.740407314586761, -255.90416212173633, -23.72358050195401, -740.7118003586027, -663.2054883197397, -70.47912292969737, 11.458150730839128, -135.16900860748356, -444.14602356293733, -82.48286814065747, -427.58380296629866, -326.05178503675836, -331.2825357615218, 27.814521218105902, 129.7999999999997, -13.778458461346117, -56.854438238169934, -463.2363048566132, -65.98430835331655, -9.156670965585468, -360.699645273613, 15.546397074899671, 14.90523873149661, 9.113255316103565, -58.34890581949724, -400.89400534321607, -59.74466822399539, -17.059527162001142, -399.56910793773864, -894.5562605276655, -17.540886054443725, -52.15580068397329, -376.187642942919, 28.64540488666742, -138.00856028184123, -133.6860007415954, 67.74432240951322, 9.051707237107793, -217.3282560585254, -71.52297661170476, -105.0228458370652, -4.676713811736375, 67.39455090182574, -29.809753939544088, 5.050819877066786, 34.14798029801061, -326.11943370804437, -259.6169259869233, 57.30755121608486, -19.293924349111002, 4.898925795089669, -264.2692036192748, 10.778390392555742, 57.417908978161186, 17.497615199962176, -27.469350020226486, 144.35730554322078, -49.2801309385932, -498.0357686329204, -90.25524749866469, -294.3793471109618, 24.500000000000092, -289.88739848554894, -281.4079008686756, 97.39999999999965, 53.284732194339405, -8.327969765334869, 11.715278006062142, -154.40870713501872, -262.6902162529743, -13.186456240882565, 16.96660329269544, 11.323786592098765, 0.36331377289605316, 27.631172167603886, 153.04342135943062, 64.3760832237839, 86.60915502974791, 32.05006827052539, 110.98323114719942, -1.6185038354909196, 104.88976821171426, 36.85513525637389, 28.81097066822963, 22.76578637162145, -150.15243765394885, 3.936972371996791, -82.72003570510145, -39.84513727771367, 41.60000000000018, -205.8658757530643, -78.44817164410655, 114.10477182175549, 20.000000000000014, 38.618371872435866, -322.6108668309953, 13.945728948753109, 193.7, -41.80950994752138, -157.58638490766572, -3.525532069798174, 98.66444696635537, 135.7419974628505, -55.18863955738353, 112.60548993874667, 71.32564026717458, 8.838828687874399, -166.8929862906992, -67.93231249267376, 21.80000000000004, 67.74107234169533, -17.7268714376437, -55.69898868117522, -20.15683722414198, -108.57626164530063, -8.365574253170989, 16.927203473455016, 87.4002405564527, 18.722908761946407, 90.71039431631249, 21.80000000000004, 55.10000000000003, 75.13995183433079, 61.87928958748316, 18.2318090418474, 109.96544591825001, 163.99999999999977, 72.68583931425586, -10.214533490877294, -2.8703417952373744, 36.434272358025254, 61.40000000000021, -169.88677049404123, -108.41559567138805, -28.864155818222358, 7.858029489829658, 74.53184626344473, 118.30287934682922, 13.892450906271593, -71.43331378207525, 140.365679906164, -42.73564819083941, 46.66885660095146, 11.94494893133524, 151.26262110363092, 24.40114962280541, 1.8879115995685858, 74.89999999999978, -59.72600034855601, 20.000000000000014, 25.681597336433995, 134.14510384977177, 113.38811502006875, 18.701998630764727, 72.65403817475219, -82.8193063741837, -7.704970704637956, -0.36110976481406387, 9.985569581027697, -37.563250992756146, 5.324945123292721, -18.26239257182519, 20.000000000000014, -89.69590932274696, 9.616800709944512, 59.62131390644958, 14.964784157041429, 32.178292220487016, 65.6418709006598, -268.8739346500496, -415.85953876636205, -10.123453625806716, 16.169183193652312, 177.49999999999991, 74.7799735401379, -68.80513938232362, 33.30619685772272, 13.436135405085313, -17.68524302742027, 39.706587385355, -9.123145000735025, 50.150014796311304, -55.99373745493504, -173.03071567533595, 6.501525397061951], "policy_predator_policy_reward": [203.83900196693315, 238.44607334635606, 3.7308277873954823, 46.13417958421607, 46.549961238858046, 401.43551753952, 11.46224518377586, 542.8391827185529, 20.838091088974533, 81.4427179040461, 118.63056008161406, 162.45157236052424, 516.7234471607256, 472.01807124563607, 19.335369002584056, 11.059592685413207, 0.733905242712045, 323.1949265938596, 1016.053969085777, 176.57771254683547, 93.79998923797851, 59.56249322491063, 599.7203706903352, 71.96781577919958, 129.6038410991135, 462.3763895113094, 450.2215268948175, 228.33959687584053, 32.71994878849046, 55.712651813254936, 35.67845846134608, 79.63013967486707, 410.19897064512713, 228.72953821706474, 64.85358961264875, 363.95412149198563, 8.771455111868466, 17.376909081735217, 11.0867446838964, 75.14890581949669, 7.709124617841602, 455.65594865446144, 23.98343749087444, 418.0545925247326, 826.5969034436916, 651.992413548445, 350.8034162858235, 356.39579261979674, 9.704589737626339, 150.60856028184062, 138.74668504504496, 33.32237340985441, 239.7752132944959, 9.138332800162043, 163.1253326146876, 139.75968870638616, 46.311707867803136, 50.73586740904719, 46.509753939544325, 59.106248129185296, 338.02003758515633, 107.52138343386568, 250.70424743349932, 132.36254608572938, 54.56070675843778, 22.857248155635297, 192.50363367038167, 204.50932090804613, 12.582091021838936, 2.302384800037807, 46.3404122249954, 3.0469293780745077, 116.38970745973442, 513.6132668285724, 307.38389952481015, 279.1146617829956, 87.68232087849245, 242.97083505771013, 160.45499820782572, 206.3334500634406, 33.81526780566073, 27.327969765335002, 50.528653149152376, 203.8617554230307, 215.11426677216596, 160.4786327516455, 33.833396707304544, 41.07621340790125, 32.540976104358435, 18.764537955141645, 3.1949518984625507, 15.45302595626226, 49.690844970252115, 6.44993172947463, 13.21676885280027, 20.818503835490947, 12.910231788285662, 53.74486474362623, 104.8890293317704, 30.799991618552347, 153.23780294081712, 149.2871310658295, 113.59592977803385, 64.24530953445986, 3.0144919384706093, 214.4481070220182, 12.474045786112729, 117.48088145000925, 0.0, 10.381628127564321, 188.88465006443033, 202.81696389242688, 0.0, 59.00950994752162, 242.13548035057931, 35.062284502252396, 11.514929825064254, 3.278625745729073, 75.08863955738326, 21.894510061253058, 7.374359732825087, 10.26117131212557, 202.39298629069884, 100.67546927520503, 0.0, 74.75892765830461, 0.0, 82.02152271866328, 135.24419260255897, 0.8260420418963417, 26.965574253171116, 2.77279652654496, 4.199759443546633, 1.1770912380535936, 9.466482925748132, 37.947785068844325, 0.0, 3.0600481656691594, 7.720710412516829, 4.968190958152583, 8.234554081750005, 0.0, 12.014160685743906, 27.91453349087744, 21.870341795237415, 42.8657276419749, 195.391596929828, 149.76415649011102, 152.0063993421178, 122.67462142488021, 15.436977789643443, 16.87969913265558, 75.54675566013215, 6.226940336564584, 90.93331378207439, 1.0343200938357187, 32.17936215309585, 80.51301692434691, 7.355051068664733, 9.237378896368883, 0.8988503771946861, 23.512088400431487, 59.86137276776271, 149.8229715568692, 0.0, 7.118402663566118, 14.687292876004594, 4.999529246911687, 12.698001369235259, 16.345961825247496, 116.1143370789777, 57.62964561564985, 0.0, 26.237240258611706, 83.19610650086165, 1.7538233677517125, 61.46239257182537, 0.0, 171.76215519624753, 33.815716995399754, 18.554000119490695, 11.898544625675425, 2.0217077795131067, 9.158129099340162, 426.52018559337506, 437.12549693955424, 40.45322084721963, 16.67191632623432, 5.725358491199474, 3.5224017781010053, 6.856435660516086, 103.64250686408415, 6.0638645949146515, 35.48524302742051, 38.893412614645, 40.723145000735165, 0.7642482237104764, 86.57947443491294, 157.87571289699733, 123.85165111452449]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.280857183529418, "mean_inference_ms": 4.108507482815891, "mean_action_processing_ms": 2.124831945302772, "mean_env_wait_ms": 1.2959730596127625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004484891891479492, "StateBufferConnector_ms": 0.013614892959594727, "ViewRequirementAgentConnector_ms": 0.1290513277053833}, "num_episodes": 0, "episode_return_max": 566.4921704100293, "episode_return_min": -211.28560704573084, "episode_return_mean": 116.09348394537516, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 246.9057160637893, "num_env_steps_trained_throughput_per_sec": 246.9057160637893, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 33116.372, "restore_workers_time_ms": 0.031, "training_step_time_ms": 33115.779, "sample_time_ms": 1459.71, "learn_time_ms": 31625.592, "learn_throughput": 252.96, "synch_weights_time_ms": 24.29}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 16, "trial_id": "cd905_00000", "date": "2024-08-20_09-32-53", "timestamp": 1724126573, "time_this_iter_s": 32.444217920303345, "time_total_s": 532.4347531795502, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f6af70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 532.4347531795502, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 35.49782608695652, "ram_util_percent": 83.10652173913044}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.408176552386038, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 0.0001, "total_loss": 4.361386928861103, "policy_loss": -0.0034127483687674005, "vf_loss": 4.3647986086588055, "vf_explained_var": 0.03686452498511662, "kl": 0.0055236544244060435, "entropy": 1.5763034332366217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3508534452094445, "cur_kl_coeff": 9.765624999999999e-05, "cur_lr": 0.0001, "total_loss": 2.359311662779914, "policy_loss": -0.004428477243461188, "vf_loss": 2.363739489752149, "vf_explained_var": 0.0003854107289087205, "kl": 0.006770195118042466, "entropy": 1.465596299890488, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 267.2200409927582, "episode_reward_min": -20.499279297605298, "episode_reward_mean": 95.80091971433903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -415.85953876636205, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 177.49999999999991, "predator_policy": 437.12549693955424}, "policy_reward_mean": {"prey_policy": 5.371638942994704, "predator_policy": 42.528820914174894}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.29999999999885, 236.66898292589715, 137.4012692773888, 114.70655267557287, 213.96902624979757, 160.89999999999907, 116.62558748755438, 179.7999999999991, 50.70000000000034, 224.8583439760754, 52.80000000000045, 267.2200409927582, 120.3999999999992, 83.2197056158059, 35.861700074825634, 52.71162399915024, 63.200000000000216, 125.4987635788443, 105.03864280865596, 108.99999999999912, 178.91220911651317, 63.170866741299626, 261.5277338094389, 75.00000000000026, 37.30000000000027, 110.19999999999989, 81.49999999999986, 115.19817373324749, 39.40000000000029, 72.9999999999997, 66.60000000000028, 37.90000000000027, 216.89999999999887, 106.79999999999883, 34.200000000000216, 79.29999999999957, 59.4000000000003, 160.19999999999936, 71.39307954441941, 82.6999999999991, 91.49999999999875, 135.9999999999996, 47.88144712502542, 149.18977193696026, 38.00000000000027, 64.30000000000017, 227.09084951049405, 83.899999999999, 80.1999999999993, 40.7962967799794, 38.50000000000028, 219.72927254408157, 90.59999999999872, 28.517029978918305, 54.50000000000042, 48.300000000000445, 124.09999999999917, 204.59999999999891, -20.499279297605298, 62.90000000000049, 47.00000000000041, 130.14339713610795, 69.62537012095085, 45.30000000000038, 113.89999999999972, 53.60000000000027, 63.80000000000049, 76.46888467175874, 39.9000000000003, 183.93479345017016, 147.79999999999868, 158.4118546503652, 54.48784578504814, 61.30000000000022, 106.12463488097652, 101.5999999999988, 33.70000000000021, 39.40000000000029, 114.63427089120265, 48.400000000000404, 39.100000000000286, 100.49999999999946, 88.09999999999876, 49.110996790620916, 173.59999999999886, 134.49999999999918, 163.4881132735271, 100.79999999999882, 62.50000000000041, 116.3999999999993, 41.71793292158753, 69.00000000000003, 33.53326786143924, 61.80000000000042, 81.5999999999994, 67.90000000000019, 62.20000000000031, 50.622917815064405, 47.10000000000043, 37.40000000000026], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.8703417952373744, 36.434272358025254, 61.40000000000021, -169.88677049404123, -108.41559567138805, -28.864155818222358, 7.858029489829658, 74.53184626344473, 118.30287934682922, 13.892450906271593, -71.43331378207525, 140.365679906164, -42.73564819083941, 46.66885660095146, 11.94494893133524, 151.26262110363092, 24.40114962280541, 1.8879115995685858, 74.89999999999978, -59.72600034855601, 20.000000000000014, 25.681597336433995, 134.14510384977177, 113.38811502006875, 18.701998630764727, 72.65403817475219, -82.8193063741837, -7.704970704637956, -0.36110976481406387, 9.985569581027697, -37.563250992756146, 5.324945123292721, -18.26239257182519, 20.000000000000014, -89.69590932274696, 9.616800709944512, 59.62131390644958, 14.964784157041429, 32.178292220487016, 65.6418709006598, -268.8739346500496, -415.85953876636205, -10.123453625806716, 16.169183193652312, 177.49999999999991, 74.7799735401379, -68.80513938232362, 33.30619685772272, 13.436135405085313, -17.68524302742027, 39.706587385355, -9.123145000735025, 50.150014796311304, -55.99373745493504, -173.03071567533595, 6.501525397061951, 18.674671793299648, 13.431134453664601, 13.979683749803574, -1.0060182392789168, -5.073259790454038, 34.07524277363958, -4.900579271116728, 8.950467186706033, 124.39999999999952, 87.86962396188991, 15.618757591421192, 23.600000000000076, -49.58241743580398, 13.134922956846212, 24.03745233882608, -42.56470833173929, 21.278952260709357, 18.88912835456422, -26.565547097200607, 69.18441574982339, 30.102471123463904, -79.85241667561849, 18.831977917137884, 13.900052995171679, 20.000000000000014, 30.387201967133436, 13.952409627583362, 26.618673161807052, 22.700000000000063, -26.55224724924171, 41.63834993684002, -82.00628438721276, 9.839685462102917, -3.567006451459189, 20.000000000000014, -47.68518981847029, 71.29999999999964, -218.6952906359178, 18.837722677765722, 40.637871644232874, 20.000000000000014, 40.69450048434519, 14.984622117322939, 3.922551344552495, -17.457385306526916, 20.000000000000014, 81.79630809169555, 94.67830968039405, 14.267262314114635, 55.29431856123616, -25.4962663870592, -49.59653884305689, 9.502412818849939, 24.319201906411802, -5.452713248992108, 16.393494376329524, 85.69999999999965, -74.41244924795502, 110.06547345339719, 76.26190874604721, -65.53200461882706, -75.48091277919151, 37.677531493768, 20.000000000000014, -8.255649427754634, 26.242160499629165, 81.85613258170267, -24.232194377358823, -65.35767644333738, 36.35246924705471, 24.512885530913334, 20.000000000000014, 23.352323789056136, 19.57313865850225, 20.000000000000014, 24.753467252041844, 2.2499828914782247, 39.81633758923626, -85.050561539445, -24.309977076265163, 20.000000000000014, 18.760035321385978, 49.87948359805656, 71.85695007018312, 20.682602515521445, 105.49999999999943, -169.76634326308428, 70.39999999999975, 10.26818114765302, 6.171654438822266, 15.48223466227457, -101.79695438970666, 20.000000000000014, -80.60452311112215, 21.904124279086478, 0.36226982497457927, 2.5918354890148643, -94.66383072269302, 13.896989161290715, 19.080200076126474, -28.202694854265886, -187.88390648367286, 20.000000000000014, 22.67702435721295, 6.922146298673923, 17.194790710565652, 60.573910214066515, 18.859319181371777, 18.83766224378005, 55.12962248703357, -6.185325550505757, 4.529312096365468, 117.52745449232332, 27.628915352319044, 111.5035755204647, 10.275316565735555, 38.000000000000185, -50.845056305291855, -3.3219616738516486, 63.39041304462692, 26.345787901602534, -22.121295447217626, 28.25364210343972, 14.50688558977567, -51.46511936393796, 17.410097864293608, 7.473091181229183, 24.47317629580493, 6.708531222265783, -29.06510817962998, -13.322739875801533, -6.678250389596151, -100.84404857424877, 4.261313113781277, 28.54826632020817, 15.704509593066847, 22.575182327486036, -32.40601135928014, 22.982928560629116, -29.05952932709529, -35.641528420162025, 24.16521109489593, -18.707723930114504, -5.308293831001235], "policy_predator_policy_reward": [21.870341795237415, 42.8657276419749, 195.391596929828, 149.76415649011102, 152.0063993421178, 122.67462142488021, 15.436977789643443, 16.87969913265558, 75.54675566013215, 6.226940336564584, 90.93331378207439, 1.0343200938357187, 32.17936215309585, 80.51301692434691, 7.355051068664733, 9.237378896368883, 0.8988503771946861, 23.512088400431487, 59.86137276776271, 149.8229715568692, 0.0, 7.118402663566118, 14.687292876004594, 4.999529246911687, 12.698001369235259, 16.345961825247496, 116.1143370789777, 57.62964561564985, 0.0, 26.237240258611706, 83.19610650086165, 1.7538233677517125, 61.46239257182537, 0.0, 171.76215519624753, 33.815716995399754, 18.554000119490695, 11.898544625675425, 2.0217077795131067, 9.158129099340162, 426.52018559337506, 437.12549693955424, 40.45322084721963, 16.67191632623432, 5.725358491199474, 3.5224017781010053, 6.856435660516086, 103.64250686408415, 6.0638645949146515, 35.48524302742051, 38.893412614645, 40.723145000735165, 0.7642482237104764, 86.57947443491294, 157.87571289699733, 123.85165111452449, 1.2253282067003508, 6.068865546335364, 56.06162929758195, 3.9647051918933385, 22.973259790454094, 14.624757226360638, 23.400579271116786, 10.449532813293931, 0.0, 4.630376038109509, 67.58124240857875, 0.0, 45.71499379694384, 24.9325006820141, 25.060314115462155, 72.76694187745137, 18.22104773929072, 1.0108716454357782, 44.26554709720086, 73.31558425017654, 8.222968102738635, 112.9200569938345, 1.8680220828621186, 48.09994700482832, 0.0, 41.11279803286674, 9.747590372416596, 85.68132683819283, 36.089197159430725, 15.644497214836232, 108.21493741366636, 81.34276897366631, 9.460314537897048, 22.267006451459235, 54.81783922087085, 37.16735059759957, 205.92614074189734, 168.5599994045152, 1.0622773222342792, 23.362128355767307, 19.505499515655004, 0.0, 19.391187790649173, 2.497935527454413, 35.95738530652718, 0.0, 32.73956081316188, 10.515093958830166, 8.39074208313529, 12.647677041514047, 103.60983520903454, 0.0, 3.5394990756963955, 17.138886199041924, 34.05271324899217, 3.3065056236704415, 0.8580321982644967, 111.95441704968982, 2.313581586872317, 15.959036213682234, 1.6863608102000835, 118.82727729021084, 0.0, 5.2224685062322385, 27.355649427754766, 1.6578395003709505, 7.387264554405815, 65.13219437735901, 2.9150501666878355, 95.71552715054516, 0.7871144690867514, 0.0, 5.284298267911715, 65.69023928453001, 0.0, 8.846532747958266, 18.923104556411214, 2.810574962874507, 39.05953412193122, 146.7698891655379, 0.0, 1.1399646786140212, 38.477640501143085, 23.720719280788185, 21.617397484478627, 0.0, 99.99351326868096, 157.78468464476938, 29.023365208305805, 9.02464499026654, 18.776311870093, 128.83840785733844, 86.68263762210462, 80.04652036999477, 24.69587572091359, 54.63773017502545, 16.108164510985105, 109.66383072269217, 5.603010838709249, 0.8197999238735315, 133.7766311390976, 196.94424109004382, 0.0, 5.722975642787111, 12.377853701326043, 2.6052092894343266, 20.02608978593363, 1.0406808186282241, 12.462337756219954, 1.6703775129666567, 11.947628106348143, 38.81938213841275, 2.1725455076762046, 26.27108464768116, 3.5964244795350266, 9.12468343426441, 54.15198669555635, 122.18118288326372, 40.73154862922491, 0.0, 18.254212098397595, 40.02129544721788, 68.64635789656035, 4.993114410224298, 74.69022141405824, 1.0827330071732986, 13.426908818770785, 23.62682370419519, 54.272389087615046, 1.6174557311883913, 23.690645333988982, 58.11034493140895, 163.94404857424826, 14.238686886218696, 4.551733679791994, 19.095490406933116, 18.45532563369794, 53.57550339809652, 56.699518581530434, 0.0, 53.241528420162275, 5.334788905104153, 37.30772393011477, 24.108293831001312]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.208668456731917, "mean_inference_ms": 4.03691207661301, "mean_action_processing_ms": 2.059078474800678, "mean_env_wait_ms": 1.2700707573433392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003538966178894043, "StateBufferConnector_ms": 0.01300191879272461, "ViewRequirementAgentConnector_ms": 0.1000678539276123}, "num_episodes": 72, "episode_return_max": 267.2200409927582, "episode_return_min": -20.499279297605298, "episode_return_mean": 95.80091971433903, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 246.1199961611819, "num_env_steps_trained_throughput_per_sec": 246.1199961611819, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 32963.647, "restore_workers_time_ms": 0.032, "training_step_time_ms": 32963.091, "sample_time_ms": 1431.479, "learn_time_ms": 31498.275, "learn_throughput": 253.982, "synch_weights_time_ms": 27.971}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 17, "trial_id": "cd905_00000", "date": "2024-08-20_09-33-26", "timestamp": 1724126606, "time_this_iter_s": 32.553730726242065, "time_total_s": 564.9884839057922, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f0dc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 564.9884839057922, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 36.39565217391304, "ram_util_percent": 82.59565217391302}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7068208725679488, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 0.0001, "total_loss": 2.1677145331624956, "policy_loss": -0.004594761057062045, "vf_loss": 2.1723068767123754, "vf_explained_var": 0.16760310842877343, "kl": 0.012465059602072148, "entropy": 1.5659296026305547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 11025.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.21975832181051375, "cur_kl_coeff": 9.765624999999999e-05, "cur_lr": 0.0001, "total_loss": 0.32346435801850426, "policy_loss": -0.0007078688192580428, "vf_loss": 0.3241719757280653, "vf_explained_var": 0.0017157541380988226, "kl": 0.0025753426185283097, "entropy": 1.5009063438763695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 11025.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 267.2200409927582, "episode_reward_min": -20.499279297605298, "episode_reward_mean": 92.18226213422591, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -415.85953876636205, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 177.49999999999991, "predator_policy": 437.12549693955424}, "policy_reward_mean": {"prey_policy": 6.4329956972678906, "predator_policy": 39.658135369845176}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.70000000000034, 224.8583439760754, 52.80000000000045, 267.2200409927582, 120.3999999999992, 83.2197056158059, 35.861700074825634, 52.71162399915024, 63.200000000000216, 125.4987635788443, 105.03864280865596, 108.99999999999912, 178.91220911651317, 63.170866741299626, 261.5277338094389, 75.00000000000026, 37.30000000000027, 110.19999999999989, 81.49999999999986, 115.19817373324749, 39.40000000000029, 72.9999999999997, 66.60000000000028, 37.90000000000027, 216.89999999999887, 106.79999999999883, 34.200000000000216, 79.29999999999957, 59.4000000000003, 160.19999999999936, 71.39307954441941, 82.6999999999991, 91.49999999999875, 135.9999999999996, 47.88144712502542, 149.18977193696026, 38.00000000000027, 64.30000000000017, 227.09084951049405, 83.899999999999, 80.1999999999993, 40.7962967799794, 38.50000000000028, 219.72927254408157, 90.59999999999872, 28.517029978918305, 54.50000000000042, 48.300000000000445, 124.09999999999917, 204.59999999999891, -20.499279297605298, 62.90000000000049, 47.00000000000041, 130.14339713610795, 69.62537012095085, 45.30000000000038, 113.89999999999972, 53.60000000000027, 63.80000000000049, 76.46888467175874, 39.9000000000003, 183.93479345017016, 147.79999999999868, 158.4118546503652, 54.48784578504814, 61.30000000000022, 106.12463488097652, 101.5999999999988, 33.70000000000021, 39.40000000000029, 114.63427089120265, 48.400000000000404, 39.100000000000286, 100.49999999999946, 88.09999999999876, 49.110996790620916, 173.59999999999886, 134.49999999999918, 163.4881132735271, 100.79999999999882, 62.50000000000041, 116.3999999999993, 41.71793292158753, 69.00000000000003, 33.53326786143924, 61.80000000000042, 81.5999999999994, 67.90000000000019, 62.20000000000031, 50.622917815064405, 47.10000000000043, 37.40000000000026, 39.50000000000029, 105.5999999999985, 119.89999999999884, 122.43305985899752, 92.19999999999874, 123.69999999999948, 186.47260074590358, 106.69999999999905], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [24.40114962280541, 1.8879115995685858, 74.89999999999978, -59.72600034855601, 20.000000000000014, 25.681597336433995, 134.14510384977177, 113.38811502006875, 18.701998630764727, 72.65403817475219, -82.8193063741837, -7.704970704637956, -0.36110976481406387, 9.985569581027697, -37.563250992756146, 5.324945123292721, -18.26239257182519, 20.000000000000014, -89.69590932274696, 9.616800709944512, 59.62131390644958, 14.964784157041429, 32.178292220487016, 65.6418709006598, -268.8739346500496, -415.85953876636205, -10.123453625806716, 16.169183193652312, 177.49999999999991, 74.7799735401379, -68.80513938232362, 33.30619685772272, 13.436135405085313, -17.68524302742027, 39.706587385355, -9.123145000735025, 50.150014796311304, -55.99373745493504, -173.03071567533595, 6.501525397061951, 18.674671793299648, 13.431134453664601, 13.979683749803574, -1.0060182392789168, -5.073259790454038, 34.07524277363958, -4.900579271116728, 8.950467186706033, 124.39999999999952, 87.86962396188991, 15.618757591421192, 23.600000000000076, -49.58241743580398, 13.134922956846212, 24.03745233882608, -42.56470833173929, 21.278952260709357, 18.88912835456422, -26.565547097200607, 69.18441574982339, 30.102471123463904, -79.85241667561849, 18.831977917137884, 13.900052995171679, 20.000000000000014, 30.387201967133436, 13.952409627583362, 26.618673161807052, 22.700000000000063, -26.55224724924171, 41.63834993684002, -82.00628438721276, 9.839685462102917, -3.567006451459189, 20.000000000000014, -47.68518981847029, 71.29999999999964, -218.6952906359178, 18.837722677765722, 40.637871644232874, 20.000000000000014, 40.69450048434519, 14.984622117322939, 3.922551344552495, -17.457385306526916, 20.000000000000014, 81.79630809169555, 94.67830968039405, 14.267262314114635, 55.29431856123616, -25.4962663870592, -49.59653884305689, 9.502412818849939, 24.319201906411802, -5.452713248992108, 16.393494376329524, 85.69999999999965, -74.41244924795502, 110.06547345339719, 76.26190874604721, -65.53200461882706, -75.48091277919151, 37.677531493768, 20.000000000000014, -8.255649427754634, 26.242160499629165, 81.85613258170267, -24.232194377358823, -65.35767644333738, 36.35246924705471, 24.512885530913334, 20.000000000000014, 23.352323789056136, 19.57313865850225, 20.000000000000014, 24.753467252041844, 2.2499828914782247, 39.81633758923626, -85.050561539445, -24.309977076265163, 20.000000000000014, 18.760035321385978, 49.87948359805656, 71.85695007018312, 20.682602515521445, 105.49999999999943, -169.76634326308428, 70.39999999999975, 10.26818114765302, 6.171654438822266, 15.48223466227457, -101.79695438970666, 20.000000000000014, -80.60452311112215, 21.904124279086478, 0.36226982497457927, 2.5918354890148643, -94.66383072269302, 13.896989161290715, 19.080200076126474, -28.202694854265886, -187.88390648367286, 20.000000000000014, 22.67702435721295, 6.922146298673923, 17.194790710565652, 60.573910214066515, 18.859319181371777, 18.83766224378005, 55.12962248703357, -6.185325550505757, 4.529312096365468, 117.52745449232332, 27.628915352319044, 111.5035755204647, 10.275316565735555, 38.000000000000185, -50.845056305291855, -3.3219616738516486, 63.39041304462692, 26.345787901602534, -22.121295447217626, 28.25364210343972, 14.50688558977567, -51.46511936393796, 17.410097864293608, 7.473091181229183, 24.47317629580493, 6.708531222265783, -29.06510817962998, -13.322739875801533, -6.678250389596151, -100.84404857424877, 4.261313113781277, 28.54826632020817, 15.704509593066847, 22.575182327486036, -32.40601135928014, 22.982928560629116, -29.05952932709529, -35.641528420162025, 24.16521109489593, -18.707723930114504, -5.308293831001235, 16.773269767009737, 17.755137926721165, 66.59052314854551, -35.11090416183717, -19.095076883730407, 69.65606784707508, 54.412593410585565, 24.195911405241294, 6.4875816540882765, -3.986197047071259, 53.96931466829308, 34.237461164929115, 88.55191763143426, 30.261524883048068, 2.0755344090523824, 43.95245018593177], "policy_predator_policy_reward": [0.8988503771946861, 23.512088400431487, 59.86137276776271, 149.8229715568692, 0.0, 7.118402663566118, 14.687292876004594, 4.999529246911687, 12.698001369235259, 16.345961825247496, 116.1143370789777, 57.62964561564985, 0.0, 26.237240258611706, 83.19610650086165, 1.7538233677517125, 61.46239257182537, 0.0, 171.76215519624753, 33.815716995399754, 18.554000119490695, 11.898544625675425, 2.0217077795131067, 9.158129099340162, 426.52018559337506, 437.12549693955424, 40.45322084721963, 16.67191632623432, 5.725358491199474, 3.5224017781010053, 6.856435660516086, 103.64250686408415, 6.0638645949146515, 35.48524302742051, 38.893412614645, 40.723145000735165, 0.7642482237104764, 86.57947443491294, 157.87571289699733, 123.85165111452449, 1.2253282067003508, 6.068865546335364, 56.06162929758195, 3.9647051918933385, 22.973259790454094, 14.624757226360638, 23.400579271116786, 10.449532813293931, 0.0, 4.630376038109509, 67.58124240857875, 0.0, 45.71499379694384, 24.9325006820141, 25.060314115462155, 72.76694187745137, 18.22104773929072, 1.0108716454357782, 44.26554709720086, 73.31558425017654, 8.222968102738635, 112.9200569938345, 1.8680220828621186, 48.09994700482832, 0.0, 41.11279803286674, 9.747590372416596, 85.68132683819283, 36.089197159430725, 15.644497214836232, 108.21493741366636, 81.34276897366631, 9.460314537897048, 22.267006451459235, 54.81783922087085, 37.16735059759957, 205.92614074189734, 168.5599994045152, 1.0622773222342792, 23.362128355767307, 19.505499515655004, 0.0, 19.391187790649173, 2.497935527454413, 35.95738530652718, 0.0, 32.73956081316188, 10.515093958830166, 8.39074208313529, 12.647677041514047, 103.60983520903454, 0.0, 3.5394990756963955, 17.138886199041924, 34.05271324899217, 3.3065056236704415, 0.8580321982644967, 111.95441704968982, 2.313581586872317, 15.959036213682234, 1.6863608102000835, 118.82727729021084, 0.0, 5.2224685062322385, 27.355649427754766, 1.6578395003709505, 7.387264554405815, 65.13219437735901, 2.9150501666878355, 95.71552715054516, 0.7871144690867514, 0.0, 5.284298267911715, 65.69023928453001, 0.0, 8.846532747958266, 18.923104556411214, 2.810574962874507, 39.05953412193122, 146.7698891655379, 0.0, 1.1399646786140212, 38.477640501143085, 23.720719280788185, 21.617397484478627, 0.0, 99.99351326868096, 157.78468464476938, 29.023365208305805, 9.02464499026654, 18.776311870093, 128.83840785733844, 86.68263762210462, 80.04652036999477, 24.69587572091359, 54.63773017502545, 16.108164510985105, 109.66383072269217, 5.603010838709249, 0.8197999238735315, 133.7766311390976, 196.94424109004382, 0.0, 5.722975642787111, 12.377853701326043, 2.6052092894343266, 20.02608978593363, 1.0406808186282241, 12.462337756219954, 1.6703775129666567, 11.947628106348143, 38.81938213841275, 2.1725455076762046, 26.27108464768116, 3.5964244795350266, 9.12468343426441, 54.15198669555635, 122.18118288326372, 40.73154862922491, 0.0, 18.254212098397595, 40.02129544721788, 68.64635789656035, 4.993114410224298, 74.69022141405824, 1.0827330071732986, 13.426908818770785, 23.62682370419519, 54.272389087615046, 1.6174557311883913, 23.690645333988982, 58.11034493140895, 163.94404857424826, 14.238686886218696, 4.551733679791994, 19.095490406933116, 18.45532563369794, 53.57550339809652, 56.699518581530434, 0.0, 53.241528420162275, 5.334788905104153, 37.30772393011477, 24.108293831001312, 2.9267302329902356, 2.044862073278819, 1.8094768514545052, 72.31090416183721, 67.08688834891697, 2.252120687738319, 8.78351923998187, 35.04103580319018, 0.0, 89.69861539298304, 1.0306853317071452, 34.462538835070916, 22.220995042628793, 45.43816318879351, 17.6649307170228, 43.007084687993135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2077744487721445, "mean_inference_ms": 4.040102530122666, "mean_action_processing_ms": 2.03984538442239, "mean_env_wait_ms": 1.260206255417164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034270286560058594, "StateBufferConnector_ms": 0.012595772743225098, "ViewRequirementAgentConnector_ms": 0.09859943389892578}, "num_episodes": 8, "episode_return_max": 267.2200409927582, "episode_return_min": -20.499279297605298, "episode_return_mean": 92.18226213422591, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 243.57157068706368, "num_env_steps_trained_throughput_per_sec": 243.57157068706368, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 32832.458, "restore_workers_time_ms": 0.038, "training_step_time_ms": 32831.873, "sample_time_ms": 1401.687, "learn_time_ms": 31395.198, "learn_throughput": 254.816, "synch_weights_time_ms": 29.244}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 18, "trial_id": "cd905_00000", "date": "2024-08-20_09-33-59", "timestamp": 1724126639, "time_this_iter_s": 32.86017107963562, "time_total_s": 597.8486549854279, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169e6d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 597.8486549854279, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 36.09148936170213, "ram_util_percent": 82.77021276595744}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.135813452788289, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 0.0001, "total_loss": 5.311911117462885, "policy_loss": -0.006541786001189538, "vf_loss": 5.318450375965663, "vf_explained_var": 0.01476751480783735, "kl": 0.013002132229363696, "entropy": 1.5552471726659745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 11655.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3462738045328666, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 0.0001, "total_loss": 3.6525429392617847, "policy_loss": -0.001977884258690571, "vf_loss": 3.6545205861803085, "vf_explained_var": 0.0004343930691007584, "kl": 0.004659522773003811, "entropy": 1.5400151091908652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 11655.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 249.29999999999924, "episode_reward_min": 14.178497483930432, "episode_reward_mean": 91.65187407373105, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -229.11702887457477, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.39999999999992, "predator_policy": 280.24842773434614}, "policy_reward_mean": {"prey_policy": 8.543499056800691, "predator_policy": 37.28243798006501}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.48784578504814, 61.30000000000022, 106.12463488097652, 101.5999999999988, 33.70000000000021, 39.40000000000029, 114.63427089120265, 48.400000000000404, 39.100000000000286, 100.49999999999946, 88.09999999999876, 49.110996790620916, 173.59999999999886, 134.49999999999918, 163.4881132735271, 100.79999999999882, 62.50000000000041, 116.3999999999993, 41.71793292158753, 69.00000000000003, 33.53326786143924, 61.80000000000042, 81.5999999999994, 67.90000000000019, 62.20000000000031, 50.622917815064405, 47.10000000000043, 37.40000000000026, 39.50000000000029, 105.5999999999985, 119.89999999999884, 122.43305985899752, 92.19999999999874, 123.69999999999948, 186.47260074590358, 106.69999999999905, 91.09999999999889, 140.1999999999993, 103.09999999999916, 60.55802924357517, 56.10000000000029, 39.800000000000296, 39.10000000000029, 249.29999999999924, 39.9000000000003, 181.89999999999944, 100.09999999999874, 94.57721586486684, 72.33668759922615, 87.39999999999976, 22.168073836292805, 98.39999999999876, 57.100000000000215, 143.89999999999938, 35.500000000000234, 176.1960707601096, 82.89999999999907, 51.10000000000049, 38.400000000000276, 63.70000000000047, 104.39999999999912, 113.59999999999889, 52.800000000000416, 47.800000000000374, 109.79999999999902, 91.19999999999897, 120.59999999999862, 217.1646372951767, 61.2000000000003, 44.300000000000395, 37.33215373946656, 113.59999999999874, 149.5839744329219, 46.750697514342136, 98.99999999999892, 106.59999999999897, 69.90000000000002, 62.100000000000406, 153.65896560092463, 104.29999999999933, 123.1999999999997, 103.19999999999949, 204.4459583978466, 95.29999999999944, 68.29999999999995, 98.03366616206165, 94.09999999999958, 38.537003835090864, 145.59999999999928, 14.178497483930432, 42.86188602862598, 40.30000000000029, 133.8381476148327, 117.79999999999976, 119.99999999999926, 115.09999999999886, 124.29999999999973, 132.8999999999992, 106.56639014467372, 178.97371099480117], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [10.26818114765302, 6.171654438822266, 15.48223466227457, -101.79695438970666, 20.000000000000014, -80.60452311112215, 21.904124279086478, 0.36226982497457927, 2.5918354890148643, -94.66383072269302, 13.896989161290715, 19.080200076126474, -28.202694854265886, -187.88390648367286, 20.000000000000014, 22.67702435721295, 6.922146298673923, 17.194790710565652, 60.573910214066515, 18.859319181371777, 18.83766224378005, 55.12962248703357, -6.185325550505757, 4.529312096365468, 117.52745449232332, 27.628915352319044, 111.5035755204647, 10.275316565735555, 38.000000000000185, -50.845056305291855, -3.3219616738516486, 63.39041304462692, 26.345787901602534, -22.121295447217626, 28.25364210343972, 14.50688558977567, -51.46511936393796, 17.410097864293608, 7.473091181229183, 24.47317629580493, 6.708531222265783, -29.06510817962998, -13.322739875801533, -6.678250389596151, -100.84404857424877, 4.261313113781277, 28.54826632020817, 15.704509593066847, 22.575182327486036, -32.40601135928014, 22.982928560629116, -29.05952932709529, -35.641528420162025, 24.16521109489593, -18.707723930114504, -5.308293831001235, 16.773269767009737, 17.755137926721165, 66.59052314854551, -35.11090416183717, -19.095076883730407, 69.65606784707508, 54.412593410585565, 24.195911405241294, 6.4875816540882765, -3.986197047071259, 53.96931466829308, 34.237461164929115, 88.55191763143426, 30.261524883048068, 2.0755344090523824, 43.95245018593177, 18.905798060124717, 70.29810973013902, 9.626235172231407, 85.0894201802352, 3.0475138491435887, 68.55637305156739, -3.7194181049483928, 16.554272147479377, -31.17626739558922, 2.1111276523316698, 17.782315175189183, 20.000000000000014, -19.362514823632658, -34.39908701953582, 187.39999999999992, 46.981357935056806, 20.000000000000014, 18.944736706016545, 95.2791976261658, 41.758997787790214, 59.45299042294684, 20.000000000000014, 18.84688305893193, 62.732827211383935, 20.53420889905319, 4.647293786064219, 17.820352054024166, 20.000000000000014, -71.92186273475879, -130.44896560587316, -17.42499919836562, 52.16777673141751, -26.56973778340106, -24.730649071624235, 94.32488006367431, 19.117663671836794, -14.516178086839927, -29.58098712517164, 55.434660993520616, 52.91524714229215, 11.523558536424476, 10.773110639639965, 23.245313863333358, 11.433422608128561, 6.2720555963545, -4.714530760308813, 6.682881079386096, 13.20062821574319, 10.26019570509157, 5.117606130995241, 39.35199587204859, 12.776030047540072, -14.37067355251749, 0.5757745032654544, -19.71354826197261, 15.767178857789789, 53.3784667877517, 11.794059066537514, 5.649362846915401, 25.289195223862638, 34.40000000000025, 82.22495461739467, 20.13778569087819, 105.01654639316718, -101.82572098564434, -28.80008904952291, 10.4346635115282, -60.834192826693936, -48.24297190435149, 0.3876672929633096, 53.666336900632146, 5.473248411546946, 86.13920582812068, 10.364482019491597, -9.441035486516832, 1.490341720828819, 15.777926863172858, 58.795686662247945, 80.6952669568215, -161.7193243600065, -21.00855149528096, -5.949081818112001, -70.3599226116779, 16.365708129700547, 16.905379040897326, 33.82626482911046, 17.702991027325844, -41.342373794868095, 7.4340897886665935, 0.23445382132962855, -38.95529095005627, -15.33999622822695, 78.54247095915109, 57.52001808611318, 21.444968358964644, -13.739222916610911, 6.452845604439242, -49.80059963531037, 12.013372428793932, 11.019536108699514, -86.16004768363635, -52.60515036467574, -30.20534130161512, -5.852419695611719, 11.387588432184138, 107.29989088891577, -229.11702887457477, -40.44915722446683, -5.976446472423364, 6.85487433990053, 14.174765658110807, 20.000000000000014, 27.835277260594943, 30.19454377919847, -46.70614809715231, 30.43889941500475, 53.22190932207151, 8.353169690487416, -1.748374887205069, 72.19999999999955, 67.23917845846566, -54.608748815505564, 40.69999999999998, 74.49703579983431, 25.17041435865895, 19.173482946578268, -8.756597426834022, -54.55403333254101], "policy_predator_policy_reward": [29.023365208305805, 9.02464499026654, 18.776311870093, 128.83840785733844, 86.68263762210462, 80.04652036999477, 24.69587572091359, 54.63773017502545, 16.108164510985105, 109.66383072269217, 5.603010838709249, 0.8197999238735315, 133.7766311390976, 196.94424109004382, 0.0, 5.722975642787111, 12.377853701326043, 2.6052092894343266, 20.02608978593363, 1.0406808186282241, 12.462337756219954, 1.6703775129666567, 11.947628106348143, 38.81938213841275, 2.1725455076762046, 26.27108464768116, 3.5964244795350266, 9.12468343426441, 54.15198669555635, 122.18118288326372, 40.73154862922491, 0.0, 18.254212098397595, 40.02129544721788, 68.64635789656035, 4.993114410224298, 74.69022141405824, 1.0827330071732986, 13.426908818770785, 23.62682370419519, 54.272389087615046, 1.6174557311883913, 23.690645333988982, 58.11034493140895, 163.94404857424826, 14.238686886218696, 4.551733679791994, 19.095490406933116, 18.45532563369794, 53.57550339809652, 56.699518581530434, 0.0, 53.241528420162275, 5.334788905104153, 37.30772393011477, 24.108293831001312, 2.9267302329902356, 2.044862073278819, 1.8094768514545052, 72.31090416183721, 67.08688834891697, 2.252120687738319, 8.78351923998187, 35.04103580319018, 0.0, 89.69861539298304, 1.0306853317071452, 34.462538835070916, 22.220995042628793, 45.43816318879351, 17.6649307170228, 43.007084687993135, 0.9942019398752869, 0.9018902698606852, 16.97460690704405, 28.50973774048932, 31.496113099288824, 0.0, 43.71941810494859, 4.003757096095539, 65.51363785582112, 19.65150188743648, 2.0176848248108037, 0.0, 36.362514823632885, 56.49908701953606, 0.0, 14.918642064943361, 0.0, 0.9552632939834556, 20.889316783485878, 23.972487802558383, 18.89134043131282, 1.755669145740499, 9.281783186325049, 3.7157224082276077, 19.524674639406875, 27.63051027470207, 49.57964794597598, 0.0, 184.64217349598943, 39.896728680933805, 35.62499919836588, 28.032223268582662, 56.73619893287834, 51.66418792214737, 22.109774161287394, 8.347682103201407, 32.416178086840155, 47.18098712517189, 0.0, 67.84616262429752, 19.07644146357553, 41.52688936036003, 8.554686136666707, 7.866577391871404, 12.727944403645466, 24.114530760308888, 14.817118920613876, 28.99937178425678, 9.139804294908394, 79.88239386900472, 13.84800412795154, 47.62396995245991, 32.77067355251772, 33.82422549673456, 37.01851437600262, 14.727855028180363, 11.25335718846749, 33.37411695724337, 58.55063715308463, 1.7108047761374738, 0.0, 3.9750453826047076, 55.9358115251728, 36.074493685958906, 83.64037588820412, 108.18543414696278, 8.865336488471765, 85.83419282669331, 16.020951224261832, 69.16650712659276, 26.433663099368026, 28.026751588453113, 43.46079417187905, 9.619492413431146, 8.201227547469296, 46.50016373256051, 12.686071270223549, 11.740315204355747, 11.904733043178034, 175.7193243600058, 67.90855149528117, 28.949081818112077, 100.65665171699312, 15.437562764983248, 38.753586560028225, 64.17373517088967, 103.60263071297243, 24.336752054569875, 24.164828576715298, 91.36662781328803, 53.81939158561221, 103.6758955926713, 13.323691706992804, 55.059777645590074, 53.655031641035485, 33.93922291661113, 12.747154395560724, 98.90059963531021, 41.340548529740914, 33.660209094827785, 101.96004768363545, 130.90515036467562, 3.8767832613068727, 70.71798157101078, 25.030442791409953, 1.8820778874899067, 280.24842773434614, 3.496255848625421, 26.97141387388841, 15.012044287260109, 6.125234341889154, 0.0, 34.89878174734327, 40.909544827696884, 126.5061480971522, 7.5611005849954225, 3.0236197673611893, 55.40130122007993, 44.64837488720504, 0.0, 36.86082154153443, 74.80874881550554, 0.0, 17.7029642001653, 41.35757137148293, 20.864921467954996, 122.85247116196219, 119.43187059221472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.204762032898967, "mean_inference_ms": 4.055137258513137, "mean_action_processing_ms": 2.032983002846117, "mean_env_wait_ms": 1.2640147371291492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049991607666015625, "StateBufferConnector_ms": 0.020285487174987793, "ViewRequirementAgentConnector_ms": 0.11516380310058594}, "num_episodes": 64, "episode_return_max": 249.29999999999924, "episode_return_min": 14.178497483930432, "episode_return_mean": 91.65187407373105, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 245.59435032819624, "num_env_steps_trained_throughput_per_sec": 245.59435032819624, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 32769.02, "restore_workers_time_ms": 0.039, "training_step_time_ms": 32768.45, "sample_time_ms": 1377.676, "learn_time_ms": 31355.117, "learn_throughput": 255.142, "synch_weights_time_ms": 28.487}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 19, "trial_id": "cd905_00000", "date": "2024-08-20_09-34-32", "timestamp": 1724126672, "time_this_iter_s": 32.63486409187317, "time_total_s": 630.483519077301, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f6bdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 630.483519077301, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 34.87021276595745, "ram_util_percent": 81.85744680851066}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9217158398694463, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 0.0001, "total_loss": 2.6376334250919404, "policy_loss": -0.001197510894890579, "vf_loss": 2.638830835100204, "vf_explained_var": 0.0952447027441055, "kl": 0.0005268495529997657, "entropy": 1.5346070507216074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3328708817384073, "cur_kl_coeff": 2.4414062499999998e-05, "cur_lr": 0.0001, "total_loss": 1.4489521718214429, "policy_loss": -0.0005535116315715843, "vf_loss": 1.4495056837324112, "vf_explained_var": 0.0025403507172115265, "kl": 0.00038650551178429776, "entropy": 1.5527204941189479, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 267.8999999999996, "episode_reward_min": 13.594807418318242, "episode_reward_mean": 91.16527360920308, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -249.94588524265674, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 156.46307391849652, "predator_policy": 280.24842773434614}, "policy_reward_mean": {"prey_policy": -8.65488488782653, "predator_policy": 54.23752169242818}, "custom_metrics": {}, "hist_stats": {"episode_reward": [149.5839744329219, 46.750697514342136, 98.99999999999892, 106.59999999999897, 69.90000000000002, 62.100000000000406, 153.65896560092463, 104.29999999999933, 123.1999999999997, 103.19999999999949, 204.4459583978466, 95.29999999999944, 68.29999999999995, 98.03366616206165, 94.09999999999958, 38.537003835090864, 145.59999999999928, 14.178497483930432, 42.86188602862598, 40.30000000000029, 133.8381476148327, 117.79999999999976, 119.99999999999926, 115.09999999999886, 124.29999999999973, 132.8999999999992, 106.56639014467372, 178.97371099480117, 267.8999999999996, 102.05332792572, 38.70000000000024, 69.89999999999999, 100.63576142034275, 81.69999999999925, 34.60000000000022, 115.19999999999953, 93.30000000000003, 99.99999999999929, 40.80000000000031, 123.54600293301408, 135.1430122130924, 53.000000000000306, 130.88140832736303, 148.79999999999882, 62.600000000000435, 109.89999999999938, 88.89999999999868, 36.40000000000025, 113.66240242566167, 50.10000000000045, 34.9000000000002, 29.800000000000168, 71.29999999999987, 134.37765143613106, 44.40000000000026, 92.2170826217806, 56.13052480260554, 33.500000000000206, 70.60000000000001, 89.09999999999889, 101.89999999999951, 60.90000000000044, 132.42635176332078, 13.594807418318242, 166.29292296710418, 52.100000000000044, 36.900000000000254, 80.37214810438135, 34.42308620408982, 99.3999999999987, 38.400000000000226, 130.6999999999993, 129.49999999999903, 213.04273044520508, 151.92124065724752, 75.40578290876122, 38.11074010394973, 58.982243461433534, 34.637714039825745, 65.60562267842191, 131.699999999999, 52.52394831088469, 45.200000000000394, 137.38013599426793, 132.3817608642044, 53.200000000000344, 65.79022427096632, 100.85666844039302, 68.29999999999997, 107.19999999999916, 33.214548940947395, 107.35871592251672, 137.0999999999988, 62.11976108738957, 97.79999999999916, 74.59999999999968, 37.210134020939876, 96.5999999999992, 117.19999999999897, 100.69999999999901], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [86.13920582812068, 10.364482019491597, -9.441035486516832, 1.490341720828819, 15.777926863172858, 58.795686662247945, 80.6952669568215, -161.7193243600065, -21.00855149528096, -5.949081818112001, -70.3599226116779, 16.365708129700547, 16.905379040897326, 33.82626482911046, 17.702991027325844, -41.342373794868095, 7.4340897886665935, 0.23445382132962855, -38.95529095005627, -15.33999622822695, 78.54247095915109, 57.52001808611318, 21.444968358964644, -13.739222916610911, 6.452845604439242, -49.80059963531037, 12.013372428793932, 11.019536108699514, -86.16004768363635, -52.60515036467574, -30.20534130161512, -5.852419695611719, 11.387588432184138, 107.29989088891577, -229.11702887457477, -40.44915722446683, -5.976446472423364, 6.85487433990053, 14.174765658110807, 20.000000000000014, 27.835277260594943, 30.19454377919847, -46.70614809715231, 30.43889941500475, 53.22190932207151, 8.353169690487416, -1.748374887205069, 72.19999999999955, 67.23917845846566, -54.608748815505564, 40.69999999999998, 74.49703579983431, 25.17041435865895, 19.173482946578268, -8.756597426834022, -54.55403333254101, 156.46307391849652, 84.5072564290166, -58.72000512119503, -0.5407450559014971, -14.745941727337568, -13.104404765404292, 19.55835440394106, -6.4976684341721835, -62.12060712921849, 3.5735656809879663, 16.34486490765722, 59.41575031004802, 2.7256474242258864, -38.969427938802305, -39.20231746218025, 19.08318300244384, 38.27364730345485, -102.4119121512409, -63.304995604334, 81.53082069433609, 20.000000000000014, 19.884478577157033, 0.4358558491590604, -72.07698094914704, -108.25065367401095, 81.19999999999925, 6.897980145581442, -3.4874378195179654, -40.72654377178118, -51.67692497074381, 127.93601011648043, 20.000000000000014, 11.941636950119712, -27.09933111137267, 85.11239923370724, -6.7297896130491015, 70.39999999999975, -1.8713741070507988, -36.40458971010759, 15.437530448537498, 56.90000000000009, -168.43639706126524, 28.93892228803366, -10.599778187357218, -117.4340064791509, -6.649107785711838, -29.615101922375942, -245.0222563695404, -11.777702473630034, 21.085620527111388, -13.846752622112364, 32.92380199484356, 19.450600577058815, 3.821120192200648, -146.90303050796786, -44.83170473947287, -73.73052925808032, -38.7859714680735, -102.65017409017979, -36.19725896391018, 41.60000000000025, -38.985823096935604, 12.652560207887683, 61.9834738661457, -19.154710343957206, -32.75446324277465, -1.1546520535236762, 21.372735864672592, 48.821951168112165, 18.868083532962853, -26.488960243033915, -44.98703848228063, 44.30000000000011, 77.31082546343134, -5.717733006778856, -211.5279560629135, -1.3587336267899421, 2.0345554854958205, -249.94588524265674, -49.13202471135103, -14.539010197565416, -78.46982945910699, 68.35589183316623, -3.8768605004784176, -59.722137782743985, 10.772763482168346, 66.81886182333996, -8.450829713762385, 93.6013171070368, -38.27022127409019, -40.50184113423018, 81.587848879099, 60.9599385381947, -4.565162303365746, 10.808055080256324, -24.7812713889414, -68.10208984287054, -23.057047203874525, -52.283599601514666, -103.77458850467451, 8.213603354420213, -64.20164547222151, -22.431791971049137, 16.27193600636309, 3.9407345095307345, 98.85811557422858, 9.293105024278493, -24.054907643029097, -89.43685415291169, -40.113990418873726, 29.77094791528199, -88.38927629634505, -163.23705136989395, 30.563170722684283, -132.31057647870227, -48.133402497352265, -2.0809858447966274, -24.97608385174034, -33.69386299058661, -4.931489851574822, -107.6666697122933, -18.36165293005059, 0.15780715771280254, 79.52448425259215, -18.699346700715466, -59.19196635497486, -47.677427544877304, 17.69860397127375, 116.25841391623942, 8.972037238308907, -58.07213666308998, -125.46653621192985, -15.290945746770483, 12.3164096117684, -52.32909794226686, 55.1000000000002, -33.11378379545256, -31.504945158067002, 32.664683479549836, 19.067212379357798, 40.790996152414635, 24.069821315261596, 25.313343311106674, 18.80578778995745], "policy_predator_policy_reward": [43.46079417187905, 9.619492413431146, 8.201227547469296, 46.50016373256051, 12.686071270223549, 11.740315204355747, 11.904733043178034, 175.7193243600058, 67.90855149528117, 28.949081818112077, 100.65665171699312, 15.437562764983248, 38.753586560028225, 64.17373517088967, 103.60263071297243, 24.336752054569875, 24.164828576715298, 91.36662781328803, 53.81939158561221, 103.6758955926713, 13.323691706992804, 55.059777645590074, 53.655031641035485, 33.93922291661113, 12.747154395560724, 98.90059963531021, 41.340548529740914, 33.660209094827785, 101.96004768363545, 130.90515036467562, 3.8767832613068727, 70.71798157101078, 25.030442791409953, 1.8820778874899067, 280.24842773434614, 3.496255848625421, 26.97141387388841, 15.012044287260109, 6.125234341889154, 0.0, 34.89878174734327, 40.909544827696884, 126.5061480971522, 7.5611005849954225, 3.0236197673611893, 55.40130122007993, 44.64837488720504, 0.0, 36.86082154153443, 74.80874881550554, 0.0, 17.7029642001653, 41.35757137148293, 20.864921467954996, 122.85247116196219, 119.43187059221472, 1.9369260815032507, 24.992743570983396, 28.724057507929764, 132.59002059488748, 35.6459417273378, 30.904404765404493, 4.441645596058952, 52.397668434172225, 27.51109623251551, 131.67170663605827, 4.155135092342745, 1.7842496899521456, 16.274352575774078, 54.56942793880252, 6.187902211313596, 129.13123224842278, 24.92635269654521, 132.5119121512403, 77.20499560433355, 4.569179305663574, 0.9155214228429817, 0.0, 123.04795569473481, 72.13917233826766, 104.14170845870157, 58.051957428402496, 27.30201985441863, 22.287437819517997, 170.23639373807015, 53.04848333181831, 0.8639898835191236, 0.0, 28.336937828262286, 49.420756332990884, 2.9876007662925126, 28.52978961304919, 0.0, 20.37137410705082, 53.204589710107825, 4.1624695514624666, 177.5325819100387, 47.6662175768886, 3.2610777119665144, 28.499778187357375, 134.53400647915004, 24.449107785711917, 79.6789978815536, 224.75836041036249, 58.07770247363015, 3.9143794728886503, 85.37680946169166, 29.92379260170823, 6.249399422941209, 14.878879807799322, 80.85208753158606, 203.0997303376355, 115.2404766272041, 53.40654890155429, 118.55017409017888, 53.79725896391043, 0.0, 67.98582309693583, 8.408901944537151, 6.0550639814295995, 88.51701811883173, 65.29215546790043, 23.054652053523746, 17.627264135327447, 62.37804883188791, 2.3582682303587577, 3.295179617620951, 81.77562652601232, 25.390788237454426, 19.29130926621893, 53.04835801041886, 216.29733105927335, 19.558733626789948, 16.66544451450415, 199.21900744000462, 180.23105061838456, 4.335904599864115, 123.0960212608972, 0.0, 34.92096866731209, 31.12557099332297, 56.22380330725233, 43.79695933003203, 28.535008560390455, 3.6557992631310787, 70.5131049039222, 82.31332855525281, 89.6433941450837, 4.57910924487604, 90.94735517754387, 30.588069080217572, 58.79093013722942, 61.78514750679294, 67.48472964390102, 75.96584306294778, 139.0745885046738, 2.672003365639437, 87.95375279198647, 0.0, 71.76547864310784, 25.359265490469376, 3.5418844257709496, 67.28575092963506, 0.0, 28.869003880214848, 145.8818406915704, 69.54551703292884, 126.45294734240277, 90.4046525649868, 174.65098894642747, 146.51057647870147, 87.13340249735242, 50.257510229997735, 42.58978373750542, 29.58459349186434, 109.89742779068965, 157.66666971229282, 36.661652930050806, 18.642192842287194, 8.875515747407583, 43.80940377817539, 67.29645821846206, 132.27742754487738, 5.060111951243629, 1.6415860837601046, 10.227962761691057, 169.899564391554, 75.75886957085403, 78.57568468016511, 22.1988514548372, 71.82909794226654, 0.0, 93.27456381308335, 8.554299161376276, 44.03531652045026, 0.8327876206422071, 4.907116267227307, 47.43206626509669, 55.48665668889343, 1.0942122100425518]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.193254955971537, "mean_inference_ms": 4.060822691179487, "mean_action_processing_ms": 2.0136252944367543, "mean_env_wait_ms": 1.2610249221661076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036394596099853516, "StateBufferConnector_ms": 0.01974654197692871, "ViewRequirementAgentConnector_ms": 0.11760449409484863}, "num_episodes": 72, "episode_return_max": 267.8999999999996, "episode_return_min": 13.594807418318242, "episode_return_mean": 91.16527360920308, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 245.5689082997607, "num_env_steps_trained_throughput_per_sec": 245.5689082997607, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 32690.045, "restore_workers_time_ms": 0.039, "training_step_time_ms": 32689.542, "sample_time_ms": 1392.451, "learn_time_ms": 31260.692, "learn_throughput": 255.912, "synch_weights_time_ms": 29.214}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 20, "trial_id": "cd905_00000", "date": "2024-08-20_09-35-04", "timestamp": 1724126704, "time_this_iter_s": 32.62870407104492, "time_total_s": 663.112223148346, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169eab940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 663.112223148346, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 35.99565217391304, "ram_util_percent": 82.57391304347826}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8987511458141464, "cur_kl_coeff": 9.765624999999999e-05, "cur_lr": 0.0001, "total_loss": 2.511248861040388, "policy_loss": -0.0007401834600531157, "vf_loss": 2.511988987998357, "vf_explained_var": 0.057237233055962455, "kl": 0.0007273004051375398, "entropy": 1.5290878015851217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 12915.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2939160953556734, "cur_kl_coeff": 1.2207031249999999e-05, "cur_lr": 0.0001, "total_loss": 1.0997250409353347, "policy_loss": -0.001067643841758134, "vf_loss": 1.1007926525104614, "vf_explained_var": 0.0005302935365646605, "kl": 0.002889561771150641, "entropy": 1.5633843556283011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 12915.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 267.8999999999996, "episode_reward_min": 13.594807418318242, "episode_reward_mean": 91.16527360920308, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -249.94588524265674, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 156.46307391849652, "predator_policy": 280.24842773434614}, "policy_reward_mean": {"prey_policy": -8.65488488782653, "predator_policy": 54.23752169242818}, "custom_metrics": {}, "hist_stats": {"episode_reward": [149.5839744329219, 46.750697514342136, 98.99999999999892, 106.59999999999897, 69.90000000000002, 62.100000000000406, 153.65896560092463, 104.29999999999933, 123.1999999999997, 103.19999999999949, 204.4459583978466, 95.29999999999944, 68.29999999999995, 98.03366616206165, 94.09999999999958, 38.537003835090864, 145.59999999999928, 14.178497483930432, 42.86188602862598, 40.30000000000029, 133.8381476148327, 117.79999999999976, 119.99999999999926, 115.09999999999886, 124.29999999999973, 132.8999999999992, 106.56639014467372, 178.97371099480117, 267.8999999999996, 102.05332792572, 38.70000000000024, 69.89999999999999, 100.63576142034275, 81.69999999999925, 34.60000000000022, 115.19999999999953, 93.30000000000003, 99.99999999999929, 40.80000000000031, 123.54600293301408, 135.1430122130924, 53.000000000000306, 130.88140832736303, 148.79999999999882, 62.600000000000435, 109.89999999999938, 88.89999999999868, 36.40000000000025, 113.66240242566167, 50.10000000000045, 34.9000000000002, 29.800000000000168, 71.29999999999987, 134.37765143613106, 44.40000000000026, 92.2170826217806, 56.13052480260554, 33.500000000000206, 70.60000000000001, 89.09999999999889, 101.89999999999951, 60.90000000000044, 132.42635176332078, 13.594807418318242, 166.29292296710418, 52.100000000000044, 36.900000000000254, 80.37214810438135, 34.42308620408982, 99.3999999999987, 38.400000000000226, 130.6999999999993, 129.49999999999903, 213.04273044520508, 151.92124065724752, 75.40578290876122, 38.11074010394973, 58.982243461433534, 34.637714039825745, 65.60562267842191, 131.699999999999, 52.52394831088469, 45.200000000000394, 137.38013599426793, 132.3817608642044, 53.200000000000344, 65.79022427096632, 100.85666844039302, 68.29999999999997, 107.19999999999916, 33.214548940947395, 107.35871592251672, 137.0999999999988, 62.11976108738957, 97.79999999999916, 74.59999999999968, 37.210134020939876, 96.5999999999992, 117.19999999999897, 100.69999999999901], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [86.13920582812068, 10.364482019491597, -9.441035486516832, 1.490341720828819, 15.777926863172858, 58.795686662247945, 80.6952669568215, -161.7193243600065, -21.00855149528096, -5.949081818112001, -70.3599226116779, 16.365708129700547, 16.905379040897326, 33.82626482911046, 17.702991027325844, -41.342373794868095, 7.4340897886665935, 0.23445382132962855, -38.95529095005627, -15.33999622822695, 78.54247095915109, 57.52001808611318, 21.444968358964644, -13.739222916610911, 6.452845604439242, -49.80059963531037, 12.013372428793932, 11.019536108699514, -86.16004768363635, -52.60515036467574, -30.20534130161512, -5.852419695611719, 11.387588432184138, 107.29989088891577, -229.11702887457477, -40.44915722446683, -5.976446472423364, 6.85487433990053, 14.174765658110807, 20.000000000000014, 27.835277260594943, 30.19454377919847, -46.70614809715231, 30.43889941500475, 53.22190932207151, 8.353169690487416, -1.748374887205069, 72.19999999999955, 67.23917845846566, -54.608748815505564, 40.69999999999998, 74.49703579983431, 25.17041435865895, 19.173482946578268, -8.756597426834022, -54.55403333254101, 156.46307391849652, 84.5072564290166, -58.72000512119503, -0.5407450559014971, -14.745941727337568, -13.104404765404292, 19.55835440394106, -6.4976684341721835, -62.12060712921849, 3.5735656809879663, 16.34486490765722, 59.41575031004802, 2.7256474242258864, -38.969427938802305, -39.20231746218025, 19.08318300244384, 38.27364730345485, -102.4119121512409, -63.304995604334, 81.53082069433609, 20.000000000000014, 19.884478577157033, 0.4358558491590604, -72.07698094914704, -108.25065367401095, 81.19999999999925, 6.897980145581442, -3.4874378195179654, -40.72654377178118, -51.67692497074381, 127.93601011648043, 20.000000000000014, 11.941636950119712, -27.09933111137267, 85.11239923370724, -6.7297896130491015, 70.39999999999975, -1.8713741070507988, -36.40458971010759, 15.437530448537498, 56.90000000000009, -168.43639706126524, 28.93892228803366, -10.599778187357218, -117.4340064791509, -6.649107785711838, -29.615101922375942, -245.0222563695404, -11.777702473630034, 21.085620527111388, -13.846752622112364, 32.92380199484356, 19.450600577058815, 3.821120192200648, -146.90303050796786, -44.83170473947287, -73.73052925808032, -38.7859714680735, -102.65017409017979, -36.19725896391018, 41.60000000000025, -38.985823096935604, 12.652560207887683, 61.9834738661457, -19.154710343957206, -32.75446324277465, -1.1546520535236762, 21.372735864672592, 48.821951168112165, 18.868083532962853, -26.488960243033915, -44.98703848228063, 44.30000000000011, 77.31082546343134, -5.717733006778856, -211.5279560629135, -1.3587336267899421, 2.0345554854958205, -249.94588524265674, -49.13202471135103, -14.539010197565416, -78.46982945910699, 68.35589183316623, -3.8768605004784176, -59.722137782743985, 10.772763482168346, 66.81886182333996, -8.450829713762385, 93.6013171070368, -38.27022127409019, -40.50184113423018, 81.587848879099, 60.9599385381947, -4.565162303365746, 10.808055080256324, -24.7812713889414, -68.10208984287054, -23.057047203874525, -52.283599601514666, -103.77458850467451, 8.213603354420213, -64.20164547222151, -22.431791971049137, 16.27193600636309, 3.9407345095307345, 98.85811557422858, 9.293105024278493, -24.054907643029097, -89.43685415291169, -40.113990418873726, 29.77094791528199, -88.38927629634505, -163.23705136989395, 30.563170722684283, -132.31057647870227, -48.133402497352265, -2.0809858447966274, -24.97608385174034, -33.69386299058661, -4.931489851574822, -107.6666697122933, -18.36165293005059, 0.15780715771280254, 79.52448425259215, -18.699346700715466, -59.19196635497486, -47.677427544877304, 17.69860397127375, 116.25841391623942, 8.972037238308907, -58.07213666308998, -125.46653621192985, -15.290945746770483, 12.3164096117684, -52.32909794226686, 55.1000000000002, -33.11378379545256, -31.504945158067002, 32.664683479549836, 19.067212379357798, 40.790996152414635, 24.069821315261596, 25.313343311106674, 18.80578778995745], "policy_predator_policy_reward": [43.46079417187905, 9.619492413431146, 8.201227547469296, 46.50016373256051, 12.686071270223549, 11.740315204355747, 11.904733043178034, 175.7193243600058, 67.90855149528117, 28.949081818112077, 100.65665171699312, 15.437562764983248, 38.753586560028225, 64.17373517088967, 103.60263071297243, 24.336752054569875, 24.164828576715298, 91.36662781328803, 53.81939158561221, 103.6758955926713, 13.323691706992804, 55.059777645590074, 53.655031641035485, 33.93922291661113, 12.747154395560724, 98.90059963531021, 41.340548529740914, 33.660209094827785, 101.96004768363545, 130.90515036467562, 3.8767832613068727, 70.71798157101078, 25.030442791409953, 1.8820778874899067, 280.24842773434614, 3.496255848625421, 26.97141387388841, 15.012044287260109, 6.125234341889154, 0.0, 34.89878174734327, 40.909544827696884, 126.5061480971522, 7.5611005849954225, 3.0236197673611893, 55.40130122007993, 44.64837488720504, 0.0, 36.86082154153443, 74.80874881550554, 0.0, 17.7029642001653, 41.35757137148293, 20.864921467954996, 122.85247116196219, 119.43187059221472, 1.9369260815032507, 24.992743570983396, 28.724057507929764, 132.59002059488748, 35.6459417273378, 30.904404765404493, 4.441645596058952, 52.397668434172225, 27.51109623251551, 131.67170663605827, 4.155135092342745, 1.7842496899521456, 16.274352575774078, 54.56942793880252, 6.187902211313596, 129.13123224842278, 24.92635269654521, 132.5119121512403, 77.20499560433355, 4.569179305663574, 0.9155214228429817, 0.0, 123.04795569473481, 72.13917233826766, 104.14170845870157, 58.051957428402496, 27.30201985441863, 22.287437819517997, 170.23639373807015, 53.04848333181831, 0.8639898835191236, 0.0, 28.336937828262286, 49.420756332990884, 2.9876007662925126, 28.52978961304919, 0.0, 20.37137410705082, 53.204589710107825, 4.1624695514624666, 177.5325819100387, 47.6662175768886, 3.2610777119665144, 28.499778187357375, 134.53400647915004, 24.449107785711917, 79.6789978815536, 224.75836041036249, 58.07770247363015, 3.9143794728886503, 85.37680946169166, 29.92379260170823, 6.249399422941209, 14.878879807799322, 80.85208753158606, 203.0997303376355, 115.2404766272041, 53.40654890155429, 118.55017409017888, 53.79725896391043, 0.0, 67.98582309693583, 8.408901944537151, 6.0550639814295995, 88.51701811883173, 65.29215546790043, 23.054652053523746, 17.627264135327447, 62.37804883188791, 2.3582682303587577, 3.295179617620951, 81.77562652601232, 25.390788237454426, 19.29130926621893, 53.04835801041886, 216.29733105927335, 19.558733626789948, 16.66544451450415, 199.21900744000462, 180.23105061838456, 4.335904599864115, 123.0960212608972, 0.0, 34.92096866731209, 31.12557099332297, 56.22380330725233, 43.79695933003203, 28.535008560390455, 3.6557992631310787, 70.5131049039222, 82.31332855525281, 89.6433941450837, 4.57910924487604, 90.94735517754387, 30.588069080217572, 58.79093013722942, 61.78514750679294, 67.48472964390102, 75.96584306294778, 139.0745885046738, 2.672003365639437, 87.95375279198647, 0.0, 71.76547864310784, 25.359265490469376, 3.5418844257709496, 67.28575092963506, 0.0, 28.869003880214848, 145.8818406915704, 69.54551703292884, 126.45294734240277, 90.4046525649868, 174.65098894642747, 146.51057647870147, 87.13340249735242, 50.257510229997735, 42.58978373750542, 29.58459349186434, 109.89742779068965, 157.66666971229282, 36.661652930050806, 18.642192842287194, 8.875515747407583, 43.80940377817539, 67.29645821846206, 132.27742754487738, 5.060111951243629, 1.6415860837601046, 10.227962761691057, 169.899564391554, 75.75886957085403, 78.57568468016511, 22.1988514548372, 71.82909794226654, 0.0, 93.27456381308335, 8.554299161376276, 44.03531652045026, 0.8327876206422071, 4.907116267227307, 47.43206626509669, 55.48665668889343, 1.0942122100425518]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.193254955971537, "mean_inference_ms": 4.060822691179487, "mean_action_processing_ms": 2.0136252944367543, "mean_env_wait_ms": 1.2610249221661076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036394596099853516, "StateBufferConnector_ms": 0.01974654197692871, "ViewRequirementAgentConnector_ms": 0.11760449409484863}, "num_episodes": 0, "episode_return_max": 267.8999999999996, "episode_return_min": 13.594807418318242, "episode_return_mean": 91.16527360920308, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 250.36872091032578, "num_env_steps_trained_throughput_per_sec": 250.36872091032578, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 32634.514, "restore_workers_time_ms": 0.039, "training_step_time_ms": 32634.183, "sample_time_ms": 1383.28, "learn_time_ms": 31213.634, "learn_throughput": 256.298, "synch_weights_time_ms": 29.803}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 21, "trial_id": "cd905_00000", "date": "2024-08-20_09-35-36", "timestamp": 1724126736, "time_this_iter_s": 31.990406274795532, "time_total_s": 695.1026294231415, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f0da60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 695.1026294231415, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 32.39565217391305, "ram_util_percent": 82.14782608695651}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6936368712475376, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 0.0001, "total_loss": 2.292412683131203, "policy_loss": -0.002815448273239391, "vf_loss": 2.295227847591279, "vf_explained_var": -0.008988665588318356, "kl": 0.005656605011718451, "entropy": 1.4876402485938298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 13545.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3542414168812453, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 0.0001, "total_loss": 1.8132081688396515, "policy_loss": -0.0016986289312915196, "vf_loss": 1.8149068014962333, "vf_explained_var": 0.0027666979365878635, "kl": 0.001166530412184683, "entropy": 1.5783517292567661, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 13545.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 213.04273044520508, "episode_reward_min": 19.2081396620712, "episode_reward_mean": 76.22821985696316, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -265.6240222741168, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 116.25841391623942, "predator_policy": 292.58087291646217}, "policy_reward_mean": {"prey_policy": -3.6320451629023336, "predator_policy": 41.74615509138405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [129.49999999999903, 213.04273044520508, 151.92124065724752, 75.40578290876122, 38.11074010394973, 58.982243461433534, 34.637714039825745, 65.60562267842191, 131.699999999999, 52.52394831088469, 45.200000000000394, 137.38013599426793, 132.3817608642044, 53.200000000000344, 65.79022427096632, 100.85666844039302, 68.29999999999997, 107.19999999999916, 33.214548940947395, 107.35871592251672, 137.0999999999988, 62.11976108738957, 97.79999999999916, 74.59999999999968, 37.210134020939876, 96.5999999999992, 117.19999999999897, 100.69999999999901, 37.10000000000026, 110.4284277240949, 166.5999999999994, 90.49999999999923, 39.90000000000031, 85.79999999999892, 65.80000000000028, 83.19999999999905, 100.30193211145217, 85.69999999999928, 37.50000000000026, 121.5848244283965, 54.2000000000004, 121.1999999999989, 38.90000000000028, 41.43503095591278, 109.59999999999893, 21.036433861416846, 71.19999999999993, 56.80000000000043, 99.90354418381563, 37.600000000000264, 71.8999999999999, 118.20190391453116, 44.4000000000004, 117.8755106877905, 77.49999999999936, 151.59999999999843, 19.2081396620712, 37.90000000000027, 164.89999999999858, 28.00000000000013, 49.50000000000026, 46.41382178138786, 32.64858966405307, 46.49208570723924, 140.69999999999857, 92.39999999999884, 96.39999999999885, 75.89999999999955, 37.000000000000256, 75.8999999999999, 56.25234980239656, 29.66703554440777, 44.05777181030725, 50.20000000000045, 43.70000000000039, 29.84346183916591, 37.29971715296601, 76.59999999999943, 124.88481886074283, 38.300000000000274, 65.70000000000034, 73.89999999999975, 95.14678013269375, 73.77731651863117, 74.03915486732845, 50.400000000000446, 93.16438879610476, 59.84582824739595, 84.79999999999902, 98.2999999999985, 27.765308296605657, 83.899999999999, 49.30000000000046, 76.52947232938965, 76.09254493138974, 52.40000000000041, 61.10000000000042, 87.19999999999874, 44.383819737294516, 37.50000000000026], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [93.6013171070368, -38.27022127409019, -40.50184113423018, 81.587848879099, 60.9599385381947, -4.565162303365746, 10.808055080256324, -24.7812713889414, -68.10208984287054, -23.057047203874525, -52.283599601514666, -103.77458850467451, 8.213603354420213, -64.20164547222151, -22.431791971049137, 16.27193600636309, 3.9407345095307345, 98.85811557422858, 9.293105024278493, -24.054907643029097, -89.43685415291169, -40.113990418873726, 29.77094791528199, -88.38927629634505, -163.23705136989395, 30.563170722684283, -132.31057647870227, -48.133402497352265, -2.0809858447966274, -24.97608385174034, -33.69386299058661, -4.931489851574822, -107.6666697122933, -18.36165293005059, 0.15780715771280254, 79.52448425259215, -18.699346700715466, -59.19196635497486, -47.677427544877304, 17.69860397127375, 116.25841391623942, 8.972037238308907, -58.07213666308998, -125.46653621192985, -15.290945746770483, 12.3164096117684, -52.32909794226686, 55.1000000000002, -33.11378379545256, -31.504945158067002, 32.664683479549836, 19.067212379357798, 40.790996152414635, 24.069821315261596, 25.313343311106674, 18.80578778995745, -12.61837993755454, 7.262251062975134, 33.21755448347508, 50.76302259553094, -0.602378755808338, 85.1054537988366, 20.000000000000014, 61.337345728229735, -42.688626517394866, -19.778332983590282, 58.290511348729645, 16.38313347817557, 26.300000000000114, 36.095229863243574, -37.28225637461729, 34.03991225601755, -37.9053521540635, 14.417833372312348, 10.261901573825757, 7.949042796326748, 20.000000000000014, -34.098354341692676, 5.023758685796752, 53.96495241697934, 0.4082360101174193, 3.34619248341506, 51.55572624763131, -6.228395157307343, 11.303359032347617, 14.479779775577368, -52.265993495555335, 10.399463458206771, 78.9692913194858, -60.5836762686236, -16.025308271786372, -51.16929641455692, 20.000000000000014, 38.612755360688936, -19.784743704484896, -22.16888305434329, 35.855562005998465, 36.435383350267756, 20.000000000000014, -23.62738595572, 40.70000000000024, 25.604436531262195, 25.5409759388385, 47.02105635918424, -74.68205155601208, 16.626929156657944, 39.59541611504243, 36.18896013272486, -24.009330831326785, -70.53080646624996, 77.59999999999923, 73.99999999999949, -221.0377556545228, -91.68183901756971, -21.712338651078177, 12.015605846919714, 110.18939990824572, 41.42823211718397, -265.6240222741168, 0.8742428316383485, -6.9765354605320695, 14.792160108552013, -14.473149977365296, -18.275654657002256, 10.995008854787406, -42.78596188783942, 25.949374426758368, -91.46846399539345, 74.89999999999942, 28.109444030203093, -34.21713144169804, 71.21192983557002, 59.10125765026105, 6.213296381218903, 23.160395146450856, 19.15398013621289, -25.05396175393858, 19.020372702753757, -20.95950011618862, 38.902749602956334, -9.249699092406384, 33.99782302884174, -47.53871393184905, -41.792866393152295, -37.796769809600235, 20.000000000000014, 20.000000000000014, -19.323236134092532, -25.464995982305, -11.655733960911952, -89.36004494155804, -10.75735728117112, -27.903505142819213, 12.94207748069472, 46.97492863213629, -0.679352081265971, 8.18090924473921, 31.53289164722991, -15.089735608374905, 7.871915763534817, 42.23567346299153, -25.567927162071015, 20.90000000000003, 40.97531736313071, 20.000000000000014, -37.26972969713233, 12.374163988156345, -60.3350703024885, 2.788686159828669, 46.71674349071323, -24.413668332005173, -8.638688084895506, 27.051816098158007, 31.827682175216186, 14.374505697365658, -92.97785714359051, 37.07773053341396, 45.83383863562126, -10.55706354737846, 80.29999999999924, -43.454485030520104, -94.58735015427264, -44.26409837897899, 65.88835903860931, 23.816532372955955, 18.86549411719187, -72.35597404909782, 21.72467564403446, -11.55411895663842, -145.71411229880994, 17.892479559795607, -2.147919394616031, 9.980578646207599, 0.8597917537220624, -99.60234848255105, 25.090669828057035, 14.392765790189708, 1.6512751496293812, 15.901601344830324, -10.640671476378191], "policy_predator_policy_reward": [3.6557992631310787, 70.5131049039222, 82.31332855525281, 89.6433941450837, 4.57910924487604, 90.94735517754387, 30.588069080217572, 58.79093013722942, 61.78514750679294, 67.48472964390102, 75.96584306294778, 139.0745885046738, 2.672003365639437, 87.95375279198647, 0.0, 71.76547864310784, 25.359265490469376, 3.5418844257709496, 67.28575092963506, 0.0, 28.869003880214848, 145.8818406915704, 69.54551703292884, 126.45294734240277, 90.4046525649868, 174.65098894642747, 146.51057647870147, 87.13340249735242, 50.257510229997735, 42.58978373750542, 29.58459349186434, 109.89742779068965, 157.66666971229282, 36.661652930050806, 18.642192842287194, 8.875515747407583, 43.80940377817539, 67.29645821846206, 132.27742754487738, 5.060111951243629, 1.6415860837601046, 10.227962761691057, 169.899564391554, 75.75886957085403, 78.57568468016511, 22.1988514548372, 71.82909794226654, 0.0, 93.27456381308335, 8.554299161376276, 44.03531652045026, 0.8327876206422071, 4.907116267227307, 47.43206626509669, 55.48665668889343, 1.0942122100425518, 30.71837993755473, 11.737748937024833, 20.410384986244157, 6.037465658846329, 43.33184835334643, 38.76507660362531, 2.003317258251525, 7.159337013518915, 48.83601381982943, 53.53094568115619, 4.5094886512705665, 6.616866521824399, 0.0, 3.404770136756631, 68.02539510753984, 18.416949011060318, 26.337879349335658, 97.4515715438685, 28.014495457937088, 39.4745601719104, 0.0, 51.598354341692925, 35.58192583990125, 27.014187485720885, 43.433282098633036, 7.012289407834483, 50.84427375236881, 25.028395157307436, 7.996640967652351, 5.120220224422596, 46.803701979621415, 36.49785901363961, 14.530708680513719, 76.68367626862293, 20.393572213403374, 67.83746633435698, 0.0, 12.58724463931126, 9.20282932119645, 89.55079743763221, 22.699640691550297, 4.912958136000966, 0.0, 41.22738595572025, 0.0, 5.595563468737921, 32.4430475202047, 13.196824096305548, 65.34863161442382, 37.10649078492971, 0.0, 42.09113444002484, 33.00041309260986, 139.0397242049662, 0.0, 0.0, 292.58087291646217, 39.3468614177003, 40.31233865107844, 7.284394153080254, 2.310600091753752, 10.971767882816252, 274.9240222741188, 17.825757168361637, 36.97653546053218, 4.7078398914479545, 25.080882354905608, 54.08174406084985, 3.8535808092654324, 60.58596188783967, 5.442711280480572, 106.56846399539259, 27.868084881470452, 9.822471088326616, 52.01713144169829, 3.3880701644296636, 18.698742349739113, 12.386703618781073, 10.587452952396692, 22.998171764939652, 42.15396175393881, 0.8796272972462453, 47.259500116188825, 10.697250397043883, 31.50422586596109, 0.0, 94.43434642281332, 24.564269446596068, 40.921328141326946, 20.93321347858044, 15.930695948550245, 33.592540185542504, 43.36499598230525, 37.45573396091211, 87.47023955772107, 42.49062450417327, 4.004396215823984, 48.25674859926648, 11.025071367863838, 19.279352081265976, 22.36895943630689, 62.80205853246806, 34.18973560837516, 11.328084236465148, 5.9643265370087, 43.06792716207126, 2.8885443916491713, 9.136138245220327, 69.97732012288057, 42.439189706945875, 61.86301111540674, 59.87521171755606, 24.533725216787097, 0.0, 34.93494357774012, 48.517412839160905, 0.8204637217309283, 33.46442680100137, 30.332014463184606, 108.11716523043482, 0.822269466586287, 1.0661613643789793, 28.55706354737862, 0.0, 54.896990792547854, 110.9101526888498, 61.46409837897924, 0.8116409613907475, 0.9176773953421742, 5.700296114510079, 88.6559740490969, 38.50479668535566, 122.5623207017744, 110.79845548506339, 2.8998438804571016, 33.75559595436329, 40.06666324404032, 10.192966356029949, 112.7023484825503, 49.0093301719431, 12.456325730250978, 15.88345306722402, 3.698398655169637, 28.54067147637835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.137593274346435, "mean_inference_ms": 4.016958329196996, "mean_action_processing_ms": 1.9768434532590136, "mean_env_wait_ms": 1.245446381958116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037910938262939453, "StateBufferConnector_ms": 0.019478201866149902, "ViewRequirementAgentConnector_ms": 0.09882485866546631}, "num_episodes": 72, "episode_return_max": 213.04273044520508, "episode_return_min": 19.2081396620712, "episode_return_mean": 76.22821985696316, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 246.31528521704413, "num_env_steps_trained_throughput_per_sec": 246.31528521704413, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 32606.548, "restore_workers_time_ms": 0.038, "training_step_time_ms": 32606.187, "sample_time_ms": 1388.679, "learn_time_ms": 31181.102, "learn_throughput": 256.566, "synch_weights_time_ms": 29.578}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 22, "trial_id": "cd905_00000", "date": "2024-08-20_09-36-09", "timestamp": 1724126769, "time_this_iter_s": 32.526490926742554, "time_total_s": 727.629120349884, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f75670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 727.629120349884, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 35.004347826086956, "ram_util_percent": 82.3282608695652}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.465016972900383, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 0.0001, "total_loss": 0.8442552506923675, "policy_loss": -0.001288687551970638, "vf_loss": 0.8455438352766491, "vf_explained_var": 0.014570944176779854, "kl": 0.002158827453608468, "entropy": 1.4632838551960294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2455622870297659, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 0.48163984824740697, "policy_loss": -0.001168404258639803, "vf_loss": 0.4828082513478067, "vf_explained_var": 0.0005965841194939992, "kl": 0.0017876166985045995, "entropy": 1.5824835202050587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 213.04273044520508, "episode_reward_min": 19.2081396620712, "episode_reward_mean": 76.22821985696316, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -265.6240222741168, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 116.25841391623942, "predator_policy": 292.58087291646217}, "policy_reward_mean": {"prey_policy": -3.6320451629023336, "predator_policy": 41.74615509138405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [129.49999999999903, 213.04273044520508, 151.92124065724752, 75.40578290876122, 38.11074010394973, 58.982243461433534, 34.637714039825745, 65.60562267842191, 131.699999999999, 52.52394831088469, 45.200000000000394, 137.38013599426793, 132.3817608642044, 53.200000000000344, 65.79022427096632, 100.85666844039302, 68.29999999999997, 107.19999999999916, 33.214548940947395, 107.35871592251672, 137.0999999999988, 62.11976108738957, 97.79999999999916, 74.59999999999968, 37.210134020939876, 96.5999999999992, 117.19999999999897, 100.69999999999901, 37.10000000000026, 110.4284277240949, 166.5999999999994, 90.49999999999923, 39.90000000000031, 85.79999999999892, 65.80000000000028, 83.19999999999905, 100.30193211145217, 85.69999999999928, 37.50000000000026, 121.5848244283965, 54.2000000000004, 121.1999999999989, 38.90000000000028, 41.43503095591278, 109.59999999999893, 21.036433861416846, 71.19999999999993, 56.80000000000043, 99.90354418381563, 37.600000000000264, 71.8999999999999, 118.20190391453116, 44.4000000000004, 117.8755106877905, 77.49999999999936, 151.59999999999843, 19.2081396620712, 37.90000000000027, 164.89999999999858, 28.00000000000013, 49.50000000000026, 46.41382178138786, 32.64858966405307, 46.49208570723924, 140.69999999999857, 92.39999999999884, 96.39999999999885, 75.89999999999955, 37.000000000000256, 75.8999999999999, 56.25234980239656, 29.66703554440777, 44.05777181030725, 50.20000000000045, 43.70000000000039, 29.84346183916591, 37.29971715296601, 76.59999999999943, 124.88481886074283, 38.300000000000274, 65.70000000000034, 73.89999999999975, 95.14678013269375, 73.77731651863117, 74.03915486732845, 50.400000000000446, 93.16438879610476, 59.84582824739595, 84.79999999999902, 98.2999999999985, 27.765308296605657, 83.899999999999, 49.30000000000046, 76.52947232938965, 76.09254493138974, 52.40000000000041, 61.10000000000042, 87.19999999999874, 44.383819737294516, 37.50000000000026], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [93.6013171070368, -38.27022127409019, -40.50184113423018, 81.587848879099, 60.9599385381947, -4.565162303365746, 10.808055080256324, -24.7812713889414, -68.10208984287054, -23.057047203874525, -52.283599601514666, -103.77458850467451, 8.213603354420213, -64.20164547222151, -22.431791971049137, 16.27193600636309, 3.9407345095307345, 98.85811557422858, 9.293105024278493, -24.054907643029097, -89.43685415291169, -40.113990418873726, 29.77094791528199, -88.38927629634505, -163.23705136989395, 30.563170722684283, -132.31057647870227, -48.133402497352265, -2.0809858447966274, -24.97608385174034, -33.69386299058661, -4.931489851574822, -107.6666697122933, -18.36165293005059, 0.15780715771280254, 79.52448425259215, -18.699346700715466, -59.19196635497486, -47.677427544877304, 17.69860397127375, 116.25841391623942, 8.972037238308907, -58.07213666308998, -125.46653621192985, -15.290945746770483, 12.3164096117684, -52.32909794226686, 55.1000000000002, -33.11378379545256, -31.504945158067002, 32.664683479549836, 19.067212379357798, 40.790996152414635, 24.069821315261596, 25.313343311106674, 18.80578778995745, -12.61837993755454, 7.262251062975134, 33.21755448347508, 50.76302259553094, -0.602378755808338, 85.1054537988366, 20.000000000000014, 61.337345728229735, -42.688626517394866, -19.778332983590282, 58.290511348729645, 16.38313347817557, 26.300000000000114, 36.095229863243574, -37.28225637461729, 34.03991225601755, -37.9053521540635, 14.417833372312348, 10.261901573825757, 7.949042796326748, 20.000000000000014, -34.098354341692676, 5.023758685796752, 53.96495241697934, 0.4082360101174193, 3.34619248341506, 51.55572624763131, -6.228395157307343, 11.303359032347617, 14.479779775577368, -52.265993495555335, 10.399463458206771, 78.9692913194858, -60.5836762686236, -16.025308271786372, -51.16929641455692, 20.000000000000014, 38.612755360688936, -19.784743704484896, -22.16888305434329, 35.855562005998465, 36.435383350267756, 20.000000000000014, -23.62738595572, 40.70000000000024, 25.604436531262195, 25.5409759388385, 47.02105635918424, -74.68205155601208, 16.626929156657944, 39.59541611504243, 36.18896013272486, -24.009330831326785, -70.53080646624996, 77.59999999999923, 73.99999999999949, -221.0377556545228, -91.68183901756971, -21.712338651078177, 12.015605846919714, 110.18939990824572, 41.42823211718397, -265.6240222741168, 0.8742428316383485, -6.9765354605320695, 14.792160108552013, -14.473149977365296, -18.275654657002256, 10.995008854787406, -42.78596188783942, 25.949374426758368, -91.46846399539345, 74.89999999999942, 28.109444030203093, -34.21713144169804, 71.21192983557002, 59.10125765026105, 6.213296381218903, 23.160395146450856, 19.15398013621289, -25.05396175393858, 19.020372702753757, -20.95950011618862, 38.902749602956334, -9.249699092406384, 33.99782302884174, -47.53871393184905, -41.792866393152295, -37.796769809600235, 20.000000000000014, 20.000000000000014, -19.323236134092532, -25.464995982305, -11.655733960911952, -89.36004494155804, -10.75735728117112, -27.903505142819213, 12.94207748069472, 46.97492863213629, -0.679352081265971, 8.18090924473921, 31.53289164722991, -15.089735608374905, 7.871915763534817, 42.23567346299153, -25.567927162071015, 20.90000000000003, 40.97531736313071, 20.000000000000014, -37.26972969713233, 12.374163988156345, -60.3350703024885, 2.788686159828669, 46.71674349071323, -24.413668332005173, -8.638688084895506, 27.051816098158007, 31.827682175216186, 14.374505697365658, -92.97785714359051, 37.07773053341396, 45.83383863562126, -10.55706354737846, 80.29999999999924, -43.454485030520104, -94.58735015427264, -44.26409837897899, 65.88835903860931, 23.816532372955955, 18.86549411719187, -72.35597404909782, 21.72467564403446, -11.55411895663842, -145.71411229880994, 17.892479559795607, -2.147919394616031, 9.980578646207599, 0.8597917537220624, -99.60234848255105, 25.090669828057035, 14.392765790189708, 1.6512751496293812, 15.901601344830324, -10.640671476378191], "policy_predator_policy_reward": [3.6557992631310787, 70.5131049039222, 82.31332855525281, 89.6433941450837, 4.57910924487604, 90.94735517754387, 30.588069080217572, 58.79093013722942, 61.78514750679294, 67.48472964390102, 75.96584306294778, 139.0745885046738, 2.672003365639437, 87.95375279198647, 0.0, 71.76547864310784, 25.359265490469376, 3.5418844257709496, 67.28575092963506, 0.0, 28.869003880214848, 145.8818406915704, 69.54551703292884, 126.45294734240277, 90.4046525649868, 174.65098894642747, 146.51057647870147, 87.13340249735242, 50.257510229997735, 42.58978373750542, 29.58459349186434, 109.89742779068965, 157.66666971229282, 36.661652930050806, 18.642192842287194, 8.875515747407583, 43.80940377817539, 67.29645821846206, 132.27742754487738, 5.060111951243629, 1.6415860837601046, 10.227962761691057, 169.899564391554, 75.75886957085403, 78.57568468016511, 22.1988514548372, 71.82909794226654, 0.0, 93.27456381308335, 8.554299161376276, 44.03531652045026, 0.8327876206422071, 4.907116267227307, 47.43206626509669, 55.48665668889343, 1.0942122100425518, 30.71837993755473, 11.737748937024833, 20.410384986244157, 6.037465658846329, 43.33184835334643, 38.76507660362531, 2.003317258251525, 7.159337013518915, 48.83601381982943, 53.53094568115619, 4.5094886512705665, 6.616866521824399, 0.0, 3.404770136756631, 68.02539510753984, 18.416949011060318, 26.337879349335658, 97.4515715438685, 28.014495457937088, 39.4745601719104, 0.0, 51.598354341692925, 35.58192583990125, 27.014187485720885, 43.433282098633036, 7.012289407834483, 50.84427375236881, 25.028395157307436, 7.996640967652351, 5.120220224422596, 46.803701979621415, 36.49785901363961, 14.530708680513719, 76.68367626862293, 20.393572213403374, 67.83746633435698, 0.0, 12.58724463931126, 9.20282932119645, 89.55079743763221, 22.699640691550297, 4.912958136000966, 0.0, 41.22738595572025, 0.0, 5.595563468737921, 32.4430475202047, 13.196824096305548, 65.34863161442382, 37.10649078492971, 0.0, 42.09113444002484, 33.00041309260986, 139.0397242049662, 0.0, 0.0, 292.58087291646217, 39.3468614177003, 40.31233865107844, 7.284394153080254, 2.310600091753752, 10.971767882816252, 274.9240222741188, 17.825757168361637, 36.97653546053218, 4.7078398914479545, 25.080882354905608, 54.08174406084985, 3.8535808092654324, 60.58596188783967, 5.442711280480572, 106.56846399539259, 27.868084881470452, 9.822471088326616, 52.01713144169829, 3.3880701644296636, 18.698742349739113, 12.386703618781073, 10.587452952396692, 22.998171764939652, 42.15396175393881, 0.8796272972462453, 47.259500116188825, 10.697250397043883, 31.50422586596109, 0.0, 94.43434642281332, 24.564269446596068, 40.921328141326946, 20.93321347858044, 15.930695948550245, 33.592540185542504, 43.36499598230525, 37.45573396091211, 87.47023955772107, 42.49062450417327, 4.004396215823984, 48.25674859926648, 11.025071367863838, 19.279352081265976, 22.36895943630689, 62.80205853246806, 34.18973560837516, 11.328084236465148, 5.9643265370087, 43.06792716207126, 2.8885443916491713, 9.136138245220327, 69.97732012288057, 42.439189706945875, 61.86301111540674, 59.87521171755606, 24.533725216787097, 0.0, 34.93494357774012, 48.517412839160905, 0.8204637217309283, 33.46442680100137, 30.332014463184606, 108.11716523043482, 0.822269466586287, 1.0661613643789793, 28.55706354737862, 0.0, 54.896990792547854, 110.9101526888498, 61.46409837897924, 0.8116409613907475, 0.9176773953421742, 5.700296114510079, 88.6559740490969, 38.50479668535566, 122.5623207017744, 110.79845548506339, 2.8998438804571016, 33.75559595436329, 40.06666324404032, 10.192966356029949, 112.7023484825503, 49.0093301719431, 12.456325730250978, 15.88345306722402, 3.698398655169637, 28.54067147637835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.137593274346435, "mean_inference_ms": 4.016958329196996, "mean_action_processing_ms": 1.9768434532590136, "mean_env_wait_ms": 1.245446381958116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037910938262939453, "StateBufferConnector_ms": 0.019478201866149902, "ViewRequirementAgentConnector_ms": 0.09882485866546631}, "num_episodes": 0, "episode_return_max": 213.04273044520508, "episode_return_min": 19.2081396620712, "episode_return_mean": 76.22821985696316, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 247.27120132757443, "num_env_steps_trained_throughput_per_sec": 247.27120132757443, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 32576.409, "restore_workers_time_ms": 0.038, "training_step_time_ms": 32575.553, "sample_time_ms": 1390.157, "learn_time_ms": 31148.441, "learn_throughput": 256.835, "synch_weights_time_ms": 30.112}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 23, "trial_id": "cd905_00000", "date": "2024-08-20_09-36-41", "timestamp": 1724126801, "time_this_iter_s": 32.3880980014801, "time_total_s": 760.0172183513641, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a1058b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 760.0172183513641, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 35.21521739130435, "ram_util_percent": 81.85434782608695}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8056447447647177, "cur_kl_coeff": 2.4414062499999998e-05, "cur_lr": 0.0001, "total_loss": 2.056451850088816, "policy_loss": -0.002383235287630842, "vf_loss": 2.058834934234619, "vf_explained_var": -0.009146860478416322, "kl": 0.0069114085877071295, "entropy": 1.4117668106442407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 14805.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3141859460562941, "cur_kl_coeff": 1.5258789062499999e-06, "cur_lr": 0.0001, "total_loss": 1.5280774318982684, "policy_loss": -0.002716623157602809, "vf_loss": 1.5307940578649915, "vf_explained_var": 0.0016465132198636495, "kl": 0.005817677645072871, "entropy": 1.5885576687161884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 14805.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 124.88481886074283, "episode_reward_min": -58.54358641649709, "episode_reward_mean": 54.80864311402758, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -219.23357738091053, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 88.26113473181482, "predator_policy": 293.58104659740025}, "policy_reward_mean": {"prey_policy": -10.933581663831216, "predator_policy": 38.33790322084493}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.05777181030725, 50.20000000000045, 43.70000000000039, 29.84346183916591, 37.29971715296601, 76.59999999999943, 124.88481886074283, 38.300000000000274, 65.70000000000034, 73.89999999999975, 95.14678013269375, 73.77731651863117, 74.03915486732845, 50.400000000000446, 93.16438879610476, 59.84582824739595, 84.79999999999902, 98.2999999999985, 27.765308296605657, 83.899999999999, 49.30000000000046, 76.52947232938965, 76.09254493138974, 52.40000000000041, 61.10000000000042, 87.19999999999874, 44.383819737294516, 37.50000000000026, 36.00000000000024, 118.07030469356926, 37.10000000000026, -58.54358641649709, 34.52509351904057, 65.90000000000026, 57.90000000000051, 43.40000000000036, 50.00000000000039, 45.00000000000039, 44.25537802102524, 79.59999999999931, 63.50000000000049, 37.80000000000027, 34.200000000000216, 109.09999999999866, 63.0000000000004, 52.56391208297649, 40.80000000000031, 41.10000000000032, 43.30000000000034, 51.260302940064456, 53.2000000000004, 65.66018655345063, 79.09999999999934, 45.900000000000404, 25.524084120669773, 54.10000000000046, 63.50000000000028, 38.10000000000027, 40.600000000000314, 63.80417280664065, 39.000000000000284, 40.40836413535525, 92.1362643192964, 32.40000000000019, 44.50000000000038, 37.700000000000266, 94.2999999999986, 7.17172440032345, 72.60790271660038, 34.60000000000022, 34.49376957060786, 44.7000000000004, 41.20000000000033, 73.32869899180496, 37.10000000000026, 74.7402832533126, 54.5000000000005, 42.792919539168956, 80.20801008560916, 49.452234819266266, 105.1999999999988, 45.36511620726438, 0.2800130327607189, 49.20000000000039, -22.80968173692837, 38.10000000000027, 75.39999999999965, 38.90000000000028, 37.30000000000026, 60.600000000000485, 61.13800529547116, 81.48687501322094, 37.84980734505073, 44.90000000000038, 47.293422403742284, 75.7999999999996, 52.30000000000046, 47.600000000000435, 59.17035016987167, 88.99999999999866], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-37.796769809600235, 20.000000000000014, 20.000000000000014, -19.323236134092532, -25.464995982305, -11.655733960911952, -89.36004494155804, -10.75735728117112, -27.903505142819213, 12.94207748069472, 46.97492863213629, -0.679352081265971, 8.18090924473921, 31.53289164722991, -15.089735608374905, 7.871915763534817, 42.23567346299153, -25.567927162071015, 20.90000000000003, 40.97531736313071, 20.000000000000014, -37.26972969713233, 12.374163988156345, -60.3350703024885, 2.788686159828669, 46.71674349071323, -24.413668332005173, -8.638688084895506, 27.051816098158007, 31.827682175216186, 14.374505697365658, -92.97785714359051, 37.07773053341396, 45.83383863562126, -10.55706354737846, 80.29999999999924, -43.454485030520104, -94.58735015427264, -44.26409837897899, 65.88835903860931, 23.816532372955955, 18.86549411719187, -72.35597404909782, 21.72467564403446, -11.55411895663842, -145.71411229880994, 17.892479559795607, -2.147919394616031, 9.980578646207599, 0.8597917537220624, -99.60234848255105, 25.090669828057035, 14.392765790189708, 1.6512751496293812, 15.901601344830324, -10.640671476378191, -68.62366099457208, 11.734561897298697, 23.82787195602611, 40.70000000000025, -76.338088504861, 15.361510378269932, -219.23357738091053, -136.40196845059683, -72.56241640447959, 11.738852011316572, -54.54066298956882, 7.46905946826441, 0.20394399785607756, 37.893560664416334, 14.232373732022916, 16.178598080545665, -27.160399171914683, -12.445948467133285, 12.72842894286096, -76.74384391443222, -17.5321587262343, 20.000000000000014, 19.10369060141096, 34.25288271808241, 7.00812710032805, 44.30000000000024, -3.573410865659493, 17.496083398109047, 6.284324181085882, -97.34358020437064, -59.183075219424616, 88.26113473181482, 26.48381025081964, -70.84760704117832, -0.2245064136919321, 16.91124540670481, 9.420653304449427, 20.960002888999192, -4.762182781191372, 11.57386891588542, -173.1323039903971, 31.122258549357664, 11.391724284563159, -30.308255425726955, -14.23043470703809, -20.47943214479912, -32.92920745035185, 27.036495851232623, 50.605045821002456, -2.117350666143324, 26.30000000000012, 16.057070690523577, -100.79679010725575, 0.5678149421487142, 1.9149017387670602, 8.697302222498758, -59.56999014073674, -77.92892355520951, -31.664799464938874, 20.000000000000014, 11.780019628685094, -56.0526330222515, 16.21084164734364, 12.619677830116661, 7.372923916069011, 18.74299834340305, 17.060671251070012, 16.165607667749985, -12.83074722682597, 24.939810977330385, -50.840771628933766, -123.00598818759127, -4.699484946917391, 16.68298728164558, 0.2855042517465077, 8.055957597014789, 13.507880421219266, 74.8999999999994, -77.34794021218084, -107.29455461923742, -3.3108718106795956, 15.947453437399476, 3.277367786310748, -58.435677101829754, -46.98865726928471, -105.74253253160491, -8.462491491119756, -83.59291489157658, 5.220835239499941, -56.35983929920119, 19.03857601665419, -58.149073453543885, 14.262845473029904, -10.23965629300789, 20.602263257482537, 4.033280710095124, 29.873233693121247, 6.772091207001855, -129.83864739453566, -8.958841469719628, -14.093069970104786, 15.340129005854859, 7.297218288943959, 23.600000000000065, 39.51881351838617, -23.48126301428151, -20.610185970074177, -19.32899746571745, -137.33749265211955, -73.95718692992828, 20.000000000000014, 20.95806583059277, -192.57928776582406, -46.43857571302313, -11.834228246959238, 16.553937355384647, 27.200000000000134, 25.664762098483596, -37.655479362953734, 19.137724229649624, -49.506055128094225, 20.000000000000014, -0.5668798203009128, 39.66337693647431, -12.2296952950146, -10.053201210508497, 17.00822620224263, -3.7634582570956536, -32.289348332578435, -80.43476273444382, 28.10000000000016, -65.50809514602611, 14.96223725101174, -8.216500653401614, 41.9456951363733, -23.478310040345782, 14.887287437780543, -10.971804195585415, 20.000000000000014, -2.8272345538979042, 35.94871691796741, -105.96974664399929, 48.667085896258705, 13.705831718208794], "policy_predator_policy_reward": [40.921328141326946, 20.93321347858044, 15.930695948550245, 33.592540185542504, 43.36499598230525, 37.45573396091211, 87.47023955772107, 42.49062450417327, 4.004396215823984, 48.25674859926648, 11.025071367863838, 19.279352081265976, 22.36895943630689, 62.80205853246806, 34.18973560837516, 11.328084236465148, 5.9643265370087, 43.06792716207126, 2.8885443916491713, 9.136138245220327, 69.97732012288057, 42.439189706945875, 61.86301111540674, 59.87521171755606, 24.533725216787097, 0.0, 34.93494357774012, 48.517412839160905, 0.8204637217309283, 33.46442680100137, 30.332014463184606, 108.11716523043482, 0.822269466586287, 1.0661613643789793, 28.55706354737862, 0.0, 54.896990792547854, 110.9101526888498, 61.46409837897924, 0.8116409613907475, 0.9176773953421742, 5.700296114510079, 88.6559740490969, 38.50479668535566, 122.5623207017744, 110.79845548506339, 2.8998438804571016, 33.75559595436329, 40.06666324404032, 10.192966356029949, 112.7023484825503, 49.0093301719431, 12.456325730250978, 15.88345306722402, 3.698398655169637, 28.54067147637835, 85.42366099457118, 7.4654381027012695, 50.1507762584684, 3.3916564790761248, 93.83808850486001, 4.238489621730033, 3.5109128176096585, 293.58104659740025, 12.068383644813187, 83.28027426738922, 93.23884721817929, 19.73275630312506, 18.896056002143922, 0.9064393355839178, 9.467626267977051, 3.5214019194543003, 1.7024630568182912, 87.90388458223002, 16.07157105713901, 92.9438439144313, 25.699722052673224, 16.087814694586154, 0.7963093985890458, 25.447117281917773, 12.191872899671916, 0.0, 21.57341086565951, 2.3039166018909367, 12.515675818914085, 112.74358020436976, 76.55015480626666, 3.4717856813419083, 19.9161897491805, 87.44760704117738, 11.402442795870702, 24.47473029409241, 9.679346695550539, 0.7399971110008402, 31.825829829570985, 2.4624840357349917, 185.31004544103936, 0.0, 48.41880241985449, 21.7580316613735, 54.0777546488109, 33.83211220302671, 48.61880834882136, 22.93408980374848, 9.894954178997732, 20.71735066614335, 0.0, 3.5429293094763867, 116.61523900503266, 9.137820280743163, 37.63299653458003, 5.854799504154088, 75.2699901407362, 125.72892355520897, 49.76479946493913, 0.0, 8.629411334176902, 76.24320205938906, 14.704959267880652, 20.2686940612992, 11.727076083930955, 1.1570016565969503, 4.6328295205525265, 2.549255695982363, 48.27198238162551, 31.7552181871683, 67.74077162893376, 138.5059881875904, 23.81408687966819, 8.702410785603597, 18.514495748253488, 10.844042402985178, 5.892119578780699, 0.0, 0.0, 191.81421923174034, 14.0452048709593, 45.92611621892132, 34.77829743638228, 54.98001187913638, 131.80823272402125, 55.41672664747549, 96.5282210648864, 40.22718531780933, 19.279164760500034, 73.05983929920079, 14.790122975151055, 97.64907345354368, 3.2753147375334897, 29.80149608244452, 6.7782552250953465, 43.32648406063993, 5.726766306878938, 12.127908792998115, 126.04538255722008, 55.54502584620311, 38.77849597875053, 40.182455071109395, 14.542309416980705, 4.01270711334111, 47.781186481613986, 41.381263014281764, 29.372660483671154, 55.931639159384936, 17.064948455450647, 194.50974415935616, 0.0, 8.241934169407255, 215.31187843942033, 0.8963033024976018, 2.8827270461019223, 30.49756384547277, 0.0, 22.535237901516528, 3.312686668880303, 54.10506846442406, 0.0, 66.80605512809441, 18.866879820300902, 2.636623063525923, 29.267700590485518, 54.153201210508605, 9.68090667813402, 58.56120038994075, 133.2125328139597, 17.36138559811245, 0.0, 82.30809514602515, 14.077248408114823, 26.470437398016962, 15.691432023425579, 41.64118288054734, 19.812712562219442, 28.57180419558557, 0.0, 30.427234553897925, 2.84033931304909, 126.35104058285343, 13.332914103741498, 13.294168281791176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.083876890282766, "mean_inference_ms": 3.9701126427644824, "mean_action_processing_ms": 1.9382997415621273, "mean_env_wait_ms": 1.2301869000799903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004608869552612305, "StateBufferConnector_ms": 0.014678120613098145, "ViewRequirementAgentConnector_ms": 0.10046982765197754}, "num_episodes": 72, "episode_return_max": 124.88481886074283, "episode_return_min": -58.54358641649709, "episode_return_mean": 54.80864311402758, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 248.00265055056005, "num_env_steps_trained_throughput_per_sec": 248.00265055056005, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 32559.976, "restore_workers_time_ms": 0.039, "training_step_time_ms": 32559.162, "sample_time_ms": 1396.967, "learn_time_ms": 31127.325, "learn_throughput": 257.009, "synch_weights_time_ms": 27.854}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 24, "trial_id": "cd905_00000", "date": "2024-08-20_09-37-14", "timestamp": 1724126834, "time_this_iter_s": 32.30219078063965, "time_total_s": 792.3194091320038, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f0daf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 792.3194091320038, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 35.2608695652174, "ram_util_percent": 82.20869565217393}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5426735112591394, "cur_kl_coeff": 2.4414062499999998e-05, "cur_lr": 0.0001, "total_loss": 1.926795850859748, "policy_loss": -0.0005339297724680769, "vf_loss": 1.9273297599383763, "vf_explained_var": -0.005377739667892456, "kl": 0.0017739407446093819, "entropy": 1.400546573835706, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 15435.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3176708696557889, "cur_kl_coeff": 1.5258789062499999e-06, "cur_lr": 0.0001, "total_loss": 1.237896232850968, "policy_loss": -0.005782533107724573, "vf_loss": 1.2436787652590917, "vf_explained_var": 0.0003523846467336019, "kl": 0.02179413459749441, "entropy": 1.5227712023825872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 15435.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 118.07030469356926, "episode_reward_min": -58.54358641649709, "episode_reward_mean": 54.339999952457035, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -219.23357738091053, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 88.26113473181482, "predator_policy": 293.58104659740025}, "policy_reward_mean": {"prey_policy": -10.58211947087146, "predator_policy": 37.75211944709988}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.70000000000034, 73.89999999999975, 95.14678013269375, 73.77731651863117, 74.03915486732845, 50.400000000000446, 93.16438879610476, 59.84582824739595, 84.79999999999902, 98.2999999999985, 27.765308296605657, 83.899999999999, 49.30000000000046, 76.52947232938965, 76.09254493138974, 52.40000000000041, 61.10000000000042, 87.19999999999874, 44.383819737294516, 37.50000000000026, 36.00000000000024, 118.07030469356926, 37.10000000000026, -58.54358641649709, 34.52509351904057, 65.90000000000026, 57.90000000000051, 43.40000000000036, 50.00000000000039, 45.00000000000039, 44.25537802102524, 79.59999999999931, 63.50000000000049, 37.80000000000027, 34.200000000000216, 109.09999999999866, 63.0000000000004, 52.56391208297649, 40.80000000000031, 41.10000000000032, 43.30000000000034, 51.260302940064456, 53.2000000000004, 65.66018655345063, 79.09999999999934, 45.900000000000404, 25.524084120669773, 54.10000000000046, 63.50000000000028, 38.10000000000027, 40.600000000000314, 63.80417280664065, 39.000000000000284, 40.40836413535525, 92.1362643192964, 32.40000000000019, 44.50000000000038, 37.700000000000266, 94.2999999999986, 7.17172440032345, 72.60790271660038, 34.60000000000022, 34.49376957060786, 44.7000000000004, 41.20000000000033, 73.32869899180496, 37.10000000000026, 74.7402832533126, 54.5000000000005, 42.792919539168956, 80.20801008560916, 49.452234819266266, 105.1999999999988, 45.36511620726438, 0.2800130327607189, 49.20000000000039, -22.80968173692837, 38.10000000000027, 75.39999999999965, 38.90000000000028, 37.30000000000026, 60.600000000000485, 61.13800529547116, 81.48687501322094, 37.84980734505073, 44.90000000000038, 47.293422403742284, 75.7999999999996, 52.30000000000046, 47.600000000000435, 59.17035016987167, 88.99999999999866, 38.39102450851365, 42.95464166095936, 43.41314652391906, 37.60000000000027, 41.74998534297967, 87.88336692275891, 41.82337241447805, 64.20591613251841], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [42.23567346299153, -25.567927162071015, 20.90000000000003, 40.97531736313071, 20.000000000000014, -37.26972969713233, 12.374163988156345, -60.3350703024885, 2.788686159828669, 46.71674349071323, -24.413668332005173, -8.638688084895506, 27.051816098158007, 31.827682175216186, 14.374505697365658, -92.97785714359051, 37.07773053341396, 45.83383863562126, -10.55706354737846, 80.29999999999924, -43.454485030520104, -94.58735015427264, -44.26409837897899, 65.88835903860931, 23.816532372955955, 18.86549411719187, -72.35597404909782, 21.72467564403446, -11.55411895663842, -145.71411229880994, 17.892479559795607, -2.147919394616031, 9.980578646207599, 0.8597917537220624, -99.60234848255105, 25.090669828057035, 14.392765790189708, 1.6512751496293812, 15.901601344830324, -10.640671476378191, -68.62366099457208, 11.734561897298697, 23.82787195602611, 40.70000000000025, -76.338088504861, 15.361510378269932, -219.23357738091053, -136.40196845059683, -72.56241640447959, 11.738852011316572, -54.54066298956882, 7.46905946826441, 0.20394399785607756, 37.893560664416334, 14.232373732022916, 16.178598080545665, -27.160399171914683, -12.445948467133285, 12.72842894286096, -76.74384391443222, -17.5321587262343, 20.000000000000014, 19.10369060141096, 34.25288271808241, 7.00812710032805, 44.30000000000024, -3.573410865659493, 17.496083398109047, 6.284324181085882, -97.34358020437064, -59.183075219424616, 88.26113473181482, 26.48381025081964, -70.84760704117832, -0.2245064136919321, 16.91124540670481, 9.420653304449427, 20.960002888999192, -4.762182781191372, 11.57386891588542, -173.1323039903971, 31.122258549357664, 11.391724284563159, -30.308255425726955, -14.23043470703809, -20.47943214479912, -32.92920745035185, 27.036495851232623, 50.605045821002456, -2.117350666143324, 26.30000000000012, 16.057070690523577, -100.79679010725575, 0.5678149421487142, 1.9149017387670602, 8.697302222498758, -59.56999014073674, -77.92892355520951, -31.664799464938874, 20.000000000000014, 11.780019628685094, -56.0526330222515, 16.21084164734364, 12.619677830116661, 7.372923916069011, 18.74299834340305, 17.060671251070012, 16.165607667749985, -12.83074722682597, 24.939810977330385, -50.840771628933766, -123.00598818759127, -4.699484946917391, 16.68298728164558, 0.2855042517465077, 8.055957597014789, 13.507880421219266, 74.8999999999994, -77.34794021218084, -107.29455461923742, -3.3108718106795956, 15.947453437399476, 3.277367786310748, -58.435677101829754, -46.98865726928471, -105.74253253160491, -8.462491491119756, -83.59291489157658, 5.220835239499941, -56.35983929920119, 19.03857601665419, -58.149073453543885, 14.262845473029904, -10.23965629300789, 20.602263257482537, 4.033280710095124, 29.873233693121247, 6.772091207001855, -129.83864739453566, -8.958841469719628, -14.093069970104786, 15.340129005854859, 7.297218288943959, 23.600000000000065, 39.51881351838617, -23.48126301428151, -20.610185970074177, -19.32899746571745, -137.33749265211955, -73.95718692992828, 20.000000000000014, 20.95806583059277, -192.57928776582406, -46.43857571302313, -11.834228246959238, 16.553937355384647, 27.200000000000134, 25.664762098483596, -37.655479362953734, 19.137724229649624, -49.506055128094225, 20.000000000000014, -0.5668798203009128, 39.66337693647431, -12.2296952950146, -10.053201210508497, 17.00822620224263, -3.7634582570956536, -32.289348332578435, -80.43476273444382, 28.10000000000016, -65.50809514602611, 14.96223725101174, -8.216500653401614, 41.9456951363733, -23.478310040345782, 14.887287437780543, -10.971804195585415, 20.000000000000014, -2.8272345538979042, 35.94871691796741, -105.96974664399929, 48.667085896258705, 13.705831718208794, 18.085119147917563, -18.797374634278455, 20.000000000000014, -5.446271700617107, -4.313895960124887, -36.470594780852174, 0.5910968386982962, 6.3248573569242845, 16.593225564325966, 5.8000319030088345, 48.237030002550256, -24.062451147838118, 10.858858788643161, 19.392744986281365, -85.14460923653216, 8.116663290080737], "policy_predator_policy_reward": [5.9643265370087, 43.06792716207126, 2.8885443916491713, 9.136138245220327, 69.97732012288057, 42.439189706945875, 61.86301111540674, 59.87521171755606, 24.533725216787097, 0.0, 34.93494357774012, 48.517412839160905, 0.8204637217309283, 33.46442680100137, 30.332014463184606, 108.11716523043482, 0.822269466586287, 1.0661613643789793, 28.55706354737862, 0.0, 54.896990792547854, 110.9101526888498, 61.46409837897924, 0.8116409613907475, 0.9176773953421742, 5.700296114510079, 88.6559740490969, 38.50479668535566, 122.5623207017744, 110.79845548506339, 2.8998438804571016, 33.75559595436329, 40.06666324404032, 10.192966356029949, 112.7023484825503, 49.0093301719431, 12.456325730250978, 15.88345306722402, 3.698398655169637, 28.54067147637835, 85.42366099457118, 7.4654381027012695, 50.1507762584684, 3.3916564790761248, 93.83808850486001, 4.238489621730033, 3.5109128176096585, 293.58104659740025, 12.068383644813187, 83.28027426738922, 93.23884721817929, 19.73275630312506, 18.896056002143922, 0.9064393355839178, 9.467626267977051, 3.5214019194543003, 1.7024630568182912, 87.90388458223002, 16.07157105713901, 92.9438439144313, 25.699722052673224, 16.087814694586154, 0.7963093985890458, 25.447117281917773, 12.191872899671916, 0.0, 21.57341086565951, 2.3039166018909367, 12.515675818914085, 112.74358020436976, 76.55015480626666, 3.4717856813419083, 19.9161897491805, 87.44760704117738, 11.402442795870702, 24.47473029409241, 9.679346695550539, 0.7399971110008402, 31.825829829570985, 2.4624840357349917, 185.31004544103936, 0.0, 48.41880241985449, 21.7580316613735, 54.0777546488109, 33.83211220302671, 48.61880834882136, 22.93408980374848, 9.894954178997732, 20.71735066614335, 0.0, 3.5429293094763867, 116.61523900503266, 9.137820280743163, 37.63299653458003, 5.854799504154088, 75.2699901407362, 125.72892355520897, 49.76479946493913, 0.0, 8.629411334176902, 76.24320205938906, 14.704959267880652, 20.2686940612992, 11.727076083930955, 1.1570016565969503, 4.6328295205525265, 2.549255695982363, 48.27198238162551, 31.7552181871683, 67.74077162893376, 138.5059881875904, 23.81408687966819, 8.702410785603597, 18.514495748253488, 10.844042402985178, 5.892119578780699, 0.0, 0.0, 191.81421923174034, 14.0452048709593, 45.92611621892132, 34.77829743638228, 54.98001187913638, 131.80823272402125, 55.41672664747549, 96.5282210648864, 40.22718531780933, 19.279164760500034, 73.05983929920079, 14.790122975151055, 97.64907345354368, 3.2753147375334897, 29.80149608244452, 6.7782552250953465, 43.32648406063993, 5.726766306878938, 12.127908792998115, 126.04538255722008, 55.54502584620311, 38.77849597875053, 40.182455071109395, 14.542309416980705, 4.01270711334111, 47.781186481613986, 41.381263014281764, 29.372660483671154, 55.931639159384936, 17.064948455450647, 194.50974415935616, 0.0, 8.241934169407255, 215.31187843942033, 0.8963033024976018, 2.8827270461019223, 30.49756384547277, 0.0, 22.535237901516528, 3.312686668880303, 54.10506846442406, 0.0, 66.80605512809441, 18.866879820300902, 2.636623063525923, 29.267700590485518, 54.153201210508605, 9.68090667813402, 58.56120038994075, 133.2125328139597, 17.36138559811245, 0.0, 82.30809514602515, 14.077248408114823, 26.470437398016962, 15.691432023425579, 41.64118288054734, 19.812712562219442, 28.57180419558557, 0.0, 30.427234553897925, 2.84033931304909, 126.35104058285343, 13.332914103741498, 13.294168281791176, 37.89737463427871, 1.205905360595807, 21.66470188002804, 6.73621148154815, 38.69143639528387, 45.506200869612194, 26.06706741628285, 4.616978388094507, 13.817662300271778, 5.539065575372706, 41.53166169057121, 22.17712637747725, 8.476903497896085, 3.0948651416571034, 99.39907192379802, 41.83479015517051]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.076380768148607, "mean_inference_ms": 3.9678193995989917, "mean_action_processing_ms": 1.9250272376803013, "mean_env_wait_ms": 1.2220989246499525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049288272857666016, "StateBufferConnector_ms": 0.015129685401916504, "ViewRequirementAgentConnector_ms": 0.1127011775970459}, "num_episodes": 8, "episode_return_max": 118.07030469356926, "episode_return_min": -58.54358641649709, "episode_return_mean": 54.339999952457035, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 246.13188448604436, "num_env_steps_trained_throughput_per_sec": 246.13188448604436, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 32444.897, "restore_workers_time_ms": 0.031, "training_step_time_ms": 32444.123, "sample_time_ms": 1327.979, "learn_time_ms": 31078.467, "learn_throughput": 257.413, "synch_weights_time_ms": 30.439}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 25, "trial_id": "cd905_00000", "date": "2024-08-20_09-37-46", "timestamp": 1724126866, "time_this_iter_s": 32.53553795814514, "time_total_s": 824.8549470901489, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f6bc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 824.8549470901489, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 44.57173913043478, "ram_util_percent": 82.73478260869564}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.547537831382619, "cur_kl_coeff": 1.2207031249999999e-05, "cur_lr": 0.0001, "total_loss": 5.37317182374379, "policy_loss": -0.0005979764851785841, "vf_loss": 5.373769797597613, "vf_explained_var": 0.0010752309882451619, "kl": 0.0015440304617535666, "entropy": 1.3915570429393223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3800759396027951, "cur_kl_coeff": 2.288818359375e-06, "cur_lr": 0.0001, "total_loss": 4.166008504988655, "policy_loss": -0.0046269803038162605, "vf_loss": 4.170635483378455, "vf_explained_var": 0.0001228329681214832, "kl": 0.00987413590063289, "entropy": 1.4549225534711565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 105.1999999999988, "episode_reward_min": -337.33592992764505, "episode_reward_mean": 37.05382939746388, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -499.2664998901272, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 56.58821943034279, "predator_policy": 647.0278579681814}, "policy_reward_mean": {"prey_policy": -22.942360769231737, "predator_policy": 41.4692754679636}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.20000000000033, 73.32869899180496, 37.10000000000026, 74.7402832533126, 54.5000000000005, 42.792919539168956, 80.20801008560916, 49.452234819266266, 105.1999999999988, 45.36511620726438, 0.2800130327607189, 49.20000000000039, -22.80968173692837, 38.10000000000027, 75.39999999999965, 38.90000000000028, 37.30000000000026, 60.600000000000485, 61.13800529547116, 81.48687501322094, 37.84980734505073, 44.90000000000038, 47.293422403742284, 75.7999999999996, 52.30000000000046, 47.600000000000435, 59.17035016987167, 88.99999999999866, 38.39102450851365, 42.95464166095936, 43.41314652391906, 37.60000000000027, 41.74998534297967, 87.88336692275891, 41.82337241447805, 64.20591613251841, 38.80000000000028, 16.800000000000214, 80.99999999999919, 49.30000000000046, 65.3000000000004, -29.810981591280438, 37.000000000000256, 36.70000000000025, 95.59999999999823, 36.00000000000024, -28.797731243934184, 43.200000000000344, 34.94254342990513, 75.2999999999996, 33.318771738218686, 79.89999999999928, 53.529444537542396, 44.40000000000038, 52.95659483993978, 32.184305207165536, 74.19999999999972, 43.50000000000037, -168.27793104318224, 39.31488381272789, 54.32528626348124, 11.000606965771945, -337.33592992764505, -34.03329865949597, 16.31763295604481, 9.285327057847152, 48.00000000000044, 41.50000000000032, 52.20000000000046, -84.52245274406741, 44.400000000000375, 43.90000000000036, 48.90000000000043, 62.300000000000416, 13.970899023779051, 39.100000000000286, 52.700000000000394, 64.5414744879036, 45.800000000000395, 41.00000000000031, 68.70000000000009, 73.3629818220915, -3.386255248650542, 44.474642614820745, 49.500244723650255, 22.232326514157133, 66.40000000000029, 49.20000000000046, 48.90000000000045, 42.600000000000335, -61.70411412129252, 34.90028460546001, 48.60000000000043, 50.361538591763015, 62.40000000000051, 31.203094170886494, -5.722166017299639, 75.79999999999961, 25.447454262239585, 36.98595479209009], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.220835239499941, -56.35983929920119, 19.03857601665419, -58.149073453543885, 14.262845473029904, -10.23965629300789, 20.602263257482537, 4.033280710095124, 29.873233693121247, 6.772091207001855, -129.83864739453566, -8.958841469719628, -14.093069970104786, 15.340129005854859, 7.297218288943959, 23.600000000000065, 39.51881351838617, -23.48126301428151, -20.610185970074177, -19.32899746571745, -137.33749265211955, -73.95718692992828, 20.000000000000014, 20.95806583059277, -192.57928776582406, -46.43857571302313, -11.834228246959238, 16.553937355384647, 27.200000000000134, 25.664762098483596, -37.655479362953734, 19.137724229649624, -49.506055128094225, 20.000000000000014, -0.5668798203009128, 39.66337693647431, -12.2296952950146, -10.053201210508497, 17.00822620224263, -3.7634582570956536, -32.289348332578435, -80.43476273444382, 28.10000000000016, -65.50809514602611, 14.96223725101174, -8.216500653401614, 41.9456951363733, -23.478310040345782, 14.887287437780543, -10.971804195585415, 20.000000000000014, -2.8272345538979042, 35.94871691796741, -105.96974664399929, 48.667085896258705, 13.705831718208794, 18.085119147917563, -18.797374634278455, 20.000000000000014, -5.446271700617107, -4.313895960124887, -36.470594780852174, 0.5910968386982962, 6.3248573569242845, 16.593225564325966, 5.8000319030088345, 48.237030002550256, -24.062451147838118, 10.858858788643161, 19.392744986281365, -85.14460923653216, 8.116663290080737, 14.243142520532352, -2.0537172238953953, -31.66949256371788, -67.80202070488204, 56.58821943034279, 10.419302080303007, 25.975027213215775, 5.061457395056456, 38.7883590699246, 3.300851458024081, -224.70431639113158, -153.6360784590923, -19.8989594751708, 16.80352269286108, 8.422975142566223, -11.88347820259051, 46.10000000000024, 47.14439430839764, -21.019304027822443, -5.543500010434473, -116.1658632547292, -82.56764223786084, 8.80475890239568, 19.89063387892216, -43.44918415711713, 14.348176989230229, -5.549879734200756, 39.266882215140384, 4.912317891102106, 14.41877173821845, 0.1203281245223945, 40.77526475167742, 10.672473479800948, 34.18016840405386, -62.89751963181014, 16.598494371007185, 15.222128314152409, -135.86282610673084, -190.41102869416466, -25.096943429744965, 15.430606007021204, 28.049218075742655, 20.000000000000014, -28.501809251190082, -220.49441113724043, -249.58084304837854, -12.554878735427815, 17.541949674902156, 31.236846282636876, -82.9657795266974, -85.56454603158969, -50.595826925447675, -499.2664998901272, -485.87279800341054, -79.80573947064377, -132.1356044660402, -16.49624368633206, -53.86132833862723, -34.01357040646154, -32.78297999697068, -13.730235699495386, 20.000000000000014, -18.304095068684624, -2.059878718204379, -19.06355636078638, 15.879774342571954, -131.88900300479028, -171.2045728995637, -36.16660282612163, 13.449558504904703, 21.023221609734083, 18.108396714282517, -55.024949426078926, 23.600000000000065, 17.760282717581898, 5.391920162442153, -16.10195318868004, -14.144614635389665, 20.000000000000014, 9.02752853734764, -3.950573235628633, 20.000000000000014, 26.790354259455118, -7.320135586623669, -10.757672156916383, 20.72472240485204, -13.288903212506572, 22.700000000000053, 20.000000000000014, 31.054364048689155, 11.995050855614497, 28.100000000000147, -194.27772147223632, -97.20375470983402, 16.289948073596534, -29.709456686724252, -5.129434458407795, -70.65567807775346, -70.04508240193444, -23.209180007185495, 47.88483586488634, -48.97223467393314, -3.983526433335515, 17.372886985295775, 12.060178160580099, -1.7900289325078185, 17.870418358035067, 14.510118513827551, -448.3792230135147, -107.60220758115688, -19.315966911997776, -18.99019097298828, 25.01344381102813, 5.243598212160752, 20.000000000000014, 12.017917945042685, 31.516580779105755, 20.1407121495026, -18.30426242863478, -15.384041145956415, -44.96742042670333, -49.147189922714524, 47.262988307910724, 15.980181075017752, -36.50128903440148, -106.02064248673176, 14.419526609861899, -11.726789070021068], "policy_predator_policy_reward": [19.279164760500034, 73.05983929920079, 14.790122975151055, 97.64907345354368, 3.2753147375334897, 29.80149608244452, 6.7782552250953465, 43.32648406063993, 5.726766306878938, 12.127908792998115, 126.04538255722008, 55.54502584620311, 38.77849597875053, 40.182455071109395, 14.542309416980705, 4.01270711334111, 47.781186481613986, 41.381263014281764, 29.372660483671154, 55.931639159384936, 17.064948455450647, 194.50974415935616, 0.0, 8.241934169407255, 215.31187843942033, 0.8963033024976018, 2.8827270461019223, 30.49756384547277, 0.0, 22.535237901516528, 3.312686668880303, 54.10506846442406, 0.0, 66.80605512809441, 18.866879820300902, 2.636623063525923, 29.267700590485518, 54.153201210508605, 9.68090667813402, 58.56120038994075, 133.2125328139597, 17.36138559811245, 0.0, 82.30809514602515, 14.077248408114823, 26.470437398016962, 15.691432023425579, 41.64118288054734, 19.812712562219442, 28.57180419558557, 0.0, 30.427234553897925, 2.84033931304909, 126.35104058285343, 13.332914103741498, 13.294168281791176, 37.89737463427871, 1.205905360595807, 21.66470188002804, 6.73621148154815, 38.69143639528387, 45.506200869612194, 26.06706741628285, 4.616978388094507, 13.817662300271778, 5.539065575372706, 41.53166169057121, 22.17712637747725, 8.476903497896085, 3.0948651416571034, 99.39907192379802, 41.83479015517051, 5.356857479467613, 21.25371722389543, 110.04436804331075, 6.227145225289537, 5.311780569657395, 8.680697919696966, 4.324972786784334, 13.93854260494351, 7.611640930075627, 15.599148541975882, 162.4819210132785, 186.047492245665, 8.73425954254456, 31.36117723976527, 10.577024857433745, 29.58347820259068, 2.355605691602584, 0.0, 38.9193040278227, 23.643500010434543, 156.98152707377153, 12.95424717488362, 10.295241097604286, 4.209366121077856, 61.14918415711738, 2.894366440674605, 23.749879734200825, 17.8331177848598, 13.987682108897861, 0.0, 18.179671875477585, 20.824735248322774, 8.676802653687293, 0.0, 84.21310022863764, 6.485925032164376, 20.657724700996443, 152.93956793152063, 26.992292626608574, 220.69998470446572, 18.24844068554539, 12.471735231690893, 0.0, 52.00180925119033, 0.0, 301.79732314243665, 34.327812873253265, 0.0, 3.7160281091826954, 102.33819139835877, 36.87988013013524, 110.2810997926736, 647.0278579681814, 0.7755099977110529, 8.87694324806035, 169.03110202912788, 10.36185316013031, 76.31335182087392, 76.08187746127977, 0.0, 41.73023569949559, 0.0, 0.0, 61.86397378688928, 51.6635563607866, 3.720225657428009, 2.009517620432972, 216.56160553985347, 2.1098112913002276, 65.00723302991692, 3.076778390265948, 1.691603285717475, 13.078861988714143, 67.24608743736492, 19.33911019308839, 19.808686926887535, 42.20867154524478, 2.0087953026036858, 0.0, 10.072471462652326, 36.65057323562864, 0.0, 11.868278986355095, 33.20297682871681, 29.15767215691655, 6.675277595147986, 31.588903212506782, 0.0, 4.014553457896321, 13.631082493414711, 15.261169292088551, 18.006761674388606, 0.0, 288.09522093341934, 3.802143725070661, 54.092007502877586, 36.185903775785114, 89.09945348402512, 106.20391022840444, 9.282678694871985, 0.8151641351138795, 66.6722346739332, 0.0, 35.81063944803969, 9.839821839419868, 28.79002893250783, 1.9295816419649214, 8.289881486172417, 489.04032287605855, 5.236993597322167, 47.62657315056751, 25.57986933987885, 4.486556188971972, 13.856401787839214, 12.529701874676778, 5.813918772043139, 0.9834192208944552, 9.759287850497415, 36.72518755850167, 28.166210186976, 4.243453818904724, 84.14899051321335, 8.937011692089486, 3.6198189249822113, 120.80934699753817, 47.160038785833805, 0.0, 34.293217252248894]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.032104190703978, "mean_inference_ms": 3.922361248763732, "mean_action_processing_ms": 1.9035922005839263, "mean_env_wait_ms": 1.2153538805986583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004538893699645996, "StateBufferConnector_ms": 0.01564633846282959, "ViewRequirementAgentConnector_ms": 0.1121755838394165}, "num_episodes": 64, "episode_return_max": 105.1999999999988, "episode_return_min": -337.33592992764505, "episode_return_mean": 37.05382939746388, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 241.70261329068057, "num_env_steps_trained_throughput_per_sec": 241.70261329068057, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 32514.646, "restore_workers_time_ms": 0.031, "training_step_time_ms": 32513.871, "sample_time_ms": 1337.248, "learn_time_ms": 31139.235, "learn_throughput": 256.911, "synch_weights_time_ms": 29.938}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 26, "trial_id": "cd905_00000", "date": "2024-08-20_09-38-19", "timestamp": 1724126899, "time_this_iter_s": 33.1271710395813, "time_total_s": 857.9821181297302, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a105a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 857.9821181297302, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 45.693617021276594, "ram_util_percent": 82.89361702127661}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6884076489106057, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 0.0001, "total_loss": 9.78578158333188, "policy_loss": -0.0023415148912352465, "vf_loss": 9.78812308084397, "vf_explained_var": -0.0002630568685985747, "kl": 0.006866063860459127, "entropy": 1.4066364085863508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 16695.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5888257302107319, "cur_kl_coeff": 2.288818359375e-06, "cur_lr": 0.0001, "total_loss": 8.840165919349307, "policy_loss": -0.005830926903050452, "vf_loss": 8.845996797652472, "vf_explained_var": -1.5948878394232856e-05, "kl": 0.014889994526581019, "entropy": 1.3959348459092398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 16695.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 105.1999999999988, "episode_reward_min": -470.7042687225246, "episode_reward_mean": 17.048036179535934, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1060.581007095729, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 56.58821943034279, "predator_policy": 1090.0390707938982}, "policy_reward_mean": {"prey_policy": -66.82282544938629, "predator_policy": 75.3468435391542}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.1999999999988, 45.36511620726438, 0.2800130327607189, 49.20000000000039, -22.80968173692837, 38.10000000000027, 75.39999999999965, 38.90000000000028, 37.30000000000026, 60.600000000000485, 61.13800529547116, 81.48687501322094, 37.84980734505073, 44.90000000000038, 47.293422403742284, 75.7999999999996, 52.30000000000046, 47.600000000000435, 59.17035016987167, 88.99999999999866, 38.39102450851365, 42.95464166095936, 43.41314652391906, 37.60000000000027, 41.74998534297967, 87.88336692275891, 41.82337241447805, 64.20591613251841, 38.80000000000028, 16.800000000000214, 80.99999999999919, 49.30000000000046, 65.3000000000004, -29.810981591280438, 37.000000000000256, 36.70000000000025, 95.59999999999823, 36.00000000000024, -28.797731243934184, 43.200000000000344, 34.94254342990513, 75.2999999999996, 33.318771738218686, 79.89999999999928, 53.529444537542396, 44.40000000000038, 52.95659483993978, 32.184305207165536, 74.19999999999972, 43.50000000000037, -168.27793104318224, 39.31488381272789, 54.32528626348124, 11.000606965771945, -337.33592992764505, -34.03329865949597, 16.31763295604481, 9.285327057847152, 48.00000000000044, 41.50000000000032, 52.20000000000046, -84.52245274406741, 44.400000000000375, 43.90000000000036, 48.90000000000043, 62.300000000000416, 13.970899023779051, 39.100000000000286, 52.700000000000394, 64.5414744879036, 45.800000000000395, 41.00000000000031, 68.70000000000009, 73.3629818220915, -3.386255248650542, 44.474642614820745, 49.500244723650255, 22.232326514157133, 66.40000000000029, 49.20000000000046, 48.90000000000045, 42.600000000000335, -61.70411412129252, 34.90028460546001, 48.60000000000043, 50.361538591763015, 62.40000000000051, 31.203094170886494, -5.722166017299639, 75.79999999999961, 25.447454262239585, 36.98595479209009, -193.20638377889148, -143.92632629142724, -118.83552475523545, -73.63948888152956, -300.9509098768816, -470.7042687225246, 38.10660255313603, -284.1008753502771], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [39.51881351838617, -23.48126301428151, -20.610185970074177, -19.32899746571745, -137.33749265211955, -73.95718692992828, 20.000000000000014, 20.95806583059277, -192.57928776582406, -46.43857571302313, -11.834228246959238, 16.553937355384647, 27.200000000000134, 25.664762098483596, -37.655479362953734, 19.137724229649624, -49.506055128094225, 20.000000000000014, -0.5668798203009128, 39.66337693647431, -12.2296952950146, -10.053201210508497, 17.00822620224263, -3.7634582570956536, -32.289348332578435, -80.43476273444382, 28.10000000000016, -65.50809514602611, 14.96223725101174, -8.216500653401614, 41.9456951363733, -23.478310040345782, 14.887287437780543, -10.971804195585415, 20.000000000000014, -2.8272345538979042, 35.94871691796741, -105.96974664399929, 48.667085896258705, 13.705831718208794, 18.085119147917563, -18.797374634278455, 20.000000000000014, -5.446271700617107, -4.313895960124887, -36.470594780852174, 0.5910968386982962, 6.3248573569242845, 16.593225564325966, 5.8000319030088345, 48.237030002550256, -24.062451147838118, 10.858858788643161, 19.392744986281365, -85.14460923653216, 8.116663290080737, 14.243142520532352, -2.0537172238953953, -31.66949256371788, -67.80202070488204, 56.58821943034279, 10.419302080303007, 25.975027213215775, 5.061457395056456, 38.7883590699246, 3.300851458024081, -224.70431639113158, -153.6360784590923, -19.8989594751708, 16.80352269286108, 8.422975142566223, -11.88347820259051, 46.10000000000024, 47.14439430839764, -21.019304027822443, -5.543500010434473, -116.1658632547292, -82.56764223786084, 8.80475890239568, 19.89063387892216, -43.44918415711713, 14.348176989230229, -5.549879734200756, 39.266882215140384, 4.912317891102106, 14.41877173821845, 0.1203281245223945, 40.77526475167742, 10.672473479800948, 34.18016840405386, -62.89751963181014, 16.598494371007185, 15.222128314152409, -135.86282610673084, -190.41102869416466, -25.096943429744965, 15.430606007021204, 28.049218075742655, 20.000000000000014, -28.501809251190082, -220.49441113724043, -249.58084304837854, -12.554878735427815, 17.541949674902156, 31.236846282636876, -82.9657795266974, -85.56454603158969, -50.595826925447675, -499.2664998901272, -485.87279800341054, -79.80573947064377, -132.1356044660402, -16.49624368633206, -53.86132833862723, -34.01357040646154, -32.78297999697068, -13.730235699495386, 20.000000000000014, -18.304095068684624, -2.059878718204379, -19.06355636078638, 15.879774342571954, -131.88900300479028, -171.2045728995637, -36.16660282612163, 13.449558504904703, 21.023221609734083, 18.108396714282517, -55.024949426078926, 23.600000000000065, 17.760282717581898, 5.391920162442153, -16.10195318868004, -14.144614635389665, 20.000000000000014, 9.02752853734764, -3.950573235628633, 20.000000000000014, 26.790354259455118, -7.320135586623669, -10.757672156916383, 20.72472240485204, -13.288903212506572, 22.700000000000053, 20.000000000000014, 31.054364048689155, 11.995050855614497, 28.100000000000147, -194.27772147223632, -97.20375470983402, 16.289948073596534, -29.709456686724252, -5.129434458407795, -70.65567807775346, -70.04508240193444, -23.209180007185495, 47.88483586488634, -48.97223467393314, -3.983526433335515, 17.372886985295775, 12.060178160580099, -1.7900289325078185, 17.870418358035067, 14.510118513827551, -448.3792230135147, -107.60220758115688, -19.315966911997776, -18.99019097298828, 25.01344381102813, 5.243598212160752, 20.000000000000014, 12.017917945042685, 31.516580779105755, 20.1407121495026, -18.30426242863478, -15.384041145956415, -44.96742042670333, -49.147189922714524, 47.262988307910724, 15.980181075017752, -36.50128903440148, -106.02064248673176, 14.419526609861899, -11.726789070021068, -441.10254517447567, -454.3440794034881, -429.7594410868196, -612.8805814700316, -444.9199359844104, -512.0507683660354, -341.9615294402062, -305.74942837668107, -848.0082461103301, -806.4814891829232, -1060.581007095729, -866.0225243925978, -385.9550614717729, -334.79047839491056, -425.7580029943712, -637.3264720745561], "policy_predator_policy_reward": [47.781186481613986, 41.381263014281764, 29.372660483671154, 55.931639159384936, 17.064948455450647, 194.50974415935616, 0.0, 8.241934169407255, 215.31187843942033, 0.8963033024976018, 2.8827270461019223, 30.49756384547277, 0.0, 22.535237901516528, 3.312686668880303, 54.10506846442406, 0.0, 66.80605512809441, 18.866879820300902, 2.636623063525923, 29.267700590485518, 54.153201210508605, 9.68090667813402, 58.56120038994075, 133.2125328139597, 17.36138559811245, 0.0, 82.30809514602515, 14.077248408114823, 26.470437398016962, 15.691432023425579, 41.64118288054734, 19.812712562219442, 28.57180419558557, 0.0, 30.427234553897925, 2.84033931304909, 126.35104058285343, 13.332914103741498, 13.294168281791176, 37.89737463427871, 1.205905360595807, 21.66470188002804, 6.73621148154815, 38.69143639528387, 45.506200869612194, 26.06706741628285, 4.616978388094507, 13.817662300271778, 5.539065575372706, 41.53166169057121, 22.17712637747725, 8.476903497896085, 3.0948651416571034, 99.39907192379802, 41.83479015517051, 5.356857479467613, 21.25371722389543, 110.04436804331075, 6.227145225289537, 5.311780569657395, 8.680697919696966, 4.324972786784334, 13.93854260494351, 7.611640930075627, 15.599148541975882, 162.4819210132785, 186.047492245665, 8.73425954254456, 31.36117723976527, 10.577024857433745, 29.58347820259068, 2.355605691602584, 0.0, 38.9193040278227, 23.643500010434543, 156.98152707377153, 12.95424717488362, 10.295241097604286, 4.209366121077856, 61.14918415711738, 2.894366440674605, 23.749879734200825, 17.8331177848598, 13.987682108897861, 0.0, 18.179671875477585, 20.824735248322774, 8.676802653687293, 0.0, 84.21310022863764, 6.485925032164376, 20.657724700996443, 152.93956793152063, 26.992292626608574, 220.69998470446572, 18.24844068554539, 12.471735231690893, 0.0, 52.00180925119033, 0.0, 301.79732314243665, 34.327812873253265, 0.0, 3.7160281091826954, 102.33819139835877, 36.87988013013524, 110.2810997926736, 647.0278579681814, 0.7755099977110529, 8.87694324806035, 169.03110202912788, 10.36185316013031, 76.31335182087392, 76.08187746127977, 0.0, 41.73023569949559, 0.0, 0.0, 61.86397378688928, 51.6635563607866, 3.720225657428009, 2.009517620432972, 216.56160553985347, 2.1098112913002276, 65.00723302991692, 3.076778390265948, 1.691603285717475, 13.078861988714143, 67.24608743736492, 19.33911019308839, 19.808686926887535, 42.20867154524478, 2.0087953026036858, 0.0, 10.072471462652326, 36.65057323562864, 0.0, 11.868278986355095, 33.20297682871681, 29.15767215691655, 6.675277595147986, 31.588903212506782, 0.0, 4.014553457896321, 13.631082493414711, 15.261169292088551, 18.006761674388606, 0.0, 288.09522093341934, 3.802143725070661, 54.092007502877586, 36.185903775785114, 89.09945348402512, 106.20391022840444, 9.282678694871985, 0.8151641351138795, 66.6722346739332, 0.0, 35.81063944803969, 9.839821839419868, 28.79002893250783, 1.9295816419649214, 8.289881486172417, 489.04032287605855, 5.236993597322167, 47.62657315056751, 25.57986933987885, 4.486556188971972, 13.856401787839214, 12.529701874676778, 5.813918772043139, 0.9834192208944552, 9.759287850497415, 36.72518755850167, 28.166210186976, 4.243453818904724, 84.14899051321335, 8.937011692089486, 3.6198189249822113, 120.80934699753817, 47.160038785833805, 0.0, 34.293217252248894, 120.04037475656547, 582.1998660425064, 327.0021764820308, 571.7115197833932, 423.5837495091091, 414.5514300861003, 400.6992702200887, 173.37219871526992, 843.2903086833129, 510.24851673305875, 1090.0390707938982, 365.8601919719043, 416.70264410079375, 342.1494983190252, 20.202726027585015, 758.7808736910658]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.024421912832834, "mean_inference_ms": 3.9210229044102056, "mean_action_processing_ms": 1.891632350644043, "mean_env_wait_ms": 1.2082298443826056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004408478736877441, "StateBufferConnector_ms": 0.014984130859375, "ViewRequirementAgentConnector_ms": 0.1100311279296875}, "num_episodes": 8, "episode_return_max": 105.1999999999988, "episode_return_min": -470.7042687225246, "episode_return_mean": 17.048036179535934, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 247.95404522017904, "num_env_steps_trained_throughput_per_sec": 247.95404522017904, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 32490.602, "restore_workers_time_ms": 0.031, "training_step_time_ms": 32489.795, "sample_time_ms": 1356.352, "learn_time_ms": 31100.768, "learn_throughput": 257.228, "synch_weights_time_ms": 25.812}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 27, "trial_id": "cd905_00000", "date": "2024-08-20_09-38-52", "timestamp": 1724126932, "time_this_iter_s": 32.30598187446594, "time_total_s": 890.2881000041962, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16aff6430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 890.2881000041962, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 40.495652173913044, "ram_util_percent": 82.28695652173914}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7238207068471681, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 0.0001, "total_loss": 9.612692872304764, "policy_loss": -0.0013961486862085406, "vf_loss": 9.614089030311222, "vf_explained_var": 0.0015226846649533227, "kl": 0.0018042535142507898, "entropy": 1.448404774400923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 17325.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.42406610810449197, "cur_kl_coeff": 2.288818359375e-06, "cur_lr": 0.0001, "total_loss": 9.504163251604353, "policy_loss": -0.005525416048568866, "vf_loss": 9.509688674079047, "vf_explained_var": 0.00012637670077974834, "kl": 0.013294597452483094, "entropy": 1.3420713462526837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 17325.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 160.34165380689834, "episode_reward_min": -624.4593522838353, "episode_reward_mean": -113.6813152717787, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1266.3461136330172, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 47.88483586488634, "predator_policy": 1283.5986021996678}, "policy_reward_mean": {"prey_policy": -405.95462903966194, "predator_policy": 349.1139714037726}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.90000000000043, 62.300000000000416, 13.970899023779051, 39.100000000000286, 52.700000000000394, 64.5414744879036, 45.800000000000395, 41.00000000000031, 68.70000000000009, 73.3629818220915, -3.386255248650542, 44.474642614820745, 49.500244723650255, 22.232326514157133, 66.40000000000029, 49.20000000000046, 48.90000000000045, 42.600000000000335, -61.70411412129252, 34.90028460546001, 48.60000000000043, 50.361538591763015, 62.40000000000051, 31.203094170886494, -5.722166017299639, 75.79999999999961, 25.447454262239585, 36.98595479209009, -193.20638377889148, -143.92632629142724, -118.83552475523545, -73.63948888152956, -300.9509098768816, -470.7042687225246, 38.10660255313603, -284.1008753502771, -222.95525338585747, 18.39900806056668, -423.0504918203116, 0.6629342366784989, -38.56145158759902, -83.6622159732456, -385.1043654906134, 53.64835853140946, -312.4861180185688, -205.9762046401482, -251.17544366451358, -432.1261698942641, -70.53387668026822, 160.34165380689834, -402.97860437472855, -263.04085821253005, -160.53074678947814, 31.90221726735733, -199.8472289962298, -406.3543121745533, -81.33254649069714, -3.9751965643173186, 118.58461588777168, -388.8591663706173, -77.17413735701446, 13.946383732175306, -70.87513920810764, -624.4593522838353, 12.658335184195057, -273.958238101602, -44.43829761032753, -12.523605558027022, -367.57332192924895, -443.13450902364013, 10.055439710839622, -42.423640743289766, 39.376864447798, -113.0783258232421, -525.1709716936007, -440.4637859501906, -296.66126161303043, -307.2360457152395, -294.82696620794115, -224.60170439500703, -234.59562500892227, -162.7046268008175, 25.172974431139895, -317.2314804233089, 69.6000000000001, -364.45620578954384, -151.15379425559564, -30.65594593290659, -388.35553650823545, 4.732273832214414, -28.72271784874998, -20.6505113413556, -564.7250411744576, -476.93409455711674, 75.66275692601899, -125.30529363647801, -54.6925640765931, -173.71744088934764, 46.05333371369856, -45.18942947928892], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-55.024949426078926, 23.600000000000065, 17.760282717581898, 5.391920162442153, -16.10195318868004, -14.144614635389665, 20.000000000000014, 9.02752853734764, -3.950573235628633, 20.000000000000014, 26.790354259455118, -7.320135586623669, -10.757672156916383, 20.72472240485204, -13.288903212506572, 22.700000000000053, 20.000000000000014, 31.054364048689155, 11.995050855614497, 28.100000000000147, -194.27772147223632, -97.20375470983402, 16.289948073596534, -29.709456686724252, -5.129434458407795, -70.65567807775346, -70.04508240193444, -23.209180007185495, 47.88483586488634, -48.97223467393314, -3.983526433335515, 17.372886985295775, 12.060178160580099, -1.7900289325078185, 17.870418358035067, 14.510118513827551, -448.3792230135147, -107.60220758115688, -19.315966911997776, -18.99019097298828, 25.01344381102813, 5.243598212160752, 20.000000000000014, 12.017917945042685, 31.516580779105755, 20.1407121495026, -18.30426242863478, -15.384041145956415, -44.96742042670333, -49.147189922714524, 47.262988307910724, 15.980181075017752, -36.50128903440148, -106.02064248673176, 14.419526609861899, -11.726789070021068, -441.10254517447567, -454.3440794034881, -429.7594410868196, -612.8805814700316, -444.9199359844104, -512.0507683660354, -341.9615294402062, -305.74942837668107, -848.0082461103301, -806.4814891829232, -1060.581007095729, -866.0225243925978, -385.9550614717729, -334.79047839491056, -425.7580029943712, -637.3264720745561, -508.5336498266779, -335.87183621541726, -669.6186727198437, -720.8372074943597, -741.8166837760855, -965.0752807002566, -158.27157291013094, -122.65417709571186, -171.03983966728114, -274.513572184793, -580.9615617626263, -517.508312784154, -592.9492890711743, -691.1085423681467, -372.46833377055646, -410.2359521676138, -604.0691813860385, -637.179672599315, -513.6532597522512, -486.461434445485, -658.8007771840266, -617.8006541464816, -881.3582407661486, -1159.1398280895362, -858.9256814065986, -887.5630405019482, -839.6105932353361, -915.3760395915517, -660.1388823906728, -614.087678875738, -450.9374643641306, -407.6160568378886, -1030.0051215818803, -702.2916633892487, -63.15863655450112, -7.439394326560624, -322.9035194478945, -692.296482194258, -773.9019625619255, -838.0009168607914, -463.09303999713404, -479.717944330009, -86.83172890143777, -206.14616986878883, -853.7598631039244, -996.4362441069463, -502.2620431736355, -505.6856751996835, -283.94612941239916, -261.26624869705444, -1236.0036639167593, -1266.3461136330172, -658.0125569115525, -739.7110620184283, -825.8202782375175, -1019.7932128378466, -120.92326050500745, -220.57925788753843, -707.3070341592883, -812.576332407077, -860.6569044275415, -869.9762160889724, -503.3275503479318, -397.43134014627014, -551.1079592975983, -463.0644514360018, -801.673969226472, -686.8153847534139, -35.08957736690809, -47.39943491024204, -892.7919731753055, -1168.8050913732636, -92.46229940524032, -43.96885103538894, -955.3010833297955, -1050.611519857308, -797.7304853743843, -716.0023042028608, -678.2280275571427, -874.1130054089039, -511.5167293305536, -542.5221394355199, -825.6352568472381, -777.4623326088275, -1191.8061955583382, -811.8873412612265, -701.3097373338603, -652.8003820577749, -432.38940721093604, -506.32831476623664, -643.1689492376534, -763.9221927545847, -32.49367273862119, -40.50682145471333, -487.45334058145255, -432.25975324956426, 28.903558094016603, 31.009937399669735, -506.9746785489526, -515.0336274079572, -860.4272023946994, -777.4915401006325, -190.9506658579714, -197.7107447289387, -664.3765084876113, -613.7829368498371, -802.8864151941299, -774.0017177951014, -63.03184704643477, -63.13269597927781, -114.74562603701654, -125.38421110006578, -1011.3259415207432, -676.8836624743823, -672.0299893274065, -664.3324628971696, -163.2801283538852, -225.31303473143993, -419.20030135260674, -264.86270524392705, -619.6723719695069, -453.6475520463128, -434.05331024135626, -569.2109388859939, -4.34639633401436, 22.83293134084917, -611.8531051526228, -796.4432397708105], "policy_predator_policy_reward": [13.078861988714143, 67.24608743736492, 19.33911019308839, 19.808686926887535, 42.20867154524478, 2.0087953026036858, 0.0, 10.072471462652326, 36.65057323562864, 0.0, 11.868278986355095, 33.20297682871681, 29.15767215691655, 6.675277595147986, 31.588903212506782, 0.0, 4.014553457896321, 13.631082493414711, 15.261169292088551, 18.006761674388606, 0.0, 288.09522093341934, 3.802143725070661, 54.092007502877586, 36.185903775785114, 89.09945348402512, 106.20391022840444, 9.282678694871985, 0.8151641351138795, 66.6722346739332, 0.0, 35.81063944803969, 9.839821839419868, 28.79002893250783, 1.9295816419649214, 8.289881486172417, 489.04032287605855, 5.236993597322167, 47.62657315056751, 25.57986933987885, 4.486556188971972, 13.856401787839214, 12.529701874676778, 5.813918772043139, 0.9834192208944552, 9.759287850497415, 36.72518755850167, 28.166210186976, 4.243453818904724, 84.14899051321335, 8.937011692089486, 3.6198189249822113, 120.80934699753817, 47.160038785833805, 0.0, 34.293217252248894, 120.04037475656547, 582.1998660425064, 327.0021764820308, 571.7115197833932, 423.5837495091091, 414.5514300861003, 400.6992702200887, 173.37219871526992, 843.2903086833129, 510.24851673305875, 1090.0390707938982, 365.8601919719043, 416.70264410079375, 342.1494983190252, 20.202726027585015, 758.7808736910658, 588.7319983936719, 32.718234262565666, 508.1802049975961, 900.6746832771746, 293.493598714585, 990.3478739414456, 175.95716159273044, 105.63152264979067, 316.76643453439704, 90.22552573007798, 353.28255163592485, 661.5251069376086, 699.5104495404005, 199.44301640830665, 449.28515569869165, 387.0674887708876, 104.08830121205007, 824.6744347547348, 476.1537601419181, 317.9847294156699, 561.1154473326092, 464.3105403333856, 353.15687294529897, 1255.2150260161216, 831.7229307935308, 844.2319144347476, 922.8888447048513, 992.4394419289347, 852.889742568386, 18.358214323295975, 49.42110431805737, 546.0915586714315, 567.6625797952759, 1004.1034583863751, 49.528323031654196, 52.97192511676489, 83.47075721412935, 731.882015431793, 986.3040822928247, 219.24448495533974, 343.88991140732435, 517.5885264291213, 62.59695344155816, 226.4057487643502, 945.2806762211228, 1023.5000468775198, 29.560929294299395, 589.5276227084014, 229.8123200301324, 238.2259207223059, 1283.5986021996678, 1232.6975590822835, 821.7493680741068, 505.0991116477662, 19.907857547946353, 1201.2462812435822, 109.04699690739575, 245.11385666934444, 317.76256697356916, 928.1625614911949, 822.7550551563155, 863.4397677498708, 511.70258708396517, 376.5326978522095, 614.4110920471222, 32.18799675722883, 111.48603580572, 933.8688091505264, 80.35624933176224, 12.188202656227222, 1215.5244183160783, 803.649005489201, 145.52723042684124, 30.280784461585778, 878.1784358949948, 1014.6558414688668, 987.7191439565166, 0.8426739271276212, 122.9250523136627, 988.9521947021932, 749.835944057304, 7.54166309573869, 852.5983284257253, 443.2632153151008, 1265.042324731991, 443.8242458796323, 457.844803649098, 671.6636113475301, 579.5754744247057, 124.5466225435441, 432.2430968291049, 812.1434183623151, 52.51145086446846, 45.66201776000589, 578.213087065259, 24.268526342448943, 3.909485023686935, 5.7770194826271375, 636.5769181462368, 20.97518202112853, 956.8580187482892, 529.9069294914468, 213.36210732653154, 144.64335732747202, 778.5541073044676, 111.24980152474558, 856.1732575807022, 725.4471492407434, 0.0, 97.44182517696234, 199.42695696708782, 20.05236882863855, 1123.4845628206683, 0.0, 838.7165948321255, 20.711762835333513, 268.1026106869543, 196.153309324391, 64.76308303798731, 493.99462992206816, 534.3790470751495, 484.24831286407647, 199.38941361339948, 630.1573946246023, 4.009483336957551, 23.55731536990602, 804.8059121981426, 558.3010032460018]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.992397250312427, "mean_inference_ms": 3.882821715250218, "mean_action_processing_ms": 1.8725945751738675, "mean_env_wait_ms": 1.2054362961908847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032198429107666016, "StateBufferConnector_ms": 0.011909246444702148, "ViewRequirementAgentConnector_ms": 0.10402262210845947}, "num_episodes": 64, "episode_return_max": 160.34165380689834, "episode_return_min": -624.4593522838353, "episode_return_mean": -113.6813152717787, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 248.38784087218676, "num_env_steps_trained_throughput_per_sec": 248.38784087218676, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 32426.914, "restore_workers_time_ms": 0.024, "training_step_time_ms": 32426.089, "sample_time_ms": 1279.072, "learn_time_ms": 31114.855, "learn_throughput": 257.112, "synch_weights_time_ms": 25.704}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 28, "trial_id": "cd905_00000", "date": "2024-08-20_09-39-24", "timestamp": 1724126964, "time_this_iter_s": 32.258363008499146, "time_total_s": 922.5464630126953, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f6bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 922.5464630126953, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 42.369565217391305, "ram_util_percent": 82.07391304347829}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2062043351431688, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 9.498684656052362, "policy_loss": -0.0018398745037201379, "vf_loss": 9.500524546608093, "vf_explained_var": 0.002139151380175636, "kl": 0.003084829974211191, "entropy": 1.5016210423575507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.740030204043502, "cur_kl_coeff": 2.288818359375e-06, "cur_lr": 0.0001, "total_loss": 9.404560886867463, "policy_loss": -0.001201812439184222, "vf_loss": 9.405762720864917, "vf_explained_var": 3.946414069523887e-05, "kl": 0.009753421239962798, "entropy": 1.2687112713616993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 595.0523211526661, "episode_reward_min": -564.7250411744576, "episode_reward_mean": 77.75523985090439, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1459.8595565687083, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 31.009937399669735, "predator_policy": 1444.1654458824237}, "policy_reward_mean": {"prey_policy": -783.9793035299668, "predator_policy": 822.8569234554191}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.376864447798, -113.0783258232421, -525.1709716936007, -440.4637859501906, -296.66126161303043, -307.2360457152395, -294.82696620794115, -224.60170439500703, -234.59562500892227, -162.7046268008175, 25.172974431139895, -317.2314804233089, 69.6000000000001, -364.45620578954384, -151.15379425559564, -30.65594593290659, -388.35553650823545, 4.732273832214414, -28.72271784874998, -20.6505113413556, -564.7250411744576, -476.93409455711674, 75.66275692601899, -125.30529363647801, -54.6925640765931, -173.71744088934764, 46.05333371369856, -45.18942947928892, -101.80528646500944, -168.76822408846115, 30.23721309569844, 176.17591305531175, -329.4829595970268, 195.70482901511093, 120.95398148707608, -125.89261218072522, 117.91717533723468, 127.01775649867194, 346.9543494298195, 289.14939695010275, 46.780426481512066, -14.8725978131204, 293.7058755214143, 584.5844422331377, -174.26878873340345, 38.41455434802492, 115.97211522747867, 233.62358843482926, 180.42402638053306, 190.32291931024827, 94.65909136565882, 104.26220133718866, 110.68265417307468, 270.59658447818254, 47.75003174641297, 595.0523211526661, -155.3641955531719, 258.96556370101223, 193.32073878809814, 188.50148261826914, 195.27596771043451, 253.7395281718998, 483.3013219660055, 65.91002776711129, 271.9740207345919, 333.9495414855893, 476.7191504207752, 98.76679794907392, 266.939685613901, 187.05678909889969, -3.8855678604070247, 136.14617011128618, 125.05915922322114, 247.073835560231, 217.49360784360178, 289.66642021026024, 327.98065864367754, 165.5724502679829, 274.71324417506435, 362.8266093942512, 297.6150222239954, 26.751220600154838, 170.7053606253117, 71.8484096957828, 359.127861680734, 323.5665403475689, -48.583662438834565, -142.4840695425063, 298.0190418473622, 384.7998070051571, 316.7989136649149, 465.6525896270743, 331.3437578714094, -6.122337782765398, 299.10661895697933, 300.31416653240154, 399.22862855646815, 162.3973273060784, 116.50432448599983, 71.91164337395267], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-92.46229940524032, -43.96885103538894, -955.3010833297955, -1050.611519857308, -797.7304853743843, -716.0023042028608, -678.2280275571427, -874.1130054089039, -511.5167293305536, -542.5221394355199, -825.6352568472381, -777.4623326088275, -1191.8061955583382, -811.8873412612265, -701.3097373338603, -652.8003820577749, -432.38940721093604, -506.32831476623664, -643.1689492376534, -763.9221927545847, -32.49367273862119, -40.50682145471333, -487.45334058145255, -432.25975324956426, 28.903558094016603, 31.009937399669735, -506.9746785489526, -515.0336274079572, -860.4272023946994, -777.4915401006325, -190.9506658579714, -197.7107447289387, -664.3765084876113, -613.7829368498371, -802.8864151941299, -774.0017177951014, -63.03184704643477, -63.13269597927781, -114.74562603701654, -125.38421110006578, -1011.3259415207432, -676.8836624743823, -672.0299893274065, -664.3324628971696, -163.2801283538852, -225.31303473143993, -419.20030135260674, -264.86270524392705, -619.6723719695069, -453.6475520463128, -434.05331024135626, -569.2109388859939, -4.34639633401436, 22.83293134084917, -611.8531051526228, -796.4432397708105, -1084.649455491044, -815.0798168097917, -1006.8235469964727, -941.3170586391791, -689.6312400689667, -785.8266883600655, -748.5993183272952, -726.2165026035526, -1127.1564144896156, -1231.0580709430515, -538.5826984745645, -730.5175091905353, -889.4988100299657, -945.4337597161871, -1018.8954472934552, -963.262616982706, -963.4928594368859, -1197.9484510316743, -972.6774292321434, -748.6475315518549, -583.7967100855932, -700.4060415913458, -1121.8338938751258, -363.440177933371, -1074.963562080335, -846.1030266925155, -1070.7829841194953, -879.8316534124123, -996.1501603498036, -892.5189255341122, -1211.2465620083606, -364.27826848797, -939.637861168611, -923.9386576568573, -1100.1444244579716, -887.4162377830792, -995.9360821676222, -1009.7443779597604, -1046.7392424881953, -1111.051896955206, -1185.3801909663164, -1079.6920371145416, -680.8710405413153, -659.0806947264037, -1066.7789831809373, -950.8701240149569, -896.1116250769535, -997.7171586187243, -995.5748750232176, -841.6702916395268, -891.5489778291227, -1050.9142372652436, -656.1227025499813, -1090.041891965298, -683.8301963358753, -1271.451601252738, -985.647699714453, -845.6729462210576, -920.7745706037977, -870.1959554853026, -673.1280715799198, -981.8926197671589, -900.2153049646585, -1188.277735157594, -981.0352007050902, -975.6408359079016, -1050.943310879832, -626.2129389741904, -330.1452987890036, -1031.7134721925481, -932.4756295921682, -832.5538958920629, -961.9515441001782, -1178.1702657258754, -1008.2663675244854, -890.1840696977267, -566.1249986020649, -1222.910312317805, -1227.3744502186744, -1136.5027555245963, -1015.7721023360109, -1151.0029795634905, -722.2505226230517, -838.7844312247677, -828.6732984060699, -1228.2124066237777, -950.3647776582745, -807.5020243642134, -560.2641894359948, -885.8209572247407, -1129.9800115185726, -875.5268824471901, -994.763797415178, -1035.9728677478097, -548.7823857908302, -512.7697448825076, -715.2487286863437, -1009.0731268305874, -757.8950080942218, -677.5045363260746, -961.7717944121246, -1078.2845059079327, -1459.8595565687083, -641.3759135702521, -1043.6208191299138, -888.5221562845346, -908.7187002399103, -1141.018007542217, -755.0848287532378, -924.9224497996844, -713.5866629471951, -1074.5700874102463, -314.49192110547887, -572.6270396805916, -855.9683659790762, -639.2216074887846, -852.5054697585973, -832.6375069878558, -895.7026463522817, -1054.1860440572225, -1036.8858106050607, -914.1982505586421, -805.7985805529606, -467.0153393381439, -1160.506376760467, -730.4298646859002, -819.7364806269424, -961.1878880275226, -905.9423779670615, -479.50701932273654, -717.8469796609314, -594.084699003811, -876.2467309879546, -540.5152549013127, -1422.07766944804, -956.7208170431594, -1073.048038426365, 14.18916159487002, -851.6746636572644, -764.5469419718679, -983.5475710210205, -761.5828435540703, -1010.7348103403058, -1224.9118716406924], "policy_predator_policy_reward": [145.52723042684124, 30.280784461585778, 878.1784358949948, 1014.6558414688668, 987.7191439565166, 0.8426739271276212, 122.9250523136627, 988.9521947021932, 749.835944057304, 7.54166309573869, 852.5983284257253, 443.2632153151008, 1265.042324731991, 443.8242458796323, 457.844803649098, 671.6636113475301, 579.5754744247057, 124.5466225435441, 432.2430968291049, 812.1434183623151, 52.51145086446846, 45.66201776000589, 578.213087065259, 24.268526342448943, 3.909485023686935, 5.7770194826271375, 636.5769181462368, 20.97518202112853, 956.8580187482892, 529.9069294914468, 213.36210732653154, 144.64335732747202, 778.5541073044676, 111.24980152474558, 856.1732575807022, 725.4471492407434, 0.0, 97.44182517696234, 199.42695696708782, 20.05236882863855, 1123.4845628206683, 0.0, 838.7165948321255, 20.711762835333513, 268.1026106869543, 196.153309324391, 64.76308303798731, 493.99462992206816, 534.3790470751495, 484.24831286407647, 199.38941361339948, 630.1573946246023, 4.009483336957551, 23.55731536990602, 804.8059121981426, 558.3010032460018, 1222.3952814705708, 575.5287043652548, 1228.1888021933069, 551.1835793538836, 607.568126201546, 898.1270153231845, 744.4737400944327, 906.5179938917267, 673.6220732608471, 1355.1094525747917, 491.0740911959761, 973.7309454842344, 1004.8189343948196, 951.0676168384093, 804.7850843229044, 1051.4803677725313, 947.3729624148993, 1331.9855233908952, 982.0733003078474, 866.2694169748213, 689.2400988326359, 941.9170022741224, 1258.4230039428685, 516.0004648157309, 1272.700620940875, 695.1463943134884, 1088.380531764169, 847.3615079546177, 1198.4734998602003, 983.90146154513, 1126.946581639383, 1033.1626910900839, 636.9270653816114, 1052.380664710453, 1131.1330194638977, 894.8421971251777, 1331.1974753930897, 790.4550999617729, 1338.015964499884, 1053.3987633783472, 1212.7457212353788, 1232.7505332260123, 695.184498397305, 835.0901561806629, 968.1126221840143, 1144.1955763775388, 816.0046309272396, 1182.086354105627, 833.4584626840658, 1114.4693581517533, 1007.355598226088, 1205.7042013464618, 674.7958547352157, 1119.1187715264773, 1315.1946956018744, 1235.1394231394058, 559.4202752666602, 1116.536175115678, 1041.2143268648108, 1008.7217629253018, 906.9841756985559, 941.3572544366217, 972.9264791580666, 1304.0680435824547, 1185.746117466666, 966.2058868567608, 1052.106612992162, 878.7891650337605, 1017.0237389152637, 828.1363540322927, 1050.0636579160448, 780.8758953352972, 1024.6771380168307, 1387.4186925438144, 955.2134091116931, 1277.1865695961094, 1122.7498213376825, 1143.0046400029632, 1135.7657252069775, 1326.8782784853672, 1172.8732194410036, 1260.8415480723988, 819.3220664912485, 928.7696764554701, 701.3385380672325, 1351.6615991022081, 820.2527942803215, 1073.7601778534522, 760.2562609879745, 810.8880448959814, 1226.9901709965284, 1025.5905585294659, 1094.0412531694851, 1154.1890198371052, 710.3596677373184, 640.8588831462794, 1023.6532275885788, 1028.6492865720293, 952.4373657447848, 648.5346289434945, 1208.1607214488763, 1106.608823046246, 1293.304823941703, 1170.7572555915085, 1046.5536214245803, 1183.204376213864, 827.5722115362311, 1248.9157168460508, 891.8902499958757, 958.8223891823579, 1095.8901257676966, 764.1150342855268, 666.3006496723897, 579.9461727944149, 844.8307356203987, 973.9257781950317, 935.3671347879203, 701.1921795196979, 1168.7644707405927, 638.6401501264056, 1063.8374132834895, 1185.265689727575, 780.3272881914179, 877.2864387048425, 1081.0144741897311, 1126.720680921551, 1167.1252601369558, 1079.4516981445834, 914.5969344275944, 802.1962207336136, 789.7984125860376, 516.0109282959389, 913.0490235457299, 802.8195813005169, 1444.1654458824237, 1234.9472071411765, 953.7072742348248, 504.3802311531377, 986.3533962671057, 792.2655366681049, 885.6587886588023, 975.9759504022884, 1228.100261222115, 1079.4580641328353]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9691241976437, "mean_inference_ms": 3.8626818181453655, "mean_action_processing_ms": 1.952446721740746, "mean_env_wait_ms": 1.202427762570553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003269195556640625, "StateBufferConnector_ms": 0.011546492576599121, "ViewRequirementAgentConnector_ms": 0.10059905052185059}, "num_episodes": 72, "episode_return_max": 595.0523211526661, "episode_return_min": -564.7250411744576, "episode_return_mean": 77.75523985090439, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 243.51233124356955, "num_env_steps_trained_throughput_per_sec": 243.51233124356955, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 32454.778, "restore_workers_time_ms": 0.025, "training_step_time_ms": 32453.933, "sample_time_ms": 1334.495, "learn_time_ms": 31088.111, "learn_throughput": 257.333, "synch_weights_time_ms": 26.058}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 29, "trial_id": "cd905_00000", "date": "2024-08-20_09-39-57", "timestamp": 1724126997, "time_this_iter_s": 32.89790320396423, "time_total_s": 955.4443662166595, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f0d9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 955.4443662166595, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 43.96595744680851, "ram_util_percent": 82.29787234042553}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.116093234759238, "cur_kl_coeff": 1.5258789062499999e-06, "cur_lr": 0.0001, "total_loss": 8.665217911251007, "policy_loss": -0.005731736756269894, "vf_loss": 8.67094957714989, "vf_explained_var": 0.0010784040367792522, "kl": 0.00520461082586539, "entropy": 1.549397157487415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 18585.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.38597587634410174, "cur_kl_coeff": 2.288818359375e-06, "cur_lr": 0.0001, "total_loss": 9.862386252388122, "policy_loss": -0.00018179904935615402, "vf_loss": 9.862568063584584, "vf_explained_var": 3.219890216040233e-05, "kl": 0.003971053376674732, "entropy": 1.2074860616335794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 18585.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 595.0523211526661, "episode_reward_min": -564.7250411744576, "episode_reward_mean": 77.75523985090439, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1459.8595565687083, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 31.009937399669735, "predator_policy": 1444.1654458824237}, "policy_reward_mean": {"prey_policy": -783.9793035299668, "predator_policy": 822.8569234554191}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.376864447798, -113.0783258232421, -525.1709716936007, -440.4637859501906, -296.66126161303043, -307.2360457152395, -294.82696620794115, -224.60170439500703, -234.59562500892227, -162.7046268008175, 25.172974431139895, -317.2314804233089, 69.6000000000001, -364.45620578954384, -151.15379425559564, -30.65594593290659, -388.35553650823545, 4.732273832214414, -28.72271784874998, -20.6505113413556, -564.7250411744576, -476.93409455711674, 75.66275692601899, -125.30529363647801, -54.6925640765931, -173.71744088934764, 46.05333371369856, -45.18942947928892, -101.80528646500944, -168.76822408846115, 30.23721309569844, 176.17591305531175, -329.4829595970268, 195.70482901511093, 120.95398148707608, -125.89261218072522, 117.91717533723468, 127.01775649867194, 346.9543494298195, 289.14939695010275, 46.780426481512066, -14.8725978131204, 293.7058755214143, 584.5844422331377, -174.26878873340345, 38.41455434802492, 115.97211522747867, 233.62358843482926, 180.42402638053306, 190.32291931024827, 94.65909136565882, 104.26220133718866, 110.68265417307468, 270.59658447818254, 47.75003174641297, 595.0523211526661, -155.3641955531719, 258.96556370101223, 193.32073878809814, 188.50148261826914, 195.27596771043451, 253.7395281718998, 483.3013219660055, 65.91002776711129, 271.9740207345919, 333.9495414855893, 476.7191504207752, 98.76679794907392, 266.939685613901, 187.05678909889969, -3.8855678604070247, 136.14617011128618, 125.05915922322114, 247.073835560231, 217.49360784360178, 289.66642021026024, 327.98065864367754, 165.5724502679829, 274.71324417506435, 362.8266093942512, 297.6150222239954, 26.751220600154838, 170.7053606253117, 71.8484096957828, 359.127861680734, 323.5665403475689, -48.583662438834565, -142.4840695425063, 298.0190418473622, 384.7998070051571, 316.7989136649149, 465.6525896270743, 331.3437578714094, -6.122337782765398, 299.10661895697933, 300.31416653240154, 399.22862855646815, 162.3973273060784, 116.50432448599983, 71.91164337395267], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-92.46229940524032, -43.96885103538894, -955.3010833297955, -1050.611519857308, -797.7304853743843, -716.0023042028608, -678.2280275571427, -874.1130054089039, -511.5167293305536, -542.5221394355199, -825.6352568472381, -777.4623326088275, -1191.8061955583382, -811.8873412612265, -701.3097373338603, -652.8003820577749, -432.38940721093604, -506.32831476623664, -643.1689492376534, -763.9221927545847, -32.49367273862119, -40.50682145471333, -487.45334058145255, -432.25975324956426, 28.903558094016603, 31.009937399669735, -506.9746785489526, -515.0336274079572, -860.4272023946994, -777.4915401006325, -190.9506658579714, -197.7107447289387, -664.3765084876113, -613.7829368498371, -802.8864151941299, -774.0017177951014, -63.03184704643477, -63.13269597927781, -114.74562603701654, -125.38421110006578, -1011.3259415207432, -676.8836624743823, -672.0299893274065, -664.3324628971696, -163.2801283538852, -225.31303473143993, -419.20030135260674, -264.86270524392705, -619.6723719695069, -453.6475520463128, -434.05331024135626, -569.2109388859939, -4.34639633401436, 22.83293134084917, -611.8531051526228, -796.4432397708105, -1084.649455491044, -815.0798168097917, -1006.8235469964727, -941.3170586391791, -689.6312400689667, -785.8266883600655, -748.5993183272952, -726.2165026035526, -1127.1564144896156, -1231.0580709430515, -538.5826984745645, -730.5175091905353, -889.4988100299657, -945.4337597161871, -1018.8954472934552, -963.262616982706, -963.4928594368859, -1197.9484510316743, -972.6774292321434, -748.6475315518549, -583.7967100855932, -700.4060415913458, -1121.8338938751258, -363.440177933371, -1074.963562080335, -846.1030266925155, -1070.7829841194953, -879.8316534124123, -996.1501603498036, -892.5189255341122, -1211.2465620083606, -364.27826848797, -939.637861168611, -923.9386576568573, -1100.1444244579716, -887.4162377830792, -995.9360821676222, -1009.7443779597604, -1046.7392424881953, -1111.051896955206, -1185.3801909663164, -1079.6920371145416, -680.8710405413153, -659.0806947264037, -1066.7789831809373, -950.8701240149569, -896.1116250769535, -997.7171586187243, -995.5748750232176, -841.6702916395268, -891.5489778291227, -1050.9142372652436, -656.1227025499813, -1090.041891965298, -683.8301963358753, -1271.451601252738, -985.647699714453, -845.6729462210576, -920.7745706037977, -870.1959554853026, -673.1280715799198, -981.8926197671589, -900.2153049646585, -1188.277735157594, -981.0352007050902, -975.6408359079016, -1050.943310879832, -626.2129389741904, -330.1452987890036, -1031.7134721925481, -932.4756295921682, -832.5538958920629, -961.9515441001782, -1178.1702657258754, -1008.2663675244854, -890.1840696977267, -566.1249986020649, -1222.910312317805, -1227.3744502186744, -1136.5027555245963, -1015.7721023360109, -1151.0029795634905, -722.2505226230517, -838.7844312247677, -828.6732984060699, -1228.2124066237777, -950.3647776582745, -807.5020243642134, -560.2641894359948, -885.8209572247407, -1129.9800115185726, -875.5268824471901, -994.763797415178, -1035.9728677478097, -548.7823857908302, -512.7697448825076, -715.2487286863437, -1009.0731268305874, -757.8950080942218, -677.5045363260746, -961.7717944121246, -1078.2845059079327, -1459.8595565687083, -641.3759135702521, -1043.6208191299138, -888.5221562845346, -908.7187002399103, -1141.018007542217, -755.0848287532378, -924.9224497996844, -713.5866629471951, -1074.5700874102463, -314.49192110547887, -572.6270396805916, -855.9683659790762, -639.2216074887846, -852.5054697585973, -832.6375069878558, -895.7026463522817, -1054.1860440572225, -1036.8858106050607, -914.1982505586421, -805.7985805529606, -467.0153393381439, -1160.506376760467, -730.4298646859002, -819.7364806269424, -961.1878880275226, -905.9423779670615, -479.50701932273654, -717.8469796609314, -594.084699003811, -876.2467309879546, -540.5152549013127, -1422.07766944804, -956.7208170431594, -1073.048038426365, 14.18916159487002, -851.6746636572644, -764.5469419718679, -983.5475710210205, -761.5828435540703, -1010.7348103403058, -1224.9118716406924], "policy_predator_policy_reward": [145.52723042684124, 30.280784461585778, 878.1784358949948, 1014.6558414688668, 987.7191439565166, 0.8426739271276212, 122.9250523136627, 988.9521947021932, 749.835944057304, 7.54166309573869, 852.5983284257253, 443.2632153151008, 1265.042324731991, 443.8242458796323, 457.844803649098, 671.6636113475301, 579.5754744247057, 124.5466225435441, 432.2430968291049, 812.1434183623151, 52.51145086446846, 45.66201776000589, 578.213087065259, 24.268526342448943, 3.909485023686935, 5.7770194826271375, 636.5769181462368, 20.97518202112853, 956.8580187482892, 529.9069294914468, 213.36210732653154, 144.64335732747202, 778.5541073044676, 111.24980152474558, 856.1732575807022, 725.4471492407434, 0.0, 97.44182517696234, 199.42695696708782, 20.05236882863855, 1123.4845628206683, 0.0, 838.7165948321255, 20.711762835333513, 268.1026106869543, 196.153309324391, 64.76308303798731, 493.99462992206816, 534.3790470751495, 484.24831286407647, 199.38941361339948, 630.1573946246023, 4.009483336957551, 23.55731536990602, 804.8059121981426, 558.3010032460018, 1222.3952814705708, 575.5287043652548, 1228.1888021933069, 551.1835793538836, 607.568126201546, 898.1270153231845, 744.4737400944327, 906.5179938917267, 673.6220732608471, 1355.1094525747917, 491.0740911959761, 973.7309454842344, 1004.8189343948196, 951.0676168384093, 804.7850843229044, 1051.4803677725313, 947.3729624148993, 1331.9855233908952, 982.0733003078474, 866.2694169748213, 689.2400988326359, 941.9170022741224, 1258.4230039428685, 516.0004648157309, 1272.700620940875, 695.1463943134884, 1088.380531764169, 847.3615079546177, 1198.4734998602003, 983.90146154513, 1126.946581639383, 1033.1626910900839, 636.9270653816114, 1052.380664710453, 1131.1330194638977, 894.8421971251777, 1331.1974753930897, 790.4550999617729, 1338.015964499884, 1053.3987633783472, 1212.7457212353788, 1232.7505332260123, 695.184498397305, 835.0901561806629, 968.1126221840143, 1144.1955763775388, 816.0046309272396, 1182.086354105627, 833.4584626840658, 1114.4693581517533, 1007.355598226088, 1205.7042013464618, 674.7958547352157, 1119.1187715264773, 1315.1946956018744, 1235.1394231394058, 559.4202752666602, 1116.536175115678, 1041.2143268648108, 1008.7217629253018, 906.9841756985559, 941.3572544366217, 972.9264791580666, 1304.0680435824547, 1185.746117466666, 966.2058868567608, 1052.106612992162, 878.7891650337605, 1017.0237389152637, 828.1363540322927, 1050.0636579160448, 780.8758953352972, 1024.6771380168307, 1387.4186925438144, 955.2134091116931, 1277.1865695961094, 1122.7498213376825, 1143.0046400029632, 1135.7657252069775, 1326.8782784853672, 1172.8732194410036, 1260.8415480723988, 819.3220664912485, 928.7696764554701, 701.3385380672325, 1351.6615991022081, 820.2527942803215, 1073.7601778534522, 760.2562609879745, 810.8880448959814, 1226.9901709965284, 1025.5905585294659, 1094.0412531694851, 1154.1890198371052, 710.3596677373184, 640.8588831462794, 1023.6532275885788, 1028.6492865720293, 952.4373657447848, 648.5346289434945, 1208.1607214488763, 1106.608823046246, 1293.304823941703, 1170.7572555915085, 1046.5536214245803, 1183.204376213864, 827.5722115362311, 1248.9157168460508, 891.8902499958757, 958.8223891823579, 1095.8901257676966, 764.1150342855268, 666.3006496723897, 579.9461727944149, 844.8307356203987, 973.9257781950317, 935.3671347879203, 701.1921795196979, 1168.7644707405927, 638.6401501264056, 1063.8374132834895, 1185.265689727575, 780.3272881914179, 877.2864387048425, 1081.0144741897311, 1126.720680921551, 1167.1252601369558, 1079.4516981445834, 914.5969344275944, 802.1962207336136, 789.7984125860376, 516.0109282959389, 913.0490235457299, 802.8195813005169, 1444.1654458824237, 1234.9472071411765, 953.7072742348248, 504.3802311531377, 986.3533962671057, 792.2655366681049, 885.6587886588023, 975.9759504022884, 1228.100261222115, 1079.4580641328353]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9691241976437, "mean_inference_ms": 3.8626818181453655, "mean_action_processing_ms": 1.952446721740746, "mean_env_wait_ms": 1.202427762570553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003269195556640625, "StateBufferConnector_ms": 0.011546492576599121, "ViewRequirementAgentConnector_ms": 0.10059905052185059}, "num_episodes": 0, "episode_return_max": 595.0523211526661, "episode_return_min": -564.7250411744576, "episode_return_mean": 77.75523985090439, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 252.1756369500386, "num_env_steps_trained_throughput_per_sec": 252.1756369500386, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 32369.428, "restore_workers_time_ms": 0.025, "training_step_time_ms": 32368.618, "sample_time_ms": 1307.92, "learn_time_ms": 31030.844, "learn_throughput": 257.808, "synch_weights_time_ms": 24.677}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 30, "trial_id": "cd905_00000", "date": "2024-08-20_09-40-29", "timestamp": 1724127029, "time_this_iter_s": 31.752270221710205, "time_total_s": 987.1966364383698, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f75f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 987.1966364383698, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 40.37555555555556, "ram_util_percent": 82.63555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4871035742026473, "cur_kl_coeff": 1.5258789062499999e-06, "cur_lr": 0.0001, "total_loss": 7.808711070863027, "policy_loss": -0.012339214655378508, "vf_loss": 7.821050252611675, "vf_explained_var": 0.0049210835070837115, "kl": 0.020232425300004873, "entropy": 1.5778059785328213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 19215.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9207339408970069, "cur_kl_coeff": 1.1444091796875e-06, "cur_lr": 0.0001, "total_loss": 8.353355598449706, "policy_loss": -0.0007964692370493024, "vf_loss": 8.354152074692742, "vf_explained_var": 0.00034248989725869797, "kl": 0.005528029882283128, "entropy": 1.2077354098123216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 19215.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 803.467663153912, "episode_reward_min": -142.4840695425063, "episode_reward_mean": 348.29555967304003, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1459.8595565687083, "predator_policy": 50.20419199530572}, "policy_reward_max": {"prey_policy": 72.97925943569481, "predator_policy": 1444.1654458824237}, "policy_reward_mean": {"prey_policy": -621.8836876248585, "predator_policy": 796.0314674613782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.05915922322114, 247.073835560231, 217.49360784360178, 289.66642021026024, 327.98065864367754, 165.5724502679829, 274.71324417506435, 362.8266093942512, 297.6150222239954, 26.751220600154838, 170.7053606253117, 71.8484096957828, 359.127861680734, 323.5665403475689, -48.583662438834565, -142.4840695425063, 298.0190418473622, 384.7998070051571, 316.7989136649149, 465.6525896270743, 331.3437578714094, -6.122337782765398, 299.10661895697933, 300.31416653240154, 399.22862855646815, 162.3973273060784, 116.50432448599983, 71.91164337395267, 444.7464426015679, 237.09837177599053, 307.09363280974645, 803.467663153912, 428.236714889284, 357.91317014253957, 465.7862771348943, 303.1147765748643, 536.2874791247971, 308.535448787853, 77.14861345863532, 392.8134373170948, 238.1502689856959, 314.5359993603323, 626.8797657055816, 273.9641812956925, 441.424910227256, 302.2594157987194, 416.26007792584784, 337.8487997415548, 238.60952053588744, 467.32690512054796, 443.0771584895731, 272.62892264354457, 750.562048112456, 740.5740756709653, 12.43374377864663, 395.34209259511255, 610.4682252730138, 196.84275324390083, 253.9402541795652, 613.1350830190414, 460.64013970197175, 603.7296724114798, 364.71594834178893, 317.82034939146206, 439.352588648866, 337.6994140530385, 381.3228632282944, 510.03046919925896, 315.23929066151584, 450.34914566082347, 319.3835443323263, 293.67056064118253, 519.3650855640027, 318.0591051038544, 291.35843782672976, 392.1464716141573, 351.26023243051867, 272.2790757012542, 432.5874459932697, 444.88877635254744, 415.6549338265692, 290.17120008771934, 314.7991831121913, 463.8738468445304, 687.5923077254733, 418.44081931250196, 411.39017298101663, 373.91323081911656, 556.8402975913, 376.6639521512537, 109.3910713532091, 428.79346866859487, 452.02019528095235, 268.5872311323199, 461.00592933562183, 520.7219794528421, 207.30525841212406, 355.36077616177505, 594.8110193263637, 488.9270974405433], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-560.2641894359948, -885.8209572247407, -1129.9800115185726, -875.5268824471901, -994.763797415178, -1035.9728677478097, -548.7823857908302, -512.7697448825076, -715.2487286863437, -1009.0731268305874, -757.8950080942218, -677.5045363260746, -961.7717944121246, -1078.2845059079327, -1459.8595565687083, -641.3759135702521, -1043.6208191299138, -888.5221562845346, -908.7187002399103, -1141.018007542217, -755.0848287532378, -924.9224497996844, -713.5866629471951, -1074.5700874102463, -314.49192110547887, -572.6270396805916, -855.9683659790762, -639.2216074887846, -852.5054697585973, -832.6375069878558, -895.7026463522817, -1054.1860440572225, -1036.8858106050607, -914.1982505586421, -805.7985805529606, -467.0153393381439, -1160.506376760467, -730.4298646859002, -819.7364806269424, -961.1878880275226, -905.9423779670615, -479.50701932273654, -717.8469796609314, -594.084699003811, -876.2467309879546, -540.5152549013127, -1422.07766944804, -956.7208170431594, -1073.048038426365, 14.18916159487002, -851.6746636572644, -764.5469419718679, -983.5475710210205, -761.5828435540703, -1010.7348103403058, -1224.9118716406924, -478.5718791126408, -846.0740926780865, -915.898943808007, -582.187341112028, -1033.9567501492347, -1146.5481001329895, -952.4443690183308, -264.0524635430868, -245.52013103245145, -199.92002993503667, -852.6389200004048, -544.8265034919781, -751.5465030112305, -273.9920673223063, -701.0252506622184, -1091.2592475280944, -896.6763005403265, -746.7950775907321, -713.8524666991675, -810.0481949463857, -495.40836340812047, 18.821076067652903, -758.4955049177545, -1031.8786411039907, -736.734635517255, -834.6715748272402, -95.92405023622369, -827.5930259953282, -104.42864043340714, -633.8974617303917, -483.3824541041734, -183.12570481955018, -127.47854431153976, -441.61888911671304, -218.28327097268172, 57.787041158599784, -833.4066381731468, -678.7005223734957, -433.63109158626816, -713.0073870274502, -589.154927759513, -775.1057963586593, -555.646680908919, -552.4106665330962, -591.8652408407122, -908.5609685183259, -524.1446684774075, -580.2887367107816, -1061.9075573805558, -19.409710681411987, -60.86217899617223, -830.5336331529991, -779.6047225427643, -653.857273865391, -41.0504028836768, -451.87128344428004, -43.08289554862727, -700.5383432798002, -299.6898783786251, -486.3698910382131, -273.5804529970814, -9.785240662434532, -922.9108293064977, -961.8066801559006, -633.6039564455083, -677.7403484175915, -76.22916802451408, -726.4907645087144, -161.0970714779132, -726.2227863598007, -384.051794836543, 16.213501873460324, -803.6058318800651, -750.3907690327219, -258.2244165097076, -4.851760343636542, -630.8972548078311, -457.49228583885076, -50.81213406581409, -673.2567576071829, -739.8642194527656, -320.47773759694365, -793.9909497801357, -373.96847919507985, 0.8768141807526159, -793.3983270940955, -127.46832190978164, -429.8896151206217, -855.9497622903464, -209.412158487652, -956.9162021835191, -341.2080017188314, -475.2887771554405, -1031.9292475366192, -520.6432827464001, -919.7624634274076, -22.8474056938064, -310.35737804319797, -824.7384456243628, -702.7184819535969, -385.2123409629351, -504.98523930351985, -753.2394586080401, -143.93060388595492, -827.5492647962283, -451.98987779831396, -711.1427484533295, -7.95739700040251, -401.7608083061357, -624.5882666362892, -394.0477098315575, -886.9121075694311, -530.8218031743727, -1072.203908798587, -247.6618069335691, -578.2815405545548, -562.4351087672624, -781.957727131608, -543.4552012454208, -222.87340397526214, -742.6509913320026, -238.70196729760656, -806.2982340511716, -590.7194331368551, -58.61243492680789, -84.3078360971652, -746.6285279230694, -429.2208736812952, -474.1284042373993, -851.9980631630868, -150.75879906769794, -551.472239595214, -857.6753944338063, -1011.4303767054536, -7.9000913448726156, -712.631599859056, -529.128424661647, -600.3527169908947, -596.9567088697728, -341.5761957977312, -671.9825082095646, 72.97925943569481, -804.827127849493, -574.2778552818241], "policy_predator_policy_reward": [760.2562609879745, 810.8880448959814, 1226.9901709965284, 1025.5905585294659, 1094.0412531694851, 1154.1890198371052, 710.3596677373184, 640.8588831462794, 1023.6532275885788, 1028.6492865720293, 952.4373657447848, 648.5346289434945, 1208.1607214488763, 1106.608823046246, 1293.304823941703, 1170.7572555915085, 1046.5536214245803, 1183.204376213864, 827.5722115362311, 1248.9157168460508, 891.8902499958757, 958.8223891823579, 1095.8901257676966, 764.1150342855268, 666.3006496723897, 579.9461727944149, 844.8307356203987, 973.9257781950317, 935.3671347879203, 701.1921795196979, 1168.7644707405927, 638.6401501264056, 1063.8374132834895, 1185.265689727575, 780.3272881914179, 877.2864387048425, 1081.0144741897311, 1126.720680921551, 1167.1252601369558, 1079.4516981445834, 914.5969344275944, 802.1962207336136, 789.7984125860376, 516.0109282959389, 913.0490235457299, 802.8195813005169, 1444.1654458824237, 1234.9472071411765, 953.7072742348248, 504.3802311531377, 986.3533962671057, 792.2655366681049, 885.6587886588023, 975.9759504022884, 1228.100261222115, 1079.4580641328353, 835.8943831420978, 933.4980312501972, 894.5425080276844, 840.6421486683415, 1296.7840099670725, 1190.8144731248985, 1056.312904476889, 963.6515912384388, 419.3439556924064, 454.33292016436496, 950.2212657060343, 805.157327928888, 845.2534751103196, 646.0713723581101, 1216.5890440538747, 878.8102307113021, 1171.165132525422, 1008.5937247304332, 966.7159918192698, 865.7201186141358, 503.5317088037987, 50.20419199530572, 1097.6447258167777, 1085.5428575220626, 946.6675542303756, 862.8889250998151, 450.2288450695545, 787.82423052233, 698.7107061786793, 666.4951616906993, 506.07550778509363, 434.39683243432324, 471.5800619593945, 538.9422816961134, 234.0705007476678, 228.68514486513337, 974.5850671869673, 953.7821712855226, 641.671606035275, 842.8156723199976, 737.5052938940671, 865.364950759992, 762.0135051939678, 813.370747368594, 891.9978870714625, 1051.505480777148, 685.8140278945046, 691.2482999372284, 950.3962926256374, 881.4830235487842, 772.3600089744875, 859.6098788456467, 812.9385514721142, 632.9571887146874, 429.91402471573986, 458.3497542073279, 687.6602930720227, 666.4291710294169, 456.8989442897864, 526.003578370953, 294.25471724045207, 243.05123059863053, 1254.9132996732571, 1242.9392928081854, 959.7178504137096, 812.2665941513613, 743.168662821119, 663.2809421235879, 514.6564895351577, 737.3793166443448, 286.0904033842318, 399.56823897031205, 952.5096463572063, 1040.839543204446, 288.1982886709179, 312.5773022354646, 749.0813111174951, 720.6310927574818, 587.6546242683482, 646.4447366039074, 704.1126406942665, 671.4686070169586, 884.9810410084996, 733.3275336275414, 337.78719200367385, 774.1178652419944, 389.8420641182365, 461.1864335533497, 813.2096324890039, 771.5173738529959, 833.3956808912673, 782.7876281149379, 707.3802286258749, 1091.1962338929143, 856.0012333294836, 976.550984458481, 328.51294036737886, 355.9520758001438, 1044.6155796910161, 755.1204235881974, 663.0784834846171, 659.7065427751078, 758.0253449675723, 584.0334938789697, 927.0187616329098, 768.1753147882008, 685.3232887991257, 323.94805674232595, 682.4782425915799, 658.6700154630369, 926.9704431166524, 817.8632211288668, 1146.210220262282, 1144.407799436151, 537.9505861416428, 706.4335806589828, 893.2337324282373, 862.5492764516489, 563.8194761269524, 576.4223599128482, 771.6529732265835, 766.5402829943245, 960.1209088590384, 813.560710480242, 156.15244178406888, 96.1589005931135, 694.8625687467189, 909.7803015262407, 799.399908431444, 978.7467542499926, 461.80296172389814, 509.0153080713342, 1141.365220764064, 1188.7464797108196, 604.9119439926931, 636.3417266640757, 542.6366171877366, 794.1497828769293, 662.7586527591171, 631.1350280701612, 656.3744655673557, 537.4398025328754, 867.4862905390688, 1000.5457900327905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9382088230860965, "mean_inference_ms": 3.8371277812249023, "mean_action_processing_ms": 1.9674170244642946, "mean_env_wait_ms": 1.199365144735361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031627416610717773, "StateBufferConnector_ms": 0.011576056480407715, "ViewRequirementAgentConnector_ms": 0.09106993675231934}, "num_episodes": 72, "episode_return_max": 803.467663153912, "episode_return_min": -142.4840695425063, "episode_return_mean": 348.29555967304003, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 246.57742100651498, "num_env_steps_trained_throughput_per_sec": 246.57742100651498, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 32418.55, "restore_workers_time_ms": 0.023, "training_step_time_ms": 32417.756, "sample_time_ms": 1319.882, "learn_time_ms": 31068.33, "learn_throughput": 257.497, "synch_weights_time_ms": 24.627}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 31, "trial_id": "cd905_00000", "date": "2024-08-20_09-41-01", "timestamp": 1724127061, "time_this_iter_s": 32.46785497665405, "time_total_s": 1019.6644914150238, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afecb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1019.6644914150238, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 44.27608695652174, "ram_util_percent": 82.71304347826086}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.24314843846692, "cur_kl_coeff": 2.288818359375e-06, "cur_lr": 0.0001, "total_loss": 3.388784597033546, "policy_loss": -0.012816636933989468, "vf_loss": 3.401601222204784, "vf_explained_var": 0.006315440601772733, "kl": 0.021846643825166025, "entropy": 1.561537758320097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4667091072019605, "cur_kl_coeff": 1.1444091796875e-06, "cur_lr": 0.0001, "total_loss": 4.060526379706368, "policy_loss": -4.477104216459252e-05, "vf_loss": 4.060571156229291, "vf_explained_var": -7.357464896308051e-05, "kl": 0.0009053581565330393, "entropy": 1.2503098103735182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 803.467663153912, "episode_reward_min": -142.4840695425063, "episode_reward_mean": 348.29555967304003, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1459.8595565687083, "predator_policy": 50.20419199530572}, "policy_reward_max": {"prey_policy": 72.97925943569481, "predator_policy": 1444.1654458824237}, "policy_reward_mean": {"prey_policy": -621.8836876248585, "predator_policy": 796.0314674613782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.05915922322114, 247.073835560231, 217.49360784360178, 289.66642021026024, 327.98065864367754, 165.5724502679829, 274.71324417506435, 362.8266093942512, 297.6150222239954, 26.751220600154838, 170.7053606253117, 71.8484096957828, 359.127861680734, 323.5665403475689, -48.583662438834565, -142.4840695425063, 298.0190418473622, 384.7998070051571, 316.7989136649149, 465.6525896270743, 331.3437578714094, -6.122337782765398, 299.10661895697933, 300.31416653240154, 399.22862855646815, 162.3973273060784, 116.50432448599983, 71.91164337395267, 444.7464426015679, 237.09837177599053, 307.09363280974645, 803.467663153912, 428.236714889284, 357.91317014253957, 465.7862771348943, 303.1147765748643, 536.2874791247971, 308.535448787853, 77.14861345863532, 392.8134373170948, 238.1502689856959, 314.5359993603323, 626.8797657055816, 273.9641812956925, 441.424910227256, 302.2594157987194, 416.26007792584784, 337.8487997415548, 238.60952053588744, 467.32690512054796, 443.0771584895731, 272.62892264354457, 750.562048112456, 740.5740756709653, 12.43374377864663, 395.34209259511255, 610.4682252730138, 196.84275324390083, 253.9402541795652, 613.1350830190414, 460.64013970197175, 603.7296724114798, 364.71594834178893, 317.82034939146206, 439.352588648866, 337.6994140530385, 381.3228632282944, 510.03046919925896, 315.23929066151584, 450.34914566082347, 319.3835443323263, 293.67056064118253, 519.3650855640027, 318.0591051038544, 291.35843782672976, 392.1464716141573, 351.26023243051867, 272.2790757012542, 432.5874459932697, 444.88877635254744, 415.6549338265692, 290.17120008771934, 314.7991831121913, 463.8738468445304, 687.5923077254733, 418.44081931250196, 411.39017298101663, 373.91323081911656, 556.8402975913, 376.6639521512537, 109.3910713532091, 428.79346866859487, 452.02019528095235, 268.5872311323199, 461.00592933562183, 520.7219794528421, 207.30525841212406, 355.36077616177505, 594.8110193263637, 488.9270974405433], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-560.2641894359948, -885.8209572247407, -1129.9800115185726, -875.5268824471901, -994.763797415178, -1035.9728677478097, -548.7823857908302, -512.7697448825076, -715.2487286863437, -1009.0731268305874, -757.8950080942218, -677.5045363260746, -961.7717944121246, -1078.2845059079327, -1459.8595565687083, -641.3759135702521, -1043.6208191299138, -888.5221562845346, -908.7187002399103, -1141.018007542217, -755.0848287532378, -924.9224497996844, -713.5866629471951, -1074.5700874102463, -314.49192110547887, -572.6270396805916, -855.9683659790762, -639.2216074887846, -852.5054697585973, -832.6375069878558, -895.7026463522817, -1054.1860440572225, -1036.8858106050607, -914.1982505586421, -805.7985805529606, -467.0153393381439, -1160.506376760467, -730.4298646859002, -819.7364806269424, -961.1878880275226, -905.9423779670615, -479.50701932273654, -717.8469796609314, -594.084699003811, -876.2467309879546, -540.5152549013127, -1422.07766944804, -956.7208170431594, -1073.048038426365, 14.18916159487002, -851.6746636572644, -764.5469419718679, -983.5475710210205, -761.5828435540703, -1010.7348103403058, -1224.9118716406924, -478.5718791126408, -846.0740926780865, -915.898943808007, -582.187341112028, -1033.9567501492347, -1146.5481001329895, -952.4443690183308, -264.0524635430868, -245.52013103245145, -199.92002993503667, -852.6389200004048, -544.8265034919781, -751.5465030112305, -273.9920673223063, -701.0252506622184, -1091.2592475280944, -896.6763005403265, -746.7950775907321, -713.8524666991675, -810.0481949463857, -495.40836340812047, 18.821076067652903, -758.4955049177545, -1031.8786411039907, -736.734635517255, -834.6715748272402, -95.92405023622369, -827.5930259953282, -104.42864043340714, -633.8974617303917, -483.3824541041734, -183.12570481955018, -127.47854431153976, -441.61888911671304, -218.28327097268172, 57.787041158599784, -833.4066381731468, -678.7005223734957, -433.63109158626816, -713.0073870274502, -589.154927759513, -775.1057963586593, -555.646680908919, -552.4106665330962, -591.8652408407122, -908.5609685183259, -524.1446684774075, -580.2887367107816, -1061.9075573805558, -19.409710681411987, -60.86217899617223, -830.5336331529991, -779.6047225427643, -653.857273865391, -41.0504028836768, -451.87128344428004, -43.08289554862727, -700.5383432798002, -299.6898783786251, -486.3698910382131, -273.5804529970814, -9.785240662434532, -922.9108293064977, -961.8066801559006, -633.6039564455083, -677.7403484175915, -76.22916802451408, -726.4907645087144, -161.0970714779132, -726.2227863598007, -384.051794836543, 16.213501873460324, -803.6058318800651, -750.3907690327219, -258.2244165097076, -4.851760343636542, -630.8972548078311, -457.49228583885076, -50.81213406581409, -673.2567576071829, -739.8642194527656, -320.47773759694365, -793.9909497801357, -373.96847919507985, 0.8768141807526159, -793.3983270940955, -127.46832190978164, -429.8896151206217, -855.9497622903464, -209.412158487652, -956.9162021835191, -341.2080017188314, -475.2887771554405, -1031.9292475366192, -520.6432827464001, -919.7624634274076, -22.8474056938064, -310.35737804319797, -824.7384456243628, -702.7184819535969, -385.2123409629351, -504.98523930351985, -753.2394586080401, -143.93060388595492, -827.5492647962283, -451.98987779831396, -711.1427484533295, -7.95739700040251, -401.7608083061357, -624.5882666362892, -394.0477098315575, -886.9121075694311, -530.8218031743727, -1072.203908798587, -247.6618069335691, -578.2815405545548, -562.4351087672624, -781.957727131608, -543.4552012454208, -222.87340397526214, -742.6509913320026, -238.70196729760656, -806.2982340511716, -590.7194331368551, -58.61243492680789, -84.3078360971652, -746.6285279230694, -429.2208736812952, -474.1284042373993, -851.9980631630868, -150.75879906769794, -551.472239595214, -857.6753944338063, -1011.4303767054536, -7.9000913448726156, -712.631599859056, -529.128424661647, -600.3527169908947, -596.9567088697728, -341.5761957977312, -671.9825082095646, 72.97925943569481, -804.827127849493, -574.2778552818241], "policy_predator_policy_reward": [760.2562609879745, 810.8880448959814, 1226.9901709965284, 1025.5905585294659, 1094.0412531694851, 1154.1890198371052, 710.3596677373184, 640.8588831462794, 1023.6532275885788, 1028.6492865720293, 952.4373657447848, 648.5346289434945, 1208.1607214488763, 1106.608823046246, 1293.304823941703, 1170.7572555915085, 1046.5536214245803, 1183.204376213864, 827.5722115362311, 1248.9157168460508, 891.8902499958757, 958.8223891823579, 1095.8901257676966, 764.1150342855268, 666.3006496723897, 579.9461727944149, 844.8307356203987, 973.9257781950317, 935.3671347879203, 701.1921795196979, 1168.7644707405927, 638.6401501264056, 1063.8374132834895, 1185.265689727575, 780.3272881914179, 877.2864387048425, 1081.0144741897311, 1126.720680921551, 1167.1252601369558, 1079.4516981445834, 914.5969344275944, 802.1962207336136, 789.7984125860376, 516.0109282959389, 913.0490235457299, 802.8195813005169, 1444.1654458824237, 1234.9472071411765, 953.7072742348248, 504.3802311531377, 986.3533962671057, 792.2655366681049, 885.6587886588023, 975.9759504022884, 1228.100261222115, 1079.4580641328353, 835.8943831420978, 933.4980312501972, 894.5425080276844, 840.6421486683415, 1296.7840099670725, 1190.8144731248985, 1056.312904476889, 963.6515912384388, 419.3439556924064, 454.33292016436496, 950.2212657060343, 805.157327928888, 845.2534751103196, 646.0713723581101, 1216.5890440538747, 878.8102307113021, 1171.165132525422, 1008.5937247304332, 966.7159918192698, 865.7201186141358, 503.5317088037987, 50.20419199530572, 1097.6447258167777, 1085.5428575220626, 946.6675542303756, 862.8889250998151, 450.2288450695545, 787.82423052233, 698.7107061786793, 666.4951616906993, 506.07550778509363, 434.39683243432324, 471.5800619593945, 538.9422816961134, 234.0705007476678, 228.68514486513337, 974.5850671869673, 953.7821712855226, 641.671606035275, 842.8156723199976, 737.5052938940671, 865.364950759992, 762.0135051939678, 813.370747368594, 891.9978870714625, 1051.505480777148, 685.8140278945046, 691.2482999372284, 950.3962926256374, 881.4830235487842, 772.3600089744875, 859.6098788456467, 812.9385514721142, 632.9571887146874, 429.91402471573986, 458.3497542073279, 687.6602930720227, 666.4291710294169, 456.8989442897864, 526.003578370953, 294.25471724045207, 243.05123059863053, 1254.9132996732571, 1242.9392928081854, 959.7178504137096, 812.2665941513613, 743.168662821119, 663.2809421235879, 514.6564895351577, 737.3793166443448, 286.0904033842318, 399.56823897031205, 952.5096463572063, 1040.839543204446, 288.1982886709179, 312.5773022354646, 749.0813111174951, 720.6310927574818, 587.6546242683482, 646.4447366039074, 704.1126406942665, 671.4686070169586, 884.9810410084996, 733.3275336275414, 337.78719200367385, 774.1178652419944, 389.8420641182365, 461.1864335533497, 813.2096324890039, 771.5173738529959, 833.3956808912673, 782.7876281149379, 707.3802286258749, 1091.1962338929143, 856.0012333294836, 976.550984458481, 328.51294036737886, 355.9520758001438, 1044.6155796910161, 755.1204235881974, 663.0784834846171, 659.7065427751078, 758.0253449675723, 584.0334938789697, 927.0187616329098, 768.1753147882008, 685.3232887991257, 323.94805674232595, 682.4782425915799, 658.6700154630369, 926.9704431166524, 817.8632211288668, 1146.210220262282, 1144.407799436151, 537.9505861416428, 706.4335806589828, 893.2337324282373, 862.5492764516489, 563.8194761269524, 576.4223599128482, 771.6529732265835, 766.5402829943245, 960.1209088590384, 813.560710480242, 156.15244178406888, 96.1589005931135, 694.8625687467189, 909.7803015262407, 799.399908431444, 978.7467542499926, 461.80296172389814, 509.0153080713342, 1141.365220764064, 1188.7464797108196, 604.9119439926931, 636.3417266640757, 542.6366171877366, 794.1497828769293, 662.7586527591171, 631.1350280701612, 656.3744655673557, 537.4398025328754, 867.4862905390688, 1000.5457900327905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9382088230860965, "mean_inference_ms": 3.8371277812249023, "mean_action_processing_ms": 1.9674170244642946, "mean_env_wait_ms": 1.199365144735361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031627416610717773, "StateBufferConnector_ms": 0.011576056480407715, "ViewRequirementAgentConnector_ms": 0.09106993675231934}, "num_episodes": 0, "episode_return_max": 803.467663153912, "episode_return_min": -142.4840695425063, "episode_return_mean": 348.29555967304003, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 247.7425769072278, "num_env_steps_trained_throughput_per_sec": 247.7425769072278, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 32399.826, "restore_workers_time_ms": 0.024, "training_step_time_ms": 32399.041, "sample_time_ms": 1322.467, "learn_time_ms": 31046.688, "learn_throughput": 257.676, "synch_weights_time_ms": 24.646}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 32, "trial_id": "cd905_00000", "date": "2024-08-20_09-41-33", "timestamp": 1724127093, "time_this_iter_s": 32.31807494163513, "time_total_s": 1051.982566356659, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f0dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1051.982566356659, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 37.65434782608695, "ram_util_percent": 81.40869565217392}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9585172111434597, "cur_kl_coeff": 3.4332275390625005e-06, "cur_lr": 0.0001, "total_loss": 2.621905089181567, "policy_loss": -0.008775051029044249, "vf_loss": 2.6306801080703734, "vf_explained_var": 0.05591701335377163, "kl": 0.02354462835139693, "entropy": 1.5033981332703241, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 20475.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9165012396990306, "cur_kl_coeff": 5.7220458984375e-07, "cur_lr": 0.0001, "total_loss": 1.4801918790453956, "policy_loss": -0.0014541714099265397, "vf_loss": 1.4816460513879381, "vf_explained_var": -0.002747760121784513, "kl": 0.008291578681299086, "entropy": 1.2893958106873527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 20475.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 687.5923077254733, "episode_reward_min": 27.26710294068299, "episode_reward_mean": 207.60958157886228, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1072.203908798587, "predator_policy": 0.8092314667623366}, "policy_reward_max": {"prey_policy": 124.71320656624314, "predator_policy": 1188.7464797108196}, "policy_reward_mean": {"prey_policy": -204.3560201451169, "predator_policy": 308.1608109345481}, "custom_metrics": {}, "hist_stats": {"episode_reward": [519.3650855640027, 318.0591051038544, 291.35843782672976, 392.1464716141573, 351.26023243051867, 272.2790757012542, 432.5874459932697, 444.88877635254744, 415.6549338265692, 290.17120008771934, 314.7991831121913, 463.8738468445304, 687.5923077254733, 418.44081931250196, 411.39017298101663, 373.91323081911656, 556.8402975913, 376.6639521512537, 109.3910713532091, 428.79346866859487, 452.02019528095235, 268.5872311323199, 461.00592933562183, 520.7219794528421, 207.30525841212406, 355.36077616177505, 594.8110193263637, 488.9270974405433, 78.07297025634132, 106.03563068365169, 99.0970257460847, 233.99421437421734, 426.5107971638394, 292.60133481481483, 264.90766210683813, 41.600000000000286, 129.84905137987974, 187.35447245044233, 65.5016011783069, 107.7052412335799, 81.69999999999924, 53.585313341847346, 42.234754922909445, 79.29999999999934, 129.1723813962573, 77.80924040173264, 40.50000000000031, 35.462228663946775, 281.0379462541153, 40.85242314455077, 67.36332995440111, 95.49506500131854, 581.21465008422, 86.39999999999885, 189.7278466912362, 37.50000000000026, 27.26710294068299, 81.30606773345316, 249.65239184857023, 211.12998765988428, 62.612507078708276, 33.368578870726495, 170.61596785576205, 147.69999999999888, 64.55275913160845, 313.8986792554651, 61.79288215370363, 354.5507888493783, 117.93791292764828, 100.29999999999893, 62.18677985254971, 34.70000000000022, 59.033752064169796, 76.99999999999952, 74.4658645186092, 221.81602017193205, 37.902861084849405, 114.79893903758561, 61.21539365618878, 258.54428830700743, 193.30262653686077, 58.12543914406729, 252.86382862500335, 227.72739684425852, 134.3999999999987, 54.70000000000042, 194.22240884452026, 132.83568591061538, 215.001340669771, 272.6298847439129, 98.66630708200589, 39.31493455273389, 134.04610988337694, 120.29999999999869, 37.06340980590912, 96.84499957265037, 90.01437887145501, 33.67256468346061, 143.8835342702622, 62.20000000000044], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-855.9497622903464, -209.412158487652, -956.9162021835191, -341.2080017188314, -475.2887771554405, -1031.9292475366192, -520.6432827464001, -919.7624634274076, -22.8474056938064, -310.35737804319797, -824.7384456243628, -702.7184819535969, -385.2123409629351, -504.98523930351985, -753.2394586080401, -143.93060388595492, -827.5492647962283, -451.98987779831396, -711.1427484533295, -7.95739700040251, -401.7608083061357, -624.5882666362892, -394.0477098315575, -886.9121075694311, -530.8218031743727, -1072.203908798587, -247.6618069335691, -578.2815405545548, -562.4351087672624, -781.957727131608, -543.4552012454208, -222.87340397526214, -742.6509913320026, -238.70196729760656, -806.2982340511716, -590.7194331368551, -58.61243492680789, -84.3078360971652, -746.6285279230694, -429.2208736812952, -474.1284042373993, -851.9980631630868, -150.75879906769794, -551.472239595214, -857.6753944338063, -1011.4303767054536, -7.9000913448726156, -712.631599859056, -529.128424661647, -600.3527169908947, -596.9567088697728, -341.5761957977312, -671.9825082095646, 72.97925943569481, -804.827127849493, -574.2778552818241, -17.02173443032985, -73.83977574727432, -45.06467487545444, -211.02357013962802, -66.24072054974273, -155.1816213108585, -350.690632812978, -1.2683077772682498, -117.32167723620628, -682.2883919539119, -359.21904396974355, 8.00993916999609, -8.002978306533059, -449.6785794158884, 15.694546778808032, 7.340731590010048, 26.32401899792112, -116.88139282310321, 22.986224030575894, -264.63667405281274, -6.734250178468175, 4.794833638246912, 42.82883876184181, 12.86555643324824, 13.753585915437222, 59.610335084190936, -0.3514480501930922, -76.57971811550647, 2.2098628131280735, -50.0124890097749, 30.304780155160174, 5.322961401798546, 59.435591520685605, 3.9324585378319425, -20.58449754596952, 13.967940786832566, 13.056551301999106, -63.79726176348972, -192.83074779610587, -39.34162598854263, -2.1348640818440594, -392.66665322386393, -92.58050348581395, 5.48845761269618, 18.408320462433064, -1.5362748107081958, -106.8925366627507, 1.9625531952995876, -587.9447151533682, 39.53228266585912, 58.424198535640414, 13.438511127677737, -10.870653726333536, -286.7519688516543, -15.469405726121558, 1.896632475050809, -27.37157654457529, -4.104137501289186, -90.16919679138167, 18.722529392220743, 33.50000000000019, -307.26012625433077, -193.94860812020175, 101.24748442820652, -171.5157800341755, 13.915540428199643, 14.39150744018921, -58.43738586977307, 7.663800299892815, -170.73620292535304, -52.41048506112895, 124.71320656624314, -19.263125712650307, 13.306852986346723, -170.31913756890904, -436.3360683623863, -153.5543609711248, -29.90398999625898, 9.37589197071525, -505.4369057246192, -206.9666862747886, -27.82983912874142, 35.91188480899822, 12.360692100456314, 12.686654745774376, -82.45055909108737, -2.1688599503829633, -69.41796726124369, -101.85511260655659, -146.87917866127384, 50.50968258601853, -84.92955330244436, -16.937661559527676, 27.58210922605912, -428.9743178379378, -0.5367725143367618, -4.917996106590346, -49.850230319132905, -165.64246450581922, -127.9749720302242, -212.28721333934092, 9.676480610380946, -446.41278722470776, 45.20000000000021, 5.588738517812798, -285.56421717450314, -130.51134002087684, 38.831419711648344, -267.0172965311763, 0.5235674427102464, -311.8072932745375, -170.88480244148204, 19.628374377700954, 67.68303700360626, -0.5564865800742257, 12.898888000013162, -258.4314031494116, -132.3371416336955, -140.69625206162772, 52.33282262752791, -128.53483886812506, -59.38636009060169, 51.674405492466356, -442.2493221418095, 3.9747950225720365, -56.01094335038857, -75.0698189968337, -41.1278471399547, 16.730923299525337, 26.33083452555516, 19.090768533237668, 94.77194368935139, -2.6213923960826557, -44.1140872377261, -206.41678657707496, 6.349899838614457, 44.74384479936078, -40.31733635884817, 9.112645919879455, -20.854531107027732, 35.40238667417967, 90.26793983800641, 43.731838755889285, -110.44351214696964], "policy_predator_policy_reward": [813.2096324890039, 771.5173738529959, 833.3956808912673, 782.7876281149379, 707.3802286258749, 1091.1962338929143, 856.0012333294836, 976.550984458481, 328.51294036737886, 355.9520758001438, 1044.6155796910161, 755.1204235881974, 663.0784834846171, 659.7065427751078, 758.0253449675723, 584.0334938789697, 927.0187616329098, 768.1753147882008, 685.3232887991257, 323.94805674232595, 682.4782425915799, 658.6700154630369, 926.9704431166524, 817.8632211288668, 1146.210220262282, 1144.407799436151, 537.9505861416428, 706.4335806589828, 893.2337324282373, 862.5492764516489, 563.8194761269524, 576.4223599128482, 771.6529732265835, 766.5402829943245, 960.1209088590384, 813.560710480242, 156.15244178406888, 96.1589005931135, 694.8625687467189, 909.7803015262407, 799.399908431444, 978.7467542499926, 461.80296172389814, 509.0153080713342, 1141.365220764064, 1188.7464797108196, 604.9119439926931, 636.3417266640757, 542.6366171877366, 794.1497828769293, 662.7586527591171, 631.1350280701612, 656.3744655673557, 537.4398025328754, 867.4862905390688, 1000.5457900327905, 113.70419352782783, 55.230286906117925, 187.9483250012488, 174.175550697486, 200.03673170866534, 120.48263589802025, 294.99170311295876, 290.96145185150846, 641.1524233544916, 584.9684429994645, 310.19422609350465, 333.61621352105624, 284.3989537526146, 438.19026607664597, 3.905453221191931, 14.659268409989906, 115.11318054501949, 105.29324466004265, 126.70225299563776, 302.3026694770454, 36.433029074863626, 31.00798864366419, 20.562546405148854, 31.44829963334237, 5.846414084562742, 2.4896649158092554, 41.58916499008782, 88.92731451745784, 58.433271367295816, 31.60410975226028, 5.069922727640636, 38.60233571540077, 41.57973641486817, 24.224594922873237, 40.89373794770294, 43.53205921316743, 66.661379218126, 24.579331243363747, 200.2359700445598, 67.39863240403464, 278.2847615322727, 397.5547020275504, 104.37358453728012, 23.570884480387168, 27.21462890463298, 23.276655398042976, 118.60283924850467, 81.82220922026558, 551.0147444490893, 578.6123381226387, 8.475801464359783, 6.0614888723222276, 203.50402360648422, 283.8464456627423, 31.137117076355494, 19.935656174715483, 26.344112795555453, 32.398704190992106, 44.89097542494187, 107.86175970767212, 247.96503552855012, 275.4474825743527, 125.49015192338496, 178.3409594284947, 175.4464578360846, 44.76628884859836, 39.056080782029525, 38.35837651828014, 151.44548289058537, 182.24288759063757, 69.81048506112884, 5.586793433756438, 41.904514231945114, 28.60451762596664, 444.0938122961893, 476.46007289056905, 190.61514813838997, 54.636084982696865, 345.43542608528344, 505.1763765179974, 226.91823524053183, 125.81620309064641, 44.98811519100192, 7.039307899543651, 44.52190504727681, 87.4287791505846, 43.4220511877658, 62.86477602386003, 143.273439359502, 164.49460397249658, 9.890317413981672, 101.52955330244342, 27.103820357781657, 36.71759649429678, 428.4231673854012, 222.90394313880842, 26.516359206544536, 66.15472830402796, 169.73042741238245, 238.6859481612464, 157.49260041205707, 106.33352597309049, 432.1342234259438, 227.6228521057715, 183.8160628297762, 289.4620423637785, 141.9113400208763, 7.8940194324188315, 245.9366538345066, 273.42090387896457, 321.23716886470766, 389.18232369557273, 39.371625622299085, 7.716962996393633, 19.656486580074237, 22.701111999986804, 377.5409813913607, 207.44997223626777, 103.92349327233123, 117.27562207238516, 176.50187256434202, 226.4206670641557, 228.41949891126706, 434.785302481989, 67.50878380227562, 83.1936716075479, 102.887967728636, 52.6246329608852, 71.36146567978258, 19.62288637851409, 0.8092314667623366, 5.628056310648025, 22.784802201991543, 61.01408723772633, 213.09595390892585, 83.8159324021846, 69.08624427704271, 16.50162615390026, 43.84865892691055, 1.565790943698316, 11.481147596084144, 6.732060161993158, 2.168161244110926, 126.74351214696871]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.932190766025531, "mean_inference_ms": 3.8191453266528197, "mean_action_processing_ms": 1.9420399830990818, "mean_env_wait_ms": 1.1951234789543488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003462672233581543, "StateBufferConnector_ms": 0.013009786605834961, "ViewRequirementAgentConnector_ms": 0.09665191173553467}, "num_episodes": 72, "episode_return_max": 687.5923077254733, "episode_return_min": 27.26710294068299, "episode_return_mean": 207.60958157886228, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 248.55231474048324, "num_env_steps_trained_throughput_per_sec": 248.55231474048324, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 32383.005, "restore_workers_time_ms": 0.024, "training_step_time_ms": 32382.608, "sample_time_ms": 1332.202, "learn_time_ms": 31020.281, "learn_throughput": 257.896, "synch_weights_time_ms": 24.831}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 33, "trial_id": "cd905_00000", "date": "2024-08-20_09-42-06", "timestamp": 1724127126, "time_this_iter_s": 32.222280979156494, "time_total_s": 1084.2048473358154, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a1058b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1084.2048473358154, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 32.21521739130435, "ram_util_percent": 81.38043478260869}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5490032297632996, "cur_kl_coeff": 5.1498413085937495e-06, "cur_lr": 0.0001, "total_loss": 0.5314648267768678, "policy_loss": -0.0032955363518484527, "vf_loss": 0.5347603092117915, "vf_explained_var": 0.23252309059339857, "kl": 0.010890602307024112, "entropy": 1.5361016008589004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 21105.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8258619454408449, "cur_kl_coeff": 5.7220458984375e-07, "cur_lr": 0.0001, "total_loss": 0.15756876313585846, "policy_loss": -0.0011572224771722204, "vf_loss": 0.1587259823840762, "vf_explained_var": 1.654000509352911e-05, "kl": 0.00881214036572702, "entropy": 1.3236582583851284, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 21105.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 687.5923077254733, "episode_reward_min": 27.26710294068299, "episode_reward_mean": 182.65725439057277, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1072.203908798587, "predator_policy": 0.8092314667623366}, "policy_reward_max": {"prey_policy": 124.71320656624314, "predator_policy": 1188.7464797108196}, "policy_reward_mean": {"prey_policy": -158.94546432160988, "predator_policy": 250.27409151689633}, "custom_metrics": {}, "hist_stats": {"episode_reward": [415.6549338265692, 290.17120008771934, 314.7991831121913, 463.8738468445304, 687.5923077254733, 418.44081931250196, 411.39017298101663, 373.91323081911656, 556.8402975913, 376.6639521512537, 109.3910713532091, 428.79346866859487, 452.02019528095235, 268.5872311323199, 461.00592933562183, 520.7219794528421, 207.30525841212406, 355.36077616177505, 594.8110193263637, 488.9270974405433, 78.07297025634132, 106.03563068365169, 99.0970257460847, 233.99421437421734, 426.5107971638394, 292.60133481481483, 264.90766210683813, 41.600000000000286, 129.84905137987974, 187.35447245044233, 65.5016011783069, 107.7052412335799, 81.69999999999924, 53.585313341847346, 42.234754922909445, 79.29999999999934, 129.1723813962573, 77.80924040173264, 40.50000000000031, 35.462228663946775, 281.0379462541153, 40.85242314455077, 67.36332995440111, 95.49506500131854, 581.21465008422, 86.39999999999885, 189.7278466912362, 37.50000000000026, 27.26710294068299, 81.30606773345316, 249.65239184857023, 211.12998765988428, 62.612507078708276, 33.368578870726495, 170.61596785576205, 147.69999999999888, 64.55275913160845, 313.8986792554651, 61.79288215370363, 354.5507888493783, 117.93791292764828, 100.29999999999893, 62.18677985254971, 34.70000000000022, 59.033752064169796, 76.99999999999952, 74.4658645186092, 221.81602017193205, 37.902861084849405, 114.79893903758561, 61.21539365618878, 258.54428830700743, 193.30262653686077, 58.12543914406729, 252.86382862500335, 227.72739684425852, 134.3999999999987, 54.70000000000042, 194.22240884452026, 132.83568591061538, 215.001340669771, 272.6298847439129, 98.66630708200589, 39.31493455273389, 134.04610988337694, 120.29999999999869, 37.06340980590912, 96.84499957265037, 90.01437887145501, 33.67256468346061, 143.8835342702622, 62.20000000000044, 48.01191175739115, 78.99999999999937, 40.80000000000031, 43.700000000000315, 36.00000000000021, 92.09999999999859, 65.30000000000037, 121.7999999999987], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-827.5492647962283, -451.98987779831396, -711.1427484533295, -7.95739700040251, -401.7608083061357, -624.5882666362892, -394.0477098315575, -886.9121075694311, -530.8218031743727, -1072.203908798587, -247.6618069335691, -578.2815405545548, -562.4351087672624, -781.957727131608, -543.4552012454208, -222.87340397526214, -742.6509913320026, -238.70196729760656, -806.2982340511716, -590.7194331368551, -58.61243492680789, -84.3078360971652, -746.6285279230694, -429.2208736812952, -474.1284042373993, -851.9980631630868, -150.75879906769794, -551.472239595214, -857.6753944338063, -1011.4303767054536, -7.9000913448726156, -712.631599859056, -529.128424661647, -600.3527169908947, -596.9567088697728, -341.5761957977312, -671.9825082095646, 72.97925943569481, -804.827127849493, -574.2778552818241, -17.02173443032985, -73.83977574727432, -45.06467487545444, -211.02357013962802, -66.24072054974273, -155.1816213108585, -350.690632812978, -1.2683077772682498, -117.32167723620628, -682.2883919539119, -359.21904396974355, 8.00993916999609, -8.002978306533059, -449.6785794158884, 15.694546778808032, 7.340731590010048, 26.32401899792112, -116.88139282310321, 22.986224030575894, -264.63667405281274, -6.734250178468175, 4.794833638246912, 42.82883876184181, 12.86555643324824, 13.753585915437222, 59.610335084190936, -0.3514480501930922, -76.57971811550647, 2.2098628131280735, -50.0124890097749, 30.304780155160174, 5.322961401798546, 59.435591520685605, 3.9324585378319425, -20.58449754596952, 13.967940786832566, 13.056551301999106, -63.79726176348972, -192.83074779610587, -39.34162598854263, -2.1348640818440594, -392.66665322386393, -92.58050348581395, 5.48845761269618, 18.408320462433064, -1.5362748107081958, -106.8925366627507, 1.9625531952995876, -587.9447151533682, 39.53228266585912, 58.424198535640414, 13.438511127677737, -10.870653726333536, -286.7519688516543, -15.469405726121558, 1.896632475050809, -27.37157654457529, -4.104137501289186, -90.16919679138167, 18.722529392220743, 33.50000000000019, -307.26012625433077, -193.94860812020175, 101.24748442820652, -171.5157800341755, 13.915540428199643, 14.39150744018921, -58.43738586977307, 7.663800299892815, -170.73620292535304, -52.41048506112895, 124.71320656624314, -19.263125712650307, 13.306852986346723, -170.31913756890904, -436.3360683623863, -153.5543609711248, -29.90398999625898, 9.37589197071525, -505.4369057246192, -206.9666862747886, -27.82983912874142, 35.91188480899822, 12.360692100456314, 12.686654745774376, -82.45055909108737, -2.1688599503829633, -69.41796726124369, -101.85511260655659, -146.87917866127384, 50.50968258601853, -84.92955330244436, -16.937661559527676, 27.58210922605912, -428.9743178379378, -0.5367725143367618, -4.917996106590346, -49.850230319132905, -165.64246450581922, -127.9749720302242, -212.28721333934092, 9.676480610380946, -446.41278722470776, 45.20000000000021, 5.588738517812798, -285.56421717450314, -130.51134002087684, 38.831419711648344, -267.0172965311763, 0.5235674427102464, -311.8072932745375, -170.88480244148204, 19.628374377700954, 67.68303700360626, -0.5564865800742257, 12.898888000013162, -258.4314031494116, -132.3371416336955, -140.69625206162772, 52.33282262752791, -128.53483886812506, -59.38636009060169, 51.674405492466356, -442.2493221418095, 3.9747950225720365, -56.01094335038857, -75.0698189968337, -41.1278471399547, 16.730923299525337, 26.33083452555516, 19.090768533237668, 94.77194368935139, -2.6213923960826557, -44.1140872377261, -206.41678657707496, 6.349899838614457, 44.74384479936078, -40.31733635884817, 9.112645919879455, -20.854531107027732, 35.40238667417967, 90.26793983800641, 43.731838755889285, -110.44351214696964, -23.7768379916323, 1.0335556883730075, 42.4154361559195, 15.043510256214013, 8.055970077972935, 17.279928012475192, -8.236716872064186, 11.601593417134438, -77.522074292414, -39.219966096504294, 17.195816173392515, 41.37075963381346, 31.586268924340573, 14.244000485653379, -27.48708619657424, 99.38775770368157], "policy_predator_policy_reward": [927.0187616329098, 768.1753147882008, 685.3232887991257, 323.94805674232595, 682.4782425915799, 658.6700154630369, 926.9704431166524, 817.8632211288668, 1146.210220262282, 1144.407799436151, 537.9505861416428, 706.4335806589828, 893.2337324282373, 862.5492764516489, 563.8194761269524, 576.4223599128482, 771.6529732265835, 766.5402829943245, 960.1209088590384, 813.560710480242, 156.15244178406888, 96.1589005931135, 694.8625687467189, 909.7803015262407, 799.399908431444, 978.7467542499926, 461.80296172389814, 509.0153080713342, 1141.365220764064, 1188.7464797108196, 604.9119439926931, 636.3417266640757, 542.6366171877366, 794.1497828769293, 662.7586527591171, 631.1350280701612, 656.3744655673557, 537.4398025328754, 867.4862905390688, 1000.5457900327905, 113.70419352782783, 55.230286906117925, 187.9483250012488, 174.175550697486, 200.03673170866534, 120.48263589802025, 294.99170311295876, 290.96145185150846, 641.1524233544916, 584.9684429994645, 310.19422609350465, 333.61621352105624, 284.3989537526146, 438.19026607664597, 3.905453221191931, 14.659268409989906, 115.11318054501949, 105.29324466004265, 126.70225299563776, 302.3026694770454, 36.433029074863626, 31.00798864366419, 20.562546405148854, 31.44829963334237, 5.846414084562742, 2.4896649158092554, 41.58916499008782, 88.92731451745784, 58.433271367295816, 31.60410975226028, 5.069922727640636, 38.60233571540077, 41.57973641486817, 24.224594922873237, 40.89373794770294, 43.53205921316743, 66.661379218126, 24.579331243363747, 200.2359700445598, 67.39863240403464, 278.2847615322727, 397.5547020275504, 104.37358453728012, 23.570884480387168, 27.21462890463298, 23.276655398042976, 118.60283924850467, 81.82220922026558, 551.0147444490893, 578.6123381226387, 8.475801464359783, 6.0614888723222276, 203.50402360648422, 283.8464456627423, 31.137117076355494, 19.935656174715483, 26.344112795555453, 32.398704190992106, 44.89097542494187, 107.86175970767212, 247.96503552855012, 275.4474825743527, 125.49015192338496, 178.3409594284947, 175.4464578360846, 44.76628884859836, 39.056080782029525, 38.35837651828014, 151.44548289058537, 182.24288759063757, 69.81048506112884, 5.586793433756438, 41.904514231945114, 28.60451762596664, 444.0938122961893, 476.46007289056905, 190.61514813838997, 54.636084982696865, 345.43542608528344, 505.1763765179974, 226.91823524053183, 125.81620309064641, 44.98811519100192, 7.039307899543651, 44.52190504727681, 87.4287791505846, 43.4220511877658, 62.86477602386003, 143.273439359502, 164.49460397249658, 9.890317413981672, 101.52955330244342, 27.103820357781657, 36.71759649429678, 428.4231673854012, 222.90394313880842, 26.516359206544536, 66.15472830402796, 169.73042741238245, 238.6859481612464, 157.49260041205707, 106.33352597309049, 432.1342234259438, 227.6228521057715, 183.8160628297762, 289.4620423637785, 141.9113400208763, 7.8940194324188315, 245.9366538345066, 273.42090387896457, 321.23716886470766, 389.18232369557273, 39.371625622299085, 7.716962996393633, 19.656486580074237, 22.701111999986804, 377.5409813913607, 207.44997223626777, 103.92349327233123, 117.27562207238516, 176.50187256434202, 226.4206670641557, 228.41949891126706, 434.785302481989, 67.50878380227562, 83.1936716075479, 102.887967728636, 52.6246329608852, 71.36146567978258, 19.62288637851409, 0.8092314667623366, 5.628056310648025, 22.784802201991543, 61.01408723772633, 213.09595390892585, 83.8159324021846, 69.08624427704271, 16.50162615390026, 43.84865892691055, 1.565790943698316, 11.481147596084144, 6.732060161993158, 2.168161244110926, 126.74351214696871, 24.0985709480061, 46.65662311264413, 16.984563844080693, 4.556489743785951, 12.944029922027031, 2.520071987524788, 27.43671687206432, 12.898406582865515, 64.36571853652755, 88.37632185239015, 24.204183826607466, 9.32924036618671, 13.413731075659644, 6.055999514346587, 45.9870861965745, 3.912242296317845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.927820274009427, "mean_inference_ms": 3.819455687818642, "mean_action_processing_ms": 1.9283279074489952, "mean_env_wait_ms": 1.1900286374050535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038411617279052734, "StateBufferConnector_ms": 0.01337897777557373, "ViewRequirementAgentConnector_ms": 0.10096943378448486}, "num_episodes": 8, "episode_return_max": 687.5923077254733, "episode_return_min": 27.26710294068299, "episode_return_mean": 182.65725439057277, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 247.47045038120203, "num_env_steps_trained_throughput_per_sec": 247.47045038120203, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 32389.945, "restore_workers_time_ms": 0.023, "training_step_time_ms": 32389.441, "sample_time_ms": 1317.721, "learn_time_ms": 31040.844, "learn_throughput": 257.725, "synch_weights_time_ms": 25.703}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 34, "trial_id": "cd905_00000", "date": "2024-08-20_09-42-38", "timestamp": 1724127158, "time_this_iter_s": 32.35585618019104, "time_total_s": 1116.5607035160065, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afec9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1116.5607035160065, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 35.47608695652174, "ram_util_percent": 81.19347826086957}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7799730562856273, "cur_kl_coeff": 5.1498413085937495e-06, "cur_lr": 0.0001, "total_loss": 2.329923763350835, "policy_loss": -0.0017748463858244202, "vf_loss": 2.3316986053709, "vf_explained_var": 0.08027354355842348, "kl": 0.005155608229741784, "entropy": 1.5709988696234567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5538873155083921, "cur_kl_coeff": 5.7220458984375e-07, "cur_lr": 0.0001, "total_loss": 1.0006592222622464, "policy_loss": -0.0033807493118007503, "vf_loss": 1.0040399699457108, "vf_explained_var": -0.004526712402464852, "kl": 0.013151684123720234, "entropy": 1.3320481186821347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 272.6298847439129, "episode_reward_min": 33.67256468346061, "episode_reward_mean": 81.46816358293674, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -446.41278722470776, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 99.38775770368157, "predator_policy": 434.785302481989}, "policy_reward_mean": {"prey_policy": -12.445966729896114, "predator_policy": 53.18004852136459}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.033752064169796, 76.99999999999952, 74.4658645186092, 221.81602017193205, 37.902861084849405, 114.79893903758561, 61.21539365618878, 258.54428830700743, 193.30262653686077, 58.12543914406729, 252.86382862500335, 227.72739684425852, 134.3999999999987, 54.70000000000042, 194.22240884452026, 132.83568591061538, 215.001340669771, 272.6298847439129, 98.66630708200589, 39.31493455273389, 134.04610988337694, 120.29999999999869, 37.06340980590912, 96.84499957265037, 90.01437887145501, 33.67256468346061, 143.8835342702622, 62.20000000000044, 48.01191175739115, 78.99999999999937, 40.80000000000031, 43.700000000000315, 36.00000000000021, 92.09999999999859, 65.30000000000037, 121.7999999999987, 44.800000000000395, 38.00000000000027, 54.80000000000047, 55.60000000000053, 38.10000000000027, 50.190670455786844, 39.40000000000029, 42.500000000000355, 39.20000000000029, 83.99999999999895, 118.64497005088865, 57.24528248851458, 76.39999999999944, 93.49160146700603, 53.400000000000304, 54.40000000000036, 80.3999999999993, 53.700000000000514, 70.79999999999998, 83.69999999999901, 118.6683059436183, 60.400000000000425, 88.45436961566531, 133.69999999999857, 37.90000000000027, 59.30000000000048, 39.30000000000029, 88.59999999999872, 36.00000000000024, 36.300000000000246, 36.50000000000025, 46.393772092105124, 44.248593523941736, 41.00000000000031, 66.20000000000032, 41.300000000000324, 69.33199899653873, 89.95652074958768, 38.80000000000028, 39.3000000000003, 138.49999999999858, 41.5983058359622, 77.42392921770465, 46.077710227677294, 83.32533502605513, 46.3000000000004, 179.30285223485228, 69.68983697209045, 36.78703784272975, 55.18124141412196, 74.09999999999957, 37.90000000000027, 121.69999999999901, 52.40000000000044, 39.20000000000029, 94.69636546860502, 42.800000000000345, 40.700000000000315, 117.52991631925002, 43.60108105531734, 46.70000000000041, 45.90000000000028, 63.17278065706108, 88.49999999999893], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-101.85511260655659, -146.87917866127384, 50.50968258601853, -84.92955330244436, -16.937661559527676, 27.58210922605912, -428.9743178379378, -0.5367725143367618, -4.917996106590346, -49.850230319132905, -165.64246450581922, -127.9749720302242, -212.28721333934092, 9.676480610380946, -446.41278722470776, 45.20000000000021, 5.588738517812798, -285.56421717450314, -130.51134002087684, 38.831419711648344, -267.0172965311763, 0.5235674427102464, -311.8072932745375, -170.88480244148204, 19.628374377700954, 67.68303700360626, -0.5564865800742257, 12.898888000013162, -258.4314031494116, -132.3371416336955, -140.69625206162772, 52.33282262752791, -128.53483886812506, -59.38636009060169, 51.674405492466356, -442.2493221418095, 3.9747950225720365, -56.01094335038857, -75.0698189968337, -41.1278471399547, 16.730923299525337, 26.33083452555516, 19.090768533237668, 94.77194368935139, -2.6213923960826557, -44.1140872377261, -206.41678657707496, 6.349899838614457, 44.74384479936078, -40.31733635884817, 9.112645919879455, -20.854531107027732, 35.40238667417967, 90.26793983800641, 43.731838755889285, -110.44351214696964, -23.7768379916323, 1.0335556883730075, 42.4154361559195, 15.043510256214013, 8.055970077972935, 17.279928012475192, -8.236716872064186, 11.601593417134438, -77.522074292414, -39.219966096504294, 17.195816173392515, 41.37075963381346, 31.586268924340573, 14.244000485653379, -27.48708619657424, 99.38775770368157, 9.160622749915982, -16.235094594263664, 2.010945261891626, -1.6458294283083745, 18.03692385275909, 18.75314611721383, 22.853959513947533, 26.29716844769737, 3.81801287570097, 9.419807087630224, -10.547988157789637, 0.03393498615833687, 17.848817732957087, 12.289537290304638, 6.9057427752144225, -2.264084172476749, 12.132519736556914, -3.482855089926656, 14.50014995567976, 19.70545852126792, -20.117023561404352, 97.15907283621316, 13.278509584995835, -6.063407689864807, 15.246239908815719, 55.918316727738826, 32.3698492570407, -31.640190951527345, -34.87616701483909, 10.950420653348317, -15.492102311489521, 10.63650459129266, 59.47214225788063, -10.312855227822675, 31.947755841269384, 13.546044707156753, 22.053792733413967, 29.24511274520247, 18.949857848969824, -22.44026267587791, 87.29760330521503, -5.029190503208955, 13.78778353881984, 33.5845543783591, 8.697795966094054, -11.611401305455352, 25.323005628725593, 94.39898190286593, -8.33547026634063, -29.66962762861911, -4.736361510301771, 35.577308555007725, 17.3945121624324, 12.247537811507215, 36.92284863854657, 30.076006586481622, -3.0522635597147625, -56.8311932984775, -10.142579515417163, -28.470412269649344, 17.720040835297414, -62.843051626823154, -10.706650170067439, -8.511581539578545, 18.792984205435115, -22.09722355442654, 10.157637213544728, 7.8787514815569395, 16.606731879260277, 37.48316594935657, 15.52373465454167, 20.710131373541742, 10.741990294684465, -9.428547881515076, 25.82995984492579, 38.85964575788216, 5.539716960948283, 18.041654705995764, -19.198921796926868, 8.459460613436072, 85.14047937606563, 26.586761377978075, -53.35540087140223, 3.849974968321148, 1.6286131078803037, 27.98100147017692, 7.225721802418811, 11.293790952097478, -110.37068362768326, 36.97721043208329, 1.9446618224774352, 24.839064422574626, 6.575292759438001, 70.29293033659013, 27.966084363180745, 21.642885895206327, 17.887037842729484, -5.23546993751334, 11.63316499384307, 16.331969812974403, -8.957675723379515, 12.092652653163238, 1.5250759807602436, 6.497198619854355, 32.90970597882599, -3.0628199186232576, 17.511392876221997, 15.602407197505581, 18.77392422529585, 0.23971577410365977, 62.22881480350921, -0.8079930015532144, 14.917776937793112, 18.606087652457113, -14.201538292170337, 2.6879493706703608, -5.274980792264833, 18.0275276484085, -29.597846818841624, -13.241747108682091, 17.507656384213437, 13.06688608721698, 12.427771178742296, 20.000000000000014, -1.1566282220836075, 34.61043874504388, 62.39427421237665, 4.775970447014762], "policy_predator_policy_reward": [143.273439359502, 164.49460397249658, 9.890317413981672, 101.52955330244342, 27.103820357781657, 36.71759649429678, 428.4231673854012, 222.90394313880842, 26.516359206544536, 66.15472830402796, 169.73042741238245, 238.6859481612464, 157.49260041205707, 106.33352597309049, 432.1342234259438, 227.6228521057715, 183.8160628297762, 289.4620423637785, 141.9113400208763, 7.8940194324188315, 245.9366538345066, 273.42090387896457, 321.23716886470766, 389.18232369557273, 39.371625622299085, 7.716962996393633, 19.656486580074237, 22.701111999986804, 377.5409813913607, 207.44997223626777, 103.92349327233123, 117.27562207238516, 176.50187256434202, 226.4206670641557, 228.41949891126706, 434.785302481989, 67.50878380227562, 83.1936716075479, 102.887967728636, 52.6246329608852, 71.36146567978258, 19.62288637851409, 0.8092314667623366, 5.628056310648025, 22.784802201991543, 61.01408723772633, 213.09595390892585, 83.8159324021846, 69.08624427704271, 16.50162615390026, 43.84865892691055, 1.565790943698316, 11.481147596084144, 6.732060161993158, 2.168161244110926, 126.74351214696871, 24.0985709480061, 46.65662311264413, 16.984563844080693, 4.556489743785951, 12.944029922027031, 2.520071987524788, 27.43671687206432, 12.898406582865515, 64.36571853652755, 88.37632185239015, 24.204183826607466, 9.32924036618671, 13.413731075659644, 6.055999514346587, 45.9870861965745, 3.912242296317845, 32.57722552004171, 19.297246324306155, 31.915602221397556, 5.719281945019163, 15.932336407545066, 2.0775936224820004, 5.646040486052524, 0.8028315523027449, 15.181987124298995, 9.680192912369742, 42.45489564056301, 18.249827986854864, 1.9511822670428998, 7.310462709695326, 17.09425722478556, 20.76408417247677, 7.367480263443051, 23.1828550899267, 31.355055347278455, 18.439336175773853, 37.8170235614046, 3.7858972146762353, 23.932759079425818, 26.09742151395731, 4.353760091184245, 0.8816832722613227, 46.54601090329074, 46.215932258203566, 68.67616701483901, 8.649579346651647, 44.85597529496444, 14.3996224252326, 2.627857742119585, 28.612855227822834, 2.2522441587308335, 5.9539552928432125, 15.646207266586085, 3.8548872547977022, 31.942799369450555, 55.24760545745778, 23.772021501137857, 12.627871640475162, 6.512216461180126, 6.515445621641113, 64.11809079025879, 27.24988416476919, 12.076994371274512, 1.9010180971334456, 29.194832362066737, 46.71026553289341, 26.236361510301816, 2.2226914449925106, 2.4054878375675828, 7.252462188492751, 1.7771513614536834, 19.823993413518583, 21.45226355971479, 74.43119329847701, 48.39803027681661, 26.514961508250316, 28.106827956298716, 53.516182835226154, 13.01499352495034, 52.59701027680062, 39.897223554426795, 7.655609318506253, 11.742362786455239, 11.221248518443026, 3.093268120739694, 9.016834050643661, 4.076265345458294, 0.9898686264582826, 27.94327699590526, 40.075279587464074, 13.25434729946229, 12.01256784731917, 13.460283039051683, 1.7583452940042243, 28.101453690072958, 21.938007493418052, 14.159520623933782, 12.613238622022052, 48.212804508670004, 42.890927230372654, 37.17138689211966, 10.642927747528347, 20.116774455119465, 7.441423018041073, 135.67068362768248, 21.048124593973014, 16.555338177522525, 2.9609355774254817, 54.909712363250385, 47.52491677557463, 12.107874646771297, 7.97299206693219, 0.0, 24.135469937513417, 26.243051322689674, 0.973055284614263, 63.65767572337958, 7.3073473468367265, 17.174924019239718, 12.70280138014561, 32.99029402117419, 58.86281991862332, 2.2886071237779855, 16.99759280249439, 1.1260757747041479, 19.060284225896343, 28.352549808794578, 4.922993857855983, 5.434900867845826, 3.841234541903912, 9.552626228286734, 42.66096269321341, 43.532720504159634, 61.244648958947465, 46.44520875293886, 39.99546622990229, 9.792343615786544, 6.333113912782984, 13.47222882125765, 0.0, 19.8958162473309, 9.823153886769656, 7.405725787623474, 13.924029552985203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.903527021674996, "mean_inference_ms": 3.791522549372221, "mean_action_processing_ms": 1.9167408867510864, "mean_env_wait_ms": 1.184331994011224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004781842231750488, "StateBufferConnector_ms": 0.013770461082458496, "ViewRequirementAgentConnector_ms": 0.10557782649993896}, "num_episodes": 64, "episode_return_max": 272.6298847439129, "episode_return_min": 33.67256468346061, "episode_return_mean": 81.46816358293674, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 245.89572351334868, "num_env_steps_trained_throughput_per_sec": 245.89572351334868, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 32393.068, "restore_workers_time_ms": 0.024, "training_step_time_ms": 32392.572, "sample_time_ms": 1315.52, "learn_time_ms": 31049.973, "learn_throughput": 257.649, "synch_weights_time_ms": 22.192}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 35, "trial_id": "cd905_00000", "date": "2024-08-20_09-43-11", "timestamp": 1724127191, "time_this_iter_s": 32.5747389793396, "time_total_s": 1149.135442495346, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16aff5700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1149.135442495346, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 34.83478260869565, "ram_util_percent": 81.96521739130435}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4670873674135358, "cur_kl_coeff": 5.1498413085937495e-06, "cur_lr": 0.0001, "total_loss": 0.6558120697027161, "policy_loss": -0.003697533440214419, "vf_loss": 0.6595095543161271, "vf_explained_var": 0.1047219713528951, "kl": 0.009400736563151123, "entropy": 1.5958765026122805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 22365.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4174283119953341, "cur_kl_coeff": 5.7220458984375e-07, "cur_lr": 0.0001, "total_loss": 0.16889623284694694, "policy_loss": -0.0005735707336238452, "vf_loss": 0.16946980336769707, "vf_explained_var": -0.008116427016636682, "kl": 0.0023987108776935434, "entropy": 1.3530100515910557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 22365.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 272.6298847439129, "episode_reward_min": 33.67256468346061, "episode_reward_mean": 76.66726403751095, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -442.2493221418095, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 99.38775770368157, "predator_policy": 434.785302481989}, "policy_reward_mean": {"prey_policy": -3.6286268654014906, "predator_policy": 41.962258884157066}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193.30262653686077, 58.12543914406729, 252.86382862500335, 227.72739684425852, 134.3999999999987, 54.70000000000042, 194.22240884452026, 132.83568591061538, 215.001340669771, 272.6298847439129, 98.66630708200589, 39.31493455273389, 134.04610988337694, 120.29999999999869, 37.06340980590912, 96.84499957265037, 90.01437887145501, 33.67256468346061, 143.8835342702622, 62.20000000000044, 48.01191175739115, 78.99999999999937, 40.80000000000031, 43.700000000000315, 36.00000000000021, 92.09999999999859, 65.30000000000037, 121.7999999999987, 44.800000000000395, 38.00000000000027, 54.80000000000047, 55.60000000000053, 38.10000000000027, 50.190670455786844, 39.40000000000029, 42.500000000000355, 39.20000000000029, 83.99999999999895, 118.64497005088865, 57.24528248851458, 76.39999999999944, 93.49160146700603, 53.400000000000304, 54.40000000000036, 80.3999999999993, 53.700000000000514, 70.79999999999998, 83.69999999999901, 118.6683059436183, 60.400000000000425, 88.45436961566531, 133.69999999999857, 37.90000000000027, 59.30000000000048, 39.30000000000029, 88.59999999999872, 36.00000000000024, 36.300000000000246, 36.50000000000025, 46.393772092105124, 44.248593523941736, 41.00000000000031, 66.20000000000032, 41.300000000000324, 69.33199899653873, 89.95652074958768, 38.80000000000028, 39.3000000000003, 138.49999999999858, 41.5983058359622, 77.42392921770465, 46.077710227677294, 83.32533502605513, 46.3000000000004, 179.30285223485228, 69.68983697209045, 36.78703784272975, 55.18124141412196, 74.09999999999957, 37.90000000000027, 121.69999999999901, 52.40000000000044, 39.20000000000029, 94.69636546860502, 42.800000000000345, 40.700000000000315, 117.52991631925002, 43.60108105531734, 46.70000000000041, 45.90000000000028, 63.17278065706108, 88.49999999999893, 68.60000000000011, 40.2000000000003, 68.89999999999999, 37.987164297761716, 42.10000000000033, 38.300000000000274, 69.59999999999982, 59.00000000000049], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.588738517812798, -285.56421717450314, -130.51134002087684, 38.831419711648344, -267.0172965311763, 0.5235674427102464, -311.8072932745375, -170.88480244148204, 19.628374377700954, 67.68303700360626, -0.5564865800742257, 12.898888000013162, -258.4314031494116, -132.3371416336955, -140.69625206162772, 52.33282262752791, -128.53483886812506, -59.38636009060169, 51.674405492466356, -442.2493221418095, 3.9747950225720365, -56.01094335038857, -75.0698189968337, -41.1278471399547, 16.730923299525337, 26.33083452555516, 19.090768533237668, 94.77194368935139, -2.6213923960826557, -44.1140872377261, -206.41678657707496, 6.349899838614457, 44.74384479936078, -40.31733635884817, 9.112645919879455, -20.854531107027732, 35.40238667417967, 90.26793983800641, 43.731838755889285, -110.44351214696964, -23.7768379916323, 1.0335556883730075, 42.4154361559195, 15.043510256214013, 8.055970077972935, 17.279928012475192, -8.236716872064186, 11.601593417134438, -77.522074292414, -39.219966096504294, 17.195816173392515, 41.37075963381346, 31.586268924340573, 14.244000485653379, -27.48708619657424, 99.38775770368157, 9.160622749915982, -16.235094594263664, 2.010945261891626, -1.6458294283083745, 18.03692385275909, 18.75314611721383, 22.853959513947533, 26.29716844769737, 3.81801287570097, 9.419807087630224, -10.547988157789637, 0.03393498615833687, 17.848817732957087, 12.289537290304638, 6.9057427752144225, -2.264084172476749, 12.132519736556914, -3.482855089926656, 14.50014995567976, 19.70545852126792, -20.117023561404352, 97.15907283621316, 13.278509584995835, -6.063407689864807, 15.246239908815719, 55.918316727738826, 32.3698492570407, -31.640190951527345, -34.87616701483909, 10.950420653348317, -15.492102311489521, 10.63650459129266, 59.47214225788063, -10.312855227822675, 31.947755841269384, 13.546044707156753, 22.053792733413967, 29.24511274520247, 18.949857848969824, -22.44026267587791, 87.29760330521503, -5.029190503208955, 13.78778353881984, 33.5845543783591, 8.697795966094054, -11.611401305455352, 25.323005628725593, 94.39898190286593, -8.33547026634063, -29.66962762861911, -4.736361510301771, 35.577308555007725, 17.3945121624324, 12.247537811507215, 36.92284863854657, 30.076006586481622, -3.0522635597147625, -56.8311932984775, -10.142579515417163, -28.470412269649344, 17.720040835297414, -62.843051626823154, -10.706650170067439, -8.511581539578545, 18.792984205435115, -22.09722355442654, 10.157637213544728, 7.8787514815569395, 16.606731879260277, 37.48316594935657, 15.52373465454167, 20.710131373541742, 10.741990294684465, -9.428547881515076, 25.82995984492579, 38.85964575788216, 5.539716960948283, 18.041654705995764, -19.198921796926868, 8.459460613436072, 85.14047937606563, 26.586761377978075, -53.35540087140223, 3.849974968321148, 1.6286131078803037, 27.98100147017692, 7.225721802418811, 11.293790952097478, -110.37068362768326, 36.97721043208329, 1.9446618224774352, 24.839064422574626, 6.575292759438001, 70.29293033659013, 27.966084363180745, 21.642885895206327, 17.887037842729484, -5.23546993751334, 11.63316499384307, 16.331969812974403, -8.957675723379515, 12.092652653163238, 1.5250759807602436, 6.497198619854355, 32.90970597882599, -3.0628199186232576, 17.511392876221997, 15.602407197505581, 18.77392422529585, 0.23971577410365977, 62.22881480350921, -0.8079930015532144, 14.917776937793112, 18.606087652457113, -14.201538292170337, 2.6879493706703608, -5.274980792264833, 18.0275276484085, -29.597846818841624, -13.241747108682091, 17.507656384213437, 13.06688608721698, 12.427771178742296, 20.000000000000014, -1.1566282220836075, 34.61043874504388, 62.39427421237665, 4.775970447014762, 45.05214887941972, 11.282773515210744, -10.58426482207876, 5.3701050699407595, -10.978120466828939, 17.427295638413224, 5.350567995394535, 1.4091869430459767, 18.747853508911245, 16.155342722757307, -12.529428919692483, 15.973909196979266, -6.391748053321836, -37.718563436492246, 28.051453306467753, 22.619474235364926], "policy_predator_policy_reward": [183.8160628297762, 289.4620423637785, 141.9113400208763, 7.8940194324188315, 245.9366538345066, 273.42090387896457, 321.23716886470766, 389.18232369557273, 39.371625622299085, 7.716962996393633, 19.656486580074237, 22.701111999986804, 377.5409813913607, 207.44997223626777, 103.92349327233123, 117.27562207238516, 176.50187256434202, 226.4206670641557, 228.41949891126706, 434.785302481989, 67.50878380227562, 83.1936716075479, 102.887967728636, 52.6246329608852, 71.36146567978258, 19.62288637851409, 0.8092314667623366, 5.628056310648025, 22.784802201991543, 61.01408723772633, 213.09595390892585, 83.8159324021846, 69.08624427704271, 16.50162615390026, 43.84865892691055, 1.565790943698316, 11.481147596084144, 6.732060161993158, 2.168161244110926, 126.74351214696871, 24.0985709480061, 46.65662311264413, 16.984563844080693, 4.556489743785951, 12.944029922027031, 2.520071987524788, 27.43671687206432, 12.898406582865515, 64.36571853652755, 88.37632185239015, 24.204183826607466, 9.32924036618671, 13.413731075659644, 6.055999514346587, 45.9870861965745, 3.912242296317845, 32.57722552004171, 19.297246324306155, 31.915602221397556, 5.719281945019163, 15.932336407545066, 2.0775936224820004, 5.646040486052524, 0.8028315523027449, 15.181987124298995, 9.680192912369742, 42.45489564056301, 18.249827986854864, 1.9511822670428998, 7.310462709695326, 17.09425722478556, 20.76408417247677, 7.367480263443051, 23.1828550899267, 31.355055347278455, 18.439336175773853, 37.8170235614046, 3.7858972146762353, 23.932759079425818, 26.09742151395731, 4.353760091184245, 0.8816832722613227, 46.54601090329074, 46.215932258203566, 68.67616701483901, 8.649579346651647, 44.85597529496444, 14.3996224252326, 2.627857742119585, 28.612855227822834, 2.2522441587308335, 5.9539552928432125, 15.646207266586085, 3.8548872547977022, 31.942799369450555, 55.24760545745778, 23.772021501137857, 12.627871640475162, 6.512216461180126, 6.515445621641113, 64.11809079025879, 27.24988416476919, 12.076994371274512, 1.9010180971334456, 29.194832362066737, 46.71026553289341, 26.236361510301816, 2.2226914449925106, 2.4054878375675828, 7.252462188492751, 1.7771513614536834, 19.823993413518583, 21.45226355971479, 74.43119329847701, 48.39803027681661, 26.514961508250316, 28.106827956298716, 53.516182835226154, 13.01499352495034, 52.59701027680062, 39.897223554426795, 7.655609318506253, 11.742362786455239, 11.221248518443026, 3.093268120739694, 9.016834050643661, 4.076265345458294, 0.9898686264582826, 27.94327699590526, 40.075279587464074, 13.25434729946229, 12.01256784731917, 13.460283039051683, 1.7583452940042243, 28.101453690072958, 21.938007493418052, 14.159520623933782, 12.613238622022052, 48.212804508670004, 42.890927230372654, 37.17138689211966, 10.642927747528347, 20.116774455119465, 7.441423018041073, 135.67068362768248, 21.048124593973014, 16.555338177522525, 2.9609355774254817, 54.909712363250385, 47.52491677557463, 12.107874646771297, 7.97299206693219, 0.0, 24.135469937513417, 26.243051322689674, 0.973055284614263, 63.65767572337958, 7.3073473468367265, 17.174924019239718, 12.70280138014561, 32.99029402117419, 58.86281991862332, 2.2886071237779855, 16.99759280249439, 1.1260757747041479, 19.060284225896343, 28.352549808794578, 4.922993857855983, 5.434900867845826, 3.841234541903912, 9.552626228286734, 42.66096269321341, 43.532720504159634, 61.244648958947465, 46.44520875293886, 39.99546622990229, 9.792343615786544, 6.333113912782984, 13.47222882125765, 0.0, 19.8958162473309, 9.823153886769656, 7.405725787623474, 13.924029552985203, 4.347851120580485, 7.917226484789222, 31.384264822078915, 14.029894930059205, 52.63198364194714, 9.818841186468655, 11.46022338512337, 19.76718597419749, 1.1521464910887533, 6.044657277242653, 31.129428919692685, 3.7260908030206976, 25.391748053321933, 88.31856343649207, 8.329072458167532, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.895967652566644, "mean_inference_ms": 3.790580097438859, "mean_action_processing_ms": 1.9034863074113348, "mean_env_wait_ms": 1.1788927089381125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004854917526245117, "StateBufferConnector_ms": 0.013774752616882324, "ViewRequirementAgentConnector_ms": 0.10672223567962646}, "num_episodes": 8, "episode_return_max": 272.6298847439129, "episode_return_min": 33.67256468346061, "episode_return_mean": 76.66726403751095, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 250.47214107337373, "num_env_steps_trained_throughput_per_sec": 250.47214107337373, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 32277.179, "restore_workers_time_ms": 0.023, "training_step_time_ms": 32276.703, "sample_time_ms": 1312.261, "learn_time_ms": 30938.197, "learn_throughput": 258.58, "synch_weights_time_ms": 21.538}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 36, "trial_id": "cd905_00000", "date": "2024-08-20_09-43-43", "timestamp": 1724127223, "time_this_iter_s": 31.958600997924805, "time_total_s": 1181.0940434932709, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a105700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1181.0940434932709, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 35.36086956521739, "ram_util_percent": 81.9108695652174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.014388613875896, "cur_kl_coeff": 5.1498413085937495e-06, "cur_lr": 0.0001, "total_loss": 5.119878908944508, "policy_loss": -0.0025958533980883656, "vf_loss": 5.122474744584825, "vf_explained_var": 0.05490835100885422, "kl": 0.012488776483014446, "entropy": 1.580831675870078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 22995.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.40195762297463794, "cur_kl_coeff": 2.86102294921875e-07, "cur_lr": 0.0001, "total_loss": 1.86259495757875, "policy_loss": -0.0020215025082940146, "vf_loss": 1.8646164612164573, "vf_explained_var": -0.000600594471371363, "kl": 0.009026111414037417, "entropy": 1.3219925273032416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 22995.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 187.19039360899654, "episode_reward_min": 20.83739869006001, "episode_reward_mean": 65.16512475528714, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -110.37068362768326, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 119.23254876379136, "predator_policy": 135.67068362768248}, "policy_reward_mean": {"prey_policy": 11.821622182371339, "predator_policy": 20.76094019527229}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.33199899653873, 89.95652074958768, 38.80000000000028, 39.3000000000003, 138.49999999999858, 41.5983058359622, 77.42392921770465, 46.077710227677294, 83.32533502605513, 46.3000000000004, 179.30285223485228, 69.68983697209045, 36.78703784272975, 55.18124141412196, 74.09999999999957, 37.90000000000027, 121.69999999999901, 52.40000000000044, 39.20000000000029, 94.69636546860502, 42.800000000000345, 40.700000000000315, 117.52991631925002, 43.60108105531734, 46.70000000000041, 45.90000000000028, 63.17278065706108, 88.49999999999893, 68.60000000000011, 40.2000000000003, 68.89999999999999, 37.987164297761716, 42.10000000000033, 38.300000000000274, 69.59999999999982, 59.00000000000049, 82.82004705908413, 36.70000000000025, 51.20000000000043, 60.100000000000456, 67.90000000000022, 38.00000000000027, 46.452608600869496, 45.40000000000038, 40.3000000000003, 27.962430553685422, 54.563944228628465, 78.29999999999946, 102.69999999999987, 187.19039360899654, 154.39999999999927, 125.47299614198299, 42.00000000000034, 46.50000000000038, 153.9362679827965, 100.99999999999874, 69.10000000000011, 96.99999999999893, 56.95881987995869, 32.141969010816375, 45.200000000000394, 38.300000000000274, 60.200000000000486, 122.64037581071277, 44.70000000000038, 38.80000000000028, 20.83739869006001, 52.600000000000435, 38.90000000000028, 37.000000000000256, 108.29999999999855, 48.50000000000036, 39.24558899870032, 33.349572679722996, 63.00000000000037, 97.39999999999871, 83.3999999999991, 72.39999999999986, 45.500000000000405, 39.000000000000284, 33.4616815146728, 39.40000000000029, 65.90000000000035, 36.60000000000025, 36.98299447787689, 47.70000000000043, 103.2622534416242, 80.42056127936999, 71.22565524431053, 38.300000000000274, 45.200000000000344, 39.40000000000029, 93.29999999999858, 77.39999999999952, 38.60000000000028, 47.283174005135294, 80.94166600439249, 56.000000000000504, 38.00000000000027, 174.5999999999991], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [10.741990294684465, -9.428547881515076, 25.82995984492579, 38.85964575788216, 5.539716960948283, 18.041654705995764, -19.198921796926868, 8.459460613436072, 85.14047937606563, 26.586761377978075, -53.35540087140223, 3.849974968321148, 1.6286131078803037, 27.98100147017692, 7.225721802418811, 11.293790952097478, -110.37068362768326, 36.97721043208329, 1.9446618224774352, 24.839064422574626, 6.575292759438001, 70.29293033659013, 27.966084363180745, 21.642885895206327, 17.887037842729484, -5.23546993751334, 11.63316499384307, 16.331969812974403, -8.957675723379515, 12.092652653163238, 1.5250759807602436, 6.497198619854355, 32.90970597882599, -3.0628199186232576, 17.511392876221997, 15.602407197505581, 18.77392422529585, 0.23971577410365977, 62.22881480350921, -0.8079930015532144, 14.917776937793112, 18.606087652457113, -14.201538292170337, 2.6879493706703608, -5.274980792264833, 18.0275276484085, -29.597846818841624, -13.241747108682091, 17.507656384213437, 13.06688608721698, 12.427771178742296, 20.000000000000014, -1.1566282220836075, 34.61043874504388, 62.39427421237665, 4.775970447014762, 45.05214887941972, 11.282773515210744, -10.58426482207876, 5.3701050699407595, -10.978120466828939, 17.427295638413224, 5.350567995394535, 1.4091869430459767, 18.747853508911245, 16.155342722757307, -12.529428919692483, 15.973909196979266, -6.391748053321836, -37.718563436492246, 28.051453306467753, 22.619474235364926, 33.7908223300226, 1.1949640698853086, 9.042636867520345, -11.315779333089209, -4.958180089394164, 7.905274059485565, -3.784451620731215, 14.701336802370395, 11.178644915829166, 47.57809493101498, 0.6195762186463935, 6.278446481251429, -4.814172431599076, 15.908665118792554, 19.059821651168193, 16.154620236280124, -16.547346957432367, 3.9593236245737446, -13.147442886038261, 2.421311110874214, -69.57789169847688, 2.476819930578614, 57.41161481863554, 16.05158091470703, -2.5938141064943765, 75.88468909048987, 68.92351765614092, 69.17828627160675, 1.2823654126081883, 69.08291523406567, 28.426972417671276, 45.92599406736467, -42.82237165495846, 11.669895852581485, -41.89656452720535, 22.564374328118614, 55.747139422866674, 35.73465543207543, 57.28149155277849, 24.085495300656127, 27.16620989678979, 25.12465779082197, 13.44597431284475, 57.23817640824492, -0.6063313550469878, 18.62016617223113, 5.469709550363129, -36.97647066271554, 14.424696367561392, -0.7253679173374666, 14.780374969536705, -7.0688852103132405, 25.016241526344768, -20.85713683120833, 50.92212103775099, 45.12713383654389, 20.000000000000014, -7.005652472638545, 18.009210310230895, -13.438620905544727, -13.793370830969527, -35.899764541994166, 3.6719124302433883, 16.36391639294129, 16.94114337478494, 4.2332203142391, 5.273300559833638, -62.93558182446291, 32.16170533742087, 32.48588399660275, 22.397943572396322, -9.013029113074555, -28.589478009764754, 7.035552756737003, 7.5018807486852666, 6.803559247579642, 31.157078715656112, 18.652183078445077, 13.33257793292013, 54.927109263324816, 34.66762385747643, 4.571342533130911, 28.5312450710092, 5.400437311572482, 12.949180256422727, 12.357701692234901, 9.679791759413522, 12.212854372010643, 3.492115839816212, 5.516792298064283, 19.090583316619053, 13.249355044107602, 42.01696687070477, 10.097640672599747, -1.883529721551949, -21.059598978846566, 5.407327265502321, 11.0559535322701, 15.631635518781309, 26.948525970381073, -19.691149205649083, 18.59452539173282, 46.74947228421243, -18.9198950785431, 8.301336079479455, 25.822640288472183, -3.1404419213392436, 11.422746414539478, 1.3160540428849081, -19.385937733368536, 17.72215579925086, 15.304992559466639, 70.26807784112586, 4.609394307127136, 26.127103997537695, 23.00623681466006, 18.134571618163235, 4.444230121407612, 11.178280350108919, -4.691167068448234, -62.63151363374571, 57.87682329268533, -2.2555434953217803, 16.466492907252206, -3.309940187801074, 1.1426927449807633, 119.23254876379136, 30.238391648703875], "policy_predator_policy_reward": [27.94327699590526, 40.075279587464074, 13.25434729946229, 12.01256784731917, 13.460283039051683, 1.7583452940042243, 28.101453690072958, 21.938007493418052, 14.159520623933782, 12.613238622022052, 48.212804508670004, 42.890927230372654, 37.17138689211966, 10.642927747528347, 20.116774455119465, 7.441423018041073, 135.67068362768248, 21.048124593973014, 16.555338177522525, 2.9609355774254817, 54.909712363250385, 47.52491677557463, 12.107874646771297, 7.97299206693219, 0.0, 24.135469937513417, 26.243051322689674, 0.973055284614263, 63.65767572337958, 7.3073473468367265, 17.174924019239718, 12.70280138014561, 32.99029402117419, 58.86281991862332, 2.2886071237779855, 16.99759280249439, 1.1260757747041479, 19.060284225896343, 28.352549808794578, 4.922993857855983, 5.434900867845826, 3.841234541903912, 9.552626228286734, 42.66096269321341, 43.532720504159634, 61.244648958947465, 46.44520875293886, 39.99546622990229, 9.792343615786544, 6.333113912782984, 13.47222882125765, 0.0, 19.8958162473309, 9.823153886769656, 7.405725787623474, 13.924029552985203, 4.347851120580485, 7.917226484789222, 31.384264822078915, 14.029894930059205, 52.63198364194714, 9.818841186468655, 11.46022338512337, 19.76718597419749, 1.1521464910887533, 6.044657277242653, 31.129428919692685, 3.7260908030206976, 25.391748053321933, 88.31856343649207, 8.329072458167532, 0.0, 47.02050547834593, 0.8137551808314647, 10.45736313247962, 28.51577933308936, 23.858180089394235, 24.39472594051442, 23.984451620731257, 25.198663197629585, 8.0213550841708, 1.1219050689852528, 18.080423781353595, 13.021553518748537, 14.284569956818101, 21.073545956857533, 6.640178348831809, 3.5453797637198416, 37.94734695743263, 14.940676375426222, 33.33196745416491, 5.3565948746846175, 89.39501046240576, 32.27000553411943, 1.188385181364681, 3.6484190852929315, 22.093814106494406, 7.315310909510146, 26.15967556392391, 22.928914117325494, 54.23387555476835, 29.800843798557597, 44.49551714219301, 6.624512514755573, 65.42237165495862, 7.73010414741848, 26.571797047035563, 39.260393152051456, 22.602629379697518, 39.85184374815853, 6.3185084472216735, 13.31450469934386, 0.0, 16.809132312388474, 5.954025687155218, 20.361823591755215, 19.01126802992143, 19.93371703285264, 50.09911491128152, 13.54961521188731, 11.775303632438572, 19.72536791733748, 4.819625030463261, 25.768885210313346, 1.7903948635589269, 54.250500441304986, 14.474309994679137, 12.116810941740786, 27.317634885106717, 4.388017587531913, 1.790789689769094, 32.43862090554495, 4.747416261923556, 65.78311780110063, 26.593970371651647, 5.970200805163638, 2.7588566252150346, 14.966779685760866, 13.926699440166328, 80.73558182446197, 30.59645759726452, 13.055953068712277, 3.758306159893943, 31.356779380784477, 23.456719006535124, 37.34279524519288, 13.817448607171496, 5.226684076286317, 10.31056827498589, 2.8801699309130786, 6.067422067079836, 23.072890736675355, 18.93237614252373, 25.22865746686906, 0.0, 38.46831761741845, 13.050819743577234, 7.1422983077650635, 9.820208240586442, 7.287145627989322, 2.626125547535764, 21.826647829256267, 0.809416683380949, 6.250644955892363, 4.5830331292954645, 9.202359327400218, 20.883529721551977, 38.659598978846816, 2.685529629429459, 17.834184050674686, 4.068364481218655, 1.0514740296190597, 95.16711955435294, 9.191757701188367, 37.76567248001433, 14.825311593687514, 37.10167887635909, 0.0, 21.940441921339275, 8.077253585460486, 17.583945957115073, 45.68593773336878, 2.0778442007491247, 4.295007440533326, 4.231922158873882, 14.19060569287283, 5.872896002462406, 22.39376318534011, 1.6654283818367548, 14.355769878592357, 14.604893655025919, 26.191167068448294, 33.021435546958436, 52.67492079849464, 30.855543495321793, 10.93350709274776, 21.909940187801116, 18.257307255019228, 10.767451236208462, 14.361608351296319]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.873032152850132, "mean_inference_ms": 3.7644339721442543, "mean_action_processing_ms": 1.894696651982116, "mean_env_wait_ms": 1.1746317503122485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006246089935302734, "StateBufferConnector_ms": 0.012685775756835938, "ViewRequirementAgentConnector_ms": 0.11713576316833496}, "num_episodes": 64, "episode_return_max": 187.19039360899654, "episode_return_min": 20.83739869006001, "episode_return_mean": 65.16512475528714, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 248.60551652791605, "num_env_steps_trained_throughput_per_sec": 248.60551652791605, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 32268.723, "restore_workers_time_ms": 0.023, "training_step_time_ms": 32268.13, "sample_time_ms": 1299.001, "learn_time_ms": 30942.923, "learn_throughput": 258.541, "synch_weights_time_ms": 21.548}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 37, "trial_id": "cd905_00000", "date": "2024-08-20_09-44-15", "timestamp": 1724127255, "time_this_iter_s": 32.22933101654053, "time_total_s": 1213.3233745098114, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f0da60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1213.3233745098114, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 42.375555555555565, "ram_util_percent": 81.84444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8304491034694135, "cur_kl_coeff": 5.1498413085937495e-06, "cur_lr": 0.0001, "total_loss": 2.869779769201127, "policy_loss": -0.0029305247822776436, "vf_loss": 2.872710294572134, "vf_explained_var": 0.08546719475397987, "kl": 0.006828719490679052, "entropy": 1.5770164936307878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3637443008876982, "cur_kl_coeff": 2.86102294921875e-07, "cur_lr": 0.0001, "total_loss": 0.994291752576828, "policy_loss": -0.0014554739619294802, "vf_loss": 0.9957472244898479, "vf_explained_var": 0.0005155310744330996, "kl": 0.0057151378467443425, "entropy": 1.26485982433198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 294.00000000000057, "episode_reward_min": 33.349572679722996, "episode_reward_mean": 94.46967788831205, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -128.68205191754086, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 167.0583104035046, "predator_policy": 171.55729138964077}, "policy_reward_mean": {"prey_policy": 18.31552269674097, "predator_policy": 28.91931624741522}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.24558899870032, 33.349572679722996, 63.00000000000037, 97.39999999999871, 83.3999999999991, 72.39999999999986, 45.500000000000405, 39.000000000000284, 33.4616815146728, 39.40000000000029, 65.90000000000035, 36.60000000000025, 36.98299447787689, 47.70000000000043, 103.2622534416242, 80.42056127936999, 71.22565524431053, 38.300000000000274, 45.200000000000344, 39.40000000000029, 93.29999999999858, 77.39999999999952, 38.60000000000028, 47.283174005135294, 80.94166600439249, 56.000000000000504, 38.00000000000027, 174.5999999999991, 67.50000000000017, 151.52223032320708, 39.40000000000029, 37.000000000000256, 129.0999999999995, 53.70000000000048, 144.59999999999908, 195.51819517083965, 149.33669759687584, 115.29999999999912, 172.5999999999992, 36.60000000000025, 155.24676477277526, 294.00000000000057, 132.19999999999908, 146.799999999999, 176.91064877512258, 174.59999999999934, 105.4999999999988, 149.6999999999996, 103.69999999999874, 49.26696116554387, 141.53408878812286, 53.89906968667718, 38.10000000000027, 57.400000000000304, 109.19999999999919, 45.00000000000039, 80.70000000000005, 102.6999999999993, 111.1007074040986, 142.89999999999912, 121.31447753316257, 44.20000000000038, 49.00000000000023, 54.30000000000026, 146.8279191650734, 41.00000000000032, 59.300000000000274, 36.40000000000025, 47.20000000000026, 129.59999999999877, 136.2999999999995, 137.45197995597147, 172.6999999999992, 166.79999999999905, 50.60000000000018, 37.600000000000264, 125.07885374894477, 120.68879438819724, 43.20000000000035, 35.00000000000023, 42.800000000000345, 139.9782068302095, 72.49999999999969, 64.94297935652321, 138.89999999999915, 169.2999999999994, 40.79597263253438, 94.79999999999882, 142.39999999999912, 172.49999999999898, 103.89999999999887, 164.4923807208369, 42.10000000000034, 184.59999999999903, 60.30000000000033, 43.30000000000036, 187.3999999999993, 151.99999999999906, 93.13608292807105, 202.35163024263113], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-28.589478009764754, 7.035552756737003, 7.5018807486852666, 6.803559247579642, 31.157078715656112, 18.652183078445077, 13.33257793292013, 54.927109263324816, 34.66762385747643, 4.571342533130911, 28.5312450710092, 5.400437311572482, 12.949180256422727, 12.357701692234901, 9.679791759413522, 12.212854372010643, 3.492115839816212, 5.516792298064283, 19.090583316619053, 13.249355044107602, 42.01696687070477, 10.097640672599747, -1.883529721551949, -21.059598978846566, 5.407327265502321, 11.0559535322701, 15.631635518781309, 26.948525970381073, -19.691149205649083, 18.59452539173282, 46.74947228421243, -18.9198950785431, 8.301336079479455, 25.822640288472183, -3.1404419213392436, 11.422746414539478, 1.3160540428849081, -19.385937733368536, 17.72215579925086, 15.304992559466639, 70.26807784112586, 4.609394307127136, 26.127103997537695, 23.00623681466006, 18.134571618163235, 4.444230121407612, 11.178280350108919, -4.691167068448234, -62.63151363374571, 57.87682329268533, -2.2555434953217803, 16.466492907252206, -3.309940187801074, 1.1426927449807633, 119.23254876379136, 30.238391648703875, -10.76878318687915, 26.81982107410792, 26.890124074696267, 72.95013312816253, 13.766686530205051, 18.10695874831289, -8.172837140368765, -1.79643880207504, -22.6259740668279, 47.93964337506233, 14.054607591570203, 4.054500768239373, -5.974343362954494, 76.69899274722397, -5.694212445070315, 99.56278032566992, -7.25812189819986, 104.34432472615583, -11.533267939339362, 82.50953922096514, 103.72587305016322, 50.43158672386221, 5.254786602537756, -8.905394562628528, 0.2940544484351451, 68.25726074493073, 167.0583104035046, 118.62758410186177, -3.315984110712139, 72.5284914886206, 34.74066416549326, 89.24066595539902, 69.89632220838328, 49.824080607577386, 88.45109125058552, 37.39573610675812, -22.739657775515944, 57.09335150528721, 79.35066699070398, 17.67057468750231, 9.853519921941286, 47.55937256056117, -0.3994202816774507, -4.689419990216834, 8.31235101469831, 43.019730140823164, -8.862324477240811, -24.90140348842945, -4.886813902499725, 3.536671381991352, 24.65003589834874, -49.00514098664278, 69.27369330197757, 38.90000000000012, 6.629685867732661, -35.61623285203747, -114.15729138964113, 9.950127559919796, 6.3487027614818805, 59.17379170101729, 37.368018010237186, 18.59386926336126, -26.619747107906825, 66.93675421119751, 26.037454285219628, -80.10128292751733, -37.7914586864099, -35.660639012624166, -48.31106919396347, 9.900366784009705, 14.15242931583231, 28.140830887987285, -112.66224433929469, -12.803561291174322, -2.9372914935688788, -6.117984879307771, -3.703477973151562, 10.00603779983729, -49.41124228320288, 13.286284485674777, 18.01217179925395, -15.091793741878032, 80.36390253365569, -5.92705929287456, -24.816320912320926, 89.14759764994008, 103.30979830088985, 6.659103479272817, -128.68205191754086, 131.37680367288812, 93.8478752651539, -25.419613815729093, -59.55100689233477, 17.59638642512229, -1.7496276576700063, -9.339683149262958, 35.10540409081454, -46.005752632087706, 10.162128724580691, 60.247437609701514, -89.64007540990944, 14.366030714611862, -38.80620078750305, -8.961385170374156, 10.241253950393192, -46.74406861374402, 50.1679084524809, 23.565802513695257, 40.56576441370564, -16.99865711914235, 38.518437005200234, -19.433567537449456, 9.669156896064916, 101.91395804254103, -41.892159377519846, 126.08092065121002, 16.330262769127188, 10.312683078548575, 43.97286630685326, -14.232705250970984, 11.368758483667504, 57.545158045862536, 13.034677179746108, 151.85780494479891, 62.17483923831004, 3.442779876691752, -63.7007995299137, 121.53657935615033, -9.733949009069756, 3.812535816309441, 98.72153192759731, 82.99999999999997, 16.01501922448963, 16.3506069484609, 19.401617298181502, 20.000000000000014, 53.81908056872594, -4.832327220473104, -16.368376805740915, 86.79856126109085, 30.84668997131783, -39.079126766654824, 107.02263870352397, 65.39484895031151], "policy_predator_policy_reward": [23.456719006535124, 37.34279524519288, 13.817448607171496, 5.226684076286317, 10.31056827498589, 2.8801699309130786, 6.067422067079836, 23.072890736675355, 18.93237614252373, 25.22865746686906, 0.0, 38.46831761741845, 13.050819743577234, 7.1422983077650635, 9.820208240586442, 7.287145627989322, 2.626125547535764, 21.826647829256267, 0.809416683380949, 6.250644955892363, 4.5830331292954645, 9.202359327400218, 20.883529721551977, 38.659598978846816, 2.685529629429459, 17.834184050674686, 4.068364481218655, 1.0514740296190597, 95.16711955435294, 9.191757701188367, 37.76567248001433, 14.825311593687514, 37.10167887635909, 0.0, 21.940441921339275, 8.077253585460486, 17.583945957115073, 45.68593773336878, 2.0778442007491247, 4.295007440533326, 4.231922158873882, 14.19060569287283, 5.872896002462406, 22.39376318534011, 1.6654283818367548, 14.355769878592357, 14.604893655025919, 26.191167068448294, 33.021435546958436, 52.67492079849464, 30.855543495321793, 10.93350709274776, 21.909940187801116, 18.257307255019228, 10.767451236208462, 14.361608351296319, 29.668783186879324, 21.78017892589213, 18.77807173336987, 32.90390138697943, 5.833313469794913, 1.6930412516870994, 26.272837140368882, 20.69643880207506, 40.32597406682815, 63.46035662493778, 20.745392408429765, 14.845499231760593, 31.5343932638037, 42.3409573519267, 3.760214705478225, 97.88941258476238, 46.158121898199916, 6.092372870720519, 34.475545747718925, 9.848182970655097, 3.243755165647247, 15.198785060327443, 13.445213397462211, 26.805394562628653, 75.5100365110779, 11.185413068331375, 2.141689596495376, 6.172415898137866, 50.81598411071212, 12.17150851137902, 3.8593358345068647, 18.95933404460051, 25.92743661315311, 31.262809346009732, 21.7489087494141, 27.004263893242005, 66.43965777551598, 4.706648494713, 50.54933300929608, 2.129425312497676, 14.246480078058676, 32.04062743943898, 18.199688582161034, 36.1561128552767, 52.62686467815297, 37.575142954449795, 57.505391439977856, 30.15740621236967, 23.786813902499794, 15.663328618008611, 56.75726785498946, 24.997837233304892, 1.0263066980226119, 0.0, 12.170314132267306, 61.816232852037714, 171.55729138964077, 13.349872440080173, 31.7143775050501, 5.463128032450953, 43.693185403510164, 11.445634726991536, 54.77481132018384, 47.80818157652557, 86.7338609351945, 88.64444524026652, 55.09145868641014, 62.56063901262441, 65.61106919396362, 21.799633215990333, 5.347570684167656, 6.65916911201284, 158.95935071501813, 113.33437408052471, 21.537291493568908, 28.517984879307857, 13.502010866829048, 39.49542930648536, 65.61124228320301, 6.913715514325185, 1.7878282007460415, 42.491793741878254, 18.53609746634375, 36.62705929287462, 61.11632091232112, 10.852402350059915, 11.909424845371163, 15.57365333043846, 168.18205191754038, 1.8231963271116018, 43.252124734845836, 55.11961381572933, 88.56938434196005, 3.985236125252027, 22.58533283163803, 26.103977975295084, 71.5281214663224, 64.45108082389616, 0.9256983408294792, 49.35352971308674, 113.34007540990855, 5.133969285388105, 55.306200787503286, 27.461385170374292, 14.958746049606777, 64.34406861374427, 23.512581125704223, 42.73191473832951, 14.357721053034984, 34.5751716524021, 6.420614080245921, 39.437495808526705, 19.93084310393506, 7.386041957458682, 58.692159377520085, 26.419079348789985, 8.833781640532088, 5.319245144326148, 32.3271336931469, 32.732705250971215, 53.03124151633253, 20.454841954137642, 6.365322820253857, 1.2421950552008014, 6.725160761690119, 31.557220123308344, 96.10079952991285, 10.555801364687088, 32.9339490090699, 15.087464183690525, 2.878468072402085, 0.0, 19.284980775510366, 8.64939305153906, 3.8983827018185075, 0.0, 12.388845052113165, 126.02440159963403, 35.46837680574117, 46.10143873890885, 48.74818188970436, 52.62033783370524, 20.51897973677894, 9.415162852017575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.860414641690398, "mean_inference_ms": 3.75367051491277, "mean_action_processing_ms": 1.8803824349041252, "mean_env_wait_ms": 1.1674991408572786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004501938819885254, "StateBufferConnector_ms": 0.012462258338928223, "ViewRequirementAgentConnector_ms": 0.11149048805236816}, "num_episodes": 72, "episode_return_max": 294.00000000000057, "episode_return_min": 33.349572679722996, "episode_return_mean": 94.46967788831205, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 246.90025300070192, "num_env_steps_trained_throughput_per_sec": 246.90025300070192, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 32288.127, "restore_workers_time_ms": 0.023, "training_step_time_ms": 32287.573, "sample_time_ms": 1303.819, "learn_time_ms": 30957.587, "learn_throughput": 258.418, "synch_weights_time_ms": 21.171}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 38, "trial_id": "cd905_00000", "date": "2024-08-20_09-44-47", "timestamp": 1724127287, "time_this_iter_s": 32.415762186050415, "time_total_s": 1245.7391366958618, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16affa160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1245.7391366958618, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 42.92826086956522, "ram_util_percent": 82.06086956521739}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.78967566433407, "cur_kl_coeff": 5.1498413085937495e-06, "cur_lr": 0.0001, "total_loss": 2.5268594476911757, "policy_loss": -0.004023116039082644, "vf_loss": 2.530882568207998, "vf_explained_var": 0.12273179661659968, "kl": 0.011824655299643194, "entropy": 1.5988735677703978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 24255.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.35698636320848315, "cur_kl_coeff": 2.86102294921875e-07, "cur_lr": 0.0001, "total_loss": 0.6202906982766258, "policy_loss": -0.002673863848700883, "vf_loss": 0.6229645616241863, "vf_explained_var": 0.006423953033628918, "kl": 0.0065219632867067525, "entropy": 1.2961291086106073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 24255.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 294.00000000000057, "episode_reward_min": 33.349572679722996, "episode_reward_mean": 94.46967788831205, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -128.68205191754086, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 167.0583104035046, "predator_policy": 171.55729138964077}, "policy_reward_mean": {"prey_policy": 18.31552269674097, "predator_policy": 28.91931624741522}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.24558899870032, 33.349572679722996, 63.00000000000037, 97.39999999999871, 83.3999999999991, 72.39999999999986, 45.500000000000405, 39.000000000000284, 33.4616815146728, 39.40000000000029, 65.90000000000035, 36.60000000000025, 36.98299447787689, 47.70000000000043, 103.2622534416242, 80.42056127936999, 71.22565524431053, 38.300000000000274, 45.200000000000344, 39.40000000000029, 93.29999999999858, 77.39999999999952, 38.60000000000028, 47.283174005135294, 80.94166600439249, 56.000000000000504, 38.00000000000027, 174.5999999999991, 67.50000000000017, 151.52223032320708, 39.40000000000029, 37.000000000000256, 129.0999999999995, 53.70000000000048, 144.59999999999908, 195.51819517083965, 149.33669759687584, 115.29999999999912, 172.5999999999992, 36.60000000000025, 155.24676477277526, 294.00000000000057, 132.19999999999908, 146.799999999999, 176.91064877512258, 174.59999999999934, 105.4999999999988, 149.6999999999996, 103.69999999999874, 49.26696116554387, 141.53408878812286, 53.89906968667718, 38.10000000000027, 57.400000000000304, 109.19999999999919, 45.00000000000039, 80.70000000000005, 102.6999999999993, 111.1007074040986, 142.89999999999912, 121.31447753316257, 44.20000000000038, 49.00000000000023, 54.30000000000026, 146.8279191650734, 41.00000000000032, 59.300000000000274, 36.40000000000025, 47.20000000000026, 129.59999999999877, 136.2999999999995, 137.45197995597147, 172.6999999999992, 166.79999999999905, 50.60000000000018, 37.600000000000264, 125.07885374894477, 120.68879438819724, 43.20000000000035, 35.00000000000023, 42.800000000000345, 139.9782068302095, 72.49999999999969, 64.94297935652321, 138.89999999999915, 169.2999999999994, 40.79597263253438, 94.79999999999882, 142.39999999999912, 172.49999999999898, 103.89999999999887, 164.4923807208369, 42.10000000000034, 184.59999999999903, 60.30000000000033, 43.30000000000036, 187.3999999999993, 151.99999999999906, 93.13608292807105, 202.35163024263113], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-28.589478009764754, 7.035552756737003, 7.5018807486852666, 6.803559247579642, 31.157078715656112, 18.652183078445077, 13.33257793292013, 54.927109263324816, 34.66762385747643, 4.571342533130911, 28.5312450710092, 5.400437311572482, 12.949180256422727, 12.357701692234901, 9.679791759413522, 12.212854372010643, 3.492115839816212, 5.516792298064283, 19.090583316619053, 13.249355044107602, 42.01696687070477, 10.097640672599747, -1.883529721551949, -21.059598978846566, 5.407327265502321, 11.0559535322701, 15.631635518781309, 26.948525970381073, -19.691149205649083, 18.59452539173282, 46.74947228421243, -18.9198950785431, 8.301336079479455, 25.822640288472183, -3.1404419213392436, 11.422746414539478, 1.3160540428849081, -19.385937733368536, 17.72215579925086, 15.304992559466639, 70.26807784112586, 4.609394307127136, 26.127103997537695, 23.00623681466006, 18.134571618163235, 4.444230121407612, 11.178280350108919, -4.691167068448234, -62.63151363374571, 57.87682329268533, -2.2555434953217803, 16.466492907252206, -3.309940187801074, 1.1426927449807633, 119.23254876379136, 30.238391648703875, -10.76878318687915, 26.81982107410792, 26.890124074696267, 72.95013312816253, 13.766686530205051, 18.10695874831289, -8.172837140368765, -1.79643880207504, -22.6259740668279, 47.93964337506233, 14.054607591570203, 4.054500768239373, -5.974343362954494, 76.69899274722397, -5.694212445070315, 99.56278032566992, -7.25812189819986, 104.34432472615583, -11.533267939339362, 82.50953922096514, 103.72587305016322, 50.43158672386221, 5.254786602537756, -8.905394562628528, 0.2940544484351451, 68.25726074493073, 167.0583104035046, 118.62758410186177, -3.315984110712139, 72.5284914886206, 34.74066416549326, 89.24066595539902, 69.89632220838328, 49.824080607577386, 88.45109125058552, 37.39573610675812, -22.739657775515944, 57.09335150528721, 79.35066699070398, 17.67057468750231, 9.853519921941286, 47.55937256056117, -0.3994202816774507, -4.689419990216834, 8.31235101469831, 43.019730140823164, -8.862324477240811, -24.90140348842945, -4.886813902499725, 3.536671381991352, 24.65003589834874, -49.00514098664278, 69.27369330197757, 38.90000000000012, 6.629685867732661, -35.61623285203747, -114.15729138964113, 9.950127559919796, 6.3487027614818805, 59.17379170101729, 37.368018010237186, 18.59386926336126, -26.619747107906825, 66.93675421119751, 26.037454285219628, -80.10128292751733, -37.7914586864099, -35.660639012624166, -48.31106919396347, 9.900366784009705, 14.15242931583231, 28.140830887987285, -112.66224433929469, -12.803561291174322, -2.9372914935688788, -6.117984879307771, -3.703477973151562, 10.00603779983729, -49.41124228320288, 13.286284485674777, 18.01217179925395, -15.091793741878032, 80.36390253365569, -5.92705929287456, -24.816320912320926, 89.14759764994008, 103.30979830088985, 6.659103479272817, -128.68205191754086, 131.37680367288812, 93.8478752651539, -25.419613815729093, -59.55100689233477, 17.59638642512229, -1.7496276576700063, -9.339683149262958, 35.10540409081454, -46.005752632087706, 10.162128724580691, 60.247437609701514, -89.64007540990944, 14.366030714611862, -38.80620078750305, -8.961385170374156, 10.241253950393192, -46.74406861374402, 50.1679084524809, 23.565802513695257, 40.56576441370564, -16.99865711914235, 38.518437005200234, -19.433567537449456, 9.669156896064916, 101.91395804254103, -41.892159377519846, 126.08092065121002, 16.330262769127188, 10.312683078548575, 43.97286630685326, -14.232705250970984, 11.368758483667504, 57.545158045862536, 13.034677179746108, 151.85780494479891, 62.17483923831004, 3.442779876691752, -63.7007995299137, 121.53657935615033, -9.733949009069756, 3.812535816309441, 98.72153192759731, 82.99999999999997, 16.01501922448963, 16.3506069484609, 19.401617298181502, 20.000000000000014, 53.81908056872594, -4.832327220473104, -16.368376805740915, 86.79856126109085, 30.84668997131783, -39.079126766654824, 107.02263870352397, 65.39484895031151], "policy_predator_policy_reward": [23.456719006535124, 37.34279524519288, 13.817448607171496, 5.226684076286317, 10.31056827498589, 2.8801699309130786, 6.067422067079836, 23.072890736675355, 18.93237614252373, 25.22865746686906, 0.0, 38.46831761741845, 13.050819743577234, 7.1422983077650635, 9.820208240586442, 7.287145627989322, 2.626125547535764, 21.826647829256267, 0.809416683380949, 6.250644955892363, 4.5830331292954645, 9.202359327400218, 20.883529721551977, 38.659598978846816, 2.685529629429459, 17.834184050674686, 4.068364481218655, 1.0514740296190597, 95.16711955435294, 9.191757701188367, 37.76567248001433, 14.825311593687514, 37.10167887635909, 0.0, 21.940441921339275, 8.077253585460486, 17.583945957115073, 45.68593773336878, 2.0778442007491247, 4.295007440533326, 4.231922158873882, 14.19060569287283, 5.872896002462406, 22.39376318534011, 1.6654283818367548, 14.355769878592357, 14.604893655025919, 26.191167068448294, 33.021435546958436, 52.67492079849464, 30.855543495321793, 10.93350709274776, 21.909940187801116, 18.257307255019228, 10.767451236208462, 14.361608351296319, 29.668783186879324, 21.78017892589213, 18.77807173336987, 32.90390138697943, 5.833313469794913, 1.6930412516870994, 26.272837140368882, 20.69643880207506, 40.32597406682815, 63.46035662493778, 20.745392408429765, 14.845499231760593, 31.5343932638037, 42.3409573519267, 3.760214705478225, 97.88941258476238, 46.158121898199916, 6.092372870720519, 34.475545747718925, 9.848182970655097, 3.243755165647247, 15.198785060327443, 13.445213397462211, 26.805394562628653, 75.5100365110779, 11.185413068331375, 2.141689596495376, 6.172415898137866, 50.81598411071212, 12.17150851137902, 3.8593358345068647, 18.95933404460051, 25.92743661315311, 31.262809346009732, 21.7489087494141, 27.004263893242005, 66.43965777551598, 4.706648494713, 50.54933300929608, 2.129425312497676, 14.246480078058676, 32.04062743943898, 18.199688582161034, 36.1561128552767, 52.62686467815297, 37.575142954449795, 57.505391439977856, 30.15740621236967, 23.786813902499794, 15.663328618008611, 56.75726785498946, 24.997837233304892, 1.0263066980226119, 0.0, 12.170314132267306, 61.816232852037714, 171.55729138964077, 13.349872440080173, 31.7143775050501, 5.463128032450953, 43.693185403510164, 11.445634726991536, 54.77481132018384, 47.80818157652557, 86.7338609351945, 88.64444524026652, 55.09145868641014, 62.56063901262441, 65.61106919396362, 21.799633215990333, 5.347570684167656, 6.65916911201284, 158.95935071501813, 113.33437408052471, 21.537291493568908, 28.517984879307857, 13.502010866829048, 39.49542930648536, 65.61124228320301, 6.913715514325185, 1.7878282007460415, 42.491793741878254, 18.53609746634375, 36.62705929287462, 61.11632091232112, 10.852402350059915, 11.909424845371163, 15.57365333043846, 168.18205191754038, 1.8231963271116018, 43.252124734845836, 55.11961381572933, 88.56938434196005, 3.985236125252027, 22.58533283163803, 26.103977975295084, 71.5281214663224, 64.45108082389616, 0.9256983408294792, 49.35352971308674, 113.34007540990855, 5.133969285388105, 55.306200787503286, 27.461385170374292, 14.958746049606777, 64.34406861374427, 23.512581125704223, 42.73191473832951, 14.357721053034984, 34.5751716524021, 6.420614080245921, 39.437495808526705, 19.93084310393506, 7.386041957458682, 58.692159377520085, 26.419079348789985, 8.833781640532088, 5.319245144326148, 32.3271336931469, 32.732705250971215, 53.03124151633253, 20.454841954137642, 6.365322820253857, 1.2421950552008014, 6.725160761690119, 31.557220123308344, 96.10079952991285, 10.555801364687088, 32.9339490090699, 15.087464183690525, 2.878468072402085, 0.0, 19.284980775510366, 8.64939305153906, 3.8983827018185075, 0.0, 12.388845052113165, 126.02440159963403, 35.46837680574117, 46.10143873890885, 48.74818188970436, 52.62033783370524, 20.51897973677894, 9.415162852017575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.860414641690398, "mean_inference_ms": 3.75367051491277, "mean_action_processing_ms": 1.8803824349041252, "mean_env_wait_ms": 1.1674991408572786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004501938819885254, "StateBufferConnector_ms": 0.012462258338928223, "ViewRequirementAgentConnector_ms": 0.11149048805236816}, "num_episodes": 0, "episode_return_max": 294.00000000000057, "episode_return_min": 33.349572679722996, "episode_return_mean": 94.46967788831205, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 252.6399609924224, "num_env_steps_trained_throughput_per_sec": 252.6399609924224, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 32169.421, "restore_workers_time_ms": 0.023, "training_step_time_ms": 32168.807, "sample_time_ms": 1248.215, "learn_time_ms": 30893.505, "learn_throughput": 258.954, "synch_weights_time_ms": 22.056}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 39, "trial_id": "cd905_00000", "date": "2024-08-20_09-45-19", "timestamp": 1724127319, "time_this_iter_s": 31.69510006904602, "time_total_s": 1277.4342367649078, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16affaee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1277.4342367649078, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 39.89555555555555, "ram_util_percent": 82.06444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.247409655248362, "cur_kl_coeff": 5.1498413085937495e-06, "cur_lr": 0.0001, "total_loss": 3.7726391073257206, "policy_loss": -0.0005589285994776421, "vf_loss": 3.7731980448677427, "vf_explained_var": 0.029323850548456584, "kl": 0.0005790603412922084, "entropy": 1.604757947770376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 24885.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.48407037928700447, "cur_kl_coeff": 2.86102294921875e-07, "cur_lr": 0.0001, "total_loss": 1.7676817778557066, "policy_loss": -0.002821309474991664, "vf_loss": 1.7705030884061541, "vf_explained_var": 0.008041973057247343, "kl": 0.009552793649785896, "entropy": 1.2872586102712722, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 24885.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 270.4761865529297, "episode_reward_min": 31.245501730193183, "episode_reward_mean": 92.71315397775923, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -128.68205191754086, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 151.85780494479891, "predator_policy": 168.18205191754038}, "policy_reward_mean": {"prey_policy": 17.208633247752253, "predator_policy": 29.14794374112749}, "custom_metrics": {}, "hist_stats": {"episode_reward": [172.6999999999992, 166.79999999999905, 50.60000000000018, 37.600000000000264, 125.07885374894477, 120.68879438819724, 43.20000000000035, 35.00000000000023, 42.800000000000345, 139.9782068302095, 72.49999999999969, 64.94297935652321, 138.89999999999915, 169.2999999999994, 40.79597263253438, 94.79999999999882, 142.39999999999912, 172.49999999999898, 103.89999999999887, 164.4923807208369, 42.10000000000034, 184.59999999999903, 60.30000000000033, 43.30000000000036, 187.3999999999993, 151.99999999999906, 93.13608292807105, 202.35163024263113, 67.00000000000014, 166.39472459320496, 183.29999999999916, 64.70000000000029, 65.90000000000023, 184.79999999999896, 50.80000000000049, 111.59999999999876, 96.89999999999853, 93.39999999999877, 51.80000000000026, 110.3999999999988, 173.06866382557422, 47.46187925305358, 79.39999999999947, 270.4761865529297, 42.933268669409586, 134.00927220033566, 68.1082495229697, 140.79999999999902, 173.39999999999912, 61.90000000000029, 72.99999999999973, 37.30000000000026, 53.10000000000037, 38.20000000000029, 102.19999999999928, 36.18798047473978, 109.99999999999915, 140.99999999999955, 49.71727729370293, 58.50000000000026, 53.800000000000466, 76.80000000000034, 115.39999999999864, 77.89999999999945, 69.80000000000015, 116.8999999999987, 110.0999999999992, 39.800000000000296, 75.99999999999956, 140.19999999999888, 40.80000000000032, 67.7000000000001, 50.100000000000435, 61.20000000000023, 52.50000000000025, 109.51594559756097, 44.873260913598756, 57.153948345695234, 71.99999999999986, 61.60000000000041, 56.60000000000045, 104.79999999999944, 55.800000000000296, 122.24100630920698, 146.39999999999995, 60.86725087408976, 39.5000000000003, 85.22627453077428, 31.245501730193183, 193.39999999999895, 63.71469745509225, 81.29081254398697, 69.6642962418768, 39.50000000000029, 51.8000000000005, 64.50000000000017, 88.39999999999907, 53.80000000000038, 70.09999999999978, 96.39999999999837], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-128.68205191754086, 131.37680367288812, 93.8478752651539, -25.419613815729093, -59.55100689233477, 17.59638642512229, -1.7496276576700063, -9.339683149262958, 35.10540409081454, -46.005752632087706, 10.162128724580691, 60.247437609701514, -89.64007540990944, 14.366030714611862, -38.80620078750305, -8.961385170374156, 10.241253950393192, -46.74406861374402, 50.1679084524809, 23.565802513695257, 40.56576441370564, -16.99865711914235, 38.518437005200234, -19.433567537449456, 9.669156896064916, 101.91395804254103, -41.892159377519846, 126.08092065121002, 16.330262769127188, 10.312683078548575, 43.97286630685326, -14.232705250970984, 11.368758483667504, 57.545158045862536, 13.034677179746108, 151.85780494479891, 62.17483923831004, 3.442779876691752, -63.7007995299137, 121.53657935615033, -9.733949009069756, 3.812535816309441, 98.72153192759731, 82.99999999999997, 16.01501922448963, 16.3506069484609, 19.401617298181502, 20.000000000000014, 53.81908056872594, -4.832327220473104, -16.368376805740915, 86.79856126109085, 30.84668997131783, -39.079126766654824, 107.02263870352397, 65.39484895031151, 24.518236827223316, 6.0470801002966414, 97.76949276048572, 18.15268203678634, 45.11410121298897, 101.14035712188047, -85.81666495996959, 10.375224228570323, 3.08869163192169, 11.224784692160888, 62.47918728326673, 49.884973372673585, 11.268959649374175, 7.045308845060848, 64.61145477794463, -9.841184064571017, 22.700000000000063, 61.78355063150098, 9.352209595805386, 23.47673587718983, 24.02908138222599, -20.435742280089357, 9.344962343883621, 80.341159440562, 8.312725524546217, 79.39123652689203, -28.733932354524526, -2.2067677016915423, 54.82927455145194, 13.49578739490806, 88.06579349444479, 99.61989051567635, -44.54702268511802, -33.024878976783675, 47.16474394930841, -4.415525133588211, -35.084714665915236, -26.864740297069993, 51.054342796466194, 31.44235106621997, 132.74206122796033, 14.781544927048495, -4.339306674833859, 42.44108768061047, 12.215117265793255, 22.186690689736164, 10.751625291782133, -27.83251531009072, 22.65474073703657, 17.855304415305216, 13.341667321867082, -62.51490425542679, -3.69098665815066, 30.461546032665066, -46.58166372493459, -23.75466356142143, -6.887962898392061, -10.696297969116506, 80.40362274124041, 2.2822844552089334, -62.72932638014958, 16.186705566345395, 15.54115713619213, 38.9, 13.983660470422725, 1.2289788927393934, 0.9871986932139556, 24.549597968244598, 93.76466003297452, -56.204820145510155, 58.00883387086034, -19.27865563540822, 28.941601776276677, 12.282927552457126, 21.813480092745095, 67.60682735796229, 40.24005750565152, -26.0438702650874, 10.930752546063072, 17.210939304949065, 20.65886008028312, 20.000000000000014, -46.83050630722943, 96.87316421115557, 7.487899713262577, 13.314426993489205, 6.520394310094337, 22.27846002663141, -4.619173037691468, -1.6887439507258044, 13.97468196127862, 4.774768902625741, -5.7069616553645925, 27.851388039887077, 12.195787081038972, 2.6233148703908893, -24.469484739453087, -6.226893247969187, 11.337090428472923, -9.477892620303177, 10.130025017718015, 14.798038322767734, -0.8161139833294213, 18.06333063337954, 17.2090669740218, 13.604683930578767, 58.59689191225231, 33.85219950430566, 17.096745584874558, 15.28745223202274, -11.312160040339425, 22.700000000000053, 89.53133282418082, 6.594074114319905, 2.9081496517945795, -11.972888688737706, 2.970473488794076, 17.985840912515467, 33.56216727934656, -9.205312596356215, -1.6695899665939002, -0.7465941940013873, 19.426964767803504, 90.82304732880205, 0.9884900563222085, 17.93369324688826, 20.52154826024189, -6.32482138305957, 4.72405580071478, 44.402843449960315, 16.933741893685333, 17.589496448667816, -11.73327099388779, 23.903417320365556, -62.95211340245998, 26.35761372424089, 35.68796401869568, -33.87873392952691, 1.632557717594555, 23.00854704072966, -0.10304817646421288, 17.752833851214554, 31.295967639086637, 48.79088259538393], "policy_predator_policy_reward": [168.18205191754038, 1.8231963271116018, 43.252124734845836, 55.11961381572933, 88.56938434196005, 3.985236125252027, 22.58533283163803, 26.103977975295084, 71.5281214663224, 64.45108082389616, 0.9256983408294792, 49.35352971308674, 113.34007540990855, 5.133969285388105, 55.306200787503286, 27.461385170374292, 14.958746049606777, 64.34406861374427, 23.512581125704223, 42.73191473832951, 14.357721053034984, 34.5751716524021, 6.420614080245921, 39.437495808526705, 19.93084310393506, 7.386041957458682, 58.692159377520085, 26.419079348789985, 8.833781640532088, 5.319245144326148, 32.3271336931469, 32.732705250971215, 53.03124151633253, 20.454841954137642, 6.365322820253857, 1.2421950552008014, 6.725160761690119, 31.557220123308344, 96.10079952991285, 10.555801364687088, 32.9339490090699, 15.087464183690525, 2.878468072402085, 0.0, 19.284980775510366, 8.64939305153906, 3.8983827018185075, 0.0, 12.388845052113165, 126.02440159963403, 35.46837680574117, 46.10143873890885, 48.74818188970436, 52.62033783370524, 20.51897973677894, 9.415162852017575, 23.381763172776843, 13.052919899703324, 19.385277854522734, 31.087271941410993, 28.9858987870112, 8.059642878119032, 48.96768054762052, 91.17376018377804, 36.92045584808209, 14.66606782783534, 32.620812716733404, 39.81502662732655, 12.231040350625793, 20.25469115493912, 28.588545222055465, 28.24118406457117, 0.0, 12.416449368499206, 35.34191830682444, 25.2291362201804, 8.670918617773983, 39.5357422800896, 10.055037656116344, 10.658840559437618, 23.102569087706843, 62.26213268642983, 35.035862891487604, 43.36671641778187, 5.170725448548131, 5.904212605091907, 28.22267067155179, 54.56783187125678, 63.37838767020104, 57.12678266111053, 19.368839138198396, 71.89121424641779, 119.03036816409394, 11.027336321861256, 18.445657203533898, 39.85764893378016, 20.957938772039462, 4.9184550729514696, 22.939306674833915, 0.8589123193895349, 6.984882734206711, 31.61330931026394, 8.448374708217832, 45.93251531009098, 5.048124463583647, 7.541830384074568, 49.396797392458126, 37.97643954110077, 62.38674170331718, 13.04269892216865, 36.6897435326703, 69.83456422842573, 72.04454276354309, 55.53971810396562, 41.696377258759604, 16.617715544791036, 23.351217434363154, 72.90868067314256, 4.058842863807834, 0.0, 21.316339529577256, 17.27102110726058, 2.5657857568112865, 48.69741758173009, 4.235339967024864, 73.60482014550972, 3.09116612913986, 36.07865563540846, 21.45839822372337, 7.117072447542842, 14.086519907254948, 13.393172642037605, 27.086397455890978, 68.81741530354519, 9.069247453936894, 2.5890606950509127, 32.07184251143657, 3.269297408280358, 76.93050630722921, 13.226835788843905, 10.560848628316393, 9.43682466493176, 35.1796056899057, 3.7215399733686367, 25.319173037691566, 31.088743950725792, 5.725318038721344, 36.725231097374476, 24.306961655364674, 6.048611960112916, 48.87780057084263, 45.81904307528889, 48.531343848613105, 27.038295052407904, 50.77761234151065, 4.51713819601458, 45.209619642935095, 1.8623170165790988, 42.61611398332941, 1.7366693666204496, 19.275725681733533, 6.51052341366584, 8.603108087747895, 3.747800495694322, 16.503254415125397, 6.912547767977219, 56.67139078793485, 54.181775561611914, 15.568667175819215, 34.70592588568032, 32.59931061192473, 37.3326792991078, 15.829526511205886, 2.714159087484522, 8.068311390020144, 52.801108457765096, 26.499245780942527, 7.162440109845806, 34.173035232196504, 48.976952671197836, 27.985751917738583, 16.806762234142678, 5.281640192630357, 61.81244547417532, 20.537396991201394, 0.0, 2.766258106314642, 2.2105035513321685, 30.633270993887983, 8.996582679634521, 80.95211340245903, 20.14238627575925, 35.912035981304456, 50.67873392952714, 20.197271204214125, 8.961624037461704, 50.40304817646434, 2.0471661487854336, 4.5373612640113645, 11.775788501518504]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.900764057222611, "mean_inference_ms": 3.7850485476330955, "mean_action_processing_ms": 1.8899732639172047, "mean_env_wait_ms": 1.1698768836899216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003361940383911133, "StateBufferConnector_ms": 0.013189435005187988, "ViewRequirementAgentConnector_ms": 0.11198318004608154}, "num_episodes": 72, "episode_return_max": 270.4761865529297, "episode_return_min": 31.245501730193183, "episode_return_mean": 92.71315397775923, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 243.5078142983997, "num_env_steps_trained_throughput_per_sec": 243.5078142983997, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 32282.353, "restore_workers_time_ms": 0.028, "training_step_time_ms": 32281.724, "sample_time_ms": 1351.518, "learn_time_ms": 30903.312, "learn_throughput": 258.872, "synch_weights_time_ms": 21.828}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 40, "trial_id": "cd905_00000", "date": "2024-08-20_09-45-52", "timestamp": 1724127352, "time_this_iter_s": 32.900755882263184, "time_total_s": 1310.334992647171, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f75dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1310.334992647171, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 38.47234042553192, "ram_util_percent": 82.57446808510639}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2711981466601765, "cur_kl_coeff": 2.5749206542968747e-06, "cur_lr": 0.0001, "total_loss": 5.580685751021854, "policy_loss": -0.0021843439766338893, "vf_loss": 5.58287009663052, "vf_explained_var": 0.05430174687552074, "kl": 0.009545832544093476, "entropy": 1.5934196786274986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4728766085018241, "cur_kl_coeff": 2.86102294921875e-07, "cur_lr": 0.0001, "total_loss": 1.2154329102190713, "policy_loss": -0.001429668011971646, "vf_loss": 1.2168625845795586, "vf_explained_var": 0.002317642503314548, "kl": 0.004002596149071213, "entropy": 1.3214207967122396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 270.4761865529297, "episode_reward_min": 31.245501730193183, "episode_reward_mean": 92.71315397775923, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -128.68205191754086, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 151.85780494479891, "predator_policy": 168.18205191754038}, "policy_reward_mean": {"prey_policy": 17.208633247752253, "predator_policy": 29.14794374112749}, "custom_metrics": {}, "hist_stats": {"episode_reward": [172.6999999999992, 166.79999999999905, 50.60000000000018, 37.600000000000264, 125.07885374894477, 120.68879438819724, 43.20000000000035, 35.00000000000023, 42.800000000000345, 139.9782068302095, 72.49999999999969, 64.94297935652321, 138.89999999999915, 169.2999999999994, 40.79597263253438, 94.79999999999882, 142.39999999999912, 172.49999999999898, 103.89999999999887, 164.4923807208369, 42.10000000000034, 184.59999999999903, 60.30000000000033, 43.30000000000036, 187.3999999999993, 151.99999999999906, 93.13608292807105, 202.35163024263113, 67.00000000000014, 166.39472459320496, 183.29999999999916, 64.70000000000029, 65.90000000000023, 184.79999999999896, 50.80000000000049, 111.59999999999876, 96.89999999999853, 93.39999999999877, 51.80000000000026, 110.3999999999988, 173.06866382557422, 47.46187925305358, 79.39999999999947, 270.4761865529297, 42.933268669409586, 134.00927220033566, 68.1082495229697, 140.79999999999902, 173.39999999999912, 61.90000000000029, 72.99999999999973, 37.30000000000026, 53.10000000000037, 38.20000000000029, 102.19999999999928, 36.18798047473978, 109.99999999999915, 140.99999999999955, 49.71727729370293, 58.50000000000026, 53.800000000000466, 76.80000000000034, 115.39999999999864, 77.89999999999945, 69.80000000000015, 116.8999999999987, 110.0999999999992, 39.800000000000296, 75.99999999999956, 140.19999999999888, 40.80000000000032, 67.7000000000001, 50.100000000000435, 61.20000000000023, 52.50000000000025, 109.51594559756097, 44.873260913598756, 57.153948345695234, 71.99999999999986, 61.60000000000041, 56.60000000000045, 104.79999999999944, 55.800000000000296, 122.24100630920698, 146.39999999999995, 60.86725087408976, 39.5000000000003, 85.22627453077428, 31.245501730193183, 193.39999999999895, 63.71469745509225, 81.29081254398697, 69.6642962418768, 39.50000000000029, 51.8000000000005, 64.50000000000017, 88.39999999999907, 53.80000000000038, 70.09999999999978, 96.39999999999837], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-128.68205191754086, 131.37680367288812, 93.8478752651539, -25.419613815729093, -59.55100689233477, 17.59638642512229, -1.7496276576700063, -9.339683149262958, 35.10540409081454, -46.005752632087706, 10.162128724580691, 60.247437609701514, -89.64007540990944, 14.366030714611862, -38.80620078750305, -8.961385170374156, 10.241253950393192, -46.74406861374402, 50.1679084524809, 23.565802513695257, 40.56576441370564, -16.99865711914235, 38.518437005200234, -19.433567537449456, 9.669156896064916, 101.91395804254103, -41.892159377519846, 126.08092065121002, 16.330262769127188, 10.312683078548575, 43.97286630685326, -14.232705250970984, 11.368758483667504, 57.545158045862536, 13.034677179746108, 151.85780494479891, 62.17483923831004, 3.442779876691752, -63.7007995299137, 121.53657935615033, -9.733949009069756, 3.812535816309441, 98.72153192759731, 82.99999999999997, 16.01501922448963, 16.3506069484609, 19.401617298181502, 20.000000000000014, 53.81908056872594, -4.832327220473104, -16.368376805740915, 86.79856126109085, 30.84668997131783, -39.079126766654824, 107.02263870352397, 65.39484895031151, 24.518236827223316, 6.0470801002966414, 97.76949276048572, 18.15268203678634, 45.11410121298897, 101.14035712188047, -85.81666495996959, 10.375224228570323, 3.08869163192169, 11.224784692160888, 62.47918728326673, 49.884973372673585, 11.268959649374175, 7.045308845060848, 64.61145477794463, -9.841184064571017, 22.700000000000063, 61.78355063150098, 9.352209595805386, 23.47673587718983, 24.02908138222599, -20.435742280089357, 9.344962343883621, 80.341159440562, 8.312725524546217, 79.39123652689203, -28.733932354524526, -2.2067677016915423, 54.82927455145194, 13.49578739490806, 88.06579349444479, 99.61989051567635, -44.54702268511802, -33.024878976783675, 47.16474394930841, -4.415525133588211, -35.084714665915236, -26.864740297069993, 51.054342796466194, 31.44235106621997, 132.74206122796033, 14.781544927048495, -4.339306674833859, 42.44108768061047, 12.215117265793255, 22.186690689736164, 10.751625291782133, -27.83251531009072, 22.65474073703657, 17.855304415305216, 13.341667321867082, -62.51490425542679, -3.69098665815066, 30.461546032665066, -46.58166372493459, -23.75466356142143, -6.887962898392061, -10.696297969116506, 80.40362274124041, 2.2822844552089334, -62.72932638014958, 16.186705566345395, 15.54115713619213, 38.9, 13.983660470422725, 1.2289788927393934, 0.9871986932139556, 24.549597968244598, 93.76466003297452, -56.204820145510155, 58.00883387086034, -19.27865563540822, 28.941601776276677, 12.282927552457126, 21.813480092745095, 67.60682735796229, 40.24005750565152, -26.0438702650874, 10.930752546063072, 17.210939304949065, 20.65886008028312, 20.000000000000014, -46.83050630722943, 96.87316421115557, 7.487899713262577, 13.314426993489205, 6.520394310094337, 22.27846002663141, -4.619173037691468, -1.6887439507258044, 13.97468196127862, 4.774768902625741, -5.7069616553645925, 27.851388039887077, 12.195787081038972, 2.6233148703908893, -24.469484739453087, -6.226893247969187, 11.337090428472923, -9.477892620303177, 10.130025017718015, 14.798038322767734, -0.8161139833294213, 18.06333063337954, 17.2090669740218, 13.604683930578767, 58.59689191225231, 33.85219950430566, 17.096745584874558, 15.28745223202274, -11.312160040339425, 22.700000000000053, 89.53133282418082, 6.594074114319905, 2.9081496517945795, -11.972888688737706, 2.970473488794076, 17.985840912515467, 33.56216727934656, -9.205312596356215, -1.6695899665939002, -0.7465941940013873, 19.426964767803504, 90.82304732880205, 0.9884900563222085, 17.93369324688826, 20.52154826024189, -6.32482138305957, 4.72405580071478, 44.402843449960315, 16.933741893685333, 17.589496448667816, -11.73327099388779, 23.903417320365556, -62.95211340245998, 26.35761372424089, 35.68796401869568, -33.87873392952691, 1.632557717594555, 23.00854704072966, -0.10304817646421288, 17.752833851214554, 31.295967639086637, 48.79088259538393], "policy_predator_policy_reward": [168.18205191754038, 1.8231963271116018, 43.252124734845836, 55.11961381572933, 88.56938434196005, 3.985236125252027, 22.58533283163803, 26.103977975295084, 71.5281214663224, 64.45108082389616, 0.9256983408294792, 49.35352971308674, 113.34007540990855, 5.133969285388105, 55.306200787503286, 27.461385170374292, 14.958746049606777, 64.34406861374427, 23.512581125704223, 42.73191473832951, 14.357721053034984, 34.5751716524021, 6.420614080245921, 39.437495808526705, 19.93084310393506, 7.386041957458682, 58.692159377520085, 26.419079348789985, 8.833781640532088, 5.319245144326148, 32.3271336931469, 32.732705250971215, 53.03124151633253, 20.454841954137642, 6.365322820253857, 1.2421950552008014, 6.725160761690119, 31.557220123308344, 96.10079952991285, 10.555801364687088, 32.9339490090699, 15.087464183690525, 2.878468072402085, 0.0, 19.284980775510366, 8.64939305153906, 3.8983827018185075, 0.0, 12.388845052113165, 126.02440159963403, 35.46837680574117, 46.10143873890885, 48.74818188970436, 52.62033783370524, 20.51897973677894, 9.415162852017575, 23.381763172776843, 13.052919899703324, 19.385277854522734, 31.087271941410993, 28.9858987870112, 8.059642878119032, 48.96768054762052, 91.17376018377804, 36.92045584808209, 14.66606782783534, 32.620812716733404, 39.81502662732655, 12.231040350625793, 20.25469115493912, 28.588545222055465, 28.24118406457117, 0.0, 12.416449368499206, 35.34191830682444, 25.2291362201804, 8.670918617773983, 39.5357422800896, 10.055037656116344, 10.658840559437618, 23.102569087706843, 62.26213268642983, 35.035862891487604, 43.36671641778187, 5.170725448548131, 5.904212605091907, 28.22267067155179, 54.56783187125678, 63.37838767020104, 57.12678266111053, 19.368839138198396, 71.89121424641779, 119.03036816409394, 11.027336321861256, 18.445657203533898, 39.85764893378016, 20.957938772039462, 4.9184550729514696, 22.939306674833915, 0.8589123193895349, 6.984882734206711, 31.61330931026394, 8.448374708217832, 45.93251531009098, 5.048124463583647, 7.541830384074568, 49.396797392458126, 37.97643954110077, 62.38674170331718, 13.04269892216865, 36.6897435326703, 69.83456422842573, 72.04454276354309, 55.53971810396562, 41.696377258759604, 16.617715544791036, 23.351217434363154, 72.90868067314256, 4.058842863807834, 0.0, 21.316339529577256, 17.27102110726058, 2.5657857568112865, 48.69741758173009, 4.235339967024864, 73.60482014550972, 3.09116612913986, 36.07865563540846, 21.45839822372337, 7.117072447542842, 14.086519907254948, 13.393172642037605, 27.086397455890978, 68.81741530354519, 9.069247453936894, 2.5890606950509127, 32.07184251143657, 3.269297408280358, 76.93050630722921, 13.226835788843905, 10.560848628316393, 9.43682466493176, 35.1796056899057, 3.7215399733686367, 25.319173037691566, 31.088743950725792, 5.725318038721344, 36.725231097374476, 24.306961655364674, 6.048611960112916, 48.87780057084263, 45.81904307528889, 48.531343848613105, 27.038295052407904, 50.77761234151065, 4.51713819601458, 45.209619642935095, 1.8623170165790988, 42.61611398332941, 1.7366693666204496, 19.275725681733533, 6.51052341366584, 8.603108087747895, 3.747800495694322, 16.503254415125397, 6.912547767977219, 56.67139078793485, 54.181775561611914, 15.568667175819215, 34.70592588568032, 32.59931061192473, 37.3326792991078, 15.829526511205886, 2.714159087484522, 8.068311390020144, 52.801108457765096, 26.499245780942527, 7.162440109845806, 34.173035232196504, 48.976952671197836, 27.985751917738583, 16.806762234142678, 5.281640192630357, 61.81244547417532, 20.537396991201394, 0.0, 2.766258106314642, 2.2105035513321685, 30.633270993887983, 8.996582679634521, 80.95211340245903, 20.14238627575925, 35.912035981304456, 50.67873392952714, 20.197271204214125, 8.961624037461704, 50.40304817646434, 2.0471661487854336, 4.5373612640113645, 11.775788501518504]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.900764057222611, "mean_inference_ms": 3.7850485476330955, "mean_action_processing_ms": 1.8899732639172047, "mean_env_wait_ms": 1.1698768836899216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003361940383911133, "StateBufferConnector_ms": 0.013189435005187988, "ViewRequirementAgentConnector_ms": 0.11198318004608154}, "num_episodes": 0, "episode_return_max": 270.4761865529297, "episode_return_min": 31.245501730193183, "episode_return_mean": 92.71315397775923, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 246.98468950182988, "num_env_steps_trained_throughput_per_sec": 246.98468950182988, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 32277.004, "restore_workers_time_ms": 0.028, "training_step_time_ms": 32276.368, "sample_time_ms": 1350.966, "learn_time_ms": 30898.483, "learn_throughput": 258.912, "synch_weights_time_ms": 21.795}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 41, "trial_id": "cd905_00000", "date": "2024-08-20_09-46-25", "timestamp": 1724127385, "time_this_iter_s": 32.44189095497131, "time_total_s": 1342.7768836021423, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f6bca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1342.7768836021423, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 34.515555555555565, "ram_util_percent": 82.0777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.406669494131255, "cur_kl_coeff": 2.5749206542968747e-06, "cur_lr": 0.0001, "total_loss": 5.397341977982294, "policy_loss": -0.003992795011413003, "vf_loss": 5.401334771655855, "vf_explained_var": 0.046768737406957715, "kl": 0.018894925175040305, "entropy": 1.5301339423845686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 26145.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6683540643148479, "cur_kl_coeff": 1.430511474609375e-07, "cur_lr": 0.0001, "total_loss": 2.6433939880794948, "policy_loss": -0.0022012744616303178, "vf_loss": 2.6455952723821006, "vf_explained_var": 0.005255860090255737, "kl": 0.010471196890136439, "entropy": 1.2474314859935216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 26145.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 255.69999999999976, "episode_reward_min": 15.119092496972199, "episode_reward_mean": 115.33558257475246, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -259.6090209328039, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.10812899563092, "predator_policy": 299.0090209328042}, "policy_reward_mean": {"prey_policy": 13.855160686007174, "predator_policy": 43.812630601369186}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.100000000000435, 61.20000000000023, 52.50000000000025, 109.51594559756097, 44.873260913598756, 57.153948345695234, 71.99999999999986, 61.60000000000041, 56.60000000000045, 104.79999999999944, 55.800000000000296, 122.24100630920698, 146.39999999999995, 60.86725087408976, 39.5000000000003, 85.22627453077428, 31.245501730193183, 193.39999999999895, 63.71469745509225, 81.29081254398697, 69.6642962418768, 39.50000000000029, 51.8000000000005, 64.50000000000017, 88.39999999999907, 53.80000000000038, 70.09999999999978, 96.39999999999837, 193.95368080497528, 98.23996749581933, 153.59999999999917, 196.89999999999924, 190.3999999999993, 124.99999999999994, 91.41947537448874, 113.40000000000003, 69.24024542601182, 116.49999999999949, 100.49999999999972, 176.59999999999934, 106.30000000000015, 162.59152686786874, 38.20000000000027, 149.99999999999912, 68.71509324514157, 210.39999999999975, 173.19999999999897, 45.5000000000004, 96.89999999999995, 251.15723565846042, 55.50000000000024, 167.40094793686694, 164.8999999999997, 152.69999999999922, 115.52040677263076, 167.76297637888908, 243.65049414051327, 69.53862889635406, 174.69999999999982, 155.24375262563782, 124.99999999999915, 63.92299253176351, 132.268972542991, 61.267008350437855, 123.39999999999905, 109.79386995328198, 85.2, 255.69999999999976, 247.56717311988575, 21.435365394264117, 156.99999999999946, 50.30000000000029, 48.02952342856933, 103.59999999999872, 246.49999999999966, 174.3999999999994, 136.60000000000002, 114.7999999999998, 170.91692567356446, 173.49999999999895, 15.119092496972199, 190.89999999999964, 119.89999999999951, 211.99999999999997, 158.69999999999985, 38.10000000000026, 53.85002056928248, 61.300000000000296, 110.49806171028337, 92.49999999999999, 30.457185194759525, 119.97412119063463, 57.40000000000041, 173.19999999999933, 175.89653672620742, 207.19999999999916, 187.9999999999993, 151.92073366853958, 187.81324875809065, 107.8], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.619173037691468, -1.6887439507258044, 13.97468196127862, 4.774768902625741, -5.7069616553645925, 27.851388039887077, 12.195787081038972, 2.6233148703908893, -24.469484739453087, -6.226893247969187, 11.337090428472923, -9.477892620303177, 10.130025017718015, 14.798038322767734, -0.8161139833294213, 18.06333063337954, 17.2090669740218, 13.604683930578767, 58.59689191225231, 33.85219950430566, 17.096745584874558, 15.28745223202274, -11.312160040339425, 22.700000000000053, 89.53133282418082, 6.594074114319905, 2.9081496517945795, -11.972888688737706, 2.970473488794076, 17.985840912515467, 33.56216727934656, -9.205312596356215, -1.6695899665939002, -0.7465941940013873, 19.426964767803504, 90.82304732880205, 0.9884900563222085, 17.93369324688826, 20.52154826024189, -6.32482138305957, 4.72405580071478, 44.402843449960315, 16.933741893685333, 17.589496448667816, -11.73327099388779, 23.903417320365556, -62.95211340245998, 26.35761372424089, 35.68796401869568, -33.87873392952691, 1.632557717594555, 23.00854704072966, -0.10304817646421288, 17.752833851214554, 31.295967639086637, 48.79088259538393, -2.050560465715245, 140.67363161768642, -18.25816377354463, 68.77789525643195, -26.08174047548752, 103.35530597436761, 72.3481500214232, 70.07027015746792, 155.10812899563092, 15.963965736963262, -7.1340723145647456, 54.98232107622095, 60.355310368821755, -41.72924292399597, -2.5587794121903946, 79.47423825372766, -2.9605388922251135, 12.528238867219354, -9.338367321518298, 66.02201793113049, 23.436364638630643, -183.67437068666933, 118.92997768033422, -51.68897279290429, 12.603538922821485, 46.3907715434027, 9.913380951919557, 87.65275982427653, -35.710754350931396, 20.90000000000003, 112.9016018639853, -25.772851289662057, -9.024834687510992, 35.30000000000012, 130.10139961742635, 47.55639792273844, 42.98650576995515, 83.11283269206217, 2.042991211192012, -31.575735161155315, -8.914385121263605, 38.364538320299864, 101.98735185482104, 134.98430064009557, -0.1653565429577558, -161.6205079766132, -83.39308544359346, 58.24305940977555, -115.2976127369258, 90.79517832658837, 65.59878421299557, 19.84809085883523, 29.686888244139872, -89.70511765027072, 16.91210815175925, -98.72914552742142, 109.1220592414719, 53.21006564195877, -67.48084052461216, 1.2494738970946069, 108.38985428031584, 17.856320194792282, 31.747669431794712, 7.2834780595246364, -2.381102532034452, 66.38439701138888, -25.035743628023823, -179.66001369962913, -48.788696113012385, 96.20014400777083, 29.689684098794153, 7.27792491676283, -20.859979457677852, 96.23074110515084, -36.41042939685885, 33.482994470806425, 10.069294967284748, 8.665515093919149, 109.79938420641317, 16.292886006764416, -47.37743518139536, 67.50392051400868, -4.963890234959569, -43.47042831947347, 122.03634722782836, 17.09233005102023, 21.6221215416359, 10.565429173516847, -61.802866743097226, -3.3779583813626943, 9.075311020145962, 55.83668587888838, 135.77885284632407, 65.53163585870476, 21.422361041903862, 42.71058851910052, 65.26508534154048, 20.70288572766723, -18.97949212801894, 39.72389513006999, 42.47569688429211, 73.5457833077977, -3.1809207496676115, 84.26824739900513, -27.142724784157387, -54.36688873158399, 72.70086452688821, -1.773308353100691, -19.435140142738987, -0.04189774851603825, 66.05629907469647, 55.08794742091993, 57.55023249819372, 21.594167575003937, 9.438513228066471, -231.2168705450911, -52.504482160959476, -22.66530617664185, 32.815995398616614, -150.7105710856186, -38.75897235454745, 8.274126081444427, -86.65802891379928, -259.6090209328039, -93.65363330835598, -72.02760803992717, -26.537107690913068, -3.7816910084252418, -26.059540940709773, -4.480632209632894, 82.0999999999996, 69.73255807349146, 134.35586169686098, -7.049662021861742, 46.73057866998129, 11.922135288316522, 6.606696034811501, 136.49408560834055, 99.0025537981951, -187.6183114819638, -0.6653875995344563, 135.7748403104363, 10.88846730030474, 35.28226025338927], "policy_predator_policy_reward": [25.319173037691566, 31.088743950725792, 5.725318038721344, 36.725231097374476, 24.306961655364674, 6.048611960112916, 48.87780057084263, 45.81904307528889, 48.531343848613105, 27.038295052407904, 50.77761234151065, 4.51713819601458, 45.209619642935095, 1.8623170165790988, 42.61611398332941, 1.7366693666204496, 19.275725681733533, 6.51052341366584, 8.603108087747895, 3.747800495694322, 16.503254415125397, 6.912547767977219, 56.67139078793485, 54.181775561611914, 15.568667175819215, 34.70592588568032, 32.59931061192473, 37.3326792991078, 15.829526511205886, 2.714159087484522, 8.068311390020144, 52.801108457765096, 26.499245780942527, 7.162440109845806, 34.173035232196504, 48.976952671197836, 27.985751917738583, 16.806762234142678, 5.281640192630357, 61.81244547417532, 20.537396991201394, 0.0, 2.766258106314642, 2.2105035513321685, 30.633270993887983, 8.996582679634521, 80.95211340245903, 20.14238627575925, 35.912035981304456, 50.67873392952714, 20.197271204214125, 8.961624037461704, 50.40304817646434, 2.0471661487854336, 4.5373612640113645, 11.775788501518504, 26.86843801061195, 28.46217164239311, 40.14988690258716, 7.570349110345561, 43.48174047548777, 32.8446940256322, 43.39723686999488, 11.084342951113893, 7.49067436210121, 11.837230905304493, 30.03407231456493, 47.117678923779096, 18.559025708741764, 54.23438222092249, 24.358779412190472, 12.125761746272453, 36.86844366549942, 22.804101785518306, 55.54776860027651, 4.268580790111279, 67.16363536136927, 193.57437068666906, 12.011053140064858, 97.34794197250541, 43.4964610771787, 3.8092284565972734, 49.31464516428957, 15.710740927383949, 53.010754350931634, 0.0, 18.998398136014426, 43.872851289662314, 23.320627960806696, 19.119299971845912, 9.698600382573536, 23.04360207726164, 32.61223959235216, 14.488421945630371, 75.0327439499635, 0.0, 30.014385121263736, 37.4354616797003, 3.169883803639439, 11.01569935990436, 19.16535654295776, 198.12050797661288, 144.11422063686567, 48.436753333819254, 180.69761273692566, 8.704821673411567, 65.5012157870044, 1.7519091411647914, 166.21213546245545, 9.326500716306002, 221.49091571552938, 28.089098039022403, 51.519287144073886, 29.799082113009035, 91.02584884519219, 44.74414667867845, 9.180253627650117, 39.2735718972419, 12.60973208263159, 103.60287305168717, 21.181102532034483, 39.81560298861108, 70.18150903373298, 198.4372408256835, 68.37853608474776, 16.47898856348562, 18.602982173346035, 5.696417161534497, 39.359979457678115, 8.669258894848767, 44.059544155597855, 68.66176072373852, 10.236696967872144, 56.228492970923995, 36.70061579358671, 92.90711399323554, 133.95130774881073, 93.48938003846212, 5.757854322994633, 64.11182962570284, 15.263652772171591, 2.6076699489797477, 9.377878458364071, 8.734570826483118, 56.26392602810229, 56.94642252492594, 12.024688979854004, 26.663314121111775, 36.32114715367594, 8.868364141295215, 90.97763895809581, 19.289411480899673, 12.334914658459487, 38.29711427233296, 60.01412115497513, 34.0414758429741, 26.241908241049995, 28.653537240425987, 45.369922735610295, 47.04275061505205, 10.638447076997986, 85.99025893571559, 67.60289159249228, 52.36955223371986, 48.835140142739235, 90.5418977485161, 62.62015237033799, 28.23560113404548, 9.349767501806308, 70.20583242499589, 44.727900062565794, 215.15045725445853, 74.07269156025708, 54.94711734662641, 14.584004601383368, 164.61057108561803, 92.80053814195033, 48.182369841436866, 139.75802891379894, 299.0090209328042, 112.8196793742602, 83.31874716878085, 56.73972865566094, 93.55319123431256, 58.75954094070998, 29.180632209633004, 0.0, 21.367441926508466, 29.026829596106253, 19.563507455102656, 125.15855080800314, 23.388735233699126, 20.344052042669585, 24.555166314178244, 40.398347680826575, 200.13814367148163, 47.74313746620578, 4.960658580983607, 8.31153269969523, 53.31773974661072]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.903238307783272, "mean_inference_ms": 3.7901199066865647, "mean_action_processing_ms": 1.8808008575028237, "mean_env_wait_ms": 1.167929461448481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036230087280273438, "StateBufferConnector_ms": 0.015940308570861816, "ViewRequirementAgentConnector_ms": 0.1065448522567749}, "num_episodes": 72, "episode_return_max": 255.69999999999976, "episode_return_min": 15.119092496972199, "episode_return_mean": 115.33558257475246, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 246.91212597845782, "num_env_steps_trained_throughput_per_sec": 246.91212597845782, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 32287.876, "restore_workers_time_ms": 0.029, "training_step_time_ms": 32287.213, "sample_time_ms": 1347.882, "learn_time_ms": 30911.687, "learn_throughput": 258.802, "synch_weights_time_ms": 22.476}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 42, "trial_id": "cd905_00000", "date": "2024-08-20_09-46-57", "timestamp": 1724127417, "time_this_iter_s": 32.42963910102844, "time_total_s": 1375.2065227031708, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afecb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1375.2065227031708, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 34.84347826086957, "ram_util_percent": 82.4108695652174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5840769510420543, "cur_kl_coeff": 2.5749206542968747e-06, "cur_lr": 0.0001, "total_loss": 0.8076424236808505, "policy_loss": -0.003660277908276175, "vf_loss": 0.8113027026728978, "vf_explained_var": 0.1801597721992977, "kl": 0.008023713879071966, "entropy": 1.5483896183589148, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 26775.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3645889963215542, "cur_kl_coeff": 1.430511474609375e-07, "cur_lr": 0.0001, "total_loss": 0.2599722282872314, "policy_loss": -0.00039192325258184045, "vf_loss": 0.26036415283996905, "vf_explained_var": 0.012089228062402634, "kl": 0.0013755527824186073, "entropy": 1.157827365209186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 26775.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 255.69999999999976, "episode_reward_min": 15.119092496972199, "episode_reward_mean": 116.72115102618385, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -259.6090209328039, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.10812899563092, "predator_policy": 299.0090209328042}, "policy_reward_mean": {"prey_policy": 13.192466140739086, "predator_policy": 45.168109372352994}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.60000000000045, 104.79999999999944, 55.800000000000296, 122.24100630920698, 146.39999999999995, 60.86725087408976, 39.5000000000003, 85.22627453077428, 31.245501730193183, 193.39999999999895, 63.71469745509225, 81.29081254398697, 69.6642962418768, 39.50000000000029, 51.8000000000005, 64.50000000000017, 88.39999999999907, 53.80000000000038, 70.09999999999978, 96.39999999999837, 193.95368080497528, 98.23996749581933, 153.59999999999917, 196.89999999999924, 190.3999999999993, 124.99999999999994, 91.41947537448874, 113.40000000000003, 69.24024542601182, 116.49999999999949, 100.49999999999972, 176.59999999999934, 106.30000000000015, 162.59152686786874, 38.20000000000027, 149.99999999999912, 68.71509324514157, 210.39999999999975, 173.19999999999897, 45.5000000000004, 96.89999999999995, 251.15723565846042, 55.50000000000024, 167.40094793686694, 164.8999999999997, 152.69999999999922, 115.52040677263076, 167.76297637888908, 243.65049414051327, 69.53862889635406, 174.69999999999982, 155.24375262563782, 124.99999999999915, 63.92299253176351, 132.268972542991, 61.267008350437855, 123.39999999999905, 109.79386995328198, 85.2, 255.69999999999976, 247.56717311988575, 21.435365394264117, 156.99999999999946, 50.30000000000029, 48.02952342856933, 103.59999999999872, 246.49999999999966, 174.3999999999994, 136.60000000000002, 114.7999999999998, 170.91692567356446, 173.49999999999895, 15.119092496972199, 190.89999999999964, 119.89999999999951, 211.99999999999997, 158.69999999999985, 38.10000000000026, 53.85002056928248, 61.300000000000296, 110.49806171028337, 92.49999999999999, 30.457185194759525, 119.97412119063463, 57.40000000000041, 173.19999999999933, 175.89653672620742, 207.19999999999916, 187.9999999999993, 151.92073366853958, 187.81324875809065, 107.8, 33.2000000000002, 80.89999999999921, 100.3999999999987, 101.29999999999899, 36.40000000000025, 112.09999999999852, 138.89999999999904, 44.300000000000374], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [17.2090669740218, 13.604683930578767, 58.59689191225231, 33.85219950430566, 17.096745584874558, 15.28745223202274, -11.312160040339425, 22.700000000000053, 89.53133282418082, 6.594074114319905, 2.9081496517945795, -11.972888688737706, 2.970473488794076, 17.985840912515467, 33.56216727934656, -9.205312596356215, -1.6695899665939002, -0.7465941940013873, 19.426964767803504, 90.82304732880205, 0.9884900563222085, 17.93369324688826, 20.52154826024189, -6.32482138305957, 4.72405580071478, 44.402843449960315, 16.933741893685333, 17.589496448667816, -11.73327099388779, 23.903417320365556, -62.95211340245998, 26.35761372424089, 35.68796401869568, -33.87873392952691, 1.632557717594555, 23.00854704072966, -0.10304817646421288, 17.752833851214554, 31.295967639086637, 48.79088259538393, -2.050560465715245, 140.67363161768642, -18.25816377354463, 68.77789525643195, -26.08174047548752, 103.35530597436761, 72.3481500214232, 70.07027015746792, 155.10812899563092, 15.963965736963262, -7.1340723145647456, 54.98232107622095, 60.355310368821755, -41.72924292399597, -2.5587794121903946, 79.47423825372766, -2.9605388922251135, 12.528238867219354, -9.338367321518298, 66.02201793113049, 23.436364638630643, -183.67437068666933, 118.92997768033422, -51.68897279290429, 12.603538922821485, 46.3907715434027, 9.913380951919557, 87.65275982427653, -35.710754350931396, 20.90000000000003, 112.9016018639853, -25.772851289662057, -9.024834687510992, 35.30000000000012, 130.10139961742635, 47.55639792273844, 42.98650576995515, 83.11283269206217, 2.042991211192012, -31.575735161155315, -8.914385121263605, 38.364538320299864, 101.98735185482104, 134.98430064009557, -0.1653565429577558, -161.6205079766132, -83.39308544359346, 58.24305940977555, -115.2976127369258, 90.79517832658837, 65.59878421299557, 19.84809085883523, 29.686888244139872, -89.70511765027072, 16.91210815175925, -98.72914552742142, 109.1220592414719, 53.21006564195877, -67.48084052461216, 1.2494738970946069, 108.38985428031584, 17.856320194792282, 31.747669431794712, 7.2834780595246364, -2.381102532034452, 66.38439701138888, -25.035743628023823, -179.66001369962913, -48.788696113012385, 96.20014400777083, 29.689684098794153, 7.27792491676283, -20.859979457677852, 96.23074110515084, -36.41042939685885, 33.482994470806425, 10.069294967284748, 8.665515093919149, 109.79938420641317, 16.292886006764416, -47.37743518139536, 67.50392051400868, -4.963890234959569, -43.47042831947347, 122.03634722782836, 17.09233005102023, 21.6221215416359, 10.565429173516847, -61.802866743097226, -3.3779583813626943, 9.075311020145962, 55.83668587888838, 135.77885284632407, 65.53163585870476, 21.422361041903862, 42.71058851910052, 65.26508534154048, 20.70288572766723, -18.97949212801894, 39.72389513006999, 42.47569688429211, 73.5457833077977, -3.1809207496676115, 84.26824739900513, -27.142724784157387, -54.36688873158399, 72.70086452688821, -1.773308353100691, -19.435140142738987, -0.04189774851603825, 66.05629907469647, 55.08794742091993, 57.55023249819372, 21.594167575003937, 9.438513228066471, -231.2168705450911, -52.504482160959476, -22.66530617664185, 32.815995398616614, -150.7105710856186, -38.75897235454745, 8.274126081444427, -86.65802891379928, -259.6090209328039, -93.65363330835598, -72.02760803992717, -26.537107690913068, -3.7816910084252418, -26.059540940709773, -4.480632209632894, 82.0999999999996, 69.73255807349146, 134.35586169686098, -7.049662021861742, 46.73057866998129, 11.922135288316522, 6.606696034811501, 136.49408560834055, 99.0025537981951, -187.6183114819638, -0.6653875995344563, 135.7748403104363, 10.88846730030474, 35.28226025338927, -25.960712539936182, -134.3994792402538, -27.238889811575426, 47.96124419517395, 24.301329393973475, 14.64740819584293, 41.240759944975366, 2.4394615835262012, -13.31466172966597, -7.123892778961418, -10.651132607674537, 53.79130227723315, 1.5105323477397266, 20.05230501265006, -75.92498980717109, 18.873668533228585], "policy_predator_policy_reward": [19.275725681733533, 6.51052341366584, 8.603108087747895, 3.747800495694322, 16.503254415125397, 6.912547767977219, 56.67139078793485, 54.181775561611914, 15.568667175819215, 34.70592588568032, 32.59931061192473, 37.3326792991078, 15.829526511205886, 2.714159087484522, 8.068311390020144, 52.801108457765096, 26.499245780942527, 7.162440109845806, 34.173035232196504, 48.976952671197836, 27.985751917738583, 16.806762234142678, 5.281640192630357, 61.81244547417532, 20.537396991201394, 0.0, 2.766258106314642, 2.2105035513321685, 30.633270993887983, 8.996582679634521, 80.95211340245903, 20.14238627575925, 35.912035981304456, 50.67873392952714, 20.197271204214125, 8.961624037461704, 50.40304817646434, 2.0471661487854336, 4.5373612640113645, 11.775788501518504, 26.86843801061195, 28.46217164239311, 40.14988690258716, 7.570349110345561, 43.48174047548777, 32.8446940256322, 43.39723686999488, 11.084342951113893, 7.49067436210121, 11.837230905304493, 30.03407231456493, 47.117678923779096, 18.559025708741764, 54.23438222092249, 24.358779412190472, 12.125761746272453, 36.86844366549942, 22.804101785518306, 55.54776860027651, 4.268580790111279, 67.16363536136927, 193.57437068666906, 12.011053140064858, 97.34794197250541, 43.4964610771787, 3.8092284565972734, 49.31464516428957, 15.710740927383949, 53.010754350931634, 0.0, 18.998398136014426, 43.872851289662314, 23.320627960806696, 19.119299971845912, 9.698600382573536, 23.04360207726164, 32.61223959235216, 14.488421945630371, 75.0327439499635, 0.0, 30.014385121263736, 37.4354616797003, 3.169883803639439, 11.01569935990436, 19.16535654295776, 198.12050797661288, 144.11422063686567, 48.436753333819254, 180.69761273692566, 8.704821673411567, 65.5012157870044, 1.7519091411647914, 166.21213546245545, 9.326500716306002, 221.49091571552938, 28.089098039022403, 51.519287144073886, 29.799082113009035, 91.02584884519219, 44.74414667867845, 9.180253627650117, 39.2735718972419, 12.60973208263159, 103.60287305168717, 21.181102532034483, 39.81560298861108, 70.18150903373298, 198.4372408256835, 68.37853608474776, 16.47898856348562, 18.602982173346035, 5.696417161534497, 39.359979457678115, 8.669258894848767, 44.059544155597855, 68.66176072373852, 10.236696967872144, 56.228492970923995, 36.70061579358671, 92.90711399323554, 133.95130774881073, 93.48938003846212, 5.757854322994633, 64.11182962570284, 15.263652772171591, 2.6076699489797477, 9.377878458364071, 8.734570826483118, 56.26392602810229, 56.94642252492594, 12.024688979854004, 26.663314121111775, 36.32114715367594, 8.868364141295215, 90.97763895809581, 19.289411480899673, 12.334914658459487, 38.29711427233296, 60.01412115497513, 34.0414758429741, 26.241908241049995, 28.653537240425987, 45.369922735610295, 47.04275061505205, 10.638447076997986, 85.99025893571559, 67.60289159249228, 52.36955223371986, 48.835140142739235, 90.5418977485161, 62.62015237033799, 28.23560113404548, 9.349767501806308, 70.20583242499589, 44.727900062565794, 215.15045725445853, 74.07269156025708, 54.94711734662641, 14.584004601383368, 164.61057108561803, 92.80053814195033, 48.182369841436866, 139.75802891379894, 299.0090209328042, 112.8196793742602, 83.31874716878085, 56.73972865566094, 93.55319123431256, 58.75954094070998, 29.180632209633004, 0.0, 21.367441926508466, 29.026829596106253, 19.563507455102656, 125.15855080800314, 23.388735233699126, 20.344052042669585, 24.555166314178244, 40.398347680826575, 200.13814367148163, 47.74313746620578, 4.960658580983607, 8.31153269969523, 53.31773974661072, 74.9753283537507, 118.58486342643893, 45.13888981157567, 15.03875580482623, 2.5986706060266074, 58.85259180415705, 41.55924005502477, 16.060538416473758, 29.372055811939166, 27.466498696688532, 61.35113260767462, 7.608697722767054, 76.78946765226024, 40.54769498734998, 100.32498980717044, 1.0263314667714158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.896682420154979, "mean_inference_ms": 3.791315265545378, "mean_action_processing_ms": 1.8709542425845058, "mean_env_wait_ms": 1.163893798462292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00365602970123291, "StateBufferConnector_ms": 0.01595437526702881, "ViewRequirementAgentConnector_ms": 0.1078329086303711}, "num_episodes": 8, "episode_return_max": 255.69999999999976, "episode_return_min": 15.119092496972199, "episode_return_mean": 116.72115102618385, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 250.6028405467009, "num_env_steps_trained_throughput_per_sec": 250.6028405467009, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 32261.542, "restore_workers_time_ms": 0.029, "training_step_time_ms": 32260.938, "sample_time_ms": 1334.523, "learn_time_ms": 30899.266, "learn_throughput": 258.906, "synch_weights_time_ms": 22.238}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 43, "trial_id": "cd905_00000", "date": "2024-08-20_09-47-29", "timestamp": 1724127449, "time_this_iter_s": 31.970680952072144, "time_total_s": 1407.177203655243, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afbd820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1407.177203655243, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 31.53260869565217, "ram_util_percent": 82.1891304347826}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0066101903007145, "cur_kl_coeff": 2.5749206542968747e-06, "cur_lr": 0.0001, "total_loss": 4.012890438806443, "policy_loss": -0.0029118369950632017, "vf_loss": 4.015802264592004, "vf_explained_var": 0.015714242628642492, "kl": 0.010503709564534888, "entropy": 1.510609727814084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.44572868660565407, "cur_kl_coeff": 7.152557373046875e-08, "cur_lr": 0.0001, "total_loss": 2.4758990257505387, "policy_loss": -0.002130591772526266, "vf_loss": 2.4780296128893657, "vf_explained_var": 0.001599846567426409, "kl": 0.005564954153253763, "entropy": 1.0855177850950333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 246.49999999999966, "episode_reward_min": -45.62819424798025, "episode_reward_mean": 85.15786680259691, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -259.6090209328039, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 136.49408560834055, "predator_policy": 299.0090209328042}, "policy_reward_mean": {"prey_policy": -5.931081248034152, "predator_policy": 48.51001464933272}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.02952342856933, 103.59999999999872, 246.49999999999966, 174.3999999999994, 136.60000000000002, 114.7999999999998, 170.91692567356446, 173.49999999999895, 15.119092496972199, 190.89999999999964, 119.89999999999951, 211.99999999999997, 158.69999999999985, 38.10000000000026, 53.85002056928248, 61.300000000000296, 110.49806171028337, 92.49999999999999, 30.457185194759525, 119.97412119063463, 57.40000000000041, 173.19999999999933, 175.89653672620742, 207.19999999999916, 187.9999999999993, 151.92073366853958, 187.81324875809065, 107.8, 33.2000000000002, 80.89999999999921, 100.3999999999987, 101.29999999999899, 36.40000000000025, 112.09999999999852, 138.89999999999904, 44.300000000000374, 89.8999999999987, 50.981085524569046, 145.09999999999891, 96.59999999999872, 39.40000000000029, 25.747448905227504, 106.69999999999881, 36.50000000000025, 72.99999999999979, 129.0084138617726, 85.25047780037768, 34.0060312431528, 94.29999999999876, 35.500000000000234, 53.226153997659914, 95.69999999999841, 37.20000000000026, 35.80000000000024, 39.500000000000306, 37.111724937701716, 83.48087230149434, 54.100000000000406, 35.500000000000234, 47.2000000000004, 36.900000000000254, 48.6000000000004, 79.99999999999953, 44.30000000000038, 61.65232016703141, 94.19999999999854, 35.46847287763295, 70.09999999999988, 127.09999999999846, 96.9999999999985, 105.44858133934147, 42.535513444878916, 36.40000000000025, 83.59999999999907, 192.499999999999, 69.34941279048303, 72.89999999999978, 45.64156193987147, 21.15509760808398, 29.810789862855916, -45.62819424798025, 50.886395210936044, 102.5999999999986, 53.02139539940143, 38.262347328477695, 31.927714880518927, 53.60000000000043, 46.500000000000426, 35.60000000000025, 62.80000000000043, 98.09999999999891, 154.59999999999866, 67.30000000000014, 123.69516702107092, 58.200000000000394, 40.50000000000031, 58.36924543455282, 36.97105348536844, 94.43214772832962, 130.19999999999868], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-61.802866743097226, -3.3779583813626943, 9.075311020145962, 55.83668587888838, 135.77885284632407, 65.53163585870476, 21.422361041903862, 42.71058851910052, 65.26508534154048, 20.70288572766723, -18.97949212801894, 39.72389513006999, 42.47569688429211, 73.5457833077977, -3.1809207496676115, 84.26824739900513, -27.142724784157387, -54.36688873158399, 72.70086452688821, -1.773308353100691, -19.435140142738987, -0.04189774851603825, 66.05629907469647, 55.08794742091993, 57.55023249819372, 21.594167575003937, 9.438513228066471, -231.2168705450911, -52.504482160959476, -22.66530617664185, 32.815995398616614, -150.7105710856186, -38.75897235454745, 8.274126081444427, -86.65802891379928, -259.6090209328039, -93.65363330835598, -72.02760803992717, -26.537107690913068, -3.7816910084252418, -26.059540940709773, -4.480632209632894, 82.0999999999996, 69.73255807349146, 134.35586169686098, -7.049662021861742, 46.73057866998129, 11.922135288316522, 6.606696034811501, 136.49408560834055, 99.0025537981951, -187.6183114819638, -0.6653875995344563, 135.7748403104363, 10.88846730030474, 35.28226025338927, -25.960712539936182, -134.3994792402538, -27.238889811575426, 47.96124419517395, 24.301329393973475, 14.64740819584293, 41.240759944975366, 2.4394615835262012, -13.31466172966597, -7.123892778961418, -10.651132607674537, 53.79130227723315, 1.5105323477397266, 20.05230501265006, -75.92498980717109, 18.873668533228585, -31.854985160609445, 43.28657333344258, -152.7075604640611, 8.616160936631704, 94.0572877480676, -99.05131452635277, -18.864930643575562, 56.73034849633261, 13.681177013365604, 18.89444838211969, -59.93813864999297, -201.72906712173906, -62.9374120340893, 60.83143888189578, -26.090193687719697, 20.000000000000014, 0.4683527992888611, 42.63371893869929, 44.97207453819872, 18.139059058669897, 39.638427874916786, -17.31262610962193, -41.90384291191619, 0.9832548569921602, -34.70015129721683, 8.754285147138972, -79.25498317413631, 10.49428450284206, -21.530090433367207, -23.313537657838324, 73.09999999999955, -19.978315003776203, 1.5673465990466917, -5.847290856104056, -11.700743322521083, -10.256366875035155, 5.637184189487236, -30.734130234668342, -27.11956379365005, -44.246597851039304, -4.714819268450418, 45.70285911648373, -27.458270099712877, -42.88596629560254, -9.35522730848299, -39.091966976699624, 5.769966730442611, 17.480298612946072, 2.2860442266403576, -21.79825116035395, -111.11627967338688, 3.309676037168025, -113.09496138947962, -33.14864909419672, -8.502572651706531, 6.699137894706034, -87.82236168398197, 19.668673549205334, -79.57896216179455, 70.42206300592854, 0.19007878505134426, 1.5082458852758494, -4.844131070678451, 29.886782284743756, 43.27843283042008, 42.63101535419126, 39.456123263030214, 25.287002642554643, 29.594122255955682, 3.5678143354780185, 5.041874778173241, -37.13565847070868, 10.251991681981858, -37.4272848188807, 21.016537139448282, 47.19816035559713, 54.99500142919975, 87.74520208429519, 12.158596040970204, -34.072784562398006, 44.25755003278073, -35.39443269595388, -51.542454787677734, -29.924164499670475, -60.117460980456464, -62.17509449472245, -47.7882702373645, -45.79738125108325, -88.04515934635029, -105.23762028235464, -147.29933075048365, 13.41395333971196, 45.358976643383855, 35.431400522741576, -30.39975303962332, -22.60676585169447, -67.24686238691798, -24.075728332464863, -9.700315393188605, -35.05873565934352, 16.861474613734746, -4.830717455335282, -1.1857052886873691, -50.676000465368986, -32.072282652464004, -52.41492502550795, 32.751524479190884, -17.6576749517956, 13.177345750659631, -18.67813786783278, 19.913197339717957, 89.32628084900702, -32.07048050188769, 15.858513654752626, 27.60708902485208, 27.60352093493816, -68.00375463669535, -15.764332890722342, 12.933957135581322, -71.834767725515, 25.353210177252407, -46.36545363001283, -48.41951051961668, 10.20692386646109, -78.61833277413228, 49.033551914556206, -43.438774971970524, 79.77308580979144], "policy_predator_policy_reward": [56.26392602810229, 56.94642252492594, 12.024688979854004, 26.663314121111775, 36.32114715367594, 8.868364141295215, 90.97763895809581, 19.289411480899673, 12.334914658459487, 38.29711427233296, 60.01412115497513, 34.0414758429741, 26.241908241049995, 28.653537240425987, 45.369922735610295, 47.04275061505205, 10.638447076997986, 85.99025893571559, 67.60289159249228, 52.36955223371986, 48.835140142739235, 90.5418977485161, 62.62015237033799, 28.23560113404548, 9.349767501806308, 70.20583242499589, 44.727900062565794, 215.15045725445853, 74.07269156025708, 54.94711734662641, 14.584004601383368, 164.61057108561803, 92.80053814195033, 48.182369841436866, 139.75802891379894, 299.0090209328042, 112.8196793742602, 83.31874716878085, 56.73972865566094, 93.55319123431256, 58.75954094070998, 29.180632209633004, 0.0, 21.367441926508466, 29.026829596106253, 19.563507455102656, 125.15855080800314, 23.388735233699126, 20.344052042669585, 24.555166314178244, 40.398347680826575, 200.13814367148163, 47.74313746620578, 4.960658580983607, 8.31153269969523, 53.31773974661072, 74.9753283537507, 118.58486342643893, 45.13888981157567, 15.03875580482623, 2.5986706060266074, 58.85259180415705, 41.55924005502477, 16.060538416473758, 29.372055811939166, 27.466498696688532, 61.35113260767462, 7.608697722767054, 76.78946765226024, 40.54769498734998, 100.32498980717044, 1.0263314667714158, 48.754985160609685, 29.713426666557584, 186.26655773581626, 8.805927316181215, 5.442712251931807, 144.65131452635228, 45.96259076624481, 12.771991380998573, 5.818822986634361, 1.00555161788031, 114.2929849127332, 173.12166976422492, 79.63741203408843, 29.16856111810436, 42.590193687719925, 0.0, 18.33164720071113, 11.566281061300897, 44.32926786545351, 21.568012399452265, 41.70499413263276, 21.219681902451573, 59.57710151650329, 15.349517781573523, 109.80015129721697, 10.445714852860993, 95.55498317413542, 8.705715497157906, 8.079315419057457, 89.99046666980799, 0.0, 42.57831500377644, 17.832653400953294, 23.647290856104128, 33.23986760251687, 24.517242595039704, 13.26281581051273, 51.33413023466858, 103.35288926534339, 5.124997317047828, 29.84740321771579, 12.645429235746457, 46.549992434116525, 77.89424396119934, 27.655227308483116, 56.29196697669987, 13.130033269557355, 10.819701387053893, 16.313955773359602, 40.09825116035421, 138.29835715385468, 18.108246482363374, 130.10811252118495, 96.13549796249066, 21.626296399435134, 24.477138357565448, 81.01711026684065, 48.78889803496613, 96.67896216179358, 6.677936994071197, 17.53248466911039, 16.237663538195093, 23.244131070678513, 21.813217715256428, 7.619920656261036, 33.57063115912801, 7.84387673696999, 24.41299735744547, 68.63646059415869, 3.650184153750728, 48.86050454009827, 25.768792597315926, 8.948008318018108, 54.627284818880945, 6.077782997107605, 9.307519507847227, 28.7841214051189, 20.975675081386076, 91.26360131191106, 0.0, 11.542449967219458, 52.494432695954124, 94.07600202904456, 33.03217919817479, 59.33022267769592, 84.1174304055657, 62.788270237364685, 60.608171113939235, 144.4581848400926, 3.1964005406307967, 134.35889235919038, 50.41288026251651, 10.784311681521874, 11.025311152353098, 42.52114843902463, 63.50676585169465, 37.25540303546393, 92.32953501239574, 51.53540601843775, 25.151359914613444, 2.8385253862652267, 38.730717455335295, 31.685705288687355, 66.67600046536911, 47.87228265246413, 72.21492502550812, 11.448475520809318, 36.25767495179586, 60.222654249340344, 43.37813786783302, 37.18680266028207, 8.173719150992426, 67.42813249743199, 16.083834349703164, 2.876263732480027, 65.60829332880212, 108.30375463669459, 33.664332890722584, 62.53456310771006, 36.86624748222273, 15.716035257300083, 63.665453630013054, 65.41951051961682, 9.764129618907056, 91.28056669747164, 32.73636189043468, 6.051971035206008, 87.81371812697252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.87983799929372, "mean_inference_ms": 3.774755731488673, "mean_action_processing_ms": 1.865215010035468, "mean_env_wait_ms": 1.160053737630234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036066770553588867, "StateBufferConnector_ms": 0.013876795768737793, "ViewRequirementAgentConnector_ms": 0.10813307762145996}, "num_episodes": 64, "episode_return_max": 246.49999999999966, "episode_return_min": -45.62819424798025, "episode_return_mean": 85.15786680259691, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 246.44430230334174, "num_env_steps_trained_throughput_per_sec": 246.44430230334174, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 32275.001, "restore_workers_time_ms": 0.029, "training_step_time_ms": 32274.446, "sample_time_ms": 1343.081, "learn_time_ms": 30902.606, "learn_throughput": 258.878, "synch_weights_time_ms": 23.123}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 44, "trial_id": "cd905_00000", "date": "2024-08-20_09-48-02", "timestamp": 1724127482, "time_this_iter_s": 32.504496812820435, "time_total_s": 1439.6817004680634, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a105d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1439.6817004680634, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 38.65217391304348, "ram_util_percent": 82.42391304347827}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1624832086856403, "cur_kl_coeff": 2.5749206542968747e-06, "cur_lr": 0.0001, "total_loss": 0.7252139446044725, "policy_loss": -0.001995918542397992, "vf_loss": 0.727209842110437, "vf_explained_var": 0.029517577375684466, "kl": 0.010703560250231165, "entropy": 1.4567957265036446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 28035.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3136863984049313, "cur_kl_coeff": 7.152557373046875e-08, "cur_lr": 0.0001, "total_loss": 0.42394309339542235, "policy_loss": -0.0006465477207379918, "vf_loss": 0.42458964219642065, "vf_explained_var": 0.002144740876697359, "kl": 0.002794433584930962, "entropy": 1.1152603963064769, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 28035.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 211.99999999999997, "episode_reward_min": -45.62819424798025, "episode_reward_mean": 78.67474076018635, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -259.6090209328039, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 136.49408560834055, "predator_policy": 299.0090209328042}, "policy_reward_mean": {"prey_policy": -9.732075633199718, "predator_policy": 49.06944601329299}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.119092496972199, 190.89999999999964, 119.89999999999951, 211.99999999999997, 158.69999999999985, 38.10000000000026, 53.85002056928248, 61.300000000000296, 110.49806171028337, 92.49999999999999, 30.457185194759525, 119.97412119063463, 57.40000000000041, 173.19999999999933, 175.89653672620742, 207.19999999999916, 187.9999999999993, 151.92073366853958, 187.81324875809065, 107.8, 33.2000000000002, 80.89999999999921, 100.3999999999987, 101.29999999999899, 36.40000000000025, 112.09999999999852, 138.89999999999904, 44.300000000000374, 89.8999999999987, 50.981085524569046, 145.09999999999891, 96.59999999999872, 39.40000000000029, 25.747448905227504, 106.69999999999881, 36.50000000000025, 72.99999999999979, 129.0084138617726, 85.25047780037768, 34.0060312431528, 94.29999999999876, 35.500000000000234, 53.226153997659914, 95.69999999999841, 37.20000000000026, 35.80000000000024, 39.500000000000306, 37.111724937701716, 83.48087230149434, 54.100000000000406, 35.500000000000234, 47.2000000000004, 36.900000000000254, 48.6000000000004, 79.99999999999953, 44.30000000000038, 61.65232016703141, 94.19999999999854, 35.46847287763295, 70.09999999999988, 127.09999999999846, 96.9999999999985, 105.44858133934147, 42.535513444878916, 36.40000000000025, 83.59999999999907, 192.499999999999, 69.34941279048303, 72.89999999999978, 45.64156193987147, 21.15509760808398, 29.810789862855916, -45.62819424798025, 50.886395210936044, 102.5999999999986, 53.02139539940143, 38.262347328477695, 31.927714880518927, 53.60000000000043, 46.500000000000426, 35.60000000000025, 62.80000000000043, 98.09999999999891, 154.59999999999866, 67.30000000000014, 123.69516702107092, 58.200000000000394, 40.50000000000031, 58.36924543455282, 36.97105348536844, 94.43214772832962, 130.19999999999868, 118.19999999999885, 40.1000000000003, 3.9022520911234024, 43.500000000000355, 100.59999999999891, 138.8999999999987, 15.09313806493098, 59.738454705025035], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-27.142724784157387, -54.36688873158399, 72.70086452688821, -1.773308353100691, -19.435140142738987, -0.04189774851603825, 66.05629907469647, 55.08794742091993, 57.55023249819372, 21.594167575003937, 9.438513228066471, -231.2168705450911, -52.504482160959476, -22.66530617664185, 32.815995398616614, -150.7105710856186, -38.75897235454745, 8.274126081444427, -86.65802891379928, -259.6090209328039, -93.65363330835598, -72.02760803992717, -26.537107690913068, -3.7816910084252418, -26.059540940709773, -4.480632209632894, 82.0999999999996, 69.73255807349146, 134.35586169686098, -7.049662021861742, 46.73057866998129, 11.922135288316522, 6.606696034811501, 136.49408560834055, 99.0025537981951, -187.6183114819638, -0.6653875995344563, 135.7748403104363, 10.88846730030474, 35.28226025338927, -25.960712539936182, -134.3994792402538, -27.238889811575426, 47.96124419517395, 24.301329393973475, 14.64740819584293, 41.240759944975366, 2.4394615835262012, -13.31466172966597, -7.123892778961418, -10.651132607674537, 53.79130227723315, 1.5105323477397266, 20.05230501265006, -75.92498980717109, 18.873668533228585, -31.854985160609445, 43.28657333344258, -152.7075604640611, 8.616160936631704, 94.0572877480676, -99.05131452635277, -18.864930643575562, 56.73034849633261, 13.681177013365604, 18.89444838211969, -59.93813864999297, -201.72906712173906, -62.9374120340893, 60.83143888189578, -26.090193687719697, 20.000000000000014, 0.4683527992888611, 42.63371893869929, 44.97207453819872, 18.139059058669897, 39.638427874916786, -17.31262610962193, -41.90384291191619, 0.9832548569921602, -34.70015129721683, 8.754285147138972, -79.25498317413631, 10.49428450284206, -21.530090433367207, -23.313537657838324, 73.09999999999955, -19.978315003776203, 1.5673465990466917, -5.847290856104056, -11.700743322521083, -10.256366875035155, 5.637184189487236, -30.734130234668342, -27.11956379365005, -44.246597851039304, -4.714819268450418, 45.70285911648373, -27.458270099712877, -42.88596629560254, -9.35522730848299, -39.091966976699624, 5.769966730442611, 17.480298612946072, 2.2860442266403576, -21.79825116035395, -111.11627967338688, 3.309676037168025, -113.09496138947962, -33.14864909419672, -8.502572651706531, 6.699137894706034, -87.82236168398197, 19.668673549205334, -79.57896216179455, 70.42206300592854, 0.19007878505134426, 1.5082458852758494, -4.844131070678451, 29.886782284743756, 43.27843283042008, 42.63101535419126, 39.456123263030214, 25.287002642554643, 29.594122255955682, 3.5678143354780185, 5.041874778173241, -37.13565847070868, 10.251991681981858, -37.4272848188807, 21.016537139448282, 47.19816035559713, 54.99500142919975, 87.74520208429519, 12.158596040970204, -34.072784562398006, 44.25755003278073, -35.39443269595388, -51.542454787677734, -29.924164499670475, -60.117460980456464, -62.17509449472245, -47.7882702373645, -45.79738125108325, -88.04515934635029, -105.23762028235464, -147.29933075048365, 13.41395333971196, 45.358976643383855, 35.431400522741576, -30.39975303962332, -22.60676585169447, -67.24686238691798, -24.075728332464863, -9.700315393188605, -35.05873565934352, 16.861474613734746, -4.830717455335282, -1.1857052886873691, -50.676000465368986, -32.072282652464004, -52.41492502550795, 32.751524479190884, -17.6576749517956, 13.177345750659631, -18.67813786783278, 19.913197339717957, 89.32628084900702, -32.07048050188769, 15.858513654752626, 27.60708902485208, 27.60352093493816, -68.00375463669535, -15.764332890722342, 12.933957135581322, -71.834767725515, 25.353210177252407, -46.36545363001283, -48.41951051961668, 10.20692386646109, -78.61833277413228, 49.033551914556206, -43.438774971970524, 79.77308580979144, 74.73932059193038, -64.53186151641029, 17.341775155950103, 10.092055274303942, -81.86043968558033, -30.831837434854286, -53.85080501684572, -9.120873594816098, 28.322849626492705, 13.742198814674008, 45.615892483800344, 46.815218708549736, -69.95677188916498, -43.426921535278105, -23.476908886291966, -50.81597717627889], "policy_predator_policy_reward": [10.638447076997986, 85.99025893571559, 67.60289159249228, 52.36955223371986, 48.835140142739235, 90.5418977485161, 62.62015237033799, 28.23560113404548, 9.349767501806308, 70.20583242499589, 44.727900062565794, 215.15045725445853, 74.07269156025708, 54.94711734662641, 14.584004601383368, 164.61057108561803, 92.80053814195033, 48.182369841436866, 139.75802891379894, 299.0090209328042, 112.8196793742602, 83.31874716878085, 56.73972865566094, 93.55319123431256, 58.75954094070998, 29.180632209633004, 0.0, 21.367441926508466, 29.026829596106253, 19.563507455102656, 125.15855080800314, 23.388735233699126, 20.344052042669585, 24.555166314178244, 40.398347680826575, 200.13814367148163, 47.74313746620578, 4.960658580983607, 8.31153269969523, 53.31773974661072, 74.9753283537507, 118.58486342643893, 45.13888981157567, 15.03875580482623, 2.5986706060266074, 58.85259180415705, 41.55924005502477, 16.060538416473758, 29.372055811939166, 27.466498696688532, 61.35113260767462, 7.608697722767054, 76.78946765226024, 40.54769498734998, 100.32498980717044, 1.0263314667714158, 48.754985160609685, 29.713426666557584, 186.26655773581626, 8.805927316181215, 5.442712251931807, 144.65131452635228, 45.96259076624481, 12.771991380998573, 5.818822986634361, 1.00555161788031, 114.2929849127332, 173.12166976422492, 79.63741203408843, 29.16856111810436, 42.590193687719925, 0.0, 18.33164720071113, 11.566281061300897, 44.32926786545351, 21.568012399452265, 41.70499413263276, 21.219681902451573, 59.57710151650329, 15.349517781573523, 109.80015129721697, 10.445714852860993, 95.55498317413542, 8.705715497157906, 8.079315419057457, 89.99046666980799, 0.0, 42.57831500377644, 17.832653400953294, 23.647290856104128, 33.23986760251687, 24.517242595039704, 13.26281581051273, 51.33413023466858, 103.35288926534339, 5.124997317047828, 29.84740321771579, 12.645429235746457, 46.549992434116525, 77.89424396119934, 27.655227308483116, 56.29196697669987, 13.130033269557355, 10.819701387053893, 16.313955773359602, 40.09825116035421, 138.29835715385468, 18.108246482363374, 130.10811252118495, 96.13549796249066, 21.626296399435134, 24.477138357565448, 81.01711026684065, 48.78889803496613, 96.67896216179358, 6.677936994071197, 17.53248466911039, 16.237663538195093, 23.244131070678513, 21.813217715256428, 7.619920656261036, 33.57063115912801, 7.84387673696999, 24.41299735744547, 68.63646059415869, 3.650184153750728, 48.86050454009827, 25.768792597315926, 8.948008318018108, 54.627284818880945, 6.077782997107605, 9.307519507847227, 28.7841214051189, 20.975675081386076, 91.26360131191106, 0.0, 11.542449967219458, 52.494432695954124, 94.07600202904456, 33.03217919817479, 59.33022267769592, 84.1174304055657, 62.788270237364685, 60.608171113939235, 144.4581848400926, 3.1964005406307967, 134.35889235919038, 50.41288026251651, 10.784311681521874, 11.025311152353098, 42.52114843902463, 63.50676585169465, 37.25540303546393, 92.32953501239574, 51.53540601843775, 25.151359914613444, 2.8385253862652267, 38.730717455335295, 31.685705288687355, 66.67600046536911, 47.87228265246413, 72.21492502550812, 11.448475520809318, 36.25767495179586, 60.222654249340344, 43.37813786783302, 37.18680266028207, 8.173719150992426, 67.42813249743199, 16.083834349703164, 2.876263732480027, 65.60829332880212, 108.30375463669459, 33.664332890722584, 62.53456310771006, 36.86624748222273, 15.716035257300083, 63.665453630013054, 65.41951051961682, 9.764129618907056, 91.28056669747164, 32.73636189043468, 6.051971035206008, 87.81371812697252, 25.18280537495706, 82.80973554952159, 2.458224844049877, 10.207944725696024, 114.6927807428314, 1.9017484687258797, 35.20266407366789, 71.26901453799404, 52.677150373507445, 5.857801185325956, 16.884107516199833, 29.58478129145042, 63.87367832188615, 64.60315316748716, 58.007673538369914, 76.02366722922604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.873819882898593, "mean_inference_ms": 3.7759755006006914, "mean_action_processing_ms": 1.8564482414488372, "mean_env_wait_ms": 1.1564381807284332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003742218017578125, "StateBufferConnector_ms": 0.01407766342163086, "ViewRequirementAgentConnector_ms": 0.10959160327911377}, "num_episodes": 8, "episode_return_max": 211.99999999999997, "episode_return_min": -45.62819424798025, "episode_return_mean": 78.67474076018635, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 242.07892167601761, "num_env_steps_trained_throughput_per_sec": 242.07892167601761, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 32326.307, "restore_workers_time_ms": 0.036, "training_step_time_ms": 32325.734, "sample_time_ms": 1363.942, "learn_time_ms": 30932.462, "learn_throughput": 258.628, "synch_weights_time_ms": 23.449}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 45, "trial_id": "cd905_00000", "date": "2024-08-20_09-48-35", "timestamp": 1724127515, "time_this_iter_s": 33.088785886764526, "time_total_s": 1472.7704863548279, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f759d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1472.7704863548279, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 40.028260869565216, "ram_util_percent": 82.79782608695653}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.006285724398636, "cur_kl_coeff": 2.5749206542968747e-06, "cur_lr": 0.0001, "total_loss": 3.3159564207470607, "policy_loss": -0.002287370252186462, "vf_loss": 3.318243804810539, "vf_explained_var": -0.0016353365920838856, "kl": 0.011682329953374204, "entropy": 1.4571033279101053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 28665.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3993245861833058, "cur_kl_coeff": 3.5762786865234374e-08, "cur_lr": 0.0001, "total_loss": 2.2245313476002404, "policy_loss": -0.0015771274022491914, "vf_loss": 2.226108472498636, "vf_explained_var": 0.0011011604278806657, "kl": 0.004097338002472339, "entropy": 1.2056668096118504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 28665.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 192.499999999999, "episode_reward_min": -45.62819424798025, "episode_reward_mean": 64.6495244633021, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -282.6921265276016, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 116.29999999999961, "predator_policy": 263.7235549915009}, "policy_reward_mean": {"prey_policy": -15.634876180629117, "predator_policy": 47.95963841228025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.40000000000025, 83.59999999999907, 192.499999999999, 69.34941279048303, 72.89999999999978, 45.64156193987147, 21.15509760808398, 29.810789862855916, -45.62819424798025, 50.886395210936044, 102.5999999999986, 53.02139539940143, 38.262347328477695, 31.927714880518927, 53.60000000000043, 46.500000000000426, 35.60000000000025, 62.80000000000043, 98.09999999999891, 154.59999999999866, 67.30000000000014, 123.69516702107092, 58.200000000000394, 40.50000000000031, 58.36924543455282, 36.97105348536844, 94.43214772832962, 130.19999999999868, 118.19999999999885, 40.1000000000003, 3.9022520911234024, 43.500000000000355, 100.59999999999891, 138.8999999999987, 15.09313806493098, 59.738454705025035, 21.397378766914507, 35.22613823959559, 38.300000000000274, 35.40665301112142, 83.19573103887689, 107.29999999999862, 94.99999999999858, 91.09417313505743, 93.49999999999869, 87.01733812065012, 68.79091555453982, -28.75943233587767, 12.869896906291533, 54.7566279159387, 38.300000000000274, 61.600000000000385, 87.39999999999876, 103.68969400939886, 49.20000000000038, 75.79999999999956, 68.90188765893585, 47.333521961351295, 47.99403484985668, 85.3999999999989, 62.800000000000395, 63.700000000000465, 77.13444790948226, 68.80000000000005, 93.69999999999891, 75.02778231580363, 35.80000000000024, 119.25887515032704, 37.10000000000026, 141.19987231327585, 31.914363388426924, 75.5999999999995, 45.5000000000004, 82.29999999999913, 25.919262725860854, 83.28551341803653, 32.40000000000019, 136.69999999999862, 38.50000000000028, 76.36182845903835, 40.18993340711516, 24.718029107161723, 38.70000000000028, 39.7000000000003, 126.29999999999842, 76.19999999999952, 70.09999999999994, 36.40000000000025, 67.50000000000021, 53.50000000000036, 41.10000000000034, 34.70000000000022, 53.300000000000374, 77.59999999999931, 78.29999999999943, 87.29999999999875, 34.50000000000022, 135.09999999999891, 79.49999999999919, 43.20000000000038], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [10.251991681981858, -37.4272848188807, 21.016537139448282, 47.19816035559713, 54.99500142919975, 87.74520208429519, 12.158596040970204, -34.072784562398006, 44.25755003278073, -35.39443269595388, -51.542454787677734, -29.924164499670475, -60.117460980456464, -62.17509449472245, -47.7882702373645, -45.79738125108325, -88.04515934635029, -105.23762028235464, -147.29933075048365, 13.41395333971196, 45.358976643383855, 35.431400522741576, -30.39975303962332, -22.60676585169447, -67.24686238691798, -24.075728332464863, -9.700315393188605, -35.05873565934352, 16.861474613734746, -4.830717455335282, -1.1857052886873691, -50.676000465368986, -32.072282652464004, -52.41492502550795, 32.751524479190884, -17.6576749517956, 13.177345750659631, -18.67813786783278, 19.913197339717957, 89.32628084900702, -32.07048050188769, 15.858513654752626, 27.60708902485208, 27.60352093493816, -68.00375463669535, -15.764332890722342, 12.933957135581322, -71.834767725515, 25.353210177252407, -46.36545363001283, -48.41951051961668, 10.20692386646109, -78.61833277413228, 49.033551914556206, -43.438774971970524, 79.77308580979144, 74.73932059193038, -64.53186151641029, 17.341775155950103, 10.092055274303942, -81.86043968558033, -30.831837434854286, -53.85080501684572, -9.120873594816098, 28.322849626492705, 13.742198814674008, 45.615892483800344, 46.815218708549736, -69.95677188916498, -43.426921535278105, -23.476908886291966, -50.81597717627889, -29.51582068126018, -10.718859262814652, -23.3492288129842, -17.495414080369486, 11.099634012897303, -60.767414834687095, -29.968861089612822, -282.6921265276016, -43.35100002852454, -119.39303270857883, 40.58103360315921, 13.855945980623941, 43.14970549724424, -41.85066564610442, 27.907484853204792, 8.647987031627286, -168.50884190594476, 78.1876404870705, -37.1149312715263, 12.932953893366262, 47.80183532700293, -107.61152497578483, -89.37314311206543, -117.7472568590781, -14.93754279870898, -29.73963194125549, -33.69372284364551, -33.87523693696208, 9.626626521181997, -1.5018964600389189, -32.306764033111925, -83.82473501908174, -54.36782269270356, 46.21354096535189, -114.65310010283939, 14.2099628913247, -96.04621195546044, -16.42655790021412, 7.596211554432108, 0.5366820175354239, -42.736129143817365, 21.51472375176184, -33.16347009320824, -38.377233586808046, 16.759595793918216, -12.668815285100084, 46.38931837225733, 9.788363953400674, -14.105598511897574, 11.575815336105515, 32.730870001195484, -11.037034398175464, -8.182491612219911, 3.954696924429968, 11.060013286089951, -70.6542923574891, -62.79096117895312, -38.60754118999565, 4.9742987779035825, -1.8207437538316382, -48.302971259977674, -4.208881459353574, -27.88873441439484, 60.11927785867584, 4.1929320990892816, -16.299256009248168, -4.364360447288041, 116.29999999999961, -157.623738370735, 12.533710504186866, -2.405649791085777, -109.58294561755139, -5.815282984079143, -3.503539583666274, 4.831075422977754, 44.17443927976589, 5.626212907091974, -17.50748221205695, -10.166527587193718, 7.387149700414671, -55.46440375446858, -32.48746092278306, 60.381830727052844, 32.96585749651302, 17.785721821517146, -20.331743448572617, -32.53150099141798, 14.745141586832947, -69.2711143121321, -82.74624371801885, -103.13034604880978, -14.66930565362972, -5.163649823545926, -4.9418293295901545, 7.476538607631696, -1.6102460013014124, 42.475813340899535, 60.80881248301743, 61.14710522442277, -86.79125370024882, -147.34318568008777, 34.896064653979955, -114.03346566857971, 15.094107480205773, 15.669025764577137, 38.61111923961491, 16.971972044046076, -0.7612619054529829, 12.6839161364343, -94.39503829990493, -38.24764099671098, -65.3062846538473, -82.00775767968412, -22.337400743042764, 25.072268239975422, -0.7009617832770249, 34.69205361841532, -39.340929019351634, 66.34994466067087, -9.719363710512779, -22.676618644081223, -5.745351081178191, 85.13579948346134, 47.000000000000206, 45.41734131192997, -41.355357601685505, -25.61586435135949, -72.32831181256103], "policy_predator_policy_reward": [8.948008318018108, 54.627284818880945, 6.077782997107605, 9.307519507847227, 28.7841214051189, 20.975675081386076, 91.26360131191106, 0.0, 11.542449967219458, 52.494432695954124, 94.07600202904456, 33.03217919817479, 59.33022267769592, 84.1174304055657, 62.788270237364685, 60.608171113939235, 144.4581848400926, 3.1964005406307967, 134.35889235919038, 50.41288026251651, 10.784311681521874, 11.025311152353098, 42.52114843902463, 63.50676585169465, 37.25540303546393, 92.32953501239574, 51.53540601843775, 25.151359914613444, 2.8385253862652267, 38.730717455335295, 31.685705288687355, 66.67600046536911, 47.87228265246413, 72.21492502550812, 11.448475520809318, 36.25767495179586, 60.222654249340344, 43.37813786783302, 37.18680266028207, 8.173719150992426, 67.42813249743199, 16.083834349703164, 2.876263732480027, 65.60829332880212, 108.30375463669459, 33.664332890722584, 62.53456310771006, 36.86624748222273, 15.716035257300083, 63.665453630013054, 65.41951051961682, 9.764129618907056, 91.28056669747164, 32.73636189043468, 6.051971035206008, 87.81371812697252, 25.18280537495706, 82.80973554952159, 2.458224844049877, 10.207944725696024, 114.6927807428314, 1.9017484687258797, 35.20266407366789, 71.26901453799404, 52.677150373507445, 5.857801185325956, 16.884107516199833, 29.58478129145042, 63.87367832188615, 64.60315316748716, 58.007673538369914, 76.02366722922604, 49.9956539259459, 11.636404785043796, 40.94922881298445, 35.12155231996509, 8.200365987102664, 79.7674148346868, 263.7235549915009, 84.34408563683627, 119.75319021760612, 126.18657355837473, 25.91896639684098, 26.944054019376054, 5.150294502755988, 88.55066564610455, 25.700847919759145, 28.837853330467706, 182.708841905944, 1.1123595129288588, 32.797657417650356, 78.40165808116124, 4.417019412188479, 124.18358579113371, 10.782018630130663, 167.57894900513293, 54.306376358189546, 3.240695288066912, 55.73876526650075, 66.58682243004553, 9.673373478817968, 20.501896460038942, 78.9067640331121, 98.82473501908089, 92.36782269270346, 3.1864590346483332, 138.39838771729666, 65.73444350361733, 86.26470839732625, 75.40806145834789, 16.67734232722582, 50.98976410080663, 64.7583919369369, 25.36490111405467, 112.52506546432197, 6.3491601770455715, 37.52294760476411, 6.380306736274158, 19.910681627742864, 9.311636046599292, 50.90559851189778, 14.424184663894454, 12.269129998804734, 29.73703439817564, 49.98514588286018, 31.37709671441236, 42.13998671391003, 86.25429235748821, 40.35064636466825, 154.74785600428052, 43.453483537900425, 28.420743753831644, 65.70297125997784, 22.608881459353626, 79.87637473060718, 7.151956975440623, 14.907067900910686, 34.299256009248424, 23.2643604472881, 5.999872313276899, 25.73896145440041, 151.26542980057363, 46.05317628124883, 141.53541912738748, 33.31528298407921, 21.50353958366631, 13.968924577022213, 19.325560720234296, 35.23695881363119, 2.5635732171947696, 47.34506670473809, 38.719824600078475, 71.1644037544683, 49.18746092278328, 14.110533707614405, 29.241778068820075, 2.0142781784828396, 39.03174344857288, 76.85021997704291, 17.29796788658114, 17.20413007196915, 175.0031613652955, 65.2100210878986, 77.30765972170187, 25.463649823545992, 23.34182932959022, 11.323461392368273, 22.51024600130142, 19.124186659100655, 3.8911875169827814, 1.05289477557743, 100.79125370024808, 160.04318568008705, 22.503935346020235, 130.83346566857875, 4.505892519794192, 3.930974235422826, 9.28888076038532, 13.651633369895857, 23.637656491511034, 6.616083863565666, 116.19503829990414, 43.230718961429424, 95.0232066891283, 76.66975897256634, 80.97539945016017, 27.14869731075277, 26.079996232549007, 26.607946381584878, 56.340929019351876, 2.0500553393291185, 28.619363710512935, 39.17661864408146, 23.745351081178264, 2.964200516538277, 0.0, 16.582658688070136, 58.855357601685725, 55.11586435135972, 86.0283118125603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.873478918090459, "mean_inference_ms": 3.7633033419034145, "mean_action_processing_ms": 1.8538455978445625, "mean_env_wait_ms": 1.1559720248417833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005279898643493652, "StateBufferConnector_ms": 0.013324856758117676, "ViewRequirementAgentConnector_ms": 0.11304628849029541}, "num_episodes": 64, "episode_return_max": 192.499999999999, "episode_return_min": -45.62819424798025, "episode_return_mean": 64.6495244633021, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 250.40958387842153, "num_env_steps_trained_throughput_per_sec": 250.40958387842153, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 32327.105, "restore_workers_time_ms": 0.035, "training_step_time_ms": 32326.48, "sample_time_ms": 1365.472, "learn_time_ms": 30930.921, "learn_throughput": 258.641, "synch_weights_time_ms": 24.422}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 46, "trial_id": "cd905_00000", "date": "2024-08-20_09-49-07", "timestamp": 1724127547, "time_this_iter_s": 31.995711088180542, "time_total_s": 1504.7661974430084, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afbd5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1504.7661974430084, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 32.10217391304348, "ram_util_percent": 81.86304347826085}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7613405021528403, "cur_kl_coeff": 2.5749206542968747e-06, "cur_lr": 0.0001, "total_loss": 1.757717910267058, "policy_loss": -0.0005172032134843961, "vf_loss": 1.7582351154751248, "vf_explained_var": -0.017233669757843018, "kl": 0.004280737599268804, "entropy": 1.4221635960397265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3635338410675999, "cur_kl_coeff": 1.7881393432617187e-08, "cur_lr": 0.0001, "total_loss": 1.3740022056632573, "policy_loss": -0.0005968303415953876, "vf_loss": 1.3745990334995208, "vf_explained_var": 0.00021041537088061136, "kl": 0.0015779556972495537, "entropy": 1.2505522983414785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 136.69999999999862, "episode_reward_min": -207.72610706761574, "episode_reward_mean": 53.59696075139131, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -419.16634144934346, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 85.13579948346134, "predator_policy": 530.7777160402446}, "policy_reward_mean": {"prey_policy": -14.368362022077383, "predator_policy": 41.16684239777309}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5000000000004, 82.29999999999913, 25.919262725860854, 83.28551341803653, 32.40000000000019, 136.69999999999862, 38.50000000000028, 76.36182845903835, 40.18993340711516, 24.718029107161723, 38.70000000000028, 39.7000000000003, 126.29999999999842, 76.19999999999952, 70.09999999999994, 36.40000000000025, 67.50000000000021, 53.50000000000036, 41.10000000000034, 34.70000000000022, 53.300000000000374, 77.59999999999931, 78.29999999999943, 87.29999999999875, 34.50000000000022, 135.09999999999891, 79.49999999999919, 43.20000000000038, 36.200000000000244, 97.32007357393574, 96.49999999999858, 59.40000000000046, 37.000000000000256, 12.425426739703548, 73.81521095569556, 84.49999999999895, 81.17209235943082, 44.94832341937231, 70.39039494853732, 66.30000000000024, 21.67175005953489, 59.78449924642893, 39.30000000000029, 51.841524768181216, 65.61658224793706, 55.18487355562443, 48.50000000000045, 86.59999999999883, -123.80369034970406, 54.50000000000049, 55.30000000000038, 61.405982436601334, 39.20158603879026, 53.200000000000365, 20.65528238948655, 35.500000000000234, 84.69092195250298, 50.300000000000466, 57.196488542697814, 72.97276014956964, 33.4539175742304, 33.69976937272159, 33.83333691713782, 27.573458274010456, 116.76334409507763, 48.50000000000045, 40.0000000000003, -207.72610706761574, 114.29265528151353, 33.16101870115983, -9.58898883408506, 37.78368180914788, 65.8322107917557, 34.90000000000023, 71.3999999999999, 64.73463197816801, 72.89999999999985, 57.10000000000049, 37.20000000000028, 63.70000000000049, 51.70182157071339, 92.8999999999984, 75.97449685500396, 59.100000000000485, 30.914833135120592, 77.84207245827704, 37.90000000000027, 69.99999999999999, 39.90000000000029, 82.56760207385894, 37.767960677628515, 40.700000000000315, 14.08984329161867, 78.29999999999941, 54.2010778200862, 70.7, 106.30377198736386, 57.300000000000466, 66.40000000000026, 37.155016224701356], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-5.815282984079143, -3.503539583666274, 4.831075422977754, 44.17443927976589, 5.626212907091974, -17.50748221205695, -10.166527587193718, 7.387149700414671, -55.46440375446858, -32.48746092278306, 60.381830727052844, 32.96585749651302, 17.785721821517146, -20.331743448572617, -32.53150099141798, 14.745141586832947, -69.2711143121321, -82.74624371801885, -103.13034604880978, -14.66930565362972, -5.163649823545926, -4.9418293295901545, 7.476538607631696, -1.6102460013014124, 42.475813340899535, 60.80881248301743, 61.14710522442277, -86.79125370024882, -147.34318568008777, 34.896064653979955, -114.03346566857971, 15.094107480205773, 15.669025764577137, 38.61111923961491, 16.971972044046076, -0.7612619054529829, 12.6839161364343, -94.39503829990493, -38.24764099671098, -65.3062846538473, -82.00775767968412, -22.337400743042764, 25.072268239975422, -0.7009617832770249, 34.69205361841532, -39.340929019351634, 66.34994466067087, -9.719363710512779, -22.676618644081223, -5.745351081178191, 85.13579948346134, 47.000000000000206, 45.41734131192997, -41.355357601685505, -25.61586435135949, -72.32831181256103, 3.7521622889525705, -32.42890672507099, 3.988770255705663, 11.871526888889974, -29.69142954035278, 69.88438744946097, 10.835691462600161, -13.523058441584, -11.749613379011022, -5.198148258895587, -165.23697464714093, -41.670995744775986, -70.08905388273033, 0.5407007510575721, 57.90618275832249, -58.94940165426606, 38.239677235922734, 10.623000558941328, 18.23174953138373, -14.839098903488434, 37.5354848715607, 0.6927431608477296, -9.317913705235453, -19.727744346687857, -48.38900865000949, -78.04231442089954, -12.129664009839486, -23.09300966741563, 16.28177784106495, 15.22910164283036, -14.90298230420064, 13.227985936962401, 18.96415558407272, -12.195047132623541, 34.4848735556242, -45.10967870625081, -0.5736126801504745, 5.745109023509368, 46.09270502408591, -14.132989199008419, -178.37181829510806, -255.77982069659836, 22.222295250755206, -0.7976708834975009, -46.83493556431475, -12.893848521279544, -19.407700374540504, 7.458291132132312, 4.068726807402511, -59.60443159636452, -47.457898813137575, 18.326608513565592, -27.196630878398175, -60.255735637116615, -46.43521950104411, -45.21981691279879, -37.967761457553955, 29.093763218891414, 17.88116764371264, -19.95956004405371, 25.208329198098685, -19.084047292340628, 4.473752656800677, 2.468656119199128, -19.14775442612676, -7.691285798459894, 12.549026175476213, -60.80978302795736, -13.070823124180766, -31.009758623535575, -7.281904225634282, -41.86726175088032, 14.316283200606161, 64.58053652361953, -8.883978261782772, 16.09559552621975, 15.54897158852469, 14.953529362698939, -342.11983802204804, -419.16634144934346, 16.484527441399006, 61.373888191741905, -4.25809636448745, -38.13131927249634, -84.66461054034367, -45.282911413805984, 11.906239662209009, 1.8583088482420085, -91.59661575365833, -57.76615360994455, -22.880457648057686, -52.45336989037365, 18.44495163466641, -0.18230493407741796, 25.9365815050717, -0.01714949626803733, 51.55235309640508, 3.8575960569733256, -32.40090139926451, 29.6097874207948, -109.66978245674693, -7.366916346205528, 44.290758438083316, -8.209313315034926, -73.29972358437871, -10.679518971641592, 20.084291905016094, 61.92359577951759, 19.551180747226415, 0.4686607080540569, -4.846350212471766, 28.3920199550528, 4.817500784737472, -6.581085149428064, -24.642126507021004, 17.085693298717807, -4.885684511158093, 1.3272944346991877, -32.09986557834735, 46.96014471969664, 5.364978177031426, -0.6201901930060667, -14.313180321976285, 19.086288447008783, 6.491167028649475, -44.845780093793415, -16.75329887489898, 5.0079751544039475, -43.73341910013458, -38.052929599503024, -39.61866010041082, 43.9430533095572, -64.29463403564357, -1.9182090643585457, -9.81487056139055, 46.49138613064484, 23.749309392318324, -3.052136756988907, 11.782632982259, 15.366642063456661, -95.67377849153513, -5.229607398256814, -25.76856744932997, -4.697327823054582], "policy_predator_policy_reward": [33.31528298407921, 21.50353958366631, 13.968924577022213, 19.325560720234296, 35.23695881363119, 2.5635732171947696, 47.34506670473809, 38.719824600078475, 71.1644037544683, 49.18746092278328, 14.110533707614405, 29.241778068820075, 2.0142781784828396, 39.03174344857288, 76.85021997704291, 17.29796788658114, 17.20413007196915, 175.0031613652955, 65.2100210878986, 77.30765972170187, 25.463649823545992, 23.34182932959022, 11.323461392368273, 22.51024600130142, 19.124186659100655, 3.8911875169827814, 1.05289477557743, 100.79125370024808, 160.04318568008705, 22.503935346020235, 130.83346566857875, 4.505892519794192, 3.930974235422826, 9.28888076038532, 13.651633369895857, 23.637656491511034, 6.616083863565666, 116.19503829990414, 43.230718961429424, 95.0232066891283, 76.66975897256634, 80.97539945016017, 27.14869731075277, 26.079996232549007, 26.607946381584878, 56.340929019351876, 2.0500553393291185, 28.619363710512935, 39.17661864408146, 23.745351081178264, 2.964200516538277, 0.0, 16.582658688070136, 58.855357601685725, 55.11586435135972, 86.0283118125603, 23.03101664752157, 41.84572778859705, 31.21174387521304, 50.248032554128336, 47.39142954035303, 8.915612550538793, 9.597106415109444, 52.49026056387458, 30.44961337901121, 23.498148258895654, 194.44206007345284, 24.8913370581673, 80.65966513640872, 62.70389895095887, 10.893817241677691, 74.64940165426553, 27.57270494637373, 4.736709618194012, 7.066475341928881, 34.48919744954798, 15.703118929601036, 16.45904798652804, 57.71791370523553, 37.627744346688104, 22.862239275418226, 125.2408338550252, 32.70027799846572, 62.3068949252183, 3.4182221589350155, 4.370898357169605, 13.913327329195557, 39.603193806223615, 13.715931519378467, 45.13154227710927, 0.0, 65.80967870625103, 19.71170703150565, 23.61679662513542, 22.407294975914276, 32.23298919900864, 12.51240518430733, 297.83554345769755, 2.87770474924484, 30.19767088349749, 83.83493556431493, 31.193848521279747, 30.140730244942702, 43.214661434066564, 49.84594320525872, 44.89134762249255, 62.45789881313779, 19.87339148643443, 64.83668280872818, 43.27096609627279, 63.335219501044335, 63.819816912799055, 2.9469261590732447, 90.61799403209369, 37.02540453978486, 15.352987860556423, 13.988159344598808, 37.084047292340884, 7.185075262391088, 58.84527611117892, 29.87104634677694, 30.421911452040277, 0.0, 81.96052622520197, 16.54430289886011, 61.369615765994084, 47.29035361899241, 29.43227063153279, 23.144594272421262, 14.721930098432344, 10.093051840426437, 31.195330895136635, 4.851028411475274, 4.646470637301025, 530.7777160402446, 22.782356363531257, 6.228877243747229, 30.20536240462719, 22.39095259260858, 53.159481745535096, 35.01913356445399, 85.33939955560976, 17.103980190452898, 6.9151531082436435, 2.0759599061898077, 213.11902024916833, 87.1395773146556, 23.094250223776044, 14.421127167073207, 38.716226132337795, 6.8980504730959895, 31.91714949626801, 2.447646903595145, 15.04240394302664, 50.50090139926477, 9.390212579205382, 76.77074161890687, 77.46595718404492, 0.8092415619169183, 26.809313315035045, 103.55470758093784, 32.126356545794856, 8.115708094983923, 2.7764042204826165, 38.513436812196815, 17.441218587527047, 23.146350212471827, 12.407980044947362, 6.476280919247787, 26.202136580563277, 73.14153653394233, 12.256969132638641, 23.985684511158166, 17.472705565300792, 50.199865578347605, 4.939855280303545, 8.87942718180296, 26.27578483417166, 53.92648575832179, 23.868008190505705, 40.57129447595141, 35.55127926682097, 34.05329887489923, 18.39202484559604, 62.14056144367333, 33.735630547583256, 65.08542620144766, 8.8901805894064, 80.49205156949614, 39.92186935059079, 31.040064128227524, 2.9834203025185646, 37.55069060768178, 48.05590874435422, 17.781178010801128, 12.369546943483154, 9.731795905060357, 157.57158998473093, 29.18115362684228, 38.439757870243675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.86894186925408, "mean_inference_ms": 3.7526296648503985, "mean_action_processing_ms": 1.8458757940164943, "mean_env_wait_ms": 1.1537271421507453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006706953048706055, "StateBufferConnector_ms": 0.014066219329833984, "ViewRequirementAgentConnector_ms": 0.1072847843170166}, "num_episodes": 72, "episode_return_max": 136.69999999999862, "episode_return_min": -207.72610706761574, "episode_return_mean": 53.59696075139131, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 250.35165844982524, "num_env_steps_trained_throughput_per_sec": 250.35165844982524, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 32304.684, "restore_workers_time_ms": 0.035, "training_step_time_ms": 32304.164, "sample_time_ms": 1364.862, "learn_time_ms": 30908.215, "learn_throughput": 258.831, "synch_weights_time_ms": 24.793}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 47, "trial_id": "cd905_00000", "date": "2024-08-20_09-49-39", "timestamp": 1724127579, "time_this_iter_s": 32.00323295593262, "time_total_s": 1536.769430398941, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afc6310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1536.769430398941, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 35.577777777777776, "ram_util_percent": 81.64666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6892573003139761, "cur_kl_coeff": 1.2874603271484374e-06, "cur_lr": 0.0001, "total_loss": 3.218542694667029, "policy_loss": -0.0011628821510673753, "vf_loss": 3.219705570690216, "vf_explained_var": 0.0033914213142697772, "kl": 0.004406714457550223, "entropy": 1.3674249620664687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 29925.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.33177238567362705, "cur_kl_coeff": 8.940696716308593e-09, "cur_lr": 0.0001, "total_loss": 1.840478639943259, "policy_loss": -0.0018571807426356133, "vf_loss": 1.8423358188735115, "vf_explained_var": 1.6201677776518323e-05, "kl": 0.004206733230055054, "entropy": 1.3282883645996215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 29925.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 136.69999999999862, "episode_reward_min": -207.72610706761574, "episode_reward_mean": 53.59696075139131, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -419.16634144934346, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 85.13579948346134, "predator_policy": 530.7777160402446}, "policy_reward_mean": {"prey_policy": -14.368362022077383, "predator_policy": 41.16684239777309}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5000000000004, 82.29999999999913, 25.919262725860854, 83.28551341803653, 32.40000000000019, 136.69999999999862, 38.50000000000028, 76.36182845903835, 40.18993340711516, 24.718029107161723, 38.70000000000028, 39.7000000000003, 126.29999999999842, 76.19999999999952, 70.09999999999994, 36.40000000000025, 67.50000000000021, 53.50000000000036, 41.10000000000034, 34.70000000000022, 53.300000000000374, 77.59999999999931, 78.29999999999943, 87.29999999999875, 34.50000000000022, 135.09999999999891, 79.49999999999919, 43.20000000000038, 36.200000000000244, 97.32007357393574, 96.49999999999858, 59.40000000000046, 37.000000000000256, 12.425426739703548, 73.81521095569556, 84.49999999999895, 81.17209235943082, 44.94832341937231, 70.39039494853732, 66.30000000000024, 21.67175005953489, 59.78449924642893, 39.30000000000029, 51.841524768181216, 65.61658224793706, 55.18487355562443, 48.50000000000045, 86.59999999999883, -123.80369034970406, 54.50000000000049, 55.30000000000038, 61.405982436601334, 39.20158603879026, 53.200000000000365, 20.65528238948655, 35.500000000000234, 84.69092195250298, 50.300000000000466, 57.196488542697814, 72.97276014956964, 33.4539175742304, 33.69976937272159, 33.83333691713782, 27.573458274010456, 116.76334409507763, 48.50000000000045, 40.0000000000003, -207.72610706761574, 114.29265528151353, 33.16101870115983, -9.58898883408506, 37.78368180914788, 65.8322107917557, 34.90000000000023, 71.3999999999999, 64.73463197816801, 72.89999999999985, 57.10000000000049, 37.20000000000028, 63.70000000000049, 51.70182157071339, 92.8999999999984, 75.97449685500396, 59.100000000000485, 30.914833135120592, 77.84207245827704, 37.90000000000027, 69.99999999999999, 39.90000000000029, 82.56760207385894, 37.767960677628515, 40.700000000000315, 14.08984329161867, 78.29999999999941, 54.2010778200862, 70.7, 106.30377198736386, 57.300000000000466, 66.40000000000026, 37.155016224701356], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-5.815282984079143, -3.503539583666274, 4.831075422977754, 44.17443927976589, 5.626212907091974, -17.50748221205695, -10.166527587193718, 7.387149700414671, -55.46440375446858, -32.48746092278306, 60.381830727052844, 32.96585749651302, 17.785721821517146, -20.331743448572617, -32.53150099141798, 14.745141586832947, -69.2711143121321, -82.74624371801885, -103.13034604880978, -14.66930565362972, -5.163649823545926, -4.9418293295901545, 7.476538607631696, -1.6102460013014124, 42.475813340899535, 60.80881248301743, 61.14710522442277, -86.79125370024882, -147.34318568008777, 34.896064653979955, -114.03346566857971, 15.094107480205773, 15.669025764577137, 38.61111923961491, 16.971972044046076, -0.7612619054529829, 12.6839161364343, -94.39503829990493, -38.24764099671098, -65.3062846538473, -82.00775767968412, -22.337400743042764, 25.072268239975422, -0.7009617832770249, 34.69205361841532, -39.340929019351634, 66.34994466067087, -9.719363710512779, -22.676618644081223, -5.745351081178191, 85.13579948346134, 47.000000000000206, 45.41734131192997, -41.355357601685505, -25.61586435135949, -72.32831181256103, 3.7521622889525705, -32.42890672507099, 3.988770255705663, 11.871526888889974, -29.69142954035278, 69.88438744946097, 10.835691462600161, -13.523058441584, -11.749613379011022, -5.198148258895587, -165.23697464714093, -41.670995744775986, -70.08905388273033, 0.5407007510575721, 57.90618275832249, -58.94940165426606, 38.239677235922734, 10.623000558941328, 18.23174953138373, -14.839098903488434, 37.5354848715607, 0.6927431608477296, -9.317913705235453, -19.727744346687857, -48.38900865000949, -78.04231442089954, -12.129664009839486, -23.09300966741563, 16.28177784106495, 15.22910164283036, -14.90298230420064, 13.227985936962401, 18.96415558407272, -12.195047132623541, 34.4848735556242, -45.10967870625081, -0.5736126801504745, 5.745109023509368, 46.09270502408591, -14.132989199008419, -178.37181829510806, -255.77982069659836, 22.222295250755206, -0.7976708834975009, -46.83493556431475, -12.893848521279544, -19.407700374540504, 7.458291132132312, 4.068726807402511, -59.60443159636452, -47.457898813137575, 18.326608513565592, -27.196630878398175, -60.255735637116615, -46.43521950104411, -45.21981691279879, -37.967761457553955, 29.093763218891414, 17.88116764371264, -19.95956004405371, 25.208329198098685, -19.084047292340628, 4.473752656800677, 2.468656119199128, -19.14775442612676, -7.691285798459894, 12.549026175476213, -60.80978302795736, -13.070823124180766, -31.009758623535575, -7.281904225634282, -41.86726175088032, 14.316283200606161, 64.58053652361953, -8.883978261782772, 16.09559552621975, 15.54897158852469, 14.953529362698939, -342.11983802204804, -419.16634144934346, 16.484527441399006, 61.373888191741905, -4.25809636448745, -38.13131927249634, -84.66461054034367, -45.282911413805984, 11.906239662209009, 1.8583088482420085, -91.59661575365833, -57.76615360994455, -22.880457648057686, -52.45336989037365, 18.44495163466641, -0.18230493407741796, 25.9365815050717, -0.01714949626803733, 51.55235309640508, 3.8575960569733256, -32.40090139926451, 29.6097874207948, -109.66978245674693, -7.366916346205528, 44.290758438083316, -8.209313315034926, -73.29972358437871, -10.679518971641592, 20.084291905016094, 61.92359577951759, 19.551180747226415, 0.4686607080540569, -4.846350212471766, 28.3920199550528, 4.817500784737472, -6.581085149428064, -24.642126507021004, 17.085693298717807, -4.885684511158093, 1.3272944346991877, -32.09986557834735, 46.96014471969664, 5.364978177031426, -0.6201901930060667, -14.313180321976285, 19.086288447008783, 6.491167028649475, -44.845780093793415, -16.75329887489898, 5.0079751544039475, -43.73341910013458, -38.052929599503024, -39.61866010041082, 43.9430533095572, -64.29463403564357, -1.9182090643585457, -9.81487056139055, 46.49138613064484, 23.749309392318324, -3.052136756988907, 11.782632982259, 15.366642063456661, -95.67377849153513, -5.229607398256814, -25.76856744932997, -4.697327823054582], "policy_predator_policy_reward": [33.31528298407921, 21.50353958366631, 13.968924577022213, 19.325560720234296, 35.23695881363119, 2.5635732171947696, 47.34506670473809, 38.719824600078475, 71.1644037544683, 49.18746092278328, 14.110533707614405, 29.241778068820075, 2.0142781784828396, 39.03174344857288, 76.85021997704291, 17.29796788658114, 17.20413007196915, 175.0031613652955, 65.2100210878986, 77.30765972170187, 25.463649823545992, 23.34182932959022, 11.323461392368273, 22.51024600130142, 19.124186659100655, 3.8911875169827814, 1.05289477557743, 100.79125370024808, 160.04318568008705, 22.503935346020235, 130.83346566857875, 4.505892519794192, 3.930974235422826, 9.28888076038532, 13.651633369895857, 23.637656491511034, 6.616083863565666, 116.19503829990414, 43.230718961429424, 95.0232066891283, 76.66975897256634, 80.97539945016017, 27.14869731075277, 26.079996232549007, 26.607946381584878, 56.340929019351876, 2.0500553393291185, 28.619363710512935, 39.17661864408146, 23.745351081178264, 2.964200516538277, 0.0, 16.582658688070136, 58.855357601685725, 55.11586435135972, 86.0283118125603, 23.03101664752157, 41.84572778859705, 31.21174387521304, 50.248032554128336, 47.39142954035303, 8.915612550538793, 9.597106415109444, 52.49026056387458, 30.44961337901121, 23.498148258895654, 194.44206007345284, 24.8913370581673, 80.65966513640872, 62.70389895095887, 10.893817241677691, 74.64940165426553, 27.57270494637373, 4.736709618194012, 7.066475341928881, 34.48919744954798, 15.703118929601036, 16.45904798652804, 57.71791370523553, 37.627744346688104, 22.862239275418226, 125.2408338550252, 32.70027799846572, 62.3068949252183, 3.4182221589350155, 4.370898357169605, 13.913327329195557, 39.603193806223615, 13.715931519378467, 45.13154227710927, 0.0, 65.80967870625103, 19.71170703150565, 23.61679662513542, 22.407294975914276, 32.23298919900864, 12.51240518430733, 297.83554345769755, 2.87770474924484, 30.19767088349749, 83.83493556431493, 31.193848521279747, 30.140730244942702, 43.214661434066564, 49.84594320525872, 44.89134762249255, 62.45789881313779, 19.87339148643443, 64.83668280872818, 43.27096609627279, 63.335219501044335, 63.819816912799055, 2.9469261590732447, 90.61799403209369, 37.02540453978486, 15.352987860556423, 13.988159344598808, 37.084047292340884, 7.185075262391088, 58.84527611117892, 29.87104634677694, 30.421911452040277, 0.0, 81.96052622520197, 16.54430289886011, 61.369615765994084, 47.29035361899241, 29.43227063153279, 23.144594272421262, 14.721930098432344, 10.093051840426437, 31.195330895136635, 4.851028411475274, 4.646470637301025, 530.7777160402446, 22.782356363531257, 6.228877243747229, 30.20536240462719, 22.39095259260858, 53.159481745535096, 35.01913356445399, 85.33939955560976, 17.103980190452898, 6.9151531082436435, 2.0759599061898077, 213.11902024916833, 87.1395773146556, 23.094250223776044, 14.421127167073207, 38.716226132337795, 6.8980504730959895, 31.91714949626801, 2.447646903595145, 15.04240394302664, 50.50090139926477, 9.390212579205382, 76.77074161890687, 77.46595718404492, 0.8092415619169183, 26.809313315035045, 103.55470758093784, 32.126356545794856, 8.115708094983923, 2.7764042204826165, 38.513436812196815, 17.441218587527047, 23.146350212471827, 12.407980044947362, 6.476280919247787, 26.202136580563277, 73.14153653394233, 12.256969132638641, 23.985684511158166, 17.472705565300792, 50.199865578347605, 4.939855280303545, 8.87942718180296, 26.27578483417166, 53.92648575832179, 23.868008190505705, 40.57129447595141, 35.55127926682097, 34.05329887489923, 18.39202484559604, 62.14056144367333, 33.735630547583256, 65.08542620144766, 8.8901805894064, 80.49205156949614, 39.92186935059079, 31.040064128227524, 2.9834203025185646, 37.55069060768178, 48.05590874435422, 17.781178010801128, 12.369546943483154, 9.731795905060357, 157.57158998473093, 29.18115362684228, 38.439757870243675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.86894186925408, "mean_inference_ms": 3.7526296648503985, "mean_action_processing_ms": 1.8458757940164943, "mean_env_wait_ms": 1.1537271421507453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006706953048706055, "StateBufferConnector_ms": 0.014066219329833984, "ViewRequirementAgentConnector_ms": 0.1072847843170166}, "num_episodes": 0, "episode_return_max": 136.69999999999862, "episode_return_min": -207.72610706761574, "episode_return_mean": 53.59696075139131, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 249.9717375552848, "num_env_steps_trained_throughput_per_sec": 249.9717375552848, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 32264.942, "restore_workers_time_ms": 0.035, "training_step_time_ms": 32264.259, "sample_time_ms": 1359.322, "learn_time_ms": 30873.608, "learn_throughput": 259.121, "synch_weights_time_ms": 24.817}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 48, "trial_id": "cd905_00000", "date": "2024-08-20_09-50-11", "timestamp": 1724127611, "time_this_iter_s": 32.02772808074951, "time_total_s": 1568.7971584796906, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16affac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1568.7971584796906, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 33.59111111111111, "ram_util_percent": 82.16222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6847304748873861, "cur_kl_coeff": 6.437301635742187e-07, "cur_lr": 0.0001, "total_loss": 3.8434951774657717, "policy_loss": -0.0007115444109316856, "vf_loss": 3.844206718036107, "vf_explained_var": 0.002180843126206171, "kl": 0.003762877300467817, "entropy": 1.3573291937510172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 30555.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.37380108768859555, "cur_kl_coeff": 4.470348358154297e-09, "cur_lr": 0.0001, "total_loss": 2.4916899981952847, "policy_loss": -0.0022629502303307017, "vf_loss": 2.49395295892443, "vf_explained_var": 2.8469638218955388e-05, "kl": 0.0037151168443398004, "entropy": 1.3244226911711314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 30555.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 106.30377198736386, "episode_reward_min": -433.9092345939612, "episode_reward_mean": 18.77758409504711, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -827.6619866399564, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 61.92359577951759, "predator_policy": 937.6436101252351}, "policy_reward_mean": {"prey_policy": -56.78549893808744, "predator_policy": 66.17429098561094}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.8322107917557, 34.90000000000023, 71.3999999999999, 64.73463197816801, 72.89999999999985, 57.10000000000049, 37.20000000000028, 63.70000000000049, 51.70182157071339, 92.8999999999984, 75.97449685500396, 59.100000000000485, 30.914833135120592, 77.84207245827704, 37.90000000000027, 69.99999999999999, 39.90000000000029, 82.56760207385894, 37.767960677628515, 40.700000000000315, 14.08984329161867, 78.29999999999941, 54.2010778200862, 70.7, 106.30377198736386, 57.300000000000466, 66.40000000000026, 37.155016224701356, 46.900000000000404, -202.9465527504792, 31.27085256906468, 47.600000000000335, 37.473046346109, 45.000000000000384, 68.4827082546413, 53.60000000000047, 55.20000000000044, 34.00000000000021, -14.111349823368732, 84.95912670855986, 37.30000000000026, 81.29801194042615, 36.058333374725706, 54.70000000000043, -225.7336825400725, 52.20000000000049, 53.900000000000496, 38.0898089404595, -58.182098753417485, 26.673104214190303, 64.90000000000033, 68.40000000000013, 58.19727509896323, -14.161667293031407, 64.60000000000039, 81.39999999999924, 26.633386445661998, 38.068294721389336, 38.00000000000027, 37.477635035634584, 57.90000000000043, 48.30000000000045, 45.1000000000004, 44.60993337490495, -59.132448040232575, 38.20000000000027, 55.499752900908355, 92.8999999999986, 65.28034820691092, -182.6163048709457, 72.8999999999998, -301.80859838711507, 57.66144749855348, 27.26446609406746, -8.134713919282872, -44.54764945911786, 38.70000000000028, -323.3138433631086, -303.38894822645665, -433.9092345939612, 71.74610280231036, 11.737487792978314, 22.37872485501827, 84.73724600247468, -27.278284938926763, 103.13817838098518, -4.257430199226408, -180.47032127649467, -46.196335186457155, 8.903379934833247, 68.30000000000018, -64.72166031072081, 34.20092685272562, -14.363526116402008, 43.30000000000037, 34.60000000000022, 38.80814234272946, 66.1000000000003, 80.79999999999924, 62.10000000000043], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-91.59661575365833, -57.76615360994455, -22.880457648057686, -52.45336989037365, 18.44495163466641, -0.18230493407741796, 25.9365815050717, -0.01714949626803733, 51.55235309640508, 3.8575960569733256, -32.40090139926451, 29.6097874207948, -109.66978245674693, -7.366916346205528, 44.290758438083316, -8.209313315034926, -73.29972358437871, -10.679518971641592, 20.084291905016094, 61.92359577951759, 19.551180747226415, 0.4686607080540569, -4.846350212471766, 28.3920199550528, 4.817500784737472, -6.581085149428064, -24.642126507021004, 17.085693298717807, -4.885684511158093, 1.3272944346991877, -32.09986557834735, 46.96014471969664, 5.364978177031426, -0.6201901930060667, -14.313180321976285, 19.086288447008783, 6.491167028649475, -44.845780093793415, -16.75329887489898, 5.0079751544039475, -43.73341910013458, -38.052929599503024, -39.61866010041082, 43.9430533095572, -64.29463403564357, -1.9182090643585457, -9.81487056139055, 46.49138613064484, 23.749309392318324, -3.052136756988907, 11.782632982259, 15.366642063456661, -95.67377849153513, -5.229607398256814, -25.76856744932997, -4.697327823054582, -64.54776088443376, -64.8482705851937, -303.1892095485997, -299.75836224343357, -28.930175958325044, -37.5289401728107, -134.07437992583672, -81.64852501488664, -8.540159689299339, 5.457602708593321, 4.385728467102469, -0.9775359822134023, 20.000000000000014, 30.32998255816703, 17.834636606659224, -0.6178250757522146, -8.148981273230719, -15.86114567549858, -54.929989357808104, 0.7366032220146845, -103.88210083116981, -62.080360443504865, 44.889507494551616, -41.36813905312941, -1.587860832936625, -3.1354670907740725, -3.2844728941438994, 12.551076868580637, -23.685600647342888, 17.85748582321494, 11.323493486085466, -0.9459713543622558, -378.34951469876665, -294.5832433077928, 26.21652336918423, 11.202937286129766, 21.28302171341518, -25.684949355449, -0.8973362825508071, -8.013366125680786, -114.26504428714958, -246.93761082590962, -186.01410207522886, -1.1480623943475168, -3.0069281747075287, -29.817097030017315, 31.722916015452356, -45.04964391339234, 31.672831848598722, -59.523063113763705, -360.0464927070138, -63.9528941776642, -69.5306938028977, 20.573268562729403, 47.84440579886754, 13.394043017413226, -76.01902265975457, -91.30679826734675, 10.074282299888528, 18.768294721389065, 13.850934387661868, -28.160671799315814, 13.927431198064193, -51.26328352960202, -27.353416795899044, 17.435353260771432, -38.8067520557351, -19.60872105661366, -4.333766748100439, -25.189785019778725, -4.374683596704282, 3.1811729425852326, -176.4384796507733, -500.5582515546202, 6.70324151697452, -0.7295875593271627, 27.99498012463707, -15.590233063039905, 30.154256341953936, 31.167237536153486, 27.100249881522263, -51.59616638169603, -377.5420374619529, -313.37871995375076, 19.43483068994836, 17.089002866519454, -427.8292026127112, -396.82360661887986, 22.1403478605914, -21.08202207206034, -6.575882735942989, -98.05151227256266, -184.87452680743667, -43.19436085906986, -121.76060064584507, -79.31659295515853, -6.800986584551218, 17.633051810257296, -454.67735513025576, -413.3738751713354, -392.8810029494448, -509.26291586358525, -562.6177018721952, -827.6619866399564, -58.83667380015238, 53.99027083531649, -66.17055031999594, -62.9668318023764, -30.845687334596107, -55.44444088457725, 16.334064140609463, 43.49884465377337, -40.05551453793953, -172.80005215894926, 51.921255106170015, 31.160183179862976, -87.24861924642003, -284.0553562231326, -225.73717966722475, -258.7149281925965, -129.8056470773201, -69.37845439353204, -21.573929053389843, -27.25056298664787, 47.50921704997472, 1.022915334264668, -121.35425861097046, -166.28691239069744, -115.72714787246429, -35.38198279948027, -99.71299586745614, -104.72909234096264, 11.11735073871731, -18.20340497768869, 6.900824002442761, -89.89773477487984, -23.18708817157001, -12.338436095366886, 11.930273113390871, 23.834515904787782, 42.27044080087906, 15.388044582924458, 12.319328451553016, -18.72071440710851], "policy_predator_policy_reward": [2.0759599061898077, 213.11902024916833, 87.1395773146556, 23.094250223776044, 14.421127167073207, 38.716226132337795, 6.8980504730959895, 31.91714949626801, 2.447646903595145, 15.04240394302664, 50.50090139926477, 9.390212579205382, 76.77074161890687, 77.46595718404492, 0.8092415619169183, 26.809313315035045, 103.55470758093784, 32.126356545794856, 8.115708094983923, 2.7764042204826165, 38.513436812196815, 17.441218587527047, 23.146350212471827, 12.407980044947362, 6.476280919247787, 26.202136580563277, 73.14153653394233, 12.256969132638641, 23.985684511158166, 17.472705565300792, 50.199865578347605, 4.939855280303545, 8.87942718180296, 26.27578483417166, 53.92648575832179, 23.868008190505705, 40.57129447595141, 35.55127926682097, 34.05329887489923, 18.39202484559604, 62.14056144367333, 33.735630547583256, 65.08542620144766, 8.8901805894064, 80.49205156949614, 39.92186935059079, 31.040064128227524, 2.9834203025185646, 37.55069060768178, 48.05590874435422, 17.781178010801128, 12.369546943483154, 9.731795905060357, 157.57158998473093, 29.18115362684228, 38.439757870243675, 23.40745840559266, 152.88857306403312, 68.20781149984967, 331.793207541704, 1.1841714723081498, 96.54579722789255, 161.66418525817662, 101.65871968254521, 2.8054307161731726, 37.75017261064142, 14.314271532897498, 27.277535982213408, 15.579667815110746, 2.573057881363561, 16.665363393340762, 19.717825075752227, 27.455421422537874, 51.754705526191756, 70.2299893578079, 17.963396777985302, 138.88639419789686, 12.96471725340884, 12.656651744700206, 68.78110652243896, 20.08786083293663, 21.935467090774114, 48.45207142037968, 23.579336545610474, 40.98560064734313, 0.9008475515105068, 22.176506513914546, 22.14597135436226, 20.43183154097541, 426.76724392551165, 5.883476630815888, 8.897062713870202, 12.316978286584852, 45.984949355449245, 2.4947980100813663, 44.50571333860944, 265.738702520356, 37.281853839285176, 199.4141020752291, 14.421166608537362, 26.559634241940724, 71.16439096278427, 19.077083984547855, 62.64964391339259, 1.6523423435786353, 84.39516402054906, 380.7770774564923, 29.06064213515451, 86.53069380289676, 27.026731437270627, 3.3555942011326856, 16.805956982586746, 113.72756020197195, 80.23164717078959, 0.0, 9.225717700111435, 5.649065612338098, 46.66067179931608, 69.36328352960196, 5.450203837570092, 45.70242485292321, 22.11563868220464, 56.40675205573535, 50.3087210566139, 20.380138933052933, 54.24341283482649, 23.103960761482206, 22.69948326754141, 4.850873242975214, 613.0134099221866, 12.496758483025445, 19.729587559327165, 35.896523398863074, 7.198482440448001, 30.580025428261134, 0.9984806936318191, 62.00921558149725, 27.7670491255871, 469.1133682776363, 39.191084267120786, 2.165169310051649, 34.21099713348052, 39.76292464912744, 483.08128619534864, 51.73474965795815, 4.868372052064093, 15.282002073271808, 116.60985902930022, 200.54512802873873, 19.389045718484518, 4.827607598791933, 151.70193654309352, 25.70098658455131, 2.1669481897426883, 493.92621362130745, 50.81117331717525, 49.79720853173337, 548.9577620548399, 18.726843792956004, 937.6436101252351, 74.08143746436183, 2.5110683027843246, 38.66725325238904, 102.20761666296158, 107.0177274246981, 1.6511256494932682, 4.087356784254973, 20.816980423838103, 67.55960618660043, 118.017675571361, 2.313769370000477, 17.742970724953903, 310.9567364627708, 56.08980880755574, 281.74381318900265, 22.237973394323483, 4.496260839817565, 148.49150544457612, 41.74149981133836, 15.986372163532408, 1.990782950025508, 17.777084665735316, 211.69006149205867, 11.229449198888386, 42.637045852859735, 142.6730116718096, 167.0904793543605, 22.98808273765607, 8.282649261282655, 42.103404977688946, 97.70696138719873, 19.889949385237557, 39.69663428936512, 34.637032320301415, 7.469726886609097, 22.865484095212302, 18.829559199121135, 4.311955417075506, 7.080671548446949, 61.42071440710872]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.8497532921202255, "mean_inference_ms": 3.7365750897477845, "mean_action_processing_ms": 1.8332452667647374, "mean_env_wait_ms": 1.1476174638636218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004787087440490723, "StateBufferConnector_ms": 0.028649330139160156, "ViewRequirementAgentConnector_ms": 0.10613703727722168}, "num_episodes": 72, "episode_return_max": 106.30377198736386, "episode_return_min": -433.9092345939612, "episode_return_mean": 18.77758409504711, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 250.17281265670547, "num_env_steps_trained_throughput_per_sec": 250.17281265670547, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 32296.286, "restore_workers_time_ms": 0.035, "training_step_time_ms": 32295.539, "sample_time_ms": 1364.452, "learn_time_ms": 30900.902, "learn_throughput": 258.892, "synch_weights_time_ms": 23.948}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 49, "trial_id": "cd905_00000", "date": "2024-08-20_09-50-43", "timestamp": 1724127643, "time_this_iter_s": 32.02373480796814, "time_total_s": 1600.8208932876587, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f6bca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1600.8208932876587, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 30.90434782608696, "ram_util_percent": 81.6608695652174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7197157245365873, "cur_kl_coeff": 3.2186508178710934e-07, "cur_lr": 0.0001, "total_loss": 5.642284009570167, "policy_loss": -0.0015905526363187367, "vf_loss": 5.643874577870444, "vf_explained_var": -0.0021199682402232335, "kl": 0.007111688617713673, "entropy": 1.370661204958719, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3909201493457196, "cur_kl_coeff": 2.2351741790771484e-09, "cur_lr": 0.0001, "total_loss": 3.826828269731431, "policy_loss": -0.002268031800520562, "vf_loss": 3.8290963063164365, "vf_explained_var": 0.0004962113168504503, "kl": 0.006580831557022023, "entropy": 1.3721098337854658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 106.30377198736386, "episode_reward_min": -539.6903196466676, "episode_reward_mean": 5.754410842546629, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -827.6619866399564, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 61.92359577951759, "predator_policy": 948.9336646140904}, "policy_reward_mean": {"prey_policy": -77.44821176428783, "predator_policy": 80.32541718556111}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.70182157071339, 92.8999999999984, 75.97449685500396, 59.100000000000485, 30.914833135120592, 77.84207245827704, 37.90000000000027, 69.99999999999999, 39.90000000000029, 82.56760207385894, 37.767960677628515, 40.700000000000315, 14.08984329161867, 78.29999999999941, 54.2010778200862, 70.7, 106.30377198736386, 57.300000000000466, 66.40000000000026, 37.155016224701356, 46.900000000000404, -202.9465527504792, 31.27085256906468, 47.600000000000335, 37.473046346109, 45.000000000000384, 68.4827082546413, 53.60000000000047, 55.20000000000044, 34.00000000000021, -14.111349823368732, 84.95912670855986, 37.30000000000026, 81.29801194042615, 36.058333374725706, 54.70000000000043, -225.7336825400725, 52.20000000000049, 53.900000000000496, 38.0898089404595, -58.182098753417485, 26.673104214190303, 64.90000000000033, 68.40000000000013, 58.19727509896323, -14.161667293031407, 64.60000000000039, 81.39999999999924, 26.633386445661998, 38.068294721389336, 38.00000000000027, 37.477635035634584, 57.90000000000043, 48.30000000000045, 45.1000000000004, 44.60993337490495, -59.132448040232575, 38.20000000000027, 55.499752900908355, 92.8999999999986, 65.28034820691092, -182.6163048709457, 72.8999999999998, -301.80859838711507, 57.66144749855348, 27.26446609406746, -8.134713919282872, -44.54764945911786, 38.70000000000028, -323.3138433631086, -303.38894822645665, -433.9092345939612, 71.74610280231036, 11.737487792978314, 22.37872485501827, 84.73724600247468, -27.278284938926763, 103.13817838098518, -4.257430199226408, -180.47032127649467, -46.196335186457155, 8.903379934833247, 68.30000000000018, -64.72166031072081, 34.20092685272562, -14.363526116402008, 43.30000000000037, 34.60000000000022, 38.80814234272946, 66.1000000000003, 80.79999999999924, 62.10000000000043, 55.30000000000044, -539.6903196466676, 52.24171958218403, 25.25218869635102, 50.91080371572248, 40.2097037539166, -176.66752982074004, -342.10704876089], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-73.29972358437871, -10.679518971641592, 20.084291905016094, 61.92359577951759, 19.551180747226415, 0.4686607080540569, -4.846350212471766, 28.3920199550528, 4.817500784737472, -6.581085149428064, -24.642126507021004, 17.085693298717807, -4.885684511158093, 1.3272944346991877, -32.09986557834735, 46.96014471969664, 5.364978177031426, -0.6201901930060667, -14.313180321976285, 19.086288447008783, 6.491167028649475, -44.845780093793415, -16.75329887489898, 5.0079751544039475, -43.73341910013458, -38.052929599503024, -39.61866010041082, 43.9430533095572, -64.29463403564357, -1.9182090643585457, -9.81487056139055, 46.49138613064484, 23.749309392318324, -3.052136756988907, 11.782632982259, 15.366642063456661, -95.67377849153513, -5.229607398256814, -25.76856744932997, -4.697327823054582, -64.54776088443376, -64.8482705851937, -303.1892095485997, -299.75836224343357, -28.930175958325044, -37.5289401728107, -134.07437992583672, -81.64852501488664, -8.540159689299339, 5.457602708593321, 4.385728467102469, -0.9775359822134023, 20.000000000000014, 30.32998255816703, 17.834636606659224, -0.6178250757522146, -8.148981273230719, -15.86114567549858, -54.929989357808104, 0.7366032220146845, -103.88210083116981, -62.080360443504865, 44.889507494551616, -41.36813905312941, -1.587860832936625, -3.1354670907740725, -3.2844728941438994, 12.551076868580637, -23.685600647342888, 17.85748582321494, 11.323493486085466, -0.9459713543622558, -378.34951469876665, -294.5832433077928, 26.21652336918423, 11.202937286129766, 21.28302171341518, -25.684949355449, -0.8973362825508071, -8.013366125680786, -114.26504428714958, -246.93761082590962, -186.01410207522886, -1.1480623943475168, -3.0069281747075287, -29.817097030017315, 31.722916015452356, -45.04964391339234, 31.672831848598722, -59.523063113763705, -360.0464927070138, -63.9528941776642, -69.5306938028977, 20.573268562729403, 47.84440579886754, 13.394043017413226, -76.01902265975457, -91.30679826734675, 10.074282299888528, 18.768294721389065, 13.850934387661868, -28.160671799315814, 13.927431198064193, -51.26328352960202, -27.353416795899044, 17.435353260771432, -38.8067520557351, -19.60872105661366, -4.333766748100439, -25.189785019778725, -4.374683596704282, 3.1811729425852326, -176.4384796507733, -500.5582515546202, 6.70324151697452, -0.7295875593271627, 27.99498012463707, -15.590233063039905, 30.154256341953936, 31.167237536153486, 27.100249881522263, -51.59616638169603, -377.5420374619529, -313.37871995375076, 19.43483068994836, 17.089002866519454, -427.8292026127112, -396.82360661887986, 22.1403478605914, -21.08202207206034, -6.575882735942989, -98.05151227256266, -184.87452680743667, -43.19436085906986, -121.76060064584507, -79.31659295515853, -6.800986584551218, 17.633051810257296, -454.67735513025576, -413.3738751713354, -392.8810029494448, -509.26291586358525, -562.6177018721952, -827.6619866399564, -58.83667380015238, 53.99027083531649, -66.17055031999594, -62.9668318023764, -30.845687334596107, -55.44444088457725, 16.334064140609463, 43.49884465377337, -40.05551453793953, -172.80005215894926, 51.921255106170015, 31.160183179862976, -87.24861924642003, -284.0553562231326, -225.73717966722475, -258.7149281925965, -129.8056470773201, -69.37845439353204, -21.573929053389843, -27.25056298664787, 47.50921704997472, 1.022915334264668, -121.35425861097046, -166.28691239069744, -115.72714787246429, -35.38198279948027, -99.71299586745614, -104.72909234096264, 11.11735073871731, -18.20340497768869, 6.900824002442761, -89.89773477487984, -23.18708817157001, -12.338436095366886, 11.930273113390871, 23.834515904787782, 42.27044080087906, 15.388044582924458, 12.319328451553016, -18.72071440710851, -20.156342991906328, 5.405171124268035, -715.4519825396198, -814.6033991871868, -171.19454552140218, -612.7727568874027, -226.50883409134275, -14.330764270180147, 17.68607856889595, 13.81369713678035, -39.62425684909668, 3.5115625881561043, -441.3024642127289, -388.3397730667325, -482.12249189992184, -455.40239983829736], "policy_predator_policy_reward": [103.55470758093784, 32.126356545794856, 8.115708094983923, 2.7764042204826165, 38.513436812196815, 17.441218587527047, 23.146350212471827, 12.407980044947362, 6.476280919247787, 26.202136580563277, 73.14153653394233, 12.256969132638641, 23.985684511158166, 17.472705565300792, 50.199865578347605, 4.939855280303545, 8.87942718180296, 26.27578483417166, 53.92648575832179, 23.868008190505705, 40.57129447595141, 35.55127926682097, 34.05329887489923, 18.39202484559604, 62.14056144367333, 33.735630547583256, 65.08542620144766, 8.8901805894064, 80.49205156949614, 39.92186935059079, 31.040064128227524, 2.9834203025185646, 37.55069060768178, 48.05590874435422, 17.781178010801128, 12.369546943483154, 9.731795905060357, 157.57158998473093, 29.18115362684228, 38.439757870243675, 23.40745840559266, 152.88857306403312, 68.20781149984967, 331.793207541704, 1.1841714723081498, 96.54579722789255, 161.66418525817662, 101.65871968254521, 2.8054307161731726, 37.75017261064142, 14.314271532897498, 27.277535982213408, 15.579667815110746, 2.573057881363561, 16.665363393340762, 19.717825075752227, 27.455421422537874, 51.754705526191756, 70.2299893578079, 17.963396777985302, 138.88639419789686, 12.96471725340884, 12.656651744700206, 68.78110652243896, 20.08786083293663, 21.935467090774114, 48.45207142037968, 23.579336545610474, 40.98560064734313, 0.9008475515105068, 22.176506513914546, 22.14597135436226, 20.43183154097541, 426.76724392551165, 5.883476630815888, 8.897062713870202, 12.316978286584852, 45.984949355449245, 2.4947980100813663, 44.50571333860944, 265.738702520356, 37.281853839285176, 199.4141020752291, 14.421166608537362, 26.559634241940724, 71.16439096278427, 19.077083984547855, 62.64964391339259, 1.6523423435786353, 84.39516402054906, 380.7770774564923, 29.06064213515451, 86.53069380289676, 27.026731437270627, 3.3555942011326856, 16.805956982586746, 113.72756020197195, 80.23164717078959, 0.0, 9.225717700111435, 5.649065612338098, 46.66067179931608, 69.36328352960196, 5.450203837570092, 45.70242485292321, 22.11563868220464, 56.40675205573535, 50.3087210566139, 20.380138933052933, 54.24341283482649, 23.103960761482206, 22.69948326754141, 4.850873242975214, 613.0134099221866, 12.496758483025445, 19.729587559327165, 35.896523398863074, 7.198482440448001, 30.580025428261134, 0.9984806936318191, 62.00921558149725, 27.7670491255871, 469.1133682776363, 39.191084267120786, 2.165169310051649, 34.21099713348052, 39.76292464912744, 483.08128619534864, 51.73474965795815, 4.868372052064093, 15.282002073271808, 116.60985902930022, 200.54512802873873, 19.389045718484518, 4.827607598791933, 151.70193654309352, 25.70098658455131, 2.1669481897426883, 493.92621362130745, 50.81117331717525, 49.79720853173337, 548.9577620548399, 18.726843792956004, 937.6436101252351, 74.08143746436183, 2.5110683027843246, 38.66725325238904, 102.20761666296158, 107.0177274246981, 1.6511256494932682, 4.087356784254973, 20.816980423838103, 67.55960618660043, 118.017675571361, 2.313769370000477, 17.742970724953903, 310.9567364627708, 56.08980880755574, 281.74381318900265, 22.237973394323483, 4.496260839817565, 148.49150544457612, 41.74149981133836, 15.986372163532408, 1.990782950025508, 17.777084665735316, 211.69006149205867, 11.229449198888386, 42.637045852859735, 142.6730116718096, 167.0904793543605, 22.98808273765607, 8.282649261282655, 42.103404977688946, 97.70696138719873, 19.889949385237557, 39.69663428936512, 34.637032320301415, 7.469726886609097, 22.865484095212302, 18.829559199121135, 4.311955417075506, 7.080671548446949, 61.42071440710872, 56.456342991906546, 13.594828875731931, 41.43139746604891, 948.9336646140904, 281.9601781295649, 554.2488438614245, 232.88964097863268, 33.202146079240464, 8.057985944042866, 11.353042066002779, 46.50092461128139, 29.82147340357568, 166.8358525103513, 486.13885494837047, 15.695401527313694, 579.7224414500151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.84206862012943, "mean_inference_ms": 3.737145538290022, "mean_action_processing_ms": 1.8283473869210587, "mean_env_wait_ms": 1.1446121145035724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004578113555908203, "StateBufferConnector_ms": 0.02806401252746582, "ViewRequirementAgentConnector_ms": 0.10178351402282715}, "num_episodes": 8, "episode_return_max": 106.30377198736386, "episode_return_min": -539.6903196466676, "episode_return_mean": 5.754410842546629, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 243.1464158517422, "num_env_steps_trained_throughput_per_sec": 243.1464158517422, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 32301.162, "restore_workers_time_ms": 0.03, "training_step_time_ms": 32300.415, "sample_time_ms": 1318.19, "learn_time_ms": 30950.826, "learn_throughput": 258.475, "synch_weights_time_ms": 24.641}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": false, "training_iteration": 50, "trial_id": "cd905_00000", "date": "2024-08-20_09-51-16", "timestamp": 1724127676, "time_this_iter_s": 32.94652485847473, "time_total_s": 1633.7674181461334, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afeca60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1633.7674181461334, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 34.26739130434783, "ram_util_percent": 81.62826086956522}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2418520568855227, "cur_kl_coeff": 3.2186508178710934e-07, "cur_lr": 0.0001, "total_loss": 6.800829385575794, "policy_loss": -0.002251407547691275, "vf_loss": 6.803080811576238, "vf_explained_var": 0.002506295366892739, "kl": 0.010915705806063858, "entropy": 1.3242973134631202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 31815.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5022548258777648, "cur_kl_coeff": 2.2351741790771484e-09, "cur_lr": 0.0001, "total_loss": 5.115244639109052, "policy_loss": -0.0034148871170593398, "vf_loss": 5.118659553073702, "vf_explained_var": 0.0006597768692743211, "kl": 0.006748812491997231, "entropy": 1.3450345603246538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 31815.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "env_runners": {"episode_reward_max": 103.13817838098518, "episode_reward_min": -541.4361405809135, "episode_reward_mean": -70.61081968511883, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -894.4451177820259, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 53.99027083531649, "predator_policy": 968.1223388383911}, "policy_reward_mean": {"prey_policy": -186.43859187389313, "predator_policy": 151.13318203133366}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.66144749855348, 27.26446609406746, -8.134713919282872, -44.54764945911786, 38.70000000000028, -323.3138433631086, -303.38894822645665, -433.9092345939612, 71.74610280231036, 11.737487792978314, 22.37872485501827, 84.73724600247468, -27.278284938926763, 103.13817838098518, -4.257430199226408, -180.47032127649467, -46.196335186457155, 8.903379934833247, 68.30000000000018, -64.72166031072081, 34.20092685272562, -14.363526116402008, 43.30000000000037, 34.60000000000022, 38.80814234272946, 66.1000000000003, 80.79999999999924, 62.10000000000043, 55.30000000000044, -539.6903196466676, 52.24171958218403, 25.25218869635102, 50.91080371572248, 40.2097037539166, -176.66752982074004, -342.10704876089, -151.4860608622374, 48.9140754435956, -3.38281055962106, -328.9540241750155, 41.25206644140059, -177.12082026199218, -35.542724516955616, -225.27332390372945, -159.01153570768082, -376.8808674244775, -13.52406930127946, 52.08732187481883, -153.33306611203218, 39.50000000000029, -541.4361405809135, 34.08528795450775, -424.3345289007089, 54.100000000000485, -36.652339015536974, 70.28241809635385, -61.158081561522316, -466.7977180165217, -131.5214233855798, 60.04765561012841, -136.8080243165557, -187.80563129414546, 29.000000000000142, 44.24146711160492, 67.40000000000022, 41.37023139353453, -217.63152104122355, -412.91926131874766, -195.50592143655157, 23.55968893977938, 17.462077409493098, 30.700000000000166, 39.20000000000029, -245.08063727258278, 54.00000000000031, -32.8059247317246, -166.33148787088416, -161.68986116212102, 38.659721445293854, -25.16971814961575, 37.000000000000256, -83.44936787267136, 61.97247881968151, -233.53000961486725, 44.281890525201355, 64.2828146515142, 39.50000000000029, 62.4511058828295, 41.57464374963703, 53.5000000000005, 37.000000000000256, -85.1266562954797, -304.153974184697, -465.70564096437414, -231.68192930980163, -91.9380889256724, 27.089348424658688, -252.6573346084556, -99.33941011634217, 30.800000000000168], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [22.1403478605914, -21.08202207206034, -6.575882735942989, -98.05151227256266, -184.87452680743667, -43.19436085906986, -121.76060064584507, -79.31659295515853, -6.800986584551218, 17.633051810257296, -454.67735513025576, -413.3738751713354, -392.8810029494448, -509.26291586358525, -562.6177018721952, -827.6619866399564, -58.83667380015238, 53.99027083531649, -66.17055031999594, -62.9668318023764, -30.845687334596107, -55.44444088457725, 16.334064140609463, 43.49884465377337, -40.05551453793953, -172.80005215894926, 51.921255106170015, 31.160183179862976, -87.24861924642003, -284.0553562231326, -225.73717966722475, -258.7149281925965, -129.8056470773201, -69.37845439353204, -21.573929053389843, -27.25056298664787, 47.50921704997472, 1.022915334264668, -121.35425861097046, -166.28691239069744, -115.72714787246429, -35.38198279948027, -99.71299586745614, -104.72909234096264, 11.11735073871731, -18.20340497768869, 6.900824002442761, -89.89773477487984, -23.18708817157001, -12.338436095366886, 11.930273113390871, 23.834515904787782, 42.27044080087906, 15.388044582924458, 12.319328451553016, -18.72071440710851, -20.156342991906328, 5.405171124268035, -715.4519825396198, -814.6033991871868, -171.19454552140218, -612.7727568874027, -226.50883409134275, -14.330764270180147, 17.68607856889595, 13.81369713678035, -39.62425684909668, 3.5115625881561043, -441.3024642127289, -388.3397730667325, -482.12249189992184, -455.40239983829736, -237.5610140094639, -465.4449540711903, -34.92645711750211, 13.30164966086736, -73.72434750868707, -94.90389571217841, -414.764128271554, -489.3059492981671, -37.316108774334076, -39.66964529327659, -362.4519803340308, -330.856735741117, -144.80615401458505, -532.526746508139, -299.85070857468884, -356.9384592777258, -242.3639951680398, -310.73536897355353, -812.3900063126978, -480.8822664552155, -153.39195539769005, -308.1386517360771, 20.3185689335089, -23.600436575712415, -286.7205518107788, -262.78155133810236, 11.9475821311148, 20.000000000000014, -629.4233858829224, -715.7840228431362, -306.95059796397493, 10.776846760959575, -601.72095458278, -597.3282299275359, -4.117338029023754, 19.862408351063635, -96.01030817045925, -83.62435877296424, 24.21529623919689, -17.053279532478477, -347.8008977605564, -231.93079674637372, -635.792641379659, -773.0805619893933, -246.7461272125069, -351.2924096100453, 2.7654373676400836, -29.389900270024953, -179.43591170294854, -277.6817322809597, -329.9965520989124, -295.00211957271176, -41.06115027383399, -64.16325949090465, -31.9313332410429, 8.490975249058929, 39.536779454291576, 22.827713185227644, 18.76928118307758, -16.753127492542223, -371.53928166203394, -369.3962684160451, -538.4685390686878, -668.9198278121912, -289.76258131781873, -332.5097129502957, -24.45601469380258, -3.3521173223146667, -727.1997129757553, 6.831060558195133, -9.930111860602198, -143.70731924148598, 18.06240500613602, 13.287073010140256, -379.0175242611232, -374.85348762716984, -365.51469880687216, 8.454062202455788, -175.8661684087525, -189.24183135291452, -243.3665251772048, -450.0390326113936, -350.2747654467661, -226.72949919365752, 5.470081705122233, -14.864112966124189, -79.10781826721853, -79.89589937826413, -14.964361375024561, 5.142769975521926, -287.2825630178997, -220.00936843456617, 28.07770657607106, -12.233987551230118, -342.09049874241356, -505.5134314137691, -64.52702448749018, -18.485483134385333, 10.65504335002544, 21.02114531388958, 20.075908488749157, -27.471329447925037, -11.90417242956501, 20.000000000000014, -2.6955330555031827, 1.8076758274492368, 18.238424586513275, -10.651535336934703, -33.28926445428941, -30.578842875186176, -211.55842019322893, -154.2180371990018, -425.40272425240704, -563.2826887042244, -813.9611335018993, -894.4451177820259, -342.5838037824574, -375.61548276755764, -154.32571675500094, -202.56944889650225, -174.58519769573047, -150.86526809334507, -411.36874446307763, -331.5509862422258, -179.14257566707462, -294.4353143575767, -5.374412697325118, -251.55779224826668], "policy_predator_policy_reward": [51.73474965795815, 4.868372052064093, 15.282002073271808, 116.60985902930022, 200.54512802873873, 19.389045718484518, 4.827607598791933, 151.70193654309352, 25.70098658455131, 2.1669481897426883, 493.92621362130745, 50.81117331717525, 49.79720853173337, 548.9577620548399, 18.726843792956004, 937.6436101252351, 74.08143746436183, 2.5110683027843246, 38.66725325238904, 102.20761666296158, 107.0177274246981, 1.6511256494932682, 4.087356784254973, 20.816980423838103, 67.55960618660043, 118.017675571361, 2.313769370000477, 17.742970724953903, 310.9567364627708, 56.08980880755574, 281.74381318900265, 22.237973394323483, 4.496260839817565, 148.49150544457612, 41.74149981133836, 15.986372163532408, 1.990782950025508, 17.777084665735316, 211.69006149205867, 11.229449198888386, 42.637045852859735, 142.6730116718096, 167.0904793543605, 22.98808273765607, 8.282649261282655, 42.103404977688946, 97.70696138719873, 19.889949385237557, 39.69663428936512, 34.637032320301415, 7.469726886609097, 22.865484095212302, 18.829559199121135, 4.311955417075506, 7.080671548446949, 61.42071440710872, 56.456342991906546, 13.594828875731931, 41.43139746604891, 948.9336646140904, 281.9601781295649, 554.2488438614245, 232.88964097863268, 33.202146079240464, 8.057985944042866, 11.353042066002779, 46.50092461128139, 29.82147340357568, 166.8358525103513, 486.13885494837047, 15.695401527313694, 579.7224414500151, 84.92059777100567, 466.5993094474116, 34.34686678864958, 36.19201611158057, 95.41815663877398, 69.82727602247056, 10.895073703738595, 564.220979690967, 35.03285602738976, 83.20496448162135, 73.45867519864669, 442.7292206145087, 81.98211256515411, 559.8080634406133, 335.02964502273346, 96.48619892595133, 13.226745733167432, 380.861082700745, 906.7773956325609, 9.614009710875283, 111.5596325966612, 336.4469052358253, 10.223819918646686, 45.145369598375495, 17.755579154500907, 378.41345788234804, 7.552417868885166, 0.0, 790.1204940387945, 13.650774106350694, 312.9302460696449, 17.328793087878218, 773.59305736429, 1.1215982453164985, 22.81733802902381, 15.537591648936377, 44.99855449888398, 97.98377342900262, 20.567121857157083, 42.553279532478726, 210.0924250966888, 308.48118784871895, 1.2422765673278882, 940.8332087852023, 6.956465769113454, 459.560647667861, 37.528736574162735, 49.14338193835029, 18.642666568496217, 301.666953098857, 391.26039508397514, 45.93264529350334, 56.561150273833974, 77.66325949090474, 19.614586309536286, 48.06723879405246, 3.4877672747540807, 1.5477400857269825, 0.0, 39.35407770299913, 17.55862294707847, 505.74540608977657, 11.85280974963365, 782.616295812498, 405.0000876211111, 21.766285210452317, 26.976742850257743, 24.39107810563887, 727.6997129757552, 10.131016851297938, 28.630111860602355, 155.70731924148615, 1.7375949938639685, 6.112926989859713, 504.895642148668, 3.894732467041779, 373.11469880687366, 37.9459377975442, 117.72428620845785, 214.5777888214849, 12.835266870035563, 514.2388030476786, 71.12911254876664, 344.1852909295359, 40.72823884111973, 7.325513865175986, 132.77618039347598, 1.0578191023904129, 33.064361375024625, 13.75723002447804, 272.41851636356006, 151.42404721623404, 27.89625882575759, 18.232500969082814, 587.9014167344031, 26.17250380691293, 20.586663877278333, 106.7077342697998, 19.54495664997453, 13.061669337624428, 0.7240915112508609, 46.1713294479253, 12.861072084203462, 41.49420622819073, 23.284307267904065, 19.178193709786502, 16.46157541348672, 29.451535336934874, 51.48926445428966, 49.37884287518644, 70.76382933634531, 209.88597176040565, 42.71720168755445, 641.8142370843801, 274.57827148115916, 968.1223388383911, 484.34350435260626, 2.1738528876066514, 168.7625774844709, 96.19449924135934, 334.39147644507744, 18.148337768656344, 15.438575972229142, 474.8238201246186, 14.475509709835645, 359.7629701984731, 23.87441269732519, 263.85779224826683]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.8408045771198775, "mean_inference_ms": 3.731208185499223, "mean_action_processing_ms": 1.877914658750571, "mean_env_wait_ms": 1.1446812585052557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037560462951660156, "StateBufferConnector_ms": 0.024166584014892578, "ViewRequirementAgentConnector_ms": 0.10188436508178711}, "num_episodes": 64, "episode_return_max": 103.13817838098518, "episode_return_min": -541.4361405809135, "episode_return_mean": -70.61081968511883, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 244.88014313473886, "num_env_steps_trained_throughput_per_sec": 244.88014313473886, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 1632000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1632000, "timers": {"training_iteration_time_ms": 32328.999, "restore_workers_time_ms": 0.031, "training_step_time_ms": 32328.263, "sample_time_ms": 1336.012, "learn_time_ms": 30961.801, "learn_throughput": 258.383, "synch_weights_time_ms": 23.687}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "done": false, "training_iteration": 51, "trial_id": "cd905_00000", "date": "2024-08-20_09-51-49", "timestamp": 1724127709, "time_this_iter_s": 32.69929790496826, "time_total_s": 1666.4667160511017, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afc6af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1666.4667160511017, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 34.11914893617021, "ram_util_percent": 81.95531914893617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.980020784586668, "cur_kl_coeff": 3.2186508178710934e-07, "cur_lr": 0.0001, "total_loss": 9.224355905018156, "policy_loss": -0.0015224987482060752, "vf_loss": 9.225878400651235, "vf_explained_var": -0.00039415255425468326, "kl": 0.0077222628524814645, "entropy": 1.278771100157783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 32445.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3799358891057117, "cur_kl_coeff": 2.2351741790771484e-09, "cur_lr": 0.0001, "total_loss": 7.841247791714139, "policy_loss": -0.0027387511399057174, "vf_loss": 7.843986512744237, "vf_explained_var": -7.496116653321281e-05, "kl": 0.004363237882888002, "entropy": 1.2880358345924863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 32445.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000}, "env_runners": {"episode_reward_max": 103.13817838098518, "episode_reward_min": -541.4361405809135, "episode_reward_mean": -70.78429444993311, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -967.5767008780598, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 53.99027083531649, "predator_policy": 992.11003517169}, "policy_reward_mean": {"prey_policy": -205.72205855579952, "predator_policy": 170.32991133083294}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.74610280231036, 11.737487792978314, 22.37872485501827, 84.73724600247468, -27.278284938926763, 103.13817838098518, -4.257430199226408, -180.47032127649467, -46.196335186457155, 8.903379934833247, 68.30000000000018, -64.72166031072081, 34.20092685272562, -14.363526116402008, 43.30000000000037, 34.60000000000022, 38.80814234272946, 66.1000000000003, 80.79999999999924, 62.10000000000043, 55.30000000000044, -539.6903196466676, 52.24171958218403, 25.25218869635102, 50.91080371572248, 40.2097037539166, -176.66752982074004, -342.10704876089, -151.4860608622374, 48.9140754435956, -3.38281055962106, -328.9540241750155, 41.25206644140059, -177.12082026199218, -35.542724516955616, -225.27332390372945, -159.01153570768082, -376.8808674244775, -13.52406930127946, 52.08732187481883, -153.33306611203218, 39.50000000000029, -541.4361405809135, 34.08528795450775, -424.3345289007089, 54.100000000000485, -36.652339015536974, 70.28241809635385, -61.158081561522316, -466.7977180165217, -131.5214233855798, 60.04765561012841, -136.8080243165557, -187.80563129414546, 29.000000000000142, 44.24146711160492, 67.40000000000022, 41.37023139353453, -217.63152104122355, -412.91926131874766, -195.50592143655157, 23.55968893977938, 17.462077409493098, 30.700000000000166, 39.20000000000029, -245.08063727258278, 54.00000000000031, -32.8059247317246, -166.33148787088416, -161.68986116212102, 38.659721445293854, -25.16971814961575, 37.000000000000256, -83.44936787267136, 61.97247881968151, -233.53000961486725, 44.281890525201355, 64.2828146515142, 39.50000000000029, 62.4511058828295, 41.57464374963703, 53.5000000000005, 37.000000000000256, -85.1266562954797, -304.153974184697, -465.70564096437414, -231.68192930980163, -91.9380889256724, 27.089348424658688, -252.6573346084556, -99.33941011634217, 30.800000000000168, -158.34765753258077, -66.31799970562851, -206.98458224044495, -5.85182189734806, -194.3646306643795, -67.00001610160211, -96.2744854987342, -211.87475881001617], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-58.83667380015238, 53.99027083531649, -66.17055031999594, -62.9668318023764, -30.845687334596107, -55.44444088457725, 16.334064140609463, 43.49884465377337, -40.05551453793953, -172.80005215894926, 51.921255106170015, 31.160183179862976, -87.24861924642003, -284.0553562231326, -225.73717966722475, -258.7149281925965, -129.8056470773201, -69.37845439353204, -21.573929053389843, -27.25056298664787, 47.50921704997472, 1.022915334264668, -121.35425861097046, -166.28691239069744, -115.72714787246429, -35.38198279948027, -99.71299586745614, -104.72909234096264, 11.11735073871731, -18.20340497768869, 6.900824002442761, -89.89773477487984, -23.18708817157001, -12.338436095366886, 11.930273113390871, 23.834515904787782, 42.27044080087906, 15.388044582924458, 12.319328451553016, -18.72071440710851, -20.156342991906328, 5.405171124268035, -715.4519825396198, -814.6033991871868, -171.19454552140218, -612.7727568874027, -226.50883409134275, -14.330764270180147, 17.68607856889595, 13.81369713678035, -39.62425684909668, 3.5115625881561043, -441.3024642127289, -388.3397730667325, -482.12249189992184, -455.40239983829736, -237.5610140094639, -465.4449540711903, -34.92645711750211, 13.30164966086736, -73.72434750868707, -94.90389571217841, -414.764128271554, -489.3059492981671, -37.316108774334076, -39.66964529327659, -362.4519803340308, -330.856735741117, -144.80615401458505, -532.526746508139, -299.85070857468884, -356.9384592777258, -242.3639951680398, -310.73536897355353, -812.3900063126978, -480.8822664552155, -153.39195539769005, -308.1386517360771, 20.3185689335089, -23.600436575712415, -286.7205518107788, -262.78155133810236, 11.9475821311148, 20.000000000000014, -629.4233858829224, -715.7840228431362, -306.95059796397493, 10.776846760959575, -601.72095458278, -597.3282299275359, -4.117338029023754, 19.862408351063635, -96.01030817045925, -83.62435877296424, 24.21529623919689, -17.053279532478477, -347.8008977605564, -231.93079674637372, -635.792641379659, -773.0805619893933, -246.7461272125069, -351.2924096100453, 2.7654373676400836, -29.389900270024953, -179.43591170294854, -277.6817322809597, -329.9965520989124, -295.00211957271176, -41.06115027383399, -64.16325949090465, -31.9313332410429, 8.490975249058929, 39.536779454291576, 22.827713185227644, 18.76928118307758, -16.753127492542223, -371.53928166203394, -369.3962684160451, -538.4685390686878, -668.9198278121912, -289.76258131781873, -332.5097129502957, -24.45601469380258, -3.3521173223146667, -727.1997129757553, 6.831060558195133, -9.930111860602198, -143.70731924148598, 18.06240500613602, 13.287073010140256, -379.0175242611232, -374.85348762716984, -365.51469880687216, 8.454062202455788, -175.8661684087525, -189.24183135291452, -243.3665251772048, -450.0390326113936, -350.2747654467661, -226.72949919365752, 5.470081705122233, -14.864112966124189, -79.10781826721853, -79.89589937826413, -14.964361375024561, 5.142769975521926, -287.2825630178997, -220.00936843456617, 28.07770657607106, -12.233987551230118, -342.09049874241356, -505.5134314137691, -64.52702448749018, -18.485483134385333, 10.65504335002544, 21.02114531388958, 20.075908488749157, -27.471329447925037, -11.90417242956501, 20.000000000000014, -2.6955330555031827, 1.8076758274492368, 18.238424586513275, -10.651535336934703, -33.28926445428941, -30.578842875186176, -211.55842019322893, -154.2180371990018, -425.40272425240704, -563.2826887042244, -813.9611335018993, -894.4451177820259, -342.5838037824574, -375.61548276755764, -154.32571675500094, -202.56944889650225, -174.58519769573047, -150.86526809334507, -411.36874446307763, -331.5509862422258, -179.14257566707462, -294.4353143575767, -5.374412697325118, -251.55779224826668, -354.2505643685036, -295.2577595399664, -185.28633960059963, -139.9462664091578, -800.5074970823372, -886.4886376550926, -674.5512027093839, -657.4821987650674, -243.90142268725498, -967.5767008780598, -111.71774858859939, -139.87987807090576, -385.86621569989654, -470.8032249500893, -639.5530765177097, -585.9825257472114], "policy_predator_policy_reward": [74.08143746436183, 2.5110683027843246, 38.66725325238904, 102.20761666296158, 107.0177274246981, 1.6511256494932682, 4.087356784254973, 20.816980423838103, 67.55960618660043, 118.017675571361, 2.313769370000477, 17.742970724953903, 310.9567364627708, 56.08980880755574, 281.74381318900265, 22.237973394323483, 4.496260839817565, 148.49150544457612, 41.74149981133836, 15.986372163532408, 1.990782950025508, 17.777084665735316, 211.69006149205867, 11.229449198888386, 42.637045852859735, 142.6730116718096, 167.0904793543605, 22.98808273765607, 8.282649261282655, 42.103404977688946, 97.70696138719873, 19.889949385237557, 39.69663428936512, 34.637032320301415, 7.469726886609097, 22.865484095212302, 18.829559199121135, 4.311955417075506, 7.080671548446949, 61.42071440710872, 56.456342991906546, 13.594828875731931, 41.43139746604891, 948.9336646140904, 281.9601781295649, 554.2488438614245, 232.88964097863268, 33.202146079240464, 8.057985944042866, 11.353042066002779, 46.50092461128139, 29.82147340357568, 166.8358525103513, 486.13885494837047, 15.695401527313694, 579.7224414500151, 84.92059777100567, 466.5993094474116, 34.34686678864958, 36.19201611158057, 95.41815663877398, 69.82727602247056, 10.895073703738595, 564.220979690967, 35.03285602738976, 83.20496448162135, 73.45867519864669, 442.7292206145087, 81.98211256515411, 559.8080634406133, 335.02964502273346, 96.48619892595133, 13.226745733167432, 380.861082700745, 906.7773956325609, 9.614009710875283, 111.5596325966612, 336.4469052358253, 10.223819918646686, 45.145369598375495, 17.755579154500907, 378.41345788234804, 7.552417868885166, 0.0, 790.1204940387945, 13.650774106350694, 312.9302460696449, 17.328793087878218, 773.59305736429, 1.1215982453164985, 22.81733802902381, 15.537591648936377, 44.99855449888398, 97.98377342900262, 20.567121857157083, 42.553279532478726, 210.0924250966888, 308.48118784871895, 1.2422765673278882, 940.8332087852023, 6.956465769113454, 459.560647667861, 37.528736574162735, 49.14338193835029, 18.642666568496217, 301.666953098857, 391.26039508397514, 45.93264529350334, 56.561150273833974, 77.66325949090474, 19.614586309536286, 48.06723879405246, 3.4877672747540807, 1.5477400857269825, 0.0, 39.35407770299913, 17.55862294707847, 505.74540608977657, 11.85280974963365, 782.616295812498, 405.0000876211111, 21.766285210452317, 26.976742850257743, 24.39107810563887, 727.6997129757552, 10.131016851297938, 28.630111860602355, 155.70731924148615, 1.7375949938639685, 6.112926989859713, 504.895642148668, 3.894732467041779, 373.11469880687366, 37.9459377975442, 117.72428620845785, 214.5777888214849, 12.835266870035563, 514.2388030476786, 71.12911254876664, 344.1852909295359, 40.72823884111973, 7.325513865175986, 132.77618039347598, 1.0578191023904129, 33.064361375024625, 13.75723002447804, 272.41851636356006, 151.42404721623404, 27.89625882575759, 18.232500969082814, 587.9014167344031, 26.17250380691293, 20.586663877278333, 106.7077342697998, 19.54495664997453, 13.061669337624428, 0.7240915112508609, 46.1713294479253, 12.861072084203462, 41.49420622819073, 23.284307267904065, 19.178193709786502, 16.46157541348672, 29.451535336934874, 51.48926445428966, 49.37884287518644, 70.76382933634531, 209.88597176040565, 42.71720168755445, 641.8142370843801, 274.57827148115916, 968.1223388383911, 484.34350435260626, 2.1738528876066514, 168.7625774844709, 96.19449924135934, 334.39147644507744, 18.148337768656344, 15.438575972229142, 474.8238201246186, 14.475509709835645, 359.7629701984731, 23.87441269732519, 263.85779224826683, 42.316747287470655, 448.8439190884188, 240.3220084002785, 18.592597903850244, 661.1984203254985, 818.8131321714861, 704.7071951489008, 621.4743844282011, 25.003457729245227, 992.11003517169, 19.54730668550346, 165.05030387239935, 188.1931841967562, 572.2017709544953, 693.7436741047381, 319.917169350168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.83490426785135, "mean_inference_ms": 3.733261956103486, "mean_action_processing_ms": 1.8741660178156239, "mean_env_wait_ms": 1.1421771534823577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003738999366760254, "StateBufferConnector_ms": 0.015852928161621094, "ViewRequirementAgentConnector_ms": 0.10142242908477783}, "num_episodes": 8, "episode_return_max": 103.13817838098518, "episode_return_min": -541.4361405809135, "episode_return_mean": -70.78429444993311, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 248.1562686628802, "num_env_steps_trained_throughput_per_sec": 248.1562686628802, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 1664000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1664000, "timers": {"training_iteration_time_ms": 32312.754, "restore_workers_time_ms": 0.029, "training_step_time_ms": 32312.05, "sample_time_ms": 1332.019, "learn_time_ms": 30950.01, "learn_throughput": 258.481, "synch_weights_time_ms": 23.101}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000}, "done": false, "training_iteration": 52, "trial_id": "cd905_00000", "date": "2024-08-20_09-52-21", "timestamp": 1724127741, "time_this_iter_s": 32.27640914916992, "time_total_s": 1698.7431252002716, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f0df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1698.7431252002716, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 33.25555555555555, "ram_util_percent": 82.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2522478441633875, "cur_kl_coeff": 3.2186508178710934e-07, "cur_lr": 0.0001, "total_loss": 8.035548387254988, "policy_loss": -0.007181651692926174, "vf_loss": 8.042730031694685, "vf_explained_var": 3.5342999867030556e-05, "kl": 0.012574004967547577, "entropy": 1.2242392259930808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.46615880195583614, "cur_kl_coeff": 1.1175870895385742e-09, "cur_lr": 0.0001, "total_loss": 7.862558565442524, "policy_loss": -0.00038646001087886, "vf_loss": 7.862944995032416, "vf_explained_var": -0.00012194353436666822, "kl": 0.002562055946056341, "entropy": 1.241613157022567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000}, "env_runners": {"episode_reward_max": 148.87014010185104, "episode_reward_min": -697.3741132102322, "episode_reward_mean": -137.0490903554799, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1187.061484515146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 43.40000000000024, "predator_policy": 1375.4838036209005}, "policy_reward_mean": {"prey_policy": -446.964454317331, "predator_policy": 378.43990913959095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.20000000000029, -245.08063727258278, 54.00000000000031, -32.8059247317246, -166.33148787088416, -161.68986116212102, 38.659721445293854, -25.16971814961575, 37.000000000000256, -83.44936787267136, 61.97247881968151, -233.53000961486725, 44.281890525201355, 64.2828146515142, 39.50000000000029, 62.4511058828295, 41.57464374963703, 53.5000000000005, 37.000000000000256, -85.1266562954797, -304.153974184697, -465.70564096437414, -231.68192930980163, -91.9380889256724, 27.089348424658688, -252.6573346084556, -99.33941011634217, 30.800000000000168, -158.34765753258077, -66.31799970562851, -206.98458224044495, -5.85182189734806, -194.3646306643795, -67.00001610160211, -96.2744854987342, -211.87475881001617, 70.58249662194955, -255.75623114044794, -244.54788377668308, -37.654156752646806, -166.46601841084765, -20.331177072815148, -108.85613788894085, 148.87014010185104, 21.618574569686004, -384.2074290126283, -204.3383876834472, -389.710438474624, -125.25848146359547, -524.7484794049317, 20.84961174358249, -169.85532718586472, -205.4828856681246, -329.06942553231676, -35.7150643863756, -341.1006822007766, 14.009146374756494, 67.11499956938718, -183.05509559108876, 35.50345675769425, -96.46667833638409, -427.09084570948573, -406.1803934072048, -218.19634800057977, -67.34667714938082, -202.79267438838843, 30.228025920421402, -256.31181617835017, -180.50585540159952, -169.03795887864055, 18.74981330573157, -60.70738415485305, -488.9516503337235, -88.54311687481766, -316.61136620631083, 90.97414413715872, -375.4323698276857, -336.4741876149539, -541.6173038314737, 84.89999999999897, -172.64513652543116, -697.3741132102322, -7.242182748610915, -10.791277354840824, 128.54850575545612, -7.179915877402028, -48.28985523458319, -185.1675390801969, -173.22843492167738, -152.42041829253333, -256.1858014391454, 51.90000000000047, -338.6582433889826, -87.53250932041124, -322.14153898462115, -479.91698050178405, -84.84271996563322, -136.84591858517967, -426.12114723985786, -89.39029976334855], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [18.06240500613602, 13.287073010140256, -379.0175242611232, -374.85348762716984, -365.51469880687216, 8.454062202455788, -175.8661684087525, -189.24183135291452, -243.3665251772048, -450.0390326113936, -350.2747654467661, -226.72949919365752, 5.470081705122233, -14.864112966124189, -79.10781826721853, -79.89589937826413, -14.964361375024561, 5.142769975521926, -287.2825630178997, -220.00936843456617, 28.07770657607106, -12.233987551230118, -342.09049874241356, -505.5134314137691, -64.52702448749018, -18.485483134385333, 10.65504335002544, 21.02114531388958, 20.075908488749157, -27.471329447925037, -11.90417242956501, 20.000000000000014, -2.6955330555031827, 1.8076758274492368, 18.238424586513275, -10.651535336934703, -33.28926445428941, -30.578842875186176, -211.55842019322893, -154.2180371990018, -425.40272425240704, -563.2826887042244, -813.9611335018993, -894.4451177820259, -342.5838037824574, -375.61548276755764, -154.32571675500094, -202.56944889650225, -174.58519769573047, -150.86526809334507, -411.36874446307763, -331.5509862422258, -179.14257566707462, -294.4353143575767, -5.374412697325118, -251.55779224826668, -354.2505643685036, -295.2577595399664, -185.28633960059963, -139.9462664091578, -800.5074970823372, -886.4886376550926, -674.5512027093839, -657.4821987650674, -243.90142268725498, -967.5767008780598, -111.71774858859939, -139.87987807090576, -385.86621569989654, -470.8032249500893, -639.5530765177097, -585.9825257472114, -76.06731679531893, -459.6225598664401, -605.890818936541, -755.956779621359, -594.7017550435598, -498.1266210861657, -634.2012208604118, -886.6230723812704, -1119.3962834560025, -823.2167575119237, -1161.422583569485, -761.9484882524162, -487.2343083704013, -384.23649388348406, -191.25085237143827, -466.88139793582354, -300.0972259726925, -142.86361848966712, -773.4719708706081, -984.0233714938813, -674.8276456550334, -606.6261394280568, -906.8433229039798, -774.5458539122357, -489.7319568486599, -245.8614047629862, -919.6873006185685, -697.7707781234734, -522.8075487513433, -254.70904331430813, -261.11708475892203, -416.749222121896, -734.2533481727951, -628.0522896422069, -936.5753841994671, -907.3537845905541, -560.222999724213, -504.1922543505037, -668.3893412148252, -407.251375965513, -104.83434776795781, -166.37924359997356, -4.466151637901916, -80.3514523347925, -619.8033399282976, -389.03031674915815, -27.241677486228575, 14.928532942378036, -567.5834021208015, -761.4553608342366, -737.0211650808378, -745.769629040808, -579.0106396558173, -542.5870945904754, -514.9557099529106, -298.0249747586529, -353.4105951314114, -282.57571109615355, -788.5885263869362, -341.5712900542348, -282.953733934083, -232.51429075437247, -943.9588666515236, -706.1060147492964, -255.9557545550616, -466.46158715538917, -796.1060859485337, -919.7966746750636, -44.94036507984822, -32.08222114648497, -650.3898000034575, -102.6965275683415, -595.5222172564445, -873.0351730534563, -521.0509570841483, -715.7999274970191, -464.53181024859725, -401.31484591280815, -5.842355576518939, -132.63679716090382, -702.2149705050723, -777.6369309217272, -489.6396974254316, -451.57660299833043, -1135.7749417279563, -1187.061484515146, 17.45914481418155, 43.40000000000024, -1097.9859363730136, -1033.0724900197183, -988.6207030176876, -871.6481739286991, -730.6021028120131, -705.1227166934575, -461.43581722654415, -582.8302343249713, -665.6112041599856, -718.1287391139086, -917.100462166012, -525.0528804754133, -124.1099918865686, -377.8512660398669, -638.6939735207965, -767.6905580059994, -517.5968868245047, -216.39749644493168, -293.44577224957465, -589.9001351748728, -537.3957019076573, -464.3129809036823, 2.5640751831386077, 16.80086934799411, -857.0115905188517, -901.2610503166151, -626.4506854519128, -899.8771282593622, -536.6250636715972, -492.41492583515134, -845.5224020961979, -634.4541826690029, -555.6722369439983, -868.1880073882618, -604.8763502449914, -754.4977953838885, -781.7577386318275, -957.4613631586008, -666.8054495072981, -847.4278664850875], "policy_predator_policy_reward": [1.7375949938639685, 6.112926989859713, 504.895642148668, 3.894732467041779, 373.11469880687366, 37.9459377975442, 117.72428620845785, 214.5777888214849, 12.835266870035563, 514.2388030476786, 71.12911254876664, 344.1852909295359, 40.72823884111973, 7.325513865175986, 132.77618039347598, 1.0578191023904129, 33.064361375024625, 13.75723002447804, 272.41851636356006, 151.42404721623404, 27.89625882575759, 18.232500969082814, 587.9014167344031, 26.17250380691293, 20.586663877278333, 106.7077342697998, 19.54495664997453, 13.061669337624428, 0.7240915112508609, 46.1713294479253, 12.861072084203462, 41.49420622819073, 23.284307267904065, 19.178193709786502, 16.46157541348672, 29.451535336934874, 51.48926445428966, 49.37884287518644, 70.76382933634531, 209.88597176040565, 42.71720168755445, 641.8142370843801, 274.57827148115916, 968.1223388383911, 484.34350435260626, 2.1738528876066514, 168.7625774844709, 96.19449924135934, 334.39147644507744, 18.148337768656344, 15.438575972229142, 474.8238201246186, 14.475509709835645, 359.7629701984731, 23.87441269732519, 263.85779224826683, 42.316747287470655, 448.8439190884188, 240.3220084002785, 18.592597903850244, 661.1984203254985, 818.8131321714861, 704.7071951489008, 621.4743844282011, 25.003457729245227, 992.11003517169, 19.54730668550346, 165.05030387239935, 188.1931841967562, 572.2017709544953, 693.7436741047381, 319.917169350168, 176.55487850361664, 429.71749478009195, 883.737362084044, 222.35400533340808, 721.3737977994181, 126.90669455362422, 653.45490067397, 829.7152358150659, 1169.267390510635, 606.8796320464426, 866.1846723825172, 1036.8552223665693, 245.08670782115212, 517.5279565437928, 371.2242904299399, 435.77809997917166, 110.44978800217334, 354.1296310298719, 322.37155406623555, 1050.9163592856257, 290.3695402882439, 786.7458571113989, 925.1685739101002, 366.51016443149166, 560.604329554819, 49.73055059323117, 1082.0466149535853, 10.662984383525119, 489.7889014144121, 308.57730239482225, 466.080040729544, 41.93093896540863, 346.602696943042, 810.220055203836, 515.1313599424909, 999.7283833152131, 570.9620875481617, 457.73810214018, 705.883769700445, 28.65626527911623, 222.45781602673742, 62.76492171594998, 37.519200950462185, 114.41340259161932, 372.7070604403353, 453.0715006460316, 34.760286298284065, 13.056315003260664, 887.8494805554938, 344.72260406315996, 1013.4353320902484, 42.264616321911305, 709.9007785494963, 5.516562289591555, 587.5680120825851, 7.2163246283986995, 367.43966559972597, 201.1999634784584, 788.9885263869362, 138.3786156658467, 251.96893954530125, 293.7271110635753, 1025.559668401491, 368.19339682097836, 15.85021038398822, 526.0612759248631, 533.7266088313734, 1013.1381929135841, 89.41790306261727, 6.354496469447348, 657.1898000034574, 35.1891434134882, 1.0664021819386735, 978.5393377942388, 541.9630369059334, 606.3447308004155, 538.5931156753858, 10.642174279708623, 29.32967098504049, 200.12362588954093, 315.42283668994713, 788.9966949091674, 57.549953571133486, 547.1921592376743, 405.73531879072834, 1375.4838036209005, 24.040855185818437, 0.0, 1131.2540567520034, 827.1592331152963, 1120.916990364309, 41.97777337184525, 604.5625455562797, 823.9200912005796, 424.3871902457487, 609.0875839509259, 778.8065596838746, 733.4818893454764, 627.9253952755824, 807.0480314884401, 32.06312206443384, 421.6082806274183, 877.9759013963735, 343.2410910502247, 28.169056286788997, 532.5968920609702, 328.3205629835795, 402.60492614833504, 690.6639610606678, 54.8589203115254, 26.88423067968353, 5.650824789183706, 486.5809792759939, 933.0334181704893, 736.4529316022342, 702.3423727886295, 695.7087866139874, 11.189663908139373, 995.7045994434203, 4.3550048199962905, 435.4500342194565, 903.56749014717, 578.8909389585694, 643.6372880851311, 904.3166156188922, 408.7813389316784, 496.0000360188062, 928.8429802102304]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.828979772432582, "mean_inference_ms": 3.721111589463643, "mean_action_processing_ms": 1.8865188702428746, "mean_env_wait_ms": 1.1420524293520784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003275156021118164, "StateBufferConnector_ms": 0.01821005344390869, "ViewRequirementAgentConnector_ms": 0.10491716861724854}, "num_episodes": 64, "episode_return_max": 148.87014010185104, "episode_return_min": -697.3741132102322, "episode_return_mean": -137.0490903554799, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 250.014242596171, "num_env_steps_trained_throughput_per_sec": 250.014242596171, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 1696000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1696000, "timers": {"training_iteration_time_ms": 32320.269, "restore_workers_time_ms": 0.03, "training_step_time_ms": 32319.432, "sample_time_ms": 1330.758, "learn_time_ms": 30958.481, "learn_throughput": 258.411, "synch_weights_time_ms": 23.148}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000}, "done": false, "training_iteration": 53, "trial_id": "cd905_00000", "date": "2024-08-20_09-52-53", "timestamp": 1724127773, "time_this_iter_s": 32.04385995864868, "time_total_s": 1730.7869851589203, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16affa310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1730.7869851589203, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 33.48043478260869, "ram_util_percent": 82.32391304347826}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3737517461890265, "cur_kl_coeff": 3.2186508178710934e-07, "cur_lr": 0.0001, "total_loss": 4.563380574044727, "policy_loss": -0.005467599169129417, "vf_loss": 4.568848167903839, "vf_explained_var": -0.0009093154044378371, "kl": 0.012614241862761374, "entropy": 1.1567374954147944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 33705.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.46696710255410934, "cur_kl_coeff": 5.587935447692871e-10, "cur_lr": 0.0001, "total_loss": 5.3913067893376425, "policy_loss": -0.0004395135988791784, "vf_loss": 5.391746301499624, "vf_explained_var": 6.780927143399677e-06, "kl": 0.0006189186307099568, "entropy": 1.21940811645417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 33705.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "env_runners": {"episode_reward_max": 304.7489038688759, "episode_reward_min": -697.3741132102322, "episode_reward_mean": -128.76849352612643, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1187.061484515146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 43.40000000000024, "predator_policy": 1375.4838036209005}, "policy_reward_mean": {"prey_policy": -460.3312636917828, "predator_policy": 395.9470169287196}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.000000000000256, -83.44936787267136, 61.97247881968151, -233.53000961486725, 44.281890525201355, 64.2828146515142, 39.50000000000029, 62.4511058828295, 41.57464374963703, 53.5000000000005, 37.000000000000256, -85.1266562954797, -304.153974184697, -465.70564096437414, -231.68192930980163, -91.9380889256724, 27.089348424658688, -252.6573346084556, -99.33941011634217, 30.800000000000168, -158.34765753258077, -66.31799970562851, -206.98458224044495, -5.85182189734806, -194.3646306643795, -67.00001610160211, -96.2744854987342, -211.87475881001617, 70.58249662194955, -255.75623114044794, -244.54788377668308, -37.654156752646806, -166.46601841084765, -20.331177072815148, -108.85613788894085, 148.87014010185104, 21.618574569686004, -384.2074290126283, -204.3383876834472, -389.710438474624, -125.25848146359547, -524.7484794049317, 20.84961174358249, -169.85532718586472, -205.4828856681246, -329.06942553231676, -35.7150643863756, -341.1006822007766, 14.009146374756494, 67.11499956938718, -183.05509559108876, 35.50345675769425, -96.46667833638409, -427.09084570948573, -406.1803934072048, -218.19634800057977, -67.34667714938082, -202.79267438838843, 30.228025920421402, -256.31181617835017, -180.50585540159952, -169.03795887864055, 18.74981330573157, -60.70738415485305, -488.9516503337235, -88.54311687481766, -316.61136620631083, 90.97414413715872, -375.4323698276857, -336.4741876149539, -541.6173038314737, 84.89999999999897, -172.64513652543116, -697.3741132102322, -7.242182748610915, -10.791277354840824, 128.54850575545612, -7.179915877402028, -48.28985523458319, -185.1675390801969, -173.22843492167738, -152.42041829253333, -256.1858014391454, 51.90000000000047, -338.6582433889826, -87.53250932041124, -322.14153898462115, -479.91698050178405, -84.84271996563322, -136.84591858517967, -426.12114723985786, -89.39029976334855, 207.43071564931537, -62.8562965165562, 54.57128289196299, -19.313328818078325, 23.11977123172354, -153.95775301947808, 304.7489038688759, -24.901520094053403], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.964361375024561, 5.142769975521926, -287.2825630178997, -220.00936843456617, 28.07770657607106, -12.233987551230118, -342.09049874241356, -505.5134314137691, -64.52702448749018, -18.485483134385333, 10.65504335002544, 21.02114531388958, 20.075908488749157, -27.471329447925037, -11.90417242956501, 20.000000000000014, -2.6955330555031827, 1.8076758274492368, 18.238424586513275, -10.651535336934703, -33.28926445428941, -30.578842875186176, -211.55842019322893, -154.2180371990018, -425.40272425240704, -563.2826887042244, -813.9611335018993, -894.4451177820259, -342.5838037824574, -375.61548276755764, -154.32571675500094, -202.56944889650225, -174.58519769573047, -150.86526809334507, -411.36874446307763, -331.5509862422258, -179.14257566707462, -294.4353143575767, -5.374412697325118, -251.55779224826668, -354.2505643685036, -295.2577595399664, -185.28633960059963, -139.9462664091578, -800.5074970823372, -886.4886376550926, -674.5512027093839, -657.4821987650674, -243.90142268725498, -967.5767008780598, -111.71774858859939, -139.87987807090576, -385.86621569989654, -470.8032249500893, -639.5530765177097, -585.9825257472114, -76.06731679531893, -459.6225598664401, -605.890818936541, -755.956779621359, -594.7017550435598, -498.1266210861657, -634.2012208604118, -886.6230723812704, -1119.3962834560025, -823.2167575119237, -1161.422583569485, -761.9484882524162, -487.2343083704013, -384.23649388348406, -191.25085237143827, -466.88139793582354, -300.0972259726925, -142.86361848966712, -773.4719708706081, -984.0233714938813, -674.8276456550334, -606.6261394280568, -906.8433229039798, -774.5458539122357, -489.7319568486599, -245.8614047629862, -919.6873006185685, -697.7707781234734, -522.8075487513433, -254.70904331430813, -261.11708475892203, -416.749222121896, -734.2533481727951, -628.0522896422069, -936.5753841994671, -907.3537845905541, -560.222999724213, -504.1922543505037, -668.3893412148252, -407.251375965513, -104.83434776795781, -166.37924359997356, -4.466151637901916, -80.3514523347925, -619.8033399282976, -389.03031674915815, -27.241677486228575, 14.928532942378036, -567.5834021208015, -761.4553608342366, -737.0211650808378, -745.769629040808, -579.0106396558173, -542.5870945904754, -514.9557099529106, -298.0249747586529, -353.4105951314114, -282.57571109615355, -788.5885263869362, -341.5712900542348, -282.953733934083, -232.51429075437247, -943.9588666515236, -706.1060147492964, -255.9557545550616, -466.46158715538917, -796.1060859485337, -919.7966746750636, -44.94036507984822, -32.08222114648497, -650.3898000034575, -102.6965275683415, -595.5222172564445, -873.0351730534563, -521.0509570841483, -715.7999274970191, -464.53181024859725, -401.31484591280815, -5.842355576518939, -132.63679716090382, -702.2149705050723, -777.6369309217272, -489.6396974254316, -451.57660299833043, -1135.7749417279563, -1187.061484515146, 17.45914481418155, 43.40000000000024, -1097.9859363730136, -1033.0724900197183, -988.6207030176876, -871.6481739286991, -730.6021028120131, -705.1227166934575, -461.43581722654415, -582.8302343249713, -665.6112041599856, -718.1287391139086, -917.100462166012, -525.0528804754133, -124.1099918865686, -377.8512660398669, -638.6939735207965, -767.6905580059994, -517.5968868245047, -216.39749644493168, -293.44577224957465, -589.9001351748728, -537.3957019076573, -464.3129809036823, 2.5640751831386077, 16.80086934799411, -857.0115905188517, -901.2610503166151, -626.4506854519128, -899.8771282593622, -536.6250636715972, -492.41492583515134, -845.5224020961979, -634.4541826690029, -555.6722369439983, -868.1880073882618, -604.8763502449914, -754.4977953838885, -781.7577386318275, -957.4613631586008, -666.8054495072981, -847.4278664850875, -307.5189079867874, 15.01295974867787, -251.8782140449213, -122.28944724939126, -164.72367090329965, -437.6056980532229, -193.20269986509047, -445.4042240817793, -902.6709320261423, 18.899999237059962, -688.6608837960351, -386.40973483438603, -775.4509472537051, 19.94479424262093, -511.3701063448707, -423.53190325270765], "policy_predator_policy_reward": [33.064361375024625, 13.75723002447804, 272.41851636356006, 151.42404721623404, 27.89625882575759, 18.232500969082814, 587.9014167344031, 26.17250380691293, 20.586663877278333, 106.7077342697998, 19.54495664997453, 13.061669337624428, 0.7240915112508609, 46.1713294479253, 12.861072084203462, 41.49420622819073, 23.284307267904065, 19.178193709786502, 16.46157541348672, 29.451535336934874, 51.48926445428966, 49.37884287518644, 70.76382933634531, 209.88597176040565, 42.71720168755445, 641.8142370843801, 274.57827148115916, 968.1223388383911, 484.34350435260626, 2.1738528876066514, 168.7625774844709, 96.19449924135934, 334.39147644507744, 18.148337768656344, 15.438575972229142, 474.8238201246186, 14.475509709835645, 359.7629701984731, 23.87441269732519, 263.85779224826683, 42.316747287470655, 448.8439190884188, 240.3220084002785, 18.592597903850244, 661.1984203254985, 818.8131321714861, 704.7071951489008, 621.4743844282011, 25.003457729245227, 992.11003517169, 19.54730668550346, 165.05030387239935, 188.1931841967562, 572.2017709544953, 693.7436741047381, 319.917169350168, 176.55487850361664, 429.71749478009195, 883.737362084044, 222.35400533340808, 721.3737977994181, 126.90669455362422, 653.45490067397, 829.7152358150659, 1169.267390510635, 606.8796320464426, 866.1846723825172, 1036.8552223665693, 245.08670782115212, 517.5279565437928, 371.2242904299399, 435.77809997917166, 110.44978800217334, 354.1296310298719, 322.37155406623555, 1050.9163592856257, 290.3695402882439, 786.7458571113989, 925.1685739101002, 366.51016443149166, 560.604329554819, 49.73055059323117, 1082.0466149535853, 10.662984383525119, 489.7889014144121, 308.57730239482225, 466.080040729544, 41.93093896540863, 346.602696943042, 810.220055203836, 515.1313599424909, 999.7283833152131, 570.9620875481617, 457.73810214018, 705.883769700445, 28.65626527911623, 222.45781602673742, 62.76492171594998, 37.519200950462185, 114.41340259161932, 372.7070604403353, 453.0715006460316, 34.760286298284065, 13.056315003260664, 887.8494805554938, 344.72260406315996, 1013.4353320902484, 42.264616321911305, 709.9007785494963, 5.516562289591555, 587.5680120825851, 7.2163246283986995, 367.43966559972597, 201.1999634784584, 788.9885263869362, 138.3786156658467, 251.96893954530125, 293.7271110635753, 1025.559668401491, 368.19339682097836, 15.85021038398822, 526.0612759248631, 533.7266088313734, 1013.1381929135841, 89.41790306261727, 6.354496469447348, 657.1898000034574, 35.1891434134882, 1.0664021819386735, 978.5393377942388, 541.9630369059334, 606.3447308004155, 538.5931156753858, 10.642174279708623, 29.32967098504049, 200.12362588954093, 315.42283668994713, 788.9966949091674, 57.549953571133486, 547.1921592376743, 405.73531879072834, 1375.4838036209005, 24.040855185818437, 0.0, 1131.2540567520034, 827.1592331152963, 1120.916990364309, 41.97777337184525, 604.5625455562797, 823.9200912005796, 424.3871902457487, 609.0875839509259, 778.8065596838746, 733.4818893454764, 627.9253952755824, 807.0480314884401, 32.06312206443384, 421.6082806274183, 877.9759013963735, 343.2410910502247, 28.169056286788997, 532.5968920609702, 328.3205629835795, 402.60492614833504, 690.6639610606678, 54.8589203115254, 26.88423067968353, 5.650824789183706, 486.5809792759939, 933.0334181704893, 736.4529316022342, 702.3423727886295, 695.7087866139874, 11.189663908139373, 995.7045994434203, 4.3550048199962905, 435.4500342194565, 903.56749014717, 578.8909389585694, 643.6372880851311, 904.3166156188922, 408.7813389316784, 496.0000360188062, 928.8429802102304, 291.62266987718687, 208.31399401024066, 0.0, 311.3113647777561, 181.1364570591542, 475.7641947893313, 148.15738875528749, 471.13620637350334, 701.8378511823498, 205.05285283845544, 697.905303362794, 223.20756224815094, 774.6692212763625, 285.5858356035969, 586.4697809002165, 323.5307086033093]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.822072237018864, "mean_inference_ms": 3.7218252304181103, "mean_action_processing_ms": 1.87601258619071, "mean_env_wait_ms": 1.138918207373338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032906532287597656, "StateBufferConnector_ms": 0.018183350563049316, "ViewRequirementAgentConnector_ms": 0.10500979423522949}, "num_episodes": 8, "episode_return_max": 304.7489038688759, "episode_return_min": -697.3741132102322, "episode_return_mean": -128.76849352612643, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 249.29587119077743, "num_env_steps_trained_throughput_per_sec": 249.29587119077743, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 1728000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1728000, "timers": {"training_iteration_time_ms": 32283.138, "restore_workers_time_ms": 0.03, "training_step_time_ms": 32282.089, "sample_time_ms": 1331.781, "learn_time_ms": 30921.734, "learn_throughput": 258.718, "synch_weights_time_ms": 21.956}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "done": false, "training_iteration": 54, "trial_id": "cd905_00000", "date": "2024-08-20_09-53-25", "timestamp": 1724127805, "time_this_iter_s": 32.14490222930908, "time_total_s": 1762.9318873882294, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afc60d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1762.9318873882294, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 33.48, "ram_util_percent": 82.56222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5237176029218569, "cur_kl_coeff": 3.2186508178710934e-07, "cur_lr": 0.0001, "total_loss": 3.951059995378767, "policy_loss": -0.005802282101533834, "vf_loss": 3.956862263073997, "vf_explained_var": -0.004737138369726756, "kl": 0.011117641444453902, "entropy": 1.1731380027437968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 34335.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4254936565364164, "cur_kl_coeff": 2.7939677238464354e-10, "cur_lr": 0.0001, "total_loss": 3.880242883591425, "policy_loss": -0.002287574583620188, "vf_loss": 3.882530451577807, "vf_explained_var": 0.00013226715345231313, "kl": 0.00838105060036375, "entropy": 1.1481626009184216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 34335.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "env_runners": {"episode_reward_max": 445.16187067951836, "episode_reward_min": -697.3741132102322, "episode_reward_mean": -12.056905945590625, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1187.061484515146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 43.972015347618566, "predator_policy": 1375.4838036209005}, "policy_reward_mean": {"prey_policy": -365.531585579999, "predator_policy": 359.5031326072039}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-488.9516503337235, -88.54311687481766, -316.61136620631083, 90.97414413715872, -375.4323698276857, -336.4741876149539, -541.6173038314737, 84.89999999999897, -172.64513652543116, -697.3741132102322, -7.242182748610915, -10.791277354840824, 128.54850575545612, -7.179915877402028, -48.28985523458319, -185.1675390801969, -173.22843492167738, -152.42041829253333, -256.1858014391454, 51.90000000000047, -338.6582433889826, -87.53250932041124, -322.14153898462115, -479.91698050178405, -84.84271996563322, -136.84591858517967, -426.12114723985786, -89.39029976334855, 207.43071564931537, -62.8562965165562, 54.57128289196299, -19.313328818078325, 23.11977123172354, -153.95775301947808, 304.7489038688759, -24.901520094053403, 211.2501480995073, -56.73483264700172, 70.18167211180378, 143.4035310205343, -348.00643025199673, 292.09261443818673, 22.100000000000048, 23.600000000000037, 103.19812882836473, 93.18090733762597, 44.145696265355, 15.399999999999961, 78.77297908026958, 73.33034557858883, -22.340576858638407, 21.00000000000003, 16.199999999999957, -9.884888231996062, -209.52274192629645, 9.161402213779864, 20.60000000000002, 43.20000000000038, 41.03064396447121, 38.90000000000028, 31.605150779515544, 25.85504415564974, 194.86967718999938, 39.01867652089854, 397.05359852278434, 33.80248101906039, 86.9089333171861, 31.304432657406046, 69.6640199665385, 425.571483886963, 182.16092693253606, 32.9000000000002, 24.100000000000072, 191.29877733801393, -112.49028100750724, 78.02561926088482, -41.062559619728624, 3.1831292144698713, 153.8289758657313, 56.88937673318395, 445.16187067951836, -176.36891246264258, 4.917217293311461, 56.97733029801369, -190.85011111056156, 267.71577350865175, 19.26363651141646, 365.8846091137265, 27.563621705305973, 25.656615105065903, 31.144070197020746, 172.19008397343475, -19.638548802918017, 148.90497127067846, 96.52766576009704, 5.433071082935664, 21.60000000000003, 64.10401132579865, -4.7139674175747555, -47.47006230937432], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-595.5222172564445, -873.0351730534563, -521.0509570841483, -715.7999274970191, -464.53181024859725, -401.31484591280815, -5.842355576518939, -132.63679716090382, -702.2149705050723, -777.6369309217272, -489.6396974254316, -451.57660299833043, -1135.7749417279563, -1187.061484515146, 17.45914481418155, 43.40000000000024, -1097.9859363730136, -1033.0724900197183, -988.6207030176876, -871.6481739286991, -730.6021028120131, -705.1227166934575, -461.43581722654415, -582.8302343249713, -665.6112041599856, -718.1287391139086, -917.100462166012, -525.0528804754133, -124.1099918865686, -377.8512660398669, -638.6939735207965, -767.6905580059994, -517.5968868245047, -216.39749644493168, -293.44577224957465, -589.9001351748728, -537.3957019076573, -464.3129809036823, 2.5640751831386077, 16.80086934799411, -857.0115905188517, -901.2610503166151, -626.4506854519128, -899.8771282593622, -536.6250636715972, -492.41492583515134, -845.5224020961979, -634.4541826690029, -555.6722369439983, -868.1880073882618, -604.8763502449914, -754.4977953838885, -781.7577386318275, -957.4613631586008, -666.8054495072981, -847.4278664850875, -307.5189079867874, 15.01295974867787, -251.8782140449213, -122.28944724939126, -164.72367090329965, -437.6056980532229, -193.20269986509047, -445.4042240817793, -902.6709320261423, 18.899999237059962, -688.6608837960351, -386.40973483438603, -775.4509472537051, 19.94479424262093, -511.3701063448707, -423.53190325270765, 9.157770163937133, -412.12831094780785, -484.18190493380155, -199.53541567502413, -415.036208658439, 11.862267490143955, -565.4905008837004, -57.71466399634533, -512.1793484058737, -572.4213750821943, -6.794051188542598, -535.9409337738439, -636.1117403457371, -44.23302306566083, -508.680408257862, -12.471908246091573, 18.780108429824267, -193.47076591943087, 28.76714998154627, -259.3220142931912, -451.884292480861, -120.1387113690385, -461.12290229960763, -194.40717112950958, -404.5245679083356, -673.2873390427353, -147.9602231758515, -370.3963534320347, -149.22231609315278, -225.5803137702795, -361.6585151665999, -227.7400979774085, -156.07472334471115, -446.2917927371103, -106.53615462288589, -152.25918594156173, -252.8754236269254, -444.7623874343067, -184.14058538489024, -275.67454477602075, -306.44422768490875, -222.13590457229122, 1.7007365749010066, -187.59801913117892, -65.724944244504, -105.25508593073903, 20.000000000000014, -1.4200600713708633, -799.2799799602459, -14.00942142114392, -194.2364569787969, -38.12300617235804, 43.972015347618566, -338.3960481603555, -10.27090494059664, -125.06637700516043, 17.076883665451405, -592.0343942066885, -30.30454638432721, -34.47241672642982, 8.204773538178676, -315.05185568039263, -55.167618358625155, -776.7283821666238, -373.0148370608763, -25.383061299281962, -137.98016456758617, -751.2502190963212, -433.5845495651422, -37.89697263363221, 9.172227472026076, -181.55867222944184, 10.757490288238092, -477.77914820508613, -411.6092069912721, 0.8013514153353863, -205.69129429011045, -300.17480706289365, -425.9923932021228, 29.626098161579737, -171.78404254359418, -526.0565542465948, -550.0436008569221, -348.329804339506, -6.346641982136903, -399.3066868378875, -210.36560929244212, -185.51453630255705, -673.7776003640087, 22.51623574140493, -444.91957472450866, -564.1748642101634, -50.48841301373602, -292.18547966053916, -164.6441251453838, -305.01484078762394, -433.2183782462034, -313.9304837366076, -45.193501384800555, -797.5435722513574, -176.4383051541558, -511.68944812212953, -713.115067079913, -32.76362544958852, -101.97865963674386, -78.50435247900866, -11.852358759666888, -29.28754581677871, -272.6108609680049, -29.14736849360297, -770.7417408143419, 20.000000000000014, -85.94908976001355, -136.20421929595605, -1173.7689288430727, -28.508275712424798, -777.1204817575252, -748.5794200504231, -233.09752017281477, -137.43351804041956, -11.427944382751381, -577.7315514561521, -300.11620117061324, 6.627685770315843, -311.36768697741496, -70.71382555278613, -209.87022484248646, -571.4139291023051], "policy_predator_policy_reward": [1.0664021819386735, 978.5393377942388, 541.9630369059334, 606.3447308004155, 538.5931156753858, 10.642174279708623, 29.32967098504049, 200.12362588954093, 315.42283668994713, 788.9966949091674, 57.549953571133486, 547.1921592376743, 405.73531879072834, 1375.4838036209005, 24.040855185818437, 0.0, 1131.2540567520034, 827.1592331152963, 1120.916990364309, 41.97777337184525, 604.5625455562797, 823.9200912005796, 424.3871902457487, 609.0875839509259, 778.8065596838746, 733.4818893454764, 627.9253952755824, 807.0480314884401, 32.06312206443384, 421.6082806274183, 877.9759013963735, 343.2410910502247, 28.169056286788997, 532.5968920609702, 328.3205629835795, 402.60492614833504, 690.6639610606678, 54.8589203115254, 26.88423067968353, 5.650824789183706, 486.5809792759939, 933.0334181704893, 736.4529316022342, 702.3423727886295, 695.7087866139874, 11.189663908139373, 995.7045994434203, 4.3550048199962905, 435.4500342194565, 903.56749014717, 578.8909389585694, 643.6372880851311, 904.3166156188922, 408.7813389316784, 496.0000360188062, 928.8429802102304, 291.62266987718687, 208.31399401024066, 0.0, 311.3113647777561, 181.1364570591542, 475.7641947893313, 148.15738875528749, 471.13620637350334, 701.8378511823498, 205.05285283845544, 697.905303362794, 223.20756224815094, 774.6692212763625, 285.5858356035969, 586.4697809002165, 323.5307086033093, 294.2260965467406, 319.9945923366394, 192.47915668092728, 434.5033312808989, 366.55434463883654, 106.8012686412636, 474.47434612380573, 292.13434977677593, 18.750635355505693, 717.8436578805666, 318.28467061116856, 516.542928789405, 493.4445293670467, 209.00023404435268, 136.4871316689005, 408.26518483505265, 88.73676219224879, 189.1520241257232, 195.65924863622598, 128.07652301304702, 370.3041780336811, 245.86452208157385, 445.66282137598614, 225.26725205313156, 602.6929429655203, 553.8919430658227, 482.65525875768935, 109.03166342878548, 329.7029521061247, 22.75910089866809, 557.5646491245112, 52.8339640194992, 324.31880432929086, 294.24771175253005, 226.72872366938032, 22.18172866307006, 483.5856692141218, 4.529399920816576, 23.103369313098284, 445.8731630615934, 157.6368455589283, 391.5432866982711, 221.84389745935124, 7.253385096926069, 39.24673048582718, 172.76394365388606, 20.320060071370822, 0.0, 38.24398801287397, 806.6505641480315, 115.46062960806296, 142.7538776987413, 250.50854267664954, 238.7851673260905, 91.02851742679113, 83.32744103986357, 466.93298132339476, 505.0781277406256, 49.200372771565114, 49.379071358252574, 76.53254541289863, 317.2234700465037, 155.18241441499208, 708.0180187676629, 371.3888820682059, 96.67303625849065, 622.0691758589096, 692.7326916919592, 246.9087172690297, 406.7337318622825, 9.827772527973897, 195.4586722294417, 224.82809333871688, 266.2935645781312, 231.32582760426965, 370.78080530968276, 320.8274426769162, 72.5483776685837, 369.9404190565816, 104.4514952448489, 423.6448741858258, 233.13316298463522, 358.1362692326969, 543.4202651782042, 207.38068097544166, 352.1016237103158, 255.77847766817757, 196.99104466000563, 479.31354478820134, 617.1096905139196, 355.5144898966179, 477.2110365754121, 15.346349249461321, 332.24476071812813, 295.3046623605044, 231.33163387051817, 0.0, 556.2987508722524, 556.1747690706861, 554.2780780741232, 311.17465739721484, 396.2167323904881, 533.9805114058679, 577.7827902373602, 9.340333662613242, 198.7063001584436, 63.28332805865857, 3.5131916228531423, 13.730615852853731, 319.1716838057759, 760.6097661046541, 162.32205868312357, 12.408495992712869, 190.1062642603367, 1067.3758620649064, 283.8063137612687, 494.244938200208, 1127.982629367837, 101.36785412181888, 274.5962551743502, 308.09709610502847, 302.6623997338758, 281.72186002397063, 75.8706667021271, 179.16483862163383, 198.20270649099334, 325.1807257918648, 408.6333658435531]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.809988663955391, "mean_inference_ms": 3.7095989406306806, "mean_action_processing_ms": 1.8715501082845067, "mean_env_wait_ms": 1.1383862476172382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032961368560791016, "StateBufferConnector_ms": 0.016751766204833984, "ViewRequirementAgentConnector_ms": 0.10073840618133545}, "num_episodes": 64, "episode_return_max": 445.16187067951836, "episode_return_min": -697.3741132102322, "episode_return_mean": -12.056905945590625, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 250.95058444691813, "num_env_steps_trained_throughput_per_sec": 250.95058444691813, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 1760000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1760000, "timers": {"training_iteration_time_ms": 32166.306, "restore_workers_time_ms": 0.023, "training_step_time_ms": 32165.255, "sample_time_ms": 1312.032, "learn_time_ms": 30823.499, "learn_throughput": 259.542, "synch_weights_time_ms": 23.15}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "done": false, "training_iteration": 55, "trial_id": "cd905_00000", "date": "2024-08-20_09-53-57", "timestamp": 1724127837, "time_this_iter_s": 31.9216628074646, "time_total_s": 1794.853550195694, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afc6f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1794.853550195694, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 31.29111111111111, "ram_util_percent": 82.66222222222224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.519140212568972, "cur_kl_coeff": 3.2186508178710934e-07, "cur_lr": 0.0001, "total_loss": 1.4901379814223639, "policy_loss": -0.004610520883256363, "vf_loss": 1.4947485017398048, "vf_explained_var": -0.0075630552238888215, "kl": 0.013876640697957833, "entropy": 1.1340312038149152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.43190648065554715, "cur_kl_coeff": 2.7939677238464354e-10, "cur_lr": 0.0001, "total_loss": 1.2518830482921903, "policy_loss": -0.00032014178171280833, "vf_loss": 1.2522031916512384, "vf_explained_var": 0.0015513843014126733, "kl": 0.0017563955261688793, "entropy": 1.0996291578762114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000}, "env_runners": {"episode_reward_max": 445.16187067951836, "episode_reward_min": -190.85011111056156, "episode_reward_mean": 47.1364353435086, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1173.7689288430727, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 33.225735441632175, "predator_policy": 1127.982629367837}, "policy_reward_mean": {"prey_policy": -131.95927571652788, "predator_policy": 155.5274933882822}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.100000000000072, 191.29877733801393, -112.49028100750724, 78.02561926088482, -41.062559619728624, 3.1831292144698713, 153.8289758657313, 56.88937673318395, 445.16187067951836, -176.36891246264258, 4.917217293311461, 56.97733029801369, -190.85011111056156, 267.71577350865175, 19.26363651141646, 365.8846091137265, 27.563621705305973, 25.656615105065903, 31.144070197020746, 172.19008397343475, -19.638548802918017, 148.90497127067846, 96.52766576009704, 5.433071082935664, 21.60000000000003, 64.10401132579865, -4.7139674175747555, -47.47006230937432, 29.963634787313147, 34.45936263388178, 50.10000000000048, 45.500000000000405, 27.000000000000114, 27.500000000000107, 26.200000000000102, 40.60000000000033, 33.800000000000225, 37.6452384820262, 41.90000000000034, 48.50000000000045, 53.054160091580286, -7.99379551447206, 9.856016581216142, 49.47490919736983, 30.90000000000017, 100.15824229039097, 36.80000000000025, 75.5820298648744, 35.60000000000022, 11.570991295782663, 51.900000000000496, 33.98967811103753, 37.40000000000026, 30.28284667959899, 44.10000000000039, 15.57705895818603, 29.400000000000148, 30.50000000000015, 35.90000000000024, 40.855331027779584, 41.567565982906444, 25.43270696945399, 47.10896508874274, 40.60000000000032, 51.100000000000485, 48.81294378216743, 41.90000000000033, 52.30000000000049, 136.77272409555962, 34.800000000000225, 35.588047818072184, 34.200000000000216, 24.179678474224282, 37.74178400511683, 43.78906031051543, 68.82134319546341, 63.88483857398259, 28.753307467418317, 43.90000000000036, -37.656047028706155, 29.000000000000124, 52.700000000000436, 43.00000000000036, 42.800000000000374, 26.319165478976682, 49.60000000000046, 33.23489283350722, 61.254491133556854, 40.3000000000003, 35.20000000000023, 67.17472684772609, 92.83921938147375, 30.40000000000017, 52.100000000000506, 46.43368822599931, 23.26441760507997, 53.90000000000052, 176.61774283679344, 20.152665140225434, 17.90391813907578], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [10.757490288238092, -477.77914820508613, -411.6092069912721, 0.8013514153353863, -205.69129429011045, -300.17480706289365, -425.9923932021228, 29.626098161579737, -171.78404254359418, -526.0565542465948, -550.0436008569221, -348.329804339506, -6.346641982136903, -399.3066868378875, -210.36560929244212, -185.51453630255705, -673.7776003640087, 22.51623574140493, -444.91957472450866, -564.1748642101634, -50.48841301373602, -292.18547966053916, -164.6441251453838, -305.01484078762394, -433.2183782462034, -313.9304837366076, -45.193501384800555, -797.5435722513574, -176.4383051541558, -511.68944812212953, -713.115067079913, -32.76362544958852, -101.97865963674386, -78.50435247900866, -11.852358759666888, -29.28754581677871, -272.6108609680049, -29.14736849360297, -770.7417408143419, 20.000000000000014, -85.94908976001355, -136.20421929595605, -1173.7689288430727, -28.508275712424798, -777.1204817575252, -748.5794200504231, -233.09752017281477, -137.43351804041956, -11.427944382751381, -577.7315514561521, -300.11620117061324, 6.627685770315843, -311.36768697741496, -70.71382555278613, -209.87022484248646, -571.4139291023051, -2.3289928897690984, -147.94562611766625, -201.64587252990208, -83.040160697128, 20.136228746276863, -2.9023062828276704, -231.6741054151846, 26.004866610993684, -139.60919228489993, -141.39610885025945, -168.87761214721613, -112.4040321745861, -425.9590593170454, -6.840823576457542, -62.219049311143266, -35.81528896698059, -72.19068303687534, -12.84468700222375, -3.391895944252655, -16.007156643598798, 28.100000000000147, -137.76079344637617, -8.899358144480452, -46.487895342797714, -32.05728623007323, 18.624837941161058, -54.16345305897037, -129.50543190752208, -301.0703110592332, -36.31637435182713, -11.230407211997097, 30.224470900480025, 15.303960910761106, -198.4025846097131, -154.042460091559, -306.6795898505849, -5.0525301830076295, -60.401507324689845, -140.7336650362483, -1.9427272962480617, -166.94698785277933, 9.595667492337848, -64.99675559796805, -63.034657487195105, -12.723438047238178, -0.6068918651612054, 20.000000000000014, -226.99154444848315, -15.887453391079948, 6.090633584514375, -89.31768639658694, -54.172223861170345, -183.64640321143276, -45.25967909765, -484.0980629154938, -23.209316476211143, -0.7693142927989792, -249.9745971192102, -383.81568105877966, 3.706335150348267, -6.814296704647411, -40.54713171562982, -16.40442970253897, 14.84678226943434, -10.412783835078173, 3.8614865925828026, -112.0154051590638, -19.497303360907566, -49.19692549336269, 17.758900121987118, 2.781065527654421, -209.01351196720995, 25.097062672485738, -32.12031534326297, -51.36595055792706, 8.54303450152934, -150.45884263233216, -19.321884762781373, 20.000000000000014, 10.189551345804496, 9.649249687422873, -379.07902779533197, -102.43587332880472, -4.47808753896194, 10.393843960870555, -99.99100118874145, -63.71593162266043, -28.79682170589347, -61.33759353782042, -191.27275426400976, 6.5032617295865816, -5.100130610472933, -6.918435451170241, 18.026556140295177, -377.47295683290685, -15.324874293775812, -49.861596587123216, 29.355967322252777, -8.085529994445608, -10.989239596888217, -10.007719988028537, 14.21386320907204, -149.5057175983709, -182.69793533703617, -173.89364056088442, -17.86980169566307, 23.929742857144547, -158.55003534819102, 13.112282122416147, -146.13539307010484, -247.9268566483429, 17.08344473263797, -232.29658762042067, -32.895596345499875, -17.814377087991808, -2.4356096951104043, -31.503875885279257, 0.945549944561695, 17.332655430849105, -18.93994374774981, 1.1559977562035717, 11.977659086533045, 20.000000000000014, -160.2662604168678, -116.25366751795346, 14.288063871294572, -15.791087069096063, -191.84014909182116, 15.296551323568405, -248.11068955259086, 0.5661275711084219, 26.109065231241186, 16.239866901780104, -40.842333677860665, -54.64954953121155, -159.90503262971458, 33.225735441632175, 0.8102128390322217, -206.2848623482542, 12.454235246278172, -29.749983207880632, -31.85471036310566, -254.41611833770457, -58.4456204783678], "policy_predator_policy_reward": [224.82809333871688, 266.2935645781312, 231.32582760426965, 370.78080530968276, 320.8274426769162, 72.5483776685837, 369.9404190565816, 104.4514952448489, 423.6448741858258, 233.13316298463522, 358.1362692326969, 543.4202651782042, 207.38068097544166, 352.1016237103158, 255.77847766817757, 196.99104466000563, 479.31354478820134, 617.1096905139196, 355.5144898966179, 477.2110365754121, 15.346349249461321, 332.24476071812813, 295.3046623605044, 231.33163387051817, 0.0, 556.2987508722524, 556.1747690706861, 554.2780780741232, 311.17465739721484, 396.2167323904881, 533.9805114058679, 577.7827902373602, 9.340333662613242, 198.7063001584436, 63.28332805865857, 3.5131916228531423, 13.730615852853731, 319.1716838057759, 760.6097661046541, 162.32205868312357, 12.408495992712869, 190.1062642603367, 1067.3758620649064, 283.8063137612687, 494.244938200208, 1127.982629367837, 101.36785412181888, 274.5962551743502, 308.09709610502847, 302.6623997338758, 281.72186002397063, 75.8706667021271, 179.16483862163383, 198.20270649099334, 325.1807257918648, 408.6333658435531, 104.54609816464782, 75.69215563009969, 4.048117367590655, 315.0972784933198, 11.363771253723156, 21.502306282827707, 32.66159140524073, 218.5076473989498, 266.27809164269974, 41.72720949245884, 41.18376558404785, 267.5978787377537, 195.9515771379524, 263.04830575555167, 73.40878079075837, 65.22555748736546, 2.473139711781875, 116.3622303273169, 46.27986202719749, 10.764429042680174, 131.85186297277485, 19.708930473600752, 26.431023657031503, 77.45622983024697, 50.433762958746215, 16.052845421745992, 13.31697434796864, 162.35811510405082, 4.22092357621359, 343.0217784160645, 29.53040721199727, 0.9504382968895346, 186.25710226145102, 27.741521437500367, 193.74124877432774, 367.1390434582086, 24.95253018300769, 77.30150732468914, 70.32670261619529, 147.93171958117534, 181.62674763441086, 11.324572726029896, 1.8603482543802734, 137.74205612656385, 0.0, 65.23032991239957, 235.63644755555933, 5.344775003960484, 34.287453391080206, 12.909366415485591, 172.28790833053793, 1.4848486068172506, 20.995012437499607, 252.01106987158283, 276.1282388220564, 246.75619952783651, 87.22313725642778, 192.92077415558094, 41.90954351159963, 368.6998023968321, 79.31182388519855, 3.949604535078982, 42.412978460884126, 0.0, 23.56235031703232, 24.556512908369264, 22.208595990434343, 134.73681949899023, 16.542512301276833, 62.00447815884125, 227.36914198176993, 19.463304457784975, 16.152856577521288, 41.970396093256284, 32.81697334492289, 58.8188864936417, 32.27896854139272, 179.40175885372042, 0.0, 22.110448654195476, 180.49346827296574, 325.7090339305063, 8.95996905695158, 132.7539918108144, 58.95744088198003, 66.22776416396185, 79.94009914771199, 46.772654180841215, 250.24187853297155, 26.548147743081508, 25.02846831876267, 11.310184567240274, 6.400051064836115, 26.280888556554064, 322.35163816157825, 139.2675361605697, 35.35852135887826, 49.031946479974444, 14.241148538298088, 33.58692852045415, 0.9408965362952191, 38.75296024266128, 12.941317096818944, 281.6062888098802, 30.98337688361547, 189.78006537293192, 174.32713903811114, 12.993153452934978, 160.56814224888006, 15.454968698807843, 79.72449125263627, 193.91892066306826, 46.18128026181811, 245.33006918307896, 0.912806310945774, 68.93718047215663, 43.19626571318722, 20.596953061037542, 27.1948014372759, 35.666978013181385, 16.51291397781854, 10.653429179444775, 162.6278346758136, 12.838425741053424, 23.199685594491157, 145.94064489989282, 208.84048546902343, 91.6299700733685, 255.76328527571732, 7.450852953304777, 18.533872428891573, 6.89093476875893, 62.41147816966357, 8.624676832416075, 233.06780940064058, 4.751190365364468, 1.074264558368063, 18.789787160967776, 203.47448102906495, 166.97388890970518, 8.736252757570579, 73.02110595364167, 33.41282700478074, 297.35282995036954]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.798815257810875, "mean_inference_ms": 3.6983098748087504, "mean_action_processing_ms": 1.8615591203779729, "mean_env_wait_ms": 1.13477660501962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004193544387817383, "StateBufferConnector_ms": 0.011983871459960938, "ViewRequirementAgentConnector_ms": 0.09450554847717285}, "num_episodes": 72, "episode_return_max": 445.16187067951836, "episode_return_min": -190.85011111056156, "episode_return_mean": 47.1364353435086, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 245.9217181458685, "num_env_steps_trained_throughput_per_sec": 245.9217181458685, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 1792000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1792000, "timers": {"training_iteration_time_ms": 32224.607, "restore_workers_time_ms": 0.024, "training_step_time_ms": 32223.619, "sample_time_ms": 1304.714, "learn_time_ms": 30890.953, "learn_throughput": 258.976, "synch_weights_time_ms": 21.276}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000}, "done": false, "training_iteration": 56, "trial_id": "cd905_00000", "date": "2024-08-20_09-54-30", "timestamp": 1724127870, "time_this_iter_s": 32.57281994819641, "time_total_s": 1827.4263701438904, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f0df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1827.4263701438904, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 35.05000000000001, "ram_util_percent": 82.60869565217389}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4737457605699698, "cur_kl_coeff": 3.2186508178710934e-07, "cur_lr": 0.0001, "total_loss": 2.7838406799331543, "policy_loss": -0.0016557498953290403, "vf_loss": 2.7854964367927066, "vf_explained_var": -0.0013233162107921781, "kl": 0.0070503081076878065, "entropy": 1.0623275102130951, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 35595.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.37967877115995163, "cur_kl_coeff": 1.3969838619232177e-10, "cur_lr": 0.0001, "total_loss": 1.7732321869759333, "policy_loss": -0.0024019746095060358, "vf_loss": 1.7756341580360655, "vf_explained_var": -0.00013269318474663628, "kl": 0.003196356947785081, "entropy": 1.0633501631872995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 35595.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "env_runners": {"episode_reward_max": 445.16187067951836, "episode_reward_min": -190.85011111056156, "episode_reward_mean": 47.1364353435086, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1173.7689288430727, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 33.225735441632175, "predator_policy": 1127.982629367837}, "policy_reward_mean": {"prey_policy": -131.95927571652788, "predator_policy": 155.5274933882822}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.100000000000072, 191.29877733801393, -112.49028100750724, 78.02561926088482, -41.062559619728624, 3.1831292144698713, 153.8289758657313, 56.88937673318395, 445.16187067951836, -176.36891246264258, 4.917217293311461, 56.97733029801369, -190.85011111056156, 267.71577350865175, 19.26363651141646, 365.8846091137265, 27.563621705305973, 25.656615105065903, 31.144070197020746, 172.19008397343475, -19.638548802918017, 148.90497127067846, 96.52766576009704, 5.433071082935664, 21.60000000000003, 64.10401132579865, -4.7139674175747555, -47.47006230937432, 29.963634787313147, 34.45936263388178, 50.10000000000048, 45.500000000000405, 27.000000000000114, 27.500000000000107, 26.200000000000102, 40.60000000000033, 33.800000000000225, 37.6452384820262, 41.90000000000034, 48.50000000000045, 53.054160091580286, -7.99379551447206, 9.856016581216142, 49.47490919736983, 30.90000000000017, 100.15824229039097, 36.80000000000025, 75.5820298648744, 35.60000000000022, 11.570991295782663, 51.900000000000496, 33.98967811103753, 37.40000000000026, 30.28284667959899, 44.10000000000039, 15.57705895818603, 29.400000000000148, 30.50000000000015, 35.90000000000024, 40.855331027779584, 41.567565982906444, 25.43270696945399, 47.10896508874274, 40.60000000000032, 51.100000000000485, 48.81294378216743, 41.90000000000033, 52.30000000000049, 136.77272409555962, 34.800000000000225, 35.588047818072184, 34.200000000000216, 24.179678474224282, 37.74178400511683, 43.78906031051543, 68.82134319546341, 63.88483857398259, 28.753307467418317, 43.90000000000036, -37.656047028706155, 29.000000000000124, 52.700000000000436, 43.00000000000036, 42.800000000000374, 26.319165478976682, 49.60000000000046, 33.23489283350722, 61.254491133556854, 40.3000000000003, 35.20000000000023, 67.17472684772609, 92.83921938147375, 30.40000000000017, 52.100000000000506, 46.43368822599931, 23.26441760507997, 53.90000000000052, 176.61774283679344, 20.152665140225434, 17.90391813907578], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [10.757490288238092, -477.77914820508613, -411.6092069912721, 0.8013514153353863, -205.69129429011045, -300.17480706289365, -425.9923932021228, 29.626098161579737, -171.78404254359418, -526.0565542465948, -550.0436008569221, -348.329804339506, -6.346641982136903, -399.3066868378875, -210.36560929244212, -185.51453630255705, -673.7776003640087, 22.51623574140493, -444.91957472450866, -564.1748642101634, -50.48841301373602, -292.18547966053916, -164.6441251453838, -305.01484078762394, -433.2183782462034, -313.9304837366076, -45.193501384800555, -797.5435722513574, -176.4383051541558, -511.68944812212953, -713.115067079913, -32.76362544958852, -101.97865963674386, -78.50435247900866, -11.852358759666888, -29.28754581677871, -272.6108609680049, -29.14736849360297, -770.7417408143419, 20.000000000000014, -85.94908976001355, -136.20421929595605, -1173.7689288430727, -28.508275712424798, -777.1204817575252, -748.5794200504231, -233.09752017281477, -137.43351804041956, -11.427944382751381, -577.7315514561521, -300.11620117061324, 6.627685770315843, -311.36768697741496, -70.71382555278613, -209.87022484248646, -571.4139291023051, -2.3289928897690984, -147.94562611766625, -201.64587252990208, -83.040160697128, 20.136228746276863, -2.9023062828276704, -231.6741054151846, 26.004866610993684, -139.60919228489993, -141.39610885025945, -168.87761214721613, -112.4040321745861, -425.9590593170454, -6.840823576457542, -62.219049311143266, -35.81528896698059, -72.19068303687534, -12.84468700222375, -3.391895944252655, -16.007156643598798, 28.100000000000147, -137.76079344637617, -8.899358144480452, -46.487895342797714, -32.05728623007323, 18.624837941161058, -54.16345305897037, -129.50543190752208, -301.0703110592332, -36.31637435182713, -11.230407211997097, 30.224470900480025, 15.303960910761106, -198.4025846097131, -154.042460091559, -306.6795898505849, -5.0525301830076295, -60.401507324689845, -140.7336650362483, -1.9427272962480617, -166.94698785277933, 9.595667492337848, -64.99675559796805, -63.034657487195105, -12.723438047238178, -0.6068918651612054, 20.000000000000014, -226.99154444848315, -15.887453391079948, 6.090633584514375, -89.31768639658694, -54.172223861170345, -183.64640321143276, -45.25967909765, -484.0980629154938, -23.209316476211143, -0.7693142927989792, -249.9745971192102, -383.81568105877966, 3.706335150348267, -6.814296704647411, -40.54713171562982, -16.40442970253897, 14.84678226943434, -10.412783835078173, 3.8614865925828026, -112.0154051590638, -19.497303360907566, -49.19692549336269, 17.758900121987118, 2.781065527654421, -209.01351196720995, 25.097062672485738, -32.12031534326297, -51.36595055792706, 8.54303450152934, -150.45884263233216, -19.321884762781373, 20.000000000000014, 10.189551345804496, 9.649249687422873, -379.07902779533197, -102.43587332880472, -4.47808753896194, 10.393843960870555, -99.99100118874145, -63.71593162266043, -28.79682170589347, -61.33759353782042, -191.27275426400976, 6.5032617295865816, -5.100130610472933, -6.918435451170241, 18.026556140295177, -377.47295683290685, -15.324874293775812, -49.861596587123216, 29.355967322252777, -8.085529994445608, -10.989239596888217, -10.007719988028537, 14.21386320907204, -149.5057175983709, -182.69793533703617, -173.89364056088442, -17.86980169566307, 23.929742857144547, -158.55003534819102, 13.112282122416147, -146.13539307010484, -247.9268566483429, 17.08344473263797, -232.29658762042067, -32.895596345499875, -17.814377087991808, -2.4356096951104043, -31.503875885279257, 0.945549944561695, 17.332655430849105, -18.93994374774981, 1.1559977562035717, 11.977659086533045, 20.000000000000014, -160.2662604168678, -116.25366751795346, 14.288063871294572, -15.791087069096063, -191.84014909182116, 15.296551323568405, -248.11068955259086, 0.5661275711084219, 26.109065231241186, 16.239866901780104, -40.842333677860665, -54.64954953121155, -159.90503262971458, 33.225735441632175, 0.8102128390322217, -206.2848623482542, 12.454235246278172, -29.749983207880632, -31.85471036310566, -254.41611833770457, -58.4456204783678], "policy_predator_policy_reward": [224.82809333871688, 266.2935645781312, 231.32582760426965, 370.78080530968276, 320.8274426769162, 72.5483776685837, 369.9404190565816, 104.4514952448489, 423.6448741858258, 233.13316298463522, 358.1362692326969, 543.4202651782042, 207.38068097544166, 352.1016237103158, 255.77847766817757, 196.99104466000563, 479.31354478820134, 617.1096905139196, 355.5144898966179, 477.2110365754121, 15.346349249461321, 332.24476071812813, 295.3046623605044, 231.33163387051817, 0.0, 556.2987508722524, 556.1747690706861, 554.2780780741232, 311.17465739721484, 396.2167323904881, 533.9805114058679, 577.7827902373602, 9.340333662613242, 198.7063001584436, 63.28332805865857, 3.5131916228531423, 13.730615852853731, 319.1716838057759, 760.6097661046541, 162.32205868312357, 12.408495992712869, 190.1062642603367, 1067.3758620649064, 283.8063137612687, 494.244938200208, 1127.982629367837, 101.36785412181888, 274.5962551743502, 308.09709610502847, 302.6623997338758, 281.72186002397063, 75.8706667021271, 179.16483862163383, 198.20270649099334, 325.1807257918648, 408.6333658435531, 104.54609816464782, 75.69215563009969, 4.048117367590655, 315.0972784933198, 11.363771253723156, 21.502306282827707, 32.66159140524073, 218.5076473989498, 266.27809164269974, 41.72720949245884, 41.18376558404785, 267.5978787377537, 195.9515771379524, 263.04830575555167, 73.40878079075837, 65.22555748736546, 2.473139711781875, 116.3622303273169, 46.27986202719749, 10.764429042680174, 131.85186297277485, 19.708930473600752, 26.431023657031503, 77.45622983024697, 50.433762958746215, 16.052845421745992, 13.31697434796864, 162.35811510405082, 4.22092357621359, 343.0217784160645, 29.53040721199727, 0.9504382968895346, 186.25710226145102, 27.741521437500367, 193.74124877432774, 367.1390434582086, 24.95253018300769, 77.30150732468914, 70.32670261619529, 147.93171958117534, 181.62674763441086, 11.324572726029896, 1.8603482543802734, 137.74205612656385, 0.0, 65.23032991239957, 235.63644755555933, 5.344775003960484, 34.287453391080206, 12.909366415485591, 172.28790833053793, 1.4848486068172506, 20.995012437499607, 252.01106987158283, 276.1282388220564, 246.75619952783651, 87.22313725642778, 192.92077415558094, 41.90954351159963, 368.6998023968321, 79.31182388519855, 3.949604535078982, 42.412978460884126, 0.0, 23.56235031703232, 24.556512908369264, 22.208595990434343, 134.73681949899023, 16.542512301276833, 62.00447815884125, 227.36914198176993, 19.463304457784975, 16.152856577521288, 41.970396093256284, 32.81697334492289, 58.8188864936417, 32.27896854139272, 179.40175885372042, 0.0, 22.110448654195476, 180.49346827296574, 325.7090339305063, 8.95996905695158, 132.7539918108144, 58.95744088198003, 66.22776416396185, 79.94009914771199, 46.772654180841215, 250.24187853297155, 26.548147743081508, 25.02846831876267, 11.310184567240274, 6.400051064836115, 26.280888556554064, 322.35163816157825, 139.2675361605697, 35.35852135887826, 49.031946479974444, 14.241148538298088, 33.58692852045415, 0.9408965362952191, 38.75296024266128, 12.941317096818944, 281.6062888098802, 30.98337688361547, 189.78006537293192, 174.32713903811114, 12.993153452934978, 160.56814224888006, 15.454968698807843, 79.72449125263627, 193.91892066306826, 46.18128026181811, 245.33006918307896, 0.912806310945774, 68.93718047215663, 43.19626571318722, 20.596953061037542, 27.1948014372759, 35.666978013181385, 16.51291397781854, 10.653429179444775, 162.6278346758136, 12.838425741053424, 23.199685594491157, 145.94064489989282, 208.84048546902343, 91.6299700733685, 255.76328527571732, 7.450852953304777, 18.533872428891573, 6.89093476875893, 62.41147816966357, 8.624676832416075, 233.06780940064058, 4.751190365364468, 1.074264558368063, 18.789787160967776, 203.47448102906495, 166.97388890970518, 8.736252757570579, 73.02110595364167, 33.41282700478074, 297.35282995036954]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.798815257810875, "mean_inference_ms": 3.6983098748087504, "mean_action_processing_ms": 1.8615591203779729, "mean_env_wait_ms": 1.13477660501962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004193544387817383, "StateBufferConnector_ms": 0.011983871459960938, "ViewRequirementAgentConnector_ms": 0.09450554847717285}, "num_episodes": 0, "episode_return_max": 445.16187067951836, "episode_return_min": -190.85011111056156, "episode_return_mean": 47.1364353435086, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 247.20676491750473, "num_env_steps_trained_throughput_per_sec": 247.20676491750473, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 1824000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1824000, "timers": {"training_iteration_time_ms": 32265.239, "restore_workers_time_ms": 0.024, "training_step_time_ms": 32264.299, "sample_time_ms": 1322.686, "learn_time_ms": 30913.917, "learn_throughput": 258.783, "synch_weights_time_ms": 21.172}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "done": false, "training_iteration": 57, "trial_id": "cd905_00000", "date": "2024-08-20_09-55-02", "timestamp": 1724127902, "time_this_iter_s": 32.3795862197876, "time_total_s": 1859.805956363678, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169eab790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1859.805956363678, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 33.67608695652174, "ram_util_percent": 82.42608695652174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6276208394221843, "cur_kl_coeff": 3.2186508178710934e-07, "cur_lr": 0.0001, "total_loss": 3.0173345111665273, "policy_loss": -0.0013362774640203468, "vf_loss": 3.0186707867516414, "vf_explained_var": -0.0003883275720808241, "kl": 0.016188075112886655, "entropy": 1.044299768833887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 36225.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3312685709387537, "cur_kl_coeff": 6.984919309616089e-11, "cur_lr": 0.0001, "total_loss": 1.9912583818511358, "policy_loss": -0.0015427757579360216, "vf_loss": 1.9928011599041167, "vf_explained_var": -0.00021492100897289458, "kl": 0.0021732677264654264, "entropy": 1.0160228710325938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 36225.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000}, "env_runners": {"episode_reward_max": 176.61774283679344, "episode_reward_min": -917.8695563659536, "episode_reward_mean": -0.4242311199925883, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1053.992660062001, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 41.545228585034806, "predator_policy": 1144.188545933598}, "policy_reward_mean": {"prey_policy": -73.69012305809012, "predator_policy": 73.47800749809367}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.179678474224282, 37.74178400511683, 43.78906031051543, 68.82134319546341, 63.88483857398259, 28.753307467418317, 43.90000000000036, -37.656047028706155, 29.000000000000124, 52.700000000000436, 43.00000000000036, 42.800000000000374, 26.319165478976682, 49.60000000000046, 33.23489283350722, 61.254491133556854, 40.3000000000003, 35.20000000000023, 67.17472684772609, 92.83921938147375, 30.40000000000017, 52.100000000000506, 46.43368822599931, 23.26441760507997, 53.90000000000052, 176.61774283679344, 20.152665140225434, 17.90391813907578, 31.700000000000184, 38.90000000000028, -917.8695563659536, 29.783938612860595, 25.78626599930697, 62.60000000000047, 43.84123657835731, 41.000000000000306, -222.10539717058006, 50.60000000000048, 39.72751965732438, -535.1368368241717, 23.808333167764893, 37.20000000000026, 35.00000000000022, 46.0000000000004, 40.00000000000031, 42.50000000000035, -144.04649698243225, 35.20000000000023, 63.800000000000516, 32.974999503294725, -382.2401759952433, 56.90000000000052, 70.7483032969309, 39.009654298242395, 5.225663913825635, 34.900000000000226, 35.11666633552992, -44.42450639249054, 34.50000000000022, 67.54515933865045, 35.260577527381805, 45.65039870105294, 32.797139210289394, -357.01945255049975, 33.14426651335312, 62.50000000000048, 59.400000000000475, 45.421212147483445, -185.63353230967456, 74.22204612587115, 57.30000000000048, 37.50000000000026, -392.640587413192, 38.90000000000028, 47.600000000000435, 44.30000000000038, -210.46809640876634, 39.700000000000294, 49.764721114172715, 37.600000000000264, 33.68856846540228, 37.40000000000026, 52.70000000000046, 36.00000000000024, 36.007882874404714, 34.50000000000022, 35.00000000000023, -205.15462237739655, 42.000000000000334, 52.50000000000049, 54.500000000000476, -265.46314759148913, 41.585833856278185, 23.928399830646935, 36.200000000000244, 64.1990931795684, 44.15993915561412, 50.80000000000049, 34.47258435857849, 37.10000000000026], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-61.33759353782042, -191.27275426400976, 6.5032617295865816, -5.100130610472933, -6.918435451170241, 18.026556140295177, -377.47295683290685, -15.324874293775812, -49.861596587123216, 29.355967322252777, -8.085529994445608, -10.989239596888217, -10.007719988028537, 14.21386320907204, -149.5057175983709, -182.69793533703617, -173.89364056088442, -17.86980169566307, 23.929742857144547, -158.55003534819102, 13.112282122416147, -146.13539307010484, -247.9268566483429, 17.08344473263797, -232.29658762042067, -32.895596345499875, -17.814377087991808, -2.4356096951104043, -31.503875885279257, 0.945549944561695, 17.332655430849105, -18.93994374774981, 1.1559977562035717, 11.977659086533045, 20.000000000000014, -160.2662604168678, -116.25366751795346, 14.288063871294572, -15.791087069096063, -191.84014909182116, 15.296551323568405, -248.11068955259086, 0.5661275711084219, 26.109065231241186, 16.239866901780104, -40.842333677860665, -54.64954953121155, -159.90503262971458, 33.225735441632175, 0.8102128390322217, -206.2848623482542, 12.454235246278172, -29.749983207880632, -31.85471036310566, -254.41611833770457, -58.4456204783678, -124.90365016439418, -19.647206352954072, 13.36520670901752, 15.809257929933162, -1053.992660062001, -1008.0654422375505, -5.811063152689009, -67.21161511686238, -21.546202095988143, -45.532995278350846, -39.66955201155157, 35.38498402408234, -12.198594791249514, 6.839338699816066, -14.112966277191804, 21.31114147656617, -247.14630568742214, -265.5651574299757, 15.832745322016505, -24.639589203801933, 7.872580094868308, 1.0298827615482165, -631.5443250481505, -731.9243126481464, -7.988131753850412, -94.42474876122655, -137.0694375288441, 18.003505527401895, -127.91977103726902, 7.607210079895442, 20.000000000000014, 10.654856514589415, -51.969010873699055, -82.29980797893464, -1.7709004574374405, -1.5390414447104575, -178.49443199896942, -223.15202455355032, 9.612494469173221, -89.7362507735591, 23.66525430457491, 33.50000000000024, 5.158331180943045, -71.35712691018705, -489.43036511413584, -497.7315726280588, 32.856282371006856, 21.80000000000004, -5.636295760086391, 30.542927120513877, -122.63994294161859, 20.000000000000014, -58.014943714919866, -26.942374135086865, -45.94034994381986, -2.282227484625337, -5.653463040813747, 12.900741381706473, -58.0504155387103, -137.0844632575721, -19.61000719343322, -60.353911098080964, 20.000000000000014, -31.557504998543948, 8.072951866800292, -7.460311702716009, -37.71520062634964, -67.3744017555462, 2.0701613523455524, -88.08329231147076, -488.2607677799292, -457.9258210308957, -2.8776050419841877, -5.195942881970899, 6.02429207991881, 41.545228585034806, 20.000000000000014, -0.8438706140261163, 7.732646355679547, 18.982841974550194, -334.8446692798108, -251.39790449401397, 27.350056712953247, 32.473595776573426, 20.7026145127738, 15.189253768368982, 18.94569454943938, -9.527408418308104, -435.3510576168602, -510.0290128236989, -23.211851822468404, 20.000000000000014, 20.000000000000014, -21.361347417464657, -114.45069019408962, -0.6601839086286065, -306.58203858928647, -277.2419374992814, 17.76574965725844, 18.94597155145965, 20.000000000000014, -3.3656152040678813, 9.827022156685473, 5.250780949655031, -1.4848378434762577, 5.551169300748635, -14.992540690938325, 4.895070398493308, -9.725321406360502, 1.8730681496696253, -6.2225483116347675, -49.62269047367297, -34.784560764105215, -4.348943068855236, -67.73801530949046, -73.62776729296282, 5.860929459993697, -38.48600094759759, -272.7496143540182, -215.76433554495716, -15.00724202440551, -26.868159191778716, 28.100000000000147, -19.039642100136348, 8.61047347611017, 15.531606273213326, -302.60098894370446, -391.3566507270692, 17.40102000683312, -8.03559658795271, -14.833310692311457, -19.70699940593842, 17.646268397397606, -39.04313400648902, 35.27819416554357, 23.526084705792105, -84.35413449442945, -11.335036634563737, -1.4949683260404916, -41.49684873569922, -1.0006523315597962, -21.60891487151541, -25.62290803499816, 6.568782102810909], "policy_predator_policy_reward": [250.24187853297155, 26.548147743081508, 25.02846831876267, 11.310184567240274, 6.400051064836115, 26.280888556554064, 322.35163816157825, 139.2675361605697, 35.35852135887826, 49.031946479974444, 14.241148538298088, 33.58692852045415, 0.9408965362952191, 38.75296024266128, 12.941317096818944, 281.6062888098802, 30.98337688361547, 189.78006537293192, 174.32713903811114, 12.993153452934978, 160.56814224888006, 15.454968698807843, 79.72449125263627, 193.91892066306826, 46.18128026181811, 245.33006918307896, 0.912806310945774, 68.93718047215663, 43.19626571318722, 20.596953061037542, 27.1948014372759, 35.666978013181385, 16.51291397781854, 10.653429179444775, 162.6278346758136, 12.838425741053424, 23.199685594491157, 145.94064489989282, 208.84048546902343, 91.6299700733685, 255.76328527571732, 7.450852953304777, 18.533872428891573, 6.89093476875893, 62.41147816966357, 8.624676832416075, 233.06780940064058, 4.751190365364468, 1.074264558368063, 18.789787160967776, 203.47448102906495, 166.97388890970518, 8.736252757570579, 73.02110595364167, 33.41282700478074, 297.35282995036954, 5.087662330595096, 171.163194186753, 5.9347932909824515, 3.7907420700667998, 1144.188545933598, 0.0, 51.771953344174136, 51.03466353823692, 50.47679794665897, 42.3886654269874, 56.86955201155182, 10.015015975917892, 49.20049266979056, 0.0, 13.256246157815196, 20.54557864281065, 284.35168555434456, 6.2543803924731325, 47.79278678100483, 11.614057100780789, 4.785919838956354, 26.039136961951158, 10.603439808573219, 817.7283610635519, 101.57235978287093, 24.648853899970153, 50.5252271027969, 105.7407048986446, 0.0, 155.3125609573728, 0.0, 15.345143485410555, 95.66209073247981, 78.60672812015287, 25.47090045743745, 20.339041444710478, 253.23087460835, 4.369084961737399, 17.660398282469497, 97.66335802191543, 6.634745695425164, 0.0, 94.32775191116926, 4.846043321368405, 580.0816326939627, 24.840129052988804, 2.2437176289933767, 0.0, 11.469371236558793, 34.37230069994486, 31.972885884871, 109.67671135498884, 79.3730276214651, 10.809954142366893, 50.482118140187175, 32.64045928825827, 24.495129873048867, 3.3742581215880474, 1.254143562064682, 149.4562288417266, 79.49276405031364, 34.97115424120046, 45.93407975038502, 33.168584586809374, 16.454101519949013, 18.193835843348232, 148.3686444502577, 2.371356632690384, 77.1876380704623, 41.62263209895117, 518.4106579211368, 70.75647833918728, 0.0, 41.21781443730811, 13.275707920081155, 1.6547714149654311, 38.5742777325586, 1.6695928814674825, 8.002761602801383, 10.702962214451906, 388.4867749322513, 12.12226653189934, 6.948450349298184, 7.449943287046892, 16.115507792343703, 5.2926239265135075, 0.9543054505606221, 27.12740841830824, 452.5213253041595, 100.21815772320753, 42.11185182246865, 0.0, 45.496752927271565, 3.4645944901933166, 132.65069019408872, 26.76018390862859, 365.7391890128491, 7.616690666953604, 2.0342503427415464, 0.9540284485403521, 23.255849633142695, 9.87448668509747, 0.0, 22.522196893659416, 22.90309444881241, 6.71914255931715, 33.69254069093857, 13.80492960150666, 16.667371764471802, 43.884881492219144, 60.685819637078914, 31.159419148229144, 11.991193815882287, 63.15019289148296, 154.4545772760391, 21.411205326412343, 37.41276452582603, 30.212306961778058, 17.688118714232616, 265.6712088073462, 49.62404654523693, 34.25135467094778, 26.456071425631656, 16.983570674504946, 16.489832924350146, 13.868087326326284, 333.6227751092127, 94.8717169700717, 27.027218045650535, 5.19319239174702, 0.8788480067202142, 57.58986192217702, 35.81396949992853, 21.782896109163104, 3.3739152942079613, 2.020899014024569, 99.16463813768924, 40.68447214691692, 34.69496832604049, 59.09684873569947, 50.93582458448151, 6.146326977172182, 42.772795044951366, 13.381330887236107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.7980445841676636, "mean_inference_ms": 3.699816038486255, "mean_action_processing_ms": 1.8552602537428742, "mean_env_wait_ms": 1.1348435762991316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005371809005737305, "StateBufferConnector_ms": 0.013288140296936035, "ViewRequirementAgentConnector_ms": 0.09992003440856934}, "num_episodes": 72, "episode_return_max": 176.61774283679344, "episode_return_min": -917.8695563659536, "episode_return_mean": -0.4242311199925883, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 250.94445297060926, "num_env_steps_trained_throughput_per_sec": 250.94445297060926, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 1856000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1856000, "timers": {"training_iteration_time_ms": 32252.771, "restore_workers_time_ms": 0.024, "training_step_time_ms": 32251.904, "sample_time_ms": 1337.367, "learn_time_ms": 30887.157, "learn_throughput": 259.007, "synch_weights_time_ms": 21.156}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000}, "done": false, "training_iteration": 58, "trial_id": "cd905_00000", "date": "2024-08-20_09-55-34", "timestamp": 1724127934, "time_this_iter_s": 31.928284168243408, "time_total_s": 1891.7342405319214, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f75dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1891.7342405319214, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 32.15111111111111, "ram_util_percent": 82.18666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.273759794814719, "cur_kl_coeff": 3.2186508178710934e-07, "cur_lr": 0.0001, "total_loss": 4.766275028198485, "policy_loss": -0.0005909511634695625, "vf_loss": 4.766866005034673, "vf_explained_var": -0.0007451362080044216, "kl": 0.010035091868774052, "entropy": 1.0832124061054653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.32589152026034535, "cur_kl_coeff": 3.492459654808044e-11, "cur_lr": 0.0001, "total_loss": 2.7807914412210857, "policy_loss": -0.002382643780271922, "vf_loss": 2.7831740816434225, "vf_explained_var": -5.027585559421116e-05, "kl": 0.003224301128965823, "entropy": 1.0652501687170968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000}, "env_runners": {"episode_reward_max": 176.61774283679344, "episode_reward_min": -1000.4166560022247, "episode_reward_mean": -20.448142435853732, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1075.1507656134418, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 41.545228585034806, "predator_policy": 1144.188545933598}, "policy_reward_mean": {"prey_policy": -89.93783276577497, "predator_policy": 79.71376154784797}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.000000000000124, 52.700000000000436, 43.00000000000036, 42.800000000000374, 26.319165478976682, 49.60000000000046, 33.23489283350722, 61.254491133556854, 40.3000000000003, 35.20000000000023, 67.17472684772609, 92.83921938147375, 30.40000000000017, 52.100000000000506, 46.43368822599931, 23.26441760507997, 53.90000000000052, 176.61774283679344, 20.152665140225434, 17.90391813907578, 31.700000000000184, 38.90000000000028, -917.8695563659536, 29.783938612860595, 25.78626599930697, 62.60000000000047, 43.84123657835731, 41.000000000000306, -222.10539717058006, 50.60000000000048, 39.72751965732438, -535.1368368241717, 23.808333167764893, 37.20000000000026, 35.00000000000022, 46.0000000000004, 40.00000000000031, 42.50000000000035, -144.04649698243225, 35.20000000000023, 63.800000000000516, 32.974999503294725, -382.2401759952433, 56.90000000000052, 70.7483032969309, 39.009654298242395, 5.225663913825635, 34.900000000000226, 35.11666633552992, -44.42450639249054, 34.50000000000022, 67.54515933865045, 35.260577527381805, 45.65039870105294, 32.797139210289394, -357.01945255049975, 33.14426651335312, 62.50000000000048, 59.400000000000475, 45.421212147483445, -185.63353230967456, 74.22204612587115, 57.30000000000048, 37.50000000000026, -392.640587413192, 38.90000000000028, 47.600000000000435, 44.30000000000038, -210.46809640876634, 39.700000000000294, 49.764721114172715, 37.600000000000264, 33.68856846540228, 37.40000000000026, 52.70000000000046, 36.00000000000024, 36.007882874404714, 34.50000000000022, 35.00000000000023, -205.15462237739655, 42.000000000000334, 52.50000000000049, 54.500000000000476, -265.46314759148913, 41.585833856278185, 23.928399830646935, 36.200000000000244, 64.1990931795684, 44.15993915561412, 50.80000000000049, 34.47258435857849, 37.10000000000026, 57.6000000000005, -1000.4166560022247, -407.8452674682868, 37.90000000000027, 22.106997275239898, -432.5342313544269, 42.200000000000344, -47.988009038401465], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-173.89364056088442, -17.86980169566307, 23.929742857144547, -158.55003534819102, 13.112282122416147, -146.13539307010484, -247.9268566483429, 17.08344473263797, -232.29658762042067, -32.895596345499875, -17.814377087991808, -2.4356096951104043, -31.503875885279257, 0.945549944561695, 17.332655430849105, -18.93994374774981, 1.1559977562035717, 11.977659086533045, 20.000000000000014, -160.2662604168678, -116.25366751795346, 14.288063871294572, -15.791087069096063, -191.84014909182116, 15.296551323568405, -248.11068955259086, 0.5661275711084219, 26.109065231241186, 16.239866901780104, -40.842333677860665, -54.64954953121155, -159.90503262971458, 33.225735441632175, 0.8102128390322217, -206.2848623482542, 12.454235246278172, -29.749983207880632, -31.85471036310566, -254.41611833770457, -58.4456204783678, -124.90365016439418, -19.647206352954072, 13.36520670901752, 15.809257929933162, -1053.992660062001, -1008.0654422375505, -5.811063152689009, -67.21161511686238, -21.546202095988143, -45.532995278350846, -39.66955201155157, 35.38498402408234, -12.198594791249514, 6.839338699816066, -14.112966277191804, 21.31114147656617, -247.14630568742214, -265.5651574299757, 15.832745322016505, -24.639589203801933, 7.872580094868308, 1.0298827615482165, -631.5443250481505, -731.9243126481464, -7.988131753850412, -94.42474876122655, -137.0694375288441, 18.003505527401895, -127.91977103726902, 7.607210079895442, 20.000000000000014, 10.654856514589415, -51.969010873699055, -82.29980797893464, -1.7709004574374405, -1.5390414447104575, -178.49443199896942, -223.15202455355032, 9.612494469173221, -89.7362507735591, 23.66525430457491, 33.50000000000024, 5.158331180943045, -71.35712691018705, -489.43036511413584, -497.7315726280588, 32.856282371006856, 21.80000000000004, -5.636295760086391, 30.542927120513877, -122.63994294161859, 20.000000000000014, -58.014943714919866, -26.942374135086865, -45.94034994381986, -2.282227484625337, -5.653463040813747, 12.900741381706473, -58.0504155387103, -137.0844632575721, -19.61000719343322, -60.353911098080964, 20.000000000000014, -31.557504998543948, 8.072951866800292, -7.460311702716009, -37.71520062634964, -67.3744017555462, 2.0701613523455524, -88.08329231147076, -488.2607677799292, -457.9258210308957, -2.8776050419841877, -5.195942881970899, 6.02429207991881, 41.545228585034806, 20.000000000000014, -0.8438706140261163, 7.732646355679547, 18.982841974550194, -334.8446692798108, -251.39790449401397, 27.350056712953247, 32.473595776573426, 20.7026145127738, 15.189253768368982, 18.94569454943938, -9.527408418308104, -435.3510576168602, -510.0290128236989, -23.211851822468404, 20.000000000000014, 20.000000000000014, -21.361347417464657, -114.45069019408962, -0.6601839086286065, -306.58203858928647, -277.2419374992814, 17.76574965725844, 18.94597155145965, 20.000000000000014, -3.3656152040678813, 9.827022156685473, 5.250780949655031, -1.4848378434762577, 5.551169300748635, -14.992540690938325, 4.895070398493308, -9.725321406360502, 1.8730681496696253, -6.2225483116347675, -49.62269047367297, -34.784560764105215, -4.348943068855236, -67.73801530949046, -73.62776729296282, 5.860929459993697, -38.48600094759759, -272.7496143540182, -215.76433554495716, -15.00724202440551, -26.868159191778716, 28.100000000000147, -19.039642100136348, 8.61047347611017, 15.531606273213326, -302.60098894370446, -391.3566507270692, 17.40102000683312, -8.03559658795271, -14.833310692311457, -19.70699940593842, 17.646268397397606, -39.04313400648902, 35.27819416554357, 23.526084705792105, -84.35413449442945, -11.335036634563737, -1.4949683260404916, -41.49684873569922, -1.0006523315597962, -21.60891487151541, -25.62290803499816, 6.568782102810909, 32.710180990043696, 4.795023487721915, -1075.1507656134418, -1051.3296076713902, -449.2333705663967, -484.59345523801414, -4.156759830312302, 12.847071872741191, -6.40909567418899, -27.514414893107137, -479.010087991824, -504.8244555771613, -41.40187304093322, 18.745784548183003, -73.09645231971577, -122.39449971001574], "policy_predator_policy_reward": [30.98337688361547, 189.78006537293192, 174.32713903811114, 12.993153452934978, 160.56814224888006, 15.454968698807843, 79.72449125263627, 193.91892066306826, 46.18128026181811, 245.33006918307896, 0.912806310945774, 68.93718047215663, 43.19626571318722, 20.596953061037542, 27.1948014372759, 35.666978013181385, 16.51291397781854, 10.653429179444775, 162.6278346758136, 12.838425741053424, 23.199685594491157, 145.94064489989282, 208.84048546902343, 91.6299700733685, 255.76328527571732, 7.450852953304777, 18.533872428891573, 6.89093476875893, 62.41147816966357, 8.624676832416075, 233.06780940064058, 4.751190365364468, 1.074264558368063, 18.789787160967776, 203.47448102906495, 166.97388890970518, 8.736252757570579, 73.02110595364167, 33.41282700478074, 297.35282995036954, 5.087662330595096, 171.163194186753, 5.9347932909824515, 3.7907420700667998, 1144.188545933598, 0.0, 51.771953344174136, 51.03466353823692, 50.47679794665897, 42.3886654269874, 56.86955201155182, 10.015015975917892, 49.20049266979056, 0.0, 13.256246157815196, 20.54557864281065, 284.35168555434456, 6.2543803924731325, 47.79278678100483, 11.614057100780789, 4.785919838956354, 26.039136961951158, 10.603439808573219, 817.7283610635519, 101.57235978287093, 24.648853899970153, 50.5252271027969, 105.7407048986446, 0.0, 155.3125609573728, 0.0, 15.345143485410555, 95.66209073247981, 78.60672812015287, 25.47090045743745, 20.339041444710478, 253.23087460835, 4.369084961737399, 17.660398282469497, 97.66335802191543, 6.634745695425164, 0.0, 94.32775191116926, 4.846043321368405, 580.0816326939627, 24.840129052988804, 2.2437176289933767, 0.0, 11.469371236558793, 34.37230069994486, 31.972885884871, 109.67671135498884, 79.3730276214651, 10.809954142366893, 50.482118140187175, 32.64045928825827, 24.495129873048867, 3.3742581215880474, 1.254143562064682, 149.4562288417266, 79.49276405031364, 34.97115424120046, 45.93407975038502, 33.168584586809374, 16.454101519949013, 18.193835843348232, 148.3686444502577, 2.371356632690384, 77.1876380704623, 41.62263209895117, 518.4106579211368, 70.75647833918728, 0.0, 41.21781443730811, 13.275707920081155, 1.6547714149654311, 38.5742777325586, 1.6695928814674825, 8.002761602801383, 10.702962214451906, 388.4867749322513, 12.12226653189934, 6.948450349298184, 7.449943287046892, 16.115507792343703, 5.2926239265135075, 0.9543054505606221, 27.12740841830824, 452.5213253041595, 100.21815772320753, 42.11185182246865, 0.0, 45.496752927271565, 3.4645944901933166, 132.65069019408872, 26.76018390862859, 365.7391890128491, 7.616690666953604, 2.0342503427415464, 0.9540284485403521, 23.255849633142695, 9.87448668509747, 0.0, 22.522196893659416, 22.90309444881241, 6.71914255931715, 33.69254069093857, 13.80492960150666, 16.667371764471802, 43.884881492219144, 60.685819637078914, 31.159419148229144, 11.991193815882287, 63.15019289148296, 154.4545772760391, 21.411205326412343, 37.41276452582603, 30.212306961778058, 17.688118714232616, 265.6712088073462, 49.62404654523693, 34.25135467094778, 26.456071425631656, 16.983570674504946, 16.489832924350146, 13.868087326326284, 333.6227751092127, 94.8717169700717, 27.027218045650535, 5.19319239174702, 0.8788480067202142, 57.58986192217702, 35.81396949992853, 21.782896109163104, 3.3739152942079613, 2.020899014024569, 99.16463813768924, 40.68447214691692, 34.69496832604049, 59.09684873569947, 50.93582458448151, 6.146326977172182, 42.772795044951366, 13.381330887236107, 5.6898190099565396, 14.40497651227805, 9.070745691190355, 1116.9929715914168, 14.623785393029468, 511.3577729430946, 5.384148422733619, 23.825539534837453, 53.7003352091986, 2.3301726333377397, 2.3066504431716908, 548.9936617713863, 18.310498268291408, 46.54559022445903, 147.50294299132972, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.791779579535034, "mean_inference_ms": 3.7025358092112346, "mean_action_processing_ms": 1.8467073949626598, "mean_env_wait_ms": 1.132840803741615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005176186561584473, "StateBufferConnector_ms": 0.013223409652709961, "ViewRequirementAgentConnector_ms": 0.09791100025177002}, "num_episodes": 8, "episode_return_max": 176.61774283679344, "episode_return_min": -1000.4166560022247, "episode_return_mean": -20.448142435853732, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 246.77022645896108, "num_env_steps_trained_throughput_per_sec": 246.77022645896108, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 1888000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1888000, "timers": {"training_iteration_time_ms": 32296.753, "restore_workers_time_ms": 0.024, "training_step_time_ms": 32296.008, "sample_time_ms": 1338.488, "learn_time_ms": 30929.703, "learn_throughput": 258.651, "synch_weights_time_ms": 21.397}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000}, "done": false, "training_iteration": 59, "trial_id": "cd905_00000", "date": "2024-08-20_09-56-07", "timestamp": 1724127967, "time_this_iter_s": 32.45810008049011, "time_total_s": 1924.1923406124115, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a167af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1924.1923406124115, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 34.64130434782608, "ram_util_percent": 81.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5937528200565823, "cur_kl_coeff": 3.2186508178710934e-07, "cur_lr": 0.0001, "total_loss": 5.693151523196508, "policy_loss": -0.0007816216187729012, "vf_loss": 5.693933138014779, "vf_explained_var": 0.0005324380738394601, "kl": 0.004362363741391951, "entropy": 1.1056942544286212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 37485.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3390461112535189, "cur_kl_coeff": 1.746229827404022e-11, "cur_lr": 0.0001, "total_loss": 3.6056008024821207, "policy_loss": -0.001960046855836279, "vf_loss": 3.607560852595738, "vf_explained_var": -6.872879134284125e-05, "kl": 0.004639326592838361, "entropy": 1.0582565481700594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 37485.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 66.19021331402749, "episode_reward_min": -1154.4421716895636, "episode_reward_mean": -175.84731798109394, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1335.2863084097808, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 35.27819416554357, "predator_policy": 1549.269128035845}, "policy_reward_mean": {"prey_policy": -255.38206279786564, "predator_policy": 167.45840380731858}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-392.640587413192, 38.90000000000028, 47.600000000000435, 44.30000000000038, -210.46809640876634, 39.700000000000294, 49.764721114172715, 37.600000000000264, 33.68856846540228, 37.40000000000026, 52.70000000000046, 36.00000000000024, 36.007882874404714, 34.50000000000022, 35.00000000000023, -205.15462237739655, 42.000000000000334, 52.50000000000049, 54.500000000000476, -265.46314759148913, 41.585833856278185, 23.928399830646935, 36.200000000000244, 64.1990931795684, 44.15993915561412, 50.80000000000049, 34.47258435857849, 37.10000000000026, 57.6000000000005, -1000.4166560022247, -407.8452674682868, 37.90000000000027, 22.106997275239898, -432.5342313544269, 42.200000000000344, -47.988009038401465, 45.800000000000395, 40.48127622811734, -167.35930957249593, 41.70000000000033, -338.67575768452076, 60.90000000000047, 57.3000000000005, -941.1315096055139, 34.50271714740215, 57.75557551512871, 39.700000000000294, 44.50000000000038, -809.498135868625, -1024.4062956764344, 42.500000000000334, -12.054495032387397, -1154.4421716895636, 40.25000000000042, -441.58513961181563, -706.592038190684, -1019.339667056955, -1063.1399969266563, 40.204193487602716, -551.3761780595953, -290.73623606796684, 32.2108685896076, -35.496789278049434, 51.9000000000005, 55.20000000000049, -1039.377758981921, -676.9429274253852, 36.8842102621403, -379.8281129014306, 46.500000000000405, 55.6000000000005, -107.08593118391647, -814.138260737581, -76.44967270850188, 33.608910707598255, 36.10000000000025, 51.10000000000049, 37.700000000000266, -712.582336141632, 56.9000000000005, -505.9425577222684, 20.061050315167034, -1139.1325529742517, 46.0000000000004, 39.284210262140334, -121.20299550147178, 52.13951128030234, 37.55000000000036, -217.27105490019335, -183.9303588850556, -470.78923771115, -555.5434457473069, 32.405077714012485, -1036.1423319295031, -472.7416059380581, -28.01666666666651, 66.19021331402749, -130.8114870108214, 52.00000000000049, 52.20000000000048], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-435.3510576168602, -510.0290128236989, -23.211851822468404, 20.000000000000014, 20.000000000000014, -21.361347417464657, -114.45069019408962, -0.6601839086286065, -306.58203858928647, -277.2419374992814, 17.76574965725844, 18.94597155145965, 20.000000000000014, -3.3656152040678813, 9.827022156685473, 5.250780949655031, -1.4848378434762577, 5.551169300748635, -14.992540690938325, 4.895070398493308, -9.725321406360502, 1.8730681496696253, -6.2225483116347675, -49.62269047367297, -34.784560764105215, -4.348943068855236, -67.73801530949046, -73.62776729296282, 5.860929459993697, -38.48600094759759, -272.7496143540182, -215.76433554495716, -15.00724202440551, -26.868159191778716, 28.100000000000147, -19.039642100136348, 8.61047347611017, 15.531606273213326, -302.60098894370446, -391.3566507270692, 17.40102000683312, -8.03559658795271, -14.833310692311457, -19.70699940593842, 17.646268397397606, -39.04313400648902, 35.27819416554357, 23.526084705792105, -84.35413449442945, -11.335036634563737, -1.4949683260404916, -41.49684873569922, -1.0006523315597962, -21.60891487151541, -25.62290803499816, 6.568782102810909, 32.710180990043696, 4.795023487721915, -1075.1507656134418, -1051.3296076713902, -449.2333705663967, -484.59345523801414, -4.156759830312302, 12.847071872741191, -6.40909567418899, -27.514414893107137, -479.010087991824, -504.8244555771613, -41.40187304093322, 18.745784548183003, -73.09645231971577, -122.39449971001574, -11.469309606322554, 16.33808063557737, 11.226908319143847, -65.61849231658867, -224.57744980238212, -189.92869576194002, 16.18365383821084, -14.843785930656217, -440.54709206118633, -420.49126069934204, 27.535941720078032, -8.983990592124497, 32.5284864407545, 13.680460086998261, -960.4214140622339, -1065.0856289295534, -16.376718303011753, -0.20973767907636987, 25.22087740964657, 13.919902556974137, 20.000000000000014, 16.291009231416595, -7.293133178878133, -18.545975785037008, -877.0240450434868, -944.8305699285592, -1274.2323588614859, -1315.9390231558357, 19.01860958154363, 21.80000000000004, -69.37591180963804, -33.71714288085842, -1266.4196653039567, -1267.7782995042649, 9.790898622343448, -28.646115734507006, -675.3065576438332, -669.9832919720448, -1241.8657321741346, -954.3218386964351, -1120.1283133280626, -1117.4380418607973, -1335.2863084097808, -1114.1879451329949, 7.377030771210022, -9.229883139874902, -875.7825308226779, -858.5012857390523, -355.5775199214147, -381.5814263944646, -6.747688231160896, 4.926504753938398, -58.27105887741008, -62.29937281186978, -4.946611820024051, 27.513711300937356, 1.4338256291371103, 25.489938213699038, -1167.6084606349332, -1131.2519535748077, -791.1410874853603, -859.2569873167404, 1.7916360998639473, 16.026753692044863, -463.89058025799403, -451.61693631098626, 18.866586715283955, 19.446602580262628, 0.31911654234124537, 31.40760302839162, -648.0743215976889, -651.2811241713571, -865.9401019608069, -1016.3922125719279, -126.69680858566483, -132.8698595163331, -22.889093936339748, -3.1606416019975234, -48.118974120006314, 8.231599897853444, 0.8348464557775305, 28.230582138355068, 10.469110165027004, 0.07046204786825216, -952.6125342368548, -822.6999824782338, -4.392283204540599, 31.901012589766687, -555.8570089399261, -621.6081678963183, -21.747353639285087, -20.568103097424174, -1244.2915559555336, -1176.1423843103917, 21.80000000000004, 20.827889349235058, 5.98988615540682, -11.535716931305931, -142.44892089117798, -164.769575774164, -112.05196453934872, -13.55059022035603, -10.927983132954347, 14.799405572201522, -240.26400308123542, -298.8102008805974, -226.63380057455524, -256.458989085104, -514.9989283540028, -571.7076225458472, -1149.2839387998804, -1224.1389278257216, -78.09360851913084, -12.257859202464626, -1170.7111087020053, -1154.0232184553538, -532.129516309777, -536.5790307046486, -125.68786223755691, -56.92382186127851, 31.419286156191504, 2.6903353418263203, -189.5320788186685, -192.24935183099592, -62.101587362913996, 34.172506399451294, -7.911184771022265, 6.308197777243299], "policy_predator_policy_reward": [452.5213253041595, 100.21815772320753, 42.11185182246865, 0.0, 45.496752927271565, 3.4645944901933166, 132.65069019408872, 26.76018390862859, 365.7391890128491, 7.616690666953604, 2.0342503427415464, 0.9540284485403521, 23.255849633142695, 9.87448668509747, 0.0, 22.522196893659416, 22.90309444881241, 6.71914255931715, 33.69254069093857, 13.80492960150666, 16.667371764471802, 43.884881492219144, 60.685819637078914, 31.159419148229144, 11.991193815882287, 63.15019289148296, 154.4545772760391, 21.411205326412343, 37.41276452582603, 30.212306961778058, 17.688118714232616, 265.6712088073462, 49.62404654523693, 34.25135467094778, 26.456071425631656, 16.983570674504946, 16.489832924350146, 13.868087326326284, 333.6227751092127, 94.8717169700717, 27.027218045650535, 5.19319239174702, 0.8788480067202142, 57.58986192217702, 35.81396949992853, 21.782896109163104, 3.3739152942079613, 2.020899014024569, 99.16463813768924, 40.68447214691692, 34.69496832604049, 59.09684873569947, 50.93582458448151, 6.146326977172182, 42.772795044951366, 13.381330887236107, 5.6898190099565396, 14.40497651227805, 9.070745691190355, 1116.9929715914168, 14.623785393029468, 511.3577729430946, 5.384148422733619, 23.825539534837453, 53.7003352091986, 2.3301726333377397, 2.3066504431716908, 548.9936617713863, 18.310498268291408, 46.54559022445903, 147.50294299132972, 0.0, 30.26930960632274, 10.661919364422596, 8.861579924745447, 86.01128030081532, 238.43771599585563, 8.709119995970596, 34.70041876148531, 5.659713330960252, 13.396381182987385, 508.9662138930201, 13.838805877699812, 28.50924299434694, 2.571513559245732, 8.519539913001704, 0.0, 1084.3755333862737, 37.596102779354176, 13.493070350135755, 3.1175899013050694, 15.497205647202493, 0.0, 3.4089907685833696, 25.493133178878235, 44.845975785037254, 1012.356479103421, 0.0, 16.495958305042326, 1549.269128035845, 1.6813904184563742, 0.0, 91.03855965810904, 0.0, 1373.445865213258, 6.309927905399853, 40.693459805819444, 18.411757306344292, 695.0874163878871, 208.61729361617537, 1197.6645963083579, 291.93093637152907, 1.1796949295416763, 1217.0469932023632, 1358.7115980472777, 27.62265856884197, 6.528131406375879, 35.52891444989151, 270.8357650944169, 912.0718734077177, 41.02967036017067, 405.393039887742, 25.047688231160862, 8.984363835668901, 82.86630612417669, 2.207336287053595, 7.403257579998312, 21.929642939088588, 17.56617437086287, 10.710061786301068, 1248.1958483864057, 11.286806841413444, 46.93648978660992, 926.5186575901056, 19.065820470231145, 0.0, 39.66175808357067, 496.01764558397934, 1.033413284716045, 7.153397419737383, 18.68088345765875, 5.192396971608591, 633.0774598969117, 559.1920546882186, 15.31187257651373, 1052.88218121864, 179.0571230983691, 4.05987229512683, 55.077812061904815, 4.580834184030794, 24.295456611976153, 51.69191761017692, 17.965153544222456, 4.069417861645085, 17.018619169634775, 10.141808617469902, 64.77701618062201, 997.9531643928343, 23.792283204540666, 5.5989874102335335, 0.0, 671.5226191139757, 8.560134749111414, 53.81637230276454, 1276.8515630470995, 4.4498242445741045, 1.0659189776764915, 2.30619167308848, 21.572396198363315, 23.25764483967578, 2.7866228695138946, 183.22887829435652, 75.69243090676352, 102.04963513324236, 31.443772870814367, 2.234804689938553, 2.989850338719485, 318.8132987229199, 10.854697693920567, 288.3077330806829, 5.469864136719682, 610.4474490519805, 490.90728973722923, 1326.9721311410658, 9.698932061517304, 113.05761337408991, 18.861557539524696, 1269.7304376883305, 29.77470305293392, 566.1922380234339, 14.909469052949811, 139.68554837921823, 26.809664658173645, 5.270927157835849, 235.05862643300605, 15.911317205837166, 78.90158736291318, 1.0274936005489594, 40.81118477102236, 12.991802222756666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.787339121257661, "mean_inference_ms": 3.6938121360669323, "mean_action_processing_ms": 1.8460174896234909, "mean_env_wait_ms": 1.1335752963241714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041294097900390625, "StateBufferConnector_ms": 0.01273965835571289, "ViewRequirementAgentConnector_ms": 0.09543144702911377}, "num_episodes": 64, "episode_return_max": 66.19021331402749, "episode_return_min": -1154.4421716895636, "episode_return_mean": -175.84731798109394, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 247.33634955369058, "num_env_steps_trained_throughput_per_sec": 247.33634955369058, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 32241.019, "restore_workers_time_ms": 0.024, "training_step_time_ms": 32240.251, "sample_time_ms": 1289.63, "learn_time_ms": 30922.756, "learn_throughput": 258.709, "synch_weights_time_ms": 21.872}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 60, "trial_id": "cd905_00000", "date": "2024-08-20_09-56-39", "timestamp": 1724127999, "time_this_iter_s": 32.39514183998108, "time_total_s": 1956.5874824523926, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f6bdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1956.5874824523926, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 33.736956521739124, "ram_util_percent": 81.22173913043478}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9730815671384334, "cur_kl_coeff": 1.6093254089355467e-07, "cur_lr": 0.0001, "total_loss": 7.1984029489850245, "policy_loss": -0.0007628169446621859, "vf_loss": 7.199165736304389, "vf_explained_var": -0.00015499062008327908, "kl": 0.0030317693335386404, "entropy": 1.1245565121136014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 38115.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.31458295037349066, "cur_kl_coeff": 8.73114913702011e-12, "cur_lr": 0.0001, "total_loss": 4.52328924527244, "policy_loss": -0.0031164036524142067, "vf_loss": 4.526405664095803, "vf_explained_var": -7.270252893841456e-06, "kl": 0.006578278979618012, "entropy": 1.0385818829612126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 38115.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000}, "env_runners": {"episode_reward_max": 66.19021331402749, "episode_reward_min": -1154.4421716895636, "episode_reward_mean": -186.90098678816221, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1757.5738520927853, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 35.27819416554357, "predator_policy": 1678.2418361572481}, "policy_reward_mean": {"prey_policy": -282.0404266311826, "predator_policy": 188.58993323710135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.68856846540228, 37.40000000000026, 52.70000000000046, 36.00000000000024, 36.007882874404714, 34.50000000000022, 35.00000000000023, -205.15462237739655, 42.000000000000334, 52.50000000000049, 54.500000000000476, -265.46314759148913, 41.585833856278185, 23.928399830646935, 36.200000000000244, 64.1990931795684, 44.15993915561412, 50.80000000000049, 34.47258435857849, 37.10000000000026, 57.6000000000005, -1000.4166560022247, -407.8452674682868, 37.90000000000027, 22.106997275239898, -432.5342313544269, 42.200000000000344, -47.988009038401465, 45.800000000000395, 40.48127622811734, -167.35930957249593, 41.70000000000033, -338.67575768452076, 60.90000000000047, 57.3000000000005, -941.1315096055139, 34.50271714740215, 57.75557551512871, 39.700000000000294, 44.50000000000038, -809.498135868625, -1024.4062956764344, 42.500000000000334, -12.054495032387397, -1154.4421716895636, 40.25000000000042, -441.58513961181563, -706.592038190684, -1019.339667056955, -1063.1399969266563, 40.204193487602716, -551.3761780595953, -290.73623606796684, 32.2108685896076, -35.496789278049434, 51.9000000000005, 55.20000000000049, -1039.377758981921, -676.9429274253852, 36.8842102621403, -379.8281129014306, 46.500000000000405, 55.6000000000005, -107.08593118391647, -814.138260737581, -76.44967270850188, 33.608910707598255, 36.10000000000025, 51.10000000000049, 37.700000000000266, -712.582336141632, 56.9000000000005, -505.9425577222684, 20.061050315167034, -1139.1325529742517, 46.0000000000004, 39.284210262140334, -121.20299550147178, 52.13951128030234, 37.55000000000036, -217.27105490019335, -183.9303588850556, -470.78923771115, -555.5434457473069, 32.405077714012485, -1036.1423319295031, -472.7416059380581, -28.01666666666651, 66.19021331402749, -130.8114870108214, 52.00000000000049, 52.20000000000048, -64.61575703311708, 57.500000000000476, -96.43164577144252, -863.2036477608616, -323.27836986354913, -239.17020002283388, 40.28877703719215, 38.300000000000274], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1.4848378434762577, 5.551169300748635, -14.992540690938325, 4.895070398493308, -9.725321406360502, 1.8730681496696253, -6.2225483116347675, -49.62269047367297, -34.784560764105215, -4.348943068855236, -67.73801530949046, -73.62776729296282, 5.860929459993697, -38.48600094759759, -272.7496143540182, -215.76433554495716, -15.00724202440551, -26.868159191778716, 28.100000000000147, -19.039642100136348, 8.61047347611017, 15.531606273213326, -302.60098894370446, -391.3566507270692, 17.40102000683312, -8.03559658795271, -14.833310692311457, -19.70699940593842, 17.646268397397606, -39.04313400648902, 35.27819416554357, 23.526084705792105, -84.35413449442945, -11.335036634563737, -1.4949683260404916, -41.49684873569922, -1.0006523315597962, -21.60891487151541, -25.62290803499816, 6.568782102810909, 32.710180990043696, 4.795023487721915, -1075.1507656134418, -1051.3296076713902, -449.2333705663967, -484.59345523801414, -4.156759830312302, 12.847071872741191, -6.40909567418899, -27.514414893107137, -479.010087991824, -504.8244555771613, -41.40187304093322, 18.745784548183003, -73.09645231971577, -122.39449971001574, -11.469309606322554, 16.33808063557737, 11.226908319143847, -65.61849231658867, -224.57744980238212, -189.92869576194002, 16.18365383821084, -14.843785930656217, -440.54709206118633, -420.49126069934204, 27.535941720078032, -8.983990592124497, 32.5284864407545, 13.680460086998261, -960.4214140622339, -1065.0856289295534, -16.376718303011753, -0.20973767907636987, 25.22087740964657, 13.919902556974137, 20.000000000000014, 16.291009231416595, -7.293133178878133, -18.545975785037008, -877.0240450434868, -944.8305699285592, -1274.2323588614859, -1315.9390231558357, 19.01860958154363, 21.80000000000004, -69.37591180963804, -33.71714288085842, -1266.4196653039567, -1267.7782995042649, 9.790898622343448, -28.646115734507006, -675.3065576438332, -669.9832919720448, -1241.8657321741346, -954.3218386964351, -1120.1283133280626, -1117.4380418607973, -1335.2863084097808, -1114.1879451329949, 7.377030771210022, -9.229883139874902, -875.7825308226779, -858.5012857390523, -355.5775199214147, -381.5814263944646, -6.747688231160896, 4.926504753938398, -58.27105887741008, -62.29937281186978, -4.946611820024051, 27.513711300937356, 1.4338256291371103, 25.489938213699038, -1167.6084606349332, -1131.2519535748077, -791.1410874853603, -859.2569873167404, 1.7916360998639473, 16.026753692044863, -463.89058025799403, -451.61693631098626, 18.866586715283955, 19.446602580262628, 0.31911654234124537, 31.40760302839162, -648.0743215976889, -651.2811241713571, -865.9401019608069, -1016.3922125719279, -126.69680858566483, -132.8698595163331, -22.889093936339748, -3.1606416019975234, -48.118974120006314, 8.231599897853444, 0.8348464557775305, 28.230582138355068, 10.469110165027004, 0.07046204786825216, -952.6125342368548, -822.6999824782338, -4.392283204540599, 31.901012589766687, -555.8570089399261, -621.6081678963183, -21.747353639285087, -20.568103097424174, -1244.2915559555336, -1176.1423843103917, 21.80000000000004, 20.827889349235058, 5.98988615540682, -11.535716931305931, -142.44892089117798, -164.769575774164, -112.05196453934872, -13.55059022035603, -10.927983132954347, 14.799405572201522, -240.26400308123542, -298.8102008805974, -226.63380057455524, -256.458989085104, -514.9989283540028, -571.7076225458472, -1149.2839387998804, -1224.1389278257216, -78.09360851913084, -12.257859202464626, -1170.7111087020053, -1154.0232184553538, -532.129516309777, -536.5790307046486, -125.68786223755691, -56.92382186127851, 31.419286156191504, 2.6903353418263203, -189.5320788186685, -192.24935183099592, -62.101587362913996, 34.172506399451294, -7.911184771022265, 6.308197777243299, -90.12719563280396, -92.52183679710882, 11.165798431592957, 28.476057554988003, -1677.1717810377615, -1757.5738520927853, -1026.7072260149725, -895.7136424075482, -377.5890170479435, -347.5717773913167, -292.5945253910628, -254.92315955275438, -11.509857457094826, -104.35947925025745, -39.77324139646771, 16.357758059129655], "policy_predator_policy_reward": [22.90309444881241, 6.71914255931715, 33.69254069093857, 13.80492960150666, 16.667371764471802, 43.884881492219144, 60.685819637078914, 31.159419148229144, 11.991193815882287, 63.15019289148296, 154.4545772760391, 21.411205326412343, 37.41276452582603, 30.212306961778058, 17.688118714232616, 265.6712088073462, 49.62404654523693, 34.25135467094778, 26.456071425631656, 16.983570674504946, 16.489832924350146, 13.868087326326284, 333.6227751092127, 94.8717169700717, 27.027218045650535, 5.19319239174702, 0.8788480067202142, 57.58986192217702, 35.81396949992853, 21.782896109163104, 3.3739152942079613, 2.020899014024569, 99.16463813768924, 40.68447214691692, 34.69496832604049, 59.09684873569947, 50.93582458448151, 6.146326977172182, 42.772795044951366, 13.381330887236107, 5.6898190099565396, 14.40497651227805, 9.070745691190355, 1116.9929715914168, 14.623785393029468, 511.3577729430946, 5.384148422733619, 23.825539534837453, 53.7003352091986, 2.3301726333377397, 2.3066504431716908, 548.9936617713863, 18.310498268291408, 46.54559022445903, 147.50294299132972, 0.0, 30.26930960632274, 10.661919364422596, 8.861579924745447, 86.01128030081532, 238.43771599585563, 8.709119995970596, 34.70041876148531, 5.659713330960252, 13.396381182987385, 508.9662138930201, 13.838805877699812, 28.50924299434694, 2.571513559245732, 8.519539913001704, 0.0, 1084.3755333862737, 37.596102779354176, 13.493070350135755, 3.1175899013050694, 15.497205647202493, 0.0, 3.4089907685833696, 25.493133178878235, 44.845975785037254, 1012.356479103421, 0.0, 16.495958305042326, 1549.269128035845, 1.6813904184563742, 0.0, 91.03855965810904, 0.0, 1373.445865213258, 6.309927905399853, 40.693459805819444, 18.411757306344292, 695.0874163878871, 208.61729361617537, 1197.6645963083579, 291.93093637152907, 1.1796949295416763, 1217.0469932023632, 1358.7115980472777, 27.62265856884197, 6.528131406375879, 35.52891444989151, 270.8357650944169, 912.0718734077177, 41.02967036017067, 405.393039887742, 25.047688231160862, 8.984363835668901, 82.86630612417669, 2.207336287053595, 7.403257579998312, 21.929642939088588, 17.56617437086287, 10.710061786301068, 1248.1958483864057, 11.286806841413444, 46.93648978660992, 926.5186575901056, 19.065820470231145, 0.0, 39.66175808357067, 496.01764558397934, 1.033413284716045, 7.153397419737383, 18.68088345765875, 5.192396971608591, 633.0774598969117, 559.1920546882186, 15.31187257651373, 1052.88218121864, 179.0571230983691, 4.05987229512683, 55.077812061904815, 4.580834184030794, 24.295456611976153, 51.69191761017692, 17.965153544222456, 4.069417861645085, 17.018619169634775, 10.141808617469902, 64.77701618062201, 997.9531643928343, 23.792283204540666, 5.5989874102335335, 0.0, 671.5226191139757, 8.560134749111414, 53.81637230276454, 1276.8515630470995, 4.4498242445741045, 1.0659189776764915, 2.30619167308848, 21.572396198363315, 23.25764483967578, 2.7866228695138946, 183.22887829435652, 75.69243090676352, 102.04963513324236, 31.443772870814367, 2.234804689938553, 2.989850338719485, 318.8132987229199, 10.854697693920567, 288.3077330806829, 5.469864136719682, 610.4474490519805, 490.90728973722923, 1326.9721311410658, 9.698932061517304, 113.05761337408991, 18.861557539524696, 1269.7304376883305, 29.77470305293392, 566.1922380234339, 14.909469052949811, 139.68554837921823, 26.809664658173645, 5.270927157835849, 235.05862643300605, 15.911317205837166, 78.90158736291318, 1.0274936005489594, 40.81118477102236, 12.991802222756666, 110.37230230779082, 7.6609730890045, 8.234201568407007, 9.623942445012158, 1660.0721512018558, 1678.2418361572481, 1059.217220661659, 0.0, 400.9947403402549, 0.8876842354561967, 300.8414736449966, 7.506011275986735, 83.1459351364716, 73.01217860807178, 23.896775106824318, 37.818708230513934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.780482844732437, "mean_inference_ms": 3.6953052880571216, "mean_action_processing_ms": 1.8376171296646282, "mean_env_wait_ms": 1.1312930756183515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003983974456787109, "StateBufferConnector_ms": 0.012638449668884277, "ViewRequirementAgentConnector_ms": 0.09444010257720947}, "num_episodes": 8, "episode_return_max": 66.19021331402749, "episode_return_min": -1154.4421716895636, "episode_return_mean": -186.90098678816221, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 241.22020338194366, "num_env_steps_trained_throughput_per_sec": 241.22020338194366, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 1952000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1952000, "timers": {"training_iteration_time_ms": 32290.588, "restore_workers_time_ms": 0.024, "training_step_time_ms": 32289.139, "sample_time_ms": 1266.521, "learn_time_ms": 30979.274, "learn_throughput": 258.237, "synch_weights_time_ms": 36.307}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000}, "done": false, "training_iteration": 61, "trial_id": "cd905_00000", "date": "2024-08-20_09-57-12", "timestamp": 1724128032, "time_this_iter_s": 33.21349811553955, "time_total_s": 1989.8009805679321, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f7e9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1989.8009805679321, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 34.01063829787235, "ram_util_percent": 81.77446808510639}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4237927466512672, "cur_kl_coeff": 8.046627044677734e-08, "cur_lr": 0.0001, "total_loss": 6.989006619226365, "policy_loss": -0.0029978657983953045, "vf_loss": 6.9920045042794845, "vf_explained_var": 0.0007066953749883743, "kl": 0.01587308715654275, "entropy": 1.1501027852769883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.41113368428888775, "cur_kl_coeff": 8.73114913702011e-12, "cur_lr": 0.0001, "total_loss": 4.860040206757803, "policy_loss": -0.0026149313948634597, "vf_loss": 4.862655155242435, "vf_explained_var": -0.00010604536722576807, "kl": 0.005259117001719821, "entropy": 1.060382980959756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000}, "env_runners": {"episode_reward_max": 79.20122577410085, "episode_reward_min": -1333.1713372559138, "episode_reward_mean": -372.77886372399496, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1757.5738520927853, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 34.88673647984311, "predator_policy": 1843.8821906601393}, "policy_reward_mean": {"prey_policy": -524.6558190970161, "predator_policy": 338.2663872350186}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-814.138260737581, -76.44967270850188, 33.608910707598255, 36.10000000000025, 51.10000000000049, 37.700000000000266, -712.582336141632, 56.9000000000005, -505.9425577222684, 20.061050315167034, -1139.1325529742517, 46.0000000000004, 39.284210262140334, -121.20299550147178, 52.13951128030234, 37.55000000000036, -217.27105490019335, -183.9303588850556, -470.78923771115, -555.5434457473069, 32.405077714012485, -1036.1423319295031, -472.7416059380581, -28.01666666666651, 66.19021331402749, -130.8114870108214, 52.00000000000049, 52.20000000000048, -64.61575703311708, 57.500000000000476, -96.43164577144252, -863.2036477608616, -323.27836986354913, -239.17020002283388, 40.28877703719215, 38.300000000000274, -846.7105418802907, 31.605434294804038, 52.50000000000051, -108.9114235667978, -973.3167124809536, 36.25000000000003, 35.38863337110409, 7.483333333333782, 35.90000000000024, -1333.1713372559138, -663.2257405597258, -264.99474217433874, -245.94625022250545, 70.70000000000002, -727.7942542911267, -924.8548569316922, -405.6052552912592, -1070.3490338052593, -390.069056942199, -596.7649145160177, 31.175249128285547, -34.61985145291811, -115.05809657026967, -227.9684474301417, -1166.8334558653248, -531.8871585728516, -750.1427601792184, 35.00000000000023, -1044.6118789877019, -1009.590555072791, -89.23793682181962, -715.2166527589247, -751.4773484758783, -1106.8623738986869, -959.0920847048869, 50.272579029679626, -848.7925179290136, 44.80000000000038, 28.890269540797416, 44.450000000000394, -276.1469090900103, -967.133735311497, -390.3269920290508, -753.0634295344665, -180.85293842150813, 79.20122577410085, -392.30437908247916, -955.9823435466074, -1086.7544089270302, 56.600000000000506, 2.5824114100760234, -36.44084880725227, -704.2165879384505, -559.9265467639973, 16.84467155414908, -601.7820152973965, -381.41174064204563, -339.93852616597536, -493.6509905091593, -1088.5622877528317, -1119.1168353134474, -1292.756932196077, -357.05583161544115, -754.9342278567707], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-865.9401019608069, -1016.3922125719279, -126.69680858566483, -132.8698595163331, -22.889093936339748, -3.1606416019975234, -48.118974120006314, 8.231599897853444, 0.8348464557775305, 28.230582138355068, 10.469110165027004, 0.07046204786825216, -952.6125342368548, -822.6999824782338, -4.392283204540599, 31.901012589766687, -555.8570089399261, -621.6081678963183, -21.747353639285087, -20.568103097424174, -1244.2915559555336, -1176.1423843103917, 21.80000000000004, 20.827889349235058, 5.98988615540682, -11.535716931305931, -142.44892089117798, -164.769575774164, -112.05196453934872, -13.55059022035603, -10.927983132954347, 14.799405572201522, -240.26400308123542, -298.8102008805974, -226.63380057455524, -256.458989085104, -514.9989283540028, -571.7076225458472, -1149.2839387998804, -1224.1389278257216, -78.09360851913084, -12.257859202464626, -1170.7111087020053, -1154.0232184553538, -532.129516309777, -536.5790307046486, -125.68786223755691, -56.92382186127851, 31.419286156191504, 2.6903353418263203, -189.5320788186685, -192.24935183099592, -62.101587362913996, 34.172506399451294, -7.911184771022265, 6.308197777243299, -90.12719563280396, -92.52183679710882, 11.165798431592957, 28.476057554988003, -1677.1717810377615, -1757.5738520927853, -1026.7072260149725, -895.7136424075482, -377.5890170479435, -347.5717773913167, -292.5945253910628, -254.92315955275438, -11.509857457094826, -104.35947925025745, -39.77324139646771, 16.357758059129655, -918.2395677711604, -979.7417735657219, 10.205434294803716, -13.859447762620494, 27.81370728274553, 13.06407020132556, -169.98200452366495, -177.60041132374698, -1261.796895340075, -1031.0947931119467, -31.049873810314402, 4.150000000000219, -9.994099260141793, -6.4581190230180034, -25.672597520545626, -55.03804207796492, -93.31680250215261, 20.000000000000014, -1551.975803490498, -1749.122856848688, -755.9967476113592, -692.7466834355452, -341.43658925621435, -320.8607871764276, -1282.1304460452145, -1304.7474339345113, 34.75415337920127, 27.88013966371793, -792.020233295736, -874.6672528876211, -1096.842179652981, -1040.665680965829, -1270.6218244969696, -1177.7101204931287, -1518.0371982279028, -1199.0343186772216, -1054.5402362368052, -1106.4993539819945, -757.1655817992039, -651.483194226126, -37.57176668800351, -5.883951195427958, -59.81369150989474, -112.90300644400855, -157.959226180071, -141.98407070740086, -302.192086985886, -260.11259236558897, -1363.1592735589124, -1494.3001679206614, -589.1237877637792, -594.033919108746, -1533.1913801843934, -1416.0734548668001, 14.583448485174017, -132.82672620501447, -1153.1744902815067, -1190.8330522313402, -1146.3161635271176, -1129.0033273462113, -122.63850150457802, -114.18790747957715, -778.7852254858682, -837.6022383815288, -1539.1719253792442, -1523.753067585133, -1176.831488901804, -1286.12780282859, -1005.3788856587389, -1079.5091728596335, 13.874429827648635, -10.60126836105323, -949.6253344451576, -993.2467031905747, -5.365492823801032, 17.412889465045314, -151.390950514621, 9.30410001571403, -30.467090415883796, 22.37333738880599, -770.6093854453912, -833.3552426920019, -1004.1575890024625, -1146.3144016869308, -480.5916655305812, -437.7414555415968, -834.0473010217057, -902.6034809388743, -215.00365733595137, -243.06932931492372, 34.88673647984311, 17.643199931366638, -633.7959341369153, -675.7048203126662, -1090.4820400442843, -1063.3282759862225, -1154.8182939122178, -1258.1744411511454, 29.98075697256755, 20.000000000000014, -43.184756056201465, -35.46853480397323, -53.78491515717004, -66.00813687843564, -1137.844501605811, -1519.520789006662, -622.3755076568916, -609.8634406144738, -1.3224647437259125, -11.897497723840912, -830.2897270341232, -791.3468280501174, -527.1412845298605, -454.6474554143289, -368.68455663634114, -450.0335806595108, -650.2627771913457, -545.4815351001873, -1202.0699787920296, -1400.795660021067, -1236.3798567374763, -1335.268780007445, -1485.7232027092657, -1446.6185644764041, -421.89749475692105, -451.5029347759697, -899.5609543325547, -782.8687372039726], "policy_predator_policy_reward": [15.31187257651373, 1052.88218121864, 179.0571230983691, 4.05987229512683, 55.077812061904815, 4.580834184030794, 24.295456611976153, 51.69191761017692, 17.965153544222456, 4.069417861645085, 17.018619169634775, 10.141808617469902, 64.77701618062201, 997.9531643928343, 23.792283204540666, 5.5989874102335335, 0.0, 671.5226191139757, 8.560134749111414, 53.81637230276454, 1276.8515630470995, 4.4498242445741045, 1.0659189776764915, 2.30619167308848, 21.572396198363315, 23.25764483967578, 2.7866228695138946, 183.22887829435652, 75.69243090676352, 102.04963513324236, 31.443772870814367, 2.234804689938553, 2.989850338719485, 318.8132987229199, 10.854697693920567, 288.3077330806829, 5.469864136719682, 610.4474490519805, 490.90728973722923, 1326.9721311410658, 9.698932061517304, 113.05761337408991, 18.861557539524696, 1269.7304376883305, 29.77470305293392, 566.1922380234339, 14.909469052949811, 139.68554837921823, 26.809664658173645, 5.270927157835849, 235.05862643300605, 15.911317205837166, 78.90158736291318, 1.0274936005489594, 40.81118477102236, 12.991802222756666, 110.37230230779082, 7.6609730890045, 8.234201568407007, 9.623942445012158, 1660.0721512018558, 1678.2418361572481, 1059.217220661659, 0.0, 400.9947403402549, 0.8876842354561967, 300.8414736449966, 7.506011275986735, 83.1459351364716, 73.01217860807178, 23.896775106824318, 37.818708230513934, 9.18495916805061, 1042.085840288541, 35.259447762620475, 0.0, 5.186292717254617, 6.4359297986744055, 209.0228658761576, 29.648126404456157, 22.94158754110167, 1296.6333884299663, 63.14987381031436, 0.0, 4.378949843620236, 47.46190181064359, 1.063221208261428, 87.13075172358263, 23.8016066390048, 85.41519586314696, 124.04513242313293, 1843.8821906601393, 782.5889269670629, 2.9287635201157514, 397.302634258303, 0.0, 1098.3032469169352, 1242.628382840285, 2.531956646516523, 5.533750310564654, 3.3295370161824818, 935.5636948760481, 1192.400225390075, 20.252778297042607, 1227.3957522820888, 815.3309374167499, 1605.4038920477797, 41.31859105208576, 689.8040523307775, 1081.1664809458234, 24.005567963074718, 787.8782935462374, 53.270014303376726, 21.36095270834043, 85.47514168897605, 52.621704812009156, 10.11868494539586, 174.7665153718061, 37.76160986960062, 296.57462205173283, 60.36313492041665, 1630.2628506938313, 8.743183580626575, 642.5273647190463, 1508.7661514415677, 690.3559234304075, 93.39443720023289, 59.84884051960666, 8.162758462263437, 1291.2329050628812, 1256.3566741986206, 9.372261601918058, 137.19151392699254, 10.396958235343114, 837.7213278719602, 63.44948323651209, 1297.3315264026385, 1014.1161180858603, 1344.897147278802, 11.19977055290454, 1125.7959738134857, 0.0, 14.961863905691375, 32.037553657392436, 1062.927895261875, 31.15162444484438, 23.665492823801088, 9.08711053495468, 2.7292094348772684, 168.2479106048261, 40.26277617092779, 12.280976856150355, 752.4728246237374, 575.344894423645, 0.0, 1183.338255377896, 41.451612325631196, 486.5545167174959, 5.454572534664752, 978.1327798914484, 269.2481581775308, 7.971890051836196, 15.059382800169782, 11.611906562722135, 653.7882128815885, 263.40816248551397, 1191.4364882561792, 6.39148422771979, 0.894275676874453, 1325.3440504594585, 6.619243027432633, 0.0, 73.08383413294405, 8.151868137306534, 69.07649339328468, 14.275709835068565, 328.98296858909634, 1624.1657340849247, 1.0197714259058657, 671.2926300814622, 25.833333333333336, 4.231300688382303, 141.9918429062541, 877.8626968805901, 58.66802305582037, 541.7089762463229, 7.252760232607971, 471.5268508972681, 21.88164670138375, 680.2116750809898, 0.0, 1514.3033510602652, 14.143133584659116, 1438.388667846815, 1625.6769564764181, 13.90787851317481, 507.5215358562248, 8.823062061224615, 7.220338054316426, 920.2751256254403]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.8203945785174245, "mean_inference_ms": 3.721273961906877, "mean_action_processing_ms": 1.8524401650721478, "mean_env_wait_ms": 1.1426972347789244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004957914352416992, "StateBufferConnector_ms": 0.023298144340515137, "ViewRequirementAgentConnector_ms": 0.17194044589996338}, "num_episodes": 64, "episode_return_max": 79.20122577410085, "episode_return_min": -1333.1713372559138, "episode_return_mean": -372.77886372399496, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 234.07500217894693, "num_env_steps_trained_throughput_per_sec": 234.07500217894693, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 1984000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1984000, "timers": {"training_iteration_time_ms": 32484.51, "restore_workers_time_ms": 0.025, "training_step_time_ms": 32483.085, "sample_time_ms": 1382.151, "learn_time_ms": 31059.317, "learn_throughput": 257.572, "synch_weights_time_ms": 34.937}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000}, "done": false, "training_iteration": 62, "trial_id": "cd905_00000", "date": "2024-08-20_09-57-47", "timestamp": 1724128067, "time_this_iter_s": 34.23085284233093, "time_total_s": 2024.031833410263, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a1678b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2024.031833410263, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 42.97755102040817, "ram_util_percent": 81.05918367346939}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49700504861299005, "cur_kl_coeff": 8.046627044677734e-08, "cur_lr": 0.0001, "total_loss": 9.7663362684704, "policy_loss": -0.002374012226475373, "vf_loss": 9.768710305955675, "vf_explained_var": 0.00038391550381978355, "kl": 0.005864423078204824, "entropy": 1.2316304537985059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 39375.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5478228168473357, "cur_kl_coeff": 8.73114913702011e-12, "cur_lr": 0.0001, "total_loss": 9.01096411810981, "policy_loss": -0.0022329209819583903, "vf_loss": 9.01319699363103, "vf_explained_var": 2.0251009199354382e-05, "kl": 0.005498377159154669, "entropy": 1.0738773508677406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 39375.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "env_runners": {"episode_reward_max": 79.20122577410085, "episode_reward_min": -1333.1713372559138, "episode_reward_mean": -391.0263144216506, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1757.5738520927853, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 34.88673647984311, "predator_policy": 1843.8821906601393}, "policy_reward_mean": {"prey_policy": -565.8093998270947, "predator_policy": 370.2962426162693}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-505.9425577222684, 20.061050315167034, -1139.1325529742517, 46.0000000000004, 39.284210262140334, -121.20299550147178, 52.13951128030234, 37.55000000000036, -217.27105490019335, -183.9303588850556, -470.78923771115, -555.5434457473069, 32.405077714012485, -1036.1423319295031, -472.7416059380581, -28.01666666666651, 66.19021331402749, -130.8114870108214, 52.00000000000049, 52.20000000000048, -64.61575703311708, 57.500000000000476, -96.43164577144252, -863.2036477608616, -323.27836986354913, -239.17020002283388, 40.28877703719215, 38.300000000000274, -846.7105418802907, 31.605434294804038, 52.50000000000051, -108.9114235667978, -973.3167124809536, 36.25000000000003, 35.38863337110409, 7.483333333333782, 35.90000000000024, -1333.1713372559138, -663.2257405597258, -264.99474217433874, -245.94625022250545, 70.70000000000002, -727.7942542911267, -924.8548569316922, -405.6052552912592, -1070.3490338052593, -390.069056942199, -596.7649145160177, 31.175249128285547, -34.61985145291811, -115.05809657026967, -227.9684474301417, -1166.8334558653248, -531.8871585728516, -750.1427601792184, 35.00000000000023, -1044.6118789877019, -1009.590555072791, -89.23793682181962, -715.2166527589247, -751.4773484758783, -1106.8623738986869, -959.0920847048869, 50.272579029679626, -848.7925179290136, 44.80000000000038, 28.890269540797416, 44.450000000000394, -276.1469090900103, -967.133735311497, -390.3269920290508, -753.0634295344665, -180.85293842150813, 79.20122577410085, -392.30437908247916, -955.9823435466074, -1086.7544089270302, 56.600000000000506, 2.5824114100760234, -36.44084880725227, -704.2165879384505, -559.9265467639973, 16.84467155414908, -601.7820152973965, -381.41174064204563, -339.93852616597536, -493.6509905091593, -1088.5622877528317, -1119.1168353134474, -1292.756932196077, -357.05583161544115, -754.9342278567707, -670.7878617341266, -498.3153946063668, -466.99161034840023, -54.12638590863743, -685.2717327554287, -82.73475280704358, -659.2777687279955, -95.00092175768869], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-555.8570089399261, -621.6081678963183, -21.747353639285087, -20.568103097424174, -1244.2915559555336, -1176.1423843103917, 21.80000000000004, 20.827889349235058, 5.98988615540682, -11.535716931305931, -142.44892089117798, -164.769575774164, -112.05196453934872, -13.55059022035603, -10.927983132954347, 14.799405572201522, -240.26400308123542, -298.8102008805974, -226.63380057455524, -256.458989085104, -514.9989283540028, -571.7076225458472, -1149.2839387998804, -1224.1389278257216, -78.09360851913084, -12.257859202464626, -1170.7111087020053, -1154.0232184553538, -532.129516309777, -536.5790307046486, -125.68786223755691, -56.92382186127851, 31.419286156191504, 2.6903353418263203, -189.5320788186685, -192.24935183099592, -62.101587362913996, 34.172506399451294, -7.911184771022265, 6.308197777243299, -90.12719563280396, -92.52183679710882, 11.165798431592957, 28.476057554988003, -1677.1717810377615, -1757.5738520927853, -1026.7072260149725, -895.7136424075482, -377.5890170479435, -347.5717773913167, -292.5945253910628, -254.92315955275438, -11.509857457094826, -104.35947925025745, -39.77324139646771, 16.357758059129655, -918.2395677711604, -979.7417735657219, 10.205434294803716, -13.859447762620494, 27.81370728274553, 13.06407020132556, -169.98200452366495, -177.60041132374698, -1261.796895340075, -1031.0947931119467, -31.049873810314402, 4.150000000000219, -9.994099260141793, -6.4581190230180034, -25.672597520545626, -55.03804207796492, -93.31680250215261, 20.000000000000014, -1551.975803490498, -1749.122856848688, -755.9967476113592, -692.7466834355452, -341.43658925621435, -320.8607871764276, -1282.1304460452145, -1304.7474339345113, 34.75415337920127, 27.88013966371793, -792.020233295736, -874.6672528876211, -1096.842179652981, -1040.665680965829, -1270.6218244969696, -1177.7101204931287, -1518.0371982279028, -1199.0343186772216, -1054.5402362368052, -1106.4993539819945, -757.1655817992039, -651.483194226126, -37.57176668800351, -5.883951195427958, -59.81369150989474, -112.90300644400855, -157.959226180071, -141.98407070740086, -302.192086985886, -260.11259236558897, -1363.1592735589124, -1494.3001679206614, -589.1237877637792, -594.033919108746, -1533.1913801843934, -1416.0734548668001, 14.583448485174017, -132.82672620501447, -1153.1744902815067, -1190.8330522313402, -1146.3161635271176, -1129.0033273462113, -122.63850150457802, -114.18790747957715, -778.7852254858682, -837.6022383815288, -1539.1719253792442, -1523.753067585133, -1176.831488901804, -1286.12780282859, -1005.3788856587389, -1079.5091728596335, 13.874429827648635, -10.60126836105323, -949.6253344451576, -993.2467031905747, -5.365492823801032, 17.412889465045314, -151.390950514621, 9.30410001571403, -30.467090415883796, 22.37333738880599, -770.6093854453912, -833.3552426920019, -1004.1575890024625, -1146.3144016869308, -480.5916655305812, -437.7414555415968, -834.0473010217057, -902.6034809388743, -215.00365733595137, -243.06932931492372, 34.88673647984311, 17.643199931366638, -633.7959341369153, -675.7048203126662, -1090.4820400442843, -1063.3282759862225, -1154.8182939122178, -1258.1744411511454, 29.98075697256755, 20.000000000000014, -43.184756056201465, -35.46853480397323, -53.78491515717004, -66.00813687843564, -1137.844501605811, -1519.520789006662, -622.3755076568916, -609.8634406144738, -1.3224647437259125, -11.897497723840912, -830.2897270341232, -791.3468280501174, -527.1412845298605, -454.6474554143289, -368.68455663634114, -450.0335806595108, -650.2627771913457, -545.4815351001873, -1202.0699787920296, -1400.795660021067, -1236.3798567374763, -1335.268780007445, -1485.7232027092657, -1446.6185644764041, -421.89749475692105, -451.5029347759697, -899.5609543325547, -782.8687372039726, -885.1178842973209, -1332.7044350427173, -627.9575329180346, -575.1224089307174, -659.8986012613685, -642.0166613684794, -1153.912326027292, -989.4756114557827, -856.4058273450316, -962.7258744823931, -539.9514016119032, -525.795869141052, -1040.1192912982078, -1077.6297578134813, -136.62143118436802, -141.29611075561027], "policy_predator_policy_reward": [0.0, 671.5226191139757, 8.560134749111414, 53.81637230276454, 1276.8515630470995, 4.4498242445741045, 1.0659189776764915, 2.30619167308848, 21.572396198363315, 23.25764483967578, 2.7866228695138946, 183.22887829435652, 75.69243090676352, 102.04963513324236, 31.443772870814367, 2.234804689938553, 2.989850338719485, 318.8132987229199, 10.854697693920567, 288.3077330806829, 5.469864136719682, 610.4474490519805, 490.90728973722923, 1326.9721311410658, 9.698932061517304, 113.05761337408991, 18.861557539524696, 1269.7304376883305, 29.77470305293392, 566.1922380234339, 14.909469052949811, 139.68554837921823, 26.809664658173645, 5.270927157835849, 235.05862643300605, 15.911317205837166, 78.90158736291318, 1.0274936005489594, 40.81118477102236, 12.991802222756666, 110.37230230779082, 7.6609730890045, 8.234201568407007, 9.623942445012158, 1660.0721512018558, 1678.2418361572481, 1059.217220661659, 0.0, 400.9947403402549, 0.8876842354561967, 300.8414736449966, 7.506011275986735, 83.1459351364716, 73.01217860807178, 23.896775106824318, 37.818708230513934, 9.18495916805061, 1042.085840288541, 35.259447762620475, 0.0, 5.186292717254617, 6.4359297986744055, 209.0228658761576, 29.648126404456157, 22.94158754110167, 1296.6333884299663, 63.14987381031436, 0.0, 4.378949843620236, 47.46190181064359, 1.063221208261428, 87.13075172358263, 23.8016066390048, 85.41519586314696, 124.04513242313293, 1843.8821906601393, 782.5889269670629, 2.9287635201157514, 397.302634258303, 0.0, 1098.3032469169352, 1242.628382840285, 2.531956646516523, 5.533750310564654, 3.3295370161824818, 935.5636948760481, 1192.400225390075, 20.252778297042607, 1227.3957522820888, 815.3309374167499, 1605.4038920477797, 41.31859105208576, 689.8040523307775, 1081.1664809458234, 24.005567963074718, 787.8782935462374, 53.270014303376726, 21.36095270834043, 85.47514168897605, 52.621704812009156, 10.11868494539586, 174.7665153718061, 37.76160986960062, 296.57462205173283, 60.36313492041665, 1630.2628506938313, 8.743183580626575, 642.5273647190463, 1508.7661514415677, 690.3559234304075, 93.39443720023289, 59.84884051960666, 8.162758462263437, 1291.2329050628812, 1256.3566741986206, 9.372261601918058, 137.19151392699254, 10.396958235343114, 837.7213278719602, 63.44948323651209, 1297.3315264026385, 1014.1161180858603, 1344.897147278802, 11.19977055290454, 1125.7959738134857, 0.0, 14.961863905691375, 32.037553657392436, 1062.927895261875, 31.15162444484438, 23.665492823801088, 9.08711053495468, 2.7292094348772684, 168.2479106048261, 40.26277617092779, 12.280976856150355, 752.4728246237374, 575.344894423645, 0.0, 1183.338255377896, 41.451612325631196, 486.5545167174959, 5.454572534664752, 978.1327798914484, 269.2481581775308, 7.971890051836196, 15.059382800169782, 11.611906562722135, 653.7882128815885, 263.40816248551397, 1191.4364882561792, 6.39148422771979, 0.894275676874453, 1325.3440504594585, 6.619243027432633, 0.0, 73.08383413294405, 8.151868137306534, 69.07649339328468, 14.275709835068565, 328.98296858909634, 1624.1657340849247, 1.0197714259058657, 671.2926300814622, 25.833333333333336, 4.231300688382303, 141.9918429062541, 877.8626968805901, 58.66802305582037, 541.7089762463229, 7.252760232607971, 471.5268508972681, 21.88164670138375, 680.2116750809898, 0.0, 1514.3033510602652, 14.143133584659116, 1438.388667846815, 1625.6769564764181, 13.90787851317481, 507.5215358562248, 8.823062061224615, 7.220338054316426, 920.2751256254403, 76.84409729053513, 1470.1903603153764, 701.6395467456797, 3.1250004967054523, 692.948641916094, 141.97501036535346, 954.0279628688198, 1135.2335887056174, 27.4931222438233, 1106.3668468281733, 582.2982135266969, 400.7143044192143, 1137.535066535459, 320.9362138482346, 11.333552246359021, 171.58306793593022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.818183445125841, "mean_inference_ms": 3.7289078494793215, "mean_action_processing_ms": 1.8474202242813635, "mean_env_wait_ms": 1.1442472193871842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004934906959533691, "StateBufferConnector_ms": 0.023128628730773926, "ViewRequirementAgentConnector_ms": 0.18111169338226318}, "num_episodes": 8, "episode_return_max": 79.20122577410085, "episode_return_min": -1333.1713372559138, "episode_return_mean": -391.0263144216506, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 230.43359388187662, "num_env_steps_trained_throughput_per_sec": 230.43359388187662, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 2016000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2016000, "timers": {"training_iteration_time_ms": 32756.457, "restore_workers_time_ms": 0.024, "training_step_time_ms": 32755.063, "sample_time_ms": 1412.346, "learn_time_ms": 31300.397, "learn_throughput": 255.588, "synch_weights_time_ms": 35.613}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "done": false, "training_iteration": 63, "trial_id": "cd905_00000", "date": "2024-08-20_09-58-21", "timestamp": 1724128101, "time_this_iter_s": 34.763396978378296, "time_total_s": 2058.7952303886414, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a167f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2058.7952303886414, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 44.766000000000005, "ram_util_percent": 80.074}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3321179563800494, "cur_kl_coeff": 8.046627044677734e-08, "cur_lr": 0.0001, "total_loss": 9.055797829703678, "policy_loss": -0.0005341414003706877, "vf_loss": 9.056331952412924, "vf_explained_var": 0.0011892356569804842, "kl": 0.005610970683038532, "entropy": 1.2719649564652216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 40005.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5456301335304502, "cur_kl_coeff": 8.73114913702011e-12, "cur_lr": 0.0001, "total_loss": 7.856818849321396, "policy_loss": -0.0019444157306607516, "vf_loss": 7.85876326712351, "vf_explained_var": 0.0004987002365172855, "kl": 0.008315136178471799, "entropy": 1.1218210089774359, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 40005.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000}, "env_runners": {"episode_reward_max": 150.43452435734585, "episode_reward_min": -1292.756932196077, "episode_reward_mean": -425.5917719298567, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1759.105880583343, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 34.88673647984311, "predator_policy": 1763.1482184974034}, "policy_reward_mean": {"prey_policy": -850.8855711523653, "predator_policy": 638.0896851874371}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-848.7925179290136, 44.80000000000038, 28.890269540797416, 44.450000000000394, -276.1469090900103, -967.133735311497, -390.3269920290508, -753.0634295344665, -180.85293842150813, 79.20122577410085, -392.30437908247916, -955.9823435466074, -1086.7544089270302, 56.600000000000506, 2.5824114100760234, -36.44084880725227, -704.2165879384505, -559.9265467639973, 16.84467155414908, -601.7820152973965, -381.41174064204563, -339.93852616597536, -493.6509905091593, -1088.5622877528317, -1119.1168353134474, -1292.756932196077, -357.05583161544115, -754.9342278567707, -670.7878617341266, -498.3153946063668, -466.99161034840023, -54.12638590863743, -685.2717327554287, -82.73475280704358, -659.2777687279955, -95.00092175768869, -163.3909131106497, -445.1339971728311, -535.9563915196596, -588.1049454139916, -433.56150809280996, -682.2073357564576, -1088.1147046012543, -269.7439577595903, -799.4013428670908, 42.218447663935194, 89.92697598950983, -521.2412268962356, 46.56434699633172, -137.41056365699706, -523.0557077955259, -329.21796638631287, -191.4293249796123, -739.8006379632554, -1175.9621308651401, -188.63831311508065, 140.6389165843488, -146.32068295449915, -388.49422907219093, -704.8597366920125, -1022.2156230879265, -357.7481853782812, -207.41203932954588, -845.1954882233123, -56.890001885956664, -399.45289883682034, -853.1625862971327, -10.135724982875946, -639.6209036573106, -135.2387906519501, -407.3159014294504, -293.9273456341299, 49.03356877156679, -484.1834221309974, -844.2348223355509, -362.1253981219516, -582.2314870345778, -259.99952291583827, -876.4864565064184, -291.7702649046111, -161.8467613245183, -838.0904448932391, -854.7979952198997, -368.672996476845, 43.780863174951264, 129.73568806366197, -420.9383988102307, -50.30929501401752, -335.19127246888837, -534.3233623867486, -297.8751820500368, -212.086579103771, -444.59053103468483, -600.6340717916445, 150.43452435734585, -824.8868834242082, -594.1001070552641, -130.24998642339446, -463.9529163722314, -617.2823856247873], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-949.6253344451576, -993.2467031905747, -5.365492823801032, 17.412889465045314, -151.390950514621, 9.30410001571403, -30.467090415883796, 22.37333738880599, -770.6093854453912, -833.3552426920019, -1004.1575890024625, -1146.3144016869308, -480.5916655305812, -437.7414555415968, -834.0473010217057, -902.6034809388743, -215.00365733595137, -243.06932931492372, 34.88673647984311, 17.643199931366638, -633.7959341369153, -675.7048203126662, -1090.4820400442843, -1063.3282759862225, -1154.8182939122178, -1258.1744411511454, 29.98075697256755, 20.000000000000014, -43.184756056201465, -35.46853480397323, -53.78491515717004, -66.00813687843564, -1137.844501605811, -1519.520789006662, -622.3755076568916, -609.8634406144738, -1.3224647437259125, -11.897497723840912, -830.2897270341232, -791.3468280501174, -527.1412845298605, -454.6474554143289, -368.68455663634114, -450.0335806595108, -650.2627771913457, -545.4815351001873, -1202.0699787920296, -1400.795660021067, -1236.3798567374763, -1335.268780007445, -1485.7232027092657, -1446.6185644764041, -421.89749475692105, -451.5029347759697, -899.5609543325547, -782.8687372039726, -885.1178842973209, -1332.7044350427173, -627.9575329180346, -575.1224089307174, -659.8986012613685, -642.0166613684794, -1153.912326027292, -989.4756114557827, -856.4058273450316, -962.7258744823931, -539.9514016119032, -525.795869141052, -1040.1192912982078, -1077.6297578134813, -136.62143118436802, -141.29611075561027, -1161.6379553399468, -1171.2367462026746, -1006.2398870020656, -1006.5238887526423, -648.4171890791727, -604.4565295899747, -1352.2788494132728, -1135.2127119575443, -626.954738638183, -564.3221415958326, -1116.3933974739957, -1052.8839236861138, -1372.443226229953, -1396.415158891639, -587.3459680364848, -638.3048176079006, -1071.6329797866301, -1109.152574054789, -618.2730032742146, -593.6121510477552, -535.4850878049912, -486.3945427315515, -649.3121954982219, -645.1231218405687, -40.83791069372364, -65.8581503770266, -488.872975631633, -465.4903540994541, -922.4843686212456, -776.0212270951297, -367.0314675896734, -346.949545862033, -927.1330920019705, -954.3908847701679, -1363.3226973545827, -1352.7451640318275, -1428.2601695385238, -1296.4378845766514, -747.2332641155548, -755.4827798715781, -919.5399189139406, -779.0692356314084, -1407.7409454144781, -1159.3249592849647, -933.7726002179242, -922.7532207718411, -838.3465393501699, -784.4919699918453, -1163.2093059555368, -1217.6966245304895, -697.5492039224152, -765.9423934576876, -630.1037363810624, -633.7020336227977, -1208.7961030994693, -1660.8986861225203, -1422.2085090005407, -1529.2341943756412, -735.3397472361817, -805.2085140629839, -1105.7078470153258, -1122.3224696446173, -861.8856130580326, -831.5679657350447, -763.1085755563771, -719.699208179873, -762.7425766692643, -808.3443600890661, -1132.526746381435, -1175.9654290445778, -1526.9457784192189, -1183.5159042784696, -1097.6556789212634, -1190.4614351493574, -889.1801364629603, -883.5318675992543, -1059.6513185488093, -1106.2864528711475, -1682.5291735824144, -1416.356936698623, -650.8065668634533, -706.9399117684164, -1212.7480267254832, -1298.3277175879512, -1046.0236403165402, -1068.9887787554078, -1460.8926211942553, -1157.4707622929093, -1245.1996310652248, -1188.5363272693448, -937.7035305742671, -983.7624190285928, -1031.0830708920003, -1003.7345137842291, -1053.8742001226024, -965.7295873767821, -1700.6513035680878, -1759.105880583343, -1035.2191988959498, -1115.919843835507, -488.30803295281595, -484.0127967332299, -1463.124277540261, -1710.1078604365416, -1489.6884767157844, -1413.3589102974938, -771.0115378840692, -667.1461485472652, -338.8250506910337, -373.32451803674496, -939.9417551178092, -1043.7744804258289, -549.3157336561803, -609.6484810272277, -1305.698273015496, -1329.4464484384953, -974.6897916586277, -949.4462245973931, -1445.3019733365727, -1397.2167183208146, -1209.5799965032254, -1636.0676163539526, -165.11665590472344, -211.4484715599547, -901.8583511037742, -859.3141949074434, -818.7656646009617, -774.4522777926635], "policy_predator_policy_reward": [1062.927895261875, 31.15162444484438, 23.665492823801088, 9.08711053495468, 2.7292094348772684, 168.2479106048261, 40.26277617092779, 12.280976856150355, 752.4728246237374, 575.344894423645, 0.0, 1183.338255377896, 41.451612325631196, 486.5545167174959, 5.454572534664752, 978.1327798914484, 269.2481581775308, 7.971890051836196, 15.059382800169782, 11.611906562722135, 653.7882128815885, 263.40816248551397, 1191.4364882561792, 6.39148422771979, 0.894275676874453, 1325.3440504594585, 6.619243027432633, 0.0, 73.08383413294405, 8.151868137306534, 69.07649339328468, 14.275709835068565, 328.98296858909634, 1624.1657340849247, 1.0197714259058657, 671.2926300814622, 25.833333333333336, 4.231300688382303, 141.9918429062541, 877.8626968805901, 58.66802305582037, 541.7089762463229, 7.252760232607971, 471.5268508972681, 21.88164670138375, 680.2116750809898, 0.0, 1514.3033510602652, 14.143133584659116, 1438.388667846815, 1625.6769564764181, 13.90787851317481, 507.5215358562248, 8.823062061224615, 7.220338054316426, 920.2751256254403, 76.84409729053513, 1470.1903603153764, 701.6395467456797, 3.1250004967054523, 692.948641916094, 141.97501036535346, 954.0279628688198, 1135.2335887056174, 27.4931222438233, 1106.3668468281733, 582.2982135266969, 400.7143044192143, 1137.535066535459, 320.9362138482346, 11.333552246359021, 171.58306793593022, 923.7644490566905, 1245.719339375281, 485.06883885648233, 1082.560939725395, 667.5726738697206, 49.34465327976726, 1475.1265516485983, 424.26006430822736, 717.2211866603152, 40.49418548089057, 1216.5081820359455, 270.5618033677069, 167.03109984104486, 1513.712580679293, 618.5937529597414, 337.3130749250537, 1211.3429459467961, 170.0412650275319, 670.2704450000075, 583.8331569858974, 591.990725655027, 519.8158808710253, 55.02063502771159, 718.1734554148433, 107.04710902927498, 46.21329903780676, 261.9086673794329, 555.0440986946569, 201.10755546494443, 974.3423324559051, 0.0, 384.7630470653933, 1023.4351805669439, 666.6594712255821, 502.76020100517445, 1473.50702241798, 1511.5103316735817, 37.22559157645318, 448.75929608222424, 865.3184347898288, 941.4172086961887, 897.8308624335089, 1377.5643391382196, 1043.1808826067243, 454.24718127000017, 1013.7844106475749, 35.66854055644113, 882.3102320935616, 1286.4438552006748, 72.24645219742453, 315.5747395175137, 790.168672484308, 376.06683003904135, 680.3269006352728, 308.5054296198188, 1715.9938713788588, 1592.7962893296592, 1301.7564121605658, 860.5332436205001, 280.56211884184506, 1221.3525842178035, 153.515146145007, 877.1296652366312, 806.1881885735702, 0.7979338949596588, 842.3889461839796, 600.8155186166131, 835.032627489767, 787.0466075090217, 1114.1296664875413, 1550.4874728329369, 866.0468642306218, 1106.1433860129941, 1231.0072968291936, 321.2856420518435, 967.2429398793741, 1308.0295939542195, 13.673355130186719, 1608.4357111650374, 1128.3250009940482, 739.6801325175595, 35.834859079732446, 1355.373693320569, 895.7025280770274, 7.153907867927435, 1231.3720546976024, 1562.425992442741, 764.1671261398119, 1040.292439640467, 1231.5967573695843, 27.509224773968903, 1055.866279935652, 1127.2720731154511, 52.74751634087932, 537.8341938460717, 1113.0965971764676, 1763.1482184974034, 1740.3898288289784, 1106.4021364208925, 1174.472594374226, 546.0413727102023, 5.341058165613068, 1403.2483150317344, 1719.6745279310503, 1595.280105422099, 972.5760091222911, 60.19145513693168, 843.6428689076542, 413.4418863303059, 0.8325003474356079, 1054.297173840453, 717.3324825994141, 642.5023145870161, 71.87136906170701, 1448.0099190501214, 586.5007306122245, 1035.6925944022087, 1038.877946211158, 496.1045949746433, 1521.5272132585353, 569.9336131815801, 1681.613892620334, 0.0, 246.31514104128343, 324.5225059868502, 972.6971236521362, 898.054362759656, 77.88119400918251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.847084320692659, "mean_inference_ms": 3.750982238291243, "mean_action_processing_ms": 1.8588220360096, "mean_env_wait_ms": 1.1538818073526251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047855377197265625, "StateBufferConnector_ms": 0.023107171058654785, "ViewRequirementAgentConnector_ms": 0.13379299640655518}, "num_episodes": 64, "episode_return_max": 150.43452435734585, "episode_return_min": -1292.756932196077, "episode_return_mean": -425.5917719298567, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 239.37186788415306, "num_env_steps_trained_throughput_per_sec": 239.37186788415306, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 2048000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2048000, "timers": {"training_iteration_time_ms": 32889.499, "restore_workers_time_ms": 0.024, "training_step_time_ms": 32888.34, "sample_time_ms": 1432.222, "learn_time_ms": 31413.209, "learn_throughput": 254.67, "synch_weights_time_ms": 36.257}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000}, "done": false, "training_iteration": 64, "trial_id": "cd905_00000", "date": "2024-08-20_09-58-55", "timestamp": 1724128135, "time_this_iter_s": 33.45951581001282, "time_total_s": 2092.254746198654, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afc6d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2092.254746198654, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 41.48510638297873, "ram_util_percent": 80.0659574468085}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1370691843922176, "cur_kl_coeff": 8.046627044677734e-08, "cur_lr": 0.0001, "total_loss": 9.481413275098044, "policy_loss": -0.00036777477667090437, "vf_loss": 9.481781052786207, "vf_explained_var": 0.001943103377781217, "kl": 0.0009068303258183213, "entropy": 1.3133211544581822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5326031106154597, "cur_kl_coeff": 8.73114913702011e-12, "cur_lr": 0.0001, "total_loss": 9.246106868320041, "policy_loss": -0.00032393810161877244, "vf_loss": 9.246430808778793, "vf_explained_var": 0.00017440271756005666, "kl": 0.0007868260898978031, "entropy": 1.147103432435838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "env_runners": {"episode_reward_max": 251.5087156112189, "episode_reward_min": -876.4864565064184, "episode_reward_mean": -193.97672966321724, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1759.105880583343, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": -165.11665590472344, "predator_policy": 1763.1482184974034}, "policy_reward_mean": {"prey_policy": -1041.084520789442, "predator_policy": 944.0961559578332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.03356877156679, -484.1834221309974, -844.2348223355509, -362.1253981219516, -582.2314870345778, -259.99952291583827, -876.4864565064184, -291.7702649046111, -161.8467613245183, -838.0904448932391, -854.7979952198997, -368.672996476845, 43.780863174951264, 129.73568806366197, -420.9383988102307, -50.30929501401752, -335.19127246888837, -534.3233623867486, -297.8751820500368, -212.086579103771, -444.59053103468483, -600.6340717916445, 150.43452435734585, -824.8868834242082, -594.1001070552641, -130.24998642339446, -463.9529163722314, -617.2823856247873, -355.9475691439482, -322.8843308892081, -51.7030388342811, -351.0965310014415, -523.2478020867908, -581.694820922608, -375.1226763549471, -121.34522092951559, -387.4787689957311, -275.0531300307842, -481.36695380996696, -549.5013606959293, -585.6158102034233, -76.86822834951055, 104.09042487688772, -409.1531205393266, 155.8282664356533, 29.82178391907586, 104.16922809697454, -262.9263528157115, -463.11908510980516, -4.392806719540219, -229.1259409305266, -9.868810232603664, -32.21385563621151, -124.07834760916002, -285.75733671409637, -227.28676299680046, 160.1474014602298, -466.5236988487322, 29.752452983049935, 52.85521518742048, 58.664196455687815, -67.71484055982543, 63.818664162038154, 140.90458056656425, 185.1139544361943, -103.53449505914314, -7.41605086079732, -207.89706567304754, -499.49646936045906, 220.6772586802481, -230.49996206997432, 161.35718036049727, -31.424633486596775, 14.358251618550781, 95.41106331060801, 96.66489618269776, -386.0295598327814, 21.583232084629632, -424.4740164222682, -205.06934522203468, -100.24917685709546, -23.94256948101853, 80.77873724867112, 79.22851437704821, -386.351729389902, 133.41672483083045, -37.822895472914624, 28.79469894987465, -0.5102898639898541, 125.68442277818214, 135.16493819771205, 251.5087156112189, 101.28896692295866, -186.33922575302003, 154.22894887909567, -630.0926256453968, -295.0083782240557, 177.91690132314025, -8.381562798615732, 102.60056523290064], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1097.6556789212634, -1190.4614351493574, -889.1801364629603, -883.5318675992543, -1059.6513185488093, -1106.2864528711475, -1682.5291735824144, -1416.356936698623, -650.8065668634533, -706.9399117684164, -1212.7480267254832, -1298.3277175879512, -1046.0236403165402, -1068.9887787554078, -1460.8926211942553, -1157.4707622929093, -1245.1996310652248, -1188.5363272693448, -937.7035305742671, -983.7624190285928, -1031.0830708920003, -1003.7345137842291, -1053.8742001226024, -965.7295873767821, -1700.6513035680878, -1759.105880583343, -1035.2191988959498, -1115.919843835507, -488.30803295281595, -484.0127967332299, -1463.124277540261, -1710.1078604365416, -1489.6884767157844, -1413.3589102974938, -771.0115378840692, -667.1461485472652, -338.8250506910337, -373.32451803674496, -939.9417551178092, -1043.7744804258289, -549.3157336561803, -609.6484810272277, -1305.698273015496, -1329.4464484384953, -974.6897916586277, -949.4462245973931, -1445.3019733365727, -1397.2167183208146, -1209.5799965032254, -1636.0676163539526, -165.11665590472344, -211.4484715599547, -901.8583511037742, -859.3141949074434, -818.7656646009617, -774.4522777926635, -1119.9322627381232, -1006.2548011538082, -1139.3968114511595, -1396.4547733732018, -1038.524356996355, -983.3542468731716, -1357.4233808648985, -1371.5809083614581, -1224.2510586536448, -1076.6927305508125, -867.7770518712379, -876.8662856600656, -443.70594238736373, -472.74831748628134, -741.1634778328751, -800.9063518471617, -1422.0640494821478, -1450.988818970897, -711.338073944501, -768.3275445412477, -1139.2663980663895, -1427.9416809116583, -969.735216934306, -1287.649068648585, -888.7106197238137, -843.533248987447, -708.6877047023163, -725.3337274572892, -934.6365025654866, -1130.933798621558, -799.1930799198897, -807.562405673914, -698.9201932003061, -661.1014625159347, -1170.696652360732, -1306.0055278301606, -1562.1489428637447, -1461.0834938375156, -1179.2915361877267, -1093.7183545574276, -1229.87191280581, -1117.6385168270776, -506.0898628141441, -737.8928411720991, -738.0067738950223, -777.5105663644392, -952.0622321312974, -1097.0037007301821, -1218.3384043083597, -1295.0917480262447, -1507.7842028073035, -1646.6784719425439, -1144.8632856846446, -1288.5726013558788, -1182.264181290136, -1093.6977829881507, -654.6812412982193, -672.4338771011429, -1460.0278376099996, -1464.5843075611174, -1070.2045991631971, -881.8538045796955, -515.1549042694323, -506.850883828704, -893.5089228512861, -935.0890650615538, -1076.200925191592, -1264.9835054788884, -551.7326249936705, -540.092834981252, -590.5897689846934, -643.1153121669308, -1016.6664570585993, -948.077996193793, -717.4408294682602, -742.5541827510949, -383.1368389819206, -342.72643056043546, -1295.8362507123006, -1319.3137100884373, -792.4794489022898, -767.3599328614107, -811.0463466957796, -832.9861423558824, -1090.5537837448478, -1089.4997186006217, -1422.3437743704387, -1490.0496299366578, -1402.8949057082104, -1482.4628108711042, -1333.291252835506, -1450.5124804008744, -824.587003811657, -887.7999237942541, -949.124297265788, -918.9362552816124, -1490.7117456110361, -1217.8335453567001, -1239.768440067653, -1133.4476353142004, -1300.9077190451703, -1216.1989031881012, -1261.0855396466254, -1359.5653912241028, -1236.8769599808224, -1235.0382837343113, -657.0645451988667, -634.192196022131, -729.6065407644039, -782.9981719069413, -1129.6955944079184, -1043.4047561452662, -1224.7206492153182, -1382.4032697769558, -998.1740354159463, -869.0628559699214, -1062.977252873129, -921.4472163868777, -1612.1927481963903, -1461.181529286055, -820.1566214875985, -676.1085883056895, -807.888587659495, -738.8262451765224, -926.7953080554024, -1031.6329117128307, -844.4128612692276, -988.0814294030661, -903.3658264866247, -1085.0783932383613, -1054.3890916756652, -1263.6999372619125, -1008.3358378316761, -923.0234468835606, -1269.4450182845885, -1128.9654704406773, -1315.331520766088, -1394.7100540536192, -1330.5526706038838, -1227.7151392401074, -1666.4682610061454, -1433.4952257494122, -1131.5750115051997, -1145.881160442527], "policy_predator_policy_reward": [1106.1433860129941, 1231.0072968291936, 321.2856420518435, 967.2429398793741, 1308.0295939542195, 13.673355130186719, 1608.4357111650374, 1128.3250009940482, 739.6801325175595, 35.834859079732446, 1355.373693320569, 895.7025280770274, 7.153907867927435, 1231.3720546976024, 1562.425992442741, 764.1671261398119, 1040.292439640467, 1231.5967573695843, 27.509224773968903, 1055.866279935652, 1127.2720731154511, 52.74751634087932, 537.8341938460717, 1113.0965971764676, 1763.1482184974034, 1740.3898288289784, 1106.4021364208925, 1174.472594374226, 546.0413727102023, 5.341058165613068, 1403.2483150317344, 1719.6745279310503, 1595.280105422099, 972.5760091222911, 60.19145513693168, 843.6428689076542, 413.4418863303059, 0.8325003474356079, 1054.297173840453, 717.3324825994141, 642.5023145870161, 71.87136906170701, 1448.0099190501214, 586.5007306122245, 1035.6925944022087, 1038.877946211158, 496.1045949746433, 1521.5272132585353, 569.9336131815801, 1681.613892620334, 0.0, 246.31514104128343, 324.5225059868502, 972.6971236521362, 898.054362759656, 77.88119400918251, 516.1829049029878, 1254.0565898449954, 676.887885732473, 1536.0793682026808, 1115.051409478013, 855.1241555572326, 840.758641792348, 1537.149116432566, 1326.8693457680229, 450.8266413496429, 206.93616681296925, 956.0123497957265, 511.7892676215778, 29.54231589712053, 640.1338924335171, 780.5907163170041, 1593.2615062111859, 892.3125932461273, 419.99053857081, 784.6219498841543, 531.5660971974819, 1554.2750279705992, 269.00304610022374, 1438.8798787867372, 137.63876716006428, 1008.9892913477734, 794.2237013198271, 562.9295024902675, 1016.1349876465165, 1153.5257384174163, 869.2690317211435, 328.3333333333333, 743.1611716100781, 772.6887505418158, 1080.0742133113188, 1426.4497507986487, 1633.9545245607032, 1493.447140237531, 1342.8545195325823, 667.229018396861, 1304.2659896324246, 580.1253548906575, 732.0546238868988, 507.5352733798037, 411.8601657537105, 874.5312335752249, 1064.2806282520446, 974.9164943768312, 1044.2480863734122, 1436.9682103249809, 1319.479955948558, 1710.9043711921286, 1501.8670442845962, 645.8115060418311, 802.137032596996, 1246.5381686844912, 718.6971158967156, 768.5654039628762, 766.1137637345904, 1691.974682587795, 897.8269831345659, 1083.9838735913768, 465.363610322107, 609.4973929634493, 935.9032092748685, 951.3589750936592, 1302.1655852300119, 971.3040048806431, 681.1614529648874, 474.48267117207223, 749.0942038643254, 625.5154578538629, 1142.0913188995592, 1007.7670887890274, 574.4534325493905, 782.007084610821, 458.66183467713535, 259.7853840044231, 1395.433664828646, 1011.8192302990437, 175.942185661397, 884.4007267418446, 934.8536477004585, 929.8561000314513, 1243.7990441517566, 705.7544961237389, 1694.0618761193566, 1379.6887085482365, 1690.5297622199182, 1163.4033208728, 1312.9018156714721, 1485.2601691834582, 988.3546261112899, 819.4433648052291, 910.3699832706495, 1054.3554654594482, 842.9981958056258, 1479.517535329328, 1119.4137650153712, 1275.3855424511116, 1464.824282173623, 627.8083236373795, 957.7523177002845, 1457.8292679484084, 1454.13904077115, 917.5270260868879, 487.8953560802061, 779.4188156597733, 731.8851278974128, 861.4983220226031, 1092.0510816206204, 1160.277783309612, 658.0984184794554, 1562.6737711229164, 979.5592986047035, 1021.0943176119944, 1151.4169670100018, 795.1846067770903, 1744.8417235372963, 1357.3272528950235, 629.9335419942233, 865.8213779350747, 823.5910671640894, 848.8081884501099, 975.2260044697452, 1118.3671534962, 937.6437882855342, 1146.3592179979778, 1210.0569737111612, 879.6762129367828, 790.2372677883554, 1341.5125353962017, 970.7843744582542, 1114.8038591360778, 440.6510443496693, 1327.6668187301998, 913.719395363953, 1501.313801231699, 1445.6681487643932, 1290.5165624027372, 1670.634964139242, 1420.9469598176986, 1309.7040331185926, 1070.3527040620347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.856126833416388, "mean_inference_ms": 3.7590937999240235, "mean_action_processing_ms": 1.8569894619950527, "mean_env_wait_ms": 1.1576106575184206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037479400634765625, "StateBufferConnector_ms": 0.01394951343536377, "ViewRequirementAgentConnector_ms": 0.1160573959350586}, "num_episodes": 72, "episode_return_max": 251.5087156112189, "episode_return_min": -876.4864565064184, "episode_return_mean": -193.97672966321724, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 240.48966430959155, "num_env_steps_trained_throughput_per_sec": 240.48966430959155, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 2080000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2080000, "timers": {"training_iteration_time_ms": 33028.161, "restore_workers_time_ms": 0.025, "training_step_time_ms": 33027.02, "sample_time_ms": 1468.334, "learn_time_ms": 31517.262, "learn_throughput": 253.829, "synch_weights_time_ms": 35.16}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "done": false, "training_iteration": 65, "trial_id": "cd905_00000", "date": "2024-08-20_09-59-28", "timestamp": 1724128168, "time_this_iter_s": 33.272737979888916, "time_total_s": 2125.527484178543, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169eab790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2125.527484178543, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 36.77291666666667, "ram_util_percent": 79.92291666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3770406454860691, "cur_kl_coeff": 4.023313522338867e-08, "cur_lr": 0.0001, "total_loss": 9.926620159451923, "policy_loss": -0.0022893563023812713, "vf_loss": 9.928909554557194, "vf_explained_var": 0.0006363774102831644, "kl": 0.006688931636350996, "entropy": 1.3747281564606562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 41265.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5452765991526937, "cur_kl_coeff": 4.365574568510055e-12, "cur_lr": 0.0001, "total_loss": 9.682916719951328, "policy_loss": -0.004048653055603305, "vf_loss": 9.686965339902848, "vf_explained_var": 0.0001382786130148267, "kl": 0.009731722519619426, "entropy": 1.1565377044299292, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 41265.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "env_runners": {"episode_reward_max": 251.5087156112189, "episode_reward_min": -876.4864565064184, "episode_reward_mean": -193.97672966321724, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1759.105880583343, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": -165.11665590472344, "predator_policy": 1763.1482184974034}, "policy_reward_mean": {"prey_policy": -1041.084520789442, "predator_policy": 944.0961559578332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.03356877156679, -484.1834221309974, -844.2348223355509, -362.1253981219516, -582.2314870345778, -259.99952291583827, -876.4864565064184, -291.7702649046111, -161.8467613245183, -838.0904448932391, -854.7979952198997, -368.672996476845, 43.780863174951264, 129.73568806366197, -420.9383988102307, -50.30929501401752, -335.19127246888837, -534.3233623867486, -297.8751820500368, -212.086579103771, -444.59053103468483, -600.6340717916445, 150.43452435734585, -824.8868834242082, -594.1001070552641, -130.24998642339446, -463.9529163722314, -617.2823856247873, -355.9475691439482, -322.8843308892081, -51.7030388342811, -351.0965310014415, -523.2478020867908, -581.694820922608, -375.1226763549471, -121.34522092951559, -387.4787689957311, -275.0531300307842, -481.36695380996696, -549.5013606959293, -585.6158102034233, -76.86822834951055, 104.09042487688772, -409.1531205393266, 155.8282664356533, 29.82178391907586, 104.16922809697454, -262.9263528157115, -463.11908510980516, -4.392806719540219, -229.1259409305266, -9.868810232603664, -32.21385563621151, -124.07834760916002, -285.75733671409637, -227.28676299680046, 160.1474014602298, -466.5236988487322, 29.752452983049935, 52.85521518742048, 58.664196455687815, -67.71484055982543, 63.818664162038154, 140.90458056656425, 185.1139544361943, -103.53449505914314, -7.41605086079732, -207.89706567304754, -499.49646936045906, 220.6772586802481, -230.49996206997432, 161.35718036049727, -31.424633486596775, 14.358251618550781, 95.41106331060801, 96.66489618269776, -386.0295598327814, 21.583232084629632, -424.4740164222682, -205.06934522203468, -100.24917685709546, -23.94256948101853, 80.77873724867112, 79.22851437704821, -386.351729389902, 133.41672483083045, -37.822895472914624, 28.79469894987465, -0.5102898639898541, 125.68442277818214, 135.16493819771205, 251.5087156112189, 101.28896692295866, -186.33922575302003, 154.22894887909567, -630.0926256453968, -295.0083782240557, 177.91690132314025, -8.381562798615732, 102.60056523290064], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1097.6556789212634, -1190.4614351493574, -889.1801364629603, -883.5318675992543, -1059.6513185488093, -1106.2864528711475, -1682.5291735824144, -1416.356936698623, -650.8065668634533, -706.9399117684164, -1212.7480267254832, -1298.3277175879512, -1046.0236403165402, -1068.9887787554078, -1460.8926211942553, -1157.4707622929093, -1245.1996310652248, -1188.5363272693448, -937.7035305742671, -983.7624190285928, -1031.0830708920003, -1003.7345137842291, -1053.8742001226024, -965.7295873767821, -1700.6513035680878, -1759.105880583343, -1035.2191988959498, -1115.919843835507, -488.30803295281595, -484.0127967332299, -1463.124277540261, -1710.1078604365416, -1489.6884767157844, -1413.3589102974938, -771.0115378840692, -667.1461485472652, -338.8250506910337, -373.32451803674496, -939.9417551178092, -1043.7744804258289, -549.3157336561803, -609.6484810272277, -1305.698273015496, -1329.4464484384953, -974.6897916586277, -949.4462245973931, -1445.3019733365727, -1397.2167183208146, -1209.5799965032254, -1636.0676163539526, -165.11665590472344, -211.4484715599547, -901.8583511037742, -859.3141949074434, -818.7656646009617, -774.4522777926635, -1119.9322627381232, -1006.2548011538082, -1139.3968114511595, -1396.4547733732018, -1038.524356996355, -983.3542468731716, -1357.4233808648985, -1371.5809083614581, -1224.2510586536448, -1076.6927305508125, -867.7770518712379, -876.8662856600656, -443.70594238736373, -472.74831748628134, -741.1634778328751, -800.9063518471617, -1422.0640494821478, -1450.988818970897, -711.338073944501, -768.3275445412477, -1139.2663980663895, -1427.9416809116583, -969.735216934306, -1287.649068648585, -888.7106197238137, -843.533248987447, -708.6877047023163, -725.3337274572892, -934.6365025654866, -1130.933798621558, -799.1930799198897, -807.562405673914, -698.9201932003061, -661.1014625159347, -1170.696652360732, -1306.0055278301606, -1562.1489428637447, -1461.0834938375156, -1179.2915361877267, -1093.7183545574276, -1229.87191280581, -1117.6385168270776, -506.0898628141441, -737.8928411720991, -738.0067738950223, -777.5105663644392, -952.0622321312974, -1097.0037007301821, -1218.3384043083597, -1295.0917480262447, -1507.7842028073035, -1646.6784719425439, -1144.8632856846446, -1288.5726013558788, -1182.264181290136, -1093.6977829881507, -654.6812412982193, -672.4338771011429, -1460.0278376099996, -1464.5843075611174, -1070.2045991631971, -881.8538045796955, -515.1549042694323, -506.850883828704, -893.5089228512861, -935.0890650615538, -1076.200925191592, -1264.9835054788884, -551.7326249936705, -540.092834981252, -590.5897689846934, -643.1153121669308, -1016.6664570585993, -948.077996193793, -717.4408294682602, -742.5541827510949, -383.1368389819206, -342.72643056043546, -1295.8362507123006, -1319.3137100884373, -792.4794489022898, -767.3599328614107, -811.0463466957796, -832.9861423558824, -1090.5537837448478, -1089.4997186006217, -1422.3437743704387, -1490.0496299366578, -1402.8949057082104, -1482.4628108711042, -1333.291252835506, -1450.5124804008744, -824.587003811657, -887.7999237942541, -949.124297265788, -918.9362552816124, -1490.7117456110361, -1217.8335453567001, -1239.768440067653, -1133.4476353142004, -1300.9077190451703, -1216.1989031881012, -1261.0855396466254, -1359.5653912241028, -1236.8769599808224, -1235.0382837343113, -657.0645451988667, -634.192196022131, -729.6065407644039, -782.9981719069413, -1129.6955944079184, -1043.4047561452662, -1224.7206492153182, -1382.4032697769558, -998.1740354159463, -869.0628559699214, -1062.977252873129, -921.4472163868777, -1612.1927481963903, -1461.181529286055, -820.1566214875985, -676.1085883056895, -807.888587659495, -738.8262451765224, -926.7953080554024, -1031.6329117128307, -844.4128612692276, -988.0814294030661, -903.3658264866247, -1085.0783932383613, -1054.3890916756652, -1263.6999372619125, -1008.3358378316761, -923.0234468835606, -1269.4450182845885, -1128.9654704406773, -1315.331520766088, -1394.7100540536192, -1330.5526706038838, -1227.7151392401074, -1666.4682610061454, -1433.4952257494122, -1131.5750115051997, -1145.881160442527], "policy_predator_policy_reward": [1106.1433860129941, 1231.0072968291936, 321.2856420518435, 967.2429398793741, 1308.0295939542195, 13.673355130186719, 1608.4357111650374, 1128.3250009940482, 739.6801325175595, 35.834859079732446, 1355.373693320569, 895.7025280770274, 7.153907867927435, 1231.3720546976024, 1562.425992442741, 764.1671261398119, 1040.292439640467, 1231.5967573695843, 27.509224773968903, 1055.866279935652, 1127.2720731154511, 52.74751634087932, 537.8341938460717, 1113.0965971764676, 1763.1482184974034, 1740.3898288289784, 1106.4021364208925, 1174.472594374226, 546.0413727102023, 5.341058165613068, 1403.2483150317344, 1719.6745279310503, 1595.280105422099, 972.5760091222911, 60.19145513693168, 843.6428689076542, 413.4418863303059, 0.8325003474356079, 1054.297173840453, 717.3324825994141, 642.5023145870161, 71.87136906170701, 1448.0099190501214, 586.5007306122245, 1035.6925944022087, 1038.877946211158, 496.1045949746433, 1521.5272132585353, 569.9336131815801, 1681.613892620334, 0.0, 246.31514104128343, 324.5225059868502, 972.6971236521362, 898.054362759656, 77.88119400918251, 516.1829049029878, 1254.0565898449954, 676.887885732473, 1536.0793682026808, 1115.051409478013, 855.1241555572326, 840.758641792348, 1537.149116432566, 1326.8693457680229, 450.8266413496429, 206.93616681296925, 956.0123497957265, 511.7892676215778, 29.54231589712053, 640.1338924335171, 780.5907163170041, 1593.2615062111859, 892.3125932461273, 419.99053857081, 784.6219498841543, 531.5660971974819, 1554.2750279705992, 269.00304610022374, 1438.8798787867372, 137.63876716006428, 1008.9892913477734, 794.2237013198271, 562.9295024902675, 1016.1349876465165, 1153.5257384174163, 869.2690317211435, 328.3333333333333, 743.1611716100781, 772.6887505418158, 1080.0742133113188, 1426.4497507986487, 1633.9545245607032, 1493.447140237531, 1342.8545195325823, 667.229018396861, 1304.2659896324246, 580.1253548906575, 732.0546238868988, 507.5352733798037, 411.8601657537105, 874.5312335752249, 1064.2806282520446, 974.9164943768312, 1044.2480863734122, 1436.9682103249809, 1319.479955948558, 1710.9043711921286, 1501.8670442845962, 645.8115060418311, 802.137032596996, 1246.5381686844912, 718.6971158967156, 768.5654039628762, 766.1137637345904, 1691.974682587795, 897.8269831345659, 1083.9838735913768, 465.363610322107, 609.4973929634493, 935.9032092748685, 951.3589750936592, 1302.1655852300119, 971.3040048806431, 681.1614529648874, 474.48267117207223, 749.0942038643254, 625.5154578538629, 1142.0913188995592, 1007.7670887890274, 574.4534325493905, 782.007084610821, 458.66183467713535, 259.7853840044231, 1395.433664828646, 1011.8192302990437, 175.942185661397, 884.4007267418446, 934.8536477004585, 929.8561000314513, 1243.7990441517566, 705.7544961237389, 1694.0618761193566, 1379.6887085482365, 1690.5297622199182, 1163.4033208728, 1312.9018156714721, 1485.2601691834582, 988.3546261112899, 819.4433648052291, 910.3699832706495, 1054.3554654594482, 842.9981958056258, 1479.517535329328, 1119.4137650153712, 1275.3855424511116, 1464.824282173623, 627.8083236373795, 957.7523177002845, 1457.8292679484084, 1454.13904077115, 917.5270260868879, 487.8953560802061, 779.4188156597733, 731.8851278974128, 861.4983220226031, 1092.0510816206204, 1160.277783309612, 658.0984184794554, 1562.6737711229164, 979.5592986047035, 1021.0943176119944, 1151.4169670100018, 795.1846067770903, 1744.8417235372963, 1357.3272528950235, 629.9335419942233, 865.8213779350747, 823.5910671640894, 848.8081884501099, 975.2260044697452, 1118.3671534962, 937.6437882855342, 1146.3592179979778, 1210.0569737111612, 879.6762129367828, 790.2372677883554, 1341.5125353962017, 970.7843744582542, 1114.8038591360778, 440.6510443496693, 1327.6668187301998, 913.719395363953, 1501.313801231699, 1445.6681487643932, 1290.5165624027372, 1670.634964139242, 1420.9469598176986, 1309.7040331185926, 1070.3527040620347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.856126833416388, "mean_inference_ms": 3.7590937999240235, "mean_action_processing_ms": 1.8569894619950527, "mean_env_wait_ms": 1.1576106575184206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037479400634765625, "StateBufferConnector_ms": 0.01394951343536377, "ViewRequirementAgentConnector_ms": 0.1160573959350586}, "num_episodes": 0, "episode_return_max": 251.5087156112189, "episode_return_min": -876.4864565064184, "episode_return_mean": -193.97672966321724, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 238.52631844286645, "num_env_steps_trained_throughput_per_sec": 238.52631844286645, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 2112000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2112000, "timers": {"training_iteration_time_ms": 33129.02, "restore_workers_time_ms": 0.024, "training_step_time_ms": 33127.881, "sample_time_ms": 1494.12, "learn_time_ms": 31592.622, "learn_throughput": 253.224, "synch_weights_time_ms": 35.118}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "done": false, "training_iteration": 66, "trial_id": "cd905_00000", "date": "2024-08-20_10-00-02", "timestamp": 1724128202, "time_this_iter_s": 33.54509115219116, "time_total_s": 2159.0725753307343, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f75af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2159.0725753307343, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 39.89361702127659, "ram_util_percent": 79.87446808510636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2149331355970057, "cur_kl_coeff": 4.023313522338867e-08, "cur_lr": 0.0001, "total_loss": 9.085200824434795, "policy_loss": -0.0038893358741280814, "vf_loss": 9.089090132334876, "vf_explained_var": 0.0029537708986373174, "kl": 0.009630999222481356, "entropy": 1.426876880062951, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 41895.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7326663118861024, "cur_kl_coeff": 4.365574568510055e-12, "cur_lr": 0.0001, "total_loss": 9.002252127632262, "policy_loss": -0.0009541595624464136, "vf_loss": 9.003206263648138, "vf_explained_var": 1.5311487137325225e-05, "kl": 0.002953701032902967, "entropy": 1.174272694663396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 41895.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000}, "env_runners": {"episode_reward_max": 718.6449163698571, "episode_reward_min": -630.0926256453968, "episode_reward_mean": 113.16502144827915, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1666.4682610061454, "predator_policy": 440.6510443496693}, "policy_reward_max": {"prey_policy": -102.4401412546994, "predator_policy": 1744.8417235372963}, "policy_reward_mean": {"prey_policy": -1035.2519992579794, "predator_policy": 1091.834509982119}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.424633486596775, 14.358251618550781, 95.41106331060801, 96.66489618269776, -386.0295598327814, 21.583232084629632, -424.4740164222682, -205.06934522203468, -100.24917685709546, -23.94256948101853, 80.77873724867112, 79.22851437704821, -386.351729389902, 133.41672483083045, -37.822895472914624, 28.79469894987465, -0.5102898639898541, 125.68442277818214, 135.16493819771205, 251.5087156112189, 101.28896692295866, -186.33922575302003, 154.22894887909567, -630.0926256453968, -295.0083782240557, 177.91690132314025, -8.381562798615732, 102.60056523290064, 141.64632782449638, 110.6943464072168, 125.39568160963059, 393.9688967072254, 105.1958899407932, 223.47964464576066, 128.26586776735272, 104.84791749534301, 80.34888877989904, 241.1264761633229, 212.91032381880558, 78.09177575808485, 109.32000231030166, 421.79091775750356, 211.5922422045583, 718.6449163698571, -1.5991215846124476, 286.09238534824453, 353.33349487594745, 192.38982874062438, -18.43100412114343, 267.66119309332595, 392.32764689742896, 292.84717591762654, 370.508465183937, 300.3534611250363, -164.7867846032269, 122.66083068147375, 324.05133807826337, 338.63578990001804, 205.95018903483438, 438.9948429351102, 216.1988814399662, 210.1676100130628, -23.494571560483564, 251.6551826371732, 333.8082505403476, 253.69181592079357, -243.07588024806844, 318.0707289949626, -102.52876328490692, 78.67818768231854, 177.13176444055787, 379.84410383145, 134.15830511663086, 596.8761861371974, 68.90388272157674, 390.1902716520098, 133.36227760997008, 109.22522361920755, 206.68522735896138, -381.1032673303604, -61.828182837494, 65.40967943916804, 229.71557078249887, 89.53432969999322, -97.82804519589794, -116.78616862402049, 79.3856513705642, -123.38542836178527, 384.9897363258625, 141.95214602090977, 462.59125496363544, 418.48910454830025, 173.68453983117587, 241.27428497327688, 54.82840797140099, 347.18829449866917, 68.35055312575427, 92.64567430235934, -204.0388834900974, -29.35920797019554], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1402.8949057082104, -1482.4628108711042, -1333.291252835506, -1450.5124804008744, -824.587003811657, -887.7999237942541, -949.124297265788, -918.9362552816124, -1490.7117456110361, -1217.8335453567001, -1239.768440067653, -1133.4476353142004, -1300.9077190451703, -1216.1989031881012, -1261.0855396466254, -1359.5653912241028, -1236.8769599808224, -1235.0382837343113, -657.0645451988667, -634.192196022131, -729.6065407644039, -782.9981719069413, -1129.6955944079184, -1043.4047561452662, -1224.7206492153182, -1382.4032697769558, -998.1740354159463, -869.0628559699214, -1062.977252873129, -921.4472163868777, -1612.1927481963903, -1461.181529286055, -820.1566214875985, -676.1085883056895, -807.888587659495, -738.8262451765224, -926.7953080554024, -1031.6329117128307, -844.4128612692276, -988.0814294030661, -903.3658264866247, -1085.0783932383613, -1054.3890916756652, -1263.6999372619125, -1008.3358378316761, -923.0234468835606, -1269.4450182845885, -1128.9654704406773, -1315.331520766088, -1394.7100540536192, -1330.5526706038838, -1227.7151392401074, -1666.4682610061454, -1433.4952257494122, -1131.5750115051997, -1145.881160442527, -1234.8113005405535, -874.3777347843259, -1426.7018004611718, -1243.7447677231455, -1214.555595574742, -950.7529439933617, -795.5445264674363, -993.2279752884393, -750.0607384368983, -695.2287604461925, -754.7094682636935, -647.3608297447529, -1191.402701744225, -854.4753017644852, -1413.5045021944745, -1139.7935338030065, -873.252505427101, -806.2193803507653, -1112.3560500246876, -1017.6948710546912, -705.7870292525074, -680.7836777674537, -902.9343526911049, -1113.8183445496259, -1276.3682477661175, -1228.2931909824656, -816.5209921118209, -489.2829205537616, -788.1805953049618, -652.8574930583252, -1122.7935058363273, -102.4401412546994, -1215.4110091842442, -1064.7915034286607, -1275.7547758911076, -1112.7047490114708, -1025.6749949546659, -1519.1359882160498, -780.23210155737, -1043.0666060047233, -833.499593439186, -881.1304937510972, -757.6455404931506, -1036.5636879025396, -840.6020332773892, -803.7840746682491, -889.5415896312336, -803.7210757507877, -944.2695974271335, -1440.5752535287854, -521.8515444302653, -720.2177283100854, -1209.6577043885766, -862.3321689009492, -893.919522246837, -744.0479411267822, -1152.2236250674102, -1046.3003264004228, -886.1164604286463, -727.684425970858, -1474.305931119979, -1571.6259582588593, -930.4658454654552, -1037.8550919000695, -941.2979047773557, -1092.8991604282928, -1092.2233921259417, -1179.1590601722482, -1099.3058810436467, -1320.204915627048, -970.2515775793606, -1048.1990644211908, -936.0328449961647, -1008.588918692585, -846.3246368054682, -653.5645492588978, -1340.524544992595, -1087.181004533073, -1426.391625793211, -1151.0326129005284, -1067.629424736086, -1104.988421497693, -893.203358327488, -717.7599793253248, -1092.474194382239, -1200.0905899264544, -824.5368335400677, -929.5729535545665, -1483.8800031282178, -1080.717559747677, -1374.1340926214514, -689.0786195909598, -797.1235942279905, -835.5735737853695, -793.2183960856739, -1277.3872266858632, -782.4852366435505, -896.2040916206753, -1352.4567577396497, -1219.4781705261498, -758.7468756405702, -772.9672107686897, -1313.3528889568304, -1268.720623283661, -985.6810418473208, -750.8889859923855, -870.454724165978, -825.1541377676701, -1080.8458510341052, -1384.7722866503734, -1056.4738622661107, -1145.002812061327, -999.0771448936085, -806.0976283324226, -1124.4517485093397, -1134.0720773298349, -876.6906424199321, -842.2566407518625, -1388.597113649106, -1499.425657175239, -1016.0203898618549, -1162.372248106118, -886.9197516955845, -1318.0675998429351, -1188.085194897919, -916.3403763337557, -578.3543385401439, -836.33705541339, -1210.1821480783724, -552.6833027310848, -728.0514797111096, -1075.3966459856538, -1565.5754235808845, -1089.6761609079283, -620.2384521315113, -698.9690128278378, -1085.2155179524455, -701.3187122535055, -1416.024174672497, -1436.519390641211, -933.4737303004149, -940.7879596699516, -1144.617698373152, -977.624567155415], "policy_predator_policy_reward": [1690.5297622199182, 1163.4033208728, 1312.9018156714721, 1485.2601691834582, 988.3546261112899, 819.4433648052291, 910.3699832706495, 1054.3554654594482, 842.9981958056258, 1479.517535329328, 1119.4137650153712, 1275.3855424511116, 1464.824282173623, 627.8083236373795, 957.7523177002845, 1457.8292679484084, 1454.13904077115, 917.5270260868879, 487.8953560802061, 779.4188156597733, 731.8851278974128, 861.4983220226031, 1092.0510816206204, 1160.277783309612, 658.0984184794554, 1562.6737711229164, 979.5592986047035, 1021.0943176119944, 1151.4169670100018, 795.1846067770903, 1744.8417235372963, 1357.3272528950235, 629.9335419942233, 865.8213779350747, 823.5910671640894, 848.8081884501099, 975.2260044697452, 1118.3671534962, 937.6437882855342, 1146.3592179979778, 1210.0569737111612, 879.6762129367828, 790.2372677883554, 1341.5125353962017, 970.7843744582542, 1114.8038591360778, 440.6510443496693, 1327.6668187301998, 913.719395363953, 1501.313801231699, 1445.6681487643932, 1290.5165624027372, 1670.634964139242, 1420.9469598176986, 1309.7040331185926, 1070.3527040620347, 1293.752090447346, 957.0832727020293, 1317.4406007867474, 1463.7003138047874, 1294.2575501121223, 996.4466710656118, 1141.8660652844385, 1040.875333178662, 820.5651078142309, 729.9202810096526, 832.0363710960659, 793.513571558141, 850.4432706249003, 1323.7006006511629, 1506.9413487389522, 1151.2046047538713, 793.6883183881178, 966.1324561696473, 1034.8417944602684, 1336.335602782433, 816.8694772189166, 782.6115536198499, 819.1133200467656, 1275.7311529520503, 1292.7390689340066, 1321.2423721248779, 842.4797332398686, 885.1150971832169, 881.7157701000111, 770.9145604678337, 1103.9566508423995, 839.9219126184831, 1471.5481945448898, 807.0551964834018, 1211.7806943355072, 1462.771215915315, 1314.509347077309, 1583.6351309693541, 870.3323297663209, 1145.3562065363967, 611.8645832069949, 1084.3344998621446, 1013.5998128314154, 1048.2706086576009, 1160.8761184339705, 875.8376364090966, 926.4466183079564, 1059.6632229916913, 1448.0588920163768, 1307.2944241234777, 771.6205958576071, 770.8021380077809, 1216.186650147786, 691.0164385385133, 1028.1316675291755, 732.4966265259173, 1380.4747906937087, 1142.1004988523866, 1012.7383721948835, 939.6983041046385, 1562.9864415903114, 1688.8956368233607, 1192.2314715217594, 1215.0843087788753, 1154.234210977139, 1096.1617356684749, 1315.6640175813181, 1165.8860447299346, 956.0956831136388, 1439.9205419965726, 1308.2068241694362, 961.8990004682884, 1076.4774776257675, 1201.9525366033304, 1060.5091143625082, 693.0718876226532, 1575.1043249022464, 609.5253443753544, 1517.535403738456, 1377.959563950246, 1251.1941452038436, 818.8949377450285, 845.2738319594479, 844.3676933756835, 1057.3874136739873, 1412.3091350752627, 1070.0582721166465, 1063.8956188094376, 1579.3685680149158, 1119.3872999776102, 1468.4152289157403, 1191.6736694338679, 909.3065584892204, 792.2944922457161, 1208.4287509578471, 1252.3671434656999, 634.9932195203883, 1177.058386353808, 1493.033961917395, 1188.1261899676117, 832.8463548916603, 905.5529588765605, 1523.8791241363347, 677.0911207737946, 1121.7297884353493, 553.0120565668627, 742.4771464351669, 1018.5413949376491, 1140.202897688601, 1555.130810778376, 1361.0488244970802, 929.9621795303502, 1126.1915976291339, 581.1551304009989, 1500.4905916503783, 641.2470655647766, 727.8407000094084, 1070.49223453295, 1163.4250123194274, 1601.2123301431336, 1224.5299481454222, 1338.8524261484135, 912.9840785681932, 1433.955418991236, 1296.7231806327059, 1270.2936455626048, 866.189721590025, 966.9907769118088, 1298.8472820024742, 637.7027086381588, 1176.76989487556, 867.9525157944795, 1151.3498892494144, 1558.7301032107991, 868.9355990674168, 797.460160390601, 1209.0225299262881, 645.8622534054166, 1631.7728448457162, 1313.4163947703512, 1130.6532533807863, 539.5695530994828, 1288.0671386637152, 804.8159188946565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.861638524822964, "mean_inference_ms": 3.760708584431544, "mean_action_processing_ms": 1.8531829352095701, "mean_env_wait_ms": 1.1608685127362406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004464626312255859, "StateBufferConnector_ms": 0.01845717430114746, "ViewRequirementAgentConnector_ms": 0.12327468395233154}, "num_episodes": 72, "episode_return_max": 718.6449163698571, "episode_return_min": -630.0926256453968, "episode_return_mean": 113.16502144827915, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 238.05799169559074, "num_env_steps_trained_throughput_per_sec": 238.05799169559074, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 2144000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2144000, "timers": {"training_iteration_time_ms": 33253.392, "restore_workers_time_ms": 0.029, "training_step_time_ms": 33252.266, "sample_time_ms": 1491.918, "learn_time_ms": 31720.369, "learn_throughput": 252.204, "synch_weights_time_ms": 34.44}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000}, "done": false, "training_iteration": 67, "trial_id": "cd905_00000", "date": "2024-08-20_10-00-36", "timestamp": 1724128236, "time_this_iter_s": 33.63670611381531, "time_total_s": 2192.7092814445496, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f6b1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2192.7092814445496, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 40.608333333333334, "ram_util_percent": 80.22083333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2044712757780438, "cur_kl_coeff": 4.023313522338867e-08, "cur_lr": 0.0001, "total_loss": 7.738464472785829, "policy_loss": -0.009691046284777778, "vf_loss": 7.748155512128558, "vf_explained_var": 0.00019174388476780483, "kl": 0.013037385503791903, "entropy": 1.4382318046357896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5018290419427175, "cur_kl_coeff": 2.1827872842550277e-12, "cur_lr": 0.0001, "total_loss": 9.248025556594607, "policy_loss": -0.00238596902428461, "vf_loss": 9.250411531660292, "vf_explained_var": 1.494212756081233e-05, "kl": 0.010947674254074382, "entropy": 1.1721897632356675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000}, "env_runners": {"episode_reward_max": 1071.4403791457817, "episode_reward_min": -630.0926256453968, "episode_reward_mean": 161.36431013676224, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1666.4682610061454, "predator_policy": 394.3384717524085}, "policy_reward_max": {"prey_policy": -102.4401412546994, "predator_policy": 1744.8417235372963}, "policy_reward_mean": {"prey_policy": -1003.1143213542186, "predator_policy": 1083.7964764225997}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.24917685709546, -23.94256948101853, 80.77873724867112, 79.22851437704821, -386.351729389902, 133.41672483083045, -37.822895472914624, 28.79469894987465, -0.5102898639898541, 125.68442277818214, 135.16493819771205, 251.5087156112189, 101.28896692295866, -186.33922575302003, 154.22894887909567, -630.0926256453968, -295.0083782240557, 177.91690132314025, -8.381562798615732, 102.60056523290064, 141.64632782449638, 110.6943464072168, 125.39568160963059, 393.9688967072254, 105.1958899407932, 223.47964464576066, 128.26586776735272, 104.84791749534301, 80.34888877989904, 241.1264761633229, 212.91032381880558, 78.09177575808485, 109.32000231030166, 421.79091775750356, 211.5922422045583, 718.6449163698571, -1.5991215846124476, 286.09238534824453, 353.33349487594745, 192.38982874062438, -18.43100412114343, 267.66119309332595, 392.32764689742896, 292.84717591762654, 370.508465183937, 300.3534611250363, -164.7867846032269, 122.66083068147375, 324.05133807826337, 338.63578990001804, 205.95018903483438, 438.9948429351102, 216.1988814399662, 210.1676100130628, -23.494571560483564, 251.6551826371732, 333.8082505403476, 253.69181592079357, -243.07588024806844, 318.0707289949626, -102.52876328490692, 78.67818768231854, 177.13176444055787, 379.84410383145, 134.15830511663086, 596.8761861371974, 68.90388272157674, 390.1902716520098, 133.36227760997008, 109.22522361920755, 206.68522735896138, -381.1032673303604, -61.828182837494, 65.40967943916804, 229.71557078249887, 89.53432969999322, -97.82804519589794, -116.78616862402049, 79.3856513705642, -123.38542836178527, 384.9897363258625, 141.95214602090977, 462.59125496363544, 418.48910454830025, 173.68453983117587, 241.27428497327688, 54.82840797140099, 347.18829449866917, 68.35055312575427, 92.64567430235934, -204.0388834900974, -29.35920797019554, 589.3258282613677, 546.1151901006148, 27.567726842936526, 475.8881513943963, 536.2136744173175, 351.037806736846, 1071.4403791457817, 403.36000018185496], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1236.8769599808224, -1235.0382837343113, -657.0645451988667, -634.192196022131, -729.6065407644039, -782.9981719069413, -1129.6955944079184, -1043.4047561452662, -1224.7206492153182, -1382.4032697769558, -998.1740354159463, -869.0628559699214, -1062.977252873129, -921.4472163868777, -1612.1927481963903, -1461.181529286055, -820.1566214875985, -676.1085883056895, -807.888587659495, -738.8262451765224, -926.7953080554024, -1031.6329117128307, -844.4128612692276, -988.0814294030661, -903.3658264866247, -1085.0783932383613, -1054.3890916756652, -1263.6999372619125, -1008.3358378316761, -923.0234468835606, -1269.4450182845885, -1128.9654704406773, -1315.331520766088, -1394.7100540536192, -1330.5526706038838, -1227.7151392401074, -1666.4682610061454, -1433.4952257494122, -1131.5750115051997, -1145.881160442527, -1234.8113005405535, -874.3777347843259, -1426.7018004611718, -1243.7447677231455, -1214.555595574742, -950.7529439933617, -795.5445264674363, -993.2279752884393, -750.0607384368983, -695.2287604461925, -754.7094682636935, -647.3608297447529, -1191.402701744225, -854.4753017644852, -1413.5045021944745, -1139.7935338030065, -873.252505427101, -806.2193803507653, -1112.3560500246876, -1017.6948710546912, -705.7870292525074, -680.7836777674537, -902.9343526911049, -1113.8183445496259, -1276.3682477661175, -1228.2931909824656, -816.5209921118209, -489.2829205537616, -788.1805953049618, -652.8574930583252, -1122.7935058363273, -102.4401412546994, -1215.4110091842442, -1064.7915034286607, -1275.7547758911076, -1112.7047490114708, -1025.6749949546659, -1519.1359882160498, -780.23210155737, -1043.0666060047233, -833.499593439186, -881.1304937510972, -757.6455404931506, -1036.5636879025396, -840.6020332773892, -803.7840746682491, -889.5415896312336, -803.7210757507877, -944.2695974271335, -1440.5752535287854, -521.8515444302653, -720.2177283100854, -1209.6577043885766, -862.3321689009492, -893.919522246837, -744.0479411267822, -1152.2236250674102, -1046.3003264004228, -886.1164604286463, -727.684425970858, -1474.305931119979, -1571.6259582588593, -930.4658454654552, -1037.8550919000695, -941.2979047773557, -1092.8991604282928, -1092.2233921259417, -1179.1590601722482, -1099.3058810436467, -1320.204915627048, -970.2515775793606, -1048.1990644211908, -936.0328449961647, -1008.588918692585, -846.3246368054682, -653.5645492588978, -1340.524544992595, -1087.181004533073, -1426.391625793211, -1151.0326129005284, -1067.629424736086, -1104.988421497693, -893.203358327488, -717.7599793253248, -1092.474194382239, -1200.0905899264544, -824.5368335400677, -929.5729535545665, -1483.8800031282178, -1080.717559747677, -1374.1340926214514, -689.0786195909598, -797.1235942279905, -835.5735737853695, -793.2183960856739, -1277.3872266858632, -782.4852366435505, -896.2040916206753, -1352.4567577396497, -1219.4781705261498, -758.7468756405702, -772.9672107686897, -1313.3528889568304, -1268.720623283661, -985.6810418473208, -750.8889859923855, -870.454724165978, -825.1541377676701, -1080.8458510341052, -1384.7722866503734, -1056.4738622661107, -1145.002812061327, -999.0771448936085, -806.0976283324226, -1124.4517485093397, -1134.0720773298349, -876.6906424199321, -842.2566407518625, -1388.597113649106, -1499.425657175239, -1016.0203898618549, -1162.372248106118, -886.9197516955845, -1318.0675998429351, -1188.085194897919, -916.3403763337557, -578.3543385401439, -836.33705541339, -1210.1821480783724, -552.6833027310848, -728.0514797111096, -1075.3966459856538, -1565.5754235808845, -1089.6761609079283, -620.2384521315113, -698.9690128278378, -1085.2155179524455, -701.3187122535055, -1416.024174672497, -1436.519390641211, -933.4737303004149, -940.7879596699516, -1144.617698373152, -977.624567155415, -505.7896685133869, -1231.8378670110471, -533.2379543443025, -1129.8279456209386, -427.93860774086875, -507.18726805505963, -232.8420060504153, -1011.1139970109931, -961.8946847541847, -1172.1099729488988, -765.4346162674645, -1008.0941589392904, -1204.132176451405, -529.6137492947358, -958.1300121746577, -862.4075834927875], "policy_predator_policy_reward": [1454.13904077115, 917.5270260868879, 487.8953560802061, 779.4188156597733, 731.8851278974128, 861.4983220226031, 1092.0510816206204, 1160.277783309612, 658.0984184794554, 1562.6737711229164, 979.5592986047035, 1021.0943176119944, 1151.4169670100018, 795.1846067770903, 1744.8417235372963, 1357.3272528950235, 629.9335419942233, 865.8213779350747, 823.5910671640894, 848.8081884501099, 975.2260044697452, 1118.3671534962, 937.6437882855342, 1146.3592179979778, 1210.0569737111612, 879.6762129367828, 790.2372677883554, 1341.5125353962017, 970.7843744582542, 1114.8038591360778, 440.6510443496693, 1327.6668187301998, 913.719395363953, 1501.313801231699, 1445.6681487643932, 1290.5165624027372, 1670.634964139242, 1420.9469598176986, 1309.7040331185926, 1070.3527040620347, 1293.752090447346, 957.0832727020293, 1317.4406007867474, 1463.7003138047874, 1294.2575501121223, 996.4466710656118, 1141.8660652844385, 1040.875333178662, 820.5651078142309, 729.9202810096526, 832.0363710960659, 793.513571558141, 850.4432706249003, 1323.7006006511629, 1506.9413487389522, 1151.2046047538713, 793.6883183881178, 966.1324561696473, 1034.8417944602684, 1336.335602782433, 816.8694772189166, 782.6115536198499, 819.1133200467656, 1275.7311529520503, 1292.7390689340066, 1321.2423721248779, 842.4797332398686, 885.1150971832169, 881.7157701000111, 770.9145604678337, 1103.9566508423995, 839.9219126184831, 1471.5481945448898, 807.0551964834018, 1211.7806943355072, 1462.771215915315, 1314.509347077309, 1583.6351309693541, 870.3323297663209, 1145.3562065363967, 611.8645832069949, 1084.3344998621446, 1013.5998128314154, 1048.2706086576009, 1160.8761184339705, 875.8376364090966, 926.4466183079564, 1059.6632229916913, 1448.0588920163768, 1307.2944241234777, 771.6205958576071, 770.8021380077809, 1216.186650147786, 691.0164385385133, 1028.1316675291755, 732.4966265259173, 1380.4747906937087, 1142.1004988523866, 1012.7383721948835, 939.6983041046385, 1562.9864415903114, 1688.8956368233607, 1192.2314715217594, 1215.0843087788753, 1154.234210977139, 1096.1617356684749, 1315.6640175813181, 1165.8860447299346, 956.0956831136388, 1439.9205419965726, 1308.2068241694362, 961.8990004682884, 1076.4774776257675, 1201.9525366033304, 1060.5091143625082, 693.0718876226532, 1575.1043249022464, 609.5253443753544, 1517.535403738456, 1377.959563950246, 1251.1941452038436, 818.8949377450285, 845.2738319594479, 844.3676933756835, 1057.3874136739873, 1412.3091350752627, 1070.0582721166465, 1063.8956188094376, 1579.3685680149158, 1119.3872999776102, 1468.4152289157403, 1191.6736694338679, 909.3065584892204, 792.2944922457161, 1208.4287509578471, 1252.3671434656999, 634.9932195203883, 1177.058386353808, 1493.033961917395, 1188.1261899676117, 832.8463548916603, 905.5529588765605, 1523.8791241363347, 677.0911207737946, 1121.7297884353493, 553.0120565668627, 742.4771464351669, 1018.5413949376491, 1140.202897688601, 1555.130810778376, 1361.0488244970802, 929.9621795303502, 1126.1915976291339, 581.1551304009989, 1500.4905916503783, 641.2470655647766, 727.8407000094084, 1070.49223453295, 1163.4250123194274, 1601.2123301431336, 1224.5299481454222, 1338.8524261484135, 912.9840785681932, 1433.955418991236, 1296.7231806327059, 1270.2936455626048, 866.189721590025, 966.9907769118088, 1298.8472820024742, 637.7027086381588, 1176.76989487556, 867.9525157944795, 1151.3498892494144, 1558.7301032107991, 868.9355990674168, 797.460160390601, 1209.0225299262881, 645.8622534054166, 1631.7728448457162, 1313.4163947703512, 1130.6532533807863, 539.5695530994828, 1288.0671386637152, 804.8159188946565, 1045.4325623869058, 1281.5208013988956, 986.5021361178422, 1222.6789539480133, 568.3551308864568, 394.3384717524085, 687.1383114001926, 1032.7058430556124, 1347.909615262602, 1322.3087168577983, 882.5249835088525, 1242.0415984347471, 1549.2891918213531, 1255.897113070569, 1039.5541404750657, 1184.343455374234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.854712598138917, "mean_inference_ms": 3.764465771059173, "mean_action_processing_ms": 1.8466347908550313, "mean_env_wait_ms": 1.1608643001352055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004560232162475586, "StateBufferConnector_ms": 0.018429279327392578, "ViewRequirementAgentConnector_ms": 0.12425923347473145}, "num_episodes": 8, "episode_return_max": 1071.4403791457817, "episode_return_min": -630.0926256453968, "episode_return_mean": 161.36431013676224, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 240.73860643915896, "num_env_steps_trained_throughput_per_sec": 240.73860643915896, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 2176000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2176000, "timers": {"training_iteration_time_ms": 33388.53, "restore_workers_time_ms": 0.027, "training_step_time_ms": 33387.505, "sample_time_ms": 1514.48, "learn_time_ms": 31834.386, "learn_throughput": 251.301, "synch_weights_time_ms": 33.489}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000}, "done": false, "training_iteration": 68, "trial_id": "cd905_00000", "date": "2024-08-20_10-01-09", "timestamp": 1724128269, "time_this_iter_s": 33.23858976364136, "time_total_s": 2225.947871208191, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afec280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2225.947871208191, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 37.09787234042553, "ram_util_percent": 80.09361702127659}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7715023956128528, "cur_kl_coeff": 4.023313522338867e-08, "cur_lr": 0.0001, "total_loss": 5.65864411157275, "policy_loss": -0.010691359964206755, "vf_loss": 5.66933546898857, "vf_explained_var": 0.005215087201860216, "kl": 0.015174924347252632, "entropy": 1.4659088473471384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 43155.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7543026890191767, "cur_kl_coeff": 2.1827872842550277e-12, "cur_lr": 0.0001, "total_loss": 6.383026341029576, "policy_loss": -0.00046603378603264455, "vf_loss": 6.383492371392628, "vf_explained_var": 0.00010466074186658103, "kl": 0.002897517714124002, "entropy": 1.1458106756210327, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 43155.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "env_runners": {"episode_reward_max": 1071.4403791457817, "episode_reward_min": -381.1032673303604, "episode_reward_mean": 354.3121208348437, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1565.5754235808845, "predator_policy": 1.0395125309509181}, "policy_reward_max": {"prey_policy": 35.960487469049326, "predator_policy": 1631.7728448457162}, "policy_reward_mean": {"prey_policy": -659.2611349531974, "predator_policy": 836.417195370619}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.15830511663086, 596.8761861371974, 68.90388272157674, 390.1902716520098, 133.36227760997008, 109.22522361920755, 206.68522735896138, -381.1032673303604, -61.828182837494, 65.40967943916804, 229.71557078249887, 89.53432969999322, -97.82804519589794, -116.78616862402049, 79.3856513705642, -123.38542836178527, 384.9897363258625, 141.95214602090977, 462.59125496363544, 418.48910454830025, 173.68453983117587, 241.27428497327688, 54.82840797140099, 347.18829449866917, 68.35055312575427, 92.64567430235934, -204.0388834900974, -29.35920797019554, 589.3258282613677, 546.1151901006148, 27.567726842936526, 475.8881513943963, 536.2136744173175, 351.037806736846, 1071.4403791457817, 403.36000018185496, 500.96629370561294, 312.1737600608012, 323.98571781390086, 291.0198496868536, 610.6241714588837, 523.9545239169025, 522.6017275090037, 596.2362624153471, 622.0526955108191, 518.9598528787665, 99.09879517567758, 54.56890309889969, 335.70436191711593, 369.7412458744112, 707.809708666188, 341.678228829917, 766.1486970998681, 397.0013525822376, 688.4681592169729, 535.0771156633539, 295.9656047455777, 297.8063676541287, 719.9411634468727, 813.1431985085824, 561.6553188199065, 406.0256626745407, 41.51661997028216, 256.8460008760076, 396.0805620491932, 533.0578752359813, 396.8216818450071, 743.0395851256043, 546.5426790132858, 550.8956310829436, 473.9570314926616, 406.0743579657889, 430.83582583149644, 790.0738383501497, 452.1047900179012, 413.2779940819257, 572.9903831880333, 425.2400951154543, 681.1793250378794, 277.84952068229717, 344.3264711700746, 732.5036842436513, 242.036736430671, 377.1930975293252, 480.05481511256716, 392.3771998712601, 439.5360350081085, 57.01418222581148, 545.4945207018119, 74.80377815935778, 76.1995757735145, 360.5934421211008, 141.05821384410265, 351.7020154407111, 750.6885678488834, 669.2502112623988, 410.33245637963796, 482.86917990861025, 62.300000000000495, 364.02518921934853], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1483.8800031282178, -1080.717559747677, -1374.1340926214514, -689.0786195909598, -797.1235942279905, -835.5735737853695, -793.2183960856739, -1277.3872266858632, -782.4852366435505, -896.2040916206753, -1352.4567577396497, -1219.4781705261498, -758.7468756405702, -772.9672107686897, -1313.3528889568304, -1268.720623283661, -985.6810418473208, -750.8889859923855, -870.454724165978, -825.1541377676701, -1080.8458510341052, -1384.7722866503734, -1056.4738622661107, -1145.002812061327, -999.0771448936085, -806.0976283324226, -1124.4517485093397, -1134.0720773298349, -876.6906424199321, -842.2566407518625, -1388.597113649106, -1499.425657175239, -1016.0203898618549, -1162.372248106118, -886.9197516955845, -1318.0675998429351, -1188.085194897919, -916.3403763337557, -578.3543385401439, -836.33705541339, -1210.1821480783724, -552.6833027310848, -728.0514797111096, -1075.3966459856538, -1565.5754235808845, -1089.6761609079283, -620.2384521315113, -698.9690128278378, -1085.2155179524455, -701.3187122535055, -1416.024174672497, -1436.519390641211, -933.4737303004149, -940.7879596699516, -1144.617698373152, -977.624567155415, -505.7896685133869, -1231.8378670110471, -533.2379543443025, -1129.8279456209386, -427.93860774086875, -507.18726805505963, -232.8420060504153, -1011.1139970109931, -961.8946847541847, -1172.1099729488988, -765.4346162674645, -1008.0941589392904, -1204.132176451405, -529.6137492947358, -958.1300121746577, -862.4075834927875, -34.05510059508967, -752.972370809941, -326.57381672821583, 27.908512424231883, -391.90707554711656, -208.33510999477906, -611.9336804454362, -909.4732689345611, -460.23427925295306, -568.3869271936866, -113.51068871170823, -832.7165537219091, -95.57946829597374, -929.5111831292913, -214.98213787937945, -687.2035670714217, -37.64736363719217, -1059.7339508392326, -970.8088563643685, -22.973666065956714, -338.55544432216726, -11.839860310733329, -43.80361676863968, 18.25186047611325, 12.837863307973853, -324.58793751664956, -173.95233217649292, -744.5238865356386, -631.4900903598315, -1259.7959307754072, -798.6735323842232, 18.401065874222038, 25.7416261541306, -876.1283364134948, -15.87033769090824, -578.1588457231566, -382.3606154541762, -1004.862579383947, -565.6891721416509, 20.9177097102301, -307.62951988242037, -740.1030361958606, -844.228899183753, -822.9837104045308, -573.9161097513651, -904.1050962834497, -1269.3162983515929, -389.56309963554133, -11.247514189451778, -549.4964790391257, -630.7903843548029, -400.0304174471088, 16.53174003053774, -77.88754889781876, -43.10888162054859, -513.2030102924322, -367.9847823840822, -476.6283373979274, -952.6012223925252, -776.6415038759869, -437.1022150503371, 23.18330451510975, -303.80923390089487, -936.6281045699084, -719.6353757452255, -918.9204181055464, -1253.2677778985824, -746.8086747626018, -623.7332867470154, -18.538837503962668, -1153.2515356576653, -776.2693298384497, -455.8584071602221, 25.32361932889339, -983.0370704550361, -416.74585454485396, -525.6643698715031, -65.57976425890831, -784.1520193453249, -1186.346589771376, -538.5556281942573, -860.1916096383327, -765.5665507082615, -927.3076484072325, -1039.8420045419298, -101.40863776238264, -474.7269297730387, -547.9888379813543, -723.2048275733167, -704.3943104999072, -487.0695457715521, -1052.8078373910573, -113.15890152032173, -470.9849982083886, 12.686587768301663, -455.876636915771, -676.5557619550508, -33.14413440797519, -424.15896759187376, -37.49994654633501, -906.7335517379399, -310.2821898942076, -12.955970743904386, 18.17131128821829, 26.300000000000114, -806.3859693950831, -234.91127973727487, -96.47738858715722, 30.155670317060682, 21.451715254067985, -1018.0419458239497, -1118.0957232150504, -57.12269893206086, -114.33789458021302, -334.8860209749812, -295.9709219250495, 20.000000000000014, -853.2648525856619, -828.1448137173711, -0.4070515398783836, -357.34343534683444, -813.3660621374117, -978.7213805835933, -809.408831072441, 24.18126667939802, 35.960487469049326, -508.9265664525798, -818.4458906882487], "policy_predator_policy_reward": [1579.3685680149158, 1119.3872999776102, 1468.4152289157403, 1191.6736694338679, 909.3065584892204, 792.2944922457161, 1208.4287509578471, 1252.3671434656999, 634.9932195203883, 1177.058386353808, 1493.033961917395, 1188.1261899676117, 832.8463548916603, 905.5529588765605, 1523.8791241363347, 677.0911207737946, 1121.7297884353493, 553.0120565668627, 742.4771464351669, 1018.5413949376491, 1140.202897688601, 1555.130810778376, 1361.0488244970802, 929.9621795303502, 1126.1915976291339, 581.1551304009989, 1500.4905916503783, 641.2470655647766, 727.8407000094084, 1070.49223453295, 1163.4250123194274, 1601.2123301431336, 1224.5299481454222, 1338.8524261484135, 912.9840785681932, 1433.955418991236, 1296.7231806327059, 1270.2936455626048, 866.189721590025, 966.9907769118088, 1298.8472820024742, 637.7027086381588, 1176.76989487556, 867.9525157944795, 1151.3498892494144, 1558.7301032107991, 868.9355990674168, 797.460160390601, 1209.0225299262881, 645.8622534054166, 1631.7728448457162, 1313.4163947703512, 1130.6532533807863, 539.5695530994828, 1288.0671386637152, 804.8159188946565, 1045.4325623869058, 1281.5208013988956, 986.5021361178422, 1222.6789539480133, 568.3551308864568, 394.3384717524085, 687.1383114001926, 1032.7058430556124, 1347.909615262602, 1322.3087168577983, 882.5249835088525, 1242.0415984347471, 1549.2891918213531, 1255.897113070569, 1039.5541404750657, 1184.343455374234, 678.5248426863845, 609.4689224242588, 318.8975333367106, 291.94153102807394, 480.6081123774559, 443.61979097834126, 901.4252697800094, 911.0015292868414, 806.7172058468595, 832.5281720586636, 667.0875320182663, 803.0942343322528, 628.462777352133, 919.2296015821329, 735.8240273596272, 762.5979400065195, 697.3085139876334, 1022.1254959996095, 960.042189366565, 552.7001859425256, 328.08402323631816, 121.41007657226412, 64.25650982731443, 15.864149564111463, 335.2546582331538, 312.1997778926379, 465.4399182798944, 822.7775463066486, 1253.457277649848, 1345.6384521515786, 796.3003419168471, 325.6503534230708, 746.2040990005275, 870.3313083587032, 400.7339851638138, 590.2965508324872, 1030.8989400205055, 1044.7924140345913, 534.7495547068165, 545.0990233879568, 679.9891320980093, 663.7090287258507, 1053.0656793498308, 911.9532978925823, 1095.0289835889123, 1102.9333858927753, 1300.245362713066, 1171.7772337826493, 614.382506914056, 508.0168051344266, 684.4631616168137, 752.3833028596384, 62.69922205461532, 40.173206782946636, 509.69510979853266, 303.4627829904562, 682.0177295121199, 558.6759523190836, 1232.5575613785413, 1029.7430401259523, 377.66576703772137, 433.07482534251164, 902.2721733129184, 1081.2047502834896, 1038.914201879154, 1146.1842709849034, 1381.7087468761222, 1169.2633368680047, 504.0977724325444, 612.1313833110943, 1152.1619652646086, 1183.433258197295, 427.4493337989357, 433.92127986388766, 1126.4119006241344, 1063.444862725905, 488.8440997918162, 554.5048243564953, 1099.989913980382, 1283.7866892182437, 1040.3207713091006, 931.4168497115222, 1010.01151201448, 1108.1027822164672, 940.2684772750348, 882.1614900671539, 801.1854812273248, 499.3798072093658, 829.8734028640869, 942.0522063792116, 1187.629523801119, 1084.751543605142, 371.74797596041327, 454.4326601989681, 452.2461287036875, 368.13701797310597, 681.5242755926683, 508.23043588292336, 405.23532984622557, 448.80078416324267, 981.378738122581, 675.1730385176734, 16.4618409644732, 35.33700071702396, 655.0307810869264, 670.5497090099666, 209.48603103980548, 196.70641544398308, 10.522081959935932, 14.070108242450583, 1375.8544025284575, 1120.8767086316445, 189.92046259233547, 122.59834476404068, 595.0700589988994, 387.48889934184353, 728.6885678488815, 855.2648525856617, 695.8568758988973, 801.945200620749, 638.026021280523, 943.0159325833608, 1212.0419866796215, 1058.9574048850243, 1.1187333206020553, 1.0395125309509181, 799.7703922037133, 891.6272541564649]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.870996428512894, "mean_inference_ms": 3.7686648897999424, "mean_action_processing_ms": 1.8514556673435212, "mean_env_wait_ms": 1.1662402515384265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005938291549682617, "StateBufferConnector_ms": 0.01501321792602539, "ViewRequirementAgentConnector_ms": 0.153070330619812}, "num_episodes": 64, "episode_return_max": 1071.4403791457817, "episode_return_min": -381.1032673303604, "episode_return_mean": 354.3121208348437, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 237.17637785073708, "num_env_steps_trained_throughput_per_sec": 237.17637785073708, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 2208000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2208000, "timers": {"training_iteration_time_ms": 33519.658, "restore_workers_time_ms": 0.027, "training_step_time_ms": 33518.641, "sample_time_ms": 1536.831, "learn_time_ms": 31943.434, "learn_throughput": 250.443, "synch_weights_time_ms": 33.423}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "done": false, "training_iteration": 69, "trial_id": "cd905_00000", "date": "2024-08-20_10-01-43", "timestamp": 1724128303, "time_this_iter_s": 33.775288105010986, "time_total_s": 2259.723159313202, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afbdf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2259.723159313202, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 40.89791666666667, "ram_util_percent": 80.10416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5621352103494464, "cur_kl_coeff": 4.023313522338867e-08, "cur_lr": 0.0001, "total_loss": 1.0908398763527947, "policy_loss": -0.005595253553012356, "vf_loss": 1.0964351252904014, "vf_explained_var": -0.0022031292082771423, "kl": 0.010249089668275067, "entropy": 1.4762640394861737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 43785.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7075041598743863, "cur_kl_coeff": 1.0913936421275138e-12, "cur_lr": 0.0001, "total_loss": 1.5706334795270647, "policy_loss": -0.002732390899299866, "vf_loss": 1.5733658722468784, "vf_explained_var": 4.4777658250596786e-05, "kl": 0.022324736654968185, "entropy": 1.1465725162672618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 43785.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "env_runners": {"episode_reward_max": 1071.4403791457817, "episode_reward_min": -204.0388834900974, "episode_reward_mean": 353.99657983494785, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1565.5754235808845, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 42.37777995443587, "predator_policy": 1631.7728448457162}, "policy_reward_mean": {"prey_policy": -585.5534168297195, "predator_policy": 762.5517067471933}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-61.828182837494, 65.40967943916804, 229.71557078249887, 89.53432969999322, -97.82804519589794, -116.78616862402049, 79.3856513705642, -123.38542836178527, 384.9897363258625, 141.95214602090977, 462.59125496363544, 418.48910454830025, 173.68453983117587, 241.27428497327688, 54.82840797140099, 347.18829449866917, 68.35055312575427, 92.64567430235934, -204.0388834900974, -29.35920797019554, 589.3258282613677, 546.1151901006148, 27.567726842936526, 475.8881513943963, 536.2136744173175, 351.037806736846, 1071.4403791457817, 403.36000018185496, 500.96629370561294, 312.1737600608012, 323.98571781390086, 291.0198496868536, 610.6241714588837, 523.9545239169025, 522.6017275090037, 596.2362624153471, 622.0526955108191, 518.9598528787665, 99.09879517567758, 54.56890309889969, 335.70436191711593, 369.7412458744112, 707.809708666188, 341.678228829917, 766.1486970998681, 397.0013525822376, 688.4681592169729, 535.0771156633539, 295.9656047455777, 297.8063676541287, 719.9411634468727, 813.1431985085824, 561.6553188199065, 406.0256626745407, 41.51661997028216, 256.8460008760076, 396.0805620491932, 533.0578752359813, 396.8216818450071, 743.0395851256043, 546.5426790132858, 550.8956310829436, 473.9570314926616, 406.0743579657889, 430.83582583149644, 790.0738383501497, 452.1047900179012, 413.2779940819257, 572.9903831880333, 425.2400951154543, 681.1793250378794, 277.84952068229717, 344.3264711700746, 732.5036842436513, 242.036736430671, 377.1930975293252, 480.05481511256716, 392.3771998712601, 439.5360350081085, 57.01418222581148, 545.4945207018119, 74.80377815935778, 76.1995757735145, 360.5934421211008, 141.05821384410265, 351.7020154407111, 750.6885678488834, 669.2502112623988, 410.33245637963796, 482.86917990861025, 62.300000000000495, 364.02518921934853, 52.72642629913643, -66.79419738221294, 58.400000000000496, 470.8739509106855, 507.1132478481223, 53.100000000000435, 103.42457921987832, 47.90000000000044], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-985.6810418473208, -750.8889859923855, -870.454724165978, -825.1541377676701, -1080.8458510341052, -1384.7722866503734, -1056.4738622661107, -1145.002812061327, -999.0771448936085, -806.0976283324226, -1124.4517485093397, -1134.0720773298349, -876.6906424199321, -842.2566407518625, -1388.597113649106, -1499.425657175239, -1016.0203898618549, -1162.372248106118, -886.9197516955845, -1318.0675998429351, -1188.085194897919, -916.3403763337557, -578.3543385401439, -836.33705541339, -1210.1821480783724, -552.6833027310848, -728.0514797111096, -1075.3966459856538, -1565.5754235808845, -1089.6761609079283, -620.2384521315113, -698.9690128278378, -1085.2155179524455, -701.3187122535055, -1416.024174672497, -1436.519390641211, -933.4737303004149, -940.7879596699516, -1144.617698373152, -977.624567155415, -505.7896685133869, -1231.8378670110471, -533.2379543443025, -1129.8279456209386, -427.93860774086875, -507.18726805505963, -232.8420060504153, -1011.1139970109931, -961.8946847541847, -1172.1099729488988, -765.4346162674645, -1008.0941589392904, -1204.132176451405, -529.6137492947358, -958.1300121746577, -862.4075834927875, -34.05510059508967, -752.972370809941, -326.57381672821583, 27.908512424231883, -391.90707554711656, -208.33510999477906, -611.9336804454362, -909.4732689345611, -460.23427925295306, -568.3869271936866, -113.51068871170823, -832.7165537219091, -95.57946829597374, -929.5111831292913, -214.98213787937945, -687.2035670714217, -37.64736363719217, -1059.7339508392326, -970.8088563643685, -22.973666065956714, -338.55544432216726, -11.839860310733329, -43.80361676863968, 18.25186047611325, 12.837863307973853, -324.58793751664956, -173.95233217649292, -744.5238865356386, -631.4900903598315, -1259.7959307754072, -798.6735323842232, 18.401065874222038, 25.7416261541306, -876.1283364134948, -15.87033769090824, -578.1588457231566, -382.3606154541762, -1004.862579383947, -565.6891721416509, 20.9177097102301, -307.62951988242037, -740.1030361958606, -844.228899183753, -822.9837104045308, -573.9161097513651, -904.1050962834497, -1269.3162983515929, -389.56309963554133, -11.247514189451778, -549.4964790391257, -630.7903843548029, -400.0304174471088, 16.53174003053774, -77.88754889781876, -43.10888162054859, -513.2030102924322, -367.9847823840822, -476.6283373979274, -952.6012223925252, -776.6415038759869, -437.1022150503371, 23.18330451510975, -303.80923390089487, -936.6281045699084, -719.6353757452255, -918.9204181055464, -1253.2677778985824, -746.8086747626018, -623.7332867470154, -18.538837503962668, -1153.2515356576653, -776.2693298384497, -455.8584071602221, 25.32361932889339, -983.0370704550361, -416.74585454485396, -525.6643698715031, -65.57976425890831, -784.1520193453249, -1186.346589771376, -538.5556281942573, -860.1916096383327, -765.5665507082615, -927.3076484072325, -1039.8420045419298, -101.40863776238264, -474.7269297730387, -547.9888379813543, -723.2048275733167, -704.3943104999072, -487.0695457715521, -1052.8078373910573, -113.15890152032173, -470.9849982083886, 12.686587768301663, -455.876636915771, -676.5557619550508, -33.14413440797519, -424.15896759187376, -37.49994654633501, -906.7335517379399, -310.2821898942076, -12.955970743904386, 18.17131128821829, 26.300000000000114, -806.3859693950831, -234.91127973727487, -96.47738858715722, 30.155670317060682, 21.451715254067985, -1018.0419458239497, -1118.0957232150504, -57.12269893206086, -114.33789458021302, -334.8860209749812, -295.9709219250495, 20.000000000000014, -853.2648525856619, -828.1448137173711, -0.4070515398783836, -357.34343534683444, -813.3660621374117, -978.7213805835933, -809.408831072441, 24.18126667939802, 35.960487469049326, -508.9265664525798, -818.4458906882487, -65.10594279212073, 14.008794033437175, -154.08841180630554, -258.8439207428752, 15.374057785203352, 25.524800515599882, -447.08939414428, -467.53083636576923, -495.58626708410003, 42.37777995443587, 23.59987845991838, -86.67294265519722, -45.12227621261923, -70.69716817477124, 16.736732743618187, -0.8661798715729871], "policy_predator_policy_reward": [1121.7297884353493, 553.0120565668627, 742.4771464351669, 1018.5413949376491, 1140.202897688601, 1555.130810778376, 1361.0488244970802, 929.9621795303502, 1126.1915976291339, 581.1551304009989, 1500.4905916503783, 641.2470655647766, 727.8407000094084, 1070.49223453295, 1163.4250123194274, 1601.2123301431336, 1224.5299481454222, 1338.8524261484135, 912.9840785681932, 1433.955418991236, 1296.7231806327059, 1270.2936455626048, 866.189721590025, 966.9907769118088, 1298.8472820024742, 637.7027086381588, 1176.76989487556, 867.9525157944795, 1151.3498892494144, 1558.7301032107991, 868.9355990674168, 797.460160390601, 1209.0225299262881, 645.8622534054166, 1631.7728448457162, 1313.4163947703512, 1130.6532533807863, 539.5695530994828, 1288.0671386637152, 804.8159188946565, 1045.4325623869058, 1281.5208013988956, 986.5021361178422, 1222.6789539480133, 568.3551308864568, 394.3384717524085, 687.1383114001926, 1032.7058430556124, 1347.909615262602, 1322.3087168577983, 882.5249835088525, 1242.0415984347471, 1549.2891918213531, 1255.897113070569, 1039.5541404750657, 1184.343455374234, 678.5248426863845, 609.4689224242588, 318.8975333367106, 291.94153102807394, 480.6081123774559, 443.61979097834126, 901.4252697800094, 911.0015292868414, 806.7172058468595, 832.5281720586636, 667.0875320182663, 803.0942343322528, 628.462777352133, 919.2296015821329, 735.8240273596272, 762.5979400065195, 697.3085139876334, 1022.1254959996095, 960.042189366565, 552.7001859425256, 328.08402323631816, 121.41007657226412, 64.25650982731443, 15.864149564111463, 335.2546582331538, 312.1997778926379, 465.4399182798944, 822.7775463066486, 1253.457277649848, 1345.6384521515786, 796.3003419168471, 325.6503534230708, 746.2040990005275, 870.3313083587032, 400.7339851638138, 590.2965508324872, 1030.8989400205055, 1044.7924140345913, 534.7495547068165, 545.0990233879568, 679.9891320980093, 663.7090287258507, 1053.0656793498308, 911.9532978925823, 1095.0289835889123, 1102.9333858927753, 1300.245362713066, 1171.7772337826493, 614.382506914056, 508.0168051344266, 684.4631616168137, 752.3833028596384, 62.69922205461532, 40.173206782946636, 509.69510979853266, 303.4627829904562, 682.0177295121199, 558.6759523190836, 1232.5575613785413, 1029.7430401259523, 377.66576703772137, 433.07482534251164, 902.2721733129184, 1081.2047502834896, 1038.914201879154, 1146.1842709849034, 1381.7087468761222, 1169.2633368680047, 504.0977724325444, 612.1313833110943, 1152.1619652646086, 1183.433258197295, 427.4493337989357, 433.92127986388766, 1126.4119006241344, 1063.444862725905, 488.8440997918162, 554.5048243564953, 1099.989913980382, 1283.7866892182437, 1040.3207713091006, 931.4168497115222, 1010.01151201448, 1108.1027822164672, 940.2684772750348, 882.1614900671539, 801.1854812273248, 499.3798072093658, 829.8734028640869, 942.0522063792116, 1187.629523801119, 1084.751543605142, 371.74797596041327, 454.4326601989681, 452.2461287036875, 368.13701797310597, 681.5242755926683, 508.23043588292336, 405.23532984622557, 448.80078416324267, 981.378738122581, 675.1730385176734, 16.4618409644732, 35.33700071702396, 655.0307810869264, 670.5497090099666, 209.48603103980548, 196.70641544398308, 10.522081959935932, 14.070108242450583, 1375.8544025284575, 1120.8767086316445, 189.92046259233547, 122.59834476404068, 595.0700589988994, 387.48889934184353, 728.6885678488815, 855.2648525856617, 695.8568758988973, 801.945200620749, 638.026021280523, 943.0159325833608, 1212.0419866796215, 1058.9574048850243, 1.1187333206020553, 1.0395125309509181, 799.7703922037133, 891.6272541564649, 20.051445119977124, 83.77212993784187, 289.1378660352267, 57.00026913174525, 17.501141699196857, 0.0, 710.8934567536486, 674.6007246670858, 477.74990617111405, 482.5718288066711, 116.1730641952783, 0.0, 105.62872721799874, 113.61529638927074, 9.394095237512207, 22.635351890442518]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.864555713739407, "mean_inference_ms": 3.7730538017936475, "mean_action_processing_ms": 1.8451283729446855, "mean_env_wait_ms": 1.1659316741007029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005849003791809082, "StateBufferConnector_ms": 0.015113472938537598, "ViewRequirementAgentConnector_ms": 0.15148258209228516}, "num_episodes": 8, "episode_return_max": 1071.4403791457817, "episode_return_min": -204.0388834900974, "episode_return_mean": 353.99657983494785, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 237.32538456540135, "num_env_steps_trained_throughput_per_sec": 237.32538456540135, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 2240000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2240000, "timers": {"training_iteration_time_ms": 33656.092, "restore_workers_time_ms": 0.028, "training_step_time_ms": 33655.101, "sample_time_ms": 1551.778, "learn_time_ms": 32064.148, "learn_throughput": 249.5, "synch_weights_time_ms": 33.526}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "done": false, "training_iteration": 70, "trial_id": "cd905_00000", "date": "2024-08-20_10-02-16", "timestamp": 1724128336, "time_this_iter_s": 33.75532817840576, "time_total_s": 2293.4784874916077, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a167c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2293.4784874916077, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 40.8, "ram_util_percent": 80.48958333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5053935172538908, "cur_kl_coeff": 4.023313522338867e-08, "cur_lr": 0.0001, "total_loss": 1.7172349671522775, "policy_loss": -0.004602789918204681, "vf_loss": 1.7218377609101554, "vf_explained_var": 0.0391911766831837, "kl": 0.015364068814488251, "entropy": 1.4901380014797998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5162254931671278, "cur_kl_coeff": 1.637090463191271e-12, "cur_lr": 0.0001, "total_loss": 1.0097183798040663, "policy_loss": -0.0005706323961180354, "vf_loss": 1.0102890131965516, "vf_explained_var": 0.0018905626402960884, "kl": 0.0038821124689468614, "entropy": 1.1325065529535687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000}, "env_runners": {"episode_reward_max": 790.0738383501497, "episode_reward_min": -66.79419738221294, "episode_reward_mean": 172.50051932301398, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1186.346589771376, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 58.70000000000022, "predator_policy": 1375.8544025284575}, "policy_reward_mean": {"prey_policy": -160.34827867886668, "predator_policy": 246.59853834037355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [430.83582583149644, 790.0738383501497, 452.1047900179012, 413.2779940819257, 572.9903831880333, 425.2400951154543, 681.1793250378794, 277.84952068229717, 344.3264711700746, 732.5036842436513, 242.036736430671, 377.1930975293252, 480.05481511256716, 392.3771998712601, 439.5360350081085, 57.01418222581148, 545.4945207018119, 74.80377815935778, 76.1995757735145, 360.5934421211008, 141.05821384410265, 351.7020154407111, 750.6885678488834, 669.2502112623988, 410.33245637963796, 482.86917990861025, 62.300000000000495, 364.02518921934853, 52.72642629913643, -66.79419738221294, 58.400000000000496, 470.8739509106855, 507.1132478481223, 53.100000000000435, 103.42457921987832, 47.90000000000044, 32.96748465738791, 38.00000000000027, 65.60000000000039, 40.47531955093501, 48.44353697130644, 38.90822741808197, 25.615037625869068, 48.900000000000446, 57.00000000000042, 231.25405374407723, 49.00000000000044, 261.3660621356855, 99.0212085116065, 106.00989886786445, 46.300000000000416, 50.20000000000047, 35.3967303569128, 57.300000000000495, 81.05849969695144, 312.45839614022424, 60.61474482929993, 39.35181918386824, 60.0000000000005, 37.20000000000026, 36.200000000000244, 65.80000000000034, 111.1024579460253, 41.29947126276699, 143.580815042513, 86.7186434179827, 71.37350935521616, 54.44245628520939, 61.600000000000506, 77.49999999999952, 53.10000000000045, 60.700000000000486, 47.700000000000415, 84.84218746530989, 47.36032324903812, 44.756859716579044, 67.10000000000022, 33.128542568195044, 42.67764213581869, 33.739166264238584, 80.7999999999992, 132.57662122465203, 71.89999999999989, 45.93962847387746, 30.900000000000173, 40.900000000000325, 49.00000000000043, 67.40000000000025, 44.440827042892785, 308.2755416193033, 70.88486921252745, 61.29775988034393, 96.13712226799802, 17.994965402489022, 48.742666955452606, 86.09322090703435, 38.20000000000027, 53.75046346416286, 55.20000000000047, 37.80000000000027], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-455.8584071602221, 25.32361932889339, -983.0370704550361, -416.74585454485396, -525.6643698715031, -65.57976425890831, -784.1520193453249, -1186.346589771376, -538.5556281942573, -860.1916096383327, -765.5665507082615, -927.3076484072325, -1039.8420045419298, -101.40863776238264, -474.7269297730387, -547.9888379813543, -723.2048275733167, -704.3943104999072, -487.0695457715521, -1052.8078373910573, -113.15890152032173, -470.9849982083886, 12.686587768301663, -455.876636915771, -676.5557619550508, -33.14413440797519, -424.15896759187376, -37.49994654633501, -906.7335517379399, -310.2821898942076, -12.955970743904386, 18.17131128821829, 26.300000000000114, -806.3859693950831, -234.91127973727487, -96.47738858715722, 30.155670317060682, 21.451715254067985, -1018.0419458239497, -1118.0957232150504, -57.12269893206086, -114.33789458021302, -334.8860209749812, -295.9709219250495, 20.000000000000014, -853.2648525856619, -828.1448137173711, -0.4070515398783836, -357.34343534683444, -813.3660621374117, -978.7213805835933, -809.408831072441, 24.18126667939802, 35.960487469049326, -508.9265664525798, -818.4458906882487, -65.10594279212073, 14.008794033437175, -154.08841180630554, -258.8439207428752, 15.374057785203352, 25.524800515599882, -447.08939414428, -467.53083636576923, -495.58626708410003, 42.37777995443587, 23.59987845991838, -86.67294265519722, -45.12227621261923, -70.69716817477124, 16.736732743618187, -0.8661798715729871, -6.245913288090144, -6.461873857268262, -20.313939011802155, -42.28746049282596, 24.30961792162318, 23.593371518639003, -20.003054117148636, 16.717600866983688, -24.433661755110464, -203.21073786527606, -139.52617542664822, 17.020221512911807, -71.6030376936613, -8.868665399575505, -111.26520446279429, 18.006409238118636, -42.499615176220814, -12.7897784093094, 1.6833492796520242, -237.71808881412926, 11.718418279103627, -10.412708755781388, 33.50000000000024, -268.5750369806131, -232.08297811307202, -146.353601681734, 38.900000000000226, -84.38271502065886, 2.7692454300868277, 20.000000000000014, 7.961872354082253, 14.2992345108188, -168.47295166189286, -32.90493879060435, 26.300937753803435, -34.0983958556151, -39.137177792508304, 31.203404445365912, -566.8138911209652, -2.733934504281588, 14.748797729375388, -59.48969283742447, 19.047923005199472, -35.1412148032403, 42.50000000000025, -45.81279121617465, 20.000000000000014, -42.16156858046285, 3.3217599216390163, -91.4042671749731, 23.298863807207297, 22.305019201692183, 18.210584208313175, -169.3391883307269, -14.869112859843462, -48.74782556574905, 13.66782214461174, -166.15921446946686, -281.240559612721, -31.74357644239241, 20.000000000000014, -27.21803839435821, -127.24507831821848, -42.115606284456355, 5.875767156083098, 42.50000000000025, 58.70000000000022, -1.7311158511143199, 23.3514514943367, -28.139561366704378, 32.89150386809371, 19.000791530605284, -1.9185757488342392, 2.0296521214172394, 29.279827055543365, 49.722756323134554, 10.982478346252543, 18.633885918677233, 4.271599714471723, -137.32304321270885, 30.16410468802982, -16.44958251964855, 12.722673413903104, 10.860098028244908, -21.52226368470989, -100.87652026323867, -96.99824976078826, -0.8267227175295881, 7.926653431696658, 26.990385017427133, 3.780266891106685, -140.643126913191, 12.592590694873971, 26.300000000000114, -12.313290836712222, 6.667187875179463, -138.9944942052699, -31.795712863515895, 3.9537701803820755, -57.093778482331686, -19.566349306208352, 4.845113626860707, 16.30854106396898, 46.63017905453516, -159.8419870396898, -41.64564710727964, -340.07135469294553, 7.202179703058796, -42.527667425578485, 19.23635440798996, 20.011389786652078, 36.84410915294214, 18.83661534007183, -135.92311409629178, -109.49263443743763, -44.87522175824409, 18.96894686679924, 21.03368081195433, 53.3000000000002, -18.524314536326003, 14.778219072767495, -27.401618750752554, 17.22174422064161, 12.951010437541793, -0.8172996917187201, 3.669150454506905, -1.2650160153907226, 4.495536288503981], "policy_predator_policy_reward": [427.4493337989357, 433.92127986388766, 1126.4119006241344, 1063.444862725905, 488.8440997918162, 554.5048243564953, 1099.989913980382, 1283.7866892182437, 1040.3207713091006, 931.4168497115222, 1010.01151201448, 1108.1027822164672, 940.2684772750348, 882.1614900671539, 801.1854812273248, 499.3798072093658, 829.8734028640869, 942.0522063792116, 1187.629523801119, 1084.751543605142, 371.74797596041327, 454.4326601989681, 452.2461287036875, 368.13701797310597, 681.5242755926683, 508.23043588292336, 405.23532984622557, 448.80078416324267, 981.378738122581, 675.1730385176734, 16.4618409644732, 35.33700071702396, 655.0307810869264, 670.5497090099666, 209.48603103980548, 196.70641544398308, 10.522081959935932, 14.070108242450583, 1375.8544025284575, 1120.8767086316445, 189.92046259233547, 122.59834476404068, 595.0700589988994, 387.48889934184353, 728.6885678488815, 855.2648525856617, 695.8568758988973, 801.945200620749, 638.026021280523, 943.0159325833608, 1212.0419866796215, 1058.9574048850243, 1.1187333206020553, 1.0395125309509181, 799.7703922037133, 891.6272541564649, 20.051445119977124, 83.77212993784187, 289.1378660352267, 57.00026913174525, 17.501141699196857, 0.0, 710.8934567536486, 674.6007246670858, 477.74990617111405, 482.5718288066711, 116.1730641952783, 0.0, 105.62872721799874, 113.61529638927074, 9.394095237512207, 22.635351890442518, 24.24374972085092, 21.431522081895363, 38.21393901180241, 62.387460492826214, 6.890382078376905, 10.80662848136107, 43.760772801099876, 0.0, 154.58157327023642, 121.50636332145561, 45.95979389509591, 115.4543874367216, 89.07894302859602, 17.00779769050905, 126.9652044627934, 15.193590761881355, 16.845161154777145, 95.44423243075342, 223.3555254334157, 243.93326784513962, 46.7987149592291, 0.8955755174487485, 232.65075675765672, 263.79034235864265, 167.7189489458883, 309.7388393605239, 61.33468465865849, 90.15792922986513, 23.53075456991315, 0.0, 7.176473544837167, 20.762419590261718, 18.184508957605317, 218.59011185180404, 3.154631784596483, 61.94282631721565, 37.271313869521734, 51.7209591745728, 550.0098313994791, 331.99639036599126, 51.31109893164063, 54.04454100570759, 34.239632317264075, 21.20547866464493, 0.0, 63.3127912161749, 0.0, 59.361568580463086, 65.78091238231201, 58.501594871021275, 19.001136192792774, 1.1949807983078677, 131.5391850688739, 130.69187699956524, 53.15941236585546, 51.75699732250421, 183.14884405286867, 112.92336331450021, 211.24834115270025, 188.45443832039973, 50.26026910555138, 28.331278644023232, 79.19323576260278, 144.60990512528028, 13.224232843916868, 0.0, 0.0, 20.531115851114343, 45.924575104867245, 11.963534767500738, 7.90849613190653, 0.8992084693947213, 44.58547754254827, 3.00344608486873, 5.839604086633374, 0.0, 16.998191172095414, 0.7457678120124722, 149.34995678512277, 28.458346429692288, 7.335895311970371, 46.04958251964872, 0.7729550195452539, 8.77281610650151, 125.75574305864895, 39.32068302511751, 116.78621550081006, 14.77792324174536, 11.987135344541361, 33.89582620633496, 124.31978993321353, 145.11969131352336, 33.00740930512601, 0.0, 34.813290836712405, 16.772440598697592, 106.38265033563064, 95.3075567331546, 14.746229819617891, 79.29377848233126, 18.76959846095256, 44.95163721839522, 3.2914589360309856, 1.1698209454650685, 145.60760602442036, 100.32085516544113, 334.6531694364325, 306.49154717275536, 54.642791770438905, 39.533390459677335, 2.488610213347938, 1.9536507274015427, 142.39890419329166, 70.82471683092685, 43.95622487023965, 128.40659672793058, 2.173720088652926, 6.566319188045701, 25.76498628333967, 25.552549160022032, 4.721780927232469, 46.10161875075282, 2.448563122789011, 21.12914568318994, 20.51729969171873, 31.83084954549307, 19.965016015390738, 14.604463711495985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.8833569286321685, "mean_inference_ms": 3.779228804177939, "mean_action_processing_ms": 1.904873044837609, "mean_env_wait_ms": 1.168975270528896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004918813705444336, "StateBufferConnector_ms": 0.015810012817382812, "ViewRequirementAgentConnector_ms": 0.12525928020477295}, "num_episodes": 64, "episode_return_max": 790.0738383501497, "episode_return_min": -66.79419738221294, "episode_return_mean": 172.50051932301398, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 234.8928179683902, "num_env_steps_trained_throughput_per_sec": 234.8928179683902, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 2272000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2272000, "timers": {"training_iteration_time_ms": 33745.43, "restore_workers_time_ms": 0.028, "training_step_time_ms": 33745.103, "sample_time_ms": 1661.58, "learn_time_ms": 32059.096, "learn_throughput": 249.539, "synch_weights_time_ms": 19.836}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000}, "done": false, "training_iteration": 71, "trial_id": "cd905_00000", "date": "2024-08-20_10-02-51", "timestamp": 1724128371, "time_this_iter_s": 34.07801795005798, "time_total_s": 2327.5565054416656, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afc60d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2327.5565054416656, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 38.33673469387755, "ram_util_percent": 79.90816326530613}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1830606977795324, "cur_kl_coeff": 4.023313522338867e-08, "cur_lr": 0.0001, "total_loss": 0.23381476090659226, "policy_loss": -0.0005443049347146399, "vf_loss": 0.2343590659163301, "vf_explained_var": 0.17171265577513073, "kl": 0.0020242140093592927, "entropy": 1.500543679131402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 45045.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.41368759656472814, "cur_kl_coeff": 8.185452315956355e-13, "cur_lr": 0.0001, "total_loss": 0.08993024819027928, "policy_loss": -0.002285999318008267, "vf_loss": 0.09221624674955531, "vf_explained_var": -0.004501325270486256, "kl": 0.017890870807755237, "entropy": 1.081838911866385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 45045.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "env_runners": {"episode_reward_max": 750.6885678488834, "episode_reward_min": -66.79419738221294, "episode_reward_mean": 137.39310844402934, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1118.0957232150504, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 60.5000000000002, "predator_policy": 1375.8544025284575}, "policy_reward_mean": {"prey_policy": -113.53033934190846, "predator_policy": 182.22689356392303}, "custom_metrics": {}, "hist_stats": {"episode_reward": [344.3264711700746, 732.5036842436513, 242.036736430671, 377.1930975293252, 480.05481511256716, 392.3771998712601, 439.5360350081085, 57.01418222581148, 545.4945207018119, 74.80377815935778, 76.1995757735145, 360.5934421211008, 141.05821384410265, 351.7020154407111, 750.6885678488834, 669.2502112623988, 410.33245637963796, 482.86917990861025, 62.300000000000495, 364.02518921934853, 52.72642629913643, -66.79419738221294, 58.400000000000496, 470.8739509106855, 507.1132478481223, 53.100000000000435, 103.42457921987832, 47.90000000000044, 32.96748465738791, 38.00000000000027, 65.60000000000039, 40.47531955093501, 48.44353697130644, 38.90822741808197, 25.615037625869068, 48.900000000000446, 57.00000000000042, 231.25405374407723, 49.00000000000044, 261.3660621356855, 99.0212085116065, 106.00989886786445, 46.300000000000416, 50.20000000000047, 35.3967303569128, 57.300000000000495, 81.05849969695144, 312.45839614022424, 60.61474482929993, 39.35181918386824, 60.0000000000005, 37.20000000000026, 36.200000000000244, 65.80000000000034, 111.1024579460253, 41.29947126276699, 143.580815042513, 86.7186434179827, 71.37350935521616, 54.44245628520939, 61.600000000000506, 77.49999999999952, 53.10000000000045, 60.700000000000486, 47.700000000000415, 84.84218746530989, 47.36032324903812, 44.756859716579044, 67.10000000000022, 33.128542568195044, 42.67764213581869, 33.739166264238584, 80.7999999999992, 132.57662122465203, 71.89999999999989, 45.93962847387746, 30.900000000000173, 40.900000000000325, 49.00000000000043, 67.40000000000025, 44.440827042892785, 308.2755416193033, 70.88486921252745, 61.29775988034393, 96.13712226799802, 17.994965402489022, 48.742666955452606, 86.09322090703435, 38.20000000000027, 53.75046346416286, 55.20000000000047, 37.80000000000027, 71.09999999999978, 79.29999999999934, 89.89999999999895, 36.80000000000026, 66.00000000000031, 84.41551230402314, 43.08377370763389, 62.21139839501219], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-723.2048275733167, -704.3943104999072, -487.0695457715521, -1052.8078373910573, -113.15890152032173, -470.9849982083886, 12.686587768301663, -455.876636915771, -676.5557619550508, -33.14413440797519, -424.15896759187376, -37.49994654633501, -906.7335517379399, -310.2821898942076, -12.955970743904386, 18.17131128821829, 26.300000000000114, -806.3859693950831, -234.91127973727487, -96.47738858715722, 30.155670317060682, 21.451715254067985, -1018.0419458239497, -1118.0957232150504, -57.12269893206086, -114.33789458021302, -334.8860209749812, -295.9709219250495, 20.000000000000014, -853.2648525856619, -828.1448137173711, -0.4070515398783836, -357.34343534683444, -813.3660621374117, -978.7213805835933, -809.408831072441, 24.18126667939802, 35.960487469049326, -508.9265664525798, -818.4458906882487, -65.10594279212073, 14.008794033437175, -154.08841180630554, -258.8439207428752, 15.374057785203352, 25.524800515599882, -447.08939414428, -467.53083636576923, -495.58626708410003, 42.37777995443587, 23.59987845991838, -86.67294265519722, -45.12227621261923, -70.69716817477124, 16.736732743618187, -0.8661798715729871, -6.245913288090144, -6.461873857268262, -20.313939011802155, -42.28746049282596, 24.30961792162318, 23.593371518639003, -20.003054117148636, 16.717600866983688, -24.433661755110464, -203.21073786527606, -139.52617542664822, 17.020221512911807, -71.6030376936613, -8.868665399575505, -111.26520446279429, 18.006409238118636, -42.499615176220814, -12.7897784093094, 1.6833492796520242, -237.71808881412926, 11.718418279103627, -10.412708755781388, 33.50000000000024, -268.5750369806131, -232.08297811307202, -146.353601681734, 38.900000000000226, -84.38271502065886, 2.7692454300868277, 20.000000000000014, 7.961872354082253, 14.2992345108188, -168.47295166189286, -32.90493879060435, 26.300937753803435, -34.0983958556151, -39.137177792508304, 31.203404445365912, -566.8138911209652, -2.733934504281588, 14.748797729375388, -59.48969283742447, 19.047923005199472, -35.1412148032403, 42.50000000000025, -45.81279121617465, 20.000000000000014, -42.16156858046285, 3.3217599216390163, -91.4042671749731, 23.298863807207297, 22.305019201692183, 18.210584208313175, -169.3391883307269, -14.869112859843462, -48.74782556574905, 13.66782214461174, -166.15921446946686, -281.240559612721, -31.74357644239241, 20.000000000000014, -27.21803839435821, -127.24507831821848, -42.115606284456355, 5.875767156083098, 42.50000000000025, 58.70000000000022, -1.7311158511143199, 23.3514514943367, -28.139561366704378, 32.89150386809371, 19.000791530605284, -1.9185757488342392, 2.0296521214172394, 29.279827055543365, 49.722756323134554, 10.982478346252543, 18.633885918677233, 4.271599714471723, -137.32304321270885, 30.16410468802982, -16.44958251964855, 12.722673413903104, 10.860098028244908, -21.52226368470989, -100.87652026323867, -96.99824976078826, -0.8267227175295881, 7.926653431696658, 26.990385017427133, 3.780266891106685, -140.643126913191, 12.592590694873971, 26.300000000000114, -12.313290836712222, 6.667187875179463, -138.9944942052699, -31.795712863515895, 3.9537701803820755, -57.093778482331686, -19.566349306208352, 4.845113626860707, 16.30854106396898, 46.63017905453516, -159.8419870396898, -41.64564710727964, -340.07135469294553, 7.202179703058796, -42.527667425578485, 19.23635440798996, 20.011389786652078, 36.84410915294214, 18.83661534007183, -135.92311409629178, -109.49263443743763, -44.87522175824409, 18.96894686679924, 21.03368081195433, 53.3000000000002, -18.524314536326003, 14.778219072767495, -27.401618750752554, 17.22174422064161, 12.951010437541793, -0.8172996917187201, 3.669150454506905, -1.2650160153907226, 4.495536288503981, -0.5628423771783108, -17.94250104673103, -1.2814039850383008, 60.5000000000002, -51.10082748407176, -121.34882946377928, -18.201363334844793, -88.98946510724788, 18.964783045784703, 46.100000000000215, -83.40807675403609, 20.000000000000014, -0.26047569667639614, 13.41527981923972, 17.846894602486394, -77.791607911381], "policy_predator_policy_reward": [829.8734028640869, 942.0522063792116, 1187.629523801119, 1084.751543605142, 371.74797596041327, 454.4326601989681, 452.2461287036875, 368.13701797310597, 681.5242755926683, 508.23043588292336, 405.23532984622557, 448.80078416324267, 981.378738122581, 675.1730385176734, 16.4618409644732, 35.33700071702396, 655.0307810869264, 670.5497090099666, 209.48603103980548, 196.70641544398308, 10.522081959935932, 14.070108242450583, 1375.8544025284575, 1120.8767086316445, 189.92046259233547, 122.59834476404068, 595.0700589988994, 387.48889934184353, 728.6885678488815, 855.2648525856617, 695.8568758988973, 801.945200620749, 638.026021280523, 943.0159325833608, 1212.0419866796215, 1058.9574048850243, 1.1187333206020553, 1.0395125309509181, 799.7703922037133, 891.6272541564649, 20.051445119977124, 83.77212993784187, 289.1378660352267, 57.00026913174525, 17.501141699196857, 0.0, 710.8934567536486, 674.6007246670858, 477.74990617111405, 482.5718288066711, 116.1730641952783, 0.0, 105.62872721799874, 113.61529638927074, 9.394095237512207, 22.635351890442518, 24.24374972085092, 21.431522081895363, 38.21393901180241, 62.387460492826214, 6.890382078376905, 10.80662848136107, 43.760772801099876, 0.0, 154.58157327023642, 121.50636332145561, 45.95979389509591, 115.4543874367216, 89.07894302859602, 17.00779769050905, 126.9652044627934, 15.193590761881355, 16.845161154777145, 95.44423243075342, 223.3555254334157, 243.93326784513962, 46.7987149592291, 0.8955755174487485, 232.65075675765672, 263.79034235864265, 167.7189489458883, 309.7388393605239, 61.33468465865849, 90.15792922986513, 23.53075456991315, 0.0, 7.176473544837167, 20.762419590261718, 18.184508957605317, 218.59011185180404, 3.154631784596483, 61.94282631721565, 37.271313869521734, 51.7209591745728, 550.0098313994791, 331.99639036599126, 51.31109893164063, 54.04454100570759, 34.239632317264075, 21.20547866464493, 0.0, 63.3127912161749, 0.0, 59.361568580463086, 65.78091238231201, 58.501594871021275, 19.001136192792774, 1.1949807983078677, 131.5391850688739, 130.69187699956524, 53.15941236585546, 51.75699732250421, 183.14884405286867, 112.92336331450021, 211.24834115270025, 188.45443832039973, 50.26026910555138, 28.331278644023232, 79.19323576260278, 144.60990512528028, 13.224232843916868, 0.0, 0.0, 20.531115851114343, 45.924575104867245, 11.963534767500738, 7.90849613190653, 0.8992084693947213, 44.58547754254827, 3.00344608486873, 5.839604086633374, 0.0, 16.998191172095414, 0.7457678120124722, 149.34995678512277, 28.458346429692288, 7.335895311970371, 46.04958251964872, 0.7729550195452539, 8.77281610650151, 125.75574305864895, 39.32068302511751, 116.78621550081006, 14.77792324174536, 11.987135344541361, 33.89582620633496, 124.31978993321353, 145.11969131352336, 33.00740930512601, 0.0, 34.813290836712405, 16.772440598697592, 106.38265033563064, 95.3075567331546, 14.746229819617891, 79.29377848233126, 18.76959846095256, 44.95163721839522, 3.2914589360309856, 1.1698209454650685, 145.60760602442036, 100.32085516544113, 334.6531694364325, 306.49154717275536, 54.642791770438905, 39.533390459677335, 2.488610213347938, 1.9536507274015427, 142.39890419329166, 70.82471683092685, 43.95622487023965, 128.40659672793058, 2.173720088652926, 6.566319188045701, 25.76498628333967, 25.552549160022032, 4.721780927232469, 46.10161875075282, 2.448563122789011, 21.12914568318994, 20.51729969171873, 31.83084954549307, 19.965016015390738, 14.604463711495985, 19.0628423771783, 70.54250104673115, 20.081403985038317, 0.0, 125.50082748407189, 136.8488294637784, 113.20947052243052, 30.78135791966179, 0.9352169542152986, 0.0, 71.08573907884458, 76.73784997921467, 12.93378722030171, 16.99518236476849, 36.41287974156423, 85.74323196234123]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.876562423853766, "mean_inference_ms": 3.7832725939941962, "mean_action_processing_ms": 1.906082352621311, "mean_env_wait_ms": 1.167934537862781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004819512367248535, "StateBufferConnector_ms": 0.01575922966003418, "ViewRequirementAgentConnector_ms": 0.1235344409942627}, "num_episodes": 8, "episode_return_max": 750.6885678488834, "episode_return_min": -66.79419738221294, "episode_return_mean": 137.39310844402934, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 228.46929483772192, "num_env_steps_trained_throughput_per_sec": 228.46929483772192, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 2304000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2304000, "timers": {"training_iteration_time_ms": 33829.284, "restore_workers_time_ms": 0.028, "training_step_time_ms": 33828.962, "sample_time_ms": 1560.926, "learn_time_ms": 32242.037, "learn_throughput": 248.123, "synch_weights_time_ms": 21.065}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "done": false, "training_iteration": 72, "trial_id": "cd905_00000", "date": "2024-08-20_10-03-26", "timestamp": 1724128406, "time_this_iter_s": 35.06765604019165, "time_total_s": 2362.6241614818573, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afec670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2362.6241614818573, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 43.946000000000005, "ram_util_percent": 80.04}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.725255125311632, "cur_kl_coeff": 2.0116567611694334e-08, "cur_lr": 0.0001, "total_loss": 1.7065730410908895, "policy_loss": -0.0033885846879067164, "vf_loss": 1.709961620020488, "vf_explained_var": 0.06433242001230755, "kl": 0.010399789107151943, "entropy": 1.4875939115645394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 45675.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.43011552098961103, "cur_kl_coeff": 8.185452315956355e-13, "cur_lr": 0.0001, "total_loss": 0.8134191471905935, "policy_loss": -0.0011098337193418827, "vf_loss": 0.8145289776817201, "vf_explained_var": 0.001220755066190447, "kl": 0.005305291476885205, "entropy": 1.039614585089305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 45675.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000}, "env_runners": {"episode_reward_max": 308.2755416193033, "episode_reward_min": -0.9346298306574484, "episode_reward_mean": 57.54778945939007, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -340.07135469294553, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 70.35082059540248, "predator_policy": 334.6531694364325}, "policy_reward_mean": {"prey_policy": -2.3974778113196837, "predator_policy": 31.17137254101465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.700000000000415, 84.84218746530989, 47.36032324903812, 44.756859716579044, 67.10000000000022, 33.128542568195044, 42.67764213581869, 33.739166264238584, 80.7999999999992, 132.57662122465203, 71.89999999999989, 45.93962847387746, 30.900000000000173, 40.900000000000325, 49.00000000000043, 67.40000000000025, 44.440827042892785, 308.2755416193033, 70.88486921252745, 61.29775988034393, 96.13712226799802, 17.994965402489022, 48.742666955452606, 86.09322090703435, 38.20000000000027, 53.75046346416286, 55.20000000000047, 37.80000000000027, 71.09999999999978, 79.29999999999934, 89.89999999999895, 36.80000000000026, 66.00000000000031, 84.41551230402314, 43.08377370763389, 62.21139839501219, 59.10000000000043, 45.700000000000394, 51.90000000000047, 51.9000000000005, 42.50000000000034, 48.30000000000044, 101.54888845187175, 66.10000000000035, 78.89999999999938, 58.46463626756482, 92.4999999999985, 32.4187085856218, 70.20000000000005, 38.50000000000028, 37.04335749691878, 35.70000000000024, 39.900000000000304, 39.60000000000029, 70.00000000000004, 61.90000000000047, 64.80000000000041, 52.27363427175753, 30.128723157714486, 53.70000000000048, 73.5999999999998, 39.60000000000029, 39.000000000000284, 55.10000000000043, 36.40834788407173, 66.80000000000024, 71.59999999999992, 49.46067289111209, 64.20000000000044, 36.73821404153191, 37.90000000000027, 90.59999999999857, 63.10000000000047, 61.2000000000004, 40.70000000000031, 64.05753896647747, 66.10000000000029, 38.80000000000028, -0.9346298306574484, 68.30000000000017, 94.49999999999869, 34.800000000000225, 35.90000000000024, 38.300000000000274, 59.54173535821107, 66.75737040144384, 39.20000000000029, 46.7000000000004, 60.60000000000043, 80.69999999999932, 47.50000000000043, 39.20000000000029, 39.100000000000286, 36.200000000000244, 50.10000000000048, 39.40000000000029, 60.02265573877467, 50.00000000000047, 40.1000000000003, 38.400000000000276], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1.9185757488342392, 2.0296521214172394, 29.279827055543365, 49.722756323134554, 10.982478346252543, 18.633885918677233, 4.271599714471723, -137.32304321270885, 30.16410468802982, -16.44958251964855, 12.722673413903104, 10.860098028244908, -21.52226368470989, -100.87652026323867, -96.99824976078826, -0.8267227175295881, 7.926653431696658, 26.990385017427133, 3.780266891106685, -140.643126913191, 12.592590694873971, 26.300000000000114, -12.313290836712222, 6.667187875179463, -138.9944942052699, -31.795712863515895, 3.9537701803820755, -57.093778482331686, -19.566349306208352, 4.845113626860707, 16.30854106396898, 46.63017905453516, -159.8419870396898, -41.64564710727964, -340.07135469294553, 7.202179703058796, -42.527667425578485, 19.23635440798996, 20.011389786652078, 36.84410915294214, 18.83661534007183, -135.92311409629178, -109.49263443743763, -44.87522175824409, 18.96894686679924, 21.03368081195433, 53.3000000000002, -18.524314536326003, 14.778219072767495, -27.401618750752554, 17.22174422064161, 12.951010437541793, -0.8172996917187201, 3.669150454506905, -1.2650160153907226, 4.495536288503981, -0.5628423771783108, -17.94250104673103, -1.2814039850383008, 60.5000000000002, -51.10082748407176, -121.34882946377928, -18.201363334844793, -88.98946510724788, 18.964783045784703, 46.100000000000215, -83.40807675403609, 20.000000000000014, -0.26047569667639614, 13.41527981923972, 17.846894602486394, -77.791607911381, 37.91082002515299, 0.06218897015462699, 10.578001945152149, 20.000000000000014, -43.39602644836058, -6.7969241553107995, 14.49440010618057, 19.088113352892105, -51.020185706405044, 17.650526229025292, -24.716422482024313, 29.046349698856233, 24.016267878964584, 41.60000000000025, 20.000000000000014, 46.10000000000024, 31.145579823951064, 20.38756720434921, 16.937968547076203, 21.314616322179678, 70.35082059540248, -2.4934214180600485, 5.311722065242533, -41.264199696173776, 17.25190860394901, 48.01505329905728, 4.799293208273035, 18.912286724036207, 5.727364762934716, -2.806576017619472, 5.201070482287468, -50.93618233129842, 2.1142946025517593, 16.703402075533024, 20.000000000000014, 8.651175176236938, 34.1374747427415, 8.75232061829757, 16.2086139524923, 5.717776091166435, 22.633223393977314, 7.883230497134395, 20.000000000000014, -42.994735660511125, -43.504632586819795, -2.160653199295386, 19.14834201131061, 12.727016970817273, 17.718730019817368, 48.96304045377519, 14.834879996750482, 20.000000000000014, 13.169192193237944, -4.948004860923396, -8.565725672140404, 1.738424429589435, -33.19226006815767, 14.257746768866506, 10.126507479430268, 11.582570177061964, 7.772961019760393, 41.08474102117019, -12.752647739444386, 20.000000000000014, -6.953381993568817, 25.376395406960942, -10.943603311676787, 15.327164100989151, -21.169291414630536, 20.000000000000014, 17.3353245570245, 36.20000000000026, -17.523041123001484, 27.05606010821278, -9.126930814633463, 20.000000000000014, 14.204792420278501, 9.456844108509381, 30.3135587423061, 20.64159700210089, -5.947483869239134, 39.97993598680593, 20.000000000000014, 4.7870708463264275, -34.98350145775661, -41.336414242250406, 17.920193633077602, 34.77940298798151, 60.37097099286921, 29.562041182953923, 1.409899374069462, -57.16699326530759, 10.414439864520784, -28.575451199112983, -8.687227079836553, 20.000000000000014, 39.623744674477976, -5.811750748254251, -2.6257048844726834, 30.800000000000196, 13.865416789896512, 14.785226820327923, -54.16726589258804, -9.850247431735678, -106.27514783206462, -15.044509667659682, 9.978048533389291, 24.652531212339042, -6.744049686138867, -6.6357403619301785, 15.154543484521223, 16.103616522319154, 15.673211418673688, 10.259100006213846, -97.80124772736156, 15.569896948891904, 25.234808184003843, 17.12131793647828, 20.000000000000014, 13.963196439641596, -1.1006009658759939, 35.80439908229988, 21.33964557957941, 20.000000000000014, 19.68643868262938, 11.808374201874651, 1.6931511490015938, 20.000000000000014], "policy_predator_policy_reward": [44.58547754254827, 3.00344608486873, 5.839604086633374, 0.0, 16.998191172095414, 0.7457678120124722, 149.34995678512277, 28.458346429692288, 7.335895311970371, 46.04958251964872, 0.7729550195452539, 8.77281610650151, 125.75574305864895, 39.32068302511751, 116.78621550081006, 14.77792324174536, 11.987135344541361, 33.89582620633496, 124.31978993321353, 145.11969131352336, 33.00740930512601, 0.0, 34.813290836712405, 16.772440598697592, 106.38265033563064, 95.3075567331546, 14.746229819617891, 79.29377848233126, 18.76959846095256, 44.95163721839522, 3.2914589360309856, 1.1698209454650685, 145.60760602442036, 100.32085516544113, 334.6531694364325, 306.49154717275536, 54.642791770438905, 39.533390459677335, 2.488610213347938, 1.9536507274015427, 142.39890419329166, 70.82471683092685, 43.95622487023965, 128.40659672793058, 2.173720088652926, 6.566319188045701, 25.76498628333967, 25.552549160022032, 4.721780927232469, 46.10161875075282, 2.448563122789011, 21.12914568318994, 20.51729969171873, 31.83084954549307, 19.965016015390738, 14.604463711495985, 19.0628423771783, 70.54250104673115, 20.081403985038317, 0.0, 125.50082748407189, 136.8488294637784, 113.20947052243052, 30.78135791966179, 0.9352169542152986, 0.0, 71.08573907884458, 76.73784997921467, 12.93378722030171, 16.99518236476849, 36.41287974156423, 85.74323196234123, 2.5891799748472257, 18.53781102984536, 6.289672535994435, 8.832325518853386, 60.79602644836083, 41.29692415531087, 17.505599893819397, 0.8118866471078994, 26.62532622872241, 49.24433324865733, 43.216422482024576, 0.7536503011439328, 15.186899123181023, 20.745721449728066, 0.0, 0.0, 7.954420176049149, 19.41243279565083, 16.62737932937055, 3.584672068937974, 3.349179404597269, 21.293421418060078, 64.98978081934345, 3.381405397209608, 2.548091396050972, 2.3849467009429564, 13.800706791726933, 0.9877132759637955, 22.026459658448623, 12.096109093154661, 42.09435260453388, 39.34075924447702, 18.085705397448216, 2.996597924466947, 0.0, 10.948824823763026, 16.462525257258715, 10.647679381702394, 25.99138604750767, 13.982223908833532, 9.261494907157374, 25.022051201730974, 23.347141523440083, 51.921228408828306, 61.30463258682005, 14.489376357009723, 0.7516579886893954, 21.0729830291827, 2.0812699801826184, 4.836959546225032, 4.765120003249485, 0.0, 26.14148831973047, 4.637324347954992, 9.870039621170767, 52.05726162138024, 51.592260068157934, 3.750601115204944, 4.302631912702946, 40.78829043080477, 5.831303704997014, 16.91099425407259, 31.381189249764724, 10.832131380791498, 25.353381993568917, 20.42360459303917, 30.043603311676968, 2.311049940542469, 4.664512476246074, 34.40477893838468, 1.26548173524106, 35.79919370773442, 36.22304112300175, 17.343939891787365, 30.374486935941746, 19.95244387869179, 7.1952075797214645, 9.843155891490584, 12.358402997899136, 0.7439802241710385, 30.00607865487447, 2.061469227559024, 0.0, 14.01292915367354, 0.0, 75.38528586934983, 4.379806366922386, 11.220597012018715, 2.6290290071309927, 1.9379588170462525, 38.94920696644422, 51.607886924793604, 34.86422610654422, 19.196785228048157, 26.987227079836682, 0.0, 0.817990683732841, 24.91175074825434, 11.360779431435544, 27.222295854480663, 5.734583210103452, 4.814773179672042, 8.766927581435054, 101.95058574288873, 126.21287249669453, 55.70678500302901, 17.12195146661068, 28.947468787661055, 25.044049686138962, 35.83574036193026, 5.24693480916554, 2.6949051839940115, 3.9267885813262757, 9.240899993786119, 59.75820285929511, 58.673147919173594, 5.1651918159962555, 2.5786820635216983, 0.0, 5.436803560358372, 20.700600965876006, 4.618256656474533, 8.660354420420624, 0.0, 3.3109829584133323, 5.294204157082615, 16.706848850998373, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.893465622254803, "mean_inference_ms": 3.7866824305184776, "mean_action_processing_ms": 1.933287278314815, "mean_env_wait_ms": 1.1692709371800922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009592056274414062, "StateBufferConnector_ms": 0.027244210243225098, "ViewRequirementAgentConnector_ms": 0.14673757553100586}, "num_episodes": 64, "episode_return_max": 308.2755416193033, "episode_return_min": -0.9346298306574484, "episode_return_mean": 57.54778945939007, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 236.47680733216663, "num_env_steps_trained_throughput_per_sec": 236.47680733216663, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 2336000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2336000, "timers": {"training_iteration_time_ms": 33740.52, "restore_workers_time_ms": 0.029, "training_step_time_ms": 33740.32, "sample_time_ms": 1558.01, "learn_time_ms": 32156.595, "learn_throughput": 248.783, "synch_weights_time_ms": 20.892}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000}, "done": false, "training_iteration": 73, "trial_id": "cd905_00000", "date": "2024-08-20_10-04-00", "timestamp": 1724128440, "time_this_iter_s": 33.89707088470459, "time_total_s": 2396.521232366562, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169edb4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2396.521232366562, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 40.03333333333333, "ram_util_percent": 80.19166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4250230977341296, "cur_kl_coeff": 2.0116567611694334e-08, "cur_lr": 0.0001, "total_loss": 0.785958130775936, "policy_loss": -0.002401813489222337, "vf_loss": 0.7883599418496329, "vf_explained_var": 0.02883102468081883, "kl": 0.009583152231258166, "entropy": 1.4401699223215618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.419781367894676, "cur_kl_coeff": 8.185452315956355e-13, "cur_lr": 0.0001, "total_loss": 0.5278977810863464, "policy_loss": -0.0005726051660964177, "vf_loss": 0.5284703877710161, "vf_explained_var": 0.013960250975593688, "kl": 0.0024535009891790663, "entropy": 0.9891795791330792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000}, "env_runners": {"episode_reward_max": 132.19999999999845, "episode_reward_min": -0.9346298306574484, "episode_reward_mean": 54.21354027543411, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -131.69876591651203, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 62.06561972121426, "predator_policy": 148.59876591651107}, "policy_reward_mean": {"prey_policy": 7.660757983400194, "predator_policy": 19.44601215431684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.10000000000047, 61.2000000000004, 40.70000000000031, 64.05753896647747, 66.10000000000029, 38.80000000000028, -0.9346298306574484, 68.30000000000017, 94.49999999999869, 34.800000000000225, 35.90000000000024, 38.300000000000274, 59.54173535821107, 66.75737040144384, 39.20000000000029, 46.7000000000004, 60.60000000000043, 80.69999999999932, 47.50000000000043, 39.20000000000029, 39.100000000000286, 36.200000000000244, 50.10000000000048, 39.40000000000029, 60.02265573877467, 50.00000000000047, 40.1000000000003, 38.400000000000276, 39.800000000000296, 36.84096061421653, 51.831299295995784, 63.60000000000048, 70.49999999999999, 38.859527040446395, 56.800000000000516, 90.09999999999857, 100.32586005266792, 40.0000000000003, 45.100000000000385, 61.300000000000495, 45.900000000000404, 90.99999999999858, 40.60000000000031, 37.50000000000026, 45.60000000000039, 110.89999999999839, 72.04476173418186, 44.10000000000037, 113.50043176972937, 48.40000000000044, 36.714135946131655, 42.47546299607767, 44.844309338906456, 44.00000000000036, 69.10000000000012, 60.90000000000039, 30.210618463588734, 33.591590879963036, 108.19999999999857, 61.04614053673677, 57.238688956170485, 58.300000000000466, 38.20000000000027, 56.50000000000044, 132.19999999999845, 38.90000000000028, 85.1999999999989, 47.40000000000042, 50.500000000000405, 88.1999999999987, 41.878637405408504, 50.30000000000039, 36.900000000000254, 37.10000000000026, 87.49999999999875, 57.30000000000049, 37.40000000000026, 38.80000000000028, 38.70000000000028, 50.50000000000046, 42.02032678950698, 36.900000000000254, 71.89999999999989, 50.30000000000046, 37.700000000000266, 54.80000000000044, 48.040701363954696, 39.60000000000029, 52.00000000000048, 68.60000000000015, 80.82754852058001, 53.50000000000051, 36.10000000000024, 54.44592029545027, 38.46565711493884, 57.700000000000514, 38.20000000000027, 12.606777794501994, 72.39999999999986, 72.19999999999987], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.523041123001484, 27.05606010821278, -9.126930814633463, 20.000000000000014, 14.204792420278501, 9.456844108509381, 30.3135587423061, 20.64159700210089, -5.947483869239134, 39.97993598680593, 20.000000000000014, 4.7870708463264275, -34.98350145775661, -41.336414242250406, 17.920193633077602, 34.77940298798151, 60.37097099286921, 29.562041182953923, 1.409899374069462, -57.16699326530759, 10.414439864520784, -28.575451199112983, -8.687227079836553, 20.000000000000014, 39.623744674477976, -5.811750748254251, -2.6257048844726834, 30.800000000000196, 13.865416789896512, 14.785226820327923, -54.16726589258804, -9.850247431735678, -106.27514783206462, -15.044509667659682, 9.978048533389291, 24.652531212339042, -6.744049686138867, -6.6357403619301785, 15.154543484521223, 16.103616522319154, 15.673211418673688, 10.259100006213846, -97.80124772736156, 15.569896948891904, 25.234808184003843, 17.12131793647828, 20.000000000000014, 13.963196439641596, -1.1006009658759939, 35.80439908229988, 21.33964557957941, 20.000000000000014, 19.68643868262938, 11.808374201874651, 1.6931511490015938, 20.000000000000014, 20.000000000000014, 17.680324648973386, 16.067956195801337, 8.414988257854448, 27.28659030022968, -23.499983378381884, 35.479409036266574, -12.074039459196339, 45.87977030877473, 8.072103002213579, 21.559527040446152, -62.27804560464561, 36.188156800705215, 17.292782384042685, 29.836929146147778, 3.584397342445493, 44.8300614584452, 34.39948461830302, 20.000000000000014, 20.000000000000014, 15.453706556819514, 15.774771257467378, 41.490011105270995, -9.257952718133769, 7.922322176158639, -13.308936467773735, 15.83141742552053, 59.86125332188784, 20.900000000000027, 15.61902244614005, -24.67121545562953, 3.8012868407825975, 10.93332783576092, 24.500000000000085, 39.164995174578614, 59.80070877847201, 9.638756668494326, 24.071418102282916, -30.14816387970663, -3.237565080192617, 2.535117613782298, 13.390405286013362, -23.67635083020317, -42.789705915341926, -6.282515770221622, -5.21962481370106, 15.362310937372419, 13.437852820779536, -2.2992587323619516, -14.635262784128745, 18.887733082268316, 19.996862684431434, 37.76113559773401, 24.256895784982465, 30.90262028878879, 20.000000000000014, -8.059378823108894, -19.09616891105847, -9.468231660256226, -15.152756642395113, 20.455659482496777, 39.12167063126276, 17.71127618269608, -54.97291279564532, 10.162132746647496, -9.048506614508174, 7.153735824127262, -0.5492708331211748, -1.2177893956186292, 8.80055089172266, 19.037599897215827, 6.083537024747727, 62.06561972121426, 38.27966816255696, -5.244089414216372, 17.05755967740192, 59.562165875262096, 17.79386311793672, 22.115919141731744, 19.066712841222344, 17.681161037613514, 14.47250798869236, 21.33388323873614, 49.15596102295528, 10.000468815058463, 14.407564547603785, 19.430826119829465, 13.603707260117744, -131.69876591651203, 20.000000000000014, 13.14966905362062, -16.50830826402514, 32.89598002968249, 7.784364042999551, 6.340844585686586, 22.43346494391686, -5.081412587918358, -14.267567672287345, 15.79969358719928, 7.805780500434771, 12.200488785843257, 12.698687261802124, -2.535003727651555, -10.050216803244851, 12.990021513851291, 4.3608777966817325, -8.368737550345122, 1.4486080155514351, 20.000000000000014, 17.33470623629819, 16.106461050531404, 9.54449372488693, 11.950765291164242, -27.69634215377755, 1.6311366457267094, 2.852268870814475, 17.902859178257586, -46.56348651179976, 20.000000000000014, 15.48032066588089, -12.927077747537842, 20.000000000000014, 19.08864634099511, 12.699330501137226, 4.430095873030705, 51.52039483126668, 32.153164339388475, 10.021004816971189, -3.5780089771896786, -13.895862174706572, 17.34592029544979, 9.925321694320903, 15.119548131767708, -50.957161541430445, 32.54359201254761, 22.700000000000053, -0.3352304396951066, 16.63920204480402, -28.909721659757935, -78.17934053577392, 40.38085564819488, 20.000000000000014, -40.88687808383008, 36.469546453724504], "policy_predator_policy_reward": [36.22304112300175, 17.343939891787365, 30.374486935941746, 19.95244387869179, 7.1952075797214645, 9.843155891490584, 12.358402997899136, 0.7439802241710385, 30.00607865487447, 2.061469227559024, 0.0, 14.01292915367354, 0.0, 75.38528586934983, 4.379806366922386, 11.220597012018715, 2.6290290071309927, 1.9379588170462525, 38.94920696644422, 51.607886924793604, 34.86422610654422, 19.196785228048157, 26.987227079836682, 0.0, 0.817990683732841, 24.91175074825434, 11.360779431435544, 27.222295854480663, 5.734583210103452, 4.814773179672042, 8.766927581435054, 101.95058574288873, 126.21287249669453, 55.70678500302901, 17.12195146661068, 28.947468787661055, 25.044049686138962, 35.83574036193026, 5.24693480916554, 2.6949051839940115, 3.9267885813262757, 9.240899993786119, 59.75820285929511, 58.673147919173594, 5.1651918159962555, 2.5786820635216983, 0.0, 5.436803560358372, 20.700600965876006, 4.618256656474533, 8.660354420420624, 0.0, 3.3109829584133323, 5.294204157082615, 16.706848850998373, 0.0, 0.0, 2.119675351026598, 11.54949663335751, 0.8085195272029015, 3.801298669607815, 44.24339370454013, 9.220590963733653, 30.974039459196536, 1.0202296912254833, 15.527896997786389, 0.0, 79.57804560464476, 0.8118431992950395, 2.5072176159572948, 13.707833596521063, 42.97083991488583, 7.915946406321888, 13.18036756959985, 0.0, 0.0, 3.189163013847772, 10.682359171865258, 0.9099888947292479, 28.157952718133917, 39.13891685035231, 12.147697441262936, 3.8685825744794315, 11.438746678112349, 0.0, 4.080977553859913, 42.97121545562979, 15.398713159217367, 10.166672164239046, 0.0, 4.735004825421592, 7.199291221528194, 9.869919414753015, 28.464667548651796, 26.0404802912839, 51.44524866861564, 19.717310078040143, 77.85759879189511, 42.47635083020344, 72.38970591534215, 24.60395100638965, 23.612325523664587, 1.1857692652032619, 12.489529972722043, 30.697346086807016, 31.08148476859003, 1.0122669177316852, 4.103137315568583, 1.0388644022662437, 6.043104215017628, 9.997379711211387, 0.0, 0.8281377753253086, 56.538028422430955, 21.694912107115883, 36.51766707549869, 12.844340517503241, 35.77832936873741, 43.169471045995, 55.13830610369006, 40.44891412692129, 15.676148697109467, 12.146264175872703, 39.54927083312114, 20.31778939561865, 10.299449108277306, 18.066849969108926, 13.312013108927504, 19.534380278785903, 12.320331837443264, 23.23506354047329, 3.851466196341204, 5.837834124738073, 2.0061368820632643, 4.596035330118352, 1.6213326869276097, 13.218838962386455, 5.127492011307605, 2.0661167612638964, 15.644038977044897, 8.004041031257293, 9.46656301148857, 7.069173880170543, 10.196292739882203, 148.59876591651107, 0.0, 13.877635181034547, 26.581004029370188, 7.395224460855284, 39.42443146646282, 13.059155414313379, 15.466535056083194, 23.98141258791843, 32.767567672287576, 3.8003064128006825, 11.394219499565194, 7.199511214156708, 6.601312738197842, 24.181680054240662, 38.90354047665591, 9.930305275655329, 14.739122203318233, 25.844818230306682, 17.975311304487104, 0.0, 34.56529376370179, 4.6554848330822125, 19.99356039149938, 7.449234708835723, 45.99634215377781, 17.068863354273265, 33.2477311291855, 53.47639260831475, 23.224936089181927, 0.0, 4.119679334119074, 44.92707774753803, 0.0, 13.611353659004896, 23.20066949886275, 18.369904126969303, 6.507153689314269, 2.046835660611748, 9.278995183028776, 43.21869402160389, 10.355177130292574, 0.7309753585162372, 26.443702947162837, 69.55716154143032, 4.746108983170819, 2.4564079874526126, 0.0, 3.934897746285749, 17.96113064860531, 103.31476888996325, 16.38107110006986, 12.019144351805329, 0.0, 71.85349981924286, 4.7638318108631665]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.900307702237227, "mean_inference_ms": 3.7906842660150324, "mean_action_processing_ms": 1.928999580751881, "mean_env_wait_ms": 1.1699400667388344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005267500877380371, "StateBufferConnector_ms": 0.02943241596221924, "ViewRequirementAgentConnector_ms": 0.13499677181243896}, "num_episodes": 72, "episode_return_max": 132.19999999999845, "episode_return_min": -0.9346298306574484, "episode_return_mean": 54.21354027543411, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 241.4219921940412, "num_env_steps_trained_throughput_per_sec": 241.4219921940412, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 2368000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2368000, "timers": {"training_iteration_time_ms": 33712.141, "restore_workers_time_ms": 0.028, "training_step_time_ms": 33711.873, "sample_time_ms": 1562.659, "learn_time_ms": 32122.212, "learn_throughput": 249.049, "synch_weights_time_ms": 22.371}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000}, "done": false, "training_iteration": 74, "trial_id": "cd905_00000", "date": "2024-08-20_10-04-33", "timestamp": 1724128473, "time_this_iter_s": 33.18932819366455, "time_total_s": 2429.7105605602264, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f7e9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2429.7105605602264, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 41.06304347826087, "ram_util_percent": 80.13913043478261}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1909219370711417, "cur_kl_coeff": 2.0116567611694334e-08, "cur_lr": 0.0001, "total_loss": 0.6240045234797493, "policy_loss": -0.0007318313436819211, "vf_loss": 0.6247363535657762, "vf_explained_var": 0.1551896063108293, "kl": 0.002367714064462685, "entropy": 1.4258497249512445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 46935.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.36022213141596504, "cur_kl_coeff": 4.0927261579781777e-13, "cur_lr": 0.0001, "total_loss": 0.12513122826164205, "policy_loss": -0.00016434285050583264, "vf_loss": 0.12529557089779586, "vf_explained_var": 0.0001091599464416504, "kl": 0.00046940659931892913, "entropy": 0.9781730807962872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 46935.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 132.19999999999845, "episode_reward_min": 12.606777794501994, "episode_reward_mean": 54.627926200473475, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -131.69876591651203, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 62.06561972121426, "predator_policy": 148.59876591651107}, "policy_reward_mean": {"prey_policy": 8.188635654280592, "predator_policy": 19.12532744595613}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.49999999999869, 34.800000000000225, 35.90000000000024, 38.300000000000274, 59.54173535821107, 66.75737040144384, 39.20000000000029, 46.7000000000004, 60.60000000000043, 80.69999999999932, 47.50000000000043, 39.20000000000029, 39.100000000000286, 36.200000000000244, 50.10000000000048, 39.40000000000029, 60.02265573877467, 50.00000000000047, 40.1000000000003, 38.400000000000276, 39.800000000000296, 36.84096061421653, 51.831299295995784, 63.60000000000048, 70.49999999999999, 38.859527040446395, 56.800000000000516, 90.09999999999857, 100.32586005266792, 40.0000000000003, 45.100000000000385, 61.300000000000495, 45.900000000000404, 90.99999999999858, 40.60000000000031, 37.50000000000026, 45.60000000000039, 110.89999999999839, 72.04476173418186, 44.10000000000037, 113.50043176972937, 48.40000000000044, 36.714135946131655, 42.47546299607767, 44.844309338906456, 44.00000000000036, 69.10000000000012, 60.90000000000039, 30.210618463588734, 33.591590879963036, 108.19999999999857, 61.04614053673677, 57.238688956170485, 58.300000000000466, 38.20000000000027, 56.50000000000044, 132.19999999999845, 38.90000000000028, 85.1999999999989, 47.40000000000042, 50.500000000000405, 88.1999999999987, 41.878637405408504, 50.30000000000039, 36.900000000000254, 37.10000000000026, 87.49999999999875, 57.30000000000049, 37.40000000000026, 38.80000000000028, 38.70000000000028, 50.50000000000046, 42.02032678950698, 36.900000000000254, 71.89999999999989, 50.30000000000046, 37.700000000000266, 54.80000000000044, 48.040701363954696, 39.60000000000029, 52.00000000000048, 68.60000000000015, 80.82754852058001, 53.50000000000051, 36.10000000000024, 54.44592029545027, 38.46565711493884, 57.700000000000514, 38.20000000000027, 12.606777794501994, 72.39999999999986, 72.19999999999987, 59.800000000000466, 73.49999999999977, 39.30000000000029, 45.09986072803699, 40.20000000000031, 58.461640911720465, 45.30000000000039, 81.09999999999923], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [60.37097099286921, 29.562041182953923, 1.409899374069462, -57.16699326530759, 10.414439864520784, -28.575451199112983, -8.687227079836553, 20.000000000000014, 39.623744674477976, -5.811750748254251, -2.6257048844726834, 30.800000000000196, 13.865416789896512, 14.785226820327923, -54.16726589258804, -9.850247431735678, -106.27514783206462, -15.044509667659682, 9.978048533389291, 24.652531212339042, -6.744049686138867, -6.6357403619301785, 15.154543484521223, 16.103616522319154, 15.673211418673688, 10.259100006213846, -97.80124772736156, 15.569896948891904, 25.234808184003843, 17.12131793647828, 20.000000000000014, 13.963196439641596, -1.1006009658759939, 35.80439908229988, 21.33964557957941, 20.000000000000014, 19.68643868262938, 11.808374201874651, 1.6931511490015938, 20.000000000000014, 20.000000000000014, 17.680324648973386, 16.067956195801337, 8.414988257854448, 27.28659030022968, -23.499983378381884, 35.479409036266574, -12.074039459196339, 45.87977030877473, 8.072103002213579, 21.559527040446152, -62.27804560464561, 36.188156800705215, 17.292782384042685, 29.836929146147778, 3.584397342445493, 44.8300614584452, 34.39948461830302, 20.000000000000014, 20.000000000000014, 15.453706556819514, 15.774771257467378, 41.490011105270995, -9.257952718133769, 7.922322176158639, -13.308936467773735, 15.83141742552053, 59.86125332188784, 20.900000000000027, 15.61902244614005, -24.67121545562953, 3.8012868407825975, 10.93332783576092, 24.500000000000085, 39.164995174578614, 59.80070877847201, 9.638756668494326, 24.071418102282916, -30.14816387970663, -3.237565080192617, 2.535117613782298, 13.390405286013362, -23.67635083020317, -42.789705915341926, -6.282515770221622, -5.21962481370106, 15.362310937372419, 13.437852820779536, -2.2992587323619516, -14.635262784128745, 18.887733082268316, 19.996862684431434, 37.76113559773401, 24.256895784982465, 30.90262028878879, 20.000000000000014, -8.059378823108894, -19.09616891105847, -9.468231660256226, -15.152756642395113, 20.455659482496777, 39.12167063126276, 17.71127618269608, -54.97291279564532, 10.162132746647496, -9.048506614508174, 7.153735824127262, -0.5492708331211748, -1.2177893956186292, 8.80055089172266, 19.037599897215827, 6.083537024747727, 62.06561972121426, 38.27966816255696, -5.244089414216372, 17.05755967740192, 59.562165875262096, 17.79386311793672, 22.115919141731744, 19.066712841222344, 17.681161037613514, 14.47250798869236, 21.33388323873614, 49.15596102295528, 10.000468815058463, 14.407564547603785, 19.430826119829465, 13.603707260117744, -131.69876591651203, 20.000000000000014, 13.14966905362062, -16.50830826402514, 32.89598002968249, 7.784364042999551, 6.340844585686586, 22.43346494391686, -5.081412587918358, -14.267567672287345, 15.79969358719928, 7.805780500434771, 12.200488785843257, 12.698687261802124, -2.535003727651555, -10.050216803244851, 12.990021513851291, 4.3608777966817325, -8.368737550345122, 1.4486080155514351, 20.000000000000014, 17.33470623629819, 16.106461050531404, 9.54449372488693, 11.950765291164242, -27.69634215377755, 1.6311366457267094, 2.852268870814475, 17.902859178257586, -46.56348651179976, 20.000000000000014, 15.48032066588089, -12.927077747537842, 20.000000000000014, 19.08864634099511, 12.699330501137226, 4.430095873030705, 51.52039483126668, 32.153164339388475, 10.021004816971189, -3.5780089771896786, -13.895862174706572, 17.34592029544979, 9.925321694320903, 15.119548131767708, -50.957161541430445, 32.54359201254761, 22.700000000000053, -0.3352304396951066, 16.63920204480402, -28.909721659757935, -78.17934053577392, 40.38085564819488, 20.000000000000014, -40.88687808383008, 36.469546453724504, 39.800000000000225, 20.000000000000014, 22.71143011389998, 21.914084157628537, 19.08678077026244, 10.55667392301306, 12.566649260169799, -25.91816960125327, 13.829918600559632, -12.133355831087206, 9.32681119289093, 15.43806253840199, 24.717421089431873, -14.338526657481298, 58.49364632194383, 19.74619262641689], "policy_predator_policy_reward": [2.6290290071309927, 1.9379588170462525, 38.94920696644422, 51.607886924793604, 34.86422610654422, 19.196785228048157, 26.987227079836682, 0.0, 0.817990683732841, 24.91175074825434, 11.360779431435544, 27.222295854480663, 5.734583210103452, 4.814773179672042, 8.766927581435054, 101.95058574288873, 126.21287249669453, 55.70678500302901, 17.12195146661068, 28.947468787661055, 25.044049686138962, 35.83574036193026, 5.24693480916554, 2.6949051839940115, 3.9267885813262757, 9.240899993786119, 59.75820285929511, 58.673147919173594, 5.1651918159962555, 2.5786820635216983, 0.0, 5.436803560358372, 20.700600965876006, 4.618256656474533, 8.660354420420624, 0.0, 3.3109829584133323, 5.294204157082615, 16.706848850998373, 0.0, 0.0, 2.119675351026598, 11.54949663335751, 0.8085195272029015, 3.801298669607815, 44.24339370454013, 9.220590963733653, 30.974039459196536, 1.0202296912254833, 15.527896997786389, 0.0, 79.57804560464476, 0.8118431992950395, 2.5072176159572948, 13.707833596521063, 42.97083991488583, 7.915946406321888, 13.18036756959985, 0.0, 0.0, 3.189163013847772, 10.682359171865258, 0.9099888947292479, 28.157952718133917, 39.13891685035231, 12.147697441262936, 3.8685825744794315, 11.438746678112349, 0.0, 4.080977553859913, 42.97121545562979, 15.398713159217367, 10.166672164239046, 0.0, 4.735004825421592, 7.199291221528194, 9.869919414753015, 28.464667548651796, 26.0404802912839, 51.44524866861564, 19.717310078040143, 77.85759879189511, 42.47635083020344, 72.38970591534215, 24.60395100638965, 23.612325523664587, 1.1857692652032619, 12.489529972722043, 30.697346086807016, 31.08148476859003, 1.0122669177316852, 4.103137315568583, 1.0388644022662437, 6.043104215017628, 9.997379711211387, 0.0, 0.8281377753253086, 56.538028422430955, 21.694912107115883, 36.51766707549869, 12.844340517503241, 35.77832936873741, 43.169471045995, 55.13830610369006, 40.44891412692129, 15.676148697109467, 12.146264175872703, 39.54927083312114, 20.31778939561865, 10.299449108277306, 18.066849969108926, 13.312013108927504, 19.534380278785903, 12.320331837443264, 23.23506354047329, 3.851466196341204, 5.837834124738073, 2.0061368820632643, 4.596035330118352, 1.6213326869276097, 13.218838962386455, 5.127492011307605, 2.0661167612638964, 15.644038977044897, 8.004041031257293, 9.46656301148857, 7.069173880170543, 10.196292739882203, 148.59876591651107, 0.0, 13.877635181034547, 26.581004029370188, 7.395224460855284, 39.42443146646282, 13.059155414313379, 15.466535056083194, 23.98141258791843, 32.767567672287576, 3.8003064128006825, 11.394219499565194, 7.199511214156708, 6.601312738197842, 24.181680054240662, 38.90354047665591, 9.930305275655329, 14.739122203318233, 25.844818230306682, 17.975311304487104, 0.0, 34.56529376370179, 4.6554848330822125, 19.99356039149938, 7.449234708835723, 45.99634215377781, 17.068863354273265, 33.2477311291855, 53.47639260831475, 23.224936089181927, 0.0, 4.119679334119074, 44.92707774753803, 0.0, 13.611353659004896, 23.20066949886275, 18.369904126969303, 6.507153689314269, 2.046835660611748, 9.278995183028776, 43.21869402160389, 10.355177130292574, 0.7309753585162372, 26.443702947162837, 69.55716154143032, 4.746108983170819, 2.4564079874526126, 0.0, 3.934897746285749, 17.96113064860531, 103.31476888996325, 16.38107110006986, 12.019144351805329, 0.0, 71.85349981924286, 4.7638318108631665, 0.0, 0.0, 22.38856988610009, 6.485915842371506, 0.8132192297375631, 8.843326076986905, 40.46246371360219, 17.988917355518105, 5.670081399440333, 32.8333558310874, 1.19117833942706, 32.50558884099995, 2.2825789105682146, 32.63852665748153, 1.8063536780563736, 1.0538073735831273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.891845570888159, "mean_inference_ms": 3.793849452831747, "mean_action_processing_ms": 1.9225051323066191, "mean_env_wait_ms": 1.1688515314292405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004051327705383301, "StateBufferConnector_ms": 0.02666449546813965, "ViewRequirementAgentConnector_ms": 0.12687969207763672}, "num_episodes": 8, "episode_return_max": 132.19999999999845, "episode_return_min": 12.606777794501994, "episode_return_mean": 54.627926200473475, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 240.2831807598223, "num_env_steps_trained_throughput_per_sec": 240.2831807598223, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 33715.0, "restore_workers_time_ms": 0.027, "training_step_time_ms": 33714.552, "sample_time_ms": 1540.537, "learn_time_ms": 32146.042, "learn_throughput": 248.864, "synch_weights_time_ms": 23.156}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": false, "training_iteration": 75, "trial_id": "cd905_00000", "date": "2024-08-20_10-05-06", "timestamp": 1724128506, "time_this_iter_s": 33.34290909767151, "time_total_s": 2463.053469657898, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a141ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2463.053469657898, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 42.62291666666667, "ram_util_percent": 79.94583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4683931718033458, "cur_kl_coeff": 1.0058283805847167e-08, "cur_lr": 0.0001, "total_loss": 1.4128807161535535, "policy_loss": -0.0011765905522874423, "vf_loss": 1.4140573070162819, "vf_explained_var": 0.09087131714063977, "kl": 0.008630169747173943, "entropy": 1.3734018386356415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 47565.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.404380507861811, "cur_kl_coeff": 2.0463630789890888e-13, "cur_lr": 0.0001, "total_loss": 0.6686070953096662, "policy_loss": -0.004718410646513341, "vf_loss": 0.6733255049538991, "vf_explained_var": 0.007855660574776786, "kl": 0.02932610904216571, "entropy": 0.9640731278866056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 47565.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000}, "env_runners": {"episode_reward_max": 90.6999999999986, "episode_reward_min": 12.606777794501994, "episode_reward_mean": 53.024428117436166, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -131.69876591651203, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 58.49364632194383, "predator_policy": 148.59876591651107}, "policy_reward_mean": {"prey_policy": 9.750393843025464, "predator_policy": 16.76182021569257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.900000000000254, 37.10000000000026, 87.49999999999875, 57.30000000000049, 37.40000000000026, 38.80000000000028, 38.70000000000028, 50.50000000000046, 42.02032678950698, 36.900000000000254, 71.89999999999989, 50.30000000000046, 37.700000000000266, 54.80000000000044, 48.040701363954696, 39.60000000000029, 52.00000000000048, 68.60000000000015, 80.82754852058001, 53.50000000000051, 36.10000000000024, 54.44592029545027, 38.46565711493884, 57.700000000000514, 38.20000000000027, 12.606777794501994, 72.39999999999986, 72.19999999999987, 59.800000000000466, 73.49999999999977, 39.30000000000029, 45.09986072803699, 40.20000000000031, 58.461640911720465, 45.30000000000039, 81.09999999999923, 37.50000000000026, 38.80000000000028, 58.80000000000049, 37.80000000000027, 68.8000000000001, 86.09999999999886, 79.19999999999939, 83.89999999999904, 53.500000000000504, 43.28716756904812, 70.89999999999999, 36.200000000000244, 37.82097106167263, 61.186937741185815, 39.32180804542048, 49.60000000000046, 74.19999999999975, 60.80000000000045, 39.700000000000294, 43.30000000000035, 38.60000000000028, 40.0535224031552, 38.300000000000274, 44.500000000000384, 39.100000000000286, 39.60000000000029, 88.6999999999987, 60.20000000000048, 52.800000000000495, 48.125323143800465, 57.100000000000506, 37.80000000000027, 67.30000000000024, 26.682879092128477, 42.50000000000035, 55.10000000000052, 56.682935421679005, 89.61511266332323, 38.70000000000028, 48.400000000000446, 63.49527530658061, 38.50000000000028, 42.70000000000035, 55.10000000000044, 63.60000000000044, 89.79999999999863, 58.54775839515974, 35.57964044652304, 56.700000000000514, 45.780824767566095, 56.200000000000486, 90.6999999999986, 70.50000000000003, 39.20000000000029, 67.40000000000022, 59.700000000000514, 38.50000000000028, 72.59999999999988, 45.79300769360858, 49.30000000000046, 56.800000000000445, 51.200000000000465, 55.601214474062466, 43.30000000000035], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-131.69876591651203, 20.000000000000014, 13.14966905362062, -16.50830826402514, 32.89598002968249, 7.784364042999551, 6.340844585686586, 22.43346494391686, -5.081412587918358, -14.267567672287345, 15.79969358719928, 7.805780500434771, 12.200488785843257, 12.698687261802124, -2.535003727651555, -10.050216803244851, 12.990021513851291, 4.3608777966817325, -8.368737550345122, 1.4486080155514351, 20.000000000000014, 17.33470623629819, 16.106461050531404, 9.54449372488693, 11.950765291164242, -27.69634215377755, 1.6311366457267094, 2.852268870814475, 17.902859178257586, -46.56348651179976, 20.000000000000014, 15.48032066588089, -12.927077747537842, 20.000000000000014, 19.08864634099511, 12.699330501137226, 4.430095873030705, 51.52039483126668, 32.153164339388475, 10.021004816971189, -3.5780089771896786, -13.895862174706572, 17.34592029544979, 9.925321694320903, 15.119548131767708, -50.957161541430445, 32.54359201254761, 22.700000000000053, -0.3352304396951066, 16.63920204480402, -28.909721659757935, -78.17934053577392, 40.38085564819488, 20.000000000000014, -40.88687808383008, 36.469546453724504, 39.800000000000225, 20.000000000000014, 22.71143011389998, 21.914084157628537, 19.08678077026244, 10.55667392301306, 12.566649260169799, -25.91816960125327, 13.829918600559632, -12.133355831087206, 9.32681119289093, 15.43806253840199, 24.717421089431873, -14.338526657481298, 58.49364632194383, 19.74619262641689, 3.8016927554986113, -6.418137536498868, 14.60554587525474, 0.41838896461916775, 28.78477076736038, -2.300165085507883, 1.63348970132056, 0.6766976992508124, 22.908131190253975, 11.27150829227464, 23.660335364877238, 30.922175801097133, 37.1728984862795, 18.401807771265517, 26.741889802997946, 37.59863969619653, 29.556282791322754, 8.844236827174177, -7.679588590774557, 18.842120797771585, 50.45046319708015, 1.0113384045813103, -5.97444590902901, -35.05409943187616, -1.131231684119491, -1.021208833166697, -28.49381715706525, 14.89697807390006, 20.000000000000014, -16.827354334684486, -3.4560361104569255, 19.33301369757981, 42.63841615802612, 0.3118948009743793, 0.9781172661137443, 36.01187653828403, 19.765776840037894, 6.649617443010477, 13.515873342214615, 13.22660624800446, 18.788903029602178, -2.9732568569076823, 19.153746527641175, 9.446189462641165, 20.000000000000014, -65.73002548781068, 9.52453406457584, 16.789491125677504, 17.576342571774457, -0.2553878917558663, 16.205481341976544, 18.914833480545173, 28.048064310780095, 18.0778577690483, 40.70000000000023, 14.88365342241, -28.506039491868165, 25.496616417850444, -24.561517934918925, 4.334576725111635, 7.102867502255101, 35.91342786652761, -3.7818989171530863, 9.691747640567435, 2.96772483430798, 44.22063267467973, -9.627520495472965, 2.8398370460620956, 2.597070899665829, -25.4690776601266, 17.193787533710168, 35.30000000000026, 10.979090762079528, -13.01276757536414, 18.833028295579993, 27.631116004514503, 4.425605226489063, 18.72101085799229, -1.6700537766200583, 20.000000000000014, 20.000000000000014, 13.231776295457829, 6.871072613051618, 8.921480674082616, -5.490686949979658, 15.989811870907369, -12.38877440264441, 20.000000000000014, 22.45034427243023, 32.55201659939942, 25.203566483540655, 56.00000000000022, 16.77769560406045, -9.377586661100876, -4.3292491007353195, 13.505489483769274, 37.10000000000026, 13.850079226293367, -0.18360917145497843, 7.928626364636665, 20.000000000000014, 6.209457982868383, 42.293737720531425, 24.220896742890726, 50.600000000000236, 19.173411986606286, 14.235427812998871, 15.624604660738079, 44.964549398886575, 15.081890647584531, 39.80000000000025, 18.92751372881167, 18.492395967458133, 0.07846969899723644, 31.34931898681253, 31.33723571181356, 4.423961018616689, 20.000000000000014, 21.98449270577401, 20.000000000000014, -66.57126438863283, 20.418108736875038, 16.47107766026874, 26.84014097700784, 9.474758284143796, 3.8138876873242387, -0.28733100654033983, -11.640829467712308], "policy_predator_policy_reward": [148.59876591651107, 0.0, 13.877635181034547, 26.581004029370188, 7.395224460855284, 39.42443146646282, 13.059155414313379, 15.466535056083194, 23.98141258791843, 32.767567672287576, 3.8003064128006825, 11.394219499565194, 7.199511214156708, 6.601312738197842, 24.181680054240662, 38.90354047665591, 9.930305275655329, 14.739122203318233, 25.844818230306682, 17.975311304487104, 0.0, 34.56529376370179, 4.6554848330822125, 19.99356039149938, 7.449234708835723, 45.99634215377781, 17.068863354273265, 33.2477311291855, 53.47639260831475, 23.224936089181927, 0.0, 4.119679334119074, 44.92707774753803, 0.0, 13.611353659004896, 23.20066949886275, 18.369904126969303, 6.507153689314269, 2.046835660611748, 9.278995183028776, 43.21869402160389, 10.355177130292574, 0.7309753585162372, 26.443702947162837, 69.55716154143032, 4.746108983170819, 2.4564079874526126, 0.0, 3.934897746285749, 17.96113064860531, 103.31476888996325, 16.38107110006986, 12.019144351805329, 0.0, 71.85349981924286, 4.7638318108631665, 0.0, 0.0, 22.38856988610009, 6.485915842371506, 0.8132192297375631, 8.843326076986905, 40.46246371360219, 17.988917355518105, 5.670081399440333, 32.8333558310874, 1.19117833942706, 32.50558884099995, 2.2825789105682146, 32.63852665748153, 1.8063536780563736, 1.0538073735831273, 15.198307244501354, 24.91813753649896, 4.894454124745227, 18.881611035380832, 11.215229232639786, 21.100165085507914, 17.56651029867942, 17.923302300749175, 26.69186880974611, 7.9284917077253265, 18.044970727959864, 13.472518106066035, 0.7271015137207557, 22.898192228734484, 15.858110197002185, 3.7013603038037086, 4.4437172086774215, 10.655763172825788, 1.0450467712761877, 31.07958859077467, 1.7495368029200835, 17.688661595418658, 58.71163041910963, 18.516914921795873, 20.37445398584732, 19.598957593111262, 5.5560270731258194, 69.22774975122495, 1.1480153221537912, 35.00114705795115, 8.357110462489565, 25.365911950387588, 7.261583841974106, 23.988105199025608, 17.821882733886238, 5.988123461716182, 1.0342231599621203, 12.25038255698949, 5.9841266577853505, 10.573393751995507, 1.1110969703978213, 21.67325685690772, 3.8470907498542894, 7.606495663018242, 0.0, 84.0300254878097, 14.474793419039443, 3.711181390707151, 2.2236574282255246, 19.555387891755846, 3.4945186580234227, 0.9851665194548287, 3.351935689220052, 39.22214223095169, 0.0, 4.616346577589966, 47.506039491868435, 8.303383582149662, 29.128452933344313, 39.22381142026321, 12.997132497744865, 1.086572133472637, 22.281898917153132, 9.60825235943253, 15.832275165691982, 4.279367325320502, 29.910243711188762, 3.5603188303506297, 64.350828677756, 1.0211780827049677, 2.6062124662898096, 0.0, 31.645476940976486, 27.071135293986785, 29.10281326891059, 14.048155094319656, 14.374394773510904, 1.1789891420077077, 30.07005377662006, 0.0, 20.403943917606966, 9.859555093515299, 12.228927386948348, 10.478519325917349, 7.044765753955052, 25.15610932511725, 47.48877440264459, 0.0, 1.0496557275698197, 7.547983400600785, 8.596433516459447, 0.0, 31.960704658089398, 19.186944794110378, 0.0, 26.403400063488874, 0.0, 5.749920773706599, 20.587927080017263, 17.4478804943667, 28.397542256103833, 1.592999761027765, 17.206262279468763, 6.979103257109358, 0.0, 0.726588013393718, 5.364572187001093, 3.9753953392618846, 2.7354506011136417, 4.618109352415433, 0.0, 0.9724862711883314, 1.4076040325418606, 18.521530301002755, 7.95068101318768, 1.9627642881866536, 9.426910925828256, 11.942135749163207, 7.315507294226032, 0.0, 82.27126438863193, 20.681891263125, 3.3289223397312284, 4.559859022992287, 20.574621825704025, 21.737946676889923, 24.88733100654034, 30.340829467712496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.905393621107547, "mean_inference_ms": 3.7972382395581055, "mean_action_processing_ms": 1.924143921474353, "mean_env_wait_ms": 1.1701378826598745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037935972213745117, "StateBufferConnector_ms": 0.017691969871520996, "ViewRequirementAgentConnector_ms": 0.12189114093780518}, "num_episodes": 64, "episode_return_max": 90.6999999999986, "episode_return_min": 12.606777794501994, "episode_return_mean": 53.024428117436166, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 238.21047272037487, "num_env_steps_trained_throughput_per_sec": 238.21047272037487, "timesteps_total": 608000, "num_env_steps_sampled_lifetime": 608000, "num_agent_steps_sampled_lifetime": 2432000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2432000, "timers": {"training_iteration_time_ms": 33719.453, "restore_workers_time_ms": 0.029, "training_step_time_ms": 33718.897, "sample_time_ms": 1553.085, "learn_time_ms": 32135.763, "learn_throughput": 248.944, "synch_weights_time_ms": 24.725}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000}, "done": false, "training_iteration": 76, "trial_id": "cd905_00000", "date": "2024-08-20_10-05-40", "timestamp": 1724128540, "time_this_iter_s": 33.64597296714783, "time_total_s": 2496.699442625046, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afbdca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2496.699442625046, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 40.22340425531915, "ram_util_percent": 80.30851063829788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1021589740401223, "cur_kl_coeff": 1.0058283805847167e-08, "cur_lr": 0.0001, "total_loss": 0.2915614211015285, "policy_loss": -0.00020696954572543738, "vf_loss": 0.2917683903127909, "vf_explained_var": 0.26059587881678625, "kl": 0.0006833569030757442, "entropy": 1.3658681790033975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3331038510870366, "cur_kl_coeff": 3.0695446184836325e-13, "cur_lr": 0.0001, "total_loss": 0.08522145246406869, "policy_loss": -0.0013412520843779758, "vf_loss": 0.08656270392091264, "vf_explained_var": -0.020959145303756473, "kl": 0.008522995170573094, "entropy": 0.917942239935436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000}, "env_runners": {"episode_reward_max": 102.69999999999823, "episode_reward_min": 12.606777794501994, "episode_reward_mean": 54.00442811743615, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -78.17934053577392, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 58.49364632194383, "predator_policy": 103.31476888996325}, "policy_reward_mean": {"prey_policy": 10.789416984390316, "predator_policy": 16.212797074327717}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.02032678950698, 36.900000000000254, 71.89999999999989, 50.30000000000046, 37.700000000000266, 54.80000000000044, 48.040701363954696, 39.60000000000029, 52.00000000000048, 68.60000000000015, 80.82754852058001, 53.50000000000051, 36.10000000000024, 54.44592029545027, 38.46565711493884, 57.700000000000514, 38.20000000000027, 12.606777794501994, 72.39999999999986, 72.19999999999987, 59.800000000000466, 73.49999999999977, 39.30000000000029, 45.09986072803699, 40.20000000000031, 58.461640911720465, 45.30000000000039, 81.09999999999923, 37.50000000000026, 38.80000000000028, 58.80000000000049, 37.80000000000027, 68.8000000000001, 86.09999999999886, 79.19999999999939, 83.89999999999904, 53.500000000000504, 43.28716756904812, 70.89999999999999, 36.200000000000244, 37.82097106167263, 61.186937741185815, 39.32180804542048, 49.60000000000046, 74.19999999999975, 60.80000000000045, 39.700000000000294, 43.30000000000035, 38.60000000000028, 40.0535224031552, 38.300000000000274, 44.500000000000384, 39.100000000000286, 39.60000000000029, 88.6999999999987, 60.20000000000048, 52.800000000000495, 48.125323143800465, 57.100000000000506, 37.80000000000027, 67.30000000000024, 26.682879092128477, 42.50000000000035, 55.10000000000052, 56.682935421679005, 89.61511266332323, 38.70000000000028, 48.400000000000446, 63.49527530658061, 38.50000000000028, 42.70000000000035, 55.10000000000044, 63.60000000000044, 89.79999999999863, 58.54775839515974, 35.57964044652304, 56.700000000000514, 45.780824767566095, 56.200000000000486, 90.6999999999986, 70.50000000000003, 39.20000000000029, 67.40000000000022, 59.700000000000514, 38.50000000000028, 72.59999999999988, 45.79300769360858, 49.30000000000046, 56.800000000000445, 51.200000000000465, 55.601214474062466, 43.30000000000035, 61.60000000000048, 73.09999999999981, 37.50000000000026, 36.900000000000254, 55.80000000000049, 52.800000000000516, 102.69999999999823, 61.80000000000048], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [12.990021513851291, 4.3608777966817325, -8.368737550345122, 1.4486080155514351, 20.000000000000014, 17.33470623629819, 16.106461050531404, 9.54449372488693, 11.950765291164242, -27.69634215377755, 1.6311366457267094, 2.852268870814475, 17.902859178257586, -46.56348651179976, 20.000000000000014, 15.48032066588089, -12.927077747537842, 20.000000000000014, 19.08864634099511, 12.699330501137226, 4.430095873030705, 51.52039483126668, 32.153164339388475, 10.021004816971189, -3.5780089771896786, -13.895862174706572, 17.34592029544979, 9.925321694320903, 15.119548131767708, -50.957161541430445, 32.54359201254761, 22.700000000000053, -0.3352304396951066, 16.63920204480402, -28.909721659757935, -78.17934053577392, 40.38085564819488, 20.000000000000014, -40.88687808383008, 36.469546453724504, 39.800000000000225, 20.000000000000014, 22.71143011389998, 21.914084157628537, 19.08678077026244, 10.55667392301306, 12.566649260169799, -25.91816960125327, 13.829918600559632, -12.133355831087206, 9.32681119289093, 15.43806253840199, 24.717421089431873, -14.338526657481298, 58.49364632194383, 19.74619262641689, 3.8016927554986113, -6.418137536498868, 14.60554587525474, 0.41838896461916775, 28.78477076736038, -2.300165085507883, 1.63348970132056, 0.6766976992508124, 22.908131190253975, 11.27150829227464, 23.660335364877238, 30.922175801097133, 37.1728984862795, 18.401807771265517, 26.741889802997946, 37.59863969619653, 29.556282791322754, 8.844236827174177, -7.679588590774557, 18.842120797771585, 50.45046319708015, 1.0113384045813103, -5.97444590902901, -35.05409943187616, -1.131231684119491, -1.021208833166697, -28.49381715706525, 14.89697807390006, 20.000000000000014, -16.827354334684486, -3.4560361104569255, 19.33301369757981, 42.63841615802612, 0.3118948009743793, 0.9781172661137443, 36.01187653828403, 19.765776840037894, 6.649617443010477, 13.515873342214615, 13.22660624800446, 18.788903029602178, -2.9732568569076823, 19.153746527641175, 9.446189462641165, 20.000000000000014, -65.73002548781068, 9.52453406457584, 16.789491125677504, 17.576342571774457, -0.2553878917558663, 16.205481341976544, 18.914833480545173, 28.048064310780095, 18.0778577690483, 40.70000000000023, 14.88365342241, -28.506039491868165, 25.496616417850444, -24.561517934918925, 4.334576725111635, 7.102867502255101, 35.91342786652761, -3.7818989171530863, 9.691747640567435, 2.96772483430798, 44.22063267467973, -9.627520495472965, 2.8398370460620956, 2.597070899665829, -25.4690776601266, 17.193787533710168, 35.30000000000026, 10.979090762079528, -13.01276757536414, 18.833028295579993, 27.631116004514503, 4.425605226489063, 18.72101085799229, -1.6700537766200583, 20.000000000000014, 20.000000000000014, 13.231776295457829, 6.871072613051618, 8.921480674082616, -5.490686949979658, 15.989811870907369, -12.38877440264441, 20.000000000000014, 22.45034427243023, 32.55201659939942, 25.203566483540655, 56.00000000000022, 16.77769560406045, -9.377586661100876, -4.3292491007353195, 13.505489483769274, 37.10000000000026, 13.850079226293367, -0.18360917145497843, 7.928626364636665, 20.000000000000014, 6.209457982868383, 42.293737720531425, 24.220896742890726, 50.600000000000236, 19.173411986606286, 14.235427812998871, 15.624604660738079, 44.964549398886575, 15.081890647584531, 39.80000000000025, 18.92751372881167, 18.492395967458133, 0.07846969899723644, 31.34931898681253, 31.33723571181356, 4.423961018616689, 20.000000000000014, 21.98449270577401, 20.000000000000014, -66.57126438863283, 20.418108736875038, 16.47107766026874, 26.84014097700784, 9.474758284143796, 3.8138876873242387, -0.28733100654033983, -11.640829467712308, 20.000000000000014, 30.010310789183066, 10.506193333187623, 32.136206506602704, 13.499329138717586, -53.846217399820176, -60.703428046288856, 11.213845764140718, 25.91340483591288, -7.238289968294779, 32.495962741616886, 5.908641331059362, 35.799900455641534, 45.01254158198763, 7.763651431583657, 30.30027359728687], "policy_predator_policy_reward": [9.930305275655329, 14.739122203318233, 25.844818230306682, 17.975311304487104, 0.0, 34.56529376370179, 4.6554848330822125, 19.99356039149938, 7.449234708835723, 45.99634215377781, 17.068863354273265, 33.2477311291855, 53.47639260831475, 23.224936089181927, 0.0, 4.119679334119074, 44.92707774753803, 0.0, 13.611353659004896, 23.20066949886275, 18.369904126969303, 6.507153689314269, 2.046835660611748, 9.278995183028776, 43.21869402160389, 10.355177130292574, 0.7309753585162372, 26.443702947162837, 69.55716154143032, 4.746108983170819, 2.4564079874526126, 0.0, 3.934897746285749, 17.96113064860531, 103.31476888996325, 16.38107110006986, 12.019144351805329, 0.0, 71.85349981924286, 4.7638318108631665, 0.0, 0.0, 22.38856988610009, 6.485915842371506, 0.8132192297375631, 8.843326076986905, 40.46246371360219, 17.988917355518105, 5.670081399440333, 32.8333558310874, 1.19117833942706, 32.50558884099995, 2.2825789105682146, 32.63852665748153, 1.8063536780563736, 1.0538073735831273, 15.198307244501354, 24.91813753649896, 4.894454124745227, 18.881611035380832, 11.215229232639786, 21.100165085507914, 17.56651029867942, 17.923302300749175, 26.69186880974611, 7.9284917077253265, 18.044970727959864, 13.472518106066035, 0.7271015137207557, 22.898192228734484, 15.858110197002185, 3.7013603038037086, 4.4437172086774215, 10.655763172825788, 1.0450467712761877, 31.07958859077467, 1.7495368029200835, 17.688661595418658, 58.71163041910963, 18.516914921795873, 20.37445398584732, 19.598957593111262, 5.5560270731258194, 69.22774975122495, 1.1480153221537912, 35.00114705795115, 8.357110462489565, 25.365911950387588, 7.261583841974106, 23.988105199025608, 17.821882733886238, 5.988123461716182, 1.0342231599621203, 12.25038255698949, 5.9841266577853505, 10.573393751995507, 1.1110969703978213, 21.67325685690772, 3.8470907498542894, 7.606495663018242, 0.0, 84.0300254878097, 14.474793419039443, 3.711181390707151, 2.2236574282255246, 19.555387891755846, 3.4945186580234227, 0.9851665194548287, 3.351935689220052, 39.22214223095169, 0.0, 4.616346577589966, 47.506039491868435, 8.303383582149662, 29.128452933344313, 39.22381142026321, 12.997132497744865, 1.086572133472637, 22.281898917153132, 9.60825235943253, 15.832275165691982, 4.279367325320502, 29.910243711188762, 3.5603188303506297, 64.350828677756, 1.0211780827049677, 2.6062124662898096, 0.0, 31.645476940976486, 27.071135293986785, 29.10281326891059, 14.048155094319656, 14.374394773510904, 1.1789891420077077, 30.07005377662006, 0.0, 20.403943917606966, 9.859555093515299, 12.228927386948348, 10.478519325917349, 7.044765753955052, 25.15610932511725, 47.48877440264459, 0.0, 1.0496557275698197, 7.547983400600785, 8.596433516459447, 0.0, 31.960704658089398, 19.186944794110378, 0.0, 26.403400063488874, 0.0, 5.749920773706599, 20.587927080017263, 17.4478804943667, 28.397542256103833, 1.592999761027765, 17.206262279468763, 6.979103257109358, 0.0, 0.726588013393718, 5.364572187001093, 3.9753953392618846, 2.7354506011136417, 4.618109352415433, 0.0, 0.9724862711883314, 1.4076040325418606, 18.521530301002755, 7.95068101318768, 1.9627642881866536, 9.426910925828256, 11.942135749163207, 7.315507294226032, 0.0, 82.27126438863193, 20.681891263125, 3.3289223397312284, 4.559859022992287, 20.574621825704025, 21.737946676889923, 24.88733100654034, 30.340829467712496, 11.589689210817122, 0.0, 1.143150966736361, 29.314449193473525, 25.058300414307453, 52.78858784679487, 18.84342373840717, 67.54615854374019, 10.586595164087237, 26.538289968294897, 0.9040372583833389, 13.491358668940602, 17.700099544358686, 4.187458418012604, 22.92146538554072, 0.8146095855889062]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.897410492209414, "mean_inference_ms": 3.8007205806990947, "mean_action_processing_ms": 1.9177985122121737, "mean_env_wait_ms": 1.1690784718959177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003748178482055664, "StateBufferConnector_ms": 0.016312241554260254, "ViewRequirementAgentConnector_ms": 0.11957287788391113}, "num_episodes": 8, "episode_return_max": 102.69999999999823, "episode_return_min": 12.606777794501994, "episode_return_mean": 54.00442811743615, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 241.7807823904923, "num_env_steps_trained_throughput_per_sec": 241.7807823904923, "timesteps_total": 616000, "num_env_steps_sampled_lifetime": 616000, "num_agent_steps_sampled_lifetime": 2464000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2464000, "timers": {"training_iteration_time_ms": 33667.704, "restore_workers_time_ms": 0.026, "training_step_time_ms": 33667.16, "sample_time_ms": 1560.067, "learn_time_ms": 32076.455, "learn_throughput": 249.404, "synch_weights_time_ms": 25.105}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000}, "done": false, "training_iteration": 77, "trial_id": "cd905_00000", "date": "2024-08-20_10-06-13", "timestamp": 1724128573, "time_this_iter_s": 33.11685395240784, "time_total_s": 2529.8162965774536, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a167040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2529.8162965774536, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 45.48936170212767, "ram_util_percent": 81.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5259393481035082, "cur_kl_coeff": 5.0291419029235835e-09, "cur_lr": 0.0001, "total_loss": 1.5274019188351102, "policy_loss": -0.0016121785987966827, "vf_loss": 1.5290140890885913, "vf_explained_var": 0.1503417457853045, "kl": 0.003982955390867054, "entropy": 1.384157651757437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 48825.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.36732588099345326, "cur_kl_coeff": 3.0695446184836325e-13, "cur_lr": 0.0001, "total_loss": 0.6075662719824958, "policy_loss": -0.0014653486450986258, "vf_loss": 0.6090316178779753, "vf_explained_var": 0.007515244351492987, "kl": 0.015142919046973435, "entropy": 0.8699152685347058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 48825.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000}, "env_runners": {"episode_reward_max": 106.75370114581662, "episode_reward_min": 33.821974580915345, "episode_reward_mean": 57.31455305950089, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -66.57126438863283, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 64.9139994439522, "predator_policy": 87.32890312197122}, "policy_reward_mean": {"prey_policy": 14.673741230274855, "predator_policy": 13.983535299475616}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.682935421679005, 89.61511266332323, 38.70000000000028, 48.400000000000446, 63.49527530658061, 38.50000000000028, 42.70000000000035, 55.10000000000044, 63.60000000000044, 89.79999999999863, 58.54775839515974, 35.57964044652304, 56.700000000000514, 45.780824767566095, 56.200000000000486, 90.6999999999986, 70.50000000000003, 39.20000000000029, 67.40000000000022, 59.700000000000514, 38.50000000000028, 72.59999999999988, 45.79300769360858, 49.30000000000046, 56.800000000000445, 51.200000000000465, 55.601214474062466, 43.30000000000035, 61.60000000000048, 73.09999999999981, 37.50000000000026, 36.900000000000254, 55.80000000000049, 52.800000000000516, 102.69999999999823, 61.80000000000048, 90.41230853971109, 84.68780202584021, 41.500000000000334, 50.60000000000048, 43.94908237929799, 51.70000000000049, 106.49999999999821, 39.800000000000296, 39.20000000000029, 76.59999999999957, 43.400000000000354, 56.300000000000516, 46.90000000000041, 53.900000000000496, 55.44720005501044, 59.40000000000044, 45.00000000000038, 53.40000000000042, 38.300000000000274, 52.524137479190465, 90.29999999999858, 38.300000000000274, 56.80000000000048, 38.00000000000027, 38.80000000000028, 41.200000000000315, 36.80000000000025, 65.80000000000034, 70.60000000000001, 38.80000000000028, 53.03705074743949, 38.00000000000027, 37.600000000000264, 33.821974580915345, 39.40000000000029, 48.60000000000045, 72.49999999999987, 92.69999999999843, 64.00000000000048, 69.10000000000012, 38.300000000000274, 38.20000000000027, 79.66314611658066, 99.66792807984854, 39.60000000000029, 70.00873241798713, 37.700000000000266, 38.10000000000027, 37.177785898822165, 35.81824573356215, 40.000000000000306, 89.39999999999863, 62.1000000000005, 88.79700463345473, 106.75370114581662, 42.800000000000345, 88.69999999999868, 52.240183147930914, 55.20000000000048, 78.29999999999944, 72.79999999999987, 75.99999999999962, 64.20000000000046, 44.05325380016915], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [10.979090762079528, -13.01276757536414, 18.833028295579993, 27.631116004514503, 4.425605226489063, 18.72101085799229, -1.6700537766200583, 20.000000000000014, 20.000000000000014, 13.231776295457829, 6.871072613051618, 8.921480674082616, -5.490686949979658, 15.989811870907369, -12.38877440264441, 20.000000000000014, 22.45034427243023, 32.55201659939942, 25.203566483540655, 56.00000000000022, 16.77769560406045, -9.377586661100876, -4.3292491007353195, 13.505489483769274, 37.10000000000026, 13.850079226293367, -0.18360917145497843, 7.928626364636665, 20.000000000000014, 6.209457982868383, 42.293737720531425, 24.220896742890726, 50.600000000000236, 19.173411986606286, 14.235427812998871, 15.624604660738079, 44.964549398886575, 15.081890647584531, 39.80000000000025, 18.92751372881167, 18.492395967458133, 0.07846969899723644, 31.34931898681253, 31.33723571181356, 4.423961018616689, 20.000000000000014, 21.98449270577401, 20.000000000000014, -66.57126438863283, 20.418108736875038, 16.47107766026874, 26.84014097700784, 9.474758284143796, 3.8138876873242387, -0.28733100654033983, -11.640829467712308, 20.000000000000014, 30.010310789183066, 10.506193333187623, 32.136206506602704, 13.499329138717586, -53.846217399820176, -60.703428046288856, 11.213845764140718, 25.91340483591288, -7.238289968294779, 32.495962741616886, 5.908641331059362, 35.799900455641534, 45.01254158198763, 7.763651431583657, 30.30027359728687, 32.584276555039764, 34.74246560387012, 29.136059189503143, 15.817274772327186, 20.000000000000014, 2.777386229463248, 7.329930945350847, 17.45006568221868, 13.847675733719177, 9.690619342520554, 26.139501093629907, 15.744003339574663, 47.90000000000024, 57.789051977614825, 20.000000000000014, 17.749289324844135, 0.5779717636238904, 16.363581462992745, 42.914970153990176, 12.771208555160154, 20.000000000000014, -24.397004624105854, -22.01462375745308, 38.000000000000256, -4.279816858012879, 16.882467521287488, 21.37372657976819, 3.8771453772333784, 3.714627877273012, -8.881874475058659, 18.061045406831536, 10.834162551325488, 18.905657283521318, 20.44085767436599, -9.010239075116228, 15.276352276421672, 4.004949206779072, 4.6769047077469725, -9.458069110781604, -14.382139935123194, 14.791004216132185, 61.65816897822123, 8.71170980726626, -2.750586600999355, -2.8559286403742536, 21.376030293667895, -7.201933218360846, 14.86373663790196, 11.601390643805413, 11.916076311883941, 14.438002673698888, 20.000000000000014, -31.31477141294203, 0.8390512353886169, 38.83865260949436, -6.528988951016254, 6.259525838002981, 51.500000000000234, 15.848840004380135, 11.506322469848158, 18.613649612559822, 15.80570947004405, 14.638629840216328, -11.680493326744482, -1.0377125973036074, -25.615892714412965, 11.842562490728366, -16.167099382882718, 13.801630437243071, 17.55623299286964, 25.386873269475295, 18.916168106314, 49.42220903674098, 15.581487802994122, 53.20826004037465, 36.20000000000024, 14.976077342367715, 34.390511687302514, 13.857157885658632, 46.418693385387535, -1.4992550090303274, 4.177670922824516, 0.43032766687365054, 11.664331540979711, 28.8717164467248, 33.14740512854798, 49.521643830961274, 38.601501229128864, 17.882726456946116, 17.51087661533368, 23.658776674215666, 1.1359920540410202, -38.91529547056738, -11.046505554712528, 4.206385207042638, -4.195258228125619, -0.05257171572063973, 9.415393431009711, 5.320932440722466, 13.568527390268795, 17.69451248566475, 10.171383154355363, 7.1869955984182265, 64.9139994439522, 39.62399848892652, 19.069396304830427, 31.792930444030585, 18.480864938615614, 47.410497936166905, 46.780268764950726, -9.022831008458539, -7.0111111590626045, 53.52229862882102, 26.69787489360102, -42.00921098935566, -28.86060153546596, 16.09332151873998, 0.85228046665063, 54.64380616048396, 19.039346535431964, 43.40000000000024, 22.650257218044118, 15.78593451346798, 49.18132291349727, 20.000000000000014, 23.184243171477775, 13.072928874597928, 11.830476264818808], "policy_predator_policy_reward": [31.645476940976486, 27.071135293986785, 29.10281326891059, 14.048155094319656, 14.374394773510904, 1.1789891420077077, 30.07005377662006, 0.0, 20.403943917606966, 9.859555093515299, 12.228927386948348, 10.478519325917349, 7.044765753955052, 25.15610932511725, 47.48877440264459, 0.0, 1.0496557275698197, 7.547983400600785, 8.596433516459447, 0.0, 31.960704658089398, 19.186944794110378, 0.0, 26.403400063488874, 0.0, 5.749920773706599, 20.587927080017263, 17.4478804943667, 28.397542256103833, 1.592999761027765, 17.206262279468763, 6.979103257109358, 0.0, 0.726588013393718, 5.364572187001093, 3.9753953392618846, 2.7354506011136417, 4.618109352415433, 0.0, 0.9724862711883314, 1.4076040325418606, 18.521530301002755, 7.95068101318768, 1.9627642881866536, 9.426910925828256, 11.942135749163207, 7.315507294226032, 0.0, 82.27126438863193, 20.681891263125, 3.3289223397312284, 4.559859022992287, 20.574621825704025, 21.737946676889923, 24.88733100654034, 30.340829467712496, 11.589689210817122, 0.0, 1.143150966736361, 29.314449193473525, 25.058300414307453, 52.78858784679487, 18.84342373840717, 67.54615854374019, 10.586595164087237, 26.538289968294897, 0.9040372583833389, 13.491358668940602, 17.700099544358686, 4.187458418012604, 22.92146538554072, 0.8146095855889062, 13.157534396130089, 9.928031984672986, 23.214936197686573, 16.519531866324463, 0.0, 18.72261377053675, 18.27006905464912, 7.549934317781304, 10.289380125616002, 10.121407177441831, 4.934264438603231, 4.882231128192282, 0.0, 0.8109480223853893, 0.0, 2.0507106751558504, 18.92202823637611, 3.336418537007221, 13.309565500203579, 7.604255790646273, 0.0, 47.797004624106116, 40.31462375745334, 0.0, 27.359402739416634, 6.937946597308785, 12.326273420231844, 16.322854622766588, 57.63775770221761, 2.9766889505780982, 0.0, 30.504792041842933, 0.9943427164786829, 4.6591423256340345, 13.070569192434993, 34.06331760625961, 15.195050793220894, 14.423095292252993, 36.57016035304199, 39.794186172053166, 4.70899578386778, 9.141831021778968, 8.627563244602015, 23.711313549131088, 21.755928640374293, 16.52396970633214, 0.0, 30.338196580458952, 7.798609356194552, 7.4839236881160245, 0.0, 6.76199732630108, 49.214771412942284, 18.06094876461137, 8.361347390505864, 25.12898895101635, 12.840474161996985, 0.0, 3.751159995619828, 7.693677530151808, 2.9234011348791733, 15.69429052995591, 4.961370159783636, 30.080493326744666, 17.080026671505728, 47.17357864021112, 35.88138731048379, 2.26512416258591, 5.798369562756893, 2.243767007130346, 3.3131267305248095, 0.9838318936860007, 1.0677912572346273, 6.42851190303046, 3.2917399596255765, 0.0, 4.523922657632251, 10.10948831269772, 5.842842114341332, 2.9813066146126976, 20.49925500903035, 15.122329077175449, 18.369672333126342, 7.735668459020253, 12.084780243060974, 5.5592442982479415, 6.078397691637066, 5.466385328123419, 1.9172735430538725, 2.289123384666306, 10.412528854518355, 34.801434835212085, 4.022337126791647, 83.63946389848867, 14.793614792957328, 23.29525822812568, 2.1364183430435153, 25.678545840489274, 15.10804681083675, 1.8207390917338322, 2.033356484864901, 10.100747875114935, 12.213004401581738, 5.08600055604791, 2.5760015110737284, 0.830603695169578, 34.212336471695814, 4.310872779114272, 2.043203209651697, 10.519731235049484, 23.473977213502437, 35.359964954018935, 3.8777013711791817, 4.602125106399104, 87.32890312197122, 35.78109255078136, 10.952271961325474, 27.302126053283853, 3.756193839516252, 0.8606534645680388, 0.0, 6.749742781955936, 3.814065486531984, 7.218677086502946, 0.0, 21.0157568285223, 14.68931999827631, 4.460528662475676]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.913751689900871, "mean_inference_ms": 3.8063694529109524, "mean_action_processing_ms": 1.9201520324654728, "mean_env_wait_ms": 1.171878131953272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00397944450378418, "StateBufferConnector_ms": 0.01652979850769043, "ViewRequirementAgentConnector_ms": 0.11795938014984131}, "num_episodes": 64, "episode_return_max": 106.75370114581662, "episode_return_min": 33.821974580915345, "episode_return_mean": 57.31455305950089, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 242.76714752064345, "num_env_steps_trained_throughput_per_sec": 242.76714752064345, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 2496000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2496000, "timers": {"training_iteration_time_ms": 33639.938, "restore_workers_time_ms": 0.026, "training_step_time_ms": 33639.384, "sample_time_ms": 1550.346, "learn_time_ms": 32057.02, "learn_throughput": 249.555, "synch_weights_time_ms": 26.301}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000}, "done": false, "training_iteration": 78, "trial_id": "cd905_00000", "date": "2024-08-20_10-06-46", "timestamp": 1724128606, "time_this_iter_s": 32.975914001464844, "time_total_s": 2562.7922105789185, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afbd5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2562.7922105789185, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 37.204255319148935, "ram_util_percent": 74.61914893617022}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9304243157898623, "cur_kl_coeff": 2.5145709514617917e-09, "cur_lr": 0.0001, "total_loss": 0.25528159703290654, "policy_loss": -0.002275092613380698, "vf_loss": 0.2575566882770213, "vf_explained_var": 0.1972431597255525, "kl": 0.006300773102964827, "entropy": 1.4165596517305525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 49455.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.29336971218682945, "cur_kl_coeff": 3.0695446184836325e-13, "cur_lr": 0.0001, "total_loss": 0.08595416544241802, "policy_loss": -0.00203384830771635, "vf_loss": 0.08798801282906742, "vf_explained_var": 0.035159114618150016, "kl": 0.016625743109427046, "entropy": 0.7904724666050502, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 49455.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000}, "env_runners": {"episode_reward_max": 106.75370114581662, "episode_reward_min": 33.821974580915345, "episode_reward_mean": 57.3689543853567, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -66.57126438863283, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 64.9139994439522, "predator_policy": 87.32890312197122}, "policy_reward_mean": {"prey_policy": 14.754408661131755, "predator_policy": 13.930068531546619}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.60000000000044, 89.79999999999863, 58.54775839515974, 35.57964044652304, 56.700000000000514, 45.780824767566095, 56.200000000000486, 90.6999999999986, 70.50000000000003, 39.20000000000029, 67.40000000000022, 59.700000000000514, 38.50000000000028, 72.59999999999988, 45.79300769360858, 49.30000000000046, 56.800000000000445, 51.200000000000465, 55.601214474062466, 43.30000000000035, 61.60000000000048, 73.09999999999981, 37.50000000000026, 36.900000000000254, 55.80000000000049, 52.800000000000516, 102.69999999999823, 61.80000000000048, 90.41230853971109, 84.68780202584021, 41.500000000000334, 50.60000000000048, 43.94908237929799, 51.70000000000049, 106.49999999999821, 39.800000000000296, 39.20000000000029, 76.59999999999957, 43.400000000000354, 56.300000000000516, 46.90000000000041, 53.900000000000496, 55.44720005501044, 59.40000000000044, 45.00000000000038, 53.40000000000042, 38.300000000000274, 52.524137479190465, 90.29999999999858, 38.300000000000274, 56.80000000000048, 38.00000000000027, 38.80000000000028, 41.200000000000315, 36.80000000000025, 65.80000000000034, 70.60000000000001, 38.80000000000028, 53.03705074743949, 38.00000000000027, 37.600000000000264, 33.821974580915345, 39.40000000000029, 48.60000000000045, 72.49999999999987, 92.69999999999843, 64.00000000000048, 69.10000000000012, 38.300000000000274, 38.20000000000027, 79.66314611658066, 99.66792807984854, 39.60000000000029, 70.00873241798713, 37.700000000000266, 38.10000000000027, 37.177785898822165, 35.81824573356215, 40.000000000000306, 89.39999999999863, 62.1000000000005, 88.79700463345473, 106.75370114581662, 42.800000000000345, 88.69999999999868, 52.240183147930914, 55.20000000000048, 78.29999999999944, 72.79999999999987, 75.99999999999962, 64.20000000000046, 44.05325380016915, 49.400000000000425, 48.149719412914806, 45.9000000000004, 81.19999999999924, 42.20000000000033, 62.5000000000005, 53.28373656425003, 56.000000000000504], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [22.45034427243023, 32.55201659939942, 25.203566483540655, 56.00000000000022, 16.77769560406045, -9.377586661100876, -4.3292491007353195, 13.505489483769274, 37.10000000000026, 13.850079226293367, -0.18360917145497843, 7.928626364636665, 20.000000000000014, 6.209457982868383, 42.293737720531425, 24.220896742890726, 50.600000000000236, 19.173411986606286, 14.235427812998871, 15.624604660738079, 44.964549398886575, 15.081890647584531, 39.80000000000025, 18.92751372881167, 18.492395967458133, 0.07846969899723644, 31.34931898681253, 31.33723571181356, 4.423961018616689, 20.000000000000014, 21.98449270577401, 20.000000000000014, -66.57126438863283, 20.418108736875038, 16.47107766026874, 26.84014097700784, 9.474758284143796, 3.8138876873242387, -0.28733100654033983, -11.640829467712308, 20.000000000000014, 30.010310789183066, 10.506193333187623, 32.136206506602704, 13.499329138717586, -53.846217399820176, -60.703428046288856, 11.213845764140718, 25.91340483591288, -7.238289968294779, 32.495962741616886, 5.908641331059362, 35.799900455641534, 45.01254158198763, 7.763651431583657, 30.30027359728687, 32.584276555039764, 34.74246560387012, 29.136059189503143, 15.817274772327186, 20.000000000000014, 2.777386229463248, 7.329930945350847, 17.45006568221868, 13.847675733719177, 9.690619342520554, 26.139501093629907, 15.744003339574663, 47.90000000000024, 57.789051977614825, 20.000000000000014, 17.749289324844135, 0.5779717636238904, 16.363581462992745, 42.914970153990176, 12.771208555160154, 20.000000000000014, -24.397004624105854, -22.01462375745308, 38.000000000000256, -4.279816858012879, 16.882467521287488, 21.37372657976819, 3.8771453772333784, 3.714627877273012, -8.881874475058659, 18.061045406831536, 10.834162551325488, 18.905657283521318, 20.44085767436599, -9.010239075116228, 15.276352276421672, 4.004949206779072, 4.6769047077469725, -9.458069110781604, -14.382139935123194, 14.791004216132185, 61.65816897822123, 8.71170980726626, -2.750586600999355, -2.8559286403742536, 21.376030293667895, -7.201933218360846, 14.86373663790196, 11.601390643805413, 11.916076311883941, 14.438002673698888, 20.000000000000014, -31.31477141294203, 0.8390512353886169, 38.83865260949436, -6.528988951016254, 6.259525838002981, 51.500000000000234, 15.848840004380135, 11.506322469848158, 18.613649612559822, 15.80570947004405, 14.638629840216328, -11.680493326744482, -1.0377125973036074, -25.615892714412965, 11.842562490728366, -16.167099382882718, 13.801630437243071, 17.55623299286964, 25.386873269475295, 18.916168106314, 49.42220903674098, 15.581487802994122, 53.20826004037465, 36.20000000000024, 14.976077342367715, 34.390511687302514, 13.857157885658632, 46.418693385387535, -1.4992550090303274, 4.177670922824516, 0.43032766687365054, 11.664331540979711, 28.8717164467248, 33.14740512854798, 49.521643830961274, 38.601501229128864, 17.882726456946116, 17.51087661533368, 23.658776674215666, 1.1359920540410202, -38.91529547056738, -11.046505554712528, 4.206385207042638, -4.195258228125619, -0.05257171572063973, 9.415393431009711, 5.320932440722466, 13.568527390268795, 17.69451248566475, 10.171383154355363, 7.1869955984182265, 64.9139994439522, 39.62399848892652, 19.069396304830427, 31.792930444030585, 18.480864938615614, 47.410497936166905, 46.780268764950726, -9.022831008458539, -7.0111111590626045, 53.52229862882102, 26.69787489360102, -42.00921098935566, -28.86060153546596, 16.09332151873998, 0.85228046665063, 54.64380616048396, 19.039346535431964, 43.40000000000024, 22.650257218044118, 15.78593451346798, 49.18132291349727, 20.000000000000014, 23.184243171477775, 13.072928874597928, 11.830476264818808, -37.15983117072218, 12.9565657486608, -8.823846686068947, -10.647316479383075, 16.997827244618897, 2.961064553841617, 11.156445076859677, 57.78867494642317, 21.562807472445385, 10.199993942598116, 23.312508608569658, -4.384831833375225, 26.300000000000114, 5.20898325142149, 7.141873405572657, 34.60427798546446], "policy_predator_policy_reward": [1.0496557275698197, 7.547983400600785, 8.596433516459447, 0.0, 31.960704658089398, 19.186944794110378, 0.0, 26.403400063488874, 0.0, 5.749920773706599, 20.587927080017263, 17.4478804943667, 28.397542256103833, 1.592999761027765, 17.206262279468763, 6.979103257109358, 0.0, 0.726588013393718, 5.364572187001093, 3.9753953392618846, 2.7354506011136417, 4.618109352415433, 0.0, 0.9724862711883314, 1.4076040325418606, 18.521530301002755, 7.95068101318768, 1.9627642881866536, 9.426910925828256, 11.942135749163207, 7.315507294226032, 0.0, 82.27126438863193, 20.681891263125, 3.3289223397312284, 4.559859022992287, 20.574621825704025, 21.737946676889923, 24.88733100654034, 30.340829467712496, 11.589689210817122, 0.0, 1.143150966736361, 29.314449193473525, 25.058300414307453, 52.78858784679487, 18.84342373840717, 67.54615854374019, 10.586595164087237, 26.538289968294897, 0.9040372583833389, 13.491358668940602, 17.700099544358686, 4.187458418012604, 22.92146538554072, 0.8146095855889062, 13.157534396130089, 9.928031984672986, 23.214936197686573, 16.519531866324463, 0.0, 18.72261377053675, 18.27006905464912, 7.549934317781304, 10.289380125616002, 10.121407177441831, 4.934264438603231, 4.882231128192282, 0.0, 0.8109480223853893, 0.0, 2.0507106751558504, 18.92202823637611, 3.336418537007221, 13.309565500203579, 7.604255790646273, 0.0, 47.797004624106116, 40.31462375745334, 0.0, 27.359402739416634, 6.937946597308785, 12.326273420231844, 16.322854622766588, 57.63775770221761, 2.9766889505780982, 0.0, 30.504792041842933, 0.9943427164786829, 4.6591423256340345, 13.070569192434993, 34.06331760625961, 15.195050793220894, 14.423095292252993, 36.57016035304199, 39.794186172053166, 4.70899578386778, 9.141831021778968, 8.627563244602015, 23.711313549131088, 21.755928640374293, 16.52396970633214, 0.0, 30.338196580458952, 7.798609356194552, 7.4839236881160245, 0.0, 6.76199732630108, 49.214771412942284, 18.06094876461137, 8.361347390505864, 25.12898895101635, 12.840474161996985, 0.0, 3.751159995619828, 7.693677530151808, 2.9234011348791733, 15.69429052995591, 4.961370159783636, 30.080493326744666, 17.080026671505728, 47.17357864021112, 35.88138731048379, 2.26512416258591, 5.798369562756893, 2.243767007130346, 3.3131267305248095, 0.9838318936860007, 1.0677912572346273, 6.42851190303046, 3.2917399596255765, 0.0, 4.523922657632251, 10.10948831269772, 5.842842114341332, 2.9813066146126976, 20.49925500903035, 15.122329077175449, 18.369672333126342, 7.735668459020253, 12.084780243060974, 5.5592442982479415, 6.078397691637066, 5.466385328123419, 1.9172735430538725, 2.289123384666306, 10.412528854518355, 34.801434835212085, 4.022337126791647, 83.63946389848867, 14.793614792957328, 23.29525822812568, 2.1364183430435153, 25.678545840489274, 15.10804681083675, 1.8207390917338322, 2.033356484864901, 10.100747875114935, 12.213004401581738, 5.08600055604791, 2.5760015110737284, 0.830603695169578, 34.212336471695814, 4.310872779114272, 2.043203209651697, 10.519731235049484, 23.473977213502437, 35.359964954018935, 3.8777013711791817, 4.602125106399104, 87.32890312197122, 35.78109255078136, 10.952271961325474, 27.302126053283853, 3.756193839516252, 0.8606534645680388, 0.0, 6.749742781955936, 3.814065486531984, 7.218677086502946, 0.0, 21.0157568285223, 14.68931999827631, 4.460528662475676, 28.80270400024278, 44.800561421818756, 39.29286518440545, 28.328017393961247, 10.002172755381077, 15.938935446158345, 8.143554923140288, 4.1113250535770325, 1.0371925275546523, 9.400006057401848, 12.18749139143041, 31.384831833375273, 10.837477874993953, 10.937275437834028, 11.95812659442731, 2.295722014535788]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.904678735511812, "mean_inference_ms": 3.809441349811979, "mean_action_processing_ms": 1.9139393283382933, "mean_env_wait_ms": 1.1707389849137617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405275821685791, "StateBufferConnector_ms": 0.016311049461364746, "ViewRequirementAgentConnector_ms": 0.11629939079284668}, "num_episodes": 8, "episode_return_max": 106.75370114581662, "episode_return_min": 33.821974580915345, "episode_return_mean": 57.3689543853567, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 248.19062054644976, "num_env_steps_trained_throughput_per_sec": 248.19062054644976, "timesteps_total": 632000, "num_env_steps_sampled_lifetime": 632000, "num_agent_steps_sampled_lifetime": 2528000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2528000, "timers": {"training_iteration_time_ms": 33490.253, "restore_workers_time_ms": 0.029, "training_step_time_ms": 33489.713, "sample_time_ms": 1530.96, "learn_time_ms": 31928.099, "learn_throughput": 250.563, "synch_weights_time_ms": 25.222}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000}, "done": false, "training_iteration": 79, "trial_id": "cd905_00000", "date": "2024-08-20_10-07-18", "timestamp": 1724128638, "time_this_iter_s": 32.24026393890381, "time_total_s": 2595.0324745178223, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a1410d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2595.0324745178223, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 32.255555555555546, "ram_util_percent": 72.44444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4541966627987604, "cur_kl_coeff": 2.5145709514617917e-09, "cur_lr": 0.0001, "total_loss": 2.278012451671419, "policy_loss": -0.0008890144881748018, "vf_loss": 2.2789014668691725, "vf_explained_var": 0.05076656776761252, "kl": 0.008533397670931114, "entropy": 1.3769194903827848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.37711292604605356, "cur_kl_coeff": 3.0695446184836325e-13, "cur_lr": 0.0001, "total_loss": 1.0118805374417985, "policy_loss": -0.0017513953271277604, "vf_loss": 1.0136319363874102, "vf_explained_var": 0.004957573281394111, "kl": 0.008572725530000984, "entropy": 0.6917191615180364, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "env_runners": {"episode_reward_max": 139.19816143398782, "episode_reward_min": 28.650296406828048, "episode_reward_mean": 61.43765817833987, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.31182198422034, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 91.09809371745888, "predator_policy": 91.24266963118286}, "policy_reward_mean": {"prey_policy": 17.12464233993434, "predator_policy": 13.59418674923569}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.49999999999987, 92.69999999999843, 64.00000000000048, 69.10000000000012, 38.300000000000274, 38.20000000000027, 79.66314611658066, 99.66792807984854, 39.60000000000029, 70.00873241798713, 37.700000000000266, 38.10000000000027, 37.177785898822165, 35.81824573356215, 40.000000000000306, 89.39999999999863, 62.1000000000005, 88.79700463345473, 106.75370114581662, 42.800000000000345, 88.69999999999868, 52.240183147930914, 55.20000000000048, 78.29999999999944, 72.79999999999987, 75.99999999999962, 64.20000000000046, 44.05325380016915, 49.400000000000425, 48.149719412914806, 45.9000000000004, 81.19999999999924, 42.20000000000033, 62.5000000000005, 53.28373656425003, 56.000000000000504, 28.650296406828048, 39.30000000000029, 55.400000000000425, 37.90000000000027, 45.9264482472501, 79.29999999999939, 62.50000000000042, 75.64655976710141, 47.400000000000425, 60.300000000000495, 39.20000000000029, 99.39999999999833, 48.00000000000044, 51.7000000000005, 62.84161837487896, 61.1000000000005, 62.000000000000504, 51.400000000000496, 38.90000000000028, 49.600000000000456, 70.0, 87.09999999999884, 106.32392944544905, 38.00000000000027, 58.20000000000046, 29.68150883815397, 78.99999999999939, 61.2000000000005, 44.9000000000004, 45.40000000000039, 85.59999999999893, 40.0000000000003, 36.200000000000244, 74.39999999999976, 84.58066466564914, 39.000000000000284, 64.40000000000043, 139.19816143398782, 70.89999999999999, 40.90000000000032, 39.100000000000286, 74.51183362309588, 60.8000000000005, 93.39999999999874, 67.20000000000026, 75.29999999999966, 72.49999999999989, 39.000000000000284, 38.70000000000028, 58.20000000000046, 88.89999999999874, 75.6999999999996, 57.40000000000051, 63.20000000000048, 39.30000000000029, 38.00000000000027, 75.39106075010716, 106.20029933014453, 65.2000000000004, 38.400000000000276, 39.50000000000029, 69.2000000000001, 64.70000000000044, 99.9999999999983], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [49.42220903674098, 15.581487802994122, 53.20826004037465, 36.20000000000024, 14.976077342367715, 34.390511687302514, 13.857157885658632, 46.418693385387535, -1.4992550090303274, 4.177670922824516, 0.43032766687365054, 11.664331540979711, 28.8717164467248, 33.14740512854798, 49.521643830961274, 38.601501229128864, 17.882726456946116, 17.51087661533368, 23.658776674215666, 1.1359920540410202, -38.91529547056738, -11.046505554712528, 4.206385207042638, -4.195258228125619, -0.05257171572063973, 9.415393431009711, 5.320932440722466, 13.568527390268795, 17.69451248566475, 10.171383154355363, 7.1869955984182265, 64.9139994439522, 39.62399848892652, 19.069396304830427, 31.792930444030585, 18.480864938615614, 47.410497936166905, 46.780268764950726, -9.022831008458539, -7.0111111590626045, 53.52229862882102, 26.69787489360102, -42.00921098935566, -28.86060153546596, 16.09332151873998, 0.85228046665063, 54.64380616048396, 19.039346535431964, 43.40000000000024, 22.650257218044118, 15.78593451346798, 49.18132291349727, 20.000000000000014, 23.184243171477775, 13.072928874597928, 11.830476264818808, -37.15983117072218, 12.9565657486608, -8.823846686068947, -10.647316479383075, 16.997827244618897, 2.961064553841617, 11.156445076859677, 57.78867494642317, 21.562807472445385, 10.199993942598116, 23.312508608569658, -4.384831833375225, 26.300000000000114, 5.20898325142149, 7.141873405572657, 34.60427798546446, -0.8338667355412961, -29.286224950976823, 3.17601757237945, 11.140800174865156, -56.31182198422034, 15.187682544288586, -12.500923917316834, 4.868043237637414, 8.318291366731149, -0.680320528923104, 59.60000000000022, 16.221224436371532, -3.7242856167813625, 18.862146695344634, 24.019170590496877, 36.596082744626756, 5.866200052032752, 18.826622932567865, 41.60000000000024, -5.248010530098764, 17.793789002827122, 2.561446093108595, 37.07289969281938, 33.56644562489975, 19.24914387616383, -1.13777878943085, 12.212596130495578, 25.876353207833983, 13.94569948003058, 18.65544225094421, 33.60607347275681, 18.953024444765532, 12.251456939908847, 42.50000000000025, 30.098438245966065, 17.429718448497848, 2.806387221868354, 18.82147343798637, 18.347505040155127, 27.171511156628338, 20.000000000000014, 22.640093700604005, 38.000000000000256, 39.99695315908459, 37.48090533761586, 39.03990438323347, -6.889457154525353, 19.131694243373147, -2.2187845917943205, 5.885700291241813, -6.573074222324271, 1.1295039593578442, 24.396441297075988, 34.98827625490268, 36.99204950148195, 9.966927812117602, -7.6421256199888035, 14.9935373466457, -11.053553818659086, 19.371567734234997, 64.41743806490815, 6.280723404082597, 20.000000000000014, 20.000000000000014, -26.600199389319698, -51.08700706100913, 39.664428908152566, 12.39269906677968, 56.511350751475085, 4.358491172017359, 17.141652793213183, 7.495351998063498, 23.667799298432946, 5.864454749224409, 26.106653990202748, 91.09809371745888, 15.182596961294234, 48.909338360529595, 20.000000000000014, 2.710751845265196, 20.000000000000014, -24.16414519896547, 28.00808158229273, 36.911833623096385, 19.688459635657, 29.420118847705073, -14.337212725108758, 36.906571661123934, 12.846069846997835, 33.43749401299077, 44.27994675901243, 7.146708759511075, 11.715156403725805, 51.500000000000234, 18.791157298803306, 9.810235804321012, 18.958688283921628, -0.31274327065535734, 6.451594920508448, 20.000000000000014, 5.744875772201137, 51.58804266681411, 11.3629651771804, 28.51172597669409, 15.565989839744493, 35.65525403944006, 12.758134706066615, 15.622477523348739, 17.217819583677507, 13.306741752194226, -1.3044522239141334, 16.98951758082635, 4.26788549962337, 22.726491720665408, 29.030999979171536, 30.04879679348667, 32.23246091783649, 13.347007237608262, 15.155942398686932, -12.602292695800536, 20.000000000000014, 10.916009430360765, 44.50096860636943, -13.449962152996726, 40.83486322212601, 8.160355494161253, 38.17400881656018, 37.468094441219186], "policy_predator_policy_reward": [1.0677912572346273, 6.42851190303046, 3.2917399596255765, 0.0, 4.523922657632251, 10.10948831269772, 5.842842114341332, 2.9813066146126976, 20.49925500903035, 15.122329077175449, 18.369672333126342, 7.735668459020253, 12.084780243060974, 5.5592442982479415, 6.078397691637066, 5.466385328123419, 1.9172735430538725, 2.289123384666306, 10.412528854518355, 34.801434835212085, 4.022337126791647, 83.63946389848867, 14.793614792957328, 23.29525822812568, 2.1364183430435153, 25.678545840489274, 15.10804681083675, 1.8207390917338322, 2.033356484864901, 10.100747875114935, 12.213004401581738, 5.08600055604791, 2.5760015110737284, 0.830603695169578, 34.212336471695814, 4.310872779114272, 2.043203209651697, 10.519731235049484, 23.473977213502437, 35.359964954018935, 3.8777013711791817, 4.602125106399104, 87.32890312197122, 35.78109255078136, 10.952271961325474, 27.302126053283853, 3.756193839516252, 0.8606534645680388, 0.0, 6.749742781955936, 3.814065486531984, 7.218677086502946, 0.0, 21.0157568285223, 14.68931999827631, 4.460528662475676, 28.80270400024278, 44.800561421818756, 39.29286518440545, 28.328017393961247, 10.002172755381077, 15.938935446158345, 8.143554923140288, 4.1113250535770325, 1.0371925275546523, 9.400006057401848, 12.18749139143041, 31.384831833375273, 10.837477874993953, 10.937275437834028, 11.95812659442731, 2.295722014535788, 33.99567394441232, 24.774714148934, 15.723982427620513, 9.259199825134809, 91.24266963118286, 5.2814698087485485, 31.100923917317036, 14.431956762362551, 14.91269893480545, 23.37577847463618, 0.0, 3.4787755636284348, 9.663629091701864, 37.69850982973486, 3.4356339890682444, 11.595672442910194, 20.686927408034926, 2.020249607364424, 0.0, 23.948010530098838, 2.0062109971728628, 16.838553906891377, 11.727100307180844, 17.03355437510046, 9.950856123836168, 19.937778789430865, 7.287403869504387, 6.323646792166129, 12.811449713904171, 17.42902692999948, 7.593926527243429, 0.9469755552344694, 7.248543060091118, 0.0, 1.5015617540341204, 2.370281551502133, 16.19361277813161, 1.078526562013632, 3.252494959844867, 0.8284888433717934, 27.359906299396066, 0.0, 5.562400303111609, 3.540646537804027, 18.440383001509876, 11.362736723092, 4.540723707546611, 21.21703920360569, 21.318784591794355, 33.21429970875817, 0.0, 35.12507910112031, 19.615282448021624, 0.0, 0.0, 14.241022686400653, 8.71194810633101, 28.836640167012135, 30.811314748330854, 6.27067133609342, 2.1825619350920213, 12.71927659591737, 0.0, 0.0, 45.10019938931996, 68.78700706100905, 5.235571091847676, 17.107300933220287, 1.169313914175253, 22.54150882798261, 2.5583472067867934, 11.804648001936467, 21.932200701567133, 12.935545250775558, 17.61370629200919, 4.379707434317865, 4.41740303870573, 2.3906616394706317, 13.560635374135806, 4.62861278059897, 0.0, 43.26414519896574, 9.591918417707424, 0.0, 4.411540364343013, 7.279881152295105, 32.537212725108986, 38.29342833887624, 20.916436140011584, 0.0, 11.720053240987776, 12.15329124048889, 0.0, 9.284843596274154, 1.1088427011966928, 9.289764195678954, 0.9413117160783736, 19.11274327065536, 12.10545484909999, 19.642950230391538, 13.555124227798828, 18.011957333186054, 8.837034822819566, 26.988274023306086, 6.178756120815668, 0.0, 0.7856679465322325, 34.03371982405235, 2.582180416322471, 6.19325824780574, 22.314934643087767, 0.0, 18.62450146314306, 29.77218206667566, 34.46900002082865, 12.651502536659525, 3.56753908216373, 16.05299276239171, 4.444057601313032, 31.402292695800742, 0.0, 8.5839905696392, 6.499031393630795, 31.649962152996938, 4.865136777874226, 10.839644505838713, 17.125991183440036, 7.231905558781037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.90614161905871, "mean_inference_ms": 3.8037462996252636, "mean_action_processing_ms": 1.9126580098381287, "mean_env_wait_ms": 1.1695162027893167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004328131675720215, "StateBufferConnector_ms": 0.012944579124450684, "ViewRequirementAgentConnector_ms": 0.10029089450836182}, "num_episodes": 64, "episode_return_max": 139.19816143398782, "episode_return_min": 28.650296406828048, "episode_return_mean": 61.43765817833987, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 246.73070037843783, "num_env_steps_trained_throughput_per_sec": 246.73070037843783, "timesteps_total": 640000, "num_env_steps_sampled_lifetime": 640000, "num_agent_steps_sampled_lifetime": 2560000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2560000, "timers": {"training_iteration_time_ms": 33361.752, "restore_workers_time_ms": 0.026, "training_step_time_ms": 33361.23, "sample_time_ms": 1507.717, "learn_time_ms": 31825.175, "learn_throughput": 251.373, "synch_weights_time_ms": 23.965}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "done": false, "training_iteration": 80, "trial_id": "cd905_00000", "date": "2024-08-20_10-07-51", "timestamp": 1724128671, "time_this_iter_s": 32.43206024169922, "time_total_s": 2627.4645347595215, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a17d0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2627.4645347595215, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 31.402173913043473, "ram_util_percent": 72.8413043478261}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7741610607812329, "cur_kl_coeff": 2.5145709514617917e-09, "cur_lr": 0.0001, "total_loss": 0.27950883110955593, "policy_loss": -0.0017926909334381068, "vf_loss": 0.28130152195928587, "vf_explained_var": 0.02081722721220955, "kl": 0.012648322645691223, "entropy": 1.2426527901301307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 50715.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2461292754444811, "cur_kl_coeff": 3.0695446184836325e-13, "cur_lr": 0.0001, "total_loss": 0.19030945916615782, "policy_loss": -0.0005991192885659753, "vf_loss": 0.1909085782722474, "vf_explained_var": 0.0038946983360108873, "kl": 0.00554110383951981, "entropy": 0.5656836695141263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 50715.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000}, "env_runners": {"episode_reward_max": 139.19816143398782, "episode_reward_min": 28.650296406828048, "episode_reward_mean": 60.53913383812009, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.31182198422034, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 91.09809371745888, "predator_policy": 91.24266963118286}, "policy_reward_mean": {"prey_policy": 16.07157302150556, "predator_policy": 14.197993897554552}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.60000000000029, 70.00873241798713, 37.700000000000266, 38.10000000000027, 37.177785898822165, 35.81824573356215, 40.000000000000306, 89.39999999999863, 62.1000000000005, 88.79700463345473, 106.75370114581662, 42.800000000000345, 88.69999999999868, 52.240183147930914, 55.20000000000048, 78.29999999999944, 72.79999999999987, 75.99999999999962, 64.20000000000046, 44.05325380016915, 49.400000000000425, 48.149719412914806, 45.9000000000004, 81.19999999999924, 42.20000000000033, 62.5000000000005, 53.28373656425003, 56.000000000000504, 28.650296406828048, 39.30000000000029, 55.400000000000425, 37.90000000000027, 45.9264482472501, 79.29999999999939, 62.50000000000042, 75.64655976710141, 47.400000000000425, 60.300000000000495, 39.20000000000029, 99.39999999999833, 48.00000000000044, 51.7000000000005, 62.84161837487896, 61.1000000000005, 62.000000000000504, 51.400000000000496, 38.90000000000028, 49.600000000000456, 70.0, 87.09999999999884, 106.32392944544905, 38.00000000000027, 58.20000000000046, 29.68150883815397, 78.99999999999939, 61.2000000000005, 44.9000000000004, 45.40000000000039, 85.59999999999893, 40.0000000000003, 36.200000000000244, 74.39999999999976, 84.58066466564914, 39.000000000000284, 64.40000000000043, 139.19816143398782, 70.89999999999999, 40.90000000000032, 39.100000000000286, 74.51183362309588, 60.8000000000005, 93.39999999999874, 67.20000000000026, 75.29999999999966, 72.49999999999989, 39.000000000000284, 38.70000000000028, 58.20000000000046, 88.89999999999874, 75.6999999999996, 57.40000000000051, 63.20000000000048, 39.30000000000029, 38.00000000000027, 75.39106075010716, 106.20029933014453, 65.2000000000004, 38.400000000000276, 39.50000000000029, 69.2000000000001, 64.70000000000044, 99.9999999999983, 86.32092251802253, 55.15771765642642, 38.20000000000027, 53.10000000000046, 38.90000000000028, 71.19999999999999, 49.20000000000046, 72.19999999999989], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [17.882726456946116, 17.51087661533368, 23.658776674215666, 1.1359920540410202, -38.91529547056738, -11.046505554712528, 4.206385207042638, -4.195258228125619, -0.05257171572063973, 9.415393431009711, 5.320932440722466, 13.568527390268795, 17.69451248566475, 10.171383154355363, 7.1869955984182265, 64.9139994439522, 39.62399848892652, 19.069396304830427, 31.792930444030585, 18.480864938615614, 47.410497936166905, 46.780268764950726, -9.022831008458539, -7.0111111590626045, 53.52229862882102, 26.69787489360102, -42.00921098935566, -28.86060153546596, 16.09332151873998, 0.85228046665063, 54.64380616048396, 19.039346535431964, 43.40000000000024, 22.650257218044118, 15.78593451346798, 49.18132291349727, 20.000000000000014, 23.184243171477775, 13.072928874597928, 11.830476264818808, -37.15983117072218, 12.9565657486608, -8.823846686068947, -10.647316479383075, 16.997827244618897, 2.961064553841617, 11.156445076859677, 57.78867494642317, 21.562807472445385, 10.199993942598116, 23.312508608569658, -4.384831833375225, 26.300000000000114, 5.20898325142149, 7.141873405572657, 34.60427798546446, -0.8338667355412961, -29.286224950976823, 3.17601757237945, 11.140800174865156, -56.31182198422034, 15.187682544288586, -12.500923917316834, 4.868043237637414, 8.318291366731149, -0.680320528923104, 59.60000000000022, 16.221224436371532, -3.7242856167813625, 18.862146695344634, 24.019170590496877, 36.596082744626756, 5.866200052032752, 18.826622932567865, 41.60000000000024, -5.248010530098764, 17.793789002827122, 2.561446093108595, 37.07289969281938, 33.56644562489975, 19.24914387616383, -1.13777878943085, 12.212596130495578, 25.876353207833983, 13.94569948003058, 18.65544225094421, 33.60607347275681, 18.953024444765532, 12.251456939908847, 42.50000000000025, 30.098438245966065, 17.429718448497848, 2.806387221868354, 18.82147343798637, 18.347505040155127, 27.171511156628338, 20.000000000000014, 22.640093700604005, 38.000000000000256, 39.99695315908459, 37.48090533761586, 39.03990438323347, -6.889457154525353, 19.131694243373147, -2.2187845917943205, 5.885700291241813, -6.573074222324271, 1.1295039593578442, 24.396441297075988, 34.98827625490268, 36.99204950148195, 9.966927812117602, -7.6421256199888035, 14.9935373466457, -11.053553818659086, 19.371567734234997, 64.41743806490815, 6.280723404082597, 20.000000000000014, 20.000000000000014, -26.600199389319698, -51.08700706100913, 39.664428908152566, 12.39269906677968, 56.511350751475085, 4.358491172017359, 17.141652793213183, 7.495351998063498, 23.667799298432946, 5.864454749224409, 26.106653990202748, 91.09809371745888, 15.182596961294234, 48.909338360529595, 20.000000000000014, 2.710751845265196, 20.000000000000014, -24.16414519896547, 28.00808158229273, 36.911833623096385, 19.688459635657, 29.420118847705073, -14.337212725108758, 36.906571661123934, 12.846069846997835, 33.43749401299077, 44.27994675901243, 7.146708759511075, 11.715156403725805, 51.500000000000234, 18.791157298803306, 9.810235804321012, 18.958688283921628, -0.31274327065535734, 6.451594920508448, 20.000000000000014, 5.744875772201137, 51.58804266681411, 11.3629651771804, 28.51172597669409, 15.565989839744493, 35.65525403944006, 12.758134706066615, 15.622477523348739, 17.217819583677507, 13.306741752194226, -1.3044522239141334, 16.98951758082635, 4.26788549962337, 22.726491720665408, 29.030999979171536, 30.04879679348667, 32.23246091783649, 13.347007237608262, 15.155942398686932, -12.602292695800536, 20.000000000000014, 10.916009430360765, 44.50096860636943, -13.449962152996726, 40.83486322212601, 8.160355494161253, 38.17400881656018, 37.468094441219186, 20.437300969999512, -10.910759892339902, 33.14566709629076, 10.06899136181109, 4.682813652821935, 9.574683927713304, 7.215587138539263, -2.2037903644371566, 11.058170563134583, -0.3248948313133123, 29.236602813236974, 20.664754430019514, 21.218552269364896, 6.721574784153081, 9.5716594281162, 48.19896190497023], "policy_predator_policy_reward": [1.9172735430538725, 2.289123384666306, 10.412528854518355, 34.801434835212085, 4.022337126791647, 83.63946389848867, 14.793614792957328, 23.29525822812568, 2.1364183430435153, 25.678545840489274, 15.10804681083675, 1.8207390917338322, 2.033356484864901, 10.100747875114935, 12.213004401581738, 5.08600055604791, 2.5760015110737284, 0.830603695169578, 34.212336471695814, 4.310872779114272, 2.043203209651697, 10.519731235049484, 23.473977213502437, 35.359964954018935, 3.8777013711791817, 4.602125106399104, 87.32890312197122, 35.78109255078136, 10.952271961325474, 27.302126053283853, 3.756193839516252, 0.8606534645680388, 0.0, 6.749742781955936, 3.814065486531984, 7.218677086502946, 0.0, 21.0157568285223, 14.68931999827631, 4.460528662475676, 28.80270400024278, 44.800561421818756, 39.29286518440545, 28.328017393961247, 10.002172755381077, 15.938935446158345, 8.143554923140288, 4.1113250535770325, 1.0371925275546523, 9.400006057401848, 12.18749139143041, 31.384831833375273, 10.837477874993953, 10.937275437834028, 11.95812659442731, 2.295722014535788, 33.99567394441232, 24.774714148934, 15.723982427620513, 9.259199825134809, 91.24266963118286, 5.2814698087485485, 31.100923917317036, 14.431956762362551, 14.91269893480545, 23.37577847463618, 0.0, 3.4787755636284348, 9.663629091701864, 37.69850982973486, 3.4356339890682444, 11.595672442910194, 20.686927408034926, 2.020249607364424, 0.0, 23.948010530098838, 2.0062109971728628, 16.838553906891377, 11.727100307180844, 17.03355437510046, 9.950856123836168, 19.937778789430865, 7.287403869504387, 6.323646792166129, 12.811449713904171, 17.42902692999948, 7.593926527243429, 0.9469755552344694, 7.248543060091118, 0.0, 1.5015617540341204, 2.370281551502133, 16.19361277813161, 1.078526562013632, 3.252494959844867, 0.8284888433717934, 27.359906299396066, 0.0, 5.562400303111609, 3.540646537804027, 18.440383001509876, 11.362736723092, 4.540723707546611, 21.21703920360569, 21.318784591794355, 33.21429970875817, 0.0, 35.12507910112031, 19.615282448021624, 0.0, 0.0, 14.241022686400653, 8.71194810633101, 28.836640167012135, 30.811314748330854, 6.27067133609342, 2.1825619350920213, 12.71927659591737, 0.0, 0.0, 45.10019938931996, 68.78700706100905, 5.235571091847676, 17.107300933220287, 1.169313914175253, 22.54150882798261, 2.5583472067867934, 11.804648001936467, 21.932200701567133, 12.935545250775558, 17.61370629200919, 4.379707434317865, 4.41740303870573, 2.3906616394706317, 13.560635374135806, 4.62861278059897, 0.0, 43.26414519896574, 9.591918417707424, 0.0, 4.411540364343013, 7.279881152295105, 32.537212725108986, 38.29342833887624, 20.916436140011584, 0.0, 11.720053240987776, 12.15329124048889, 0.0, 9.284843596274154, 1.1088427011966928, 9.289764195678954, 0.9413117160783736, 19.11274327065536, 12.10545484909999, 19.642950230391538, 13.555124227798828, 18.011957333186054, 8.837034822819566, 26.988274023306086, 6.178756120815668, 0.0, 0.7856679465322325, 34.03371982405235, 2.582180416322471, 6.19325824780574, 22.314934643087767, 0.0, 18.62450146314306, 29.77218206667566, 34.46900002082865, 12.651502536659525, 3.56753908216373, 16.05299276239171, 4.444057601313032, 31.402292695800742, 0.0, 8.5839905696392, 6.499031393630795, 31.649962152996938, 4.865136777874226, 10.839644505838713, 17.125991183440036, 7.231905558781037, 52.2599848201103, 24.534396620253894, 11.031008638188876, 0.9120505601353764, 14.117186347178032, 9.825316072286661, 5.271655263147347, 42.81654796275056, 8.441829436865381, 19.724894831313325, 4.763397186763197, 16.535245569980514, 8.881447730635136, 12.378425215846885, 9.728340571883765, 4.701038095029992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.895410765667705, "mean_inference_ms": 3.8045951402858393, "mean_action_processing_ms": 1.905833017877814, "mean_env_wait_ms": 1.1678639003896243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004464864730834961, "StateBufferConnector_ms": 0.013503789901733398, "ViewRequirementAgentConnector_ms": 0.10181212425231934}, "num_episodes": 8, "episode_return_max": 139.19816143398782, "episode_return_min": 28.650296406828048, "episode_return_mean": 60.53913383812009, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 248.2070463648551, "num_env_steps_trained_throughput_per_sec": 248.2070463648551, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 2592000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2592000, "timers": {"training_iteration_time_ms": 33179.054, "restore_workers_time_ms": 0.025, "training_step_time_ms": 33178.553, "sample_time_ms": 1383.432, "learn_time_ms": 31768.129, "learn_throughput": 251.825, "synch_weights_time_ms": 22.818}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000}, "done": false, "training_iteration": 81, "trial_id": "cd905_00000", "date": "2024-08-20_10-08-23", "timestamp": 1724128703, "time_this_iter_s": 32.23530888557434, "time_total_s": 2659.699843645096, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a17de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2659.699843645096, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 26.07608695652174, "ram_util_percent": 72.34565217391305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.579272642672535, "cur_kl_coeff": 2.5145709514617917e-09, "cur_lr": 0.0001, "total_loss": 1.287111644044755, "policy_loss": -0.0017404823068765895, "vf_loss": 1.288852135908036, "vf_explained_var": 0.03039150219115, "kl": 0.005300434641818385, "entropy": 1.2205829639283439, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 51345.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3225296483862968, "cur_kl_coeff": 3.0695446184836325e-13, "cur_lr": 0.0001, "total_loss": 0.7209819202385251, "policy_loss": -0.001494828016600675, "vf_loss": 0.7224767468987949, "vf_explained_var": 0.003508008188671536, "kl": 0.006762586561630419, "entropy": 0.4112055009319669, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 51345.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000}, "env_runners": {"episode_reward_max": 142.7227483436988, "episode_reward_min": 10.447368835208625, "episode_reward_mean": 65.2350450632746, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -70.23239131976376, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 91.09809371745888, "predator_policy": 107.2591226233126}, "policy_reward_mean": {"prey_policy": 12.332818888046859, "predator_policy": 20.284703643590582}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.40000000000043, 139.19816143398782, 70.89999999999999, 40.90000000000032, 39.100000000000286, 74.51183362309588, 60.8000000000005, 93.39999999999874, 67.20000000000026, 75.29999999999966, 72.49999999999989, 39.000000000000284, 38.70000000000028, 58.20000000000046, 88.89999999999874, 75.6999999999996, 57.40000000000051, 63.20000000000048, 39.30000000000029, 38.00000000000027, 75.39106075010716, 106.20029933014453, 65.2000000000004, 38.400000000000276, 39.50000000000029, 69.2000000000001, 64.70000000000044, 99.9999999999983, 86.32092251802253, 55.15771765642642, 38.20000000000027, 53.10000000000046, 38.90000000000028, 71.19999999999999, 49.20000000000046, 72.19999999999989, 110.09999999999874, 63.400000000000475, 48.500000000000355, 83.59999999999907, 37.700000000000266, 37.50000000000026, 85.40724063236625, 76.09999999999958, 60.900000000000446, 38.00000000000027, 36.80000000000025, 38.10000000000027, 90.0999999999986, 52.92722320968278, 75.29999999999964, 40.0000000000003, 37.50000000000026, 127.8999999999983, 96.89999999999873, 80.01282041645068, 113.29999999999842, 40.500000000000306, 104.59999999999883, 123.29999999999839, 82.59999999999914, 102.79999999999876, 33.038913295063736, 35.30000000000023, 38.905006518113865, 48.90000000000043, 69.2000000000001, 34.14755620342366, 60.20000000000046, 62.00000000000038, 28.92430414095314, 116.29999999999853, 38.00000000000027, 55.30000000000044, 50.500000000000455, 39.20000000000029, 74.99999999999964, 58.29696633307805, 39.100000000000286, 85.77287986241807, 71.39999999999989, 39.60000000000029, 64.9000000000004, 49.88216935332076, 95.09999999999869, 39.30000000000029, 37.700000000000266, 94.56621994376357, 99.59999999999829, 38.50000000000028, 65.60000000000036, 81.79999999999919, 142.7227483436988, 121.89999999999833, 38.400000000000276, 46.281681074155365, 10.447368835208625, 16.890786909948297, 116.10062594404033, 81.3999999999992], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [23.667799298432946, 5.864454749224409, 26.106653990202748, 91.09809371745888, 15.182596961294234, 48.909338360529595, 20.000000000000014, 2.710751845265196, 20.000000000000014, -24.16414519896547, 28.00808158229273, 36.911833623096385, 19.688459635657, 29.420118847705073, -14.337212725108758, 36.906571661123934, 12.846069846997835, 33.43749401299077, 44.27994675901243, 7.146708759511075, 11.715156403725805, 51.500000000000234, 18.791157298803306, 9.810235804321012, 18.958688283921628, -0.31274327065535734, 6.451594920508448, 20.000000000000014, 5.744875772201137, 51.58804266681411, 11.3629651771804, 28.51172597669409, 15.565989839744493, 35.65525403944006, 12.758134706066615, 15.622477523348739, 17.217819583677507, 13.306741752194226, -1.3044522239141334, 16.98951758082635, 4.26788549962337, 22.726491720665408, 29.030999979171536, 30.04879679348667, 32.23246091783649, 13.347007237608262, 15.155942398686932, -12.602292695800536, 20.000000000000014, 10.916009430360765, 44.50096860636943, -13.449962152996726, 40.83486322212601, 8.160355494161253, 38.17400881656018, 37.468094441219186, 20.437300969999512, -10.910759892339902, 33.14566709629076, 10.06899136181109, 4.682813652821935, 9.574683927713304, 7.215587138539263, -2.2037903644371566, 11.058170563134583, -0.3248948313133123, 29.236602813236974, 20.664754430019514, 21.218552269364896, 6.721574784153081, 9.5716594281162, 48.19896190497023, 75.62127509140231, 20.000000000000014, -2.603841005686289, 36.73686937969286, -64.41865289877016, 17.422133032862867, 19.18060062522531, 54.294897998093525, -25.58457135195573, 18.62413439903963, -7.749476774875733, 7.147123566902016, -9.5658654197797, 38.39136346588249, 16.337520212441543, 18.903647284772582, -1.0257245276273013, 2.163206621103854, -2.8698621010148937, -5.521042177340918, -8.518539402385288, -0.3585591095753816, 20.000000000000014, -19.277670363723267, 20.90000000000003, 61.95676396229205, -9.34427925126357, -4.248691597286445, 43.44390115433084, 11.286712462120056, 20.000000000000014, 20.000000000000014, 10.833867696357274, -10.320883674759846, 52.465447834371176, 71.29999999999968, 41.78553581632584, 25.400000000000098, 35.32091239207768, -0.8031279185944558, 24.653386680145545, 80.29999999999924, -27.309162519893448, 19.833504996574067, 28.849577654927366, 20.000000000000014, 31.29027894101051, 75.79999999999936, 11.234751816840522, 47.821847113744475, 17.654283288253016, 65.04067313752611, -0.2738551266135669, -37.21075175766404, -57.0548585834474, -1.2960730649801793, -3.1645761226542155, -4.516904706569525, -25.92840023503399, 17.48319869353064, 7.780505277934823, 45.48609795551984, -8.477383170855607, -46.48766474500739, 8.033694343637686, 1.7348343380404596, -5.883025069220221, -69.47712176447541, -21.3547738535132, -31.495443222670232, 32.361158687124025, 38.4984336954035, -70.23239131976376, 1.2004480872116494, -6.331385047339035, -4.992192502443947, -1.5448207909506357, -42.20069507330239, 18.967558340305406, 3.0443486055200735, 28.843142399195614, 20.000000000000014, 6.270918056892272, 34.396966333077806, 5.516430529132052, 20.000000000000014, 57.41912260889272, -8.3431834213818, -34.00690133644393, -27.26632592840854, 8.734793197320142, 15.130302859188875, 21.413508428970534, 20.90000000000003, -42.6059871312714, 10.229037374387442, -11.552752100185115, 48.76668346702563, 10.807966445281517, 20.000000000000014, -15.246599669390648, -13.2628624190437, 60.97251602262963, -2.2447202197679585, 45.0217628264357, 34.1246181335308, 20.000000000000014, 0.19838094677745813, 35.228029480884864, 13.81047852177891, 18.357267265828465, -19.10543431068787, 7.24271100322883, 31.994529128735707, 73.13024154295867, 40.556117422504876, -23.597197812972873, 15.418819029725142, -32.54117153086387, 20.000000000000014, -27.26523091910994, -54.16365477396953, -9.055460363755863, -19.623677749380747, 47.35771106031436, -67.27883853177474, 25.7639635870655, -25.80877276426751], "policy_predator_policy_reward": [21.932200701567133, 12.935545250775558, 17.61370629200919, 4.379707434317865, 4.41740303870573, 2.3906616394706317, 13.560635374135806, 4.62861278059897, 0.0, 43.26414519896574, 9.591918417707424, 0.0, 4.411540364343013, 7.279881152295105, 32.537212725108986, 38.29342833887624, 20.916436140011584, 0.0, 11.720053240987776, 12.15329124048889, 0.0, 9.284843596274154, 1.1088427011966928, 9.289764195678954, 0.9413117160783736, 19.11274327065536, 12.10545484909999, 19.642950230391538, 13.555124227798828, 18.011957333186054, 8.837034822819566, 26.988274023306086, 6.178756120815668, 0.0, 0.7856679465322325, 34.03371982405235, 2.582180416322471, 6.19325824780574, 22.314934643087767, 0.0, 18.62450146314306, 29.77218206667566, 34.46900002082865, 12.651502536659525, 3.56753908216373, 16.05299276239171, 4.444057601313032, 31.402292695800742, 0.0, 8.5839905696392, 6.499031393630795, 31.649962152996938, 4.865136777874226, 10.839644505838713, 17.125991183440036, 7.231905558781037, 52.2599848201103, 24.534396620253894, 11.031008638188876, 0.9120505601353764, 14.117186347178032, 9.825316072286661, 5.271655263147347, 42.81654796275056, 8.441829436865381, 19.724894831313325, 4.763397186763197, 16.535245569980514, 8.881447730635136, 12.378425215846885, 9.728340571883765, 4.701038095029992, 14.478724908597098, 0.0, 21.403841005686324, 7.863130620307369, 15.886194231104403, 79.61032563480215, 0.7193993747746955, 9.40510200190668, 0.0, 44.66043695291634, 26.44947677487585, 11.652876433097951, 28.125504495577278, 28.456238090687606, 39.86247978755842, 0.996352715227421, 43.325724527627266, 16.436793378896112, 21.869862101014935, 24.521042177341002, 27.018539402385418, 18.65855910957537, 0.0, 37.377670363723524, 0.0, 7.243236037708126, 31.964965876232764, 34.55522818199981, 12.45609884566937, 8.11328753787991, 0.0, 0.0, 8.566132303642691, 28.420883674760002, 4.134552165629044, 0.0, 9.907117524637492, 19.80734665903683, 44.308091704151025, 1.1869442388173024, 8.346613319854544, 0.0, 46.20916251989372, 1.766495003425948, 55.750422345072785, 0.0, 16.209721058989697, 0.0, 11.465248183159446, 12.07815288625574, 7.111736861708402, 12.99330671251252, 7.616628041122966, 62.90689213821838, 73.55485858344696, 20.096073064980196, 21.383303724659214, 25.203183622678207, 44.02840023503425, 13.316801306469333, 11.319494722065143, 4.613902044480389, 10.65445900300504, 78.45814511628178, 11.06630565636228, 39.36516566195952, 95.75072209925204, 41.60942473444295, 11.613109513403886, 70.16141170373302, 38.43884131287616, 7.00156630459668, 86.93239131976283, 20.099551912788325, 24.23138504733911, 42.39219250244397, 73.36158958432601, 20.883926279927252, 0.9324416596945981, 16.25565139447989, 15.780962128624259, 10.375895472180305, 17.629081943107703, 0.0, 13.583569470867914, 0.0, 19.712670523911576, 16.984270150996984, 107.2591226233126, 25.414104641540366, 10.365206802679824, 5.36969714081109, 22.586491571029512, 0.0, 12.506339360788624, 69.75277974941582, 30.552752100185305, 27.333316532974543, 8.492033554718448, 0.0, 33.746599669390896, 32.46286241904392, 22.691730620070615, 13.146693520832969, 20.45361904003393, 0.0, 17.56561555212295, 0.7360035010995584, 10.871970519115365, 5.689521478221056, 21.44273273417153, 61.10543431068808, 94.34617748661574, 9.139330725119873, 3.1697584570408734, 5.04388257749536, 42.39719781297314, 4.181180970274822, 15.717712399715978, 43.10514020530311, 0.0, 91.87625452828807, 40.47491533780252, 5.095009685282785, 98.54214335505391, 37.47961006044771, 2.1360364129346046, 79.30877276426769]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.88652545011692, "mean_inference_ms": 3.789010153735093, "mean_action_processing_ms": 1.9012013961274932, "mean_env_wait_ms": 1.1639917501683552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004248142242431641, "StateBufferConnector_ms": 0.011363983154296875, "ViewRequirementAgentConnector_ms": 0.09615647792816162}, "num_episodes": 64, "episode_return_max": 142.7227483436988, "episode_return_min": 10.447368835208625, "episode_return_mean": 65.2350450632746, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 258.1184789797114, "num_env_steps_trained_throughput_per_sec": 258.1184789797114, "timesteps_total": 656000, "num_env_steps_sampled_lifetime": 656000, "num_agent_steps_sampled_lifetime": 2624000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2624000, "timers": {"training_iteration_time_ms": 32776.84, "restore_workers_time_ms": 0.023, "training_step_time_ms": 32776.344, "sample_time_ms": 1351.252, "learn_time_ms": 31399.845, "learn_throughput": 254.778, "synch_weights_time_ms": 21.741}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000}, "done": false, "training_iteration": 82, "trial_id": "cd905_00000", "date": "2024-08-20_10-08-54", "timestamp": 1724128734, "time_this_iter_s": 30.99962019920349, "time_total_s": 2690.6994638442993, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169edb4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2690.6994638442993, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 28.07045454545455, "ram_util_percent": 71.62954545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3420347059056872, "cur_kl_coeff": 2.5145709514617917e-09, "cur_lr": 0.0001, "total_loss": 0.6800930302531, "policy_loss": -0.0003167398953958163, "vf_loss": 0.680409769761184, "vf_explained_var": 0.016937000505507938, "kl": 0.0004802683304963769, "entropy": 1.208605833091433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.30916565225001363, "cur_kl_coeff": 3.0695446184836325e-13, "cur_lr": 0.0001, "total_loss": 0.4841212660783813, "policy_loss": -0.0008871318447211432, "vf_loss": 0.48500839765109716, "vf_explained_var": 0.003890829332291134, "kl": 0.003403504053169183, "entropy": 0.3534190890334901, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000}, "env_runners": {"episode_reward_max": 142.7227483436988, "episode_reward_min": 10.447368835208625, "episode_reward_mean": 55.788426313356766, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -86.15012662476566, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 73.13024154295867, "predator_policy": 107.2591226233126}, "policy_reward_mean": {"prey_policy": 6.9099728615932055, "predator_policy": 20.98424029508517}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.00000000000027, 55.30000000000044, 50.500000000000455, 39.20000000000029, 74.99999999999964, 58.29696633307805, 39.100000000000286, 85.77287986241807, 71.39999999999989, 39.60000000000029, 64.9000000000004, 49.88216935332076, 95.09999999999869, 39.30000000000029, 37.700000000000266, 94.56621994376357, 99.59999999999829, 38.50000000000028, 65.60000000000036, 81.79999999999919, 142.7227483436988, 121.89999999999833, 38.400000000000276, 46.281681074155365, 10.447368835208625, 16.890786909948297, 116.10062594404033, 81.3999999999992, 49.45665304893202, 53.18549930145363, 38.70000000000028, 44.10000000000037, 64.20000000000046, 42.90000000000036, 62.70000000000042, 69.90000000000005, 39.000000000000284, 40.400000000000304, 59.60000000000049, 38.300000000000274, 38.300000000000274, 65.00000000000041, 71.39999999999998, 32.325243941660204, 39.20000000000029, 39.22327132675215, 63.52677520299933, 55.20000000000042, 52.383439869103995, 38.559133070666654, 59.992265046732754, 57.0000000000005, 81.99999999999919, 38.60000000000028, 56.600000000000506, 16.125352007001734, 55.700000000000486, 54.80000000000052, 65.12631172563087, 65.00000000000041, 56.7000000000005, 43.10000000000034, 67.4000000000002, 47.00000000000041, 51.04518123391943, 47.56441187129318, 66.46670309930767, 39.30000000000029, 43.80000000000036, 85.49674347184249, 30.9095659861662, 40.1000000000003, 74.6999999999997, 51.00000000000048, 85.09999999999897, 40.67892745010882, 51.600000000000485, 61.64176980124357, 67.7071256341879, 38.60000000000028, 44.320547261944355, 39.11119114628228, 54.18593877549691, 39.98639951639677, 48.10000000000044, 38.90000000000028, 39.700000000000294, 64.90000000000043, 32.79771933905154, 50.50000000000048, 39.26501560786231, 37.90000000000027, 68.60000000000015, 46.70000000000041, 75.8999999999996, 81.8999999999992, 65.9000000000003, 61.9000000000005, 74.59999999999972, 42.00000000000033], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-70.23239131976376, 1.2004480872116494, -6.331385047339035, -4.992192502443947, -1.5448207909506357, -42.20069507330239, 18.967558340305406, 3.0443486055200735, 28.843142399195614, 20.000000000000014, 6.270918056892272, 34.396966333077806, 5.516430529132052, 20.000000000000014, 57.41912260889272, -8.3431834213818, -34.00690133644393, -27.26632592840854, 8.734793197320142, 15.130302859188875, 21.413508428970534, 20.90000000000003, -42.6059871312714, 10.229037374387442, -11.552752100185115, 48.76668346702563, 10.807966445281517, 20.000000000000014, -15.246599669390648, -13.2628624190437, 60.97251602262963, -2.2447202197679585, 45.0217628264357, 34.1246181335308, 20.000000000000014, 0.19838094677745813, 35.228029480884864, 13.81047852177891, 18.357267265828465, -19.10543431068787, 7.24271100322883, 31.994529128735707, 73.13024154295867, 40.556117422504876, -23.597197812972873, 15.418819029725142, -32.54117153086387, 20.000000000000014, -27.26523091910994, -54.16365477396953, -9.055460363755863, -19.623677749380747, 47.35771106031436, -67.27883853177474, 25.7639635870655, -25.80877276426751, 1.3711543002286095, -65.38218881274952, -7.149228272834334, 20.000000000000014, 16.78470646044171, -15.42606759487229, -19.120769354539952, -5.53364917831407, 18.538445826231566, 34.448903059518365, -25.40530697133888, -69.18929332122327, 26.016200440972348, -19.55691010978957, 9.29846452079138, 28.678316390369158, 0.3961335132633619, 20.000000000000014, -16.271949456720805, 19.118443894506704, 28.20617959048697, 16.312426180033604, 11.08403565822574, 1.7173901165957683, 18.85632050560531, -3.4256411901753063, 12.129625651606723, 41.720298843027855, 14.86100134072529, 45.200000000000244, 8.598199854771872, -2.2064104761459964, 13.436903819077497, 17.120168243136494, -9.296196170063382, -9.53183937781573, 10.137044690187176, 23.49924620301892, -52.34843484012115, 15.880607884415587, 12.370144227818535, -10.401947810039943, 11.009121602705212, -18.478663264234562, 8.850803338239643, 14.779430448145238, 32.193239355116, 6.53334971260821, 30.94963071000578, 27.13611529150111, 14.437010919023903, 3.1237151338735916, 33.68751644956701, 17.48696584453783, -33.87073725317628, -36.532922988299426, -13.271513953479651, 27.83627810284988, 36.20000000000026, -1.0972710038436206, 8.044047073661764, 15.789369590057081, 37.97292689465727, -15.523705380394967, 9.196852002054548, 34.02073401491123, 13.220043452815792, 14.34351663731608, -10.88820745315893, 29.50456373452057, 15.347126189101923, 19.705926047852465, 4.3579329180432005, 0.5626101672893828, -1.0476500107337836, 16.99103114909078, -4.339429277422687, 9.127337068400784, 0.6504001815088675, 20.000000000000014, 20.674798466606475, 1.3346404536084442, 4.048325529564423, 61.03065020961803, -0.0027857457995007773, 2.3494765376622317, -6.893790416646226, 16.19103671288908, -13.08162864169632, 56.00000000000022, -20.173114030476412, 27.669958114169233, 33.64853264132543, 36.20000000000026, 5.59895297156214, -34.22529912433706, 30.595091865735554, 20.000000000000014, -3.1531638314792736, 31.18185491634105, 27.02948206746923, 25.198551008067646, 15.233968123647715, 5.485978621530046, -65.35665158109452, -19.129735486129967, 7.203375356466577, -24.666951935068326, 11.338514855564327, 29.332818310040427, -4.349170683172142, -21.51297372491885, 2.6087861834796806, -7.053573248419003, -21.66743636114584, 20.000000000000014, 16.673836071392245, 20.000000000000014, 33.619542062093345, 17.672050411204182, 4.398291629059296, 10.666732486579349, -8.647483766322996, 16.50547000108724, 7.4452500283597, -8.483816351116236, -0.08411189073252351, -86.15012662476566, 0.30340606817877397, 9.921698031640338, 17.532483519224954, 10.204777530572388, 34.61965324367617, 17.98995869271124, 47.73506629785113, 15.438637559017758, 18.059922380342506, 18.304198842092692, 13.951372188116546, 41.38209580799961, 55.10310023618567, -24.532757151829756, 7.177789273622944, 10.408878896086392], "policy_predator_policy_reward": [86.93239131976283, 20.099551912788325, 24.23138504733911, 42.39219250244397, 73.36158958432601, 20.883926279927252, 0.9324416596945981, 16.25565139447989, 15.780962128624259, 10.375895472180305, 17.629081943107703, 0.0, 13.583569470867914, 0.0, 19.712670523911576, 16.984270150996984, 107.2591226233126, 25.414104641540366, 10.365206802679824, 5.36969714081109, 22.586491571029512, 0.0, 12.506339360788624, 69.75277974941582, 30.552752100185305, 27.333316532974543, 8.492033554718448, 0.0, 33.746599669390896, 32.46286241904392, 22.691730620070615, 13.146693520832969, 20.45361904003393, 0.0, 17.56561555212295, 0.7360035010995584, 10.871970519115365, 5.689521478221056, 21.44273273417153, 61.10543431068808, 94.34617748661574, 9.139330725119873, 3.1697584570408734, 5.04388257749536, 42.39719781297314, 4.181180970274822, 15.717712399715978, 43.10514020530311, 0.0, 91.87625452828807, 40.47491533780252, 5.095009685282785, 98.54214335505391, 37.47961006044771, 2.1360364129346046, 79.30877276426769, 64.96124194987202, 48.50644561157952, 32.33709283179364, 7.997634742493955, 2.91529353955826, 34.42606759487255, 39.33750110073147, 29.416917432122872, 1.3615541737684298, 9.851096940481863, 101.03989814502611, 36.4547021475355, 4.292081178621462, 51.94862849019616, 10.101535479208584, 21.821683609631013, 18.603866486736635, 0.0, 35.07194945672107, 2.4815561054933006, 11.69382040951319, 3.387573819966361, 8.315964341774224, 17.1826098834042, 1.0436794943946894, 21.825641190175347, 7.070374348393242, 4.079701156972381, 11.338998659274676, 0.0, 22.450803679253262, 3.482650883780875, 5.963096180922469, 2.679831756863483, 10.382344855646124, 47.66896201898516, 2.670956881276238, 27.21952742851654, 23.143227072589966, 68.52459988311564, 26.73060350371862, 23.6846399476064, 45.01313868909458, 1.0155360431013434, 18.964491259098512, 17.397540001248803, 1.1822086990094012, 17.09120223326658, 12.550369289994427, 11.363884708499027, 5.162989080976062, 15.87628486612637, 3.1124835504332324, 2.31303415546215, 80.92800882090982, 5.601003427568168, 31.671513953479863, 9.463721897150268, 0.0, 19.697271003843632, 10.164756505256797, 31.128138556654783, 0.82707310534297, 41.7237053803952, 13.482413983034442, 0.0, 1.0146823558247706, 14.521757554043294, 29.3882074531591, 19.39543626547963, 5.204315108318225, 6.7426326547273625, 26.910723360969747, 19.213914787616574, 21.547650010733793, 10.073380722201952, 30.469688525453456, 31.209106782875843, 18.64959981849113, 0.0, 4.32520153339355, 17.465359546391536, 19.651674470435545, 0.766093262225738, 20.96196256909306, 7.600912625210202, 25.79379041664633, 5.008963287110883, 31.781628641696532, 0.0, 37.37311403047666, 6.13004188583091, 14.292710190987922, 0.9587571676868711, 26.011649188448118, 43.29362441443554, 1.0049081342646442, 0.0, 27.253163831479306, 6.359914884902219, 5.645063202207753, 9.834029356443256, 4.366031876352249, 13.51402137846992, 73.01336643688644, 55.79356789228129, 41.694309669681644, 14.880458055202318, 12.754677338194764, 0.7599282716970363, 65.84854392448774, 0.0, 48.87866617820784, 3.66612088673152, 40.56743636114611, 0.0, 3.0261639286077253, 0.0, 4.880457937906906, 8.727949588795802, 14.484676518534771, 3.24801870487786, 27.547483766323133, 15.094529998912728, 28.55521612181978, 11.748365808798873, 21.184111890732527, 102.9501266247647, 28.69659393182121, 29.678301968359637, 9.967516480775028, 8.995222469427578, 19.11690716078393, 4.173480902828852, 6.864933702149097, 11.861362440982203, 25.068092618150278, 4.46778615941451, 5.548627811883424, 1.017904192000637, 1.5968997638145563, 42.43275715183001, 11.580385708604116, 12.832946121686481]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.871427228378951, "mean_inference_ms": 3.777658863641432, "mean_action_processing_ms": 1.8927432916820766, "mean_env_wait_ms": 1.1596126142875345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003601670265197754, "StateBufferConnector_ms": 0.012825608253479004, "ViewRequirementAgentConnector_ms": 0.09775674343109131}, "num_episodes": 72, "episode_return_max": 142.7227483436988, "episode_return_min": 10.447368835208625, "episode_return_mean": 55.788426313356766, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 260.2043594564425, "num_env_steps_trained_throughput_per_sec": 260.2043594564425, "timesteps_total": 664000, "num_env_steps_sampled_lifetime": 664000, "num_agent_steps_sampled_lifetime": 2656000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2656000, "timers": {"training_iteration_time_ms": 32468.339, "restore_workers_time_ms": 0.022, "training_step_time_ms": 32467.876, "sample_time_ms": 1312.186, "learn_time_ms": 31132.218, "learn_throughput": 256.969, "synch_weights_time_ms": 20.312}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000}, "done": false, "training_iteration": 83, "trial_id": "cd905_00000", "date": "2024-08-20_10-09-25", "timestamp": 1724128765, "time_this_iter_s": 30.75000500679016, "time_total_s": 2721.4494688510895, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afbd9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2721.4494688510895, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 28.744186046511622, "ram_util_percent": 71.79767441860464}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.300553185197096, "cur_kl_coeff": 1.2572854757308959e-09, "cur_lr": 0.0001, "total_loss": 0.7045646475894111, "policy_loss": -0.001227480934060637, "vf_loss": 0.7057921314050281, "vf_explained_var": 0.06617552004163227, "kl": 0.00883718564187759, "entropy": 1.1889849017536829, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 52605.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.24457319047124612, "cur_kl_coeff": 1.5347723092418163e-13, "cur_lr": 0.0001, "total_loss": 0.32202624125140056, "policy_loss": -0.0009219298804444926, "vf_loss": 0.3229481719729919, "vf_explained_var": 0.0019986842359815326, "kl": 0.003106305965267229, "entropy": 0.28630804310715385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 52605.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000}, "env_runners": {"episode_reward_max": 142.7227483436988, "episode_reward_min": 10.447368835208625, "episode_reward_mean": 55.50830789439215, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -86.15012662476566, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 73.13024154295867, "predator_policy": 107.2591226233126}, "policy_reward_mean": {"prey_policy": 7.369371557799974, "predator_policy": 20.384782389396086}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.39999999999989, 39.60000000000029, 64.9000000000004, 49.88216935332076, 95.09999999999869, 39.30000000000029, 37.700000000000266, 94.56621994376357, 99.59999999999829, 38.50000000000028, 65.60000000000036, 81.79999999999919, 142.7227483436988, 121.89999999999833, 38.400000000000276, 46.281681074155365, 10.447368835208625, 16.890786909948297, 116.10062594404033, 81.3999999999992, 49.45665304893202, 53.18549930145363, 38.70000000000028, 44.10000000000037, 64.20000000000046, 42.90000000000036, 62.70000000000042, 69.90000000000005, 39.000000000000284, 40.400000000000304, 59.60000000000049, 38.300000000000274, 38.300000000000274, 65.00000000000041, 71.39999999999998, 32.325243941660204, 39.20000000000029, 39.22327132675215, 63.52677520299933, 55.20000000000042, 52.383439869103995, 38.559133070666654, 59.992265046732754, 57.0000000000005, 81.99999999999919, 38.60000000000028, 56.600000000000506, 16.125352007001734, 55.700000000000486, 54.80000000000052, 65.12631172563087, 65.00000000000041, 56.7000000000005, 43.10000000000034, 67.4000000000002, 47.00000000000041, 51.04518123391943, 47.56441187129318, 66.46670309930767, 39.30000000000029, 43.80000000000036, 85.49674347184249, 30.9095659861662, 40.1000000000003, 74.6999999999997, 51.00000000000048, 85.09999999999897, 40.67892745010882, 51.600000000000485, 61.64176980124357, 67.7071256341879, 38.60000000000028, 44.320547261944355, 39.11119114628228, 54.18593877549691, 39.98639951639677, 48.10000000000044, 38.90000000000028, 39.700000000000294, 64.90000000000043, 32.79771933905154, 50.50000000000048, 39.26501560786231, 37.90000000000027, 68.60000000000015, 46.70000000000041, 75.8999999999996, 81.8999999999992, 65.9000000000003, 61.9000000000005, 74.59999999999972, 42.00000000000033, 61.65800429903414, 42.500000000000334, 47.20000000000042, 48.60000000000044, 68.70000000000014, 47.00000000000042, 44.70000000000039, 52.80000000000048], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-34.00690133644393, -27.26632592840854, 8.734793197320142, 15.130302859188875, 21.413508428970534, 20.90000000000003, -42.6059871312714, 10.229037374387442, -11.552752100185115, 48.76668346702563, 10.807966445281517, 20.000000000000014, -15.246599669390648, -13.2628624190437, 60.97251602262963, -2.2447202197679585, 45.0217628264357, 34.1246181335308, 20.000000000000014, 0.19838094677745813, 35.228029480884864, 13.81047852177891, 18.357267265828465, -19.10543431068787, 7.24271100322883, 31.994529128735707, 73.13024154295867, 40.556117422504876, -23.597197812972873, 15.418819029725142, -32.54117153086387, 20.000000000000014, -27.26523091910994, -54.16365477396953, -9.055460363755863, -19.623677749380747, 47.35771106031436, -67.27883853177474, 25.7639635870655, -25.80877276426751, 1.3711543002286095, -65.38218881274952, -7.149228272834334, 20.000000000000014, 16.78470646044171, -15.42606759487229, -19.120769354539952, -5.53364917831407, 18.538445826231566, 34.448903059518365, -25.40530697133888, -69.18929332122327, 26.016200440972348, -19.55691010978957, 9.29846452079138, 28.678316390369158, 0.3961335132633619, 20.000000000000014, -16.271949456720805, 19.118443894506704, 28.20617959048697, 16.312426180033604, 11.08403565822574, 1.7173901165957683, 18.85632050560531, -3.4256411901753063, 12.129625651606723, 41.720298843027855, 14.86100134072529, 45.200000000000244, 8.598199854771872, -2.2064104761459964, 13.436903819077497, 17.120168243136494, -9.296196170063382, -9.53183937781573, 10.137044690187176, 23.49924620301892, -52.34843484012115, 15.880607884415587, 12.370144227818535, -10.401947810039943, 11.009121602705212, -18.478663264234562, 8.850803338239643, 14.779430448145238, 32.193239355116, 6.53334971260821, 30.94963071000578, 27.13611529150111, 14.437010919023903, 3.1237151338735916, 33.68751644956701, 17.48696584453783, -33.87073725317628, -36.532922988299426, -13.271513953479651, 27.83627810284988, 36.20000000000026, -1.0972710038436206, 8.044047073661764, 15.789369590057081, 37.97292689465727, -15.523705380394967, 9.196852002054548, 34.02073401491123, 13.220043452815792, 14.34351663731608, -10.88820745315893, 29.50456373452057, 15.347126189101923, 19.705926047852465, 4.3579329180432005, 0.5626101672893828, -1.0476500107337836, 16.99103114909078, -4.339429277422687, 9.127337068400784, 0.6504001815088675, 20.000000000000014, 20.674798466606475, 1.3346404536084442, 4.048325529564423, 61.03065020961803, -0.0027857457995007773, 2.3494765376622317, -6.893790416646226, 16.19103671288908, -13.08162864169632, 56.00000000000022, -20.173114030476412, 27.669958114169233, 33.64853264132543, 36.20000000000026, 5.59895297156214, -34.22529912433706, 30.595091865735554, 20.000000000000014, -3.1531638314792736, 31.18185491634105, 27.02948206746923, 25.198551008067646, 15.233968123647715, 5.485978621530046, -65.35665158109452, -19.129735486129967, 7.203375356466577, -24.666951935068326, 11.338514855564327, 29.332818310040427, -4.349170683172142, -21.51297372491885, 2.6087861834796806, -7.053573248419003, -21.66743636114584, 20.000000000000014, 16.673836071392245, 20.000000000000014, 33.619542062093345, 17.672050411204182, 4.398291629059296, 10.666732486579349, -8.647483766322996, 16.50547000108724, 7.4452500283597, -8.483816351116236, -0.08411189073252351, -86.15012662476566, 0.30340606817877397, 9.921698031640338, 17.532483519224954, 10.204777530572388, 34.61965324367617, 17.98995869271124, 47.73506629785113, 15.438637559017758, 18.059922380342506, 18.304198842092692, 13.951372188116546, 41.38209580799961, 55.10310023618567, -24.532757151829756, 7.177789273622944, 10.408878896086392, 16.324011018372527, 17.342558318333744, 19.168704313734317, 7.442826976355224, -0.408820432510306, 21.4715294525795, 25.720674006504908, 18.860036913112197, 46.74519552991344, 6.361248632746843, 15.80183976770322, 19.565258053738553, -63.76867895198912, -13.633546866112631, -3.098830686082734, 20.000000000000014], "policy_predator_policy_reward": [107.2591226233126, 25.414104641540366, 10.365206802679824, 5.36969714081109, 22.586491571029512, 0.0, 12.506339360788624, 69.75277974941582, 30.552752100185305, 27.333316532974543, 8.492033554718448, 0.0, 33.746599669390896, 32.46286241904392, 22.691730620070615, 13.146693520832969, 20.45361904003393, 0.0, 17.56561555212295, 0.7360035010995584, 10.871970519115365, 5.689521478221056, 21.44273273417153, 61.10543431068808, 94.34617748661574, 9.139330725119873, 3.1697584570408734, 5.04388257749536, 42.39719781297314, 4.181180970274822, 15.717712399715978, 43.10514020530311, 0.0, 91.87625452828807, 40.47491533780252, 5.095009685282785, 98.54214335505391, 37.47961006044771, 2.1360364129346046, 79.30877276426769, 64.96124194987202, 48.50644561157952, 32.33709283179364, 7.997634742493955, 2.91529353955826, 34.42606759487255, 39.33750110073147, 29.416917432122872, 1.3615541737684298, 9.851096940481863, 101.03989814502611, 36.4547021475355, 4.292081178621462, 51.94862849019616, 10.101535479208584, 21.821683609631013, 18.603866486736635, 0.0, 35.07194945672107, 2.4815561054933006, 11.69382040951319, 3.387573819966361, 8.315964341774224, 17.1826098834042, 1.0436794943946894, 21.825641190175347, 7.070374348393242, 4.079701156972381, 11.338998659274676, 0.0, 22.450803679253262, 3.482650883780875, 5.963096180922469, 2.679831756863483, 10.382344855646124, 47.66896201898516, 2.670956881276238, 27.21952742851654, 23.143227072589966, 68.52459988311564, 26.73060350371862, 23.6846399476064, 45.01313868909458, 1.0155360431013434, 18.964491259098512, 17.397540001248803, 1.1822086990094012, 17.09120223326658, 12.550369289994427, 11.363884708499027, 5.162989080976062, 15.87628486612637, 3.1124835504332324, 2.31303415546215, 80.92800882090982, 5.601003427568168, 31.671513953479863, 9.463721897150268, 0.0, 19.697271003843632, 10.164756505256797, 31.128138556654783, 0.82707310534297, 41.7237053803952, 13.482413983034442, 0.0, 1.0146823558247706, 14.521757554043294, 29.3882074531591, 19.39543626547963, 5.204315108318225, 6.7426326547273625, 26.910723360969747, 19.213914787616574, 21.547650010733793, 10.073380722201952, 30.469688525453456, 31.209106782875843, 18.64959981849113, 0.0, 4.32520153339355, 17.465359546391536, 19.651674470435545, 0.766093262225738, 20.96196256909306, 7.600912625210202, 25.79379041664633, 5.008963287110883, 31.781628641696532, 0.0, 37.37311403047666, 6.13004188583091, 14.292710190987922, 0.9587571676868711, 26.011649188448118, 43.29362441443554, 1.0049081342646442, 0.0, 27.253163831479306, 6.359914884902219, 5.645063202207753, 9.834029356443256, 4.366031876352249, 13.51402137846992, 73.01336643688644, 55.79356789228129, 41.694309669681644, 14.880458055202318, 12.754677338194764, 0.7599282716970363, 65.84854392448774, 0.0, 48.87866617820784, 3.66612088673152, 40.56743636114611, 0.0, 3.0261639286077253, 0.0, 4.880457937906906, 8.727949588795802, 14.484676518534771, 3.24801870487786, 27.547483766323133, 15.094529998912728, 28.55521612181978, 11.748365808798873, 21.184111890732527, 102.9501266247647, 28.69659393182121, 29.678301968359637, 9.967516480775028, 8.995222469427578, 19.11690716078393, 4.173480902828852, 6.864933702149097, 11.861362440982203, 25.068092618150278, 4.46778615941451, 5.548627811883424, 1.017904192000637, 1.5968997638145563, 42.43275715183001, 11.580385708604116, 12.832946121686481, 6.603288690055413, 21.388146272271918, 4.03129568626569, 11.85717302364474, 19.00882043251031, 7.128470547420538, 2.9793259934952, 1.0399630868878031, 2.7548044700867944, 12.838751367253122, 3.798160232296744, 7.834741946261458, 80.76867895198818, 41.33354686611284, 35.898830686082746, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.860469048222878, "mean_inference_ms": 3.778121784799524, "mean_action_processing_ms": 1.8861078536860156, "mean_env_wait_ms": 1.157821879734023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035805702209472656, "StateBufferConnector_ms": 0.013052582740783691, "ViewRequirementAgentConnector_ms": 0.09849679470062256}, "num_episodes": 8, "episode_return_max": 142.7227483436988, "episode_return_min": 10.447368835208625, "episode_return_mean": 55.50830789439215, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 265.4504529153452, "num_env_steps_trained_throughput_per_sec": 265.4504529153452, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 2688000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2688000, "timers": {"training_iteration_time_ms": 32168.378, "restore_workers_time_ms": 0.021, "training_step_time_ms": 32168.021, "sample_time_ms": 1259.962, "learn_time_ms": 30887.506, "learn_throughput": 259.004, "synch_weights_time_ms": 17.703}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000}, "done": false, "training_iteration": 84, "trial_id": "cd905_00000", "date": "2024-08-20_10-09-55", "timestamp": 1724128795, "time_this_iter_s": 30.14161515235901, "time_total_s": 2751.5910840034485, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afea280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2751.5910840034485, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 26.655813953488373, "ram_util_percent": 71.8558139534884}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.379511528261124, "cur_kl_coeff": 1.2572854757308959e-09, "cur_lr": 0.0001, "total_loss": 1.310079465499, "policy_loss": -0.0023212489483523226, "vf_loss": 1.312400711434228, "vf_explained_var": 0.013629550120187184, "kl": 0.007933085895903845, "entropy": 1.0534261826484923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 53235.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3204475634627872, "cur_kl_coeff": 7.673861546209081e-14, "cur_lr": 0.0001, "total_loss": 0.8573350737965296, "policy_loss": -0.0007982511531620744, "vf_loss": 0.8581333313196424, "vf_explained_var": 0.0021593793044014584, "kl": 0.0019050975792684506, "entropy": 0.2412574555192675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 53235.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "env_runners": {"episode_reward_max": 101.79999999999828, "episode_reward_min": -5.095768978004106, "episode_reward_mean": 52.04553830232959, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -97.00700912493204, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 57.80000000000021, "predator_policy": 114.71666653583702}, "policy_reward_mean": {"prey_policy": 9.576158459050811, "predator_policy": 16.44661069211393}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.6999999999997, 51.00000000000048, 85.09999999999897, 40.67892745010882, 51.600000000000485, 61.64176980124357, 67.7071256341879, 38.60000000000028, 44.320547261944355, 39.11119114628228, 54.18593877549691, 39.98639951639677, 48.10000000000044, 38.90000000000028, 39.700000000000294, 64.90000000000043, 32.79771933905154, 50.50000000000048, 39.26501560786231, 37.90000000000027, 68.60000000000015, 46.70000000000041, 75.8999999999996, 81.8999999999992, 65.9000000000003, 61.9000000000005, 74.59999999999972, 42.00000000000033, 61.65800429903414, 42.500000000000334, 47.20000000000042, 48.60000000000044, 68.70000000000014, 47.00000000000042, 44.70000000000039, 52.80000000000048, 38.76401703800637, 48.60000000000045, 89.09999999999866, 24.4778541542473, 38.80000000000028, 82.79999999999914, 39.100000000000286, 44.20000000000038, 50.389113361702684, 68.20000000000017, 54.700000000000514, 63.50000000000048, 38.70000000000028, 39.30000000000029, 38.354199830217375, 40.0000000000003, 76.0999999999996, 37.10000000000026, 38.50000000000028, 50.20000000000047, 39.30000000000029, 56.300000000000445, 101.79999999999828, 80.82498858376027, 61.200000000000486, 44.80000000000038, 44.900000000000375, 50.700000000000486, 37.50000000000026, 40.70068189636162, 38.90000000000028, 54.300000000000495, 70.5, 36.60000000000025, 60.8000000000005, 66.40000000000032, 37.034567102176304, 69.60000000000008, 53.800000000000516, 54.40000000000046, 82.29999999999916, 47.0696787140058, 39.79879336038985, -5.095768978004106, 54.90000000000048, 86.29323077552354, 72.9999999999998, 42.28305696254419, 60.1000000000005, 31.32259483114496, 31.734680059470357, 40.0000000000003, 44.70529784085386, 39.30000000000029, 39.60000000000029, 60.1442058689353, 48.50000000000044, 65.20000000000039, 44.100000000000364, 39.30000000000029, 65.90000000000036, 66.6000000000003, 36.70000000000025, 38.20000000000027], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.08162864169632, 56.00000000000022, -20.173114030476412, 27.669958114169233, 33.64853264132543, 36.20000000000026, 5.59895297156214, -34.22529912433706, 30.595091865735554, 20.000000000000014, -3.1531638314792736, 31.18185491634105, 27.02948206746923, 25.198551008067646, 15.233968123647715, 5.485978621530046, -65.35665158109452, -19.129735486129967, 7.203375356466577, -24.666951935068326, 11.338514855564327, 29.332818310040427, -4.349170683172142, -21.51297372491885, 2.6087861834796806, -7.053573248419003, -21.66743636114584, 20.000000000000014, 16.673836071392245, 20.000000000000014, 33.619542062093345, 17.672050411204182, 4.398291629059296, 10.666732486579349, -8.647483766322996, 16.50547000108724, 7.4452500283597, -8.483816351116236, -0.08411189073252351, -86.15012662476566, 0.30340606817877397, 9.921698031640338, 17.532483519224954, 10.204777530572388, 34.61965324367617, 17.98995869271124, 47.73506629785113, 15.438637559017758, 18.059922380342506, 18.304198842092692, 13.951372188116546, 41.38209580799961, 55.10310023618567, -24.532757151829756, 7.177789273622944, 10.408878896086392, 16.324011018372527, 17.342558318333744, 19.168704313734317, 7.442826976355224, -0.408820432510306, 21.4715294525795, 25.720674006504908, 18.860036913112197, 46.74519552991344, 6.361248632746843, 15.80183976770322, 19.565258053738553, -63.76867895198912, -13.633546866112631, -3.098830686082734, 20.000000000000014, 15.964017038006054, 11.369066970429092, -8.060452189260673, -7.763768290490097, 34.55884477136473, 27.628786648045594, -25.334280601470432, -72.82886437049176, 13.186754265555882, 0.989531596092269, 33.52632112151218, 44.63834933918826, 17.26022222673256, 7.673375126386754, -56.54265913503411, 1.4148314457882194, -30.549677818873, 19.563305456625784, 20.000000000000014, 42.8964459662863, 29.860034315411287, 16.26684340613228, 27.228933336631854, 13.6133801369024, 13.142139760135736, 6.088734993250604, -45.51767966614538, 15.023256182936414, 0.29757507506703545, -4.778380921639359, 20.000000000000014, 20.000000000000014, 7.17047241264688, 44.99391664779937, -20.02954618887081, -28.26411370922348, 15.038224453119225, 6.037257533467029, 30.8000000000002, 10.017879404533078, 13.562534515535608, 14.336873270040302, 13.3073706894257, -38.78797454992104, 41.26308336228063, 57.80000000000021, 40.00763686484293, 34.424988583761234, 18.09686860614879, 29.689911902193955, -1.871970090586804, 18.716542442329207, 25.400000000000098, 14.485731187877187, -18.921197962945428, 22.341939790305457, 20.000000000000014, -44.94401600149254, -4.467580996597587, 16.71883877449284, 9.27438495628384, 19.009786902048383, 20.000000000000014, 16.391707409096046, 17.797735903835033, 30.54190208162715, -2.824260206124345, -1.201397440565687, 41.60000000000024, 8.98252265812028, 44.69643773798565, 5.989096688619831, 13.663540146752998, 10.316139053174954, 12.848698601640628, 46.275693484836815, 32.10985904633645, 16.063890948667055, -13.658622817990704, 17.96860897832831, 55.11957735745634, 17.555870441464698, 12.196441323692474, -4.436611643410959, 2.207413672397368, 17.6661325524083, -97.00700912493204, -22.805426388909964, 17.69711552521466, 21.324420622954424, 36.79323077552491, 12.123336470312829, 53.3000000000002, 15.90108994675434, 20.000000000000014, -3.1936445347551063, 40.39218184832908, -9.280613826343494, -9.857352860678049, -38.31510563892468, -11.892153724537465, -1.5567428336962066, 17.413915519746197, -29.306596099478988, 12.365467515949124, -19.81333951973776, 20.000000000000014, 12.058446341204771, 15.399678220464299, 20.000000000000014, 25.189551269716677, 8.881276000066704, 8.700610894182736, 24.987536945626253, 10.118125977411399, 34.07094857717233, -19.083793706438122, 11.74585480774792, 8.025907936632656, 20.000000000000014, 20.000000000000014, 44.27992762333421, 47.000000000000234, 13.168067512310525, 4.899343540682231, -20.10642355825076, -23.345433113602724, 20.000000000000014], "policy_predator_policy_reward": [31.781628641696532, 0.0, 37.37311403047666, 6.13004188583091, 14.292710190987922, 0.9587571676868711, 26.011649188448118, 43.29362441443554, 1.0049081342646442, 0.0, 27.253163831479306, 6.359914884902219, 5.645063202207753, 9.834029356443256, 4.366031876352249, 13.51402137846992, 73.01336643688644, 55.79356789228129, 41.694309669681644, 14.880458055202318, 12.754677338194764, 0.7599282716970363, 65.84854392448774, 0.0, 48.87866617820784, 3.66612088673152, 40.56743636114611, 0.0, 3.0261639286077253, 0.0, 4.880457937906906, 8.727949588795802, 14.484676518534771, 3.24801870487786, 27.547483766323133, 15.094529998912728, 28.55521612181978, 11.748365808798873, 21.184111890732527, 102.9501266247647, 28.69659393182121, 29.678301968359637, 9.967516480775028, 8.995222469427578, 19.11690716078393, 4.173480902828852, 6.864933702149097, 11.861362440982203, 25.068092618150278, 4.46778615941451, 5.548627811883424, 1.017904192000637, 1.5968997638145563, 42.43275715183001, 11.580385708604116, 12.832946121686481, 6.603288690055413, 21.388146272271918, 4.03129568626569, 11.85717302364474, 19.00882043251031, 7.128470547420538, 2.9793259934952, 1.0399630868878031, 2.7548044700867944, 12.838751367253122, 3.798160232296744, 7.834741946261458, 80.76867895198818, 41.33354686611284, 35.898830686082746, 0.0, 0.0, 11.430933029570875, 28.354002815209988, 36.07021766454099, 7.329527896039508, 19.582840684550504, 70.46866547945292, 52.17233364675583, 7.113245734444083, 17.510468403907712, 0.7736788784880643, 3.8616506608119643, 2.5397777732674203, 11.62662487361321, 24.849469749288723, 74.4783579399568, 12.211259310512755, 49.164226413436936, 0.0, 5.30355403371393, 5.139965684588894, 3.4331565938676842, 1.5710666633682773, 21.08661986309757, 6.3578602398642285, 13.111265006749361, 65.11767966614563, 4.67674381706355, 26.797070214004474, 16.03793546278501, 0.0, 0.0, 18.923936729046936, 5.011674210506993, 39.22954618887107, 46.164113709223734, 8.005908571867838, 9.418609441545836, 0.0, 9.382120595466887, 6.037465484464356, 5.363126729959662, 53.42114957284232, 28.3594542876532, 0.0, 2.7369166377196015, 0.0, 6.392363135157304, 6.091099866919148, 7.322119624738277, 26.771970090586816, 1.1834575576707924, 0.0, 5.014268812122778, 37.9211979629457, 9.358060209694592, 56.80612929938266, 5.6378867021101335, 17.483097041719418, 10.966327076746676, 9.725615043716127, 0.8902130979516218, 0.0, 17.90829259090392, 2.0022640961649514, 20.158097918373052, 34.99566944132957, 5.62998820536049, 0.0, 10.217477341879686, 2.9035622620145842, 12.810903311380136, 2.1515222414831467, 10.903365660764878, 6.551301398359338, 3.9243065151634164, 2.0901409536637683, 3.5361090513329065, 3.7967167111749864, 46.293297128487566, 6.580422642543862, 3.0441295585352846, 33.43488694225911, 5.874962091464754, 16.792586327602603, 3.1326608079812397, 114.71666653583702, 0.0, 15.878463851830936, 0.0, 0.0, 37.37666352968715, 0.0, 3.7989100532456237, 3.9830569625438534, 21.49364453475514, 1.9078181516711628, 27.080613826343626, 57.94635534671787, 21.548697984030017, 7.083923185270134, 38.099653432433904, 46.337892498006205, 5.5547880817267785, 33.10304962598573, 19.050120218656588, 3.7095542018037, 3.5319994569915067, 4.200321779535665, 0.0, 4.754654599218216, 21.318723999933265, 10.29938910581723, 4.512463054373839, 8.981874022588567, 12.029051422827894, 0.0, 51.43793889869042, 11.27409206336731, 0.0, 0.0, 1.62007237666603, 0.0, 6.431932487689439, 14.000656459317735, 37.906423558251014, 41.54543311360298, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.846908315490005, "mean_inference_ms": 3.757321281596536, "mean_action_processing_ms": 1.8804845834423474, "mean_env_wait_ms": 1.1527950011563894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032150745391845703, "StateBufferConnector_ms": 0.01076352596282959, "ViewRequirementAgentConnector_ms": 0.0914311408996582}, "num_episodes": 64, "episode_return_max": 101.79999999999828, "episode_return_min": -5.095768978004106, "episode_return_mean": 52.04553830232959, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 266.14421618455964, "num_env_steps_trained_throughput_per_sec": 266.14421618455964, "timesteps_total": 680000, "num_env_steps_sampled_lifetime": 680000, "num_agent_steps_sampled_lifetime": 2720000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2720000, "timers": {"training_iteration_time_ms": 31844.859, "restore_workers_time_ms": 0.02, "training_step_time_ms": 31844.688, "sample_time_ms": 1221.685, "learn_time_ms": 30603.829, "learn_throughput": 261.405, "synch_weights_time_ms": 16.484}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "done": false, "training_iteration": 85, "trial_id": "cd905_00000", "date": "2024-08-20_10-10-25", "timestamp": 1724128825, "time_this_iter_s": 30.06400489807129, "time_total_s": 2781.65508890152, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afeae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2781.65508890152, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 27.27906976744186, "ram_util_percent": 71.78604651162789}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8949513839528201, "cur_kl_coeff": 1.2572854757308959e-09, "cur_lr": 0.0001, "total_loss": 0.3925579297489354, "policy_loss": -0.0001266495638807851, "vf_loss": 0.3926845783042529, "vf_explained_var": -0.01323687093598502, "kl": 0.007079631397172061, "entropy": 0.9492405000187102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1999553944767704, "cur_kl_coeff": 3.8369307731045406e-14, "cur_lr": 0.0001, "total_loss": 0.2740356207721763, "policy_loss": -0.0004955012669106797, "vf_loss": 0.2745311210789378, "vf_explained_var": 0.002608124888132489, "kl": 0.0025731349290485776, "entropy": 0.19603681550139473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000}, "env_runners": {"episode_reward_max": 101.79999999999828, "episode_reward_min": -5.095768978004106, "episode_reward_mean": 50.722300633643826, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -97.00700912493204, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 57.80000000000021, "predator_policy": 114.71666653583702}, "policy_reward_mean": {"prey_policy": 8.43231166737124, "predator_policy": 16.928838649450608}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.320547261944355, 39.11119114628228, 54.18593877549691, 39.98639951639677, 48.10000000000044, 38.90000000000028, 39.700000000000294, 64.90000000000043, 32.79771933905154, 50.50000000000048, 39.26501560786231, 37.90000000000027, 68.60000000000015, 46.70000000000041, 75.8999999999996, 81.8999999999992, 65.9000000000003, 61.9000000000005, 74.59999999999972, 42.00000000000033, 61.65800429903414, 42.500000000000334, 47.20000000000042, 48.60000000000044, 68.70000000000014, 47.00000000000042, 44.70000000000039, 52.80000000000048, 38.76401703800637, 48.60000000000045, 89.09999999999866, 24.4778541542473, 38.80000000000028, 82.79999999999914, 39.100000000000286, 44.20000000000038, 50.389113361702684, 68.20000000000017, 54.700000000000514, 63.50000000000048, 38.70000000000028, 39.30000000000029, 38.354199830217375, 40.0000000000003, 76.0999999999996, 37.10000000000026, 38.50000000000028, 50.20000000000047, 39.30000000000029, 56.300000000000445, 101.79999999999828, 80.82498858376027, 61.200000000000486, 44.80000000000038, 44.900000000000375, 50.700000000000486, 37.50000000000026, 40.70068189636162, 38.90000000000028, 54.300000000000495, 70.5, 36.60000000000025, 60.8000000000005, 66.40000000000032, 37.034567102176304, 69.60000000000008, 53.800000000000516, 54.40000000000046, 82.29999999999916, 47.0696787140058, 39.79879336038985, -5.095768978004106, 54.90000000000048, 86.29323077552354, 72.9999999999998, 42.28305696254419, 60.1000000000005, 31.32259483114496, 31.734680059470357, 40.0000000000003, 44.70529784085386, 39.30000000000029, 39.60000000000029, 60.1442058689353, 48.50000000000044, 65.20000000000039, 44.100000000000364, 39.30000000000029, 65.90000000000036, 66.6000000000003, 36.70000000000025, 38.20000000000027, 15.87604529313841, 42.80000000000034, 34.900000000000226, 55.500000000000504, 51.9000000000005, 63.50000000000049, 53.800000000000516, 20.42801072382402], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-65.35665158109452, -19.129735486129967, 7.203375356466577, -24.666951935068326, 11.338514855564327, 29.332818310040427, -4.349170683172142, -21.51297372491885, 2.6087861834796806, -7.053573248419003, -21.66743636114584, 20.000000000000014, 16.673836071392245, 20.000000000000014, 33.619542062093345, 17.672050411204182, 4.398291629059296, 10.666732486579349, -8.647483766322996, 16.50547000108724, 7.4452500283597, -8.483816351116236, -0.08411189073252351, -86.15012662476566, 0.30340606817877397, 9.921698031640338, 17.532483519224954, 10.204777530572388, 34.61965324367617, 17.98995869271124, 47.73506629785113, 15.438637559017758, 18.059922380342506, 18.304198842092692, 13.951372188116546, 41.38209580799961, 55.10310023618567, -24.532757151829756, 7.177789273622944, 10.408878896086392, 16.324011018372527, 17.342558318333744, 19.168704313734317, 7.442826976355224, -0.408820432510306, 21.4715294525795, 25.720674006504908, 18.860036913112197, 46.74519552991344, 6.361248632746843, 15.80183976770322, 19.565258053738553, -63.76867895198912, -13.633546866112631, -3.098830686082734, 20.000000000000014, 15.964017038006054, 11.369066970429092, -8.060452189260673, -7.763768290490097, 34.55884477136473, 27.628786648045594, -25.334280601470432, -72.82886437049176, 13.186754265555882, 0.989531596092269, 33.52632112151218, 44.63834933918826, 17.26022222673256, 7.673375126386754, -56.54265913503411, 1.4148314457882194, -30.549677818873, 19.563305456625784, 20.000000000000014, 42.8964459662863, 29.860034315411287, 16.26684340613228, 27.228933336631854, 13.6133801369024, 13.142139760135736, 6.088734993250604, -45.51767966614538, 15.023256182936414, 0.29757507506703545, -4.778380921639359, 20.000000000000014, 20.000000000000014, 7.17047241264688, 44.99391664779937, -20.02954618887081, -28.26411370922348, 15.038224453119225, 6.037257533467029, 30.8000000000002, 10.017879404533078, 13.562534515535608, 14.336873270040302, 13.3073706894257, -38.78797454992104, 41.26308336228063, 57.80000000000021, 40.00763686484293, 34.424988583761234, 18.09686860614879, 29.689911902193955, -1.871970090586804, 18.716542442329207, 25.400000000000098, 14.485731187877187, -18.921197962945428, 22.341939790305457, 20.000000000000014, -44.94401600149254, -4.467580996597587, 16.71883877449284, 9.27438495628384, 19.009786902048383, 20.000000000000014, 16.391707409096046, 17.797735903835033, 30.54190208162715, -2.824260206124345, -1.201397440565687, 41.60000000000024, 8.98252265812028, 44.69643773798565, 5.989096688619831, 13.663540146752998, 10.316139053174954, 12.848698601640628, 46.275693484836815, 32.10985904633645, 16.063890948667055, -13.658622817990704, 17.96860897832831, 55.11957735745634, 17.555870441464698, 12.196441323692474, -4.436611643410959, 2.207413672397368, 17.6661325524083, -97.00700912493204, -22.805426388909964, 17.69711552521466, 21.324420622954424, 36.79323077552491, 12.123336470312829, 53.3000000000002, 15.90108994675434, 20.000000000000014, -3.1936445347551063, 40.39218184832908, -9.280613826343494, -9.857352860678049, -38.31510563892468, -11.892153724537465, -1.5567428336962066, 17.413915519746197, -29.306596099478988, 12.365467515949124, -19.81333951973776, 20.000000000000014, 12.058446341204771, 15.399678220464299, 20.000000000000014, 25.189551269716677, 8.881276000066704, 8.700610894182736, 24.987536945626253, 10.118125977411399, 34.07094857717233, -19.083793706438122, 11.74585480774792, 8.025907936632656, 20.000000000000014, 20.000000000000014, 44.27992762333421, 47.000000000000234, 13.168067512310525, 4.899343540682231, -20.10642355825076, -23.345433113602724, 20.000000000000014, -32.848041328596686, -28.10736887452422, -4.415003102247123, 24.50000000000008, 15.875256863309435, -63.14814860237524, 18.422342689601034, 29.824885532296527, 27.836565466629914, 16.75285135268087, -5.294024455586026, 39.06004010678824, 14.32545342677587, 33.322288752946655, -22.016441274322126, -49.6508501874321], "policy_predator_policy_reward": [73.01336643688644, 55.79356789228129, 41.694309669681644, 14.880458055202318, 12.754677338194764, 0.7599282716970363, 65.84854392448774, 0.0, 48.87866617820784, 3.66612088673152, 40.56743636114611, 0.0, 3.0261639286077253, 0.0, 4.880457937906906, 8.727949588795802, 14.484676518534771, 3.24801870487786, 27.547483766323133, 15.094529998912728, 28.55521612181978, 11.748365808798873, 21.184111890732527, 102.9501266247647, 28.69659393182121, 29.678301968359637, 9.967516480775028, 8.995222469427578, 19.11690716078393, 4.173480902828852, 6.864933702149097, 11.861362440982203, 25.068092618150278, 4.46778615941451, 5.548627811883424, 1.017904192000637, 1.5968997638145563, 42.43275715183001, 11.580385708604116, 12.832946121686481, 6.603288690055413, 21.388146272271918, 4.03129568626569, 11.85717302364474, 19.00882043251031, 7.128470547420538, 2.9793259934952, 1.0399630868878031, 2.7548044700867944, 12.838751367253122, 3.798160232296744, 7.834741946261458, 80.76867895198818, 41.33354686611284, 35.898830686082746, 0.0, 0.0, 11.430933029570875, 28.354002815209988, 36.07021766454099, 7.329527896039508, 19.582840684550504, 70.46866547945292, 52.17233364675583, 7.113245734444083, 17.510468403907712, 0.7736788784880643, 3.8616506608119643, 2.5397777732674203, 11.62662487361321, 24.849469749288723, 74.4783579399568, 12.211259310512755, 49.164226413436936, 0.0, 5.30355403371393, 5.139965684588894, 3.4331565938676842, 1.5710666633682773, 21.08661986309757, 6.3578602398642285, 13.111265006749361, 65.11767966614563, 4.67674381706355, 26.797070214004474, 16.03793546278501, 0.0, 0.0, 18.923936729046936, 5.011674210506993, 39.22954618887107, 46.164113709223734, 8.005908571867838, 9.418609441545836, 0.0, 9.382120595466887, 6.037465484464356, 5.363126729959662, 53.42114957284232, 28.3594542876532, 0.0, 2.7369166377196015, 0.0, 6.392363135157304, 6.091099866919148, 7.322119624738277, 26.771970090586816, 1.1834575576707924, 0.0, 5.014268812122778, 37.9211979629457, 9.358060209694592, 56.80612929938266, 5.6378867021101335, 17.483097041719418, 10.966327076746676, 9.725615043716127, 0.8902130979516218, 0.0, 17.90829259090392, 2.0022640961649514, 20.158097918373052, 34.99566944132957, 5.62998820536049, 0.0, 10.217477341879686, 2.9035622620145842, 12.810903311380136, 2.1515222414831467, 10.903365660764878, 6.551301398359338, 3.9243065151634164, 2.0901409536637683, 3.5361090513329065, 3.7967167111749864, 46.293297128487566, 6.580422642543862, 3.0441295585352846, 33.43488694225911, 5.874962091464754, 16.792586327602603, 3.1326608079812397, 114.71666653583702, 0.0, 15.878463851830936, 0.0, 0.0, 37.37666352968715, 0.0, 3.7989100532456237, 3.9830569625438534, 21.49364453475514, 1.9078181516711628, 27.080613826343626, 57.94635534671787, 21.548697984030017, 7.083923185270134, 38.099653432433904, 46.337892498006205, 5.5547880817267785, 33.10304962598573, 19.050120218656588, 3.7095542018037, 3.5319994569915067, 4.200321779535665, 0.0, 4.754654599218216, 21.318723999933265, 10.29938910581723, 4.512463054373839, 8.981874022588567, 12.029051422827894, 0.0, 51.43793889869042, 11.27409206336731, 0.0, 0.0, 1.62007237666603, 0.0, 6.431932487689439, 14.000656459317735, 37.906423558251014, 41.54543311360298, 0.0, 14.040860454226316, 62.790595042033544, 22.715003102247177, 0.0, 41.12016669969632, 41.05272503936876, 2.277657310398963, 4.975114467703656, 4.363434533370231, 2.9471486473191, 23.9940244555861, 5.739959893211994, 5.174546573224097, 0.9777112470535836, 92.09530218557872, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.834536945313584, "mean_inference_ms": 3.756570718205256, "mean_action_processing_ms": 1.8733428175051556, "mean_env_wait_ms": 1.1506590496691798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031701326370239258, "StateBufferConnector_ms": 0.010214805603027344, "ViewRequirementAgentConnector_ms": 0.0887458324432373}, "num_episodes": 8, "episode_return_max": 101.79999999999828, "episode_return_min": -5.095768978004106, "episode_return_mean": 50.722300633643826, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 266.36811974900405, "num_env_steps_trained_throughput_per_sec": 266.36811974900405, "timesteps_total": 688000, "num_env_steps_sampled_lifetime": 688000, "num_agent_steps_sampled_lifetime": 2752000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2752000, "timers": {"training_iteration_time_ms": 31489.84, "restore_workers_time_ms": 0.018, "training_step_time_ms": 31489.778, "sample_time_ms": 1162.435, "learn_time_ms": 30310.342, "learn_throughput": 263.936, "synch_weights_time_ms": 14.848}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000}, "done": false, "training_iteration": 86, "trial_id": "cd905_00000", "date": "2024-08-20_10-10-55", "timestamp": 1724128855, "time_this_iter_s": 30.038624048233032, "time_total_s": 2811.693712949753, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a167790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2811.693712949753, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 26.469047619047615, "ram_util_percent": 71.68095238095236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4571514970608175, "cur_kl_coeff": 1.2572854757308959e-09, "cur_lr": 0.0001, "total_loss": 1.5863907652241842, "policy_loss": -0.002922778589177936, "vf_loss": 1.5893135356524635, "vf_explained_var": -0.01313061203275408, "kl": 0.006580114484307752, "entropy": 0.9187263379967402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 54495.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.33512544758499613, "cur_kl_coeff": 1.9184653865522703e-14, "cur_lr": 0.0001, "total_loss": 1.1899528155251156, "policy_loss": -0.0007371763757888286, "vf_loss": 1.1906899890256306, "vf_explained_var": 0.001031799354250469, "kl": 0.0018333867089801116, "entropy": 0.15117655157569854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 54495.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000}, "env_runners": {"episode_reward_max": 86.29323077552354, "episode_reward_min": -213.25759062587548, "episode_reward_mean": 45.97339845241572, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -375.0743120642624, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 55.11957735745634, "predator_policy": 407.55668445359385}, "policy_reward_mean": {"prey_policy": 3.4705637274591172, "predator_policy": 19.516135498748678}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.034567102176304, 69.60000000000008, 53.800000000000516, 54.40000000000046, 82.29999999999916, 47.0696787140058, 39.79879336038985, -5.095768978004106, 54.90000000000048, 86.29323077552354, 72.9999999999998, 42.28305696254419, 60.1000000000005, 31.32259483114496, 31.734680059470357, 40.0000000000003, 44.70529784085386, 39.30000000000029, 39.60000000000029, 60.1442058689353, 48.50000000000044, 65.20000000000039, 44.100000000000364, 39.30000000000029, 65.90000000000036, 66.6000000000003, 36.70000000000025, 38.20000000000027, 15.87604529313841, 42.80000000000034, 34.900000000000226, 55.500000000000504, 51.9000000000005, 63.50000000000049, 53.800000000000516, 20.42801072382402, 68.40000000000018, 37.90000000000027, 38.70000000000028, 39.700000000000294, 46.50000000000042, 47.60000000000043, 36.60000000000025, 47.40000000000043, 37.30000000000026, 42.90000000000034, 39.700000000000294, 44.100000000000364, 65.3283735404991, 38.95864949445304, 54.10000000000044, 40.0000000000003, 45.76076270080551, 62.900000000000475, 45.90000000000039, 62.900000000000496, 51.100000000000456, 56.58318160043734, 13.459732946121207, 37.281775974127434, 85.99999999999888, 53.90000000000052, 66.8000000000003, 56.600000000000506, 39.910595523785105, 43.700000000000365, -213.25759062587548, 72.79999999999987, 28.970619416598, 58.10000000000048, 79.08246418237076, 38.300000000000274, 40.0000000000003, 36.900000000000254, 49.100000000000456, 39.000000000000284, 40.60000000000031, 78.29999999999941, 38.60000000000028, 43.60000000000036, 66.91540069111029, 25.766418681307538, 82.19999999999919, 50.07073844144719, 76.69999999999958, 38.80000000000028, 53.11438352824363, 34.200000000000216, 60.600000000000506, 47.400000000000425, 39.30000000000029, 58.22612598048918, 62.50000000000053, 45.60000000000039, 59.100000000000485, 41.200000000000315, 18.26946248199477, 33.50435812963553, 45.00000000000038, 55.30000000000048], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.663540146752998, 10.316139053174954, 12.848698601640628, 46.275693484836815, 32.10985904633645, 16.063890948667055, -13.658622817990704, 17.96860897832831, 55.11957735745634, 17.555870441464698, 12.196441323692474, -4.436611643410959, 2.207413672397368, 17.6661325524083, -97.00700912493204, -22.805426388909964, 17.69711552521466, 21.324420622954424, 36.79323077552491, 12.123336470312829, 53.3000000000002, 15.90108994675434, 20.000000000000014, -3.1936445347551063, 40.39218184832908, -9.280613826343494, -9.857352860678049, -38.31510563892468, -11.892153724537465, -1.5567428336962066, 17.413915519746197, -29.306596099478988, 12.365467515949124, -19.81333951973776, 20.000000000000014, 12.058446341204771, 15.399678220464299, 20.000000000000014, 25.189551269716677, 8.881276000066704, 8.700610894182736, 24.987536945626253, 10.118125977411399, 34.07094857717233, -19.083793706438122, 11.74585480774792, 8.025907936632656, 20.000000000000014, 20.000000000000014, 44.27992762333421, 47.000000000000234, 13.168067512310525, 4.899343540682231, -20.10642355825076, -23.345433113602724, 20.000000000000014, -32.848041328596686, -28.10736887452422, -4.415003102247123, 24.50000000000008, 15.875256863309435, -63.14814860237524, 18.422342689601034, 29.824885532296527, 27.836565466629914, 16.75285135268087, -5.294024455586026, 39.06004010678824, 14.32545342677587, 33.322288752946655, -22.016441274322126, -49.6508501874321, 43.66461876288983, 9.764879297240245, 8.635917294384814, -5.787288216133986, 15.445349006685657, -6.049699443957447, 9.344147106748318, 15.84387429079705, -12.326649586298378, 0.8297945858691737, -15.087493859251715, 17.02255501545707, -10.385984546792058, -10.603163092616942, 1.5946164193558319, 10.055464424217876, 7.884581854816906, -26.588254857548705, 19.140988119536644, -12.049178621659443, -17.738358181952727, 22.700000000000053, 22.360633289997274, 8.962280520761764, 18.855332918641547, 22.345184937451275, -11.727692626851246, -99.57849575266386, -24.787553877629122, 19.126549750883253, 2.185986116722493, 20.90000000000003, 15.67709369229945, 12.593035401549526, 4.85135400539826, 43.400000000000226, 23.947482354279337, 17.560682779330886, 18.87002045016221, 37.97759945015696, -21.707494105987344, -11.492271893403622, 25.060889555622733, 15.115294259819606, -27.466982158370193, -15.623674956708797, -12.643376572130077, -10.233506639957831, 44.70782828923657, 32.25779532517414, 12.09590425918516, 34.40000000000026, 46.8120029699347, 5.929893942882121, 18.060829562093392, 33.7324272455861, 0.7884153856778529, -28.547679880358956, 12.595608626335034, -13.959917269288622, -250.02238717307353, -375.0743120642624, 45.847736623850494, 22.331707537528477, -1.0944436768959358, -54.4997554692774, -3.403766474658501, 22.737751982750634, 30.6632414315091, 1.904668204512278, 20.000000000000014, -19.99629585249076, 20.000000000000014, 20.000000000000014, -8.057358200504357, -26.83072538428918, 7.961365599787655, 14.459474886598928, -10.978980571208092, 20.000000000000014, 8.559459844431261, -17.07716298439872, 43.300050218260495, 1.8668083054631321, -0.336102331125684, 19.048161506639882, -6.183687314314335, 12.332703864166186, -48.962119250727035, 17.171823231671908, -32.54379310196647, 2.5970965935907366, 47.040586389873575, 34.40000000000025, -83.06759985206976, -11.381948134053184, 31.938038100093806, 13.49976334872152, 4.8366461103466065, 20.000000000000014, 29.63216177067626, 17.70522713914709, -7.66223428515849, -82.67299951119784, 40.700000000000244, 18.967625192916397, 15.722915235935291, 0.38591533187827354, 9.784455930354497, 20.000000000000014, -15.808615582774497, 39.69132918157343, 33.50000000000024, 29.000000000000163, 17.396479243987457, -0.2153954340742796, 28.24950549614742, 7.907445359585228, 5.320266131771014, 3.513031963100891, -2.609899878436246, -12.77569441248192, 9.717986541595, -6.363304034755162, 21.193549950141225, 7.830564073459092, -9.252847003810032, 22.947599567387226], "policy_predator_policy_reward": [2.1515222414831467, 10.903365660764878, 6.551301398359338, 3.9243065151634164, 2.0901409536637683, 3.5361090513329065, 3.7967167111749864, 46.293297128487566, 6.580422642543862, 3.0441295585352846, 33.43488694225911, 5.874962091464754, 16.792586327602603, 3.1326608079812397, 114.71666653583702, 0.0, 15.878463851830936, 0.0, 0.0, 37.37666352968715, 0.0, 3.7989100532456237, 3.9830569625438534, 21.49364453475514, 1.9078181516711628, 27.080613826343626, 57.94635534671787, 21.548697984030017, 7.083923185270134, 38.099653432433904, 46.337892498006205, 5.5547880817267785, 33.10304962598573, 19.050120218656588, 3.7095542018037, 3.5319994569915067, 4.200321779535665, 0.0, 4.754654599218216, 21.318723999933265, 10.29938910581723, 4.512463054373839, 8.981874022588567, 12.029051422827894, 0.0, 51.43793889869042, 11.27409206336731, 0.0, 0.0, 1.62007237666603, 0.0, 6.431932487689439, 14.000656459317735, 37.906423558251014, 41.54543311360298, 0.0, 14.040860454226316, 62.790595042033544, 22.715003102247177, 0.0, 41.12016669969632, 41.05272503936876, 2.277657310398963, 4.975114467703656, 4.363434533370231, 2.9471486473191, 23.9940244555861, 5.739959893211994, 5.174546573224097, 0.9777112470535836, 92.09530218557872, 0.0, 5.635381237110401, 9.33512070275972, 10.364082705615152, 24.68728821613407, 4.154650993314308, 25.14969944395754, 9.855852893251647, 4.656125709202913, 55.79297559001657, 2.2038794104127817, 0.0, 45.664938843794836, 52.918692088321656, 4.670455551087641, 26.60538358064415, 9.14453557578209, 11.11541814518306, 44.888254857548965, 4.95901188046336, 30.84917862165964, 34.73835818195297, 0.0, 2.739366710002776, 10.037719479238202, 9.973040621857141, 14.154815062548776, 95.44191880451726, 54.82291906944983, 52.49666586698787, 7.264338259758221, 16.91401388327748, 0.0, 10.595458755101905, 6.895174851854158, 14.648645994601708, 0.0, 2.152517645720738, 2.2393172206690974, 1.0299795498377873, 5.022400549843285, 19.3607037796982, 64.93906221969318, 8.523336851424874, 7.883660933569649, 51.021183066564404, 5.529206994636281, 17.67104443591592, 42.48761475029954, 1.063482206561126, 7.970894179028598, 7.404095740814805, 0.0, 0.9879970300655342, 13.070106057117846, 1.7391704379065986, 3.067572754414146, 19.12218013810695, 48.54767988035921, 20.62840496035056, 24.435903682603186, 4.282424157866812, 407.55668445359385, 2.6522633761497345, 1.9682924624715734, 73.0230801448728, 11.54173841789815, 38.766014491907974, 0.0, 29.382799036383954, 17.13175550996617, 0.0, 38.29629585249102, 0.0, 0.0, 26.957358200504483, 44.83072538428944, 19.890540411619824, 6.788619101993531, 29.97898057120827, 0.0, 14.540540155568708, 34.57716298439897, 13.147755455649886, 19.985386020626642, 19.036102331125687, 0.8518384933601226, 25.583687314314435, 11.867296135833783, 53.33211479570386, 45.37358191446128, 49.05148113674898, 6.661634052934429, 0.7594136101266598, 0.0, 67.38191130884373, 77.13837511872522, 13.16196189990642, 18.10023665127845, 13.96335388965336, 0.0, 2.082221757567029, 3.6947728608528956, 26.162234285158604, 98.37299951119695, 0.0, 0.9323748070836053, 12.97708476406467, 18.314084668121716, 9.515544069645468, 0.0, 33.40861558277474, 0.9347967989155003, 0.0, 0.0, 9.003520756012522, 19.415395434074288, 11.550494503852738, 11.392554640414737, 10.006151852266818, 22.360550052861214, 31.834809793250734, 1.8202469796624516, 4.510612328459338, 25.63906329433621, 4.806450049858806, 11.169435926540874, 29.179814939825114, 12.425432496597905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.81661356015957, "mean_inference_ms": 3.732631733908599, "mean_action_processing_ms": 1.8659318864519816, "mean_env_wait_ms": 1.1446237862802122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002927064895629883, "StateBufferConnector_ms": 0.00957179069519043, "ViewRequirementAgentConnector_ms": 0.08455216884613037}, "num_episodes": 64, "episode_return_max": 86.29323077552354, "episode_return_min": -213.25759062587548, "episode_return_mean": 45.97339845241572, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 265.14908371206843, "num_env_steps_trained_throughput_per_sec": 265.14908371206843, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 2784000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2784000, "timers": {"training_iteration_time_ms": 31198.225, "restore_workers_time_ms": 0.015, "training_step_time_ms": 31198.171, "sample_time_ms": 1115.161, "learn_time_ms": 30067.443, "learn_throughput": 266.069, "synch_weights_time_ms": 13.749}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000}, "done": false, "training_iteration": 87, "trial_id": "cd905_00000", "date": "2024-08-20_10-11-25", "timestamp": 1724128885, "time_this_iter_s": 30.176594257354736, "time_total_s": 2841.8703072071075, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f6bdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2841.8703072071075, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 28.090697674418603, "ram_util_percent": 72.10930232558138}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9375072540390113, "cur_kl_coeff": 1.2572854757308959e-09, "cur_lr": 0.0001, "total_loss": 0.8382797126259123, "policy_loss": -0.0001121794997108361, "vf_loss": 0.8383918951901178, "vf_explained_var": -0.010144579126721337, "kl": 0.00045629939138759965, "entropy": 0.8828849818971422, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 55125.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1889721585955057, "cur_kl_coeff": 9.592326932761352e-15, "cur_lr": 0.0001, "total_loss": 0.5175995511195016, "policy_loss": -0.0011697390796764503, "vf_loss": 0.5187692902390919, "vf_explained_var": 0.0017838029634384882, "kl": 0.0011775812934085401, "entropy": 0.14037057088008004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 55125.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000}, "env_runners": {"episode_reward_max": 86.29323077552354, "episode_reward_min": -213.25759062587548, "episode_reward_mean": 44.70813525494953, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -375.0743120642624, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 53.3000000000002, "predator_policy": 407.55668445359385}, "policy_reward_mean": {"prey_policy": 1.7340997181164972, "predator_policy": 20.619967909358188}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.90000000000048, 86.29323077552354, 72.9999999999998, 42.28305696254419, 60.1000000000005, 31.32259483114496, 31.734680059470357, 40.0000000000003, 44.70529784085386, 39.30000000000029, 39.60000000000029, 60.1442058689353, 48.50000000000044, 65.20000000000039, 44.100000000000364, 39.30000000000029, 65.90000000000036, 66.6000000000003, 36.70000000000025, 38.20000000000027, 15.87604529313841, 42.80000000000034, 34.900000000000226, 55.500000000000504, 51.9000000000005, 63.50000000000049, 53.800000000000516, 20.42801072382402, 68.40000000000018, 37.90000000000027, 38.70000000000028, 39.700000000000294, 46.50000000000042, 47.60000000000043, 36.60000000000025, 47.40000000000043, 37.30000000000026, 42.90000000000034, 39.700000000000294, 44.100000000000364, 65.3283735404991, 38.95864949445304, 54.10000000000044, 40.0000000000003, 45.76076270080551, 62.900000000000475, 45.90000000000039, 62.900000000000496, 51.100000000000456, 56.58318160043734, 13.459732946121207, 37.281775974127434, 85.99999999999888, 53.90000000000052, 66.8000000000003, 56.600000000000506, 39.910595523785105, 43.700000000000365, -213.25759062587548, 72.79999999999987, 28.970619416598, 58.10000000000048, 79.08246418237076, 38.300000000000274, 40.0000000000003, 36.900000000000254, 49.100000000000456, 39.000000000000284, 40.60000000000031, 78.29999999999941, 38.60000000000028, 43.60000000000036, 66.91540069111029, 25.766418681307538, 82.19999999999919, 50.07073844144719, 76.69999999999958, 38.80000000000028, 53.11438352824363, 34.200000000000216, 60.600000000000506, 47.400000000000425, 39.30000000000029, 58.22612598048918, 62.50000000000053, 45.60000000000039, 59.100000000000485, 41.200000000000315, 18.26946248199477, 33.50435812963553, 45.00000000000038, 55.30000000000048, 38.60000000000028, 38.10000000000027, 39.000000000000284, 39.100000000000286, 45.69071588069351, 32.300000000000175, -21.209765428746294, 40.80000000000031], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [17.69711552521466, 21.324420622954424, 36.79323077552491, 12.123336470312829, 53.3000000000002, 15.90108994675434, 20.000000000000014, -3.1936445347551063, 40.39218184832908, -9.280613826343494, -9.857352860678049, -38.31510563892468, -11.892153724537465, -1.5567428336962066, 17.413915519746197, -29.306596099478988, 12.365467515949124, -19.81333951973776, 20.000000000000014, 12.058446341204771, 15.399678220464299, 20.000000000000014, 25.189551269716677, 8.881276000066704, 8.700610894182736, 24.987536945626253, 10.118125977411399, 34.07094857717233, -19.083793706438122, 11.74585480774792, 8.025907936632656, 20.000000000000014, 20.000000000000014, 44.27992762333421, 47.000000000000234, 13.168067512310525, 4.899343540682231, -20.10642355825076, -23.345433113602724, 20.000000000000014, -32.848041328596686, -28.10736887452422, -4.415003102247123, 24.50000000000008, 15.875256863309435, -63.14814860237524, 18.422342689601034, 29.824885532296527, 27.836565466629914, 16.75285135268087, -5.294024455586026, 39.06004010678824, 14.32545342677587, 33.322288752946655, -22.016441274322126, -49.6508501874321, 43.66461876288983, 9.764879297240245, 8.635917294384814, -5.787288216133986, 15.445349006685657, -6.049699443957447, 9.344147106748318, 15.84387429079705, -12.326649586298378, 0.8297945858691737, -15.087493859251715, 17.02255501545707, -10.385984546792058, -10.603163092616942, 1.5946164193558319, 10.055464424217876, 7.884581854816906, -26.588254857548705, 19.140988119536644, -12.049178621659443, -17.738358181952727, 22.700000000000053, 22.360633289997274, 8.962280520761764, 18.855332918641547, 22.345184937451275, -11.727692626851246, -99.57849575266386, -24.787553877629122, 19.126549750883253, 2.185986116722493, 20.90000000000003, 15.67709369229945, 12.593035401549526, 4.85135400539826, 43.400000000000226, 23.947482354279337, 17.560682779330886, 18.87002045016221, 37.97759945015696, -21.707494105987344, -11.492271893403622, 25.060889555622733, 15.115294259819606, -27.466982158370193, -15.623674956708797, -12.643376572130077, -10.233506639957831, 44.70782828923657, 32.25779532517414, 12.09590425918516, 34.40000000000026, 46.8120029699347, 5.929893942882121, 18.060829562093392, 33.7324272455861, 0.7884153856778529, -28.547679880358956, 12.595608626335034, -13.959917269288622, -250.02238717307353, -375.0743120642624, 45.847736623850494, 22.331707537528477, -1.0944436768959358, -54.4997554692774, -3.403766474658501, 22.737751982750634, 30.6632414315091, 1.904668204512278, 20.000000000000014, -19.99629585249076, 20.000000000000014, 20.000000000000014, -8.057358200504357, -26.83072538428918, 7.961365599787655, 14.459474886598928, -10.978980571208092, 20.000000000000014, 8.559459844431261, -17.07716298439872, 43.300050218260495, 1.8668083054631321, -0.336102331125684, 19.048161506639882, -6.183687314314335, 12.332703864166186, -48.962119250727035, 17.171823231671908, -32.54379310196647, 2.5970965935907366, 47.040586389873575, 34.40000000000025, -83.06759985206976, -11.381948134053184, 31.938038100093806, 13.49976334872152, 4.8366461103466065, 20.000000000000014, 29.63216177067626, 17.70522713914709, -7.66223428515849, -82.67299951119784, 40.700000000000244, 18.967625192916397, 15.722915235935291, 0.38591533187827354, 9.784455930354497, 20.000000000000014, -15.808615582774497, 39.69132918157343, 33.50000000000024, 29.000000000000163, 17.396479243987457, -0.2153954340742796, 28.24950549614742, 7.907445359585228, 5.320266131771014, 3.513031963100891, -2.609899878436246, -12.77569441248192, 9.717986541595, -6.363304034755162, 21.193549950141225, 7.830564073459092, -9.252847003810032, 22.947599567387226, 14.398007184250757, -5.518557797949539, -22.311998723574497, 3.555099093009504, 23.60000000000007, -45.8661257866735, 17.861500050608164, 11.379270717197045, 15.863185412039622, 9.319460333129273, -75.42743047998594, -16.06920250094001, -86.47090561750404, -115.52942748680601, 20.900000000000027, 19.108519366587878], "policy_predator_policy_reward": [15.878463851830936, 0.0, 0.0, 37.37666352968715, 0.0, 3.7989100532456237, 3.9830569625438534, 21.49364453475514, 1.9078181516711628, 27.080613826343626, 57.94635534671787, 21.548697984030017, 7.083923185270134, 38.099653432433904, 46.337892498006205, 5.5547880817267785, 33.10304962598573, 19.050120218656588, 3.7095542018037, 3.5319994569915067, 4.200321779535665, 0.0, 4.754654599218216, 21.318723999933265, 10.29938910581723, 4.512463054373839, 8.981874022588567, 12.029051422827894, 0.0, 51.43793889869042, 11.27409206336731, 0.0, 0.0, 1.62007237666603, 0.0, 6.431932487689439, 14.000656459317735, 37.906423558251014, 41.54543311360298, 0.0, 14.040860454226316, 62.790595042033544, 22.715003102247177, 0.0, 41.12016669969632, 41.05272503936876, 2.277657310398963, 4.975114467703656, 4.363434533370231, 2.9471486473191, 23.9940244555861, 5.739959893211994, 5.174546573224097, 0.9777112470535836, 92.09530218557872, 0.0, 5.635381237110401, 9.33512070275972, 10.364082705615152, 24.68728821613407, 4.154650993314308, 25.14969944395754, 9.855852893251647, 4.656125709202913, 55.79297559001657, 2.2038794104127817, 0.0, 45.664938843794836, 52.918692088321656, 4.670455551087641, 26.60538358064415, 9.14453557578209, 11.11541814518306, 44.888254857548965, 4.95901188046336, 30.84917862165964, 34.73835818195297, 0.0, 2.739366710002776, 10.037719479238202, 9.973040621857141, 14.154815062548776, 95.44191880451726, 54.82291906944983, 52.49666586698787, 7.264338259758221, 16.91401388327748, 0.0, 10.595458755101905, 6.895174851854158, 14.648645994601708, 0.0, 2.152517645720738, 2.2393172206690974, 1.0299795498377873, 5.022400549843285, 19.3607037796982, 64.93906221969318, 8.523336851424874, 7.883660933569649, 51.021183066564404, 5.529206994636281, 17.67104443591592, 42.48761475029954, 1.063482206561126, 7.970894179028598, 7.404095740814805, 0.0, 0.9879970300655342, 13.070106057117846, 1.7391704379065986, 3.067572754414146, 19.12218013810695, 48.54767988035921, 20.62840496035056, 24.435903682603186, 4.282424157866812, 407.55668445359385, 2.6522633761497345, 1.9682924624715734, 73.0230801448728, 11.54173841789815, 38.766014491907974, 0.0, 29.382799036383954, 17.13175550996617, 0.0, 38.29629585249102, 0.0, 0.0, 26.957358200504483, 44.83072538428944, 19.890540411619824, 6.788619101993531, 29.97898057120827, 0.0, 14.540540155568708, 34.57716298439897, 13.147755455649886, 19.985386020626642, 19.036102331125687, 0.8518384933601226, 25.583687314314435, 11.867296135833783, 53.33211479570386, 45.37358191446128, 49.05148113674898, 6.661634052934429, 0.7594136101266598, 0.0, 67.38191130884373, 77.13837511872522, 13.16196189990642, 18.10023665127845, 13.96335388965336, 0.0, 2.082221757567029, 3.6947728608528956, 26.162234285158604, 98.37299951119695, 0.0, 0.9323748070836053, 12.97708476406467, 18.314084668121716, 9.515544069645468, 0.0, 33.40861558277474, 0.9347967989155003, 0.0, 0.0, 9.003520756012522, 19.415395434074288, 11.550494503852738, 11.392554640414737, 10.006151852266818, 22.360550052861214, 31.834809793250734, 1.8202469796624516, 4.510612328459338, 25.63906329433621, 4.806450049858806, 11.169435926540874, 29.179814939825114, 12.425432496597905, 5.101992815749209, 24.618557797949624, 41.31199872357477, 15.54490090699046, 0.0, 61.26612578667372, 1.9384999493918231, 7.920729282802921, 9.602514124366436, 10.905556011157719, 10.232578615832525, 113.56405436509299, 31.032799239333958, 149.7577684362277, 0.0, 0.791480633412128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.804390789290146, "mean_inference_ms": 3.7320069485537926, "mean_action_processing_ms": 1.8591169500918499, "mean_env_wait_ms": 1.142583834156464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028963088989257812, "StateBufferConnector_ms": 0.009365439414978027, "ViewRequirementAgentConnector_ms": 0.08254790306091309}, "num_episodes": 8, "episode_return_max": 86.29323077552354, "episode_return_min": -213.25759062587548, "episode_return_mean": 44.70813525494953, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 258.9796250785249, "num_env_steps_trained_throughput_per_sec": 258.9796250785249, "timesteps_total": 704000, "num_env_steps_sampled_lifetime": 704000, "num_agent_steps_sampled_lifetime": 2816000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2816000, "timers": {"training_iteration_time_ms": 30991.93, "restore_workers_time_ms": 0.015, "training_step_time_ms": 30991.885, "sample_time_ms": 1063.773, "learn_time_ms": 29914.036, "learn_throughput": 267.433, "synch_weights_time_ms": 12.344}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000}, "done": false, "training_iteration": 88, "trial_id": "cd905_00000", "date": "2024-08-20_10-11-56", "timestamp": 1724128916, "time_this_iter_s": 30.89939832687378, "time_total_s": 2872.7697055339813, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a17dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2872.7697055339813, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 31.19545454545454, "ram_util_percent": 73.14545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5171713357643475, "cur_kl_coeff": 6.286427378654479e-10, "cur_lr": 0.0001, "total_loss": 1.3691429404985338, "policy_loss": -0.0009437280051070192, "vf_loss": 1.3700866707733699, "vf_explained_var": -0.009026816629228138, "kl": 0.003818441112478121, "entropy": 0.8988682604025281, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.29754275635239624, "cur_kl_coeff": 4.796163466380676e-15, "cur_lr": 0.0001, "total_loss": 0.9771408581544483, "policy_loss": -0.00047585240875681244, "vf_loss": 0.9776167142958868, "vf_explained_var": 0.001966264323582725, "kl": 0.0011294136191675568, "entropy": 0.10873259069427611, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000}, "env_runners": {"episode_reward_max": 82.19999999999919, "episode_reward_min": -176.8147417502986, "episode_reward_mean": 37.60418973474669, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -320.49219770877664, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 47.040586389873575, "predator_policy": 353.1529173631087}, "policy_reward_mean": {"prey_policy": -9.350956585830922, "predator_policy": 28.153051453204153}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.0000000000003, 36.900000000000254, 49.100000000000456, 39.000000000000284, 40.60000000000031, 78.29999999999941, 38.60000000000028, 43.60000000000036, 66.91540069111029, 25.766418681307538, 82.19999999999919, 50.07073844144719, 76.69999999999958, 38.80000000000028, 53.11438352824363, 34.200000000000216, 60.600000000000506, 47.400000000000425, 39.30000000000029, 58.22612598048918, 62.50000000000053, 45.60000000000039, 59.100000000000485, 41.200000000000315, 18.26946248199477, 33.50435812963553, 45.00000000000038, 55.30000000000048, 38.60000000000028, 38.10000000000027, 39.000000000000284, 39.100000000000286, 45.69071588069351, 32.300000000000175, -21.209765428746294, 40.80000000000031, 36.10000000000024, 48.400000000000446, 0.8704247296451978, 6.853672828769053, 36.50000000000025, 19.75943504838343, 4.548746555104566, 58.8000000000005, 41.800000000000324, 38.60000000000028, 40.0000000000003, 32.20000000000019, 57.20000000000049, 46.70000000000041, -39.22601910021402, 50.80000000000046, 41.900000000000325, 58.47298217439621, 50.80000000000049, 38.400000000000276, 49.600000000000456, 40.550446105744086, 44.900000000000375, 42.100000000000335, 39.30000000000029, 36.200000000000244, 43.200000000000344, 50.30000000000047, 38.70000000000028, 38.50000000000028, 47.20000000000042, 46.100000000000406, 41.80000000000034, -176.8147417502986, 42.43096155982154, 51.400000000000496, 37.40000000000026, 56.30000000000048, 37.40000000000026, 37.10000000000026, 54.30000000000048, 31.373899667434465, 63.50000000000048, -116.55500823658089, 27.10723480638065, 37.10000000000026, 54.800000000000495, 49.60000000000046, 42.30000000000033, 53.0000000000005, 61.70000000000051, 25.21145614536392, 32.40000000000018, 34.406758416071575, 51.40000000000049, 48.80000000000045, 38.20000000000027, 29.07043306508273, 8.41045307336547, 42.000000000000334, 38.10000000000027, 41.50000000000032, 38.50000000000028, 48.80000000000045], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.000000000000014, 20.000000000000014, -8.057358200504357, -26.83072538428918, 7.961365599787655, 14.459474886598928, -10.978980571208092, 20.000000000000014, 8.559459844431261, -17.07716298439872, 43.300050218260495, 1.8668083054631321, -0.336102331125684, 19.048161506639882, -6.183687314314335, 12.332703864166186, -48.962119250727035, 17.171823231671908, -32.54379310196647, 2.5970965935907366, 47.040586389873575, 34.40000000000025, -83.06759985206976, -11.381948134053184, 31.938038100093806, 13.49976334872152, 4.8366461103466065, 20.000000000000014, 29.63216177067626, 17.70522713914709, -7.66223428515849, -82.67299951119784, 40.700000000000244, 18.967625192916397, 15.722915235935291, 0.38591533187827354, 9.784455930354497, 20.000000000000014, -15.808615582774497, 39.69132918157343, 33.50000000000024, 29.000000000000163, 17.396479243987457, -0.2153954340742796, 28.24950549614742, 7.907445359585228, 5.320266131771014, 3.513031963100891, -2.609899878436246, -12.77569441248192, 9.717986541595, -6.363304034755162, 21.193549950141225, 7.830564073459092, -9.252847003810032, 22.947599567387226, 14.398007184250757, -5.518557797949539, -22.311998723574497, 3.555099093009504, 23.60000000000007, -45.8661257866735, 17.861500050608164, 11.379270717197045, 15.863185412039622, 9.319460333129273, -75.42743047998594, -16.06920250094001, -86.47090561750404, -115.52942748680601, 20.900000000000027, 19.108519366587878, -0.9436089475973392, -29.24880373919906, 17.417748574875436, 14.561849816236998, -99.82880080966028, -54.37582742228957, -68.57918256534127, -144.58473796764417, -50.62648987016193, -22.89832430457912, -57.874519920291135, -38.00261578772096, -57.87948018165771, -37.34245193863189, 37.75755791784488, 20.000000000000014, -25.428428418384073, -2.2722303116708984, 7.753208517433073, 2.806418041939656, 20.000000000000014, 20.000000000000014, -47.67562094185664, -37.01195547063093, 31.183596470384337, -3.157708322570661, -12.686168459755503, 18.85399201462256, -261.55013331625736, -56.24031971673265, -7.580014154491094, 20.000000000000014, 22.700000000000053, 11.626126766503205, 3.950302098326112, 26.603587270903386, 20.000000000000014, 1.6152256929012305, -2.8504454706875695, 13.274614434165171, 17.834787002077636, 9.615951003676187, 7.395546585243222, -12.309251302507922, 22.694454221055125, 16.367579474355743, 19.166468398678507, -42.0182018939024, 17.104526462990957, 13.99187098612345, -37.28206008812744, -1.211112494906347, 24.50000000000008, -20.157205905631386, 11.008158177416094, 30.800000000000196, -14.758433531650157, 16.435050780164442, 18.88103068901316, -16.13654302533965, 16.72673916655882, 14.423547679597274, 13.178355549728359, 14.695812042648877, -12.690079301768744, 8.551920054953115, -320.49219770877664, -210.5519655831338, -5.194772185773489, 0.4590668350442141, -11.60528693427981, 21.57439276065636, -12.77883468698492, -8.168837095971911, 24.69612085959633, 3.5648964259333016, -24.86083718333498, 3.555613843263447, 19.160857295396827, -13.402709360092526, 16.916124605676725, 13.132485292825502, -34.65150664974111, 4.947177171635678, 38.121394213640876, 15.990731057902869, -215.2335262018795, -153.09987339824696, -137.42505605229343, -7.365163213081807, 20.000000000000014, -10.255605429154084, 20.000000000000014, 27.402445337992106, 11.79501483632569, 23.858470478055178, 12.776884668371672, -12.645838946224497, 9.227235490407043, 28.97355298078027, 36.72233592048436, 7.934231549078172, -28.200855810620837, -58.36000654503281, -0.16325425327912377, -253.44003095150464, 6.000739629483787, -7.800774200474315, 16.387261841603895, 17.21941185194272, 10.383632996364737, 16.743956553752156, -2.7045428298087404, 13.548364144204987, -7.404701336471668, -7.415659730461908, -72.78728877890481, -194.682535749904, 20.000000000000014, -15.402797092500652, -3.739768344080258, -7.499595362963046, 18.2550297436294, 11.61859297273452, 17.81110514947886, -7.17943898376433, 23.195204245622705, 9.885379766554092], "policy_predator_policy_reward": [0.0, 0.0, 26.957358200504483, 44.83072538428944, 19.890540411619824, 6.788619101993531, 29.97898057120827, 0.0, 14.540540155568708, 34.57716298439897, 13.147755455649886, 19.985386020626642, 19.036102331125687, 0.8518384933601226, 25.583687314314435, 11.867296135833783, 53.33211479570386, 45.37358191446128, 49.05148113674898, 6.661634052934429, 0.7594136101266598, 0.0, 67.38191130884373, 77.13837511872522, 13.16196189990642, 18.10023665127845, 13.96335388965336, 0.0, 2.082221757567029, 3.6947728608528956, 26.162234285158604, 98.37299951119695, 0.0, 0.9323748070836053, 12.97708476406467, 18.314084668121716, 9.515544069645468, 0.0, 33.40861558277474, 0.9347967989155003, 0.0, 0.0, 9.003520756012522, 19.415395434074288, 11.550494503852738, 11.392554640414737, 10.006151852266818, 22.360550052861214, 31.834809793250734, 1.8202469796624516, 4.510612328459338, 25.63906329433621, 4.806450049858806, 11.169435926540874, 29.179814939825114, 12.425432496597905, 5.101992815749209, 24.618557797949624, 41.31199872357477, 15.54490090699046, 0.0, 61.26612578667372, 1.9384999493918231, 7.920729282802921, 9.602514124366436, 10.905556011157719, 10.232578615832525, 113.56405436509299, 31.032799239333958, 149.7577684362277, 0.0, 0.791480633412128, 19.74360894759735, 46.54880373919931, 2.3822514251245446, 14.03815018376297, 143.01362434588563, 12.061428615708639, 214.17376181036536, 5.8438315513874075, 68.72648987016186, 41.29832430457938, 9.941520339772643, 105.69505041662292, 20.2483911962365, 79.52228747915736, 1.0424420821553724, 0.0, 0.0, 69.50065873005526, 11.646791482566892, 16.39358195806031, 0.0, 0.0, 17.303340269850846, 99.58423614263704, 7.116403529615869, 22.057708322570704, 8.354607799003995, 32.177568646129124, 278.56443393277675, 0.0, 4.443372007135232, 33.93664214735592, 0.0, 7.573873233496763, 2.769394903492446, 25.149697901673857, 0.0, 29.18477430709874, 21.95044547068761, 6.025385565834794, 18.646425891597634, 3.502836102648496, 22.668199758649028, 22.795951064359606, 2.5055457789449296, 3.332420525644225, 5.033531601321493, 59.918201893902655, 2.69547353700902, 5.508129013876515, 22.5291521097852, 52.16402047324885, 0.0, 38.85720590563165, 8.49184182258387, 0.0, 33.758433531650404, 3.2649492198355254, 29.468521769927364, 6.286990566399381, 5.668425257547012, 10.381287896296834, 13.421644450271609, 4.804187957351088, 35.29007930176895, 10.64807994504685, 353.1529173631087, 1.0765041785046168, 18.487276896978834, 28.679390013571705, 40.405286934279985, 1.0256072393436797, 31.77883468698513, 26.568837095972025, 12.503879140403761, 15.535103574066662, 32.033013394161095, 26.67220994591064, 0.7391427046031792, 30.602709360092724, 14.942403278170087, 9.308986823327633, 56.33577901434724, 4.742450131192688, 5.678605786359356, 3.7092689420970935, 248.20575802661534, 3.572633336929923, 147.07030852843263, 24.827145543322604, 25.327117028648132, 2.028488400506046, 0.0, 7.397554662008034, 7.5049851636742755, 6.441529521944897, 6.723115331628294, 35.445838946224704, 12.53212901977292, 2.2670825090398994, 1.1776640795158895, 15.865768450921795, 1.2058164347056592, 110.56650206631146, 19.663254253279135, 266.34003095150683, 34.53244896677838, 1.6743440202835722, 3.3127381583960713, 14.480588148057258, 18.616367003635233, 3.056043446247817, 21.404542829808776, 5.9516358557949784, 10.776122792742754, 33.114671339273656, 135.91649754625868, 139.9637800559141, 11.109675234792656, 26.293121857708243, 22.839768344080312, 26.499595362963163, 4.044970256370592, 7.5814070272654455, 27.86833383428547, 0.0, 6.304795754377357, 9.414620233445874]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.788901969782873, "mean_inference_ms": 3.709635552375047, "mean_action_processing_ms": 1.8522170989979856, "mean_env_wait_ms": 1.1369689764934225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030161142349243164, "StateBufferConnector_ms": 0.010805845260620117, "ViewRequirementAgentConnector_ms": 0.0915292501449585}, "num_episodes": 64, "episode_return_max": 82.19999999999919, "episode_return_min": -176.8147417502986, "episode_return_mean": 37.60418973474669, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 254.79534397384194, "num_env_steps_trained_throughput_per_sec": 254.79534397384194, "timesteps_total": 712000, "num_env_steps_sampled_lifetime": 712000, "num_agent_steps_sampled_lifetime": 2848000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2848000, "timers": {"training_iteration_time_ms": 30908.372, "restore_workers_time_ms": 0.013, "training_step_time_ms": 30908.333, "sample_time_ms": 1042.986, "learn_time_ms": 29851.17, "learn_throughput": 267.996, "synch_weights_time_ms": 12.473}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000}, "done": false, "training_iteration": 89, "trial_id": "cd905_00000", "date": "2024-08-20_10-12-28", "timestamp": 1724128948, "time_this_iter_s": 31.40393090248108, "time_total_s": 2904.1736364364624, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a1c6550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2904.1736364364624, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 27.393181818181816, "ram_util_percent": 74.25681818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9788613478934008, "cur_kl_coeff": 3.1432136893272397e-10, "cur_lr": 0.0001, "total_loss": 0.390549663223681, "policy_loss": -0.0023915794611509356, "vf_loss": 0.39294124192425184, "vf_explained_var": -0.014154622384480068, "kl": 0.010999152175499047, "entropy": 0.8245392915748414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 56385.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.18998107428233774, "cur_kl_coeff": 2.398081733190338e-15, "cur_lr": 0.0001, "total_loss": 0.2450278161655343, "policy_loss": -0.00038195986426361496, "vf_loss": 0.24540977556358223, "vf_explained_var": 0.006797945499420166, "kl": 0.0008050028954787396, "entropy": 0.08356648255435248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 56385.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "env_runners": {"episode_reward_max": 82.19999999999919, "episode_reward_min": -176.8147417502986, "episode_reward_mean": 37.58982233453573, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -320.49219770877664, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 47.040586389873575, "predator_policy": 353.1529173631087}, "policy_reward_mean": {"prey_policy": -9.65410409560713, "predator_policy": 28.44901526287488}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.91540069111029, 25.766418681307538, 82.19999999999919, 50.07073844144719, 76.69999999999958, 38.80000000000028, 53.11438352824363, 34.200000000000216, 60.600000000000506, 47.400000000000425, 39.30000000000029, 58.22612598048918, 62.50000000000053, 45.60000000000039, 59.100000000000485, 41.200000000000315, 18.26946248199477, 33.50435812963553, 45.00000000000038, 55.30000000000048, 38.60000000000028, 38.10000000000027, 39.000000000000284, 39.100000000000286, 45.69071588069351, 32.300000000000175, -21.209765428746294, 40.80000000000031, 36.10000000000024, 48.400000000000446, 0.8704247296451978, 6.853672828769053, 36.50000000000025, 19.75943504838343, 4.548746555104566, 58.8000000000005, 41.800000000000324, 38.60000000000028, 40.0000000000003, 32.20000000000019, 57.20000000000049, 46.70000000000041, -39.22601910021402, 50.80000000000046, 41.900000000000325, 58.47298217439621, 50.80000000000049, 38.400000000000276, 49.600000000000456, 40.550446105744086, 44.900000000000375, 42.100000000000335, 39.30000000000029, 36.200000000000244, 43.200000000000344, 50.30000000000047, 38.70000000000028, 38.50000000000028, 47.20000000000042, 46.100000000000406, 41.80000000000034, -176.8147417502986, 42.43096155982154, 51.400000000000496, 37.40000000000026, 56.30000000000048, 37.40000000000026, 37.10000000000026, 54.30000000000048, 31.373899667434465, 63.50000000000048, -116.55500823658089, 27.10723480638065, 37.10000000000026, 54.800000000000495, 49.60000000000046, 42.30000000000033, 53.0000000000005, 61.70000000000051, 25.21145614536392, 32.40000000000018, 34.406758416071575, 51.40000000000049, 48.80000000000045, 38.20000000000027, 29.07043306508273, 8.41045307336547, 42.000000000000334, 38.10000000000027, 41.50000000000032, 38.50000000000028, 48.80000000000045, 58.400000000000496, 36.05265476465962, 53.80000000000049, 9.059567226490149, 57.86587488545499, 27.261962199823703, 71.62320090247638, 50.60000000000048], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-48.962119250727035, 17.171823231671908, -32.54379310196647, 2.5970965935907366, 47.040586389873575, 34.40000000000025, -83.06759985206976, -11.381948134053184, 31.938038100093806, 13.49976334872152, 4.8366461103466065, 20.000000000000014, 29.63216177067626, 17.70522713914709, -7.66223428515849, -82.67299951119784, 40.700000000000244, 18.967625192916397, 15.722915235935291, 0.38591533187827354, 9.784455930354497, 20.000000000000014, -15.808615582774497, 39.69132918157343, 33.50000000000024, 29.000000000000163, 17.396479243987457, -0.2153954340742796, 28.24950549614742, 7.907445359585228, 5.320266131771014, 3.513031963100891, -2.609899878436246, -12.77569441248192, 9.717986541595, -6.363304034755162, 21.193549950141225, 7.830564073459092, -9.252847003810032, 22.947599567387226, 14.398007184250757, -5.518557797949539, -22.311998723574497, 3.555099093009504, 23.60000000000007, -45.8661257866735, 17.861500050608164, 11.379270717197045, 15.863185412039622, 9.319460333129273, -75.42743047998594, -16.06920250094001, -86.47090561750404, -115.52942748680601, 20.900000000000027, 19.108519366587878, -0.9436089475973392, -29.24880373919906, 17.417748574875436, 14.561849816236998, -99.82880080966028, -54.37582742228957, -68.57918256534127, -144.58473796764417, -50.62648987016193, -22.89832430457912, -57.874519920291135, -38.00261578772096, -57.87948018165771, -37.34245193863189, 37.75755791784488, 20.000000000000014, -25.428428418384073, -2.2722303116708984, 7.753208517433073, 2.806418041939656, 20.000000000000014, 20.000000000000014, -47.67562094185664, -37.01195547063093, 31.183596470384337, -3.157708322570661, -12.686168459755503, 18.85399201462256, -261.55013331625736, -56.24031971673265, -7.580014154491094, 20.000000000000014, 22.700000000000053, 11.626126766503205, 3.950302098326112, 26.603587270903386, 20.000000000000014, 1.6152256929012305, -2.8504454706875695, 13.274614434165171, 17.834787002077636, 9.615951003676187, 7.395546585243222, -12.309251302507922, 22.694454221055125, 16.367579474355743, 19.166468398678507, -42.0182018939024, 17.104526462990957, 13.99187098612345, -37.28206008812744, -1.211112494906347, 24.50000000000008, -20.157205905631386, 11.008158177416094, 30.800000000000196, -14.758433531650157, 16.435050780164442, 18.88103068901316, -16.13654302533965, 16.72673916655882, 14.423547679597274, 13.178355549728359, 14.695812042648877, -12.690079301768744, 8.551920054953115, -320.49219770877664, -210.5519655831338, -5.194772185773489, 0.4590668350442141, -11.60528693427981, 21.57439276065636, -12.77883468698492, -8.168837095971911, 24.69612085959633, 3.5648964259333016, -24.86083718333498, 3.555613843263447, 19.160857295396827, -13.402709360092526, 16.916124605676725, 13.132485292825502, -34.65150664974111, 4.947177171635678, 38.121394213640876, 15.990731057902869, -215.2335262018795, -153.09987339824696, -137.42505605229343, -7.365163213081807, 20.000000000000014, -10.255605429154084, 20.000000000000014, 27.402445337992106, 11.79501483632569, 23.858470478055178, 12.776884668371672, -12.645838946224497, 9.227235490407043, 28.97355298078027, 36.72233592048436, 7.934231549078172, -28.200855810620837, -58.36000654503281, -0.16325425327912377, -253.44003095150464, 6.000739629483787, -7.800774200474315, 16.387261841603895, 17.21941185194272, 10.383632996364737, 16.743956553752156, -2.7045428298087404, 13.548364144204987, -7.404701336471668, -7.415659730461908, -72.78728877890481, -194.682535749904, 20.000000000000014, -15.402797092500652, -3.739768344080258, -7.499595362963046, 18.2550297436294, 11.61859297273452, 17.81110514947886, -7.17943898376433, 23.195204245622705, 9.885379766554092, 1.4463163947485846, 36.01501271497191, -10.670775696096644, -11.311930116803515, 18.775392877362325, 19.244760582445906, -43.77090353333417, -39.440270684131356, -17.759229938364783, 23.340859159840253, 3.4474504722358583, -8.04953993220083, 30.400848115769833, -12.899453765175963, 21.773750287515018, 26.892218545483427], "policy_predator_policy_reward": [53.33211479570386, 45.37358191446128, 49.05148113674898, 6.661634052934429, 0.7594136101266598, 0.0, 67.38191130884373, 77.13837511872522, 13.16196189990642, 18.10023665127845, 13.96335388965336, 0.0, 2.082221757567029, 3.6947728608528956, 26.162234285158604, 98.37299951119695, 0.0, 0.9323748070836053, 12.97708476406467, 18.314084668121716, 9.515544069645468, 0.0, 33.40861558277474, 0.9347967989155003, 0.0, 0.0, 9.003520756012522, 19.415395434074288, 11.550494503852738, 11.392554640414737, 10.006151852266818, 22.360550052861214, 31.834809793250734, 1.8202469796624516, 4.510612328459338, 25.63906329433621, 4.806450049858806, 11.169435926540874, 29.179814939825114, 12.425432496597905, 5.101992815749209, 24.618557797949624, 41.31199872357477, 15.54490090699046, 0.0, 61.26612578667372, 1.9384999493918231, 7.920729282802921, 9.602514124366436, 10.905556011157719, 10.232578615832525, 113.56405436509299, 31.032799239333958, 149.7577684362277, 0.0, 0.791480633412128, 19.74360894759735, 46.54880373919931, 2.3822514251245446, 14.03815018376297, 143.01362434588563, 12.061428615708639, 214.17376181036536, 5.8438315513874075, 68.72648987016186, 41.29832430457938, 9.941520339772643, 105.69505041662292, 20.2483911962365, 79.52228747915736, 1.0424420821553724, 0.0, 0.0, 69.50065873005526, 11.646791482566892, 16.39358195806031, 0.0, 0.0, 17.303340269850846, 99.58423614263704, 7.116403529615869, 22.057708322570704, 8.354607799003995, 32.177568646129124, 278.56443393277675, 0.0, 4.443372007135232, 33.93664214735592, 0.0, 7.573873233496763, 2.769394903492446, 25.149697901673857, 0.0, 29.18477430709874, 21.95044547068761, 6.025385565834794, 18.646425891597634, 3.502836102648496, 22.668199758649028, 22.795951064359606, 2.5055457789449296, 3.332420525644225, 5.033531601321493, 59.918201893902655, 2.69547353700902, 5.508129013876515, 22.5291521097852, 52.16402047324885, 0.0, 38.85720590563165, 8.49184182258387, 0.0, 33.758433531650404, 3.2649492198355254, 29.468521769927364, 6.286990566399381, 5.668425257547012, 10.381287896296834, 13.421644450271609, 4.804187957351088, 35.29007930176895, 10.64807994504685, 353.1529173631087, 1.0765041785046168, 18.487276896978834, 28.679390013571705, 40.405286934279985, 1.0256072393436797, 31.77883468698513, 26.568837095972025, 12.503879140403761, 15.535103574066662, 32.033013394161095, 26.67220994591064, 0.7391427046031792, 30.602709360092724, 14.942403278170087, 9.308986823327633, 56.33577901434724, 4.742450131192688, 5.678605786359356, 3.7092689420970935, 248.20575802661534, 3.572633336929923, 147.07030852843263, 24.827145543322604, 25.327117028648132, 2.028488400506046, 0.0, 7.397554662008034, 7.5049851636742755, 6.441529521944897, 6.723115331628294, 35.445838946224704, 12.53212901977292, 2.2670825090398994, 1.1776640795158895, 15.865768450921795, 1.2058164347056592, 110.56650206631146, 19.663254253279135, 266.34003095150683, 34.53244896677838, 1.6743440202835722, 3.3127381583960713, 14.480588148057258, 18.616367003635233, 3.056043446247817, 21.404542829808776, 5.9516358557949784, 10.776122792742754, 33.114671339273656, 135.91649754625868, 139.9637800559141, 11.109675234792656, 26.293121857708243, 22.839768344080312, 26.499595362963163, 4.044970256370592, 7.5814070272654455, 27.86833383428547, 0.0, 6.304795754377357, 9.414620233445874, 17.453683605251396, 3.484987285028338, 53.482300529131564, 4.553060048428305, 8.597600113877531, 7.182246426314245, 82.64185947016178, 9.62888197379433, 30.63558578411267, 21.648659879866663, 3.1566245681521172, 28.707427091636546, 24.647084557762255, 29.474721994120703, 0.8262497124850221, 1.1077814545166982]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.778385723211321, "mean_inference_ms": 3.7100114082316016, "mean_action_processing_ms": 1.8458119006699092, "mean_env_wait_ms": 1.1350971456773347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003273487091064453, "StateBufferConnector_ms": 0.011471867561340332, "ViewRequirementAgentConnector_ms": 0.09524786472320557}, "num_episodes": 8, "episode_return_max": 82.19999999999919, "episode_return_min": -176.8147417502986, "episode_return_mean": 37.58982233453573, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 245.76551592379855, "num_env_steps_trained_throughput_per_sec": 245.76551592379855, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 2880000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2880000, "timers": {"training_iteration_time_ms": 30921.105, "restore_workers_time_ms": 0.013, "training_step_time_ms": 30921.067, "sample_time_ms": 1050.567, "learn_time_ms": 29856.433, "learn_throughput": 267.949, "synch_weights_time_ms": 12.367}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "done": false, "training_iteration": 90, "trial_id": "cd905_00000", "date": "2024-08-20_10-13-00", "timestamp": 1724128980, "time_this_iter_s": 32.555485010147095, "time_total_s": 2936.7291214466095, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a141dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2936.7291214466095, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 27.070212765957447, "ram_util_percent": 73.45106382978723}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4662082713866045, "cur_kl_coeff": 3.1432136893272397e-10, "cur_lr": 0.0001, "total_loss": 1.2535777859744572, "policy_loss": -0.001637955847758031, "vf_loss": 1.2552157473942591, "vf_explained_var": -0.014668923048746018, "kl": 0.005284172132538544, "entropy": 0.873972869676257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 57015.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2646303156538615, "cur_kl_coeff": 1.199040866595169e-15, "cur_lr": 0.0001, "total_loss": 0.9237019927728743, "policy_loss": -0.0004820648144694075, "vf_loss": 0.9241840542781921, "vf_explained_var": 0.00266621642642551, "kl": 0.0006419381584093359, "entropy": 0.05803317089402486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 57015.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000}, "env_runners": {"episode_reward_max": 71.62320090247638, "episode_reward_min": -226.03973189656176, "episode_reward_mean": 37.902121833158674, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -253.44003095150464, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 38.121394213640876, "predator_policy": 266.34003095150683}, "policy_reward_mean": {"prey_policy": -6.168583796239752, "predator_policy": 25.119644712818967}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.40000000000026, 56.30000000000048, 37.40000000000026, 37.10000000000026, 54.30000000000048, 31.373899667434465, 63.50000000000048, -116.55500823658089, 27.10723480638065, 37.10000000000026, 54.800000000000495, 49.60000000000046, 42.30000000000033, 53.0000000000005, 61.70000000000051, 25.21145614536392, 32.40000000000018, 34.406758416071575, 51.40000000000049, 48.80000000000045, 38.20000000000027, 29.07043306508273, 8.41045307336547, 42.000000000000334, 38.10000000000027, 41.50000000000032, 38.50000000000028, 48.80000000000045, 58.400000000000496, 36.05265476465962, 53.80000000000049, 9.059567226490149, 57.86587488545499, 27.261962199823703, 71.62320090247638, 50.60000000000048, 70.80000000000001, 51.20000000000049, 33.90000000000021, 36.00000000000024, 32.20000000000019, 38.80000000000028, 51.5000000000005, 47.00000000000042, 58.79895229401062, 1.6076045211016636, 48.00000000000044, 38.400000000000276, 38.20000000000027, 33.2000000000002, 44.40000000000037, 38.300000000000274, 66.20000000000036, 56.60000000000052, 45.500000000000405, 37.30000000000026, 48.100000000000435, -115.37926205067495, 42.20000000000034, 46.3000000000004, 54.40000000000049, 15.032670086456374, 47.48035756826907, 46.70000000000042, 39.000000000000284, 39.20000000000029, 52.8000000000005, 42.30000000000033, 53.01257392458676, 46.40000000000041, 26.542180488920415, 34.900000000000226, 47.80000000000043, 45.200000000000394, 45.82941093205595, 37.31891984690841, 53.10000000000049, 47.600000000000435, 39.9000000000003, 50.70000000000048, 52.80000000000051, 41.70000000000032, 53.40000000000049, 53.60000000000049, 37.50000000000026, 45.50000000000039, 41.800000000000324, -226.03973189656176, 63.10000000000052, 44.00000000000036, 53.000000000000504, 40.70000000000031, 38.80000000000028, 38.20000000000027, 56.000000000000504, 50.000000000000476, 54.30000000000051, 41.820020684743824, 39.30000000000029, 48.50000000000044], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.77883468698492, -8.168837095971911, 24.69612085959633, 3.5648964259333016, -24.86083718333498, 3.555613843263447, 19.160857295396827, -13.402709360092526, 16.916124605676725, 13.132485292825502, -34.65150664974111, 4.947177171635678, 38.121394213640876, 15.990731057902869, -215.2335262018795, -153.09987339824696, -137.42505605229343, -7.365163213081807, 20.000000000000014, -10.255605429154084, 20.000000000000014, 27.402445337992106, 11.79501483632569, 23.858470478055178, 12.776884668371672, -12.645838946224497, 9.227235490407043, 28.97355298078027, 36.72233592048436, 7.934231549078172, -28.200855810620837, -58.36000654503281, -0.16325425327912377, -253.44003095150464, 6.000739629483787, -7.800774200474315, 16.387261841603895, 17.21941185194272, 10.383632996364737, 16.743956553752156, -2.7045428298087404, 13.548364144204987, -7.404701336471668, -7.415659730461908, -72.78728877890481, -194.682535749904, 20.000000000000014, -15.402797092500652, -3.739768344080258, -7.499595362963046, 18.2550297436294, 11.61859297273452, 17.81110514947886, -7.17943898376433, 23.195204245622705, 9.885379766554092, 1.4463163947485846, 36.01501271497191, -10.670775696096644, -11.311930116803515, 18.775392877362325, 19.244760582445906, -43.77090353333417, -39.440270684131356, -17.759229938364783, 23.340859159840253, 3.4474504722358583, -8.04953993220083, 30.400848115769833, -12.899453765175963, 21.773750287515018, 26.892218545483427, 28.168951359316083, 25.31642934690625, 14.15306396090057, 13.197212865998015, -77.89591937171974, -55.7373311642556, -0.8885733562775189, -18.06572234313908, -156.79834016836574, 7.807849496387284, 10.327376482919037, 11.280677397786192, 27.078476182189377, 13.00264560584137, 12.793738305788946, 17.47034717481983, -10.725786119354654, 8.290144771978015, -47.491726653045696, -52.474620628576886, -0.08291242411540728, -13.69906526800266, -7.537512800051148, 2.339455724688816, -3.3388189391827745, -5.317151903968108, -8.402208965198632, -195.8515114176755, 2.7033289399925837, -1.7652228707805038, 4.951502159068905, 8.592965516986512, 33.71983294955496, 22.40268893147931, 27.090971031993195, 9.748753060931946, -14.64999336371805, -25.673688547148906, 3.2219496198604514, -3.3495205917260997, 28.100000000000147, 20.000000000000014, -124.1921493430538, -151.83329738577635, -12.560727344415904, 17.85510052866528, 20.000000000000014, -1.3053550912868492, 15.571322940230365, 27.273690916148706, -29.27523608466177, -43.610117048659376, -17.428916188601, 23.721935575751754, -13.743560000709655, -11.403388354273563, 17.34052301502715, -0.8788330908804414, 8.852180658038579, 16.559396768115427, 33.50000000000024, -6.22052315609319, 22.385401775895964, -10.741972448793911, 26.32381582218187, 17.749519074364574, 16.143270095452035, -2.195067915205732, -11.133867629898687, -1.195017374818494, 12.844580105975151, -81.23649061204952, 19.49109053114494, 10.212546003724652, -14.668622005269977, 1.6558426643575077, 1.397597524968753, 13.366764111938728, -23.043070440904415, 15.770656044944253, -15.507062742127255, 31.228826245279315, -11.567666264152015, 4.712632463254447, 18.69713296745577, 20.000000000000014, -5.552338854763521, 27.741449168131595, 30.549561776646584, 15.834472440476052, 12.618397488677127, 18.00908990669969, 4.695561536980469, 6.09105453007794, 25.098721873440986, 8.338425808314577, 13.110224179461225, -4.608659396957417, 9.903457807747518, 18.916643658783073, 17.978793941872116, 13.046830710935247, -245.1539190657299, -236.3190841740255, 27.20000000000013, 32.0821248783381, -21.77559419196662, 25.400000000000098, 33.50000000000024, 13.061027945912441, 19.86119626814332, 18.689954462550183, 1.027967783885882, 15.804883739468126, -14.165079499522767, 17.94107259895838, 36.20000000000025, 17.890630584299334, -11.153828912607468, 10.086546215417783, 14.899031909555848, 22.69379779915542, 12.037620529126547, -5.321073551859799, 16.866643310071833, 13.20281195769669, 20.000000000000014, -21.56051393193774], "policy_predator_policy_reward": [31.77883468698513, 26.568837095972025, 12.503879140403761, 15.535103574066662, 32.033013394161095, 26.67220994591064, 0.7391427046031792, 30.602709360092724, 14.942403278170087, 9.308986823327633, 56.33577901434724, 4.742450131192688, 5.678605786359356, 3.7092689420970935, 248.20575802661534, 3.572633336929923, 147.07030852843263, 24.827145543322604, 25.327117028648132, 2.028488400506046, 0.0, 7.397554662008034, 7.5049851636742755, 6.441529521944897, 6.723115331628294, 35.445838946224704, 12.53212901977292, 2.2670825090398994, 1.1776640795158895, 15.865768450921795, 1.2058164347056592, 110.56650206631146, 19.663254253279135, 266.34003095150683, 34.53244896677838, 1.6743440202835722, 3.3127381583960713, 14.480588148057258, 18.616367003635233, 3.056043446247817, 21.404542829808776, 5.9516358557949784, 10.776122792742754, 33.114671339273656, 135.91649754625868, 139.9637800559141, 11.109675234792656, 26.293121857708243, 22.839768344080312, 26.499595362963163, 4.044970256370592, 7.5814070272654455, 27.86833383428547, 0.0, 6.304795754377357, 9.414620233445874, 17.453683605251396, 3.484987285028338, 53.482300529131564, 4.553060048428305, 8.597600113877531, 7.182246426314245, 82.64185947016178, 9.62888197379433, 30.63558578411267, 21.648659879866663, 3.1566245681521172, 28.707427091636546, 24.647084557762255, 29.474721994120703, 0.8262497124850221, 1.1077814545166982, 0.7310486406840648, 16.58357065309386, 17.5469360390994, 6.3027871340019495, 159.2818163071967, 8.25143422877752, 19.988573356277534, 34.96572234313932, 9.441025236352024, 171.74946543562575, 9.172623517080927, 8.019322602213773, 5.021523817810756, 6.397354394158597, 12.595043561038546, 4.140870958352631, 20.688135804580714, 40.54645783680618, 14.84571341949719, 86.72823838322705, 61.7819776921182, 0.0, 26.537512800051267, 17.06054427531116, 22.738818939182828, 24.117151903968185, 28.832757512797016, 208.62096287007634, 21.045007826527392, 22.41688610426051, 13.948497840931061, 10.807034483013453, 3.180167050445289, 6.89731106852074, 6.009028968006938, 13.751246939068022, 82.84210699119548, 2.9815749196719974, 21.17975158196773, 16.247819389897835, 0.0, 0.0, 0.9015897052897951, 159.74459497286549, 21.759039559514093, 15.146587256236696, 0.0, 27.60535509128686, 4.128677059769599, 7.426309083851432, 62.55731861687385, 25.360704602904207, 3.6543832210174476, 37.532954960100774, 16.06028379984265, 55.78666455514094, 2.4594769849728317, 20.078833090880458, 10.647819341961386, 3.140603231884542, 0.0, 25.52052315609329, 1.1145982241040837, 29.541972448794084, 5.976184177818247, 2.963054850221657, 6.585488947609938, 25.866308872143726, 9.19899678156517, 29.672068712072537, 80.15502314457653, 23.136887361497173, 8.708909468855069, 9.387453996275312, 33.912380014717726, 24.300399326194942, 26.07414262348579, 4.990906671662219, 41.54307044090468, 3.0482638019638593, 32.90706274212749, 4.471173754720891, 31.467666264152204, 22.987367536745523, 1.2028670325442288, 0.0, 24.85233885476361, 3.658550831868549, 2.65043822335361, 3.7655275595239104, 1.1100349439753552, 9.962477660647785, 14.404438463019495, 28.208945469922032, 9.301278126559113, 10.861574191685389, 21.386068652353107, 7.61236656514307, 15.69654219225245, 0.9833563412169307, 3.521206058127871, 7.2531692890647195, 255.43327134319364, 0.0, 0.0, 3.8178751216621176, 40.37559419196688, 0.0, 0.0, 6.4389720540875235, 0.9388037318566931, 1.2100455374498131, 18.072032216114106, 3.8951162605318377, 32.565079499522994, 1.8589274010416075, 0.0, 1.9093694157006538, 41.65382891260763, 9.413453784582181, 6.343484659387484, 10.363685631901268, 11.563357193857485, 23.540116513619303, 2.9333566899281416, 6.297188042303274, 42.446940206200786, 7.61357372573715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.777226524381932, "mean_inference_ms": 3.700389625119111, "mean_action_processing_ms": 1.8432204002174626, "mean_env_wait_ms": 1.132937600397203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004238009452819824, "StateBufferConnector_ms": 0.011749625205993652, "ViewRequirementAgentConnector_ms": 0.10277652740478516}, "num_episodes": 64, "episode_return_max": 71.62320090247638, "episode_return_min": -226.03973189656176, "episode_return_mean": 37.902121833158674, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 229.95748815558397, "num_env_steps_trained_throughput_per_sec": 229.95748815558397, "timesteps_total": 728000, "num_env_steps_sampled_lifetime": 728000, "num_agent_steps_sampled_lifetime": 2912000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2912000, "timers": {"training_iteration_time_ms": 31176.896, "restore_workers_time_ms": 0.013, "training_step_time_ms": 31176.821, "sample_time_ms": 1063.476, "learn_time_ms": 30096.323, "learn_throughput": 265.813, "synch_weights_time_ms": 14.177}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000}, "done": false, "training_iteration": 91, "trial_id": "cd905_00000", "date": "2024-08-20_10-13-35", "timestamp": 1724129015, "time_this_iter_s": 34.86325407028198, "time_total_s": 2971.5923755168915, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a167310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2971.5923755168915, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 47.69591836734695, "ram_util_percent": 75.04285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3577364578370064, "cur_kl_coeff": 3.1432136893272397e-10, "cur_lr": 0.0001, "total_loss": 0.7722206828140077, "policy_loss": -0.001238900730164633, "vf_loss": 0.7734595809664045, "vf_explained_var": -0.011772892399439737, "kl": 0.009644403244310328, "entropy": 0.7793134756504543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.34274442017314927, "cur_kl_coeff": 5.995204332975845e-16, "cur_lr": 0.0001, "total_loss": 0.6098488988384368, "policy_loss": 4.769800423038384e-05, "vf_loss": 0.6098012029651612, "vf_explained_var": 0.004542330616996402, "kl": 0.0003440999646720287, "entropy": 0.05731628464446181, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000}, "env_runners": {"episode_reward_max": 74.25656939960058, "episode_reward_min": -226.03973189656176, "episode_reward_mean": 39.03939685636844, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -245.1539190657299, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 41.34742108078427, "predator_policy": 255.43327134319364}, "policy_reward_mean": {"prey_policy": 0.1517513617247073, "predator_policy": 19.367947066459358}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.80000000000043, 45.200000000000394, 45.82941093205595, 37.31891984690841, 53.10000000000049, 47.600000000000435, 39.9000000000003, 50.70000000000048, 52.80000000000051, 41.70000000000032, 53.40000000000049, 53.60000000000049, 37.50000000000026, 45.50000000000039, 41.800000000000324, -226.03973189656176, 63.10000000000052, 44.00000000000036, 53.000000000000504, 40.70000000000031, 38.80000000000028, 38.20000000000027, 56.000000000000504, 50.000000000000476, 54.30000000000051, 41.820020684743824, 39.30000000000029, 48.50000000000044, 74.25656939960058, 39.60000000000029, 59.70000000000049, 39.43572877178081, 39.800000000000296, 57.600000000000506, 43.30000000000036, 46.600000000000406, 51.70000000000049, 38.70000000000028, 38.70000000000028, 38.10000000000027, 46.000000000000405, 50.80000000000047, 67.50000000000026, 45.80558198526228, 49.50000000000046, 62.000000000000504, 37.156723091912504, 38.80000000000028, 42.799839459581, 48.60000000000045, 37.90000000000027, 36.857392815851625, -1.2729481609806, 57.90000000000049, 44.30000000000038, 38.50000000000028, 36.200000000000244, 39.97548395029312, 37.30000000000026, 47.500000000000426, 49.40000000000046, 39.50000000000029, 47.00000000000042, 55.50000000000051, 23.050196103067147, 40.58008672146445, 39.78976247269202, 60.10000000000051, 60.2000000000005, 52.75935767669923, 35.80000000000024, 32.2000000000002, 42.20000000000033, 53.60000000000051, 9.197806898819506, 60.10000000000049, 37.80000000000027, 45.20000000000039, 53.10000000000052, 38.400000000000276, 52.30000000000051, 44.300000000000374, 38.00000000000027, 39.30000000000029, 43.40000000000036, 51.00000000000049, -207.39214228136882, 51.20000000000049, 38.90000000000028, 35.82620889001172, 35.80000000000024, 38.20000000000027, 7.756001558453308, 53.128130651651816, 38.20000000000028, 42.500000000000334, 44.80000000000039, 34.90000000000024, 39.700000000000294, 39.60128606487703], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [19.49109053114494, 10.212546003724652, -14.668622005269977, 1.6558426643575077, 1.397597524968753, 13.366764111938728, -23.043070440904415, 15.770656044944253, -15.507062742127255, 31.228826245279315, -11.567666264152015, 4.712632463254447, 18.69713296745577, 20.000000000000014, -5.552338854763521, 27.741449168131595, 30.549561776646584, 15.834472440476052, 12.618397488677127, 18.00908990669969, 4.695561536980469, 6.09105453007794, 25.098721873440986, 8.338425808314577, 13.110224179461225, -4.608659396957417, 9.903457807747518, 18.916643658783073, 17.978793941872116, 13.046830710935247, -245.1539190657299, -236.3190841740255, 27.20000000000013, 32.0821248783381, -21.77559419196662, 25.400000000000098, 33.50000000000024, 13.061027945912441, 19.86119626814332, 18.689954462550183, 1.027967783885882, 15.804883739468126, -14.165079499522767, 17.94107259895838, 36.20000000000025, 17.890630584299334, -11.153828912607468, 10.086546215417783, 14.899031909555848, 22.69379779915542, 12.037620529126547, -5.321073551859799, 16.866643310071833, 13.20281195769669, 20.000000000000014, -21.56051393193774, 35.13310303835811, 12.957316748777158, 18.197621746076173, 17.421789445972202, 20.986770410097094, 9.303179449019018, -19.94519861288763, 17.942584232511237, 20.000000000000014, 17.48422616701248, 20.000000000000014, 30.636327480794524, -5.793583981955512, -92.00879064042847, 18.0624496860888, 2.69516813531346, 10.490420065928776, 17.122546212681424, 15.606847971055869, 10.660115236609249, 17.822207862739486, 5.959209162737524, -2.527558639723124, 14.310319788950926, 20.000000000000014, 13.033712484802178, -7.361100281488602, 12.53502433287871, 25.254091298107216, 26.548832992314722, 5.166184067585766, 16.9706149308079, 16.323772457952312, 13.121258985480294, 35.300000000000246, 18.994486548172873, 6.56995428522395, 13.38790008617231, 5.921923376231447, 16.6411712375121, 4.096019754005036, 19.00157545278546, 28.529446885659123, -14.089511646275202, -5.70352444216398, 15.935366126798499, 17.457392815851357, -4.67574793252459, -95.685848915855, -30.607106480707742, 5.572890806074694, 29.610880564037206, -28.783368809654725, 20.733528420687815, 17.501135594645916, -4.213602523648646, -42.282882299873926, 12.355455711113212, 15.763527710100542, 17.738347502284334, -1.6951636111516386, -6.818296286393796, 15.69672296452973, -9.460202860134004, 24.439607935992047, -10.51063389695774, 20.000000000000014, 13.3587480703281, 20.000000000000014, 2.7734234963959348, 27.30604016224683, 21.516552308392384, -25.19674061697644, -7.233955166299406, 1.4072034839543222, 1.312155230567982, -33.91478916912061, 20.000000000000014, 14.831099587204472, 7.650667566410105, 7.163169039223183, 26.923058944548714, 25.400000000000098, -1.5934798139006907, 12.953281274284954, -33.653753508154175, -66.51093026201636, 2.140706905084404, -9.494665439910147, 3.875359926307131, 6.948031795198993, 33.360207192202445, -67.16786382360328, -105.99802791044891, 41.34742108078427, -15.814699981265566, 20.000000000000014, -38.498447128610124, 17.564106349851894, 2.316859232255506, 14.890577852337387, 33.50000000000024, -7.370407483385749, 10.197806029675046, 19.123184116959905, 30.329450970372623, -14.957395049873424, 2.2971872615942344, 11.765200932011494, 3.0594402097465085, 12.405084729947376, 17.902675223647012, 4.628416770631251, -6.072891469759476, 18.091001436563012, 25.870726046868217, -210.7946693542933, -219.92597140734813, 22.49186746717242, 5.13105445588651, 16.99619987746427, 6.931476323000098, -6.40080926961997, -43.788211378645855, -31.204573173012236, 13.828425830606411, -6.842756175015694, 15.007610756398057, -21.429059234954977, -80.48018321949628, 29.90000000000018, 9.39626850496948, -145.3686488601168, 20.000000000000014, 15.416038863118452, -20.856706482638565, 2.1981308798484673, 16.97032030101173, -76.65123628593292, 18.999559570537947, 17.859147141052542, 18.730090135866345, 14.174249093172927, -8.013615059136441], "policy_predator_policy_reward": [8.708909468855069, 9.387453996275312, 33.912380014717726, 24.300399326194942, 26.07414262348579, 4.990906671662219, 41.54307044090468, 3.0482638019638593, 32.90706274212749, 4.471173754720891, 31.467666264152204, 22.987367536745523, 1.2028670325442288, 0.0, 24.85233885476361, 3.658550831868549, 2.65043822335361, 3.7655275595239104, 1.1100349439753552, 9.962477660647785, 14.404438463019495, 28.208945469922032, 9.301278126559113, 10.861574191685389, 21.386068652353107, 7.61236656514307, 15.69654219225245, 0.9833563412169307, 3.521206058127871, 7.2531692890647195, 255.43327134319364, 0.0, 0.0, 3.8178751216621176, 40.37559419196688, 0.0, 0.0, 6.4389720540875235, 0.9388037318566931, 1.2100455374498131, 18.072032216114106, 3.8951162605318377, 32.565079499522994, 1.8589274010416075, 0.0, 1.9093694157006538, 41.65382891260763, 9.413453784582181, 6.343484659387484, 10.363685631901268, 11.563357193857485, 23.540116513619303, 2.9333566899281416, 6.297188042303274, 42.446940206200786, 7.61357372573715, 18.24268325122281, 7.923466361242939, 0.0, 3.9805888079516, 0.0, 29.41005014088389, 2.49314453926927, 38.9451986128879, 0.0, 2.3157738329875026, 0.0, 6.963672519205673, 31.893583981955583, 109.2087906404275, 9.437550313911188, 16.404831864686507, 8.70957993407119, 15.377453787318553, 5.737298611095609, 6.695738181239204, 1.9777921372605032, 12.940790837262442, 4.780289388390112, 21.536949462382076, 0.0, 12.966287515197791, 22.472560815821936, 23.153515132788016, 5.845908701892884, 9.851167007685405, 11.33611644661366, 12.332666540254497, 3.376227542047653, 16.678741014519677, 0.0, 7.705513451827128, 4.334048342657999, 12.864820377857917, 13.178076623768519, 3.0588287624878716, 14.564438843606716, 5.137805409183419, 2.8705531143410363, 31.28951164627541, 24.93221322491139, 2.7359450904541305, 0.0, 24.075747932524663, 116.71226556748245, 8.307741668099304, 13.227109193925273, 9.489119435962976, 44.78336880965495, 7.566471579312207, 25.212466929002755, 0.0, 10.462055335029286, 55.66537125373163, 2.5371364480084684, 3.9364722898994216, 20.295163611151658, 25.5182962863939, 12.603277035470233, 28.66020286013416, 28.975821791456344, 6.495204169509595, 0.0, 6.141251929671871, 0.0, 24.22657650360403, 4.793959837753308, 1.883447691607654, 5.456328389898111, 50.024563496445225, 31.33175102580645, 6.528976981135336, 23.785725377744825, 29.918826264067764, 13.468900412795495, 24.149332433589866, 17.099316381295807, 9.014455634932393, 21.79172861120945, 7.1611088793899675, 6.54671872571501, 49.953753508154406, 5.987922378178318, 90.58230097875288, 28.294665439910297, 19.524640073692836, 12.351968204800972, 0.9397928077977933, 137.39351519600785, 44.970183436861966, 0.0, 34.567278900481774, 0.0, 56.29844712861038, 11.294975837240798, 14.024058580651749, 4.709422147662577, 0.0, 26.67040748338587, 8.90219397032492, 0.7768158830400987, 2.0705490296275664, 50.99505152958112, 5.965156258698277, 23.175358858241957, 0.0, 7.094915270052589, 1.8973247763529755, 4.804186502722739, 40.040288196405555, 1.7089985634369764, 5.329273953131894, 0.8288311533072921, 222.49966732696535, 9.408132532827633, 14.168945544113456, 2.8038001225357037, 12.168523676999868, 58.404304706879955, 27.610924831397657, 47.404573173012466, 5.771574169393553, 25.342756175015793, 4.692389243601907, 14.354890582886384, 95.31035343001754, 11.803731495030485, 2.0281306516512956, 6.221658738651616, 157.34699012146444, 8.383961136881512, 39.55670648263883, 22.901869120151506, 2.7296796989882455, 2.857377231542276, 89.6942994838519, 1.9408528589474465, 1.1699098641336534, 6.327036971703771, 27.11361505913657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.7802634201169605, "mean_inference_ms": 3.7034854447256986, "mean_action_processing_ms": 1.8726934145919716, "mean_env_wait_ms": 1.132533035666461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005527853965759277, "StateBufferConnector_ms": 0.02421414852142334, "ViewRequirementAgentConnector_ms": 0.12497317790985107}, "num_episodes": 72, "episode_return_max": 74.25656939960058, "episode_return_min": -226.03973189656176, "episode_return_mean": 39.03939685636844, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 234.07048729138276, "num_env_steps_trained_throughput_per_sec": 234.07048729138276, "timesteps_total": 736000, "num_env_steps_sampled_lifetime": 736000, "num_agent_steps_sampled_lifetime": 2944000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2944000, "timers": {"training_iteration_time_ms": 31495.321, "restore_workers_time_ms": 0.014, "training_step_time_ms": 31495.231, "sample_time_ms": 1154.488, "learn_time_ms": 30322.382, "learn_throughput": 263.832, "synch_weights_time_ms": 15.29}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000}, "done": false, "training_iteration": 92, "trial_id": "cd905_00000", "date": "2024-08-20_10-14-09", "timestamp": 1724129049, "time_this_iter_s": 34.189011096954346, "time_total_s": 3005.781386613846, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169edf4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3005.781386613846, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 75.57755102040815, "ram_util_percent": 78.71224489795918}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0289422004350595, "cur_kl_coeff": 3.1432136893272397e-10, "cur_lr": 0.0001, "total_loss": 1.1555340693110512, "policy_loss": 0.00020331330893058627, "vf_loss": 1.155330748501278, "vf_explained_var": -0.018282487846556165, "kl": 0.001482918983085602, "entropy": 0.7095380658195132, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 58275.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2171634579934771, "cur_kl_coeff": 2.9976021664879224e-16, "cur_lr": 0.0001, "total_loss": 0.7848040384905679, "policy_loss": 9.914615583266058e-05, "vf_loss": 0.7847048921244485, "vf_explained_var": 0.0019932334385220967, "kl": 0.00013367533688369443, "entropy": 0.05542500153893516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 58275.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000}, "env_runners": {"episode_reward_max": 74.25656939960058, "episode_reward_min": -226.03973189656176, "episode_reward_mean": 39.19449108307522, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -245.1539190657299, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 44.300000000000246, "predator_policy": 255.43327134319364}, "policy_reward_mean": {"prey_policy": 1.1242284181825868, "predator_policy": 18.473017123354865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.80000000000051, 41.70000000000032, 53.40000000000049, 53.60000000000049, 37.50000000000026, 45.50000000000039, 41.800000000000324, -226.03973189656176, 63.10000000000052, 44.00000000000036, 53.000000000000504, 40.70000000000031, 38.80000000000028, 38.20000000000027, 56.000000000000504, 50.000000000000476, 54.30000000000051, 41.820020684743824, 39.30000000000029, 48.50000000000044, 74.25656939960058, 39.60000000000029, 59.70000000000049, 39.43572877178081, 39.800000000000296, 57.600000000000506, 43.30000000000036, 46.600000000000406, 51.70000000000049, 38.70000000000028, 38.70000000000028, 38.10000000000027, 46.000000000000405, 50.80000000000047, 67.50000000000026, 45.80558198526228, 49.50000000000046, 62.000000000000504, 37.156723091912504, 38.80000000000028, 42.799839459581, 48.60000000000045, 37.90000000000027, 36.857392815851625, -1.2729481609806, 57.90000000000049, 44.30000000000038, 38.50000000000028, 36.200000000000244, 39.97548395029312, 37.30000000000026, 47.500000000000426, 49.40000000000046, 39.50000000000029, 47.00000000000042, 55.50000000000051, 23.050196103067147, 40.58008672146445, 39.78976247269202, 60.10000000000051, 60.2000000000005, 52.75935767669923, 35.80000000000024, 32.2000000000002, 42.20000000000033, 53.60000000000051, 9.197806898819506, 60.10000000000049, 37.80000000000027, 45.20000000000039, 53.10000000000052, 38.400000000000276, 52.30000000000051, 44.300000000000374, 38.00000000000027, 39.30000000000029, 43.40000000000036, 51.00000000000049, -207.39214228136882, 51.20000000000049, 38.90000000000028, 35.82620889001172, 35.80000000000024, 38.20000000000027, 7.756001558453308, 53.128130651651816, 38.20000000000028, 42.500000000000334, 44.80000000000039, 34.90000000000024, 39.700000000000294, 39.60128606487703, 56.80000000000051, 37.700000000000266, 48.800000000000445, 43.00000000000034, 37.65775344964173, 47.80000000000043, 64.0000000000005, 47.20000000000043], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [30.549561776646584, 15.834472440476052, 12.618397488677127, 18.00908990669969, 4.695561536980469, 6.09105453007794, 25.098721873440986, 8.338425808314577, 13.110224179461225, -4.608659396957417, 9.903457807747518, 18.916643658783073, 17.978793941872116, 13.046830710935247, -245.1539190657299, -236.3190841740255, 27.20000000000013, 32.0821248783381, -21.77559419196662, 25.400000000000098, 33.50000000000024, 13.061027945912441, 19.86119626814332, 18.689954462550183, 1.027967783885882, 15.804883739468126, -14.165079499522767, 17.94107259895838, 36.20000000000025, 17.890630584299334, -11.153828912607468, 10.086546215417783, 14.899031909555848, 22.69379779915542, 12.037620529126547, -5.321073551859799, 16.866643310071833, 13.20281195769669, 20.000000000000014, -21.56051393193774, 35.13310303835811, 12.957316748777158, 18.197621746076173, 17.421789445972202, 20.986770410097094, 9.303179449019018, -19.94519861288763, 17.942584232511237, 20.000000000000014, 17.48422616701248, 20.000000000000014, 30.636327480794524, -5.793583981955512, -92.00879064042847, 18.0624496860888, 2.69516813531346, 10.490420065928776, 17.122546212681424, 15.606847971055869, 10.660115236609249, 17.822207862739486, 5.959209162737524, -2.527558639723124, 14.310319788950926, 20.000000000000014, 13.033712484802178, -7.361100281488602, 12.53502433287871, 25.254091298107216, 26.548832992314722, 5.166184067585766, 16.9706149308079, 16.323772457952312, 13.121258985480294, 35.300000000000246, 18.994486548172873, 6.56995428522395, 13.38790008617231, 5.921923376231447, 16.6411712375121, 4.096019754005036, 19.00157545278546, 28.529446885659123, -14.089511646275202, -5.70352444216398, 15.935366126798499, 17.457392815851357, -4.67574793252459, -95.685848915855, -30.607106480707742, 5.572890806074694, 29.610880564037206, -28.783368809654725, 20.733528420687815, 17.501135594645916, -4.213602523648646, -42.282882299873926, 12.355455711113212, 15.763527710100542, 17.738347502284334, -1.6951636111516386, -6.818296286393796, 15.69672296452973, -9.460202860134004, 24.439607935992047, -10.51063389695774, 20.000000000000014, 13.3587480703281, 20.000000000000014, 2.7734234963959348, 27.30604016224683, 21.516552308392384, -25.19674061697644, -7.233955166299406, 1.4072034839543222, 1.312155230567982, -33.91478916912061, 20.000000000000014, 14.831099587204472, 7.650667566410105, 7.163169039223183, 26.923058944548714, 25.400000000000098, -1.5934798139006907, 12.953281274284954, -33.653753508154175, -66.51093026201636, 2.140706905084404, -9.494665439910147, 3.875359926307131, 6.948031795198993, 33.360207192202445, -67.16786382360328, -105.99802791044891, 41.34742108078427, -15.814699981265566, 20.000000000000014, -38.498447128610124, 17.564106349851894, 2.316859232255506, 14.890577852337387, 33.50000000000024, -7.370407483385749, 10.197806029675046, 19.123184116959905, 30.329450970372623, -14.957395049873424, 2.2971872615942344, 11.765200932011494, 3.0594402097465085, 12.405084729947376, 17.902675223647012, 4.628416770631251, -6.072891469759476, 18.091001436563012, 25.870726046868217, -210.7946693542933, -219.92597140734813, 22.49186746717242, 5.13105445588651, 16.99619987746427, 6.931476323000098, -6.40080926961997, -43.788211378645855, -31.204573173012236, 13.828425830606411, -6.842756175015694, 15.007610756398057, -21.429059234954977, -80.48018321949628, 29.90000000000018, 9.39626850496948, -145.3686488601168, 20.000000000000014, 15.416038863118452, -20.856706482638565, 2.1981308798484673, 16.97032030101173, -76.65123628593292, 18.999559570537947, 17.859147141052542, 18.730090135866345, 14.174249093172927, -8.013615059136441, 35.07194920815834, 18.943990169974068, 12.484805617917226, -12.496468757034968, 17.84255859551286, 29.000000000000163, 13.813531335552126, 17.495398016616917, 12.806911828139771, 9.671341624016021, 20.000000000000014, 24.55339009271295, 16.268614944524295, 44.300000000000246, 20.000000000000014, 8.6751660334687], "policy_predator_policy_reward": [2.65043822335361, 3.7655275595239104, 1.1100349439753552, 9.962477660647785, 14.404438463019495, 28.208945469922032, 9.301278126559113, 10.861574191685389, 21.386068652353107, 7.61236656514307, 15.69654219225245, 0.9833563412169307, 3.521206058127871, 7.2531692890647195, 255.43327134319364, 0.0, 0.0, 3.8178751216621176, 40.37559419196688, 0.0, 0.0, 6.4389720540875235, 0.9388037318566931, 1.2100455374498131, 18.072032216114106, 3.8951162605318377, 32.565079499522994, 1.8589274010416075, 0.0, 1.9093694157006538, 41.65382891260763, 9.413453784582181, 6.343484659387484, 10.363685631901268, 11.563357193857485, 23.540116513619303, 2.9333566899281416, 6.297188042303274, 42.446940206200786, 7.61357372573715, 18.24268325122281, 7.923466361242939, 0.0, 3.9805888079516, 0.0, 29.41005014088389, 2.49314453926927, 38.9451986128879, 0.0, 2.3157738329875026, 0.0, 6.963672519205673, 31.893583981955583, 109.2087906404275, 9.437550313911188, 16.404831864686507, 8.70957993407119, 15.377453787318553, 5.737298611095609, 6.695738181239204, 1.9777921372605032, 12.940790837262442, 4.780289388390112, 21.536949462382076, 0.0, 12.966287515197791, 22.472560815821936, 23.153515132788016, 5.845908701892884, 9.851167007685405, 11.33611644661366, 12.332666540254497, 3.376227542047653, 16.678741014519677, 0.0, 7.705513451827128, 4.334048342657999, 12.864820377857917, 13.178076623768519, 3.0588287624878716, 14.564438843606716, 5.137805409183419, 2.8705531143410363, 31.28951164627541, 24.93221322491139, 2.7359450904541305, 0.0, 24.075747932524663, 116.71226556748245, 8.307741668099304, 13.227109193925273, 9.489119435962976, 44.78336880965495, 7.566471579312207, 25.212466929002755, 0.0, 10.462055335029286, 55.66537125373163, 2.5371364480084684, 3.9364722898994216, 20.295163611151658, 25.5182962863939, 12.603277035470233, 28.66020286013416, 28.975821791456344, 6.495204169509595, 0.0, 6.141251929671871, 0.0, 24.22657650360403, 4.793959837753308, 1.883447691607654, 5.456328389898111, 50.024563496445225, 31.33175102580645, 6.528976981135336, 23.785725377744825, 29.918826264067764, 13.468900412795495, 24.149332433589866, 17.099316381295807, 9.014455634932393, 21.79172861120945, 7.1611088793899675, 6.54671872571501, 49.953753508154406, 5.987922378178318, 90.58230097875288, 28.294665439910297, 19.524640073692836, 12.351968204800972, 0.9397928077977933, 137.39351519600785, 44.970183436861966, 0.0, 34.567278900481774, 0.0, 56.29844712861038, 11.294975837240798, 14.024058580651749, 4.709422147662577, 0.0, 26.67040748338587, 8.90219397032492, 0.7768158830400987, 2.0705490296275664, 50.99505152958112, 5.965156258698277, 23.175358858241957, 0.0, 7.094915270052589, 1.8973247763529755, 4.804186502722739, 40.040288196405555, 1.7089985634369764, 5.329273953131894, 0.8288311533072921, 222.49966732696535, 9.408132532827633, 14.168945544113456, 2.8038001225357037, 12.168523676999868, 58.404304706879955, 27.610924831397657, 47.404573173012466, 5.771574169393553, 25.342756175015793, 4.692389243601907, 14.354890582886384, 95.31035343001754, 11.803731495030485, 2.0281306516512956, 6.221658738651616, 157.34699012146444, 8.383961136881512, 39.55670648263883, 22.901869120151506, 2.7296796989882455, 2.857377231542276, 89.6942994838519, 1.9408528589474465, 1.1699098641336534, 6.327036971703771, 27.11361505913657, 0.9159563281187268, 1.8681042937491168, 6.815194382082739, 30.896468757035166, 1.9574414044871276, 0.0, 9.38646866444784, 2.304601983383063, 10.893751468967436, 4.28574852851817, 0.0, 3.2466099072871404, 3.4313850554756695, 0.0, 0.0, 18.524833966531286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.773935167103271, "mean_inference_ms": 3.7063503353850127, "mean_action_processing_ms": 1.8698073210256023, "mean_env_wait_ms": 1.1312935668387434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005532026290893555, "StateBufferConnector_ms": 0.025103211402893066, "ViewRequirementAgentConnector_ms": 0.14035439491271973}, "num_episodes": 8, "episode_return_max": 74.25656939960058, "episode_return_min": -226.03973189656176, "episode_return_mean": 39.19449108307522, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 219.37655586000594, "num_env_steps_trained_throughput_per_sec": 219.37655586000594, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 2976000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2976000, "timers": {"training_iteration_time_ms": 32067.515, "restore_workers_time_ms": 0.016, "training_step_time_ms": 32067.411, "sample_time_ms": 1189.034, "learn_time_ms": 30858.726, "learn_throughput": 259.246, "synch_weights_time_ms": 16.29}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000}, "done": false, "training_iteration": 93, "trial_id": "cd905_00000", "date": "2024-08-20_10-14-46", "timestamp": 1724129086, "time_this_iter_s": 36.47963809967041, "time_total_s": 3042.2610247135162, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169edfe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3042.2610247135162, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 83.65769230769232, "ram_util_percent": 79.9346153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3565469305193614, "cur_kl_coeff": 1.5716068446636198e-10, "cur_lr": 0.0001, "total_loss": 1.3299428058995142, "policy_loss": 0.0001576529922969048, "vf_loss": 1.329785145369787, "vf_explained_var": -0.025795193513234456, "kl": 0.002082546657766531, "entropy": 0.6430849030850425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 58905.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3369680358540444, "cur_kl_coeff": 1.4988010832439612e-16, "cur_lr": 0.0001, "total_loss": 0.9287929408133976, "policy_loss": -0.0001978468911219684, "vf_loss": 0.9289907852808634, "vf_explained_var": 0.004816563261879815, "kl": 0.00025246132137064184, "entropy": 0.049177433272439335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 58905.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000}, "env_runners": {"episode_reward_max": 64.0000000000005, "episode_reward_min": -261.0502031759577, "episode_reward_mean": 31.67400727764033, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -525.3390282094967, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 44.300000000000246, "predator_policy": 529.8472422363061}, "policy_reward_mean": {"prey_policy": -11.238128267385818, "predator_policy": 27.075131906205826}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.20000000000033, 53.60000000000051, 9.197806898819506, 60.10000000000049, 37.80000000000027, 45.20000000000039, 53.10000000000052, 38.400000000000276, 52.30000000000051, 44.300000000000374, 38.00000000000027, 39.30000000000029, 43.40000000000036, 51.00000000000049, -207.39214228136882, 51.20000000000049, 38.90000000000028, 35.82620889001172, 35.80000000000024, 38.20000000000027, 7.756001558453308, 53.128130651651816, 38.20000000000028, 42.500000000000334, 44.80000000000039, 34.90000000000024, 39.700000000000294, 39.60128606487703, 56.80000000000051, 37.700000000000266, 48.800000000000445, 43.00000000000034, 37.65775344964173, 47.80000000000043, 64.0000000000005, 47.20000000000043, 39.700000000000294, 31.000000000000174, 52.4000000000005, 59.955808181750214, 38.70000000000028, -261.0502031759577, 34.37841937027627, -146.8612515091266, 45.4000000000004, 48.3916836752099, 37.618746346683444, 42.700000000000344, 36.70000000000025, 46.87236878748214, 40.499210890131835, 38.50000000000028, 33.80000000000021, 41.50000000000033, 36.00000000000024, 47.78293687402527, 39.50000000000029, 52.50000000000051, 54.73711526055579, 40.400000000000304, 38.20000000000027, 49.20000000000046, 36.40000000000025, 36.10000000000024, 54.00000000000053, 41.005280264151786, 38.70000000000028, 43.30000000000035, 44.40000000000037, -137.72180997316966, -13.836301614297351, 48.60000000000045, 37.23477704404268, 43.17100188448334, 39.40000000000029, 43.90524333994307, 40.27684881382101, 55.329774405761974, -94.95325519241376, 46.3000000000004, 38.60000000000028, 41.900000000000325, 42.10000000000033, 39.20000000000029, 38.300000000000274, 39.60000000000029, 56.10000000000051, 38.10000000000027, 41.900000000000325, 37.90000000000027, 44.600000000000385, 29.328581310170847, 38.575938155832766, 52.000000000000504, 50.10000000000047, 46.29739191821913, 52.50000000000051, 59.600000000000534, 39.587377474345615, 37.00000000000025], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.494665439910147, 3.875359926307131, 6.948031795198993, 33.360207192202445, -67.16786382360328, -105.99802791044891, 41.34742108078427, -15.814699981265566, 20.000000000000014, -38.498447128610124, 17.564106349851894, 2.316859232255506, 14.890577852337387, 33.50000000000024, -7.370407483385749, 10.197806029675046, 19.123184116959905, 30.329450970372623, -14.957395049873424, 2.2971872615942344, 11.765200932011494, 3.0594402097465085, 12.405084729947376, 17.902675223647012, 4.628416770631251, -6.072891469759476, 18.091001436563012, 25.870726046868217, -210.7946693542933, -219.92597140734813, 22.49186746717242, 5.13105445588651, 16.99619987746427, 6.931476323000098, -6.40080926961997, -43.788211378645855, -31.204573173012236, 13.828425830606411, -6.842756175015694, 15.007610756398057, -21.429059234954977, -80.48018321949628, 29.90000000000018, 9.39626850496948, -145.3686488601168, 20.000000000000014, 15.416038863118452, -20.856706482638565, 2.1981308798484673, 16.97032030101173, -76.65123628593292, 18.999559570537947, 17.859147141052542, 18.730090135866345, 14.174249093172927, -8.013615059136441, 35.07194920815834, 18.943990169974068, 12.484805617917226, -12.496468757034968, 17.84255859551286, 29.000000000000163, 13.813531335552126, 17.495398016616917, 12.806911828139771, 9.671341624016021, 20.000000000000014, 24.55339009271295, 16.268614944524295, 44.300000000000246, 20.000000000000014, 8.6751660334687, 16.786430618516544, 20.000000000000014, -96.11776760489812, -40.80166135857497, 12.696824945180964, 20.666811753124183, 12.025997477035851, -7.033193114010526, 18.810138511285743, -0.4545066316133759, -265.5584172027671, -525.3390282094967, -41.604766894280935, 4.941384614292659, -154.24239523386353, -210.01899924693248, -42.23239403911078, -31.23761071952542, 12.571477247841012, 17.18378963298677, -18.10613783533347, 15.533570536102804, -15.9031918060238, -3.6519358947555762, -34.03661651286148, 20.000000000000014, -13.55276763423126, 10.04366470253202, -36.57609631283428, -5.887596743262769, 12.187952851386479, 0.07532802660306825, 20.000000000000014, -155.43773715552058, 16.4552274512479, -12.259987461883245, -2.599003635880232, -10.117099935595286, 16.192328384880508, -21.933397398405937, -45.42287426435088, 19.14528141020215, -1.612908366179166, 32.15767473977326, 5.674913688096153, 0.4475764067345861, -38.8140377530096, 19.091998141963657, 10.897192337951576, -10.944647126101875, -8.811230572505448, 23.447922823207612, -13.525997652243989, 13.07882228746382, -101.26115505581757, 0.40129798867570343, 28.100000000000147, 13.058302032316934, 1.5581136751691689, -11.991225971829023, 20.000000000000014, 0.6750155414268054, 20.000000000000014, -8.973523953611634, 20.371138698143465, -1.7887379564291153, -152.0025548555658, -288.57179410613634, -63.30771952964027, -86.6440697677806, 11.284959063177423, 17.102052775268778, -14.367180229035293, -8.889641910083082, 16.28962157655143, 7.567305202123595, 20.000000000000014, 7.064360434121184, 17.74900244404142, 15.89174593082096, 8.426391683013197, 20.000000000000014, 17.534809594808372, 21.995938162126784, -252.05947572137083, -109.91535712965592, 18.551026748106626, 11.728170320219338, 15.021393323632301, -9.504257545664453, 16.700084869376933, 6.506652900721466, 4.478836719031834, 12.67184659225075, 20.000000000000014, -0.3612613093342002, 8.351268233286007, 11.597141873317026, 16.170279650198975, 18.99346795933108, 13.615562042522448, 30.800000000000196, -17.974148574555578, -2.3702570837748396, -10.330280661410542, 15.051084390355825, 20.000000000000014, -25.346373161439068, 20.000000000000014, -81.43161342882692, -6.0695677650656705, 6.627395489824135, 17.878075647877967, 7.9292878538274145, 30.408748177655504, 9.956128592448717, 13.285961126167768, 25.603456447150798, 5.901814593925376, 21.409467723724983, 31.388886586783826, 20.000000000000014, 29.71913070400752, 27.849875633585988, 16.61871359270142, 15.828132128795097, -57.710350154142624, 6.45111651948497], "policy_predator_policy_reward": [28.294665439910297, 19.524640073692836, 12.351968204800972, 0.9397928077977933, 137.39351519600785, 44.970183436861966, 0.0, 34.567278900481774, 0.0, 56.29844712861038, 11.294975837240798, 14.024058580651749, 4.709422147662577, 0.0, 26.67040748338587, 8.90219397032492, 0.7768158830400987, 2.0705490296275664, 50.99505152958112, 5.965156258698277, 23.175358858241957, 0.0, 7.094915270052589, 1.8973247763529755, 4.804186502722739, 40.040288196405555, 1.7089985634369764, 5.329273953131894, 0.8288311533072921, 222.49966732696535, 9.408132532827633, 14.168945544113456, 2.8038001225357037, 12.168523676999868, 58.404304706879955, 27.610924831397657, 47.404573173012466, 5.771574169393553, 25.342756175015793, 4.692389243601907, 14.354890582886384, 95.31035343001754, 11.803731495030485, 2.0281306516512956, 6.221658738651616, 157.34699012146444, 8.383961136881512, 39.55670648263883, 22.901869120151506, 2.7296796989882455, 2.857377231542276, 89.6942994838519, 1.9408528589474465, 1.1699098641336534, 6.327036971703771, 27.11361505913657, 0.9159563281187268, 1.8681042937491168, 6.815194382082739, 30.896468757035166, 1.9574414044871276, 0.0, 9.38646866444784, 2.304601983383063, 10.893751468967436, 4.28574852851817, 0.0, 3.2466099072871404, 3.4313850554756695, 0.0, 0.0, 18.524833966531286, 2.9135693814834296, 0.0, 8.651012325831472, 159.26841663764134, 6.903175054819001, 12.133188246875841, 14.92981070471383, 40.03319311401061, 1.0898614887142568, 19.25450663161338, 0.0, 529.8472422363061, 6.122208590638188, 64.91959305962637, 1.0689476385561822, 216.33119533311316, 6.310416532176019, 112.55958822646045, 7.620206427368407, 11.016210367013208, 3.405327441964002, 36.78598620395007, 30.367735789557408, 31.887391911222263, 50.736616512861715, 0.0, 32.37124336737313, 18.010228351808035, 44.550806226029714, 38.4120977201992, 7.312047148613486, 18.92467197339693, 0.0, 169.2377371555198, 23.710993674284236, 13.593766336351264, 36.411598702869455, 12.304504868606202, 24.427663199226327, 29.096342688324167, 15.90288932897477, 49.87470352517421, 20.712908366179192, 1.2423252602269543, 20.829215273721548, 27.785409892002942, 11.990759994737674, 48.131279616308525, 8.502807662048388, 29.744647126102052, 14.94758547724642, 19.615722272051606, 30.525997652244186, 6.321177712536149, 118.46115505581659, 18.49870201132429, 0.0, 12.841697967683032, 31.055119877205488, 20.383272683605995, 0.0, 18.024984458573183, 16.430802272441706, 15.842721681170051, 5.5288613018565576, 20.28873795642913, 12.40343929035588, 290.4490996981768, 134.5741042674842, 1.5413834156374249, 17.61504093682255, 2.597947224731199, 5.898372058626974, 54.59322712453419, 8.081380307931527, 11.232694797876372, 0.0, 12.33563956587878, 1.5562408959012766, 8.708254069179002, 1.076848813820709, 10.773608316986767, 7.887057787509064, 7.911968861317268, 253.1610616563263, 13.860516002286674, 8.248973251893371, 7.771829679780627, 4.578606676367663, 28.504257545664608, 6.399915130623038, 12.2933470992785, 14.521163280968132, 10.428153407749216, 0.0, 19.56126130933421, 10.74873176671396, 7.602858126682939, 3.529720349800989, 0.9065320406689199, 5.215073583262061, 6.469364374215457, 36.57414857455584, 21.87025708377488, 2.3437096609345147, 34.83548661012033, 33.62543320822566, 9.620939953213679, 85.13953239083469, 20.89208103799147, 4.842674482594026, 23.928079102818273, 1.6978625079545029, 11.070712146172552, 1.9912518223446858, 9.643871407551247, 6.314038873832196, 4.896543552849308, 0.9077427836643036, 18.07836681690407, 1.1111134132163836, 0.0, 0.9808692959926586, 1.0501243664141562, 7.140531752848741, 0.0, 9.292168903581242, 78.9670647310765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.780087817935831, "mean_inference_ms": 3.705384736280202, "mean_action_processing_ms": 1.882719309770883, "mean_env_wait_ms": 1.1321010075003786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004586219787597656, "StateBufferConnector_ms": 0.018332242965698242, "ViewRequirementAgentConnector_ms": 0.13473546504974365}, "num_episodes": 64, "episode_return_max": 64.0000000000005, "episode_return_min": -261.0502031759577, "episode_return_mean": 31.67400727764033, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 244.9307133992208, "num_env_steps_trained_throughput_per_sec": 244.9307133992208, "timesteps_total": 752000, "num_env_steps_sampled_lifetime": 752000, "num_agent_steps_sampled_lifetime": 3008000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 3008000, "timers": {"training_iteration_time_ms": 32320.002, "restore_workers_time_ms": 0.017, "training_step_time_ms": 32319.895, "sample_time_ms": 1209.166, "learn_time_ms": 31091.45, "learn_throughput": 257.305, "synch_weights_time_ms": 15.907}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000}, "done": false, "training_iteration": 94, "trial_id": "cd905_00000", "date": "2024-08-20_10-15-19", "timestamp": 1724129119, "time_this_iter_s": 32.66965317726135, "time_total_s": 3074.9306778907776, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afeac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3074.9306778907776, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 98.96739130434787, "ram_util_percent": 79.99347826086957}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8870022479976927, "cur_kl_coeff": 7.858034223318099e-11, "cur_lr": 0.0001, "total_loss": 0.523099085576241, "policy_loss": -0.0011500626292434476, "vf_loss": 0.5242491489128461, "vf_explained_var": -0.006729079712004889, "kl": 0.005266928546405411, "entropy": 0.6712121568028889, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.20350491913065077, "cur_kl_coeff": 7.494005416219806e-17, "cur_lr": 0.0001, "total_loss": 0.45326820739677975, "policy_loss": 0.0004131062835868862, "vf_loss": 0.45285510120410766, "vf_explained_var": 0.00311568332096887, "kl": 0.00020553684480492372, "entropy": 0.05710023703674475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "env_runners": {"episode_reward_max": 64.0000000000005, "episode_reward_min": -261.0502031759577, "episode_reward_mean": 29.456173115708975, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -525.3390282094967, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 44.300000000000246, "predator_policy": 529.8472422363061}, "policy_reward_mean": {"prey_policy": -13.31173187726718, "predator_policy": 28.039818435121514}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.30000000000051, 44.300000000000374, 38.00000000000027, 39.30000000000029, 43.40000000000036, 51.00000000000049, -207.39214228136882, 51.20000000000049, 38.90000000000028, 35.82620889001172, 35.80000000000024, 38.20000000000027, 7.756001558453308, 53.128130651651816, 38.20000000000028, 42.500000000000334, 44.80000000000039, 34.90000000000024, 39.700000000000294, 39.60128606487703, 56.80000000000051, 37.700000000000266, 48.800000000000445, 43.00000000000034, 37.65775344964173, 47.80000000000043, 64.0000000000005, 47.20000000000043, 39.700000000000294, 31.000000000000174, 52.4000000000005, 59.955808181750214, 38.70000000000028, -261.0502031759577, 34.37841937027627, -146.8612515091266, 45.4000000000004, 48.3916836752099, 37.618746346683444, 42.700000000000344, 36.70000000000025, 46.87236878748214, 40.499210890131835, 38.50000000000028, 33.80000000000021, 41.50000000000033, 36.00000000000024, 47.78293687402527, 39.50000000000029, 52.50000000000051, 54.73711526055579, 40.400000000000304, 38.20000000000027, 49.20000000000046, 36.40000000000025, 36.10000000000024, 54.00000000000053, 41.005280264151786, 38.70000000000028, 43.30000000000035, 44.40000000000037, -137.72180997316966, -13.836301614297351, 48.60000000000045, 37.23477704404268, 43.17100188448334, 39.40000000000029, 43.90524333994307, 40.27684881382101, 55.329774405761974, -94.95325519241376, 46.3000000000004, 38.60000000000028, 41.900000000000325, 42.10000000000033, 39.20000000000029, 38.300000000000274, 39.60000000000029, 56.10000000000051, 38.10000000000027, 41.900000000000325, 37.90000000000027, 44.600000000000385, 29.328581310170847, 38.575938155832766, 52.000000000000504, 50.10000000000047, 46.29739191821913, 52.50000000000051, 59.600000000000534, 39.587377474345615, 37.00000000000025, 47.200000000000415, 45.194496548029434, 50.20000000000046, -199.2801058423448, 45.100000000000385, 41.900000000000325, 50.10000000000047, 37.40000000000026], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [19.123184116959905, 30.329450970372623, -14.957395049873424, 2.2971872615942344, 11.765200932011494, 3.0594402097465085, 12.405084729947376, 17.902675223647012, 4.628416770631251, -6.072891469759476, 18.091001436563012, 25.870726046868217, -210.7946693542933, -219.92597140734813, 22.49186746717242, 5.13105445588651, 16.99619987746427, 6.931476323000098, -6.40080926961997, -43.788211378645855, -31.204573173012236, 13.828425830606411, -6.842756175015694, 15.007610756398057, -21.429059234954977, -80.48018321949628, 29.90000000000018, 9.39626850496948, -145.3686488601168, 20.000000000000014, 15.416038863118452, -20.856706482638565, 2.1981308798484673, 16.97032030101173, -76.65123628593292, 18.999559570537947, 17.859147141052542, 18.730090135866345, 14.174249093172927, -8.013615059136441, 35.07194920815834, 18.943990169974068, 12.484805617917226, -12.496468757034968, 17.84255859551286, 29.000000000000163, 13.813531335552126, 17.495398016616917, 12.806911828139771, 9.671341624016021, 20.000000000000014, 24.55339009271295, 16.268614944524295, 44.300000000000246, 20.000000000000014, 8.6751660334687, 16.786430618516544, 20.000000000000014, -96.11776760489812, -40.80166135857497, 12.696824945180964, 20.666811753124183, 12.025997477035851, -7.033193114010526, 18.810138511285743, -0.4545066316133759, -265.5584172027671, -525.3390282094967, -41.604766894280935, 4.941384614292659, -154.24239523386353, -210.01899924693248, -42.23239403911078, -31.23761071952542, 12.571477247841012, 17.18378963298677, -18.10613783533347, 15.533570536102804, -15.9031918060238, -3.6519358947555762, -34.03661651286148, 20.000000000000014, -13.55276763423126, 10.04366470253202, -36.57609631283428, -5.887596743262769, 12.187952851386479, 0.07532802660306825, 20.000000000000014, -155.43773715552058, 16.4552274512479, -12.259987461883245, -2.599003635880232, -10.117099935595286, 16.192328384880508, -21.933397398405937, -45.42287426435088, 19.14528141020215, -1.612908366179166, 32.15767473977326, 5.674913688096153, 0.4475764067345861, -38.8140377530096, 19.091998141963657, 10.897192337951576, -10.944647126101875, -8.811230572505448, 23.447922823207612, -13.525997652243989, 13.07882228746382, -101.26115505581757, 0.40129798867570343, 28.100000000000147, 13.058302032316934, 1.5581136751691689, -11.991225971829023, 20.000000000000014, 0.6750155414268054, 20.000000000000014, -8.973523953611634, 20.371138698143465, -1.7887379564291153, -152.0025548555658, -288.57179410613634, -63.30771952964027, -86.6440697677806, 11.284959063177423, 17.102052775268778, -14.367180229035293, -8.889641910083082, 16.28962157655143, 7.567305202123595, 20.000000000000014, 7.064360434121184, 17.74900244404142, 15.89174593082096, 8.426391683013197, 20.000000000000014, 17.534809594808372, 21.995938162126784, -252.05947572137083, -109.91535712965592, 18.551026748106626, 11.728170320219338, 15.021393323632301, -9.504257545664453, 16.700084869376933, 6.506652900721466, 4.478836719031834, 12.67184659225075, 20.000000000000014, -0.3612613093342002, 8.351268233286007, 11.597141873317026, 16.170279650198975, 18.99346795933108, 13.615562042522448, 30.800000000000196, -17.974148574555578, -2.3702570837748396, -10.330280661410542, 15.051084390355825, 20.000000000000014, -25.346373161439068, 20.000000000000014, -81.43161342882692, -6.0695677650656705, 6.627395489824135, 17.878075647877967, 7.9292878538274145, 30.408748177655504, 9.956128592448717, 13.285961126167768, 25.603456447150798, 5.901814593925376, 21.409467723724983, 31.388886586783826, 20.000000000000014, 29.71913070400752, 27.849875633585988, 16.61871359270142, 15.828132128795097, -57.710350154142624, 6.45111651948497, 16.09812097942519, 20.000000000000014, -29.045195127997616, 12.497905779467256, 15.33170815110824, -27.95800052426295, -244.34258096673761, -214.6977761422931, -10.58320358190233, 1.427846196994696, -15.911406937286324, 1.6446930404304043, 8.270391487053082, -3.9605892008375334, -1.319863003555, -2.516514434489109], "policy_predator_policy_reward": [0.7768158830400987, 2.0705490296275664, 50.99505152958112, 5.965156258698277, 23.175358858241957, 0.0, 7.094915270052589, 1.8973247763529755, 4.804186502722739, 40.040288196405555, 1.7089985634369764, 5.329273953131894, 0.8288311533072921, 222.49966732696535, 9.408132532827633, 14.168945544113456, 2.8038001225357037, 12.168523676999868, 58.404304706879955, 27.610924831397657, 47.404573173012466, 5.771574169393553, 25.342756175015793, 4.692389243601907, 14.354890582886384, 95.31035343001754, 11.803731495030485, 2.0281306516512956, 6.221658738651616, 157.34699012146444, 8.383961136881512, 39.55670648263883, 22.901869120151506, 2.7296796989882455, 2.857377231542276, 89.6942994838519, 1.9408528589474465, 1.1699098641336534, 6.327036971703771, 27.11361505913657, 0.9159563281187268, 1.8681042937491168, 6.815194382082739, 30.896468757035166, 1.9574414044871276, 0.0, 9.38646866444784, 2.304601983383063, 10.893751468967436, 4.28574852851817, 0.0, 3.2466099072871404, 3.4313850554756695, 0.0, 0.0, 18.524833966531286, 2.9135693814834296, 0.0, 8.651012325831472, 159.26841663764134, 6.903175054819001, 12.133188246875841, 14.92981070471383, 40.03319311401061, 1.0898614887142568, 19.25450663161338, 0.0, 529.8472422363061, 6.122208590638188, 64.91959305962637, 1.0689476385561822, 216.33119533311316, 6.310416532176019, 112.55958822646045, 7.620206427368407, 11.016210367013208, 3.405327441964002, 36.78598620395007, 30.367735789557408, 31.887391911222263, 50.736616512861715, 0.0, 32.37124336737313, 18.010228351808035, 44.550806226029714, 38.4120977201992, 7.312047148613486, 18.92467197339693, 0.0, 169.2377371555198, 23.710993674284236, 13.593766336351264, 36.411598702869455, 12.304504868606202, 24.427663199226327, 29.096342688324167, 15.90288932897477, 49.87470352517421, 20.712908366179192, 1.2423252602269543, 20.829215273721548, 27.785409892002942, 11.990759994737674, 48.131279616308525, 8.502807662048388, 29.744647126102052, 14.94758547724642, 19.615722272051606, 30.525997652244186, 6.321177712536149, 118.46115505581659, 18.49870201132429, 0.0, 12.841697967683032, 31.055119877205488, 20.383272683605995, 0.0, 18.024984458573183, 16.430802272441706, 15.842721681170051, 5.5288613018565576, 20.28873795642913, 12.40343929035588, 290.4490996981768, 134.5741042674842, 1.5413834156374249, 17.61504093682255, 2.597947224731199, 5.898372058626974, 54.59322712453419, 8.081380307931527, 11.232694797876372, 0.0, 12.33563956587878, 1.5562408959012766, 8.708254069179002, 1.076848813820709, 10.773608316986767, 7.887057787509064, 7.911968861317268, 253.1610616563263, 13.860516002286674, 8.248973251893371, 7.771829679780627, 4.578606676367663, 28.504257545664608, 6.399915130623038, 12.2933470992785, 14.521163280968132, 10.428153407749216, 0.0, 19.56126130933421, 10.74873176671396, 7.602858126682939, 3.529720349800989, 0.9065320406689199, 5.215073583262061, 6.469364374215457, 36.57414857455584, 21.87025708377488, 2.3437096609345147, 34.83548661012033, 33.62543320822566, 9.620939953213679, 85.13953239083469, 20.89208103799147, 4.842674482594026, 23.928079102818273, 1.6978625079545029, 11.070712146172552, 1.9912518223446858, 9.643871407551247, 6.314038873832196, 4.896543552849308, 0.9077427836643036, 18.07836681690407, 1.1111134132163836, 0.0, 0.9808692959926586, 1.0501243664141562, 7.140531752848741, 0.0, 9.292168903581242, 78.9670647310765, 1.0700919533655715, 10.031787067209201, 15.195254416842694, 46.54653147971693, 47.42845871976306, 15.397833653391796, 254.14908432713278, 5.6111669395532005, 34.68320358190249, 19.572153803005286, 34.311406937286584, 21.855306959569567, 22.629608512946888, 23.16058920083759, 24.002263558058267, 17.23411387998589]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.773262713960625, "mean_inference_ms": 3.707032896182808, "mean_action_processing_ms": 1.875628398722343, "mean_env_wait_ms": 1.1305346805761514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004540920257568359, "StateBufferConnector_ms": 0.0157320499420166, "ViewRequirementAgentConnector_ms": 0.1354583501815796}, "num_episodes": 8, "episode_return_max": 64.0000000000005, "episode_return_min": -261.0502031759577, "episode_return_mean": 29.456173115708975, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 245.65153189438863, "num_env_steps_trained_throughput_per_sec": 245.65153189438863, "timesteps_total": 760000, "num_env_steps_sampled_lifetime": 760000, "num_agent_steps_sampled_lifetime": 3040000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 3040000, "timers": {"training_iteration_time_ms": 32570.758, "restore_workers_time_ms": 0.017, "training_step_time_ms": 32570.651, "sample_time_ms": 1237.478, "learn_time_ms": 31313.279, "learn_throughput": 255.483, "synch_weights_time_ms": 16.514}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "done": false, "training_iteration": 95, "trial_id": "cd905_00000", "date": "2024-08-20_10-15-51", "timestamp": 1724129151, "time_this_iter_s": 32.57196497917175, "time_total_s": 3107.5026428699493, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169f75af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3107.5026428699493, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 98.44130434782609, "ram_util_percent": 78.93695652173912}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.242253385649787, "cur_kl_coeff": 7.858034223318099e-11, "cur_lr": 0.0001, "total_loss": 1.3225586633833628, "policy_loss": -0.0021716615451233727, "vf_loss": 1.324730318500882, "vf_explained_var": -0.01432208466151404, "kl": 0.00846275666627041, "entropy": 0.7766960824292803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 60165.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.32480634207290315, "cur_kl_coeff": 3.747002708109903e-17, "cur_lr": 0.0001, "total_loss": 0.9897350224237593, "policy_loss": -0.0003812740556895733, "vf_loss": 0.9901162937520043, "vf_explained_var": 0.0017363825487712074, "kl": 0.00034315675205732983, "entropy": 0.05877988593918937, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 60165.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000}, "env_runners": {"episode_reward_max": 84.41618727859709, "episode_reward_min": -199.2801058423448, "episode_reward_mean": 40.00563630039866, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -252.05947572137083, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 39.80000000000024, "predator_policy": 258.7570661526145}, "policy_reward_mean": {"prey_policy": -1.3063125279358383, "predator_policy": 21.30913067813502}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.23477704404268, 43.17100188448334, 39.40000000000029, 43.90524333994307, 40.27684881382101, 55.329774405761974, -94.95325519241376, 46.3000000000004, 38.60000000000028, 41.900000000000325, 42.10000000000033, 39.20000000000029, 38.300000000000274, 39.60000000000029, 56.10000000000051, 38.10000000000027, 41.900000000000325, 37.90000000000027, 44.600000000000385, 29.328581310170847, 38.575938155832766, 52.000000000000504, 50.10000000000047, 46.29739191821913, 52.50000000000051, 59.600000000000534, 39.587377474345615, 37.00000000000025, 47.200000000000415, 45.194496548029434, 50.20000000000046, -199.2801058423448, 45.100000000000385, 41.900000000000325, 50.10000000000047, 37.40000000000026, 34.477141514250555, 39.80996272120294, 46.500000000000405, 48.00000000000044, 39.40000000000029, 39.20000000000029, 56.900000000000496, 50.10000000000047, 51.70000000000049, 39.40000000000029, 40.0000000000003, 36.96869333164552, 50.40000000000048, 36.70000000000025, 39.50000000000029, 38.80000000000028, 39.30000000000029, 59.10000000000049, 9.758123339458729, 54.30000000000052, 26.700000000000095, 52.60000000000049, 38.90000000000028, 39.30000000000029, 40.30000000000033, 39.700000000000294, 34.200000000000216, 49.700000000000465, 43.95986219496591, 55.63615204432068, 50.80000000000048, 50.90000000000048, 38.80000000000028, 38.50000000000028, 54.2000000000005, 42.80000000000034, 38.300000000000274, 36.80000000000025, 46.929327717045, 32.100000000000186, 40.10000000000031, 46.2000000000004, 39.000000000000284, 39.60000000000029, 58.7000000000005, 46.400000000000404, 44.18472355799651, 56.900000000000496, 56.80000000000054, 38.60000000000028, 48.60000000000044, 41.83318061388653, 84.41618727859709, 49.60000000000046, 27.30000000000012, 44.60000000000037, 51.70000000000049, 39.30000000000029, 31.039312965379068, 37.28289290119891, 41.100000000000314, 49.30000000000045, 39.800000000000296, 55.00000000000051], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.367180229035293, -8.889641910083082, 16.28962157655143, 7.567305202123595, 20.000000000000014, 7.064360434121184, 17.74900244404142, 15.89174593082096, 8.426391683013197, 20.000000000000014, 17.534809594808372, 21.995938162126784, -252.05947572137083, -109.91535712965592, 18.551026748106626, 11.728170320219338, 15.021393323632301, -9.504257545664453, 16.700084869376933, 6.506652900721466, 4.478836719031834, 12.67184659225075, 20.000000000000014, -0.3612613093342002, 8.351268233286007, 11.597141873317026, 16.170279650198975, 18.99346795933108, 13.615562042522448, 30.800000000000196, -17.974148574555578, -2.3702570837748396, -10.330280661410542, 15.051084390355825, 20.000000000000014, -25.346373161439068, 20.000000000000014, -81.43161342882692, -6.0695677650656705, 6.627395489824135, 17.878075647877967, 7.9292878538274145, 30.408748177655504, 9.956128592448717, 13.285961126167768, 25.603456447150798, 5.901814593925376, 21.409467723724983, 31.388886586783826, 20.000000000000014, 29.71913070400752, 27.849875633585988, 16.61871359270142, 15.828132128795097, -57.710350154142624, 6.45111651948497, 16.09812097942519, 20.000000000000014, -29.045195127997616, 12.497905779467256, 15.33170815110824, -27.95800052426295, -244.34258096673761, -214.6977761422931, -10.58320358190233, 1.427846196994696, -15.911406937286324, 1.6446930404304043, 8.270391487053082, -3.9605892008375334, -1.319863003555, -2.516514434489109, -12.956978786252451, -17.26584100810314, 8.78079160765011, 9.062065747801057, 12.83293692253545, 12.389387562624782, -4.859078767905768, 14.845246148404783, 4.856774103327137, 20.000000000000014, 8.319511612127432, 20.000000000000014, 5.53539041369193, 31.20898248663465, 13.816812989056167, 21.82823452130336, 23.6758220540695, -4.566159634309605, -12.099202026954874, 17.08187754244381, -6.103016685176156, -0.22468903751694388, -0.8697053776388766, 3.564351090484539, 15.092401759973528, 17.393227907441524, -20.22736587459888, 18.808160876002027, 11.835781937507516, 20.000000000000014, 13.090249727779351, 2.4147091602411344, 20.000000000000014, 10.229095629032866, -0.8423259426421057, 39.80000000000024, -90.88639610704634, -28.762041986165983, 34.40000000000026, 18.77399001813296, -120.6669365498532, -17.256492299960676, 9.606735211925397, 11.31555479276372, 7.176423333082964, 19.112100210242488, 4.634555849906006, 18.969294291905708, -204.59294287558512, 16.169024818221075, 14.458542056958109, 20.000000000000014, -22.604179786048036, -18.784846550627933, 24.76615332980809, -0.3875186076733609, -0.2101840333311866, 14.501532568057762, 4.632276534358743, 20.33346557882543, -21.822872134519166, 33.50000000000024, 31.700000000000212, -8.451335525100816, 7.792572507755464, 13.457458649030247, -9.018986559122926, 15.561787105370275, 34.40000000000025, 17.737459392554364, -7.4111812653670555, 18.010588062684185, 3.312555688048445, 7.77962632048585, 16.143403299735432, -24.23512765550798, 21.80000000000004, -47.500861972851304, -134.60083787888297, 4.274247367234844, 20.000000000000014, 0.4092299108889329, 13.138757770311281, 14.15776452622667, 15.240823619313655, 5.276783276340671, 15.68891032084044, 4.768874815969669, 21.54442428950578, 35.05853028483561, 23.224040737875438, 14.26066283196856, 14.725325359271872, -2.6974641932389014, 31.302840661505407, 14.243842066437573, 27.9823288590586, 25.36236214445522, 18.06268433353615, 6.327117563645942, 18.58896661613421, 25.56917836014999, 17.669221261244374, 5.747420249780877, -64.44354370574419, 20.000000000000014, 30.800000000000196, -4.488130675610076, 11.746486267396975, -145.61271730690882, 16.646117651402655, -3.972661259761343, 13.726792916349696, 0.17151792794760082, 13.597474138873984, 15.882093236813601, -15.974949811325823, -215.65183281701474, 18.981904614961838, -109.12345283187248, 11.43370734579254, 8.016296757314175, 14.132310402836634, 27.722222214676684, 17.67499981487494, 20.000000000000014, -13.378573476324133, 33.406800974938136], "policy_predator_policy_reward": [5.898372058626974, 54.59322712453419, 8.081380307931527, 11.232694797876372, 0.0, 12.33563956587878, 1.5562408959012766, 8.708254069179002, 1.076848813820709, 10.773608316986767, 7.887057787509064, 7.911968861317268, 253.1610616563263, 13.860516002286674, 8.248973251893371, 7.771829679780627, 4.578606676367663, 28.504257545664608, 6.399915130623038, 12.2933470992785, 14.521163280968132, 10.428153407749216, 0.0, 19.56126130933421, 10.74873176671396, 7.602858126682939, 3.529720349800989, 0.9065320406689199, 5.215073583262061, 6.469364374215457, 36.57414857455584, 21.87025708377488, 2.3437096609345147, 34.83548661012033, 33.62543320822566, 9.620939953213679, 85.13953239083469, 20.89208103799147, 4.842674482594026, 23.928079102818273, 1.6978625079545029, 11.070712146172552, 1.9912518223446858, 9.643871407551247, 6.314038873832196, 4.896543552849308, 0.9077427836643036, 18.07836681690407, 1.1111134132163836, 0.0, 0.9808692959926586, 1.0501243664141562, 7.140531752848741, 0.0, 9.292168903581242, 78.9670647310765, 1.0700919533655715, 10.031787067209201, 15.195254416842694, 46.54653147971693, 47.42845871976306, 15.397833653391796, 254.14908432713278, 5.6111669395532005, 34.68320358190249, 19.572153803005286, 34.311406937286584, 21.855306959569567, 22.629608512946888, 23.16058920083759, 24.002263558058267, 17.23411387998589, 16.765789184162898, 47.9341721244435, 5.424575918281918, 16.542529447469498, 0.0, 21.277675514839707, 3.415138408263448, 34.59869421123755, 14.543225896672828, 0.0, 10.880488387872534, 0.0, 13.864609586308035, 6.29101751336556, 12.7831870109438, 1.6717654786966796, 9.924177945930575, 22.666159634309658, 31.699202026955067, 2.7181224575561673, 25.10301668517625, 21.22468903751695, 16.678897525265246, 17.59515009353433, 4.507598240026436, 13.406772092558455, 37.02736587459912, 1.091839123997972, 7.664218062492449, 0.0, 6.5097502722206135, 16.785290839758837, 0.0, 9.0709043709671, 20.142325942642124, 0.0, 5.041773127040036, 124.36478830563048, 0.0, 1.12600998186704, 55.8596035304753, 108.7638253193386, 0.0, 31.67770999531082, 11.823576666917003, 0.7878997897575161, 14.765444150093959, 0.9307057080942938, 4.270059437812909, 224.4538586195508, 5.241457943041855, 0.0, 38.804179786048266, 36.78484655062819, 6.4338466701920005, 18.88751860767336, 16.741564497555736, 12.926949162683199, 16.338135748851435, 14.332274182284559, 39.12287213451941, 0.0, 0.0, 27.651335525100954, 11.6074274922445, 5.942541350969718, 27.91898655912307, 4.038212894629689, 0.0, 2.062540607445622, 26.21118126536717, 5.989411937315804, 15.887444311951517, 11.320373679514116, 3.5565967002645333, 41.33512765550822, 35.63866703764892, 36.99152265224712, 15.000650062370532, 147.42594044927685, 17.323322846509242, 2.3674472426017825, 8.061242229688684, 10.842235473773297, 4.359176380686309, 14.123216723659294, 3.911089679159523, 15.231125184030297, 1.0555757104942574, 1.0414697151646373, 3.6759592621246258, 5.239337168031405, 23.319091741072143, 8.837770650891024, 6.097159338494805, 5.256157933562393, 0.9176711409415451, 2.53763785554488, 1.7373156664638394, 12.472882436354025, 1.3110333838657855, 3.1308216398501134, 5.0538349086467464, 13.362704194214164, 55.68959380329336, 73.17013718104798, 0.0, 23.288130675610137, 158.96239068729255, 2.2038403522189918, 28.292942346823036, 3.6336012615356608, 8.853037954306625, 28.948651201396007, 6.00252586112598, 3.817906763186362, 258.7570661526145, 3.90902944110477, 112.45577201784738, 14.968669100261257, 10.566292654207427, 11.083703242685791, 5.46768959716333, 1.9777777853234597, 2.1250001851250433, 0.0, 32.378573476324355, 2.593199025062107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.775814994519527, "mean_inference_ms": 3.6998393172734514, "mean_action_processing_ms": 1.876397817483347, "mean_env_wait_ms": 1.1303060962950455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033028125762939453, "StateBufferConnector_ms": 0.012451410293579102, "ViewRequirementAgentConnector_ms": 0.09925305843353271}, "num_episodes": 64, "episode_return_max": 84.41618727859709, "episode_return_min": -199.2801058423448, "episode_return_mean": 40.00563630039866, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 243.6343362169076, "num_env_steps_trained_throughput_per_sec": 243.6343362169076, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 3072000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 3072000, "timers": {"training_iteration_time_ms": 32851.006, "restore_workers_time_ms": 0.017, "training_step_time_ms": 32850.893, "sample_time_ms": 1267.256, "learn_time_ms": 31562.506, "learn_throughput": 253.465, "synch_weights_time_ms": 17.581}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000}, "done": false, "training_iteration": 96, "trial_id": "cd905_00000", "date": "2024-08-20_10-16-24", "timestamp": 1724129184, "time_this_iter_s": 32.84394598007202, "time_total_s": 3140.3465888500214, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a17d310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3140.3465888500214, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 88.98723404255323, "ram_util_percent": 78.75319148936171}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9448130102857711, "cur_kl_coeff": 7.858034223318099e-11, "cur_lr": 0.0001, "total_loss": 1.277581523098643, "policy_loss": -0.0002875617904854672, "vf_loss": 1.2778690861331092, "vf_explained_var": -0.015258350069560701, "kl": 0.0006370903426029275, "entropy": 0.8044233867100307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 60795.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1654060881437054, "cur_kl_coeff": 1.8735013540549515e-17, "cur_lr": 0.0001, "total_loss": 0.740384167432785, "policy_loss": -0.00027793812683768687, "vf_loss": 0.7406621054524467, "vf_explained_var": 0.0021037407337673127, "kl": 0.0004938799210429402, "entropy": 0.04584730426588702, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 60795.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000}, "env_runners": {"episode_reward_max": 84.41618727859709, "episode_reward_min": -199.2801058423448, "episode_reward_mean": 41.840583716932144, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -244.34258096673761, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 39.80000000000024, "predator_policy": 258.7570661526145}, "policy_reward_mean": {"prey_policy": 0.39905389367545235, "predator_policy": 20.52123796479046}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.60000000000028, 41.900000000000325, 42.10000000000033, 39.20000000000029, 38.300000000000274, 39.60000000000029, 56.10000000000051, 38.10000000000027, 41.900000000000325, 37.90000000000027, 44.600000000000385, 29.328581310170847, 38.575938155832766, 52.000000000000504, 50.10000000000047, 46.29739191821913, 52.50000000000051, 59.600000000000534, 39.587377474345615, 37.00000000000025, 47.200000000000415, 45.194496548029434, 50.20000000000046, -199.2801058423448, 45.100000000000385, 41.900000000000325, 50.10000000000047, 37.40000000000026, 34.477141514250555, 39.80996272120294, 46.500000000000405, 48.00000000000044, 39.40000000000029, 39.20000000000029, 56.900000000000496, 50.10000000000047, 51.70000000000049, 39.40000000000029, 40.0000000000003, 36.96869333164552, 50.40000000000048, 36.70000000000025, 39.50000000000029, 38.80000000000028, 39.30000000000029, 59.10000000000049, 9.758123339458729, 54.30000000000052, 26.700000000000095, 52.60000000000049, 38.90000000000028, 39.30000000000029, 40.30000000000033, 39.700000000000294, 34.200000000000216, 49.700000000000465, 43.95986219496591, 55.63615204432068, 50.80000000000048, 50.90000000000048, 38.80000000000028, 38.50000000000028, 54.2000000000005, 42.80000000000034, 38.300000000000274, 36.80000000000025, 46.929327717045, 32.100000000000186, 40.10000000000031, 46.2000000000004, 39.000000000000284, 39.60000000000029, 58.7000000000005, 46.400000000000404, 44.18472355799651, 56.900000000000496, 56.80000000000054, 38.60000000000028, 48.60000000000044, 41.83318061388653, 84.41618727859709, 49.60000000000046, 27.30000000000012, 44.60000000000037, 51.70000000000049, 39.30000000000029, 31.039312965379068, 37.28289290119891, 41.100000000000314, 49.30000000000045, 39.800000000000296, 55.00000000000051, 42.80000000000034, 37.10000000000026, 52.30000000000051, 53.60833317412329, 37.30000000000026, 58.650798774861435, 56.800000000000516, 55.60000000000051], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.021393323632301, -9.504257545664453, 16.700084869376933, 6.506652900721466, 4.478836719031834, 12.67184659225075, 20.000000000000014, -0.3612613093342002, 8.351268233286007, 11.597141873317026, 16.170279650198975, 18.99346795933108, 13.615562042522448, 30.800000000000196, -17.974148574555578, -2.3702570837748396, -10.330280661410542, 15.051084390355825, 20.000000000000014, -25.346373161439068, 20.000000000000014, -81.43161342882692, -6.0695677650656705, 6.627395489824135, 17.878075647877967, 7.9292878538274145, 30.408748177655504, 9.956128592448717, 13.285961126167768, 25.603456447150798, 5.901814593925376, 21.409467723724983, 31.388886586783826, 20.000000000000014, 29.71913070400752, 27.849875633585988, 16.61871359270142, 15.828132128795097, -57.710350154142624, 6.45111651948497, 16.09812097942519, 20.000000000000014, -29.045195127997616, 12.497905779467256, 15.33170815110824, -27.95800052426295, -244.34258096673761, -214.6977761422931, -10.58320358190233, 1.427846196994696, -15.911406937286324, 1.6446930404304043, 8.270391487053082, -3.9605892008375334, -1.319863003555, -2.516514434489109, -12.956978786252451, -17.26584100810314, 8.78079160765011, 9.062065747801057, 12.83293692253545, 12.389387562624782, -4.859078767905768, 14.845246148404783, 4.856774103327137, 20.000000000000014, 8.319511612127432, 20.000000000000014, 5.53539041369193, 31.20898248663465, 13.816812989056167, 21.82823452130336, 23.6758220540695, -4.566159634309605, -12.099202026954874, 17.08187754244381, -6.103016685176156, -0.22468903751694388, -0.8697053776388766, 3.564351090484539, 15.092401759973528, 17.393227907441524, -20.22736587459888, 18.808160876002027, 11.835781937507516, 20.000000000000014, 13.090249727779351, 2.4147091602411344, 20.000000000000014, 10.229095629032866, -0.8423259426421057, 39.80000000000024, -90.88639610704634, -28.762041986165983, 34.40000000000026, 18.77399001813296, -120.6669365498532, -17.256492299960676, 9.606735211925397, 11.31555479276372, 7.176423333082964, 19.112100210242488, 4.634555849906006, 18.969294291905708, -204.59294287558512, 16.169024818221075, 14.458542056958109, 20.000000000000014, -22.604179786048036, -18.784846550627933, 24.76615332980809, -0.3875186076733609, -0.2101840333311866, 14.501532568057762, 4.632276534358743, 20.33346557882543, -21.822872134519166, 33.50000000000024, 31.700000000000212, -8.451335525100816, 7.792572507755464, 13.457458649030247, -9.018986559122926, 15.561787105370275, 34.40000000000025, 17.737459392554364, -7.4111812653670555, 18.010588062684185, 3.312555688048445, 7.77962632048585, 16.143403299735432, -24.23512765550798, 21.80000000000004, -47.500861972851304, -134.60083787888297, 4.274247367234844, 20.000000000000014, 0.4092299108889329, 13.138757770311281, 14.15776452622667, 15.240823619313655, 5.276783276340671, 15.68891032084044, 4.768874815969669, 21.54442428950578, 35.05853028483561, 23.224040737875438, 14.26066283196856, 14.725325359271872, -2.6974641932389014, 31.302840661505407, 14.243842066437573, 27.9823288590586, 25.36236214445522, 18.06268433353615, 6.327117563645942, 18.58896661613421, 25.56917836014999, 17.669221261244374, 5.747420249780877, -64.44354370574419, 20.000000000000014, 30.800000000000196, -4.488130675610076, 11.746486267396975, -145.61271730690882, 16.646117651402655, -3.972661259761343, 13.726792916349696, 0.17151792794760082, 13.597474138873984, 15.882093236813601, -15.974949811325823, -215.65183281701474, 18.981904614961838, -109.12345283187248, 11.43370734579254, 8.016296757314175, 14.132310402836634, 27.722222214676684, 17.67499981487494, 20.000000000000014, -13.378573476324133, 33.406800974938136, 13.435519357986507, 16.68832264763061, -9.294104481853516, 5.466191487889132, 16.79170898448241, 32.60000000000023, 22.095404278636728, 13.748213527256214, 16.97327590976269, -98.00033411709971, 18.194058899575367, 4.043237786905069, 9.590881025306478, 28.903865617169014, 13.802591638103925, 33.601168866294756], "policy_predator_policy_reward": [4.578606676367663, 28.504257545664608, 6.399915130623038, 12.2933470992785, 14.521163280968132, 10.428153407749216, 0.0, 19.56126130933421, 10.74873176671396, 7.602858126682939, 3.529720349800989, 0.9065320406689199, 5.215073583262061, 6.469364374215457, 36.57414857455584, 21.87025708377488, 2.3437096609345147, 34.83548661012033, 33.62543320822566, 9.620939953213679, 85.13953239083469, 20.89208103799147, 4.842674482594026, 23.928079102818273, 1.6978625079545029, 11.070712146172552, 1.9912518223446858, 9.643871407551247, 6.314038873832196, 4.896543552849308, 0.9077427836643036, 18.07836681690407, 1.1111134132163836, 0.0, 0.9808692959926586, 1.0501243664141562, 7.140531752848741, 0.0, 9.292168903581242, 78.9670647310765, 1.0700919533655715, 10.031787067209201, 15.195254416842694, 46.54653147971693, 47.42845871976306, 15.397833653391796, 254.14908432713278, 5.6111669395532005, 34.68320358190249, 19.572153803005286, 34.311406937286584, 21.855306959569567, 22.629608512946888, 23.16058920083759, 24.002263558058267, 17.23411387998589, 16.765789184162898, 47.9341721244435, 5.424575918281918, 16.542529447469498, 0.0, 21.277675514839707, 3.415138408263448, 34.59869421123755, 14.543225896672828, 0.0, 10.880488387872534, 0.0, 13.864609586308035, 6.29101751336556, 12.7831870109438, 1.6717654786966796, 9.924177945930575, 22.666159634309658, 31.699202026955067, 2.7181224575561673, 25.10301668517625, 21.22468903751695, 16.678897525265246, 17.59515009353433, 4.507598240026436, 13.406772092558455, 37.02736587459912, 1.091839123997972, 7.664218062492449, 0.0, 6.5097502722206135, 16.785290839758837, 0.0, 9.0709043709671, 20.142325942642124, 0.0, 5.041773127040036, 124.36478830563048, 0.0, 1.12600998186704, 55.8596035304753, 108.7638253193386, 0.0, 31.67770999531082, 11.823576666917003, 0.7878997897575161, 14.765444150093959, 0.9307057080942938, 4.270059437812909, 224.4538586195508, 5.241457943041855, 0.0, 38.804179786048266, 36.78484655062819, 6.4338466701920005, 18.88751860767336, 16.741564497555736, 12.926949162683199, 16.338135748851435, 14.332274182284559, 39.12287213451941, 0.0, 0.0, 27.651335525100954, 11.6074274922445, 5.942541350969718, 27.91898655912307, 4.038212894629689, 0.0, 2.062540607445622, 26.21118126536717, 5.989411937315804, 15.887444311951517, 11.320373679514116, 3.5565967002645333, 41.33512765550822, 35.63866703764892, 36.99152265224712, 15.000650062370532, 147.42594044927685, 17.323322846509242, 2.3674472426017825, 8.061242229688684, 10.842235473773297, 4.359176380686309, 14.123216723659294, 3.911089679159523, 15.231125184030297, 1.0555757104942574, 1.0414697151646373, 3.6759592621246258, 5.239337168031405, 23.319091741072143, 8.837770650891024, 6.097159338494805, 5.256157933562393, 0.9176711409415451, 2.53763785554488, 1.7373156664638394, 12.472882436354025, 1.3110333838657855, 3.1308216398501134, 5.0538349086467464, 13.362704194214164, 55.68959380329336, 73.17013718104798, 0.0, 23.288130675610137, 158.96239068729255, 2.2038403522189918, 28.292942346823036, 3.6336012615356608, 8.853037954306625, 28.948651201396007, 6.00252586112598, 3.817906763186362, 258.7570661526145, 3.90902944110477, 112.45577201784738, 14.968669100261257, 10.566292654207427, 11.083703242685791, 5.46768959716333, 1.9777777853234597, 2.1250001851250433, 0.0, 32.378573476324355, 2.593199025062107, 9.664480642013459, 3.011677352369362, 26.994104481853647, 13.933808512110833, 2.9082910155175634, 0.0, 5.060170440172777, 12.704544928057079, 5.326724090237283, 113.00033411709886, 14.352131288853803, 22.061370799526642, 17.40911897469349, 0.89613438283115, 5.797408361896039, 2.3988311337054884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.769502041161089, "mean_inference_ms": 3.70164112316757, "mean_action_processing_ms": 1.8691827005046087, "mean_env_wait_ms": 1.1285009478859518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032385587692260742, "StateBufferConnector_ms": 0.012261629104614258, "ViewRequirementAgentConnector_ms": 0.09628832340240479}, "num_episodes": 8, "episode_return_max": 84.41618727859709, "episode_return_min": -199.2801058423448, "episode_return_mean": 41.840583716932144, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 252.96069096204437, "num_env_steps_trained_throughput_per_sec": 252.96069096204437, "timesteps_total": 776000, "num_env_steps_sampled_lifetime": 776000, "num_agent_steps_sampled_lifetime": 3104000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 3104000, "timers": {"training_iteration_time_ms": 32996.383, "restore_workers_time_ms": 0.018, "training_step_time_ms": 32996.268, "sample_time_ms": 1310.036, "learn_time_ms": 31664.665, "learn_throughput": 252.648, "synch_weights_time_ms": 18.053}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000}, "done": false, "training_iteration": 97, "trial_id": "cd905_00000", "date": "2024-08-20_10-16-56", "timestamp": 1724129216, "time_this_iter_s": 31.63022208213806, "time_total_s": 3171.9768109321594, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a1c6b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3171.9768109321594, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 28.177777777777777, "ram_util_percent": 71.89555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6477747112039536, "cur_kl_coeff": 3.9290171116590496e-11, "cur_lr": 0.0001, "total_loss": 1.5457140394619533, "policy_loss": -0.0018350163326850014, "vf_loss": 1.5475490573852781, "vf_explained_var": -0.017434112703989424, "kl": 0.009817383710460202, "entropy": 0.8992882332158467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.28744515084203276, "cur_kl_coeff": 9.367506770274757e-18, "cur_lr": 0.0001, "total_loss": 0.9911808994081285, "policy_loss": 8.406483509119541e-05, "vf_loss": 0.9910968344836008, "vf_explained_var": 0.00346734675150069, "kl": 0.0003622463403294108, "entropy": 0.03271497007282007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000}, "env_runners": {"episode_reward_max": 84.41618727859709, "episode_reward_min": -344.64093777098145, "episode_reward_mean": 22.355945798693682, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -481.26197251171243, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 35.831451540570235, "predator_policy": 541.6921828267971}, "policy_reward_mean": {"prey_policy": -24.004854590384767, "predator_policy": 35.182827489731444}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.300000000000274, 36.80000000000025, 46.929327717045, 32.100000000000186, 40.10000000000031, 46.2000000000004, 39.000000000000284, 39.60000000000029, 58.7000000000005, 46.400000000000404, 44.18472355799651, 56.900000000000496, 56.80000000000054, 38.60000000000028, 48.60000000000044, 41.83318061388653, 84.41618727859709, 49.60000000000046, 27.30000000000012, 44.60000000000037, 51.70000000000049, 39.30000000000029, 31.039312965379068, 37.28289290119891, 41.100000000000314, 49.30000000000045, 39.800000000000296, 55.00000000000051, 42.80000000000034, 37.10000000000026, 52.30000000000051, 53.60833317412329, 37.30000000000026, 58.650798774861435, 56.800000000000516, 55.60000000000051, 49.40000000000046, 36.40000000000025, 56.700000000000514, 42.600000000000335, 39.20000000000029, 39.20000000000029, 32.961803078886746, 38.20000000000027, 51.919093232403746, 35.63435930441009, 40.400000000000304, 38.50000000000028, 46.400000000000404, 39.000000000000284, 30.69930827606385, 37.500000000000256, 38.400000000000276, 37.000000000000256, 35.08426847120474, 36.02381716482476, 37.90000000000027, -2.16210956540245, -301.41409665122, 45.37822989430144, 41.534113646884144, 54.739106520097465, -177.63306722833806, 52.80000000000051, 41.607314611157236, 36.00000000000024, 39.20000000000029, 49.7634392430833, 58.2000000000005, 40.0000000000003, 40.80000000000031, 39.50000000000029, 39.30000000000029, 39.505101268274, 39.800000000000296, 58.100000000000506, 81.18875489565723, 48.30000000000044, 39.50000000000029, 36.000000000000234, -344.64093777098145, 33.48820231172836, 18.474296743346212, 37.600000000000264, 39.700000000000294, 43.50000000000035, 41.70000000000032, -302.87076599147196, 51.9000000000005, 34.00000000000021, 32.85242669327575, 31.000000000000153, -276.9397569384802, -197.058205076776, 36.80000000000025, 29.105115664255756, 43.37571586281275, 35.70000000000024, 39.20000000000029, -126.06570477373896], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3.312555688048445, 7.77962632048585, 16.143403299735432, -24.23512765550798, 21.80000000000004, -47.500861972851304, -134.60083787888297, 4.274247367234844, 20.000000000000014, 0.4092299108889329, 13.138757770311281, 14.15776452622667, 15.240823619313655, 5.276783276340671, 15.68891032084044, 4.768874815969669, 21.54442428950578, 35.05853028483561, 23.224040737875438, 14.26066283196856, 14.725325359271872, -2.6974641932389014, 31.302840661505407, 14.243842066437573, 27.9823288590586, 25.36236214445522, 18.06268433353615, 6.327117563645942, 18.58896661613421, 25.56917836014999, 17.669221261244374, 5.747420249780877, -64.44354370574419, 20.000000000000014, 30.800000000000196, -4.488130675610076, 11.746486267396975, -145.61271730690882, 16.646117651402655, -3.972661259761343, 13.726792916349696, 0.17151792794760082, 13.597474138873984, 15.882093236813601, -15.974949811325823, -215.65183281701474, 18.981904614961838, -109.12345283187248, 11.43370734579254, 8.016296757314175, 14.132310402836634, 27.722222214676684, 17.67499981487494, 20.000000000000014, -13.378573476324133, 33.406800974938136, 13.435519357986507, 16.68832264763061, -9.294104481853516, 5.466191487889132, 16.79170898448241, 32.60000000000023, 22.095404278636728, 13.748213527256214, 16.97327590976269, -98.00033411709971, 18.194058899575367, 4.043237786905069, 9.590881025306478, 28.903865617169014, 13.802591638103925, 33.601168866294756, 13.860077638114646, 17.888638410260004, -37.90021935187966, 9.658567523865923, 34.64404292740753, 16.905336391487957, 13.502069461880223, 15.243614201454871, 11.104743852428363, 15.653578455842023, 14.441671770768375, 16.83096107382122, 9.176819389656405, -1.8583398684264063, 10.463661377878704, 0.16611211747255408, -31.92349816728784, 19.598056872788668, 10.516126083206906, 7.191271519258862, 5.544801369936511, 9.858939342252535, 7.065988150772695, 9.581295166909547, -13.848022408720443, 23.60775489735196, 14.26613300817611, 13.812368086446513, -50.64706077555429, -1.576569403940812, 7.443831238137006, -23.048503606640992, 1.5937247946130293, 11.870218618971998, -7.073504392814634, -18.270638249924062, 10.335430386180805, -17.93534106958765, -5.699808448770387, 4.725997476608509, 6.850101475782529, 5.916557338923694, -65.06305452386827, -27.991335120397203, -309.9959271541311, -392.86352498736517, 19.19574776239125, 13.092474830568417, -5.377032339879358, 14.174279150264042, 27.20000000000013, 1.0680808038316283, -303.9563018638937, -216.64405305711384, 14.184026238171327, 30.278594847103932, 16.86921349034515, 18.92921179701483, -31.232438402920423, -18.09832670078076, 18.875990542976805, 5.358516139084893, -7.448103086157989, 23.6634392430829, 14.543149930501563, 35.831451540570235, -14.082280291886953, -0.017560646365557236, -7.268754991739847, 5.196598145101209, 14.905843799473885, 18.877280907599022, 20.000000000000014, 6.638306559644116, 16.28943251084087, 18.977019821028712, 20.000000000000014, 17.57320641791387, 14.140406803395189, 16.75165848136735, 27.8242701060398, 5.00884978277962, 9.5097972390395, 27.94571046726208, 7.764174781835214, 8.117543239707299, -142.5949508070256, 20.000000000000014, -356.95233622747986, -383.8294637860464, -64.35177825242309, -2.1515948485634273, -95.64660956946274, -156.27315541111773, -47.48186187597943, 15.475806052794274, 18.91445883015618, 18.05660719147427, 19.28102741635883, 13.631909638579936, -13.768109134468558, 13.870178418993106, -375.0083678772097, -317.0310319204767, 15.88860447626437, 29.80707571346373, -68.19570593353038, -55.91736425260776, -6.644020023481314, -114.3564064288401, -73.81338347609727, -15.060885840461939, -318.80071178475237, -368.8254374462873, -481.26197251171243, -263.3389442629149, -28.87767128627506, -3.115019497651056, -44.334479839795534, -59.00918357917746, -28.31544755596032, 13.715236260167233, -81.45387352609632, 15.961995496112682, 10.75351438496511, 17.216618966818437, -254.52553629027645, -143.44970920645883], "policy_predator_policy_reward": [15.887444311951517, 11.320373679514116, 3.5565967002645333, 41.33512765550822, 35.63866703764892, 36.99152265224712, 15.000650062370532, 147.42594044927685, 17.323322846509242, 2.3674472426017825, 8.061242229688684, 10.842235473773297, 4.359176380686309, 14.123216723659294, 3.911089679159523, 15.231125184030297, 1.0555757104942574, 1.0414697151646373, 3.6759592621246258, 5.239337168031405, 23.319091741072143, 8.837770650891024, 6.097159338494805, 5.256157933562393, 0.9176711409415451, 2.53763785554488, 1.7373156664638394, 12.472882436354025, 1.3110333838657855, 3.1308216398501134, 5.0538349086467464, 13.362704194214164, 55.68959380329336, 73.17013718104798, 0.0, 23.288130675610137, 158.96239068729255, 2.2038403522189918, 28.292942346823036, 3.6336012615356608, 8.853037954306625, 28.948651201396007, 6.00252586112598, 3.817906763186362, 258.7570661526145, 3.90902944110477, 112.45577201784738, 14.968669100261257, 10.566292654207427, 11.083703242685791, 5.46768959716333, 1.9777777853234597, 2.1250001851250433, 0.0, 32.378573476324355, 2.593199025062107, 9.664480642013459, 3.011677352369362, 26.994104481853647, 13.933808512110833, 2.9082910155175634, 0.0, 5.060170440172777, 12.704544928057079, 5.326724090237283, 113.00033411709886, 14.352131288853803, 22.061370799526642, 17.40911897469349, 0.89613438283115, 5.797408361896039, 2.3988311337054884, 5.739922361885318, 11.911361589739982, 55.20021935187991, 9.441432476134043, 2.255957072592722, 2.8946636085120194, 9.497930538119743, 4.356385798545094, 8.395256147571601, 4.0464215441579405, 5.0583282292315905, 2.8690389261787534, 24.729805529777742, 0.9135180278788009, 8.836338622121263, 18.733887882527444, 29.43830709565942, 34.80622743124327, 14.557200130965445, 3.3697615709785693, 13.155198630063456, 11.841060657747432, 12.13401184922727, 9.718704833090419, 26.62010407445309, 10.020163436915686, 5.233866991823855, 5.687631913553451, 22.317623166816684, 60.605315288742176, 42.323649292714244, 10.781023075789886, 17.30627520538695, 7.629781381027966, 26.273504392814747, 36.070638249924315, 32.417492774039516, 10.266686380572054, 4.20421115591843, 32.79341698106801, 12.149898524217443, 12.983442661076273, 23.74569569015195, 67.14658438871012, 8.224213931892898, 393.22114155838324, 7.037646058391958, 6.052361242949406, 26.98924987867975, 5.747616957819432, 12.689607721398787, 13.78141799486652, 339.94577570096084, 3.0215119917083024, 8.337378914724894, 0.0, 2.8781028141420864, 2.9307865096548245, 48.63243840292067, 36.698326700781024, 1.0240094570231946, 13.941483860915072, 33.54810308615809, 0.0, 5.056850069498401, 2.7685484594300127, 32.68228029188718, 21.41756064636555, 26.16875499173996, 16.703401854898758, 4.69415620052608, 1.0227190924009792, 0.0, 12.66169344035585, 3.4105674891590936, 0.8280814472449906, 0.0, 2.226793582086112, 15.459593196604779, 11.748341518632621, 21.387996063339983, 26.967638943498667, 9.890202760960465, 0.9542895327380643, 12.335825218164752, 11.282456760292666, 158.5949508070247, 0.0, 373.2533380645943, 22.887524177950326, 5.4269093582128445, 94.56466605450093, 176.9351745793295, 93.45888714459552, 65.3818618759796, 4.2241939472056895, 0.9855411698438251, 1.7433928085257202, 4.718972583641174, 5.8680903614200295, 32.668109134468786, 8.92982158100686, 380.5101741537224, 8.658459652492015, 5.312961035265749, 0.8913587750063, 150.69033890586707, 7.422731280269841, 153.85285314559619, 0.0, 5.523742564375382, 114.35052675218358, 2.299348967943945, 408.3870433246158, 541.6921828267971, 5.850528871055488, 46.777671286275314, 22.0150194976511, 121.56701164790972, 10.881767435318691, 24.636501829122064, 33.33942532948367, 97.4538735260954, 3.7380045038872804, 7.077221635849094, 4.152645012367304, 271.90954072299667, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.766506348129436, "mean_inference_ms": 3.6949504760742333, "mean_action_processing_ms": 1.870040149909545, "mean_env_wait_ms": 1.1301102075080447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003033161163330078, "StateBufferConnector_ms": 0.010973453521728516, "ViewRequirementAgentConnector_ms": 0.09061014652252197}, "num_episodes": 64, "episode_return_max": 84.41618727859709, "episode_return_min": -344.64093777098145, "episode_return_mean": 22.355945798693682, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 227.5903509987584, "num_env_steps_trained_throughput_per_sec": 227.5903509987584, "timesteps_total": 784000, "num_env_steps_sampled_lifetime": 784000, "num_agent_steps_sampled_lifetime": 3136000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 3136000, "timers": {"training_iteration_time_ms": 33422.426, "restore_workers_time_ms": 0.018, "training_step_time_ms": 33422.259, "sample_time_ms": 1323.688, "learn_time_ms": 32075.491, "learn_throughput": 249.412, "synch_weights_time_ms": 19.152}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000}, "done": false, "training_iteration": 98, "trial_id": "cd905_00000", "date": "2024-08-20_10-17-31", "timestamp": 1724129251, "time_this_iter_s": 35.18760395050049, "time_total_s": 3207.16441488266, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a167670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3207.16441488266, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 89.71000000000002, "ram_util_percent": 77.44200000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9495709343207261, "cur_kl_coeff": 3.9290171116590496e-11, "cur_lr": 0.0001, "total_loss": 0.7355201247843012, "policy_loss": -0.001685543107755837, "vf_loss": 0.737205668692551, "vf_explained_var": -0.021395616304306756, "kl": 0.013907568157722539, "entropy": 0.811502893860378, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 62055.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.22278593364984745, "cur_kl_coeff": 4.683753385137379e-18, "cur_lr": 0.0001, "total_loss": 0.4545157644247252, "policy_loss": -0.0004135231457887188, "vf_loss": 0.45492928724676845, "vf_explained_var": 0.003379673238784548, "kl": 0.00015922536658970944, "entropy": 0.02668240423949938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 62055.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000}, "env_runners": {"episode_reward_max": 84.41618727859709, "episode_reward_min": -344.64093777098145, "episode_reward_mean": 22.341297069962923, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -481.26197251171243, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 35.831451540570235, "predator_policy": 541.6921828267971}, "policy_reward_mean": {"prey_policy": -23.367655914711985, "predator_policy": 34.538304449693285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.7000000000005, 46.400000000000404, 44.18472355799651, 56.900000000000496, 56.80000000000054, 38.60000000000028, 48.60000000000044, 41.83318061388653, 84.41618727859709, 49.60000000000046, 27.30000000000012, 44.60000000000037, 51.70000000000049, 39.30000000000029, 31.039312965379068, 37.28289290119891, 41.100000000000314, 49.30000000000045, 39.800000000000296, 55.00000000000051, 42.80000000000034, 37.10000000000026, 52.30000000000051, 53.60833317412329, 37.30000000000026, 58.650798774861435, 56.800000000000516, 55.60000000000051, 49.40000000000046, 36.40000000000025, 56.700000000000514, 42.600000000000335, 39.20000000000029, 39.20000000000029, 32.961803078886746, 38.20000000000027, 51.919093232403746, 35.63435930441009, 40.400000000000304, 38.50000000000028, 46.400000000000404, 39.000000000000284, 30.69930827606385, 37.500000000000256, 38.400000000000276, 37.000000000000256, 35.08426847120474, 36.02381716482476, 37.90000000000027, -2.16210956540245, -301.41409665122, 45.37822989430144, 41.534113646884144, 54.739106520097465, -177.63306722833806, 52.80000000000051, 41.607314611157236, 36.00000000000024, 39.20000000000029, 49.7634392430833, 58.2000000000005, 40.0000000000003, 40.80000000000031, 39.50000000000029, 39.30000000000029, 39.505101268274, 39.800000000000296, 58.100000000000506, 81.18875489565723, 48.30000000000044, 39.50000000000029, 36.000000000000234, -344.64093777098145, 33.48820231172836, 18.474296743346212, 37.600000000000264, 39.700000000000294, 43.50000000000035, 41.70000000000032, -302.87076599147196, 51.9000000000005, 34.00000000000021, 32.85242669327575, 31.000000000000153, -276.9397569384802, -197.058205076776, 36.80000000000025, 29.105115664255756, 43.37571586281275, 35.70000000000024, 39.20000000000029, -126.06570477373896, 38.16779185656009, 40.35093236405789, -7.7709378352181115, 53.10000000000052, 46.80000000000041, 37.016668458569065, 53.00000000000052, 56.900000000000496], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [21.54442428950578, 35.05853028483561, 23.224040737875438, 14.26066283196856, 14.725325359271872, -2.6974641932389014, 31.302840661505407, 14.243842066437573, 27.9823288590586, 25.36236214445522, 18.06268433353615, 6.327117563645942, 18.58896661613421, 25.56917836014999, 17.669221261244374, 5.747420249780877, -64.44354370574419, 20.000000000000014, 30.800000000000196, -4.488130675610076, 11.746486267396975, -145.61271730690882, 16.646117651402655, -3.972661259761343, 13.726792916349696, 0.17151792794760082, 13.597474138873984, 15.882093236813601, -15.974949811325823, -215.65183281701474, 18.981904614961838, -109.12345283187248, 11.43370734579254, 8.016296757314175, 14.132310402836634, 27.722222214676684, 17.67499981487494, 20.000000000000014, -13.378573476324133, 33.406800974938136, 13.435519357986507, 16.68832264763061, -9.294104481853516, 5.466191487889132, 16.79170898448241, 32.60000000000023, 22.095404278636728, 13.748213527256214, 16.97327590976269, -98.00033411709971, 18.194058899575367, 4.043237786905069, 9.590881025306478, 28.903865617169014, 13.802591638103925, 33.601168866294756, 13.860077638114646, 17.888638410260004, -37.90021935187966, 9.658567523865923, 34.64404292740753, 16.905336391487957, 13.502069461880223, 15.243614201454871, 11.104743852428363, 15.653578455842023, 14.441671770768375, 16.83096107382122, 9.176819389656405, -1.8583398684264063, 10.463661377878704, 0.16611211747255408, -31.92349816728784, 19.598056872788668, 10.516126083206906, 7.191271519258862, 5.544801369936511, 9.858939342252535, 7.065988150772695, 9.581295166909547, -13.848022408720443, 23.60775489735196, 14.26613300817611, 13.812368086446513, -50.64706077555429, -1.576569403940812, 7.443831238137006, -23.048503606640992, 1.5937247946130293, 11.870218618971998, -7.073504392814634, -18.270638249924062, 10.335430386180805, -17.93534106958765, -5.699808448770387, 4.725997476608509, 6.850101475782529, 5.916557338923694, -65.06305452386827, -27.991335120397203, -309.9959271541311, -392.86352498736517, 19.19574776239125, 13.092474830568417, -5.377032339879358, 14.174279150264042, 27.20000000000013, 1.0680808038316283, -303.9563018638937, -216.64405305711384, 14.184026238171327, 30.278594847103932, 16.86921349034515, 18.92921179701483, -31.232438402920423, -18.09832670078076, 18.875990542976805, 5.358516139084893, -7.448103086157989, 23.6634392430829, 14.543149930501563, 35.831451540570235, -14.082280291886953, -0.017560646365557236, -7.268754991739847, 5.196598145101209, 14.905843799473885, 18.877280907599022, 20.000000000000014, 6.638306559644116, 16.28943251084087, 18.977019821028712, 20.000000000000014, 17.57320641791387, 14.140406803395189, 16.75165848136735, 27.8242701060398, 5.00884978277962, 9.5097972390395, 27.94571046726208, 7.764174781835214, 8.117543239707299, -142.5949508070256, 20.000000000000014, -356.95233622747986, -383.8294637860464, -64.35177825242309, -2.1515948485634273, -95.64660956946274, -156.27315541111773, -47.48186187597943, 15.475806052794274, 18.91445883015618, 18.05660719147427, 19.28102741635883, 13.631909638579936, -13.768109134468558, 13.870178418993106, -375.0083678772097, -317.0310319204767, 15.88860447626437, 29.80707571346373, -68.19570593353038, -55.91736425260776, -6.644020023481314, -114.3564064288401, -73.81338347609727, -15.060885840461939, -318.80071178475237, -368.8254374462873, -481.26197251171243, -263.3389442629149, -28.87767128627506, -3.115019497651056, -44.334479839795534, -59.00918357917746, -28.31544755596032, 13.715236260167233, -81.45387352609632, 15.961995496112682, 10.75351438496511, 17.216618966818437, -254.52553629027645, -143.44970920645883, 20.000000000000014, -23.51073379021736, 16.98260832352053, 12.598535352315281, -77.32030921716324, -54.591845316255394, 22.700000000000053, 24.941105490112896, 21.838106236253946, 10.382673078703077, -0.08289795717857978, 7.847138940200567, 12.806745694347297, 33.50000000000024, 8.802369038523715, 26.2003886695462], "policy_predator_policy_reward": [1.0555757104942574, 1.0414697151646373, 3.6759592621246258, 5.239337168031405, 23.319091741072143, 8.837770650891024, 6.097159338494805, 5.256157933562393, 0.9176711409415451, 2.53763785554488, 1.7373156664638394, 12.472882436354025, 1.3110333838657855, 3.1308216398501134, 5.0538349086467464, 13.362704194214164, 55.68959380329336, 73.17013718104798, 0.0, 23.288130675610137, 158.96239068729255, 2.2038403522189918, 28.292942346823036, 3.6336012615356608, 8.853037954306625, 28.948651201396007, 6.00252586112598, 3.817906763186362, 258.7570661526145, 3.90902944110477, 112.45577201784738, 14.968669100261257, 10.566292654207427, 11.083703242685791, 5.46768959716333, 1.9777777853234597, 2.1250001851250433, 0.0, 32.378573476324355, 2.593199025062107, 9.664480642013459, 3.011677352369362, 26.994104481853647, 13.933808512110833, 2.9082910155175634, 0.0, 5.060170440172777, 12.704544928057079, 5.326724090237283, 113.00033411709886, 14.352131288853803, 22.061370799526642, 17.40911897469349, 0.89613438283115, 5.797408361896039, 2.3988311337054884, 5.739922361885318, 11.911361589739982, 55.20021935187991, 9.441432476134043, 2.255957072592722, 2.8946636085120194, 9.497930538119743, 4.356385798545094, 8.395256147571601, 4.0464215441579405, 5.0583282292315905, 2.8690389261787534, 24.729805529777742, 0.9135180278788009, 8.836338622121263, 18.733887882527444, 29.43830709565942, 34.80622743124327, 14.557200130965445, 3.3697615709785693, 13.155198630063456, 11.841060657747432, 12.13401184922727, 9.718704833090419, 26.62010407445309, 10.020163436915686, 5.233866991823855, 5.687631913553451, 22.317623166816684, 60.605315288742176, 42.323649292714244, 10.781023075789886, 17.30627520538695, 7.629781381027966, 26.273504392814747, 36.070638249924315, 32.417492774039516, 10.266686380572054, 4.20421115591843, 32.79341698106801, 12.149898524217443, 12.983442661076273, 23.74569569015195, 67.14658438871012, 8.224213931892898, 393.22114155838324, 7.037646058391958, 6.052361242949406, 26.98924987867975, 5.747616957819432, 12.689607721398787, 13.78141799486652, 339.94577570096084, 3.0215119917083024, 8.337378914724894, 0.0, 2.8781028141420864, 2.9307865096548245, 48.63243840292067, 36.698326700781024, 1.0240094570231946, 13.941483860915072, 33.54810308615809, 0.0, 5.056850069498401, 2.7685484594300127, 32.68228029188718, 21.41756064636555, 26.16875499173996, 16.703401854898758, 4.69415620052608, 1.0227190924009792, 0.0, 12.66169344035585, 3.4105674891590936, 0.8280814472449906, 0.0, 2.226793582086112, 15.459593196604779, 11.748341518632621, 21.387996063339983, 26.967638943498667, 9.890202760960465, 0.9542895327380643, 12.335825218164752, 11.282456760292666, 158.5949508070247, 0.0, 373.2533380645943, 22.887524177950326, 5.4269093582128445, 94.56466605450093, 176.9351745793295, 93.45888714459552, 65.3818618759796, 4.2241939472056895, 0.9855411698438251, 1.7433928085257202, 4.718972583641174, 5.8680903614200295, 32.668109134468786, 8.92982158100686, 380.5101741537224, 8.658459652492015, 5.312961035265749, 0.8913587750063, 150.69033890586707, 7.422731280269841, 153.85285314559619, 0.0, 5.523742564375382, 114.35052675218358, 2.299348967943945, 408.3870433246158, 541.6921828267971, 5.850528871055488, 46.777671286275314, 22.0150194976511, 121.56701164790972, 10.881767435318691, 24.636501829122064, 33.33942532948367, 97.4538735260954, 3.7380045038872804, 7.077221635849094, 4.152645012367304, 271.90954072299667, 0.0, 39.038137287448905, 2.6403883593285093, 5.822212224088169, 4.947576464133549, 119.67825856239486, 4.462958135804675, 0.0, 5.458894509887197, 1.0577217796239615, 13.52149890541902, 20.832892581472173, 8.419534894074602, 6.693254305652668, 0.0, 21.897242291930173, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.759359811631839, "mean_inference_ms": 3.6967025539711518, "mean_action_processing_ms": 1.862907852766763, "mean_env_wait_ms": 1.1282158933992574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030881166458129883, "StateBufferConnector_ms": 0.011424422264099121, "ViewRequirementAgentConnector_ms": 0.09251654148101807}, "num_episodes": 8, "episode_return_max": 84.41618727859709, "episode_return_min": -344.64093777098145, "episode_return_mean": 22.341297069962923, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 242.71931540637655, "num_env_steps_trained_throughput_per_sec": 242.71931540637655, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 3168000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 3168000, "timers": {"training_iteration_time_ms": 33578.642, "restore_workers_time_ms": 0.019, "training_step_time_ms": 33578.47, "sample_time_ms": 1335.379, "learn_time_ms": 32220.329, "learn_throughput": 248.29, "synch_weights_time_ms": 18.829}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000}, "done": false, "training_iteration": 99, "trial_id": "cd905_00000", "date": "2024-08-20_10-18-04", "timestamp": 1724129284, "time_this_iter_s": 32.963797092437744, "time_total_s": 3240.1282119750977, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169edfca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3240.1282119750977, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 70.58723404255319, "ram_util_percent": 76.07659574468086}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4240857259858222, "cur_kl_coeff": 3.9290171116590496e-11, "cur_lr": 0.0001, "total_loss": 1.7268701140842742, "policy_loss": -0.0007505785769945572, "vf_loss": 1.727620686046661, "vf_explained_var": -0.015549295856839134, "kl": 0.0011663234009704735, "entropy": 0.7965807379238189, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 62685.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3180985633993433, "cur_kl_coeff": 2.3418766925686893e-18, "cur_lr": 0.0001, "total_loss": 1.169503681054191, "policy_loss": -0.00023165026472674475, "vf_loss": 1.1697353297755833, "vf_explained_var": 0.004066805234031072, "kl": 0.0001380863337864102, "entropy": 0.02501822973468474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 62685.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "env_runners": {"episode_reward_max": 74.59999999999974, "episode_reward_min": -397.9916001240914, "episode_reward_mean": 15.844571293725771, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -481.26197251171243, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 42.076466837390655, "predator_policy": 541.6921828267971}, "policy_reward_mean": {"prey_policy": -28.64504904493291, "predator_policy": 36.56733469179563}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-344.64093777098145, 33.48820231172836, 18.474296743346212, 37.600000000000264, 39.700000000000294, 43.50000000000035, 41.70000000000032, -302.87076599147196, 51.9000000000005, 34.00000000000021, 32.85242669327575, 31.000000000000153, -276.9397569384802, -197.058205076776, 36.80000000000025, 29.105115664255756, 43.37571586281275, 35.70000000000024, 39.20000000000029, -126.06570477373896, 38.16779185656009, 40.35093236405789, -7.7709378352181115, 53.10000000000052, 46.80000000000041, 37.016668458569065, 53.00000000000052, 56.900000000000496, 38.00000000000027, 37.50000000000026, -218.52757082535712, 52.500000000000504, -184.03389669941635, 45.60000000000039, 37.10000000000026, 40.900000000000325, 50.10000000000047, 38.20000000000027, 43.18581762644757, 31.13658387145642, 34.56025969280699, 74.59999999999974, 50.00000000000047, 39.9000000000003, 45.100000000000406, 38.701685605679586, 49.80000000000046, 39.60000000000029, 39.50000000000029, 48.00000000000043, 63.52828190671619, 47.700000000000436, 39.000000000000284, 35.70000000000024, 50.60000000000048, 41.800000000000324, 38.400000000000276, 50.10000000000047, 44.00000000000036, 50.90000000000049, 39.60000000000029, 35.80000000000024, 37.000000000000256, 43.10000000000035, 64.70000000000041, 37.55077718954269, -397.9916001240914, 50.80000000000049, 38.80000000000028, 42.24707240474752, 52.200000000000486, 48.50000000000044, 61.100000000000506, 41.50000000000032, 53.30000000000051, 35.500000000000234, 49.40000000000046, 31.78143245938085, 53.80000000000051, 55.60000000000053, 62.900000000000496, 5.919409279436495, 40.2000000000003, 47.70000000000042, 55.200000000000536, 53.40000000000052, 36.17386506249404, 59.0921627104778, 33.50920431240218, -126.1374734425697, 47.10000000000041, 57.10000000000047, 38.60000000000028, -115.41446930002323, 39.20000000000029, 44.70000000000037, 39.40000000000029, 55.30000000000051, 40.0000000000003, 44.69074607448269], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-356.95233622747986, -383.8294637860464, -64.35177825242309, -2.1515948485634273, -95.64660956946274, -156.27315541111773, -47.48186187597943, 15.475806052794274, 18.91445883015618, 18.05660719147427, 19.28102741635883, 13.631909638579936, -13.768109134468558, 13.870178418993106, -375.0083678772097, -317.0310319204767, 15.88860447626437, 29.80707571346373, -68.19570593353038, -55.91736425260776, -6.644020023481314, -114.3564064288401, -73.81338347609727, -15.060885840461939, -318.80071178475237, -368.8254374462873, -481.26197251171243, -263.3389442629149, -28.87767128627506, -3.115019497651056, -44.334479839795534, -59.00918357917746, -28.31544755596032, 13.715236260167233, -81.45387352609632, 15.961995496112682, 10.75351438496511, 17.216618966818437, -254.52553629027645, -143.44970920645883, 20.000000000000014, -23.51073379021736, 16.98260832352053, 12.598535352315281, -77.32030921716324, -54.591845316255394, 22.700000000000053, 24.941105490112896, 21.838106236253946, 10.382673078703077, -0.08289795717857978, 7.847138940200567, 12.806745694347297, 33.50000000000024, 8.802369038523715, 26.2003886695462, 8.199960995522126, -32.948032823521245, -9.609590096646048, 10.642247363606884, -236.60845953281483, -254.81719674818473, 22.356487300166275, 13.721008216070976, -235.04407195661787, -205.23550781042456, -13.879739060883796, 11.783316480929578, -3.748218824526529, -11.211532426205707, -26.193981135373328, -97.0017755479529, -0.5390796783651385, 4.8301145088675295, -1.5638853577421385, 9.572642354356617, 11.768325041567621, 20.000000000000014, 6.929530201331886, 4.9716577474655015, 7.6637347260124535, 6.617704721230952, 33.19902666600232, 36.20000000000025, 23.973522048636855, -9.01378423322561, 18.999925890742013, 20.000000000000014, -71.06272998037373, 20.000000000000014, 0.3231788358069853, 14.703164123724607, 22.24861640123382, 26.300000000000114, 20.000000000000014, 15.454555103867873, 13.436455605945769, 20.000000000000014, -24.048352130090997, 28.06690999447438, -70.35860723662451, 13.515297301852407, 2.527941873206084, -14.032860970388164, 1.553426669371296, 18.851767249126677, -57.93310433429607, 3.9891410949736374, -1.7550297771192924, 15.223119973015852, 22.700000000000053, 6.2763631505337845, -10.665017008730455, -6.698804931873092, 26.759391512153467, 1.7711369215480406, 18.85685997371425, 6.62629248427908, 33.50000000000024, -14.182813695069365, 20.000000000000014, 10.281596180705032, -60.44654438036366, 12.970734164176156, -29.9226005419601, 17.72942144058908, 12.609685556354156, -8.936247697921543, 17.886091692810115, 42.076466837390655, 1.9365645580536606, 4.82917324075666, -421.3529530467617, -461.9997573363299, 13.239510268058297, 18.72491598026592, 19.150396071079452, -8.494032298069008, -1.3490588756863287, 13.34626279436844, 21.80000000000004, 14.036255785472246, 18.445596761155592, 18.674145966395866, 41.60000000000025, 14.203481161750528, 15.282113505285496, 21.80000000000004, -15.910683113094494, 29.046534678291188, -6.859478880322648, -76.90183874807616, 18.166571112588183, 10.09312604628827, 1.4513861219611919, 0.9687106629613271, 17.02006930921483, 28.75931938115123, 8.117353982772698, 33.50000000000024, 19.696656379917723, 11.366565337745998, -102.11973823879472, -99.9767184808653, -6.9873318516879, -20.495397054751912, 18.916111968778793, 24.50000000000008, 27.931107067506726, 26.300000000000114, 35.30000000000026, -4.479072678108668, 16.741927639759645, -21.10827741887296, 14.331845869755622, 17.26597362069619, -13.415004282783205, 14.70920431240194, -257.16795659102763, -139.55998768074483, 27.20000000000013, 18.883211619364776, 26.057402587644496, 15.483220441251373, -9.291925603361868, 15.837720891858629, -146.18340880646446, -131.87113387551292, 17.82825586735519, 11.457170182525424, 20.000000000000014, 14.692056437804391, 16.552010379252, 15.800072723077351, 20.000000000000014, 35.30000000000025, 20.000000000000014, 8.3719313279803, 1.4231615283816936, 26.29074607448243], "policy_predator_policy_reward": [373.2533380645943, 22.887524177950326, 5.4269093582128445, 94.56466605450093, 176.9351745793295, 93.45888714459552, 65.3818618759796, 4.2241939472056895, 0.9855411698438251, 1.7433928085257202, 4.718972583641174, 5.8680903614200295, 32.668109134468786, 8.92982158100686, 380.5101741537224, 8.658459652492015, 5.312961035265749, 0.8913587750063, 150.69033890586707, 7.422731280269841, 153.85285314559619, 0.0, 5.523742564375382, 114.35052675218358, 2.299348967943945, 408.3870433246158, 541.6921828267971, 5.850528871055488, 46.777671286275314, 22.0150194976511, 121.56701164790972, 10.881767435318691, 24.636501829122064, 33.33942532948367, 97.4538735260954, 3.7380045038872804, 7.077221635849094, 4.152645012367304, 271.90954072299667, 0.0, 39.038137287448905, 2.6403883593285093, 5.822212224088169, 4.947576464133549, 119.67825856239486, 4.462958135804675, 0.0, 5.458894509887197, 1.0577217796239615, 13.52149890541902, 20.832892581472173, 8.419534894074602, 6.693254305652668, 0.0, 21.897242291930173, 0.0, 11.200039004477839, 51.54803282352151, 27.709590096646192, 8.75775263639308, 241.84819239875333, 31.049893056889104, 10.643512699833773, 5.778991783928989, 42.59981599725557, 213.6458670703705, 32.17973906088402, 15.51668351907039, 22.148218824526573, 29.911532426205888, 143.24191356010434, 20.853843123221324, 27.33099188695092, 18.477973282546643, 20.563885357742162, 9.627357645643349, 8.531674958432344, 2.885817626447231, 15.55642502965068, 3.6789708930081226, 12.916382605301656, 7.362437640261632, 5.20097333399792, 0.0, 2.1264779513632175, 32.91378423322574, 0.9000741092579886, 0.0, 7.992366399893359, 88.17036358047953, 0.0, 23.675342646147666, 1.251383598766226, 0.0, 0.0, 4.145444896132091, 6.063544394054196, 0.0, 42.34835213009126, 1.6330900055257676, 70.85735990709661, 49.51423193439012, 12.368235009105973, 46.8366840880763, 17.546573330628686, 1.0482327508733227, 9.264665366516574, 80.37929787280568, 22.555029777119316, 14.57688002698411, 0.0, 12.823636849466181, 29.66501700873062, 26.0988049318732, 4.54060848784666, 17.028863078451934, 1.0431400262857484, 17.47370751572089, 0.0, 31.58281369506958, 0.0, 9.318403819294932, 76.74654438036299, 6.52926583582381, 47.122600541960345, 2.0705785594109076, 12.890314443645812, 26.536247697921667, 1.9139083071898728, 2.8235331626095768, 0.0, 30.785039390732035, 5.942388584888187, 479.41872167411213, 17.660489731941674, 1.1750840197340806, 0.7496039289205528, 27.394032298069142, 9.435780840772113, 20.81408764529294, 6.448752636171949, 9.914991578355773, 10.154403238844404, 1.2258540336041313, 0.0, 5.296518838249437, 4.417886494714469, 0.0, 36.91068311309476, 3.2534653217089793, 25.959478880322756, 93.30183874807523, 21.140302841123514, 0.0, 8.53055086599852, 20.83078480845959, 2.7799306907851467, 5.240680618848934, 13.982646017227268, 0.0, 15.420314350915461, 16.416463931420797, 25.265681491808866, 182.7501845072862, 25.887331851688007, 41.79539705475217, 0.0, 4.283888031221208, 0.9688929324934196, 0.0, 0.0, 22.57907267810872, 1.0319374227341211, 39.50827741887322, 14.16031684072164, 13.334026379303786, 0.0, 32.215004282783426, 261.4275242870597, 9.1629465421428, 0.0, 1.0167883806352258, 9.64259741235562, 5.916779558748592, 15.501754622844514, 16.552450088658826, 161.43174027239658, 1.2083331095575292, 1.9717441326447975, 7.942829817474542, 0.0, 10.007943562195576, 3.1479896207479694, 3.8999272769226128, 0.0, 0.0, 11.628068672019667, 0.0, 0.0, 16.97683847161828]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.751255661154647, "mean_inference_ms": 3.6909062561950052, "mean_action_processing_ms": 1.8568595859089214, "mean_env_wait_ms": 1.126104146368797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033829212188720703, "StateBufferConnector_ms": 0.011998295783996582, "ViewRequirementAgentConnector_ms": 0.09539186954498291}, "num_episodes": 72, "episode_return_max": 74.59999999999974, "episode_return_min": -397.9916001240914, "episode_return_mean": 15.844571293725771, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 253.6721968418891, "num_env_steps_trained_throughput_per_sec": 253.6721968418891, "timesteps_total": 800000, "num_env_steps_sampled_lifetime": 800000, "num_agent_steps_sampled_lifetime": 3200000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 3200000, "timers": {"training_iteration_time_ms": 33477.183, "restore_workers_time_ms": 0.019, "training_step_time_ms": 33477.01, "sample_time_ms": 1339.788, "learn_time_ms": 32114.084, "learn_throughput": 249.112, "synch_weights_time_ms": 19.201}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "done": true, "training_iteration": 100, "trial_id": "cd905_00000", "date": "2024-08-20_10-18-35", "timestamp": 1724129315, "time_this_iter_s": 31.542535066604614, "time_total_s": 3271.6707470417023, "pid": 59738, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31a1c6a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3271.6707470417023, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 28.888888888888893, "ram_util_percent": 71.45111111111112}}
