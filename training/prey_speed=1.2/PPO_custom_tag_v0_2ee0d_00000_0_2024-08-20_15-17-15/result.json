{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2047669261772798, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.864555358129834, "policy_loss": -0.018112297789390795, "vf_loss": 7.880952617100307, "vf_explained_var": 0.02504802002477898, "kl": 0.008575256362190302, "entropy": 1.6015869898140116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8230425508407058, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.787437679654076, "policy_loss": -0.018934618706430588, "vf_loss": 6.804680329025107, "vf_explained_var": 0.032286395187731146, "kl": 0.008459887769511808, "entropy": 1.6015038560937953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.65287613724419, "num_env_steps_trained_throughput_per_sec": 70.65287613724419, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 56615.687, "restore_workers_time_ms": 0.338, "training_step_time_ms": 56614.314, "sample_time_ms": 7763.05, "learn_time_ms": 48832.342, "learn_throughput": 81.913, "synch_weights_time_ms": 15.691}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-21-25", "timestamp": 1724147485, "time_this_iter_s": 56.671451807022095, "time_total_s": 56.671451807022095, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310f89d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 56.671451807022095, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 48.048780487804876, "ram_util_percent": 83.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3504282454649608, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.0487583801229166, "policy_loss": -0.021885904732465784, "vf_loss": 7.0683355740138465, "vf_explained_var": 0.09211750408959767, "kl": 0.011543553647623403, "entropy": 1.586489691053118, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7680262322621372, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.372127174952674, "policy_loss": -0.016599907839384975, "vf_loss": 5.38698895393856, "vf_explained_var": 0.07576331461548175, "kl": 0.008690670110339487, "entropy": 1.5879574785156856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.57210129214398, "num_env_steps_trained_throughput_per_sec": 73.57210129214398, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 55492.079, "restore_workers_time_ms": 0.207, "training_step_time_ms": 55491.296, "sample_time_ms": 5530.651, "learn_time_ms": 49940.722, "learn_throughput": 80.095, "synch_weights_time_ms": 14.616}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-22-22", "timestamp": 1724147542, "time_this_iter_s": 54.42619800567627, "time_total_s": 111.09764981269836, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3311a2ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 111.09764981269836, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 50.013580246913584, "ram_util_percent": 83.15308641975308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6125438941534234, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.032906006252955, "policy_loss": -0.021830220137249737, "vf_loss": 6.052857070246701, "vf_explained_var": 0.14296039850623518, "kl": 0.009395741557741843, "entropy": 1.5760193649423186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8142784372050926, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.713490148322292, "policy_loss": -0.02360794998399874, "vf_loss": 3.73537996206334, "vf_explained_var": 0.11190516422034572, "kl": 0.008590705353500587, "entropy": 1.5725379970338609, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 90.59999999999972, "episode_reward_min": 50.50000000000019, "episode_reward_mean": 70.54999999999995, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 400, "policy_reward_min": {"prey_policy": -110.09890173078014, "predator_policy": 64.82457922114362}, "policy_reward_max": {"prey_policy": -18.64511815965559, "predator_policy": 126.79890173077942}, "policy_reward_mean": {"prey_policy": -60.93055207878374, "predator_policy": 96.20555207878363}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.50000000000019, 90.59999999999972], "episode_lengths": [200, 200], "policy_prey_policy_reward": [-110.09890173078014, -59.697568537055346, -18.64511815965559, -55.280619887643866], "policy_predator_policy_reward": [126.79890173077942, 93.49756853705549, 99.70115882615596, 64.82457922114362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.043326715816809, "mean_inference_ms": 7.947355574780367, "mean_action_processing_ms": 2.9453282715171896, "mean_env_wait_ms": 15.84626505225614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005412101745605469, "StateBufferConnector_ms": 0.004291534423828125, "ViewRequirementAgentConnector_ms": 0.21616220474243164}, "num_episodes": 2, "episode_return_max": 90.59999999999972, "episode_return_min": 50.50000000000019, "episode_return_mean": 70.54999999999995, "episodes_this_iter": 2}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.48765377504506, "num_env_steps_trained_throughput_per_sec": 72.48765377504506, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 55388.659, "restore_workers_time_ms": 0.142, "training_step_time_ms": 55388.12, "sample_time_ms": 5141.625, "learn_time_ms": 50223.051, "learn_throughput": 79.645, "synch_weights_time_ms": 16.88}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-23-18", "timestamp": 1724147598, "time_this_iter_s": 55.21909785270691, "time_total_s": 166.31674766540527, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33132b3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 166.31674766540527, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 42.6253164556962, "ram_util_percent": 83.23417721518989}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.931307438725517, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.99626659564871, "policy_loss": -0.029720611907246095, "vf_loss": 6.023196437623766, "vf_explained_var": 0.26183783907108205, "kl": 0.013953912441825702, "entropy": 1.5308734218910258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0937338279983986, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.211877943977477, "policy_loss": -0.025727502007293637, "vf_loss": 4.23509737865004, "vf_explained_var": 0.1683300961577703, "kl": 0.012540371267238346, "entropy": 1.5317128761104806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 247.93930290059487, "episode_reward_min": 14.090594406412007, "episode_reward_mean": 100.79900423323187, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -408.7653440913074, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 147.24597942420834, "predator_policy": 368.81727340556535}, "policy_reward_mean": {"prey_policy": -70.00800580136467, "predator_policy": 120.40750791798067}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.50000000000019, 90.59999999999972, 81.67249366555754, 63.20000000000033, 93.09999999999941, 176.19999999999965, 187.77705760224774, 151.79018794203628, 176.68598528766907, 33.7000000000002, 31.600000000000193, 53.40000000000037, 18.83234484776469, 114.29999999999976, 177.59999999999985, 127.90575195476804, 113.79044745927365, 86.10338977176555, 29.600000000000154, 50.90000000000014, 247.93930290059487, 92.49999999999966, 65.40000000000018, 129.03024465395927, 168.39945906334646, 83.3873501078068, 67.75058274637455, 88.79999999999953, 97.59999999999897, 161.85547824663433, 79.49999999999943, 28.684451114316914, 54.400000000000276, 27.867486390047475, 26.900000000000105, 158.17347492358778, 104.49999999999932, 111.96259492071893, 61.02148097312674, 46.0000000000001, 132.99999999999963, 99.29999999999956, 128.5, 14.090594406412007, 53.60995440089109, 88.5266923609311, 137.69999999999948, 108.03032048372982, 125.81684910783001, 170.8999999999998, 131.0520804101582, 56.816224577031505, 87.20000000000009, 140.89999999999947, 68.6797203720556, 75.02798079279101, 124.86450236097856, 98.81343318724677, 88.0999999999992, 62.80000000000026, 128.60000000000002, 194.49999999999952, 77.05479647670262, 151.3685403205599, 144.3312106161252, 205.79999999999959, 103.31286728773902, 69.10000000000004, 88.1999999999996, 66.40427021225342, 93.67967266864659, 130.5190301790228], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-110.09890173078014, -59.697568537055346, -18.64511815965559, -55.280619887643866, -197.8585484858606, 6.023101273540869, 3.7474545762419815, 36.22776062742282, 43.86824036323456, -125.93073179738465, -241.94389513103417, 147.24597942420834, -130.88906894995463, -0.6923446783843334, 19.12550540550318, 55.71012508971669, 100.81990367558659, -48.67031758219947, -162.0961204736981, -11.051208513197526, 15.832966173438285, -158.99543961969434, -113.86691735770296, -10.217932745861749, -119.4001503887182, -141.32379132301247, -156.9120245794215, 62.685502421123985, -233.89965981816522, 102.6235364275054, 83.12912353587475, -267.1906981559893, -97.94979748110319, -51.78021879780795, -240.10867003963358, -57.526944647096656, -21.3911268500222, -130.1561798993378, -44.77421550060202, -213.90170945114045, -82.9291068343061, 91.06814696385945, -177.1386290160615, 25.167943493344453, -108.73135452190898, -240.8822375735309, -175.16015400121, 91.33995624499349, -139.3501051917058, 73.85908716311809, -37.81077513008308, -225.5013925118705, -347.2269514187595, -29.67122749141842, 48.88572488161927, -84.19625635610426, 8.568846671710936, 0.46192937648315224, -77.0394565693734, 43.404338108641504, -220.49507072037684, 51.73320704958982, -123.88440438585874, -16.803525359869255, -110.48735712335603, -111.74952110565691, -87.41432642440418, -146.54367482779168, -72.30873222926148, -85.99614545631164, 44.50118709513757, 21.83269115890423, 12.269730176374269, -134.73990541044935, -242.43069406402458, 30.69105339644895, -300.28198537011815, -108.05237207828117, -129.59569188713175, -13.544616132459531, -52.335804854625934, 6.7896790439777845, 50.57420742706496, -63.18741318450213, -49.27527193653483, 55.13902896254695, -314.753349896279, -89.28477728657641, -63.32558164864653, -217.09053294372637, -35.64222844815044, 2.5983794953562733, -4.7648653472746485, 0.18535270878194157, -18.095225981889627, 51.69519063240084, 49.83502222078437, -170.76862911114813, -5.557713873879569, -66.81555116799296, -95.85859609247005, 31.733076674038422, -17.744047184029828, -142.84075136574617, 46.02576341065637, -151.56305954155604, 16.437923190481428, -175.23092216664605, -203.3349968778846, -283.59296857637594, -138.5438066715401, -113.38619076291096, -113.90562045732135, 61.885613507179976, -210.5006578654884, 26.25351214828313, -59.56688279851364, 52.15089161453428, -145.0962112636828, -67.70072349538303, -19.34196995015486, -157.05708698682128, 3.874170560015828, 91.5089537379035, -90.31681957906343, -40.69157357324807, -162.46624796416737, -53.740838663998616, -7.907944718852713, -408.7653440913074, 19.043621383547013, 120.20552304147117, -35.96951657907167, -62.082641200625204, -97.16113233069477, 55.10000000000021, -21.190389809590222, -96.80491266863345, -197.45773668716822, -104.20227174141242, -78.519074742448, -234.77569124619518, -204.36152307406672, -48.22109974702376], "policy_predator_policy_reward": [126.79890173077942, 93.49756853705549, 99.70115882615596, 64.82457922114362, 57.479575400772326, 216.0283654771054, 14.952545423757984, 8.2722393725772, 32.4550748324381, 142.70741660171151, 267.9438951310352, 2.9540205757916462, 173.74814537071674, 145.61032585987073, 74.46436950478015, 2.49018794203686, 40.065285045976594, 84.47111414830628, 101.86846920218304, 104.97885978471267, 96.09138254359796, 78.67109090265774, 132.46691735770221, 45.017932745861835, 81.31675859867354, 198.2395279608213, 169.6120245794209, 38.91449757887602, 229.88632502909348, 78.98979836156634, 200.4220145663791, 111.5453120085049, 113.94549307278623, 149.57497066539855, 184.28303487220404, 199.45596958629173, 38.691126850022414, 142.4561798993371, 79.57421550060214, 230.0017094511402, 73.24780477191673, 166.55245799912478, 194.43862901606116, 50.03205650665557, 158.73135452190866, 256.2822375735304, 205.78805408345022, 7.0623883267255625, 138.6135878341473, 95.27688925778683, 118.42560135450779, 228.27391639525305, 368.81727340556535, 75.83148825098799, 25.614275118380814, 98.49625635610387, 67.83115332828902, 20.738070623516872, 150.46570965573065, 45.02488705163559, 232.39507072037648, 15.8667929504103, 40.855055162920586, 128.51732569712462, 142.78735712335552, 133.8495211056566, 14.135227495345125, 247.69026014689737, 85.8087322292612, 99.3961454563111, 9.748092948643459, 82.09150372090342, 56.3302698236257, 170.63990541044896, 258.2731354842733, 65.4291001040211, 181.54347180393452, 287.81236661759164, 142.09569188713118, 47.044616132459694, 102.9358048546259, 75.61032095602229, 34.32579257293514, 77.58741318450221, 91.9752719365345, 30.660971037453116, 150.94751040677028, 267.18121118249815, 148.79404938883684, 185.2320196044266, 85.81595697160327, 35.75458434212261, 23.364865347274712, 118.91464729121807, 42.7474601451349, 31.682895688085065, 66.19769931159556, 180.55275668659806, 100.0577138738794, 143.21555116799283, 131.58731367712238, 63.59028615146769, 36.66027176106126, 180.74075136574572, 13.07423658934361, 179.66305954155553, 42.26207680951854, 257.43092216664587, 272.0301712866084, 283.57751453970815, 178.37965020143048, 148.57832802581143, 166.8854149449069, 9.999094366213857, 276.7823792890667, 6.2781996153857955, 71.96850181605375, 23.547489367925916, 156.49621126368217, 119.10072349538292, 73.94196995015491, 231.05708698682128, 54.63286790902086, 44.484007793059845, 123.16204696892054, 84.90114266009375, 153.6020514714903, 213.97357547723553, 264.1941614954396, 296.81033793084583, 29.15637861645306, 37.394476958528806, 152.76317122412516, 48.60185384331108, 111.16113233069402, 0.0, 46.09038980959046, 160.10491266863357, 190.1832143068537, 177.88106433397957, 123.04913587250167, 283.9253027847877, 182.81280057080286, 200.2888524293113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.777946512962195, "mean_inference_ms": 8.162551140658271, "mean_action_processing_ms": 2.338186628198928, "mean_env_wait_ms": 14.13218848474586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006496906280517578, "StateBufferConnector_ms": 0.0067510538631015355, "ViewRequirementAgentConnector_ms": 0.3967109653684828}, "num_episodes": 70, "episode_return_max": 247.93930290059487, "episode_return_min": 14.090594406412007, "episode_return_mean": 100.79900423323187, "episodes_this_iter": 70}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.45454629628324, "num_env_steps_trained_throughput_per_sec": 71.45454629628324, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 55536.407, "restore_workers_time_ms": 0.11, "training_step_time_ms": 55535.991, "sample_time_ms": 4811.731, "learn_time_ms": 50697.921, "learn_throughput": 78.899, "synch_weights_time_ms": 19.946}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-24-14", "timestamp": 1724147654, "time_this_iter_s": 56.01876616477966, "time_total_s": 222.33551383018494, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33132b4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 222.33551383018494, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 42.641772151898735, "ram_util_percent": 83.15189873417722}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.989775497509689, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.851285484606627, "policy_loss": -0.024274528708441982, "vf_loss": 6.872658969233275, "vf_explained_var": 0.21542678226238837, "kl": 0.014505181504935814, "entropy": 1.5229612923173046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8527086631015495, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.420172412685616, "policy_loss": -0.02352855383250961, "vf_loss": 4.441458147669596, "vf_explained_var": 0.12406788484129326, "kl": 0.011214030445947574, "entropy": 1.5242926219783763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 247.93930290059487, "episode_reward_min": 14.090594406412007, "episode_reward_mean": 100.79900423323187, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -408.7653440913074, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 147.24597942420834, "predator_policy": 368.81727340556535}, "policy_reward_mean": {"prey_policy": -70.00800580136467, "predator_policy": 120.40750791798067}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.50000000000019, 90.59999999999972, 81.67249366555754, 63.20000000000033, 93.09999999999941, 176.19999999999965, 187.77705760224774, 151.79018794203628, 176.68598528766907, 33.7000000000002, 31.600000000000193, 53.40000000000037, 18.83234484776469, 114.29999999999976, 177.59999999999985, 127.90575195476804, 113.79044745927365, 86.10338977176555, 29.600000000000154, 50.90000000000014, 247.93930290059487, 92.49999999999966, 65.40000000000018, 129.03024465395927, 168.39945906334646, 83.3873501078068, 67.75058274637455, 88.79999999999953, 97.59999999999897, 161.85547824663433, 79.49999999999943, 28.684451114316914, 54.400000000000276, 27.867486390047475, 26.900000000000105, 158.17347492358778, 104.49999999999932, 111.96259492071893, 61.02148097312674, 46.0000000000001, 132.99999999999963, 99.29999999999956, 128.5, 14.090594406412007, 53.60995440089109, 88.5266923609311, 137.69999999999948, 108.03032048372982, 125.81684910783001, 170.8999999999998, 131.0520804101582, 56.816224577031505, 87.20000000000009, 140.89999999999947, 68.6797203720556, 75.02798079279101, 124.86450236097856, 98.81343318724677, 88.0999999999992, 62.80000000000026, 128.60000000000002, 194.49999999999952, 77.05479647670262, 151.3685403205599, 144.3312106161252, 205.79999999999959, 103.31286728773902, 69.10000000000004, 88.1999999999996, 66.40427021225342, 93.67967266864659, 130.5190301790228], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-110.09890173078014, -59.697568537055346, -18.64511815965559, -55.280619887643866, -197.8585484858606, 6.023101273540869, 3.7474545762419815, 36.22776062742282, 43.86824036323456, -125.93073179738465, -241.94389513103417, 147.24597942420834, -130.88906894995463, -0.6923446783843334, 19.12550540550318, 55.71012508971669, 100.81990367558659, -48.67031758219947, -162.0961204736981, -11.051208513197526, 15.832966173438285, -158.99543961969434, -113.86691735770296, -10.217932745861749, -119.4001503887182, -141.32379132301247, -156.9120245794215, 62.685502421123985, -233.89965981816522, 102.6235364275054, 83.12912353587475, -267.1906981559893, -97.94979748110319, -51.78021879780795, -240.10867003963358, -57.526944647096656, -21.3911268500222, -130.1561798993378, -44.77421550060202, -213.90170945114045, -82.9291068343061, 91.06814696385945, -177.1386290160615, 25.167943493344453, -108.73135452190898, -240.8822375735309, -175.16015400121, 91.33995624499349, -139.3501051917058, 73.85908716311809, -37.81077513008308, -225.5013925118705, -347.2269514187595, -29.67122749141842, 48.88572488161927, -84.19625635610426, 8.568846671710936, 0.46192937648315224, -77.0394565693734, 43.404338108641504, -220.49507072037684, 51.73320704958982, -123.88440438585874, -16.803525359869255, -110.48735712335603, -111.74952110565691, -87.41432642440418, -146.54367482779168, -72.30873222926148, -85.99614545631164, 44.50118709513757, 21.83269115890423, 12.269730176374269, -134.73990541044935, -242.43069406402458, 30.69105339644895, -300.28198537011815, -108.05237207828117, -129.59569188713175, -13.544616132459531, -52.335804854625934, 6.7896790439777845, 50.57420742706496, -63.18741318450213, -49.27527193653483, 55.13902896254695, -314.753349896279, -89.28477728657641, -63.32558164864653, -217.09053294372637, -35.64222844815044, 2.5983794953562733, -4.7648653472746485, 0.18535270878194157, -18.095225981889627, 51.69519063240084, 49.83502222078437, -170.76862911114813, -5.557713873879569, -66.81555116799296, -95.85859609247005, 31.733076674038422, -17.744047184029828, -142.84075136574617, 46.02576341065637, -151.56305954155604, 16.437923190481428, -175.23092216664605, -203.3349968778846, -283.59296857637594, -138.5438066715401, -113.38619076291096, -113.90562045732135, 61.885613507179976, -210.5006578654884, 26.25351214828313, -59.56688279851364, 52.15089161453428, -145.0962112636828, -67.70072349538303, -19.34196995015486, -157.05708698682128, 3.874170560015828, 91.5089537379035, -90.31681957906343, -40.69157357324807, -162.46624796416737, -53.740838663998616, -7.907944718852713, -408.7653440913074, 19.043621383547013, 120.20552304147117, -35.96951657907167, -62.082641200625204, -97.16113233069477, 55.10000000000021, -21.190389809590222, -96.80491266863345, -197.45773668716822, -104.20227174141242, -78.519074742448, -234.77569124619518, -204.36152307406672, -48.22109974702376], "policy_predator_policy_reward": [126.79890173077942, 93.49756853705549, 99.70115882615596, 64.82457922114362, 57.479575400772326, 216.0283654771054, 14.952545423757984, 8.2722393725772, 32.4550748324381, 142.70741660171151, 267.9438951310352, 2.9540205757916462, 173.74814537071674, 145.61032585987073, 74.46436950478015, 2.49018794203686, 40.065285045976594, 84.47111414830628, 101.86846920218304, 104.97885978471267, 96.09138254359796, 78.67109090265774, 132.46691735770221, 45.017932745861835, 81.31675859867354, 198.2395279608213, 169.6120245794209, 38.91449757887602, 229.88632502909348, 78.98979836156634, 200.4220145663791, 111.5453120085049, 113.94549307278623, 149.57497066539855, 184.28303487220404, 199.45596958629173, 38.691126850022414, 142.4561798993371, 79.57421550060214, 230.0017094511402, 73.24780477191673, 166.55245799912478, 194.43862901606116, 50.03205650665557, 158.73135452190866, 256.2822375735304, 205.78805408345022, 7.0623883267255625, 138.6135878341473, 95.27688925778683, 118.42560135450779, 228.27391639525305, 368.81727340556535, 75.83148825098799, 25.614275118380814, 98.49625635610387, 67.83115332828902, 20.738070623516872, 150.46570965573065, 45.02488705163559, 232.39507072037648, 15.8667929504103, 40.855055162920586, 128.51732569712462, 142.78735712335552, 133.8495211056566, 14.135227495345125, 247.69026014689737, 85.8087322292612, 99.3961454563111, 9.748092948643459, 82.09150372090342, 56.3302698236257, 170.63990541044896, 258.2731354842733, 65.4291001040211, 181.54347180393452, 287.81236661759164, 142.09569188713118, 47.044616132459694, 102.9358048546259, 75.61032095602229, 34.32579257293514, 77.58741318450221, 91.9752719365345, 30.660971037453116, 150.94751040677028, 267.18121118249815, 148.79404938883684, 185.2320196044266, 85.81595697160327, 35.75458434212261, 23.364865347274712, 118.91464729121807, 42.7474601451349, 31.682895688085065, 66.19769931159556, 180.55275668659806, 100.0577138738794, 143.21555116799283, 131.58731367712238, 63.59028615146769, 36.66027176106126, 180.74075136574572, 13.07423658934361, 179.66305954155553, 42.26207680951854, 257.43092216664587, 272.0301712866084, 283.57751453970815, 178.37965020143048, 148.57832802581143, 166.8854149449069, 9.999094366213857, 276.7823792890667, 6.2781996153857955, 71.96850181605375, 23.547489367925916, 156.49621126368217, 119.10072349538292, 73.94196995015491, 231.05708698682128, 54.63286790902086, 44.484007793059845, 123.16204696892054, 84.90114266009375, 153.6020514714903, 213.97357547723553, 264.1941614954396, 296.81033793084583, 29.15637861645306, 37.394476958528806, 152.76317122412516, 48.60185384331108, 111.16113233069402, 0.0, 46.09038980959046, 160.10491266863357, 190.1832143068537, 177.88106433397957, 123.04913587250167, 283.9253027847877, 182.81280057080286, 200.2888524293113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.777946512962195, "mean_inference_ms": 8.162551140658271, "mean_action_processing_ms": 2.338186628198928, "mean_env_wait_ms": 14.13218848474586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006496906280517578, "StateBufferConnector_ms": 0.0067510538631015355, "ViewRequirementAgentConnector_ms": 0.3967109653684828}, "num_episodes": 0, "episode_return_max": 247.93930290059487, "episode_return_min": 14.090594406412007, "episode_return_mean": 100.79900423323187, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.59322462671436, "num_env_steps_trained_throughput_per_sec": 72.59322462671436, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 55449.439, "restore_workers_time_ms": 0.091, "training_step_time_ms": 55449.095, "sample_time_ms": 5109.214, "learn_time_ms": 50314.195, "learn_throughput": 79.5, "synch_weights_time_ms": 19.929}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-25-09", "timestamp": 1724147709, "time_this_iter_s": 55.13583302497864, "time_total_s": 277.4713468551636, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33132e940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 277.4713468551636, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 35.31392405063292, "ram_util_percent": 82.37594936708862}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.060364165003338, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.008458084025711, "policy_loss": -0.024300255509655155, "vf_loss": 6.030296721534124, "vf_explained_var": 0.22592599477086747, "kl": 0.0123080046641734, "entropy": 1.5356996885052434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.525728612996283, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.7902446182316574, "policy_loss": -0.022194135527831144, "vf_loss": 2.810270831887684, "vf_explained_var": 0.11839072083039258, "kl": 0.010839620178131752, "entropy": 1.5303584614128032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 247.93930290059487, "episode_reward_min": 14.090594406412007, "episode_reward_mean": 100.86018889524787, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14600, "policy_reward_min": {"prey_policy": -408.7653440913074, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 147.24597942420834, "predator_policy": 368.81727340556535}, "policy_reward_mean": {"prey_policy": -69.45124866929294, "predator_policy": 119.88134311691694}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.50000000000019, 90.59999999999972, 81.67249366555754, 63.20000000000033, 93.09999999999941, 176.19999999999965, 187.77705760224774, 151.79018794203628, 176.68598528766907, 33.7000000000002, 31.600000000000193, 53.40000000000037, 18.83234484776469, 114.29999999999976, 177.59999999999985, 127.90575195476804, 113.79044745927365, 86.10338977176555, 29.600000000000154, 50.90000000000014, 247.93930290059487, 92.49999999999966, 65.40000000000018, 129.03024465395927, 168.39945906334646, 83.3873501078068, 67.75058274637455, 88.79999999999953, 97.59999999999897, 161.85547824663433, 79.49999999999943, 28.684451114316914, 54.400000000000276, 27.867486390047475, 26.900000000000105, 158.17347492358778, 104.49999999999932, 111.96259492071893, 61.02148097312674, 46.0000000000001, 132.99999999999963, 99.29999999999956, 128.5, 14.090594406412007, 53.60995440089109, 88.5266923609311, 137.69999999999948, 108.03032048372982, 125.81684910783001, 170.8999999999998, 131.0520804101582, 56.816224577031505, 87.20000000000009, 140.89999999999947, 68.6797203720556, 75.02798079279101, 124.86450236097856, 98.81343318724677, 88.0999999999992, 62.80000000000026, 128.60000000000002, 194.49999999999952, 77.05479647670262, 151.3685403205599, 144.3312106161252, 205.79999999999959, 103.31286728773902, 69.10000000000004, 88.1999999999996, 66.40427021225342, 93.67967266864659, 130.5190301790228, 105.26548456040034], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-110.09890173078014, -59.697568537055346, -18.64511815965559, -55.280619887643866, -197.8585484858606, 6.023101273540869, 3.7474545762419815, 36.22776062742282, 43.86824036323456, -125.93073179738465, -241.94389513103417, 147.24597942420834, -130.88906894995463, -0.6923446783843334, 19.12550540550318, 55.71012508971669, 100.81990367558659, -48.67031758219947, -162.0961204736981, -11.051208513197526, 15.832966173438285, -158.99543961969434, -113.86691735770296, -10.217932745861749, -119.4001503887182, -141.32379132301247, -156.9120245794215, 62.685502421123985, -233.89965981816522, 102.6235364275054, 83.12912353587475, -267.1906981559893, -97.94979748110319, -51.78021879780795, -240.10867003963358, -57.526944647096656, -21.3911268500222, -130.1561798993378, -44.77421550060202, -213.90170945114045, -82.9291068343061, 91.06814696385945, -177.1386290160615, 25.167943493344453, -108.73135452190898, -240.8822375735309, -175.16015400121, 91.33995624499349, -139.3501051917058, 73.85908716311809, -37.81077513008308, -225.5013925118705, -347.2269514187595, -29.67122749141842, 48.88572488161927, -84.19625635610426, 8.568846671710936, 0.46192937648315224, -77.0394565693734, 43.404338108641504, -220.49507072037684, 51.73320704958982, -123.88440438585874, -16.803525359869255, -110.48735712335603, -111.74952110565691, -87.41432642440418, -146.54367482779168, -72.30873222926148, -85.99614545631164, 44.50118709513757, 21.83269115890423, 12.269730176374269, -134.73990541044935, -242.43069406402458, 30.69105339644895, -300.28198537011815, -108.05237207828117, -129.59569188713175, -13.544616132459531, -52.335804854625934, 6.7896790439777845, 50.57420742706496, -63.18741318450213, -49.27527193653483, 55.13902896254695, -314.753349896279, -89.28477728657641, -63.32558164864653, -217.09053294372637, -35.64222844815044, 2.5983794953562733, -4.7648653472746485, 0.18535270878194157, -18.095225981889627, 51.69519063240084, 49.83502222078437, -170.76862911114813, -5.557713873879569, -66.81555116799296, -95.85859609247005, 31.733076674038422, -17.744047184029828, -142.84075136574617, 46.02576341065637, -151.56305954155604, 16.437923190481428, -175.23092216664605, -203.3349968778846, -283.59296857637594, -138.5438066715401, -113.38619076291096, -113.90562045732135, 61.885613507179976, -210.5006578654884, 26.25351214828313, -59.56688279851364, 52.15089161453428, -145.0962112636828, -67.70072349538303, -19.34196995015486, -157.05708698682128, 3.874170560015828, 91.5089537379035, -90.31681957906343, -40.69157357324807, -162.46624796416737, -53.740838663998616, -7.907944718852713, -408.7653440913074, 19.043621383547013, 120.20552304147117, -35.96951657907167, -62.082641200625204, -97.16113233069477, 55.10000000000021, -21.190389809590222, -96.80491266863345, -197.45773668716822, -104.20227174141242, -78.519074742448, -234.77569124619518, -204.36152307406672, -48.22109974702376, -9.409983871339636, -49.319486448915264], "policy_predator_policy_reward": [126.79890173077942, 93.49756853705549, 99.70115882615596, 64.82457922114362, 57.479575400772326, 216.0283654771054, 14.952545423757984, 8.2722393725772, 32.4550748324381, 142.70741660171151, 267.9438951310352, 2.9540205757916462, 173.74814537071674, 145.61032585987073, 74.46436950478015, 2.49018794203686, 40.065285045976594, 84.47111414830628, 101.86846920218304, 104.97885978471267, 96.09138254359796, 78.67109090265774, 132.46691735770221, 45.017932745861835, 81.31675859867354, 198.2395279608213, 169.6120245794209, 38.91449757887602, 229.88632502909348, 78.98979836156634, 200.4220145663791, 111.5453120085049, 113.94549307278623, 149.57497066539855, 184.28303487220404, 199.45596958629173, 38.691126850022414, 142.4561798993371, 79.57421550060214, 230.0017094511402, 73.24780477191673, 166.55245799912478, 194.43862901606116, 50.03205650665557, 158.73135452190866, 256.2822375735304, 205.78805408345022, 7.0623883267255625, 138.6135878341473, 95.27688925778683, 118.42560135450779, 228.27391639525305, 368.81727340556535, 75.83148825098799, 25.614275118380814, 98.49625635610387, 67.83115332828902, 20.738070623516872, 150.46570965573065, 45.02488705163559, 232.39507072037648, 15.8667929504103, 40.855055162920586, 128.51732569712462, 142.78735712335552, 133.8495211056566, 14.135227495345125, 247.69026014689737, 85.8087322292612, 99.3961454563111, 9.748092948643459, 82.09150372090342, 56.3302698236257, 170.63990541044896, 258.2731354842733, 65.4291001040211, 181.54347180393452, 287.81236661759164, 142.09569188713118, 47.044616132459694, 102.9358048546259, 75.61032095602229, 34.32579257293514, 77.58741318450221, 91.9752719365345, 30.660971037453116, 150.94751040677028, 267.18121118249815, 148.79404938883684, 185.2320196044266, 85.81595697160327, 35.75458434212261, 23.364865347274712, 118.91464729121807, 42.7474601451349, 31.682895688085065, 66.19769931159556, 180.55275668659806, 100.0577138738794, 143.21555116799283, 131.58731367712238, 63.59028615146769, 36.66027176106126, 180.74075136574572, 13.07423658934361, 179.66305954155553, 42.26207680951854, 257.43092216664587, 272.0301712866084, 283.57751453970815, 178.37965020143048, 148.57832802581143, 166.8854149449069, 9.999094366213857, 276.7823792890667, 6.2781996153857955, 71.96850181605375, 23.547489367925916, 156.49621126368217, 119.10072349538292, 73.94196995015491, 231.05708698682128, 54.63286790902086, 44.484007793059845, 123.16204696892054, 84.90114266009375, 153.6020514714903, 213.97357547723553, 264.1941614954396, 296.81033793084583, 29.15637861645306, 37.394476958528806, 152.76317122412516, 48.60185384331108, 111.16113233069402, 0.0, 46.09038980959046, 160.10491266863357, 190.1832143068537, 177.88106433397957, 123.04913587250167, 283.9253027847877, 182.81280057080286, 200.2888524293113, 40.9514520771819, 123.04350280347441]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.762787858359916, "mean_inference_ms": 8.132797449819925, "mean_action_processing_ms": 2.392820833072893, "mean_env_wait_ms": 14.115392945339872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006478126734903414, "StateBufferConnector_ms": 0.006706094088619703, "ViewRequirementAgentConnector_ms": 0.3923755802520334}, "num_episodes": 1, "episode_return_max": 247.93930290059487, "episode_return_min": 14.090594406412007, "episode_return_mean": 100.86018889524787, "episodes_this_iter": 1}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.66695309757857, "num_env_steps_trained_throughput_per_sec": 77.66695309757857, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 54791.526, "restore_workers_time_ms": 0.078, "training_step_time_ms": 54791.229, "sample_time_ms": 4587.979, "learn_time_ms": 50178.162, "learn_throughput": 79.716, "synch_weights_time_ms": 19.208}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-26-00", "timestamp": 1724147760, "time_this_iter_s": 51.52320408821106, "time_total_s": 328.99455094337463, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x11fff9ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 328.99455094337463, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 35.846575342465755, "ram_util_percent": 82.57671232876713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.92917728897125, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.249394757407052, "policy_loss": -0.022482481714899815, "vf_loss": 6.26918069042226, "vf_explained_var": 0.27542395314211565, "kl": 0.013482684117776375, "entropy": 1.5173373122694631, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.899087406876226, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.5199133034105654, "policy_loss": -0.018312380172708934, "vf_loss": 2.536187867638926, "vf_explained_var": 0.180548559420954, "kl": 0.010189051617666211, "entropy": 1.5156576649852531, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 286.19999999999993, "episode_reward_min": 14.090594406412007, "episode_reward_mean": 122.62206545859945, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -408.7653440913074, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.47772331798367, "predator_policy": 368.81727340556535}, "policy_reward_mean": {"prey_policy": -37.32779729496773, "predator_policy": 98.63883002426752}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.600000000000154, 50.90000000000014, 247.93930290059487, 92.49999999999966, 65.40000000000018, 129.03024465395927, 168.39945906334646, 83.3873501078068, 67.75058274637455, 88.79999999999953, 97.59999999999897, 161.85547824663433, 79.49999999999943, 28.684451114316914, 54.400000000000276, 27.867486390047475, 26.900000000000105, 158.17347492358778, 104.49999999999932, 111.96259492071893, 61.02148097312674, 46.0000000000001, 132.99999999999963, 99.29999999999956, 128.5, 14.090594406412007, 53.60995440089109, 88.5266923609311, 137.69999999999948, 108.03032048372982, 125.81684910783001, 170.8999999999998, 131.0520804101582, 56.816224577031505, 87.20000000000009, 140.89999999999947, 68.6797203720556, 75.02798079279101, 124.86450236097856, 98.81343318724677, 88.0999999999992, 62.80000000000026, 128.60000000000002, 194.49999999999952, 77.05479647670262, 151.3685403205599, 144.3312106161252, 205.79999999999959, 103.31286728773902, 69.10000000000004, 88.1999999999996, 66.40427021225342, 93.67967266864659, 130.5190301790228, 105.26548456040034, 135.18945855113608, 211.90119533592892, 199.59064656248006, 109.92225286593083, 168.4999999999993, 32.573417668167515, 54.100000000000215, 132.1999999999997, 175.99999999999974, 133.99999999999983, 195.75767909746926, 150.9999999999992, 216.99999999999935, 286.19999999999993, 118.72823938645196, 122.85141316816066, 133.6208444339866, 207.50504718224275, 20.037931211970218, 142.79999999999978, 155.39999999999964, 61.200000000000216, 96.40000000000006, 185.59975336201396, 234.59999999999948, 31.165881344701848, 187.62227998880763, 269.0139373820551, 219.9900099041803, 61.549998807906256, 188.20496393865037, 71.90000000000035, 90.5866330617722, 184.9473781249168, 122.89999999999927, 216.99999999999937, 105.40000000000008, 139.5528037393398, 170.29999999999902, 198.11658612811442, 51.30000000000031, 254.29999999999941, 183.59999999999945, 123.54206379155379, 174.50000000000017], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-21.3911268500222, -130.1561798993378, -44.77421550060202, -213.90170945114045, -82.9291068343061, 91.06814696385945, -177.1386290160615, 25.167943493344453, -108.73135452190898, -240.8822375735309, -175.16015400121, 91.33995624499349, -139.3501051917058, 73.85908716311809, -37.81077513008308, -225.5013925118705, -347.2269514187595, -29.67122749141842, 48.88572488161927, -84.19625635610426, 8.568846671710936, 0.46192937648315224, -77.0394565693734, 43.404338108641504, -220.49507072037684, 51.73320704958982, -123.88440438585874, -16.803525359869255, -110.48735712335603, -111.74952110565691, -87.41432642440418, -146.54367482779168, -72.30873222926148, -85.99614545631164, 44.50118709513757, 21.83269115890423, 12.269730176374269, -134.73990541044935, -242.43069406402458, 30.69105339644895, -300.28198537011815, -108.05237207828117, -129.59569188713175, -13.544616132459531, -52.335804854625934, 6.7896790439777845, 50.57420742706496, -63.18741318450213, -49.27527193653483, 55.13902896254695, -314.753349896279, -89.28477728657641, -63.32558164864653, -217.09053294372637, -35.64222844815044, 2.5983794953562733, -4.7648653472746485, 0.18535270878194157, -18.095225981889627, 51.69519063240084, 49.83502222078437, -170.76862911114813, -5.557713873879569, -66.81555116799296, -95.85859609247005, 31.733076674038422, -17.744047184029828, -142.84075136574617, 46.02576341065637, -151.56305954155604, 16.437923190481428, -175.23092216664605, -203.3349968778846, -283.59296857637594, -138.5438066715401, -113.38619076291096, -113.90562045732135, 61.885613507179976, -210.5006578654884, 26.25351214828313, -59.56688279851364, 52.15089161453428, -145.0962112636828, -67.70072349538303, -19.34196995015486, -157.05708698682128, 3.874170560015828, 91.5089537379035, -90.31681957906343, -40.69157357324807, -162.46624796416737, -53.740838663998616, -7.907944718852713, -408.7653440913074, 19.043621383547013, 120.20552304147117, -35.96951657907167, -62.082641200625204, -97.16113233069477, 55.10000000000021, -21.190389809590222, -96.80491266863345, -197.45773668716822, -104.20227174141242, -78.519074742448, -234.77569124619518, -204.36152307406672, -48.22109974702376, -9.409983871339636, -49.319486448915264, 12.779386099934978, -51.342484850471145, -16.46236006859254, -50.62856104669679, -8.81732954805872, -167.92212816100113, -89.19902866077965, -47.82215034265346, 121.66697840110018, -23.433575622500392, -127.5788360091594, -44.48510955081267, -78.68624587420614, 2.0635429505765295, -137.3569655064323, 15.791865206773439, 83.91935510147366, -45.0503515538295, 81.32518921852026, -225.10805294987688, 65.95408350540589, 16.66458493653722, 41.509678626249034, 64.76036560143604, -4.841532581081054, 189.47772331798367, 175.74298787758465, 57.15122539693459, -47.614143561122475, 5.15165323927501, -43.64290727097154, -16.518665395131766, 45.094321108390375, -69.21794303660312, 6.907587632448296, 124.79541184345317, -69.48182870168893, -252.2799282357825, 44.11874529365975, 72.447841023602, -68.31854890865885, 93.76559993023193, 6.118402437593822, 20.000000000000014, -168.2916955492725, 61.40195735719233, 128.4579367850899, -92.43970243447232, 171.69396833862314, -1.2357703587698445, 16.73452640748599, -153.8465409118023, -48.74258656266246, 143.61621207506693, 166.9139177719893, -51.91975671216177, 145.00022457819006, 28.485079718589827, -4.859475325065081, -70.09215012898555, 98.22097518230461, 35.64065972402372, -9.739515875690188, -24.08374238518094, -55.00564708897136, -134.80647618738197, 28.415681616281514, 101.6486385493613, -3.342480072550338, -42.47343808492554, 64.38279681607796, 108.23720874014671, 11.588116458799218, 71.39023875995464, -169.3232763619567, -44.90306120649606, 146.73685691420178, -8.288166284733581, 111.66467108859567, 54.51036514431698, 28.180252136027573, -37.28319890420871, 95.21169755956943, 63.279931992570546, -18.90905400258046, 137.35847274341046, 76.76369137004343, -139.88159107450164, 90.75456878483294, -28.883815577866425], "policy_predator_policy_reward": [38.691126850022414, 142.4561798993371, 79.57421550060214, 230.0017094511402, 73.24780477191673, 166.55245799912478, 194.43862901606116, 50.03205650665557, 158.73135452190866, 256.2822375735304, 205.78805408345022, 7.0623883267255625, 138.6135878341473, 95.27688925778683, 118.42560135450779, 228.27391639525305, 368.81727340556535, 75.83148825098799, 25.614275118380814, 98.49625635610387, 67.83115332828902, 20.738070623516872, 150.46570965573065, 45.02488705163559, 232.39507072037648, 15.8667929504103, 40.855055162920586, 128.51732569712462, 142.78735712335552, 133.8495211056566, 14.135227495345125, 247.69026014689737, 85.8087322292612, 99.3961454563111, 9.748092948643459, 82.09150372090342, 56.3302698236257, 170.63990541044896, 258.2731354842733, 65.4291001040211, 181.54347180393452, 287.81236661759164, 142.09569188713118, 47.044616132459694, 102.9358048546259, 75.61032095602229, 34.32579257293514, 77.58741318450221, 91.9752719365345, 30.660971037453116, 150.94751040677028, 267.18121118249815, 148.79404938883684, 185.2320196044266, 85.81595697160327, 35.75458434212261, 23.364865347274712, 118.91464729121807, 42.7474601451349, 31.682895688085065, 66.19769931159556, 180.55275668659806, 100.0577138738794, 143.21555116799283, 131.58731367712238, 63.59028615146769, 36.66027176106126, 180.74075136574572, 13.07423658934361, 179.66305954155553, 42.26207680951854, 257.43092216664587, 272.0301712866084, 283.57751453970815, 178.37965020143048, 148.57832802581143, 166.8854149449069, 9.999094366213857, 276.7823792890667, 6.2781996153857955, 71.96850181605375, 23.547489367925916, 156.49621126368217, 119.10072349538292, 73.94196995015491, 231.05708698682128, 54.63286790902086, 44.484007793059845, 123.16204696892054, 84.90114266009375, 153.6020514714903, 213.97357547723553, 264.1941614954396, 296.81033793084583, 29.15637861645306, 37.394476958528806, 152.76317122412516, 48.60185384331108, 111.16113233069402, 0.0, 46.09038980959046, 160.10491266863357, 190.1832143068537, 177.88106433397957, 123.04913587250167, 283.9253027847877, 182.81280057080286, 200.2888524293113, 40.9514520771819, 123.04350280347441, 45.00282389692551, 128.74973340474654, 126.38255945630245, 152.60955699491583, 118.12040622556673, 258.20969804597394, 67.60949642677282, 179.33393544259056, 17.495891110680546, 52.7707061107199, 97.15179032289197, 107.48557290524701, 109.28624587420613, 21.436457049423456, 150.45696550643186, 103.30813479322656, 60.680644898526374, 76.45035155382965, 14.674810781479765, 263.1080529498775, 69.38324395185145, 43.755766703674745, 39.690321373751104, 5.039634398564104, 29.722399575229666, 2.641409687867806, 9.730705651157166, 43.57508107432366, 141.27651876251312, 19.91421094578647, 20.57022851590186, 162.442757318363, 156.09945526841136, 1.6450110937879059, 37.470210460368186, 38.33183724597386, 108.8983071780731, 232.90138097136747, 8.579019643869158, 17.654394038869142, 104.80554660269459, 25.147402375732312, 35.081597562406266, 0.0, 180.19169554927183, 23.098042642807744, 57.14682440164057, 92.4346946097559, 16.306031661376856, 47.835770358769956, 0.0, 168.2778958490172, 42.27806663471721, 50.47058784168676, 110.14863868883319, 43.87113763339435, 18.6484425441016, 27.856263063299323, 77.17993386610625, 59.32169039585023, 47.8790248176954, 6.464304214627004, 30.095452953112027, 75.62780530775926, 212.21921966027057, 68.17953667785444, 16.637342040400398, 38.24571591887395, 3.7413782481953635, 164.97453990928054, 12.317203183922171, 32.06279125985327, 19.699582297476336, 2.722062483769926, 73.01317763683313, 280.76596367095925, 25.63553002609811, 6.215779344433495, 27.199736871879413, 4.741813023323053, 47.09134841836282, 13.311598349818414, 20.160413083224334, 75.64795736463527, 44.90905400258056, 20.241527256589453, 19.07837242151047, 167.5815910745011, 22.34543121516706, 90.28381557786648]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.250802454514616, "mean_inference_ms": 7.3166797374723505, "mean_action_processing_ms": 3.3916585744161565, "mean_env_wait_ms": 13.28887806876559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005492806434631348, "StateBufferConnector_ms": 0.022271156311035156, "ViewRequirementAgentConnector_ms": 0.3142671585083008}, "num_episodes": 45, "episode_return_max": 286.19999999999993, "episode_return_min": 14.090594406412007, "episode_return_mean": 122.62206545859945, "episodes_this_iter": 45}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.24976452710838, "num_env_steps_trained_throughput_per_sec": 82.24976452710838, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 53911.646, "restore_workers_time_ms": 0.069, "training_step_time_ms": 53911.385, "sample_time_ms": 4215.625, "learn_time_ms": 49670.073, "learn_throughput": 80.531, "synch_weights_time_ms": 20.183}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-26-49", "timestamp": 1724147809, "time_this_iter_s": 48.65829610824585, "time_total_s": 377.6528470516205, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33132b670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 377.6528470516205, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 27.918840579710146, "ram_util_percent": 82.11449275362318}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.9380569810589785, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.773797288773552, "policy_loss": -0.026999914321910453, "vf_loss": 6.797728539270068, "vf_explained_var": 0.2741980216805897, "kl": 0.015343414077525416, "entropy": 1.4325562323211993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.384822178454626, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.8719796002857265, "policy_loss": -0.020649770955510793, "vf_loss": 4.889712397383635, "vf_explained_var": 0.14241407122561542, "kl": 0.014584948290780029, "entropy": 1.4327257839460221, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 286.19999999999993, "episode_reward_min": 20.037931211970218, "episode_reward_mean": 131.2692513540919, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -408.7653440913074, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.47772331798367, "predator_policy": 380.83040765748086}, "policy_reward_mean": {"prey_policy": -24.360572110254132, "predator_policy": 89.99519778730017}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.60995440089109, 88.5266923609311, 137.69999999999948, 108.03032048372982, 125.81684910783001, 170.8999999999998, 131.0520804101582, 56.816224577031505, 87.20000000000009, 140.89999999999947, 68.6797203720556, 75.02798079279101, 124.86450236097856, 98.81343318724677, 88.0999999999992, 62.80000000000026, 128.60000000000002, 194.49999999999952, 77.05479647670262, 151.3685403205599, 144.3312106161252, 205.79999999999959, 103.31286728773902, 69.10000000000004, 88.1999999999996, 66.40427021225342, 93.67967266864659, 130.5190301790228, 105.26548456040034, 135.18945855113608, 211.90119533592892, 199.59064656248006, 109.92225286593083, 168.4999999999993, 32.573417668167515, 54.100000000000215, 132.1999999999997, 175.99999999999974, 133.99999999999983, 195.75767909746926, 150.9999999999992, 216.99999999999935, 286.19999999999993, 118.72823938645196, 122.85141316816066, 133.6208444339866, 207.50504718224275, 20.037931211970218, 142.79999999999978, 155.39999999999964, 61.200000000000216, 96.40000000000006, 185.59975336201396, 234.59999999999948, 31.165881344701848, 187.62227998880763, 269.0139373820551, 219.9900099041803, 61.549998807906256, 188.20496393865037, 71.90000000000035, 90.5866330617722, 184.9473781249168, 122.89999999999927, 216.99999999999937, 105.40000000000008, 139.5528037393398, 170.29999999999902, 198.11658612811442, 51.30000000000031, 254.29999999999941, 183.59999999999945, 123.54206379155379, 174.50000000000017, 217.20556021402385, 60.35432816855618, 187.76988871028283, 31.15261325419445, 210.69378220790583, 36.05658721466475, 157.63509442973168, 105.99999999999994, 111.70728428475104, 163.5999999999993, 106.45074057956445, 109.73597820341162, 201.99999999999955, 234.57235800199467, 116.78697719607271, 107.7181901094251, 112.89999999999986, 95.08625585572872, 99.83171597442339, 146.60263652714983, 140.51557064028898, 100.41595961918665, 62.392217092135226, 45.791078138692505, 196.406273573983, 62.40000000000035], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-63.32558164864653, -217.09053294372637, -35.64222844815044, 2.5983794953562733, -4.7648653472746485, 0.18535270878194157, -18.095225981889627, 51.69519063240084, 49.83502222078437, -170.76862911114813, -5.557713873879569, -66.81555116799296, -95.85859609247005, 31.733076674038422, -17.744047184029828, -142.84075136574617, 46.02576341065637, -151.56305954155604, 16.437923190481428, -175.23092216664605, -203.3349968778846, -283.59296857637594, -138.5438066715401, -113.38619076291096, -113.90562045732135, 61.885613507179976, -210.5006578654884, 26.25351214828313, -59.56688279851364, 52.15089161453428, -145.0962112636828, -67.70072349538303, -19.34196995015486, -157.05708698682128, 3.874170560015828, 91.5089537379035, -90.31681957906343, -40.69157357324807, -162.46624796416737, -53.740838663998616, -7.907944718852713, -408.7653440913074, 19.043621383547013, 120.20552304147117, -35.96951657907167, -62.082641200625204, -97.16113233069477, 55.10000000000021, -21.190389809590222, -96.80491266863345, -197.45773668716822, -104.20227174141242, -78.519074742448, -234.77569124619518, -204.36152307406672, -48.22109974702376, -9.409983871339636, -49.319486448915264, 12.779386099934978, -51.342484850471145, -16.46236006859254, -50.62856104669679, -8.81732954805872, -167.92212816100113, -89.19902866077965, -47.82215034265346, 121.66697840110018, -23.433575622500392, -127.5788360091594, -44.48510955081267, -78.68624587420614, 2.0635429505765295, -137.3569655064323, 15.791865206773439, 83.91935510147366, -45.0503515538295, 81.32518921852026, -225.10805294987688, 65.95408350540589, 16.66458493653722, 41.509678626249034, 64.76036560143604, -4.841532581081054, 189.47772331798367, 175.74298787758465, 57.15122539693459, -47.614143561122475, 5.15165323927501, -43.64290727097154, -16.518665395131766, 45.094321108390375, -69.21794303660312, 6.907587632448296, 124.79541184345317, -69.48182870168893, -252.2799282357825, 44.11874529365975, 72.447841023602, -68.31854890865885, 93.76559993023193, 6.118402437593822, 20.000000000000014, -168.2916955492725, 61.40195735719233, 128.4579367850899, -92.43970243447232, 171.69396833862314, -1.2357703587698445, 16.73452640748599, -153.8465409118023, -48.74258656266246, 143.61621207506693, 166.9139177719893, -51.91975671216177, 145.00022457819006, 28.485079718589827, -4.859475325065081, -70.09215012898555, 98.22097518230461, 35.64065972402372, -9.739515875690188, -24.08374238518094, -55.00564708897136, -134.80647618738197, 28.415681616281514, 101.6486385493613, -3.342480072550338, -42.47343808492554, 64.38279681607796, 108.23720874014671, 11.588116458799218, 71.39023875995464, -169.3232763619567, -44.90306120649606, 146.73685691420178, -8.288166284733581, 111.66467108859567, 54.51036514431698, 28.180252136027573, -37.28319890420871, 95.21169755956943, 63.279931992570546, -18.90905400258046, 137.35847274341046, 76.76369137004343, -139.88159107450164, 90.75456878483294, -28.883815577866425, -74.10208386111711, 165.68636178629558, -92.16157402258838, -2.4946485678225514, -167.9704230960647, 40.347733865233366, -209.3912792018367, -54.41937306825774, 110.72931941711022, -143.1277568683933, -109.28516693934786, -12.473371390479283, 133.6054603994757, 20.000000000000014, 68.43992116767916, -5.303798799086449, 36.52484294049671, -144.99468482398447, 17.88907265917681, 43.20917598898251, -43.78447825376989, -61.827726140692775, -31.57594194515928, 15.5093470328874, -63.265350548935245, 148.87459444001342, 159.06655428888774, -34.751394425507286, 41.18180891885792, -28.478359909071074, 92.00000000000007, -140.91947130677335, 2.4836483676110035, -43.39647016175148, -152.5751222629319, -289.42317991995594, -250.79432760811693, -10.251256568345521, 35.60700161030245, -148.45663025219707, -0.2394108507451342, -8.176331252510792, -51.25069521444561, -8.790043442326898, -23.433138346537397, -29.116827360358428, -33.474667278185926, -36.42529524915616, -84.55792986513923, 111.37241926504842, 21.459438096034283, -32.59221533726984], "policy_predator_policy_reward": [148.79404938883684, 185.2320196044266, 85.81595697160327, 35.75458434212261, 23.364865347274712, 118.91464729121807, 42.7474601451349, 31.682895688085065, 66.19769931159556, 180.55275668659806, 100.0577138738794, 143.21555116799283, 131.58731367712238, 63.59028615146769, 36.66027176106126, 180.74075136574572, 13.07423658934361, 179.66305954155553, 42.26207680951854, 257.43092216664587, 272.0301712866084, 283.57751453970815, 178.37965020143048, 148.57832802581143, 166.8854149449069, 9.999094366213857, 276.7823792890667, 6.2781996153857955, 71.96850181605375, 23.547489367925916, 156.49621126368217, 119.10072349538292, 73.94196995015491, 231.05708698682128, 54.63286790902086, 44.484007793059845, 123.16204696892054, 84.90114266009375, 153.6020514714903, 213.97357547723553, 264.1941614954396, 296.81033793084583, 29.15637861645306, 37.394476958528806, 152.76317122412516, 48.60185384331108, 111.16113233069402, 0.0, 46.09038980959046, 160.10491266863357, 190.1832143068537, 177.88106433397957, 123.04913587250167, 283.9253027847877, 182.81280057080286, 200.2888524293113, 40.9514520771819, 123.04350280347441, 45.00282389692551, 128.74973340474654, 126.38255945630245, 152.60955699491583, 118.12040622556673, 258.20969804597394, 67.60949642677282, 179.33393544259056, 17.495891110680546, 52.7707061107199, 97.15179032289197, 107.48557290524701, 109.28624587420613, 21.436457049423456, 150.45696550643186, 103.30813479322656, 60.680644898526374, 76.45035155382965, 14.674810781479765, 263.1080529498775, 69.38324395185145, 43.755766703674745, 39.690321373751104, 5.039634398564104, 29.722399575229666, 2.641409687867806, 9.730705651157166, 43.57508107432366, 141.27651876251312, 19.91421094578647, 20.57022851590186, 162.442757318363, 156.09945526841136, 1.6450110937879059, 37.470210460368186, 38.33183724597386, 108.8983071780731, 232.90138097136747, 8.579019643869158, 17.654394038869142, 104.80554660269459, 25.147402375732312, 35.081597562406266, 0.0, 180.19169554927183, 23.098042642807744, 57.14682440164057, 92.4346946097559, 16.306031661376856, 47.835770358769956, 0.0, 168.2778958490172, 42.27806663471721, 50.47058784168676, 110.14863868883319, 43.87113763339435, 18.6484425441016, 27.856263063299323, 77.17993386610625, 59.32169039585023, 47.8790248176954, 6.464304214627004, 30.095452953112027, 75.62780530775926, 212.21921966027057, 68.17953667785444, 16.637342040400398, 38.24571591887395, 3.7413782481953635, 164.97453990928054, 12.317203183922171, 32.06279125985327, 19.699582297476336, 2.722062483769926, 73.01317763683313, 280.76596367095925, 25.63553002609811, 6.215779344433495, 27.199736871879413, 4.741813023323053, 47.09134841836282, 13.311598349818414, 20.160413083224334, 75.64795736463527, 44.90905400258056, 20.241527256589453, 19.07837242151047, 167.5815910745011, 22.34543121516706, 90.28381557786648, 60.305109327951435, 65.31617296089394, 49.612148791166945, 105.39840196780018, 241.4235725897268, 73.96900535138694, 238.79542650774087, 56.16783901654805, 90.35783828568286, 152.73438137350638, 123.7851919794253, 34.029933565066564, 0.9350944297327928, 3.0945396005239294, 14.460078832320795, 28.403798799086502, 16.08071318670401, 204.09641298153534, 88.06538283364614, 14.43636851819463, 38.51720360057743, 173.5457413734501, 50.569264826880584, 75.233308288804, 102.89957273023903, 13.491183378682504, 44.17773952920156, 66.07945860941354, 34.178729153250224, 69.90479903303599, 18.784743235699704, 137.8529181804986, 78.56209055838472, 75.25073123575574, 156.25415038113638, 380.83040765748086, 216.80194900062995, 144.07535115025578, 50.50754412814106, 208.94472104090383, 25.55498149103448, 123.37633125251067, 114.74808965343811, 45.70860862252173, 45.83873088895858, 69.1034519100725, 112.27152512505334, 3.419515540981131, 75.71083102386372, 93.88095315020996, 16.892874797813008, 56.63990244342272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.804234991405493, "mean_inference_ms": 6.839196829610999, "mean_action_processing_ms": 3.7834180378861264, "mean_env_wait_ms": 12.712178081112762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004678845405578613, "StateBufferConnector_ms": 0.022129416465759277, "ViewRequirementAgentConnector_ms": 0.21351242065429688}, "num_episodes": 26, "episode_return_max": 286.19999999999993, "episode_return_min": 20.037931211970218, "episode_return_mean": 131.2692513540919, "episodes_this_iter": 26}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.00603641970552, "num_env_steps_trained_throughput_per_sec": 84.00603641970552, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 53124.645, "restore_workers_time_ms": 0.062, "training_step_time_ms": 53124.411, "sample_time_ms": 3938.657, "learn_time_ms": 49161.321, "learn_throughput": 81.365, "synch_weights_time_ms": 19.418}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-27-37", "timestamp": 1724147857, "time_this_iter_s": 47.640440225601196, "time_total_s": 425.2932872772217, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310cc4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 425.2932872772217, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 26.761764705882353, "ram_util_percent": 82.33676470588233}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.665160663859554, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.8458529136799, "policy_loss": -0.02479557689505989, "vf_loss": 7.867769801175153, "vf_explained_var": 0.26578810867809116, "kl": 0.014393448468948168, "entropy": 1.4430189181257178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6310251511278606, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.833047097574466, "policy_loss": -0.01973687278651312, "vf_loss": 4.849966614965409, "vf_explained_var": 0.13730076671277405, "kl": 0.014086766895054588, "entropy": 1.43587083759762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 286.19999999999993, "episode_reward_min": 20.037931211970218, "episode_reward_mean": 131.2692513540919, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -408.7653440913074, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.47772331798367, "predator_policy": 380.83040765748086}, "policy_reward_mean": {"prey_policy": -24.360572110254132, "predator_policy": 89.99519778730017}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.60995440089109, 88.5266923609311, 137.69999999999948, 108.03032048372982, 125.81684910783001, 170.8999999999998, 131.0520804101582, 56.816224577031505, 87.20000000000009, 140.89999999999947, 68.6797203720556, 75.02798079279101, 124.86450236097856, 98.81343318724677, 88.0999999999992, 62.80000000000026, 128.60000000000002, 194.49999999999952, 77.05479647670262, 151.3685403205599, 144.3312106161252, 205.79999999999959, 103.31286728773902, 69.10000000000004, 88.1999999999996, 66.40427021225342, 93.67967266864659, 130.5190301790228, 105.26548456040034, 135.18945855113608, 211.90119533592892, 199.59064656248006, 109.92225286593083, 168.4999999999993, 32.573417668167515, 54.100000000000215, 132.1999999999997, 175.99999999999974, 133.99999999999983, 195.75767909746926, 150.9999999999992, 216.99999999999935, 286.19999999999993, 118.72823938645196, 122.85141316816066, 133.6208444339866, 207.50504718224275, 20.037931211970218, 142.79999999999978, 155.39999999999964, 61.200000000000216, 96.40000000000006, 185.59975336201396, 234.59999999999948, 31.165881344701848, 187.62227998880763, 269.0139373820551, 219.9900099041803, 61.549998807906256, 188.20496393865037, 71.90000000000035, 90.5866330617722, 184.9473781249168, 122.89999999999927, 216.99999999999937, 105.40000000000008, 139.5528037393398, 170.29999999999902, 198.11658612811442, 51.30000000000031, 254.29999999999941, 183.59999999999945, 123.54206379155379, 174.50000000000017, 217.20556021402385, 60.35432816855618, 187.76988871028283, 31.15261325419445, 210.69378220790583, 36.05658721466475, 157.63509442973168, 105.99999999999994, 111.70728428475104, 163.5999999999993, 106.45074057956445, 109.73597820341162, 201.99999999999955, 234.57235800199467, 116.78697719607271, 107.7181901094251, 112.89999999999986, 95.08625585572872, 99.83171597442339, 146.60263652714983, 140.51557064028898, 100.41595961918665, 62.392217092135226, 45.791078138692505, 196.406273573983, 62.40000000000035], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-63.32558164864653, -217.09053294372637, -35.64222844815044, 2.5983794953562733, -4.7648653472746485, 0.18535270878194157, -18.095225981889627, 51.69519063240084, 49.83502222078437, -170.76862911114813, -5.557713873879569, -66.81555116799296, -95.85859609247005, 31.733076674038422, -17.744047184029828, -142.84075136574617, 46.02576341065637, -151.56305954155604, 16.437923190481428, -175.23092216664605, -203.3349968778846, -283.59296857637594, -138.5438066715401, -113.38619076291096, -113.90562045732135, 61.885613507179976, -210.5006578654884, 26.25351214828313, -59.56688279851364, 52.15089161453428, -145.0962112636828, -67.70072349538303, -19.34196995015486, -157.05708698682128, 3.874170560015828, 91.5089537379035, -90.31681957906343, -40.69157357324807, -162.46624796416737, -53.740838663998616, -7.907944718852713, -408.7653440913074, 19.043621383547013, 120.20552304147117, -35.96951657907167, -62.082641200625204, -97.16113233069477, 55.10000000000021, -21.190389809590222, -96.80491266863345, -197.45773668716822, -104.20227174141242, -78.519074742448, -234.77569124619518, -204.36152307406672, -48.22109974702376, -9.409983871339636, -49.319486448915264, 12.779386099934978, -51.342484850471145, -16.46236006859254, -50.62856104669679, -8.81732954805872, -167.92212816100113, -89.19902866077965, -47.82215034265346, 121.66697840110018, -23.433575622500392, -127.5788360091594, -44.48510955081267, -78.68624587420614, 2.0635429505765295, -137.3569655064323, 15.791865206773439, 83.91935510147366, -45.0503515538295, 81.32518921852026, -225.10805294987688, 65.95408350540589, 16.66458493653722, 41.509678626249034, 64.76036560143604, -4.841532581081054, 189.47772331798367, 175.74298787758465, 57.15122539693459, -47.614143561122475, 5.15165323927501, -43.64290727097154, -16.518665395131766, 45.094321108390375, -69.21794303660312, 6.907587632448296, 124.79541184345317, -69.48182870168893, -252.2799282357825, 44.11874529365975, 72.447841023602, -68.31854890865885, 93.76559993023193, 6.118402437593822, 20.000000000000014, -168.2916955492725, 61.40195735719233, 128.4579367850899, -92.43970243447232, 171.69396833862314, -1.2357703587698445, 16.73452640748599, -153.8465409118023, -48.74258656266246, 143.61621207506693, 166.9139177719893, -51.91975671216177, 145.00022457819006, 28.485079718589827, -4.859475325065081, -70.09215012898555, 98.22097518230461, 35.64065972402372, -9.739515875690188, -24.08374238518094, -55.00564708897136, -134.80647618738197, 28.415681616281514, 101.6486385493613, -3.342480072550338, -42.47343808492554, 64.38279681607796, 108.23720874014671, 11.588116458799218, 71.39023875995464, -169.3232763619567, -44.90306120649606, 146.73685691420178, -8.288166284733581, 111.66467108859567, 54.51036514431698, 28.180252136027573, -37.28319890420871, 95.21169755956943, 63.279931992570546, -18.90905400258046, 137.35847274341046, 76.76369137004343, -139.88159107450164, 90.75456878483294, -28.883815577866425, -74.10208386111711, 165.68636178629558, -92.16157402258838, -2.4946485678225514, -167.9704230960647, 40.347733865233366, -209.3912792018367, -54.41937306825774, 110.72931941711022, -143.1277568683933, -109.28516693934786, -12.473371390479283, 133.6054603994757, 20.000000000000014, 68.43992116767916, -5.303798799086449, 36.52484294049671, -144.99468482398447, 17.88907265917681, 43.20917598898251, -43.78447825376989, -61.827726140692775, -31.57594194515928, 15.5093470328874, -63.265350548935245, 148.87459444001342, 159.06655428888774, -34.751394425507286, 41.18180891885792, -28.478359909071074, 92.00000000000007, -140.91947130677335, 2.4836483676110035, -43.39647016175148, -152.5751222629319, -289.42317991995594, -250.79432760811693, -10.251256568345521, 35.60700161030245, -148.45663025219707, -0.2394108507451342, -8.176331252510792, -51.25069521444561, -8.790043442326898, -23.433138346537397, -29.116827360358428, -33.474667278185926, -36.42529524915616, -84.55792986513923, 111.37241926504842, 21.459438096034283, -32.59221533726984], "policy_predator_policy_reward": [148.79404938883684, 185.2320196044266, 85.81595697160327, 35.75458434212261, 23.364865347274712, 118.91464729121807, 42.7474601451349, 31.682895688085065, 66.19769931159556, 180.55275668659806, 100.0577138738794, 143.21555116799283, 131.58731367712238, 63.59028615146769, 36.66027176106126, 180.74075136574572, 13.07423658934361, 179.66305954155553, 42.26207680951854, 257.43092216664587, 272.0301712866084, 283.57751453970815, 178.37965020143048, 148.57832802581143, 166.8854149449069, 9.999094366213857, 276.7823792890667, 6.2781996153857955, 71.96850181605375, 23.547489367925916, 156.49621126368217, 119.10072349538292, 73.94196995015491, 231.05708698682128, 54.63286790902086, 44.484007793059845, 123.16204696892054, 84.90114266009375, 153.6020514714903, 213.97357547723553, 264.1941614954396, 296.81033793084583, 29.15637861645306, 37.394476958528806, 152.76317122412516, 48.60185384331108, 111.16113233069402, 0.0, 46.09038980959046, 160.10491266863357, 190.1832143068537, 177.88106433397957, 123.04913587250167, 283.9253027847877, 182.81280057080286, 200.2888524293113, 40.9514520771819, 123.04350280347441, 45.00282389692551, 128.74973340474654, 126.38255945630245, 152.60955699491583, 118.12040622556673, 258.20969804597394, 67.60949642677282, 179.33393544259056, 17.495891110680546, 52.7707061107199, 97.15179032289197, 107.48557290524701, 109.28624587420613, 21.436457049423456, 150.45696550643186, 103.30813479322656, 60.680644898526374, 76.45035155382965, 14.674810781479765, 263.1080529498775, 69.38324395185145, 43.755766703674745, 39.690321373751104, 5.039634398564104, 29.722399575229666, 2.641409687867806, 9.730705651157166, 43.57508107432366, 141.27651876251312, 19.91421094578647, 20.57022851590186, 162.442757318363, 156.09945526841136, 1.6450110937879059, 37.470210460368186, 38.33183724597386, 108.8983071780731, 232.90138097136747, 8.579019643869158, 17.654394038869142, 104.80554660269459, 25.147402375732312, 35.081597562406266, 0.0, 180.19169554927183, 23.098042642807744, 57.14682440164057, 92.4346946097559, 16.306031661376856, 47.835770358769956, 0.0, 168.2778958490172, 42.27806663471721, 50.47058784168676, 110.14863868883319, 43.87113763339435, 18.6484425441016, 27.856263063299323, 77.17993386610625, 59.32169039585023, 47.8790248176954, 6.464304214627004, 30.095452953112027, 75.62780530775926, 212.21921966027057, 68.17953667785444, 16.637342040400398, 38.24571591887395, 3.7413782481953635, 164.97453990928054, 12.317203183922171, 32.06279125985327, 19.699582297476336, 2.722062483769926, 73.01317763683313, 280.76596367095925, 25.63553002609811, 6.215779344433495, 27.199736871879413, 4.741813023323053, 47.09134841836282, 13.311598349818414, 20.160413083224334, 75.64795736463527, 44.90905400258056, 20.241527256589453, 19.07837242151047, 167.5815910745011, 22.34543121516706, 90.28381557786648, 60.305109327951435, 65.31617296089394, 49.612148791166945, 105.39840196780018, 241.4235725897268, 73.96900535138694, 238.79542650774087, 56.16783901654805, 90.35783828568286, 152.73438137350638, 123.7851919794253, 34.029933565066564, 0.9350944297327928, 3.0945396005239294, 14.460078832320795, 28.403798799086502, 16.08071318670401, 204.09641298153534, 88.06538283364614, 14.43636851819463, 38.51720360057743, 173.5457413734501, 50.569264826880584, 75.233308288804, 102.89957273023903, 13.491183378682504, 44.17773952920156, 66.07945860941354, 34.178729153250224, 69.90479903303599, 18.784743235699704, 137.8529181804986, 78.56209055838472, 75.25073123575574, 156.25415038113638, 380.83040765748086, 216.80194900062995, 144.07535115025578, 50.50754412814106, 208.94472104090383, 25.55498149103448, 123.37633125251067, 114.74808965343811, 45.70860862252173, 45.83873088895858, 69.1034519100725, 112.27152512505334, 3.419515540981131, 75.71083102386372, 93.88095315020996, 16.892874797813008, 56.63990244342272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.804234991405493, "mean_inference_ms": 6.839196829610999, "mean_action_processing_ms": 3.7834180378861264, "mean_env_wait_ms": 12.712178081112762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004678845405578613, "StateBufferConnector_ms": 0.022129416465759277, "ViewRequirementAgentConnector_ms": 0.21351242065429688}, "num_episodes": 0, "episode_return_max": 286.19999999999993, "episode_return_min": 20.037931211970218, "episode_return_mean": 131.2692513540919, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.1394731753227, "num_env_steps_trained_throughput_per_sec": 84.1394731753227, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 52504.142, "restore_workers_time_ms": 0.057, "training_step_time_ms": 52503.93, "sample_time_ms": 3715.594, "learn_time_ms": 48762.875, "learn_throughput": 82.03, "synch_weights_time_ms": 20.83}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-28-24", "timestamp": 1724147904, "time_this_iter_s": 47.57348418235779, "time_total_s": 472.86677145957947, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33132b0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 472.86677145957947, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 25.8865671641791, "ram_util_percent": 82.41641791044776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.621727529972318, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.973634038904987, "policy_loss": -0.024612604205067907, "vf_loss": 7.995710466273878, "vf_explained_var": 0.3445317479037734, "kl": 0.012680821689387793, "entropy": 1.4510041948348757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999993}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7703315002577646, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.483293134951718, "policy_loss": -0.024241143887832998, "vf_loss": 4.5042344891835775, "vf_explained_var": 0.13469906149717867, "kl": 0.016499028821283627, "entropy": 1.4160920253506413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999993}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 286.19999999999993, "episode_reward_min": -47.48862742448857, "episode_reward_mean": 142.39917912072443, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -318.1899103619439, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.47772331798367, "predator_policy": 481.0769941885921}, "policy_reward_mean": {"prey_policy": -14.240063353469678, "predator_policy": 85.43965291383199}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.10000000000004, 88.1999999999996, 66.40427021225342, 93.67967266864659, 130.5190301790228, 105.26548456040034, 135.18945855113608, 211.90119533592892, 199.59064656248006, 109.92225286593083, 168.4999999999993, 32.573417668167515, 54.100000000000215, 132.1999999999997, 175.99999999999974, 133.99999999999983, 195.75767909746926, 150.9999999999992, 216.99999999999935, 286.19999999999993, 118.72823938645196, 122.85141316816066, 133.6208444339866, 207.50504718224275, 20.037931211970218, 142.79999999999978, 155.39999999999964, 61.200000000000216, 96.40000000000006, 185.59975336201396, 234.59999999999948, 31.165881344701848, 187.62227998880763, 269.0139373820551, 219.9900099041803, 61.549998807906256, 188.20496393865037, 71.90000000000035, 90.5866330617722, 184.9473781249168, 122.89999999999927, 216.99999999999937, 105.40000000000008, 139.5528037393398, 170.29999999999902, 198.11658612811442, 51.30000000000031, 254.29999999999941, 183.59999999999945, 123.54206379155379, 174.50000000000017, 217.20556021402385, 60.35432816855618, 187.76988871028283, 31.15261325419445, 210.69378220790583, 36.05658721466475, 157.63509442973168, 105.99999999999994, 111.70728428475104, 163.5999999999993, 106.45074057956445, 109.73597820341162, 201.99999999999955, 234.57235800199467, 116.78697719607271, 107.7181901094251, 112.89999999999986, 95.08625585572872, 99.83171597442339, 146.60263652714983, 140.51557064028898, 100.41595961918665, 62.392217092135226, 45.791078138692505, 196.406273573983, 62.40000000000035, -47.48862742448857, 239.09999999999974, 194.69999999999993, 170.91866561330883, 133.50173092248636, 198.90433291726825, 233.6543847745329, 171.1941330627676, 225.05335723103113, 247.0247504766852, 87.45971562101934, 149.11212802739158, 200.27089548110405, 105.88031196495095, 161.45674319042868, 212.39999999999992, 137.8359728575655, 123.09519290653294, 171.3342655487065, 96.50000000000001, 172.43401845607085, 124.21746397512337, 228.2385138155379], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-97.16113233069477, 55.10000000000021, -21.190389809590222, -96.80491266863345, -197.45773668716822, -104.20227174141242, -78.519074742448, -234.77569124619518, -204.36152307406672, -48.22109974702376, -9.409983871339636, -49.319486448915264, 12.779386099934978, -51.342484850471145, -16.46236006859254, -50.62856104669679, -8.81732954805872, -167.92212816100113, -89.19902866077965, -47.82215034265346, 121.66697840110018, -23.433575622500392, -127.5788360091594, -44.48510955081267, -78.68624587420614, 2.0635429505765295, -137.3569655064323, 15.791865206773439, 83.91935510147366, -45.0503515538295, 81.32518921852026, -225.10805294987688, 65.95408350540589, 16.66458493653722, 41.509678626249034, 64.76036560143604, -4.841532581081054, 189.47772331798367, 175.74298787758465, 57.15122539693459, -47.614143561122475, 5.15165323927501, -43.64290727097154, -16.518665395131766, 45.094321108390375, -69.21794303660312, 6.907587632448296, 124.79541184345317, -69.48182870168893, -252.2799282357825, 44.11874529365975, 72.447841023602, -68.31854890865885, 93.76559993023193, 6.118402437593822, 20.000000000000014, -168.2916955492725, 61.40195735719233, 128.4579367850899, -92.43970243447232, 171.69396833862314, -1.2357703587698445, 16.73452640748599, -153.8465409118023, -48.74258656266246, 143.61621207506693, 166.9139177719893, -51.91975671216177, 145.00022457819006, 28.485079718589827, -4.859475325065081, -70.09215012898555, 98.22097518230461, 35.64065972402372, -9.739515875690188, -24.08374238518094, -55.00564708897136, -134.80647618738197, 28.415681616281514, 101.6486385493613, -3.342480072550338, -42.47343808492554, 64.38279681607796, 108.23720874014671, 11.588116458799218, 71.39023875995464, -169.3232763619567, -44.90306120649606, 146.73685691420178, -8.288166284733581, 111.66467108859567, 54.51036514431698, 28.180252136027573, -37.28319890420871, 95.21169755956943, 63.279931992570546, -18.90905400258046, 137.35847274341046, 76.76369137004343, -139.88159107450164, 90.75456878483294, -28.883815577866425, -74.10208386111711, 165.68636178629558, -92.16157402258838, -2.4946485678225514, -167.9704230960647, 40.347733865233366, -209.3912792018367, -54.41937306825774, 110.72931941711022, -143.1277568683933, -109.28516693934786, -12.473371390479283, 133.6054603994757, 20.000000000000014, 68.43992116767916, -5.303798799086449, 36.52484294049671, -144.99468482398447, 17.88907265917681, 43.20917598898251, -43.78447825376989, -61.827726140692775, -31.57594194515928, 15.5093470328874, -63.265350548935245, 148.87459444001342, 159.06655428888774, -34.751394425507286, 41.18180891885792, -28.478359909071074, 92.00000000000007, -140.91947130677335, 2.4836483676110035, -43.39647016175148, -152.5751222629319, -289.42317991995594, -250.79432760811693, -10.251256568345521, 35.60700161030245, -148.45663025219707, -0.2394108507451342, -8.176331252510792, -51.25069521444561, -8.790043442326898, -23.433138346537397, -29.116827360358428, -33.474667278185926, -36.42529524915616, -84.55792986513923, 111.37241926504842, 21.459438096034283, -32.59221533726984, -318.1899103619439, -309.91163847861844, 117.87898590299469, -16.694237891586525, 73.44636800446693, -22.01993467440912, -130.97860800988872, 92.84321635400721, 61.75541624628568, -11.018650223753042, -238.0050887411006, 88.04916808736972, 64.41982225707365, 80.54538150117781, 24.00000701501628, -9.28740309225361, 71.0158433291008, -31.43132261346702, -33.75070931558784, 166.40914207914966, 9.569332441068047, -47.534765748441636, -107.86383607993129, 39.75335415557482, -188.71667784241174, 102.48073409996232, 17.779556761180913, -113.89921258380377, -26.88915998554167, -23.797636654667087, 64.39361657978404, 97.00676431828416, 69.6739982710369, -195.12097914613977, -3.3521377250668114, -12.526394887624944, -45.13979469221425, 106.99266511632776, -28.679767401011496, 38.884216658052225, 24.934520135628418, -63.487218048966824, -204.82370434749785, -58.62458141309733, -262.5996131409916, 150.7798725192317], "policy_predator_policy_reward": [111.16113233069402, 0.0, 46.09038980959046, 160.10491266863357, 190.1832143068537, 177.88106433397957, 123.04913587250167, 283.9253027847877, 182.81280057080286, 200.2888524293113, 40.9514520771819, 123.04350280347441, 45.00282389692551, 128.74973340474654, 126.38255945630245, 152.60955699491583, 118.12040622556673, 258.20969804597394, 67.60949642677282, 179.33393544259056, 17.495891110680546, 52.7707061107199, 97.15179032289197, 107.48557290524701, 109.28624587420613, 21.436457049423456, 150.45696550643186, 103.30813479322656, 60.680644898526374, 76.45035155382965, 14.674810781479765, 263.1080529498775, 69.38324395185145, 43.755766703674745, 39.690321373751104, 5.039634398564104, 29.722399575229666, 2.641409687867806, 9.730705651157166, 43.57508107432366, 141.27651876251312, 19.91421094578647, 20.57022851590186, 162.442757318363, 156.09945526841136, 1.6450110937879059, 37.470210460368186, 38.33183724597386, 108.8983071780731, 232.90138097136747, 8.579019643869158, 17.654394038869142, 104.80554660269459, 25.147402375732312, 35.081597562406266, 0.0, 180.19169554927183, 23.098042642807744, 57.14682440164057, 92.4346946097559, 16.306031661376856, 47.835770358769956, 0.0, 168.2778958490172, 42.27806663471721, 50.47058784168676, 110.14863868883319, 43.87113763339435, 18.6484425441016, 27.856263063299323, 77.17993386610625, 59.32169039585023, 47.8790248176954, 6.464304214627004, 30.095452953112027, 75.62780530775926, 212.21921966027057, 68.17953667785444, 16.637342040400398, 38.24571591887395, 3.7413782481953635, 164.97453990928054, 12.317203183922171, 32.06279125985327, 19.699582297476336, 2.722062483769926, 73.01317763683313, 280.76596367095925, 25.63553002609811, 6.215779344433495, 27.199736871879413, 4.741813023323053, 47.09134841836282, 13.311598349818414, 20.160413083224334, 75.64795736463527, 44.90905400258056, 20.241527256589453, 19.07837242151047, 167.5815910745011, 22.34543121516706, 90.28381557786648, 60.305109327951435, 65.31617296089394, 49.612148791166945, 105.39840196780018, 241.4235725897268, 73.96900535138694, 238.79542650774087, 56.16783901654805, 90.35783828568286, 152.73438137350638, 123.7851919794253, 34.029933565066564, 0.9350944297327928, 3.0945396005239294, 14.460078832320795, 28.403798799086502, 16.08071318670401, 204.09641298153534, 88.06538283364614, 14.43636851819463, 38.51720360057743, 173.5457413734501, 50.569264826880584, 75.233308288804, 102.89957273023903, 13.491183378682504, 44.17773952920156, 66.07945860941354, 34.178729153250224, 69.90479903303599, 18.784743235699704, 137.8529181804986, 78.56209055838472, 75.25073123575574, 156.25415038113638, 380.83040765748086, 216.80194900062995, 144.07535115025578, 50.50754412814106, 208.94472104090383, 25.55498149103448, 123.37633125251067, 114.74808965343811, 45.70860862252173, 45.83873088895858, 69.1034519100725, 112.27152512505334, 3.419515540981131, 75.71083102386372, 93.88095315020996, 16.892874797813008, 56.63990244342272, 99.53592722748125, 481.0769941885921, 40.34053150116937, 97.5747204874222, 141.45483579676812, 1.818730873174061, 14.907168621245933, 194.14688864794454, 14.634611468460212, 68.13035343149373, 271.9093799329456, 76.95087363805337, 68.54202145924334, 20.14715955703852, 109.91398932798694, 46.56753981201808, 128.75599525756178, 56.71284125783579, 19.13461112801168, 95.23170658511194, 123.17992212867817, 2.2452267997156037, 179.9598653829975, 37.26274456875069, 177.07889212727622, 109.42794709627759, 117.12142012336527, 84.87854766420817, 100.90802974346293, 111.23551008717479, 13.006383420215945, 37.993235681715866, 158.62483203728488, 104.65812169538304, 125.33744291591084, 13.636282603314445, 31.262463724859735, 78.21893139973405, 12.945229503622292, 73.35032123933713, 54.15570150740142, 156.83101486200806, 294.4810532880711, 93.18469644764774, 232.99866897552212, 107.05958546177581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.24208555548965, "mean_inference_ms": 6.229212039002763, "mean_action_processing_ms": 4.022967094202988, "mean_env_wait_ms": 11.896310639427833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036672353744506836, "StateBufferConnector_ms": 0.02168142795562744, "ViewRequirementAgentConnector_ms": 0.14523017406463623}, "num_episodes": 23, "episode_return_max": 286.19999999999993, "episode_return_min": -47.48862742448857, "episode_return_mean": 142.39917912072443, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.92030647739527, "num_env_steps_trained_throughput_per_sec": 83.92030647739527, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 52020.155, "restore_workers_time_ms": 0.052, "training_step_time_ms": 52019.959, "sample_time_ms": 3557.456, "learn_time_ms": 48437.498, "learn_throughput": 82.581, "synch_weights_time_ms": 20.109}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-29-12", "timestamp": 1724147952, "time_this_iter_s": 47.684017181396484, "time_total_s": 520.550788640976, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33133b040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 520.550788640976, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 26.10735294117647, "ram_util_percent": 83.0720588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.474522176810673, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.864196545989425, "policy_loss": -0.02446925169480324, "vf_loss": 7.885995139520635, "vf_explained_var": 0.40419138351445477, "kl": 0.013353345309329964, "entropy": 1.383275581036926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.77113830166519, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.017108178517175, "policy_loss": -0.020799968356670685, "vf_loss": 5.035069798161744, "vf_explained_var": 0.15086653201037614, "kl": 0.014191737409099622, "entropy": 1.3562172834204618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 342.41771734497866, "episode_reward_min": -47.48862742448857, "episode_reward_mean": 155.86830103432433, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -318.1899103619439, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.11771734497864, "predator_policy": 481.0769941885921}, "policy_reward_mean": {"prey_policy": -10.106995702419397, "predator_policy": 88.04114621958165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.549998807906256, 188.20496393865037, 71.90000000000035, 90.5866330617722, 184.9473781249168, 122.89999999999927, 216.99999999999937, 105.40000000000008, 139.5528037393398, 170.29999999999902, 198.11658612811442, 51.30000000000031, 254.29999999999941, 183.59999999999945, 123.54206379155379, 174.50000000000017, 217.20556021402385, 60.35432816855618, 187.76988871028283, 31.15261325419445, 210.69378220790583, 36.05658721466475, 157.63509442973168, 105.99999999999994, 111.70728428475104, 163.5999999999993, 106.45074057956445, 109.73597820341162, 201.99999999999955, 234.57235800199467, 116.78697719607271, 107.7181901094251, 112.89999999999986, 95.08625585572872, 99.83171597442339, 146.60263652714983, 140.51557064028898, 100.41595961918665, 62.392217092135226, 45.791078138692505, 196.406273573983, 62.40000000000035, -47.48862742448857, 239.09999999999974, 194.69999999999993, 170.91866561330883, 133.50173092248636, 198.90433291726825, 233.6543847745329, 171.1941330627676, 225.05335723103113, 247.0247504766852, 87.45971562101934, 149.11212802739158, 200.27089548110405, 105.88031196495095, 161.45674319042868, 212.39999999999992, 137.8359728575655, 123.09519290653294, 171.3342655487065, 96.50000000000001, 172.43401845607085, 124.21746397512337, 228.2385138155379, 166.17974936192311, 176.1816783243056, 184.03270606418664, 97.38223281971824, 289.1369779833198, 342.41771734497866, 128.21509301034104, 201.00112123461747, 117.54222745762159, 261.79768327344203, 50.587969785553966, 113.21469075816796, 127.04662351002177, 136.40738968535194, 244.244891538254, 122.33653047932039, 130.56860243700007, 163.0092681294324, 266.18311646215534, 167.15751847092355, 265.9324630115089, 165.2847774892407, 167.10604491914336, 177.19001086283416, 146.03048137381296, 160.6999999999999, 214.729875309036, 34.300000000000225, 278.1, 81.20000000000003, 196.82200793981534, 297.59999999999997, 217.58151079517754, 213.6397507465056, 189.68992584828348], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.859475325065081, -70.09215012898555, 98.22097518230461, 35.64065972402372, -9.739515875690188, -24.08374238518094, -55.00564708897136, -134.80647618738197, 28.415681616281514, 101.6486385493613, -3.342480072550338, -42.47343808492554, 64.38279681607796, 108.23720874014671, 11.588116458799218, 71.39023875995464, -169.3232763619567, -44.90306120649606, 146.73685691420178, -8.288166284733581, 111.66467108859567, 54.51036514431698, 28.180252136027573, -37.28319890420871, 95.21169755956943, 63.279931992570546, -18.90905400258046, 137.35847274341046, 76.76369137004343, -139.88159107450164, 90.75456878483294, -28.883815577866425, -74.10208386111711, 165.68636178629558, -92.16157402258838, -2.4946485678225514, -167.9704230960647, 40.347733865233366, -209.3912792018367, -54.41937306825774, 110.72931941711022, -143.1277568683933, -109.28516693934786, -12.473371390479283, 133.6054603994757, 20.000000000000014, 68.43992116767916, -5.303798799086449, 36.52484294049671, -144.99468482398447, 17.88907265917681, 43.20917598898251, -43.78447825376989, -61.827726140692775, -31.57594194515928, 15.5093470328874, -63.265350548935245, 148.87459444001342, 159.06655428888774, -34.751394425507286, 41.18180891885792, -28.478359909071074, 92.00000000000007, -140.91947130677335, 2.4836483676110035, -43.39647016175148, -152.5751222629319, -289.42317991995594, -250.79432760811693, -10.251256568345521, 35.60700161030245, -148.45663025219707, -0.2394108507451342, -8.176331252510792, -51.25069521444561, -8.790043442326898, -23.433138346537397, -29.116827360358428, -33.474667278185926, -36.42529524915616, -84.55792986513923, 111.37241926504842, 21.459438096034283, -32.59221533726984, -318.1899103619439, -309.91163847861844, 117.87898590299469, -16.694237891586525, 73.44636800446693, -22.01993467440912, -130.97860800988872, 92.84321635400721, 61.75541624628568, -11.018650223753042, -238.0050887411006, 88.04916808736972, 64.41982225707365, 80.54538150117781, 24.00000701501628, -9.28740309225361, 71.0158433291008, -31.43132261346702, -33.75070931558784, 166.40914207914966, 9.569332441068047, -47.534765748441636, -107.86383607993129, 39.75335415557482, -188.71667784241174, 102.48073409996232, 17.779556761180913, -113.89921258380377, -26.88915998554167, -23.797636654667087, 64.39361657978404, 97.00676431828416, 69.6739982710369, -195.12097914613977, -3.3521377250668114, -12.526394887624944, -45.13979469221425, 106.99266511632776, -28.679767401011496, 38.884216658052225, 24.934520135628418, -63.487218048966824, -204.82370434749785, -58.62458141309733, -262.5996131409916, 150.7798725192317, -0.32807112971256913, -25.55624675885867, -14.471553464434509, 105.10663318107781, 51.032498304997574, -50.07339862023511, -86.80294694916431, -4.467961874014284, 77.54566574930297, 70.15595242376835, 75.77021393489268, 190.11771734497864, -11.30828109339797, 71.70874383422857, 76.98654129944165, -243.99204303921243, 38.774554859184605, -63.30528912755173, 43.754202329672495, 79.42972584977443, -258.9164066903889, -6.070507279332627, -69.68372170840166, -19.632948889855516, -23.10686031470309, -2.5826564946531683, -84.53920099012353, -4.811174057895997, -45.57044948450712, 107.23035294041881, -258.0119803409695, -20.41441888533864, -144.8134778996499, -36.19909746341668, 32.677949145597104, -13.767737851488835, 111.33186105631219, 42.7253045181752, -116.95319223737668, 79.98850092264858, 87.98345477854343, 95.84733817826347, 75.89476600549357, -62.816397764224604, 64.4233853766129, -226.053823888586, 53.067821545031904, -201.65263150210413, -46.83943599400024, -116.82177836580496, 106.50551647833063, -102.75279816258464, 134.18234856945662, -11.247217694438582, -146.36135355727578, -33.490570701043204, 92.28175346455212, -48.45778482282406, -65.94443794713997, 17.151691695626806, 52.48948445462587, 45.75794160912258, 86.40067484251946, 147.71967665777242, -1.366276286083381, 25.679199429985832, -19.571595392800965, 60.071546991997806, -21.563120583395403, 58.04167719329094], "policy_predator_policy_reward": [77.17993386610625, 59.32169039585023, 47.8790248176954, 6.464304214627004, 30.095452953112027, 75.62780530775926, 212.21921966027057, 68.17953667785444, 16.637342040400398, 38.24571591887395, 3.7413782481953635, 164.97453990928054, 12.317203183922171, 32.06279125985327, 19.699582297476336, 2.722062483769926, 73.01317763683313, 280.76596367095925, 25.63553002609811, 6.215779344433495, 27.199736871879413, 4.741813023323053, 47.09134841836282, 13.311598349818414, 20.160413083224334, 75.64795736463527, 44.90905400258056, 20.241527256589453, 19.07837242151047, 167.5815910745011, 22.34543121516706, 90.28381557786648, 60.305109327951435, 65.31617296089394, 49.612148791166945, 105.39840196780018, 241.4235725897268, 73.96900535138694, 238.79542650774087, 56.16783901654805, 90.35783828568286, 152.73438137350638, 123.7851919794253, 34.029933565066564, 0.9350944297327928, 3.0945396005239294, 14.460078832320795, 28.403798799086502, 16.08071318670401, 204.09641298153534, 88.06538283364614, 14.43636851819463, 38.51720360057743, 173.5457413734501, 50.569264826880584, 75.233308288804, 102.89957273023903, 13.491183378682504, 44.17773952920156, 66.07945860941354, 34.178729153250224, 69.90479903303599, 18.784743235699704, 137.8529181804986, 78.56209055838472, 75.25073123575574, 156.25415038113638, 380.83040765748086, 216.80194900062995, 144.07535115025578, 50.50754412814106, 208.94472104090383, 25.55498149103448, 123.37633125251067, 114.74808965343811, 45.70860862252173, 45.83873088895858, 69.1034519100725, 112.27152512505334, 3.419515540981131, 75.71083102386372, 93.88095315020996, 16.892874797813008, 56.63990244342272, 99.53592722748125, 481.0769941885921, 40.34053150116937, 97.5747204874222, 141.45483579676812, 1.818730873174061, 14.907168621245933, 194.14688864794454, 14.634611468460212, 68.13035343149373, 271.9093799329456, 76.95087363805337, 68.54202145924334, 20.14715955703852, 109.91398932798694, 46.56753981201808, 128.75599525756178, 56.71284125783579, 19.13461112801168, 95.23170658511194, 123.17992212867817, 2.2452267997156037, 179.9598653829975, 37.26274456875069, 177.07889212727622, 109.42794709627759, 117.12142012336527, 84.87854766420817, 100.90802974346293, 111.23551008717479, 13.006383420215945, 37.993235681715866, 158.62483203728488, 104.65812169538304, 125.33744291591084, 13.636282603314445, 31.262463724859735, 78.21893139973405, 12.945229503622292, 73.35032123933713, 54.15570150740142, 156.83101486200806, 294.4810532880711, 93.18469644764774, 232.99866897552212, 107.05958546177581, 145.06462972110674, 46.999437529387144, 71.39986193159272, 14.146736676070152, 58.91073029680121, 124.16287608262361, 61.87122321795271, 126.78191842494422, 94.8259420886597, 46.60941772158873, 76.52978606510727, 0.0, 33.12337410373922, 34.691256165771435, 244.66693195337123, 123.3396910210172, 14.755799306149413, 127.31716241983935, 86.1441477004322, 52.469607393562896, 267.81565213632126, 47.75923161895594, 136.25882371506668, 66.27253764135976, 101.50158084022334, 51.234559479155116, 184.58313336743657, 41.174631365934616, 63.95362559799982, 118.63136248434228, 175.03824824165102, 225.72468146397728, 159.343927276684, 152.2372505233824, 48.86454926809065, 95.23450756723349, 54.33126425553917, 57.794686632128716, 28.873834605233892, 175.24837518041818, 39.785225365913654, 42.31644468878865, 21.49652639794631, 130.70988285002517, 52.09762046906792, 276.6388629620485, 124.51373313755826, 201.26108768234815, 236.88771427188576, 72.80398146173192, 125.47446552301298, 31.472816161240797, 22.639353582820913, 69.1553908511974, 164.46135355727537, 49.690570701043434, 54.04834497457629, 180.22768638369567, 118.21566126633948, 11.777084985173309, 60.567541282013465, 38.00704059405387, 61.79932515748057, 1.680323342227584, 104.0028233185017, 89.26576433277333, 58.47338977074545, 114.6664093765637, 38.39927826777734, 114.81209097061101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.728382298205236, "mean_inference_ms": 5.6938698491260995, "mean_action_processing_ms": 3.6153911959370943, "mean_env_wait_ms": 11.527400757737796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003548264503479004, "StateBufferConnector_ms": 0.021456480026245117, "ViewRequirementAgentConnector_ms": 0.12472379207611084}, "num_episodes": 35, "episode_return_max": 342.41771734497866, "episode_return_min": -47.48862742448857, "episode_return_mean": 155.86830103432433, "episodes_this_iter": 35}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.30091522779018, "num_env_steps_trained_throughput_per_sec": 83.30091522779018, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 51160.455, "restore_workers_time_ms": 0.02, "training_step_time_ms": 51160.391, "sample_time_ms": 2981.831, "learn_time_ms": 48152.459, "learn_throughput": 83.069, "synch_weights_time_ms": 20.437}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-30-00", "timestamp": 1724148000, "time_this_iter_s": 48.04914689064026, "time_total_s": 568.5999355316162, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x172352940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 568.5999355316162, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 26.72941176470588, "ram_util_percent": 82.48529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.687790162538095, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.59711094331489, "policy_loss": -0.022207617000110015, "vf_loss": 7.616629821282846, "vf_explained_var": 0.3914080796733735, "kl": 0.013443720015258622, "entropy": 1.3723393133708408, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9092022760519907, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.741363425860329, "policy_loss": -0.022646131908900483, "vf_loss": 4.7608759898988025, "vf_explained_var": 0.17157831901595705, "kl": 0.01566785156810607, "entropy": 1.350013984574212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 342.41771734497866, "episode_reward_min": -47.48862742448857, "episode_reward_mean": 161.0552244387471, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -318.1899103619439, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.11771734497864, "predator_policy": 481.0769941885921}, "policy_reward_mean": {"prey_policy": -13.253933799680786, "predator_policy": 93.7815460190544}, "custom_metrics": {}, "hist_stats": {"episode_reward": [123.54206379155379, 174.50000000000017, 217.20556021402385, 60.35432816855618, 187.76988871028283, 31.15261325419445, 210.69378220790583, 36.05658721466475, 157.63509442973168, 105.99999999999994, 111.70728428475104, 163.5999999999993, 106.45074057956445, 109.73597820341162, 201.99999999999955, 234.57235800199467, 116.78697719607271, 107.7181901094251, 112.89999999999986, 95.08625585572872, 99.83171597442339, 146.60263652714983, 140.51557064028898, 100.41595961918665, 62.392217092135226, 45.791078138692505, 196.406273573983, 62.40000000000035, -47.48862742448857, 239.09999999999974, 194.69999999999993, 170.91866561330883, 133.50173092248636, 198.90433291726825, 233.6543847745329, 171.1941330627676, 225.05335723103113, 247.0247504766852, 87.45971562101934, 149.11212802739158, 200.27089548110405, 105.88031196495095, 161.45674319042868, 212.39999999999992, 137.8359728575655, 123.09519290653294, 171.3342655487065, 96.50000000000001, 172.43401845607085, 124.21746397512337, 228.2385138155379, 166.17974936192311, 176.1816783243056, 184.03270606418664, 97.38223281971824, 289.1369779833198, 342.41771734497866, 128.21509301034104, 201.00112123461747, 117.54222745762159, 261.79768327344203, 50.587969785553966, 113.21469075816796, 127.04662351002177, 136.40738968535194, 244.244891538254, 122.33653047932039, 130.56860243700007, 163.0092681294324, 266.18311646215534, 167.15751847092355, 265.9324630115089, 165.2847774892407, 167.10604491914336, 177.19001086283416, 146.03048137381296, 160.6999999999999, 214.729875309036, 34.300000000000225, 278.1, 81.20000000000003, 196.82200793981534, 297.59999999999997, 217.58151079517754, 213.6397507465056, 189.68992584828348, 108.75142785414414, 168.3999999999997, 191.98912843847856, 222.79999999999964, 144.88460680504235, 151.00014750140625, 188.24288273039028, 177.63384335174587, 305.2663416812256, 151.22797934872023, 191.5980735150857, 188.251049678634, 152.2558203618665, 216.04940297623403], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [76.76369137004343, -139.88159107450164, 90.75456878483294, -28.883815577866425, -74.10208386111711, 165.68636178629558, -92.16157402258838, -2.4946485678225514, -167.9704230960647, 40.347733865233366, -209.3912792018367, -54.41937306825774, 110.72931941711022, -143.1277568683933, -109.28516693934786, -12.473371390479283, 133.6054603994757, 20.000000000000014, 68.43992116767916, -5.303798799086449, 36.52484294049671, -144.99468482398447, 17.88907265917681, 43.20917598898251, -43.78447825376989, -61.827726140692775, -31.57594194515928, 15.5093470328874, -63.265350548935245, 148.87459444001342, 159.06655428888774, -34.751394425507286, 41.18180891885792, -28.478359909071074, 92.00000000000007, -140.91947130677335, 2.4836483676110035, -43.39647016175148, -152.5751222629319, -289.42317991995594, -250.79432760811693, -10.251256568345521, 35.60700161030245, -148.45663025219707, -0.2394108507451342, -8.176331252510792, -51.25069521444561, -8.790043442326898, -23.433138346537397, -29.116827360358428, -33.474667278185926, -36.42529524915616, -84.55792986513923, 111.37241926504842, 21.459438096034283, -32.59221533726984, -318.1899103619439, -309.91163847861844, 117.87898590299469, -16.694237891586525, 73.44636800446693, -22.01993467440912, -130.97860800988872, 92.84321635400721, 61.75541624628568, -11.018650223753042, -238.0050887411006, 88.04916808736972, 64.41982225707365, 80.54538150117781, 24.00000701501628, -9.28740309225361, 71.0158433291008, -31.43132261346702, -33.75070931558784, 166.40914207914966, 9.569332441068047, -47.534765748441636, -107.86383607993129, 39.75335415557482, -188.71667784241174, 102.48073409996232, 17.779556761180913, -113.89921258380377, -26.88915998554167, -23.797636654667087, 64.39361657978404, 97.00676431828416, 69.6739982710369, -195.12097914613977, -3.3521377250668114, -12.526394887624944, -45.13979469221425, 106.99266511632776, -28.679767401011496, 38.884216658052225, 24.934520135628418, -63.487218048966824, -204.82370434749785, -58.62458141309733, -262.5996131409916, 150.7798725192317, -0.32807112971256913, -25.55624675885867, -14.471553464434509, 105.10663318107781, 51.032498304997574, -50.07339862023511, -86.80294694916431, -4.467961874014284, 77.54566574930297, 70.15595242376835, 75.77021393489268, 190.11771734497864, -11.30828109339797, 71.70874383422857, 76.98654129944165, -243.99204303921243, 38.774554859184605, -63.30528912755173, 43.754202329672495, 79.42972584977443, -258.9164066903889, -6.070507279332627, -69.68372170840166, -19.632948889855516, -23.10686031470309, -2.5826564946531683, -84.53920099012353, -4.811174057895997, -45.57044948450712, 107.23035294041881, -258.0119803409695, -20.41441888533864, -144.8134778996499, -36.19909746341668, 32.677949145597104, -13.767737851488835, 111.33186105631219, 42.7253045181752, -116.95319223737668, 79.98850092264858, 87.98345477854343, 95.84733817826347, 75.89476600549357, -62.816397764224604, 64.4233853766129, -226.053823888586, 53.067821545031904, -201.65263150210413, -46.83943599400024, -116.82177836580496, 106.50551647833063, -102.75279816258464, 134.18234856945662, -11.247217694438582, -146.36135355727578, -33.490570701043204, 92.28175346455212, -48.45778482282406, -65.94443794713997, 17.151691695626806, 52.48948445462587, 45.75794160912258, 86.40067484251946, 147.71967665777242, -1.366276286083381, 25.679199429985832, -19.571595392800965, 60.071546991997806, -21.563120583395403, 58.04167719329094, -14.372739245077005, -60.961659165368154, 115.31714877861627, 1.1283809152001287, 97.28479015465085, -3.638154926243814, -41.82944031236872, 68.34357657871931, 15.566120947457803, -93.07801008508564, -202.5039992111539, 68.01870886983497, -80.20466390382302, 16.407591093750952, -141.22457342663662, 77.22450933205057, 92.16357854389403, -1.1687662013201816, 11.782186942860351, -20.227399323966864, -145.3631391049415, 97.00888864258704, -98.82920312045451, 95.92919651497479, 69.27283303561369, -76.72549789771695, 155.06391014256351, -96.41491250397877], "policy_predator_policy_reward": [19.07837242151047, 167.5815910745011, 22.34543121516706, 90.28381557786648, 60.305109327951435, 65.31617296089394, 49.612148791166945, 105.39840196780018, 241.4235725897268, 73.96900535138694, 238.79542650774087, 56.16783901654805, 90.35783828568286, 152.73438137350638, 123.7851919794253, 34.029933565066564, 0.9350944297327928, 3.0945396005239294, 14.460078832320795, 28.403798799086502, 16.08071318670401, 204.09641298153534, 88.06538283364614, 14.43636851819463, 38.51720360057743, 173.5457413734501, 50.569264826880584, 75.233308288804, 102.89957273023903, 13.491183378682504, 44.17773952920156, 66.07945860941354, 34.178729153250224, 69.90479903303599, 18.784743235699704, 137.8529181804986, 78.56209055838472, 75.25073123575574, 156.25415038113638, 380.83040765748086, 216.80194900062995, 144.07535115025578, 50.50754412814106, 208.94472104090383, 25.55498149103448, 123.37633125251067, 114.74808965343811, 45.70860862252173, 45.83873088895858, 69.1034519100725, 112.27152512505334, 3.419515540981131, 75.71083102386372, 93.88095315020996, 16.892874797813008, 56.63990244342272, 99.53592722748125, 481.0769941885921, 40.34053150116937, 97.5747204874222, 141.45483579676812, 1.818730873174061, 14.907168621245933, 194.14688864794454, 14.634611468460212, 68.13035343149373, 271.9093799329456, 76.95087363805337, 68.54202145924334, 20.14715955703852, 109.91398932798694, 46.56753981201808, 128.75599525756178, 56.71284125783579, 19.13461112801168, 95.23170658511194, 123.17992212867817, 2.2452267997156037, 179.9598653829975, 37.26274456875069, 177.07889212727622, 109.42794709627759, 117.12142012336527, 84.87854766420817, 100.90802974346293, 111.23551008717479, 13.006383420215945, 37.993235681715866, 158.62483203728488, 104.65812169538304, 125.33744291591084, 13.636282603314445, 31.262463724859735, 78.21893139973405, 12.945229503622292, 73.35032123933713, 54.15570150740142, 156.83101486200806, 294.4810532880711, 93.18469644764774, 232.99866897552212, 107.05958546177581, 145.06462972110674, 46.999437529387144, 71.39986193159272, 14.146736676070152, 58.91073029680121, 124.16287608262361, 61.87122321795271, 126.78191842494422, 94.8259420886597, 46.60941772158873, 76.52978606510727, 0.0, 33.12337410373922, 34.691256165771435, 244.66693195337123, 123.3396910210172, 14.755799306149413, 127.31716241983935, 86.1441477004322, 52.469607393562896, 267.81565213632126, 47.75923161895594, 136.25882371506668, 66.27253764135976, 101.50158084022334, 51.234559479155116, 184.58313336743657, 41.174631365934616, 63.95362559799982, 118.63136248434228, 175.03824824165102, 225.72468146397728, 159.343927276684, 152.2372505233824, 48.86454926809065, 95.23450756723349, 54.33126425553917, 57.794686632128716, 28.873834605233892, 175.24837518041818, 39.785225365913654, 42.31644468878865, 21.49652639794631, 130.70988285002517, 52.09762046906792, 276.6388629620485, 124.51373313755826, 201.26108768234815, 236.88771427188576, 72.80398146173192, 125.47446552301298, 31.472816161240797, 22.639353582820913, 69.1553908511974, 164.46135355727537, 49.690570701043434, 54.04834497457629, 180.22768638369567, 118.21566126633948, 11.777084985173309, 60.567541282013465, 38.00704059405387, 61.79932515748057, 1.680323342227584, 104.0028233185017, 89.26576433277333, 58.47338977074545, 114.6664093765637, 38.39927826777734, 114.81209097061101, 68.26098828472621, 115.8248379798639, 3.5384845104101723, 48.41598579577338, 25.678848632758122, 72.6636445773137, 42.15526892691783, 154.13059480673166, 14.732210353644149, 207.6642855890262, 176.69412990252087, 108.79130794020406, 139.7927345180595, 112.24722102240321, 118.2556057225658, 123.3783017237661, 107.35091227557392, 106.92061706307774, 74.81472264549603, 84.85846908433138, 133.57326326882122, 106.37906070861891, 109.87733417914617, 81.27372210496725, 34.737664657085894, 124.97082056688446, 94.91555076797411, 62.48485456967541]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.4565405331157315, "mean_inference_ms": 5.493900916643813, "mean_action_processing_ms": 3.4311927915526157, "mean_env_wait_ms": 11.353964530599178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003751993179321289, "StateBufferConnector_ms": 0.004843473434448242, "ViewRequirementAgentConnector_ms": 0.11059737205505371}, "num_episodes": 14, "episode_return_max": 342.41771734497866, "episode_return_min": -47.48862742448857, "episode_return_mean": 161.0552244387471, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.61942732613792, "num_env_steps_trained_throughput_per_sec": 85.61942732613792, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 50395.446, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50395.397, "sample_time_ms": 2841.676, "learn_time_ms": 47528.276, "learn_throughput": 84.16, "synch_weights_time_ms": 20.332}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-30-47", "timestamp": 1724148047, "time_this_iter_s": 46.75363302230835, "time_total_s": 615.3535685539246, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33132b280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 615.3535685539246, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 25.383582089552238, "ram_util_percent": 82.78358208955224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.704643453870501, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.898432086006044, "policy_loss": -0.01967741751713215, "vf_loss": 7.915684003426285, "vf_explained_var": 0.37347801803911806, "kl": 0.012127410302618666, "entropy": 1.3747440422022785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.118739002123081, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.732839099313847, "policy_loss": -0.024345234000720282, "vf_loss": 4.754006183967388, "vf_explained_var": 0.18589945955881998, "kl": 0.01589077893649499, "entropy": 1.3310668267900982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 342.41771734497866, "episode_reward_min": -47.48862742448857, "episode_reward_mean": 166.2124903219515, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -318.1899103619439, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.11771734497864, "predator_policy": 481.0769941885921}, "policy_reward_mean": {"prey_policy": -13.02624140746676, "predator_policy": 96.13248656844259}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.45074057956445, 109.73597820341162, 201.99999999999955, 234.57235800199467, 116.78697719607271, 107.7181901094251, 112.89999999999986, 95.08625585572872, 99.83171597442339, 146.60263652714983, 140.51557064028898, 100.41595961918665, 62.392217092135226, 45.791078138692505, 196.406273573983, 62.40000000000035, -47.48862742448857, 239.09999999999974, 194.69999999999993, 170.91866561330883, 133.50173092248636, 198.90433291726825, 233.6543847745329, 171.1941330627676, 225.05335723103113, 247.0247504766852, 87.45971562101934, 149.11212802739158, 200.27089548110405, 105.88031196495095, 161.45674319042868, 212.39999999999992, 137.8359728575655, 123.09519290653294, 171.3342655487065, 96.50000000000001, 172.43401845607085, 124.21746397512337, 228.2385138155379, 166.17974936192311, 176.1816783243056, 184.03270606418664, 97.38223281971824, 289.1369779833198, 342.41771734497866, 128.21509301034104, 201.00112123461747, 117.54222745762159, 261.79768327344203, 50.587969785553966, 113.21469075816796, 127.04662351002177, 136.40738968535194, 244.244891538254, 122.33653047932039, 130.56860243700007, 163.0092681294324, 266.18311646215534, 167.15751847092355, 265.9324630115089, 165.2847774892407, 167.10604491914336, 177.19001086283416, 146.03048137381296, 160.6999999999999, 214.729875309036, 34.300000000000225, 278.1, 81.20000000000003, 196.82200793981534, 297.59999999999997, 217.58151079517754, 213.6397507465056, 189.68992584828348, 108.75142785414414, 168.3999999999997, 191.98912843847856, 222.79999999999964, 144.88460680504235, 151.00014750140625, 188.24288273039028, 177.63384335174587, 305.2663416812256, 151.22797934872023, 191.5980735150857, 188.251049678634, 152.2558203618665, 216.04940297623403, 87.39340937682778, 141.1760947304527, 294.71860873751007, 225.92207154019044, 80.12205673103153, 152.0988778051233, 154.48174157256554, 180.58641368556826, 299.9000000000001, 79.8571661949477, 258.3911685613993, 141.29618166048374], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-43.78447825376989, -61.827726140692775, -31.57594194515928, 15.5093470328874, -63.265350548935245, 148.87459444001342, 159.06655428888774, -34.751394425507286, 41.18180891885792, -28.478359909071074, 92.00000000000007, -140.91947130677335, 2.4836483676110035, -43.39647016175148, -152.5751222629319, -289.42317991995594, -250.79432760811693, -10.251256568345521, 35.60700161030245, -148.45663025219707, -0.2394108507451342, -8.176331252510792, -51.25069521444561, -8.790043442326898, -23.433138346537397, -29.116827360358428, -33.474667278185926, -36.42529524915616, -84.55792986513923, 111.37241926504842, 21.459438096034283, -32.59221533726984, -318.1899103619439, -309.91163847861844, 117.87898590299469, -16.694237891586525, 73.44636800446693, -22.01993467440912, -130.97860800988872, 92.84321635400721, 61.75541624628568, -11.018650223753042, -238.0050887411006, 88.04916808736972, 64.41982225707365, 80.54538150117781, 24.00000701501628, -9.28740309225361, 71.0158433291008, -31.43132261346702, -33.75070931558784, 166.40914207914966, 9.569332441068047, -47.534765748441636, -107.86383607993129, 39.75335415557482, -188.71667784241174, 102.48073409996232, 17.779556761180913, -113.89921258380377, -26.88915998554167, -23.797636654667087, 64.39361657978404, 97.00676431828416, 69.6739982710369, -195.12097914613977, -3.3521377250668114, -12.526394887624944, -45.13979469221425, 106.99266511632776, -28.679767401011496, 38.884216658052225, 24.934520135628418, -63.487218048966824, -204.82370434749785, -58.62458141309733, -262.5996131409916, 150.7798725192317, -0.32807112971256913, -25.55624675885867, -14.471553464434509, 105.10663318107781, 51.032498304997574, -50.07339862023511, -86.80294694916431, -4.467961874014284, 77.54566574930297, 70.15595242376835, 75.77021393489268, 190.11771734497864, -11.30828109339797, 71.70874383422857, 76.98654129944165, -243.99204303921243, 38.774554859184605, -63.30528912755173, 43.754202329672495, 79.42972584977443, -258.9164066903889, -6.070507279332627, -69.68372170840166, -19.632948889855516, -23.10686031470309, -2.5826564946531683, -84.53920099012353, -4.811174057895997, -45.57044948450712, 107.23035294041881, -258.0119803409695, -20.41441888533864, -144.8134778996499, -36.19909746341668, 32.677949145597104, -13.767737851488835, 111.33186105631219, 42.7253045181752, -116.95319223737668, 79.98850092264858, 87.98345477854343, 95.84733817826347, 75.89476600549357, -62.816397764224604, 64.4233853766129, -226.053823888586, 53.067821545031904, -201.65263150210413, -46.83943599400024, -116.82177836580496, 106.50551647833063, -102.75279816258464, 134.18234856945662, -11.247217694438582, -146.36135355727578, -33.490570701043204, 92.28175346455212, -48.45778482282406, -65.94443794713997, 17.151691695626806, 52.48948445462587, 45.75794160912258, 86.40067484251946, 147.71967665777242, -1.366276286083381, 25.679199429985832, -19.571595392800965, 60.071546991997806, -21.563120583395403, 58.04167719329094, -14.372739245077005, -60.961659165368154, 115.31714877861627, 1.1283809152001287, 97.28479015465085, -3.638154926243814, -41.82944031236872, 68.34357657871931, 15.566120947457803, -93.07801008508564, -202.5039992111539, 68.01870886983497, -80.20466390382302, 16.407591093750952, -141.22457342663662, 77.22450933205057, 92.16357854389403, -1.1687662013201816, 11.782186942860351, -20.227399323966864, -145.3631391049415, 97.00888864258704, -98.82920312045451, 95.92919651497479, 69.27283303561369, -76.72549789771695, 155.06391014256351, -96.41491250397877, -143.55705762685636, 21.82331901826299, -167.48318214975228, 84.28166678125139, 122.87001371883039, 13.226866469681896, 178.12112418675432, -113.21270658714727, -2.7501013406213075, -89.797084109671, 3.3771450235231946, -107.0495940485901, -25.05854409189179, -135.40839576271793, 56.76916664506375, -108.57174989713755, 147.27068524365802, 93.89372781321157, -205.68824316438668, -33.278956735541335, 165.7772265612155, 16.116570029237693, -32.78866104911667, -73.88417539647607], "policy_predator_policy_reward": [38.51720360057743, 173.5457413734501, 50.569264826880584, 75.233308288804, 102.89957273023903, 13.491183378682504, 44.17773952920156, 66.07945860941354, 34.178729153250224, 69.90479903303599, 18.784743235699704, 137.8529181804986, 78.56209055838472, 75.25073123575574, 156.25415038113638, 380.83040765748086, 216.80194900062995, 144.07535115025578, 50.50754412814106, 208.94472104090383, 25.55498149103448, 123.37633125251067, 114.74808965343811, 45.70860862252173, 45.83873088895858, 69.1034519100725, 112.27152512505334, 3.419515540981131, 75.71083102386372, 93.88095315020996, 16.892874797813008, 56.63990244342272, 99.53592722748125, 481.0769941885921, 40.34053150116937, 97.5747204874222, 141.45483579676812, 1.818730873174061, 14.907168621245933, 194.14688864794454, 14.634611468460212, 68.13035343149373, 271.9093799329456, 76.95087363805337, 68.54202145924334, 20.14715955703852, 109.91398932798694, 46.56753981201808, 128.75599525756178, 56.71284125783579, 19.13461112801168, 95.23170658511194, 123.17992212867817, 2.2452267997156037, 179.9598653829975, 37.26274456875069, 177.07889212727622, 109.42794709627759, 117.12142012336527, 84.87854766420817, 100.90802974346293, 111.23551008717479, 13.006383420215945, 37.993235681715866, 158.62483203728488, 104.65812169538304, 125.33744291591084, 13.636282603314445, 31.262463724859735, 78.21893139973405, 12.945229503622292, 73.35032123933713, 54.15570150740142, 156.83101486200806, 294.4810532880711, 93.18469644764774, 232.99866897552212, 107.05958546177581, 145.06462972110674, 46.999437529387144, 71.39986193159272, 14.146736676070152, 58.91073029680121, 124.16287608262361, 61.87122321795271, 126.78191842494422, 94.8259420886597, 46.60941772158873, 76.52978606510727, 0.0, 33.12337410373922, 34.691256165771435, 244.66693195337123, 123.3396910210172, 14.755799306149413, 127.31716241983935, 86.1441477004322, 52.469607393562896, 267.81565213632126, 47.75923161895594, 136.25882371506668, 66.27253764135976, 101.50158084022334, 51.234559479155116, 184.58313336743657, 41.174631365934616, 63.95362559799982, 118.63136248434228, 175.03824824165102, 225.72468146397728, 159.343927276684, 152.2372505233824, 48.86454926809065, 95.23450756723349, 54.33126425553917, 57.794686632128716, 28.873834605233892, 175.24837518041818, 39.785225365913654, 42.31644468878865, 21.49652639794631, 130.70988285002517, 52.09762046906792, 276.6388629620485, 124.51373313755826, 201.26108768234815, 236.88771427188576, 72.80398146173192, 125.47446552301298, 31.472816161240797, 22.639353582820913, 69.1553908511974, 164.46135355727537, 49.690570701043434, 54.04834497457629, 180.22768638369567, 118.21566126633948, 11.777084985173309, 60.567541282013465, 38.00704059405387, 61.79932515748057, 1.680323342227584, 104.0028233185017, 89.26576433277333, 58.47338977074545, 114.6664093765637, 38.39927826777734, 114.81209097061101, 68.26098828472621, 115.8248379798639, 3.5384845104101723, 48.41598579577338, 25.678848632758122, 72.6636445773137, 42.15526892691783, 154.13059480673166, 14.732210353644149, 207.6642855890262, 176.69412990252087, 108.79130794020406, 139.7927345180595, 112.24722102240321, 118.2556057225658, 123.3783017237661, 107.35091227557392, 106.92061706307774, 74.81472264549603, 84.85846908433138, 133.57326326882122, 106.37906070861891, 109.87733417914617, 81.27372210496725, 34.737664657085894, 124.97082056688446, 94.91555076797411, 62.48485456967541, 201.23796175185012, 7.889186233570953, 150.08362207308272, 74.29398802587082, 130.900944632505, 27.72078391649287, 41.09019215160026, 119.92346178898306, 70.3366188599723, 102.33262332135162, 100.53693140364088, 155.23439542654955, 17.9814617394856, 296.9672196876897, 184.2235178181575, 48.165479119484615, 26.829314756341972, 31.90627218678851, 124.07729139183654, 194.74707470303892, 53.15898882145814, 23.33838314948812, 123.28353278952801, 124.68548531654821]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.300609810145915, "mean_inference_ms": 5.360201091528709, "mean_action_processing_ms": 3.2520716243396004, "mean_env_wait_ms": 11.25826854934541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003784656524658203, "StateBufferConnector_ms": 0.004718422889709473, "ViewRequirementAgentConnector_ms": 0.1097409725189209}, "num_episodes": 12, "episode_return_max": 342.41771734497866, "episode_return_min": -47.48862742448857, "episode_return_mean": 166.2124903219515, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.60585457815034, "num_env_steps_trained_throughput_per_sec": 84.60585457815034, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 49605.069, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49605.007, "sample_time_ms": 2617.189, "learn_time_ms": 46963.895, "learn_throughput": 85.172, "synch_weights_time_ms": 19.336}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-31-34", "timestamp": 1724148094, "time_this_iter_s": 47.32811212539673, "time_total_s": 662.6816806793213, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310f8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 662.6816806793213, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 26.02089552238806, "ram_util_percent": 82.87014925373134}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.166849287224824, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.131318996823023, "policy_loss": -0.0207872704065666, "vf_loss": 8.149425061291488, "vf_explained_var": 0.3639022747044841, "kl": 0.013406015550545245, "entropy": 1.3440006571472007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.117300717445908, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.947754616585989, "policy_loss": -0.02061163199272145, "vf_loss": 4.965412572704295, "vf_explained_var": 0.17755088850303932, "kl": 0.014768360435430493, "entropy": 1.2854292525816216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 342.41771734497866, "episode_reward_min": 34.300000000000225, "episode_reward_mean": 173.56396694330255, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -336.4074164988297, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.11771734497864, "predator_policy": 335.11978811636277}, "policy_reward_mean": {"prey_policy": -10.819242642294821, "predator_policy": 97.60122611394618}, "custom_metrics": {}, "hist_stats": {"episode_reward": [171.1941330627676, 225.05335723103113, 247.0247504766852, 87.45971562101934, 149.11212802739158, 200.27089548110405, 105.88031196495095, 161.45674319042868, 212.39999999999992, 137.8359728575655, 123.09519290653294, 171.3342655487065, 96.50000000000001, 172.43401845607085, 124.21746397512337, 228.2385138155379, 166.17974936192311, 176.1816783243056, 184.03270606418664, 97.38223281971824, 289.1369779833198, 342.41771734497866, 128.21509301034104, 201.00112123461747, 117.54222745762159, 261.79768327344203, 50.587969785553966, 113.21469075816796, 127.04662351002177, 136.40738968535194, 244.244891538254, 122.33653047932039, 130.56860243700007, 163.0092681294324, 266.18311646215534, 167.15751847092355, 265.9324630115089, 165.2847774892407, 167.10604491914336, 177.19001086283416, 146.03048137381296, 160.6999999999999, 214.729875309036, 34.300000000000225, 278.1, 81.20000000000003, 196.82200793981534, 297.59999999999997, 217.58151079517754, 213.6397507465056, 189.68992584828348, 108.75142785414414, 168.3999999999997, 191.98912843847856, 222.79999999999964, 144.88460680504235, 151.00014750140625, 188.24288273039028, 177.63384335174587, 305.2663416812256, 151.22797934872023, 191.5980735150857, 188.251049678634, 152.2558203618665, 216.04940297623403, 87.39340937682778, 141.1760947304527, 294.71860873751007, 225.92207154019044, 80.12205673103153, 152.0988778051233, 154.48174157256554, 180.58641368556826, 299.9000000000001, 79.8571661949477, 258.3911685613993, 141.29618166048374, 194.79423421918537, 236.42283415801924, 265.4091974817432, 59.69995180439295, 169.6813259897698, 118.25630105161085, 148.6469157528707, 66.14743611432162, 93.99153769885558, 145.20997442432272, 91.71663674348866, 219.44606654111584, 183.3885379297514, 99.761580299862, 327.5447439559854, 292.0134944457408, 225.69999999999973, 118.64027400087085, 235.35985549058117, 135.2392467834744, 147.2498187243462, 133.16131286569137, 90.5628239742744], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [24.00000701501628, -9.28740309225361, 71.0158433291008, -31.43132261346702, -33.75070931558784, 166.40914207914966, 9.569332441068047, -47.534765748441636, -107.86383607993129, 39.75335415557482, -188.71667784241174, 102.48073409996232, 17.779556761180913, -113.89921258380377, -26.88915998554167, -23.797636654667087, 64.39361657978404, 97.00676431828416, 69.6739982710369, -195.12097914613977, -3.3521377250668114, -12.526394887624944, -45.13979469221425, 106.99266511632776, -28.679767401011496, 38.884216658052225, 24.934520135628418, -63.487218048966824, -204.82370434749785, -58.62458141309733, -262.5996131409916, 150.7798725192317, -0.32807112971256913, -25.55624675885867, -14.471553464434509, 105.10663318107781, 51.032498304997574, -50.07339862023511, -86.80294694916431, -4.467961874014284, 77.54566574930297, 70.15595242376835, 75.77021393489268, 190.11771734497864, -11.30828109339797, 71.70874383422857, 76.98654129944165, -243.99204303921243, 38.774554859184605, -63.30528912755173, 43.754202329672495, 79.42972584977443, -258.9164066903889, -6.070507279332627, -69.68372170840166, -19.632948889855516, -23.10686031470309, -2.5826564946531683, -84.53920099012353, -4.811174057895997, -45.57044948450712, 107.23035294041881, -258.0119803409695, -20.41441888533864, -144.8134778996499, -36.19909746341668, 32.677949145597104, -13.767737851488835, 111.33186105631219, 42.7253045181752, -116.95319223737668, 79.98850092264858, 87.98345477854343, 95.84733817826347, 75.89476600549357, -62.816397764224604, 64.4233853766129, -226.053823888586, 53.067821545031904, -201.65263150210413, -46.83943599400024, -116.82177836580496, 106.50551647833063, -102.75279816258464, 134.18234856945662, -11.247217694438582, -146.36135355727578, -33.490570701043204, 92.28175346455212, -48.45778482282406, -65.94443794713997, 17.151691695626806, 52.48948445462587, 45.75794160912258, 86.40067484251946, 147.71967665777242, -1.366276286083381, 25.679199429985832, -19.571595392800965, 60.071546991997806, -21.563120583395403, 58.04167719329094, -14.372739245077005, -60.961659165368154, 115.31714877861627, 1.1283809152001287, 97.28479015465085, -3.638154926243814, -41.82944031236872, 68.34357657871931, 15.566120947457803, -93.07801008508564, -202.5039992111539, 68.01870886983497, -80.20466390382302, 16.407591093750952, -141.22457342663662, 77.22450933205057, 92.16357854389403, -1.1687662013201816, 11.782186942860351, -20.227399323966864, -145.3631391049415, 97.00888864258704, -98.82920312045451, 95.92919651497479, 69.27283303561369, -76.72549789771695, 155.06391014256351, -96.41491250397877, -143.55705762685636, 21.82331901826299, -167.48318214975228, 84.28166678125139, 122.87001371883039, 13.226866469681896, 178.12112418675432, -113.21270658714727, -2.7501013406213075, -89.797084109671, 3.3771450235231946, -107.0495940485901, -25.05854409189179, -135.40839576271793, 56.76916664506375, -108.57174989713755, 147.27068524365802, 93.89372781321157, -205.68824316438668, -33.278956735541335, 165.7772265612155, 16.116570029237693, -32.78866104911667, -73.88417539647607, 76.4039316212493, -128.16888968897769, -336.4074164988297, 179.21708686712, 39.922963498786295, 166.4567722775127, -243.15928384134008, -10.906393330543612, 46.73077737160448, -255.37950225367808, -30.276089896013502, -85.15691327320656, -119.33215153537202, 44.71030239874347, -47.47071527667541, -212.83724437797707, -95.69471781875325, -6.718273279763406, 30.25277037493501, -101.24846137702323, 10.413905805474643, -16.18939508541271, -33.083770690309805, 135.9430084880231, 90.2309117918012, -92.9314691147991, -127.45033899717416, 11.364491794163797, 140.55376686449296, 105.81420988589184, 185.57860115887098, 49.39462848793427, 69.20784728482415, 91.42415036617373, -40.902921135476305, -118.90870962492336, 14.304293727020069, 172.78022889137867, -87.5417044091091, -190.87931554465177, -188.86825276713597, 49.69826987932231, -73.62552963990157, 53.78309736298795, -94.99689693957667, -32.533068275464245], "policy_predator_policy_reward": [109.91398932798694, 46.56753981201808, 128.75599525756178, 56.71284125783579, 19.13461112801168, 95.23170658511194, 123.17992212867817, 2.2452267997156037, 179.9598653829975, 37.26274456875069, 177.07889212727622, 109.42794709627759, 117.12142012336527, 84.87854766420817, 100.90802974346293, 111.23551008717479, 13.006383420215945, 37.993235681715866, 158.62483203728488, 104.65812169538304, 125.33744291591084, 13.636282603314445, 31.262463724859735, 78.21893139973405, 12.945229503622292, 73.35032123933713, 54.15570150740142, 156.83101486200806, 294.4810532880711, 93.18469644764774, 232.99866897552212, 107.05958546177581, 145.06462972110674, 46.999437529387144, 71.39986193159272, 14.146736676070152, 58.91073029680121, 124.16287608262361, 61.87122321795271, 126.78191842494422, 94.8259420886597, 46.60941772158873, 76.52978606510727, 0.0, 33.12337410373922, 34.691256165771435, 244.66693195337123, 123.3396910210172, 14.755799306149413, 127.31716241983935, 86.1441477004322, 52.469607393562896, 267.81565213632126, 47.75923161895594, 136.25882371506668, 66.27253764135976, 101.50158084022334, 51.234559479155116, 184.58313336743657, 41.174631365934616, 63.95362559799982, 118.63136248434228, 175.03824824165102, 225.72468146397728, 159.343927276684, 152.2372505233824, 48.86454926809065, 95.23450756723349, 54.33126425553917, 57.794686632128716, 28.873834605233892, 175.24837518041818, 39.785225365913654, 42.31644468878865, 21.49652639794631, 130.70988285002517, 52.09762046906792, 276.6388629620485, 124.51373313755826, 201.26108768234815, 236.88771427188576, 72.80398146173192, 125.47446552301298, 31.472816161240797, 22.639353582820913, 69.1553908511974, 164.46135355727537, 49.690570701043434, 54.04834497457629, 180.22768638369567, 118.21566126633948, 11.777084985173309, 60.567541282013465, 38.00704059405387, 61.79932515748057, 1.680323342227584, 104.0028233185017, 89.26576433277333, 58.47338977074545, 114.6664093765637, 38.39927826777734, 114.81209097061101, 68.26098828472621, 115.8248379798639, 3.5384845104101723, 48.41598579577338, 25.678848632758122, 72.6636445773137, 42.15526892691783, 154.13059480673166, 14.732210353644149, 207.6642855890262, 176.69412990252087, 108.79130794020406, 139.7927345180595, 112.24722102240321, 118.2556057225658, 123.3783017237661, 107.35091227557392, 106.92061706307774, 74.81472264549603, 84.85846908433138, 133.57326326882122, 106.37906070861891, 109.87733417914617, 81.27372210496725, 34.737664657085894, 124.97082056688446, 94.91555076797411, 62.48485456967541, 201.23796175185012, 7.889186233570953, 150.08362207308272, 74.29398802587082, 130.900944632505, 27.72078391649287, 41.09019215160026, 119.92346178898306, 70.3366188599723, 102.33262332135162, 100.53693140364088, 155.23439542654955, 17.9814617394856, 296.9672196876897, 184.2235178181575, 48.165479119484615, 26.829314756341972, 31.90627218678851, 124.07729139183654, 194.74707470303892, 53.15898882145814, 23.33838314948812, 123.28353278952801, 124.68548531654821, 123.70209705241676, 122.85709523449694, 218.48108745688822, 175.13207633284065, 38.47321204426679, 20.556249661177862, 201.02197918830637, 112.74364978797001, 232.02787027845736, 146.3021805933866, 96.54256362477976, 137.14674059605105, 122.94197213610462, 100.32679275339467, 104.55978580255798, 221.89560996641575, 49.87895441545315, 146.5255743819192, 146.19984937131852, 70.00581605509257, 37.17392010373071, 60.318205919696744, 61.21134231821814, 55.3754864251845, 21.3604786851311, 164.7286165676182, 38.80395110040043, 177.04347640247198, 17.087075666031996, 64.08969153956846, 20.903437312515823, 36.136827486420124, 12.705512345331654, 52.36249000367027, 157.88748353849695, 120.56442122277319, 1.803074517868006, 46.472258354315045, 335.11978811636277, 78.54047862087265, 115.78026277633073, 170.63953883582886, 76.6976547068033, 76.30609043580274, 76.12833278387211, 141.96445640544368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.951112342937647, "mean_inference_ms": 5.103453011902788, "mean_action_processing_ms": 3.0774538683472445, "mean_env_wait_ms": 11.05384958349528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035877227783203125, "StateBufferConnector_ms": 0.0044422149658203125, "ViewRequirementAgentConnector_ms": 0.12215614318847656}, "num_episodes": 23, "episode_return_max": 342.41771734497866, "episode_return_min": 34.300000000000225, "episode_return_mean": 173.56396694330255, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.16565435464933, "num_env_steps_trained_throughput_per_sec": 85.16565435464933, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 48703.834, "restore_workers_time_ms": 0.013, "training_step_time_ms": 48703.772, "sample_time_ms": 2433.046, "learn_time_ms": 46249.043, "learn_throughput": 86.488, "synch_weights_time_ms": 17.558}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-32-21", "timestamp": 1724148141, "time_this_iter_s": 47.00829720497131, "time_total_s": 709.6899778842926, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33132f4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 709.6899778842926, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 26.275757575757577, "ram_util_percent": 82.79545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.298176257257108, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.463237493504923, "policy_loss": -0.022125432420295302, "vf_loss": 8.482781281042351, "vf_explained_var": 0.3675834673422354, "kl": 0.012908241475523307, "entropy": 1.2868341046035605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999993}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.741832136887091, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.207884601310448, "policy_loss": -0.02096013863664613, "vf_loss": 6.225436474784972, "vf_explained_var": 0.14560908473357953, "kl": 0.017041352316589348, "entropy": 1.201764452268207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999993}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 327.5447439559854, "episode_reward_min": 34.300000000000225, "episode_reward_mean": 172.43446050227453, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -336.4074164988297, "predator_policy": 1.6137332412334513}, "policy_reward_max": {"prey_policy": 185.57860115887098, "predator_policy": 335.11978811636277}, "policy_reward_mean": {"prey_policy": -14.760310849323785, "predator_policy": 100.97754110046108}, "custom_metrics": {}, "hist_stats": {"episode_reward": [117.54222745762159, 261.79768327344203, 50.587969785553966, 113.21469075816796, 127.04662351002177, 136.40738968535194, 244.244891538254, 122.33653047932039, 130.56860243700007, 163.0092681294324, 266.18311646215534, 167.15751847092355, 265.9324630115089, 165.2847774892407, 167.10604491914336, 177.19001086283416, 146.03048137381296, 160.6999999999999, 214.729875309036, 34.300000000000225, 278.1, 81.20000000000003, 196.82200793981534, 297.59999999999997, 217.58151079517754, 213.6397507465056, 189.68992584828348, 108.75142785414414, 168.3999999999997, 191.98912843847856, 222.79999999999964, 144.88460680504235, 151.00014750140625, 188.24288273039028, 177.63384335174587, 305.2663416812256, 151.22797934872023, 191.5980735150857, 188.251049678634, 152.2558203618665, 216.04940297623403, 87.39340937682778, 141.1760947304527, 294.71860873751007, 225.92207154019044, 80.12205673103153, 152.0988778051233, 154.48174157256554, 180.58641368556826, 299.9000000000001, 79.8571661949477, 258.3911685613993, 141.29618166048374, 194.79423421918537, 236.42283415801924, 265.4091974817432, 59.69995180439295, 169.6813259897698, 118.25630105161085, 148.6469157528707, 66.14743611432162, 93.99153769885558, 145.20997442432272, 91.71663674348866, 219.44606654111584, 183.3885379297514, 99.761580299862, 327.5447439559854, 292.0134944457408, 225.69999999999973, 118.64027400087085, 235.35985549058117, 135.2392467834744, 147.2498187243462, 133.16131286569137, 90.5628239742744, 100.9999999999994, 178.51164101812654, 247.21356952568763, 161.4658180811914, 295.8803014923277, 237.85129047318753, 145.40135418879518, 227.30797957094498, 178.94499641485666, 107.9639444075946, 175.68060466118106, 79.42790521500639, 262.913978761361, 216.89944455893476, 186.13817571184262, 64.8000000000002, 77.10000000000004, 297.5617755680233, 241.71708772222325, 68.51479111355528, 110.40851068161602, 134.28489321409697, 165.21603227494452, 122.89999999999966], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [38.774554859184605, -63.30528912755173, 43.754202329672495, 79.42972584977443, -258.9164066903889, -6.070507279332627, -69.68372170840166, -19.632948889855516, -23.10686031470309, -2.5826564946531683, -84.53920099012353, -4.811174057895997, -45.57044948450712, 107.23035294041881, -258.0119803409695, -20.41441888533864, -144.8134778996499, -36.19909746341668, 32.677949145597104, -13.767737851488835, 111.33186105631219, 42.7253045181752, -116.95319223737668, 79.98850092264858, 87.98345477854343, 95.84733817826347, 75.89476600549357, -62.816397764224604, 64.4233853766129, -226.053823888586, 53.067821545031904, -201.65263150210413, -46.83943599400024, -116.82177836580496, 106.50551647833063, -102.75279816258464, 134.18234856945662, -11.247217694438582, -146.36135355727578, -33.490570701043204, 92.28175346455212, -48.45778482282406, -65.94443794713997, 17.151691695626806, 52.48948445462587, 45.75794160912258, 86.40067484251946, 147.71967665777242, -1.366276286083381, 25.679199429985832, -19.571595392800965, 60.071546991997806, -21.563120583395403, 58.04167719329094, -14.372739245077005, -60.961659165368154, 115.31714877861627, 1.1283809152001287, 97.28479015465085, -3.638154926243814, -41.82944031236872, 68.34357657871931, 15.566120947457803, -93.07801008508564, -202.5039992111539, 68.01870886983497, -80.20466390382302, 16.407591093750952, -141.22457342663662, 77.22450933205057, 92.16357854389403, -1.1687662013201816, 11.782186942860351, -20.227399323966864, -145.3631391049415, 97.00888864258704, -98.82920312045451, 95.92919651497479, 69.27283303561369, -76.72549789771695, 155.06391014256351, -96.41491250397877, -143.55705762685636, 21.82331901826299, -167.48318214975228, 84.28166678125139, 122.87001371883039, 13.226866469681896, 178.12112418675432, -113.21270658714727, -2.7501013406213075, -89.797084109671, 3.3771450235231946, -107.0495940485901, -25.05854409189179, -135.40839576271793, 56.76916664506375, -108.57174989713755, 147.27068524365802, 93.89372781321157, -205.68824316438668, -33.278956735541335, 165.7772265612155, 16.116570029237693, -32.78866104911667, -73.88417539647607, 76.4039316212493, -128.16888968897769, -336.4074164988297, 179.21708686712, 39.922963498786295, 166.4567722775127, -243.15928384134008, -10.906393330543612, 46.73077737160448, -255.37950225367808, -30.276089896013502, -85.15691327320656, -119.33215153537202, 44.71030239874347, -47.47071527667541, -212.83724437797707, -95.69471781875325, -6.718273279763406, 30.25277037493501, -101.24846137702323, 10.413905805474643, -16.18939508541271, -33.083770690309805, 135.9430084880231, 90.2309117918012, -92.9314691147991, -127.45033899717416, 11.364491794163797, 140.55376686449296, 105.81420988589184, 185.57860115887098, 49.39462848793427, 69.20784728482415, 91.42415036617373, -40.902921135476305, -118.90870962492336, 14.304293727020069, 172.78022889137867, -87.5417044091091, -190.87931554465177, -188.86825276713597, 49.69826987932231, -73.62552963990157, 53.78309736298795, -94.99689693957667, -32.533068275464245, 5.156751962967017, -19.847552619792737, 11.936977547308334, -34.16745036844012, 132.19661635148006, -218.22639050894583, -35.599162311531835, 57.895756470592694, 60.15611735249166, 65.5413089461902, 45.196497239151775, 98.92795962730561, -155.20671219222567, 28.843602513236505, 4.916482618360632, 92.00931496944048, -72.03413062462727, 9.62047955192208, 27.68067444997376, -194.22791405198225, -124.88938840451223, 116.11697448722265, -80.48884888888884, -206.05085900077773, 112.27050277443051, -2.7415145106734897, -134.97963644095037, -59.6892048923078, 94.37478222179729, -158.9368247570857, -47.316732462548856, 44.959706696021115, -3.7566181276708335, -9.046127608281331, -132.25759729262649, 148.56881312677794, 105.51526695537598, 8.429575580781444, -185.35795770289425, -19.531578179338005, -19.363820887333056, -45.917673688535615, -54.95619240654181, 55.780521797453986, -166.19810761301937, 19.37910491373709, 80.91673484368145, -226.24399695762165], "policy_predator_policy_reward": [14.755799306149413, 127.31716241983935, 86.1441477004322, 52.469607393562896, 267.81565213632126, 47.75923161895594, 136.25882371506668, 66.27253764135976, 101.50158084022334, 51.234559479155116, 184.58313336743657, 41.174631365934616, 63.95362559799982, 118.63136248434228, 175.03824824165102, 225.72468146397728, 159.343927276684, 152.2372505233824, 48.86454926809065, 95.23450756723349, 54.33126425553917, 57.794686632128716, 28.873834605233892, 175.24837518041818, 39.785225365913654, 42.31644468878865, 21.49652639794631, 130.70988285002517, 52.09762046906792, 276.6388629620485, 124.51373313755826, 201.26108768234815, 236.88771427188576, 72.80398146173192, 125.47446552301298, 31.472816161240797, 22.639353582820913, 69.1553908511974, 164.46135355727537, 49.690570701043434, 54.04834497457629, 180.22768638369567, 118.21566126633948, 11.777084985173309, 60.567541282013465, 38.00704059405387, 61.79932515748057, 1.680323342227584, 104.0028233185017, 89.26576433277333, 58.47338977074545, 114.6664093765637, 38.39927826777734, 114.81209097061101, 68.26098828472621, 115.8248379798639, 3.5384845104101723, 48.41598579577338, 25.678848632758122, 72.6636445773137, 42.15526892691783, 154.13059480673166, 14.732210353644149, 207.6642855890262, 176.69412990252087, 108.79130794020406, 139.7927345180595, 112.24722102240321, 118.2556057225658, 123.3783017237661, 107.35091227557392, 106.92061706307774, 74.81472264549603, 84.85846908433138, 133.57326326882122, 106.37906070861891, 109.87733417914617, 81.27372210496725, 34.737664657085894, 124.97082056688446, 94.91555076797411, 62.48485456967541, 201.23796175185012, 7.889186233570953, 150.08362207308272, 74.29398802587082, 130.900944632505, 27.72078391649287, 41.09019215160026, 119.92346178898306, 70.3366188599723, 102.33262332135162, 100.53693140364088, 155.23439542654955, 17.9814617394856, 296.9672196876897, 184.2235178181575, 48.165479119484615, 26.829314756341972, 31.90627218678851, 124.07729139183654, 194.74707470303892, 53.15898882145814, 23.33838314948812, 123.28353278952801, 124.68548531654821, 123.70209705241676, 122.85709523449694, 218.48108745688822, 175.13207633284065, 38.47321204426679, 20.556249661177862, 201.02197918830637, 112.74364978797001, 232.02787027845736, 146.3021805933866, 96.54256362477976, 137.14674059605105, 122.94197213610462, 100.32679275339467, 104.55978580255798, 221.89560996641575, 49.87895441545315, 146.5255743819192, 146.19984937131852, 70.00581605509257, 37.17392010373071, 60.318205919696744, 61.21134231821814, 55.3754864251845, 21.3604786851311, 164.7286165676182, 38.80395110040043, 177.04347640247198, 17.087075666031996, 64.08969153956846, 20.903437312515823, 36.136827486420124, 12.705512345331654, 52.36249000367027, 157.88748353849695, 120.56442122277319, 1.803074517868006, 46.472258354315045, 335.11978811636277, 78.54047862087265, 115.78026277633073, 170.63953883582886, 76.6976547068033, 76.30609043580274, 76.12833278387211, 141.96445640544368, 1.6137332412334513, 114.07706741559228, 163.08078902494807, 37.66132481431056, 147.1269998949133, 186.11634378824004, 74.78993059704754, 64.37929332508315, 115.13571640522102, 55.04715878842481, 52.94840328254248, 40.778430324188086, 152.68420571471225, 119.08025815307214, 89.54270005254858, 40.8394819305951, 75.38028916814605, 165.978358319416, 21.080209340285688, 253.43097466931764, 168.4918037635076, 15.961214814963219, 200.52627845448984, 165.44133465018257, 59.16666116892572, 94.21832932867828, 236.77058503572823, 174.79770085646476, 209.71849808527267, 40.981720161858334, 25.995319748535245, 41.161706017992586, 15.321728360834346, 74.58101737511802, 72.67920603603127, 208.5713536978404, 89.34354153230015, 38.42870365376596, 208.92154170730694, 64.48278528848037, 117.91619601145057, 57.773809246034965, 91.55285746037796, 41.90770636280711, 193.20515053356115, 118.82988444066594, 10.550401030820057, 257.67686108311955]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.770416238695541, "mean_inference_ms": 4.9293738380970655, "mean_action_processing_ms": 2.8966669275159704, "mean_env_wait_ms": 10.954587335571787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00392758846282959, "StateBufferConnector_ms": 0.00429987907409668, "ViewRequirementAgentConnector_ms": 0.13456571102142334}, "num_episodes": 24, "episode_return_max": 327.5447439559854, "episode_return_min": 34.300000000000225, "episode_return_mean": 172.43446050227453, "episodes_this_iter": 24}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.17372098254432, "num_env_steps_trained_throughput_per_sec": 85.17372098254432, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 47889.962, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47889.902, "sample_time_ms": 1999.975, "learn_time_ms": 45868.944, "learn_throughput": 87.205, "synch_weights_time_ms": 16.916}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-33-08", "timestamp": 1724148188, "time_this_iter_s": 47.00919723510742, "time_total_s": 756.6991751194, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33132b1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 756.6991751194, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 26.590909090909093, "ram_util_percent": 82.81818181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.259299021675472, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.131180166062855, "policy_loss": -0.01916724359025321, "vf_loss": 8.147782105491276, "vf_explained_var": 0.25833224070765987, "kl": 0.01282651866182547, "entropy": 1.232190191998053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8192172304978445, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.661346523345463, "policy_loss": -0.017969665627079034, "vf_loss": 6.676684838754159, "vf_explained_var": 0.153601753806311, "kl": 0.013156750309650623, "entropy": 1.1405782072001664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 327.5447439559854, "episode_reward_min": 34.300000000000225, "episode_reward_mean": 170.93011133589687, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -353.2601987086064, "predator_policy": 1.6137332412334513}, "policy_reward_max": {"prey_policy": 185.57860115887098, "predator_policy": 335.11978811636277}, "policy_reward_mean": {"prey_policy": -20.25920226187427, "predator_policy": 105.72425792982278}, "custom_metrics": {}, "hist_stats": {"episode_reward": [214.729875309036, 34.300000000000225, 278.1, 81.20000000000003, 196.82200793981534, 297.59999999999997, 217.58151079517754, 213.6397507465056, 189.68992584828348, 108.75142785414414, 168.3999999999997, 191.98912843847856, 222.79999999999964, 144.88460680504235, 151.00014750140625, 188.24288273039028, 177.63384335174587, 305.2663416812256, 151.22797934872023, 191.5980735150857, 188.251049678634, 152.2558203618665, 216.04940297623403, 87.39340937682778, 141.1760947304527, 294.71860873751007, 225.92207154019044, 80.12205673103153, 152.0988778051233, 154.48174157256554, 180.58641368556826, 299.9000000000001, 79.8571661949477, 258.3911685613993, 141.29618166048374, 194.79423421918537, 236.42283415801924, 265.4091974817432, 59.69995180439295, 169.6813259897698, 118.25630105161085, 148.6469157528707, 66.14743611432162, 93.99153769885558, 145.20997442432272, 91.71663674348866, 219.44606654111584, 183.3885379297514, 99.761580299862, 327.5447439559854, 292.0134944457408, 225.69999999999973, 118.64027400087085, 235.35985549058117, 135.2392467834744, 147.2498187243462, 133.16131286569137, 90.5628239742744, 100.9999999999994, 178.51164101812654, 247.21356952568763, 161.4658180811914, 295.8803014923277, 237.85129047318753, 145.40135418879518, 227.30797957094498, 178.94499641485666, 107.9639444075946, 175.68060466118106, 79.42790521500639, 262.913978761361, 216.89944455893476, 186.13817571184262, 64.8000000000002, 77.10000000000004, 297.5617755680233, 241.71708772222325, 68.51479111355528, 110.40851068161602, 134.28489321409697, 165.21603227494452, 122.89999999999966, 200.51298770138305, 174.7666800486497, 69.03192167157961, 188.3859975546716, 189.5315590430407, 142.69827653416658, 119.66289571222363, 71.24864534826946, 213.13947067531308, 261.89999999999986, 170.17155534580323, 66.74772473381086, 168.66223394853318, 147.6429711189916, 185.3067359152153, 202.87535523183706, 133.4328273066676, 126.1875351158714], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [134.18234856945662, -11.247217694438582, -146.36135355727578, -33.490570701043204, 92.28175346455212, -48.45778482282406, -65.94443794713997, 17.151691695626806, 52.48948445462587, 45.75794160912258, 86.40067484251946, 147.71967665777242, -1.366276286083381, 25.679199429985832, -19.571595392800965, 60.071546991997806, -21.563120583395403, 58.04167719329094, -14.372739245077005, -60.961659165368154, 115.31714877861627, 1.1283809152001287, 97.28479015465085, -3.638154926243814, -41.82944031236872, 68.34357657871931, 15.566120947457803, -93.07801008508564, -202.5039992111539, 68.01870886983497, -80.20466390382302, 16.407591093750952, -141.22457342663662, 77.22450933205057, 92.16357854389403, -1.1687662013201816, 11.782186942860351, -20.227399323966864, -145.3631391049415, 97.00888864258704, -98.82920312045451, 95.92919651497479, 69.27283303561369, -76.72549789771695, 155.06391014256351, -96.41491250397877, -143.55705762685636, 21.82331901826299, -167.48318214975228, 84.28166678125139, 122.87001371883039, 13.226866469681896, 178.12112418675432, -113.21270658714727, -2.7501013406213075, -89.797084109671, 3.3771450235231946, -107.0495940485901, -25.05854409189179, -135.40839576271793, 56.76916664506375, -108.57174989713755, 147.27068524365802, 93.89372781321157, -205.68824316438668, -33.278956735541335, 165.7772265612155, 16.116570029237693, -32.78866104911667, -73.88417539647607, 76.4039316212493, -128.16888968897769, -336.4074164988297, 179.21708686712, 39.922963498786295, 166.4567722775127, -243.15928384134008, -10.906393330543612, 46.73077737160448, -255.37950225367808, -30.276089896013502, -85.15691327320656, -119.33215153537202, 44.71030239874347, -47.47071527667541, -212.83724437797707, -95.69471781875325, -6.718273279763406, 30.25277037493501, -101.24846137702323, 10.413905805474643, -16.18939508541271, -33.083770690309805, 135.9430084880231, 90.2309117918012, -92.9314691147991, -127.45033899717416, 11.364491794163797, 140.55376686449296, 105.81420988589184, 185.57860115887098, 49.39462848793427, 69.20784728482415, 91.42415036617373, -40.902921135476305, -118.90870962492336, 14.304293727020069, 172.78022889137867, -87.5417044091091, -190.87931554465177, -188.86825276713597, 49.69826987932231, -73.62552963990157, 53.78309736298795, -94.99689693957667, -32.533068275464245, 5.156751962967017, -19.847552619792737, 11.936977547308334, -34.16745036844012, 132.19661635148006, -218.22639050894583, -35.599162311531835, 57.895756470592694, 60.15611735249166, 65.5413089461902, 45.196497239151775, 98.92795962730561, -155.20671219222567, 28.843602513236505, 4.916482618360632, 92.00931496944048, -72.03413062462727, 9.62047955192208, 27.68067444997376, -194.22791405198225, -124.88938840451223, 116.11697448722265, -80.48884888888884, -206.05085900077773, 112.27050277443051, -2.7415145106734897, -134.97963644095037, -59.6892048923078, 94.37478222179729, -158.9368247570857, -47.316732462548856, 44.959706696021115, -3.7566181276708335, -9.046127608281331, -132.25759729262649, 148.56881312677794, 105.51526695537598, 8.429575580781444, -185.35795770289425, -19.531578179338005, -19.363820887333056, -45.917673688535615, -54.95619240654181, 55.780521797453986, -166.19810761301937, 19.37910491373709, 80.91673484368145, -226.24399695762165, 59.65210426325001, -31.965203642879885, -353.2601987086064, 103.66816217658807, -152.5866769888466, -185.54158896497665, -136.3133364261371, 85.94369003877775, -262.2284365663062, 115.66456112832923, -17.154941182012834, -96.96845924094367, 11.59789844001816, -33.42634978260986, 17.26922542337686, -161.49553900362764, 83.02085343884983, -249.44078708215952, -17.768760530127313, 77.57542413151279, -122.0185783358541, 91.95010876558645, -95.35807152346725, -30.42832066435824, -41.35139403654241, -100.17795875093063, 93.2952945612546, -55.58879594585708, -220.06192879034543, 10.449924232285966, 18.71150654204821, -15.357242058143711, -68.27041518506016, -227.47735268996277, -118.33112044093875, 18.313169479820345], "policy_predator_policy_reward": [22.639353582820913, 69.1553908511974, 164.46135355727537, 49.690570701043434, 54.04834497457629, 180.22768638369567, 118.21566126633948, 11.777084985173309, 60.567541282013465, 38.00704059405387, 61.79932515748057, 1.680323342227584, 104.0028233185017, 89.26576433277333, 58.47338977074545, 114.6664093765637, 38.39927826777734, 114.81209097061101, 68.26098828472621, 115.8248379798639, 3.5384845104101723, 48.41598579577338, 25.678848632758122, 72.6636445773137, 42.15526892691783, 154.13059480673166, 14.732210353644149, 207.6642855890262, 176.69412990252087, 108.79130794020406, 139.7927345180595, 112.24722102240321, 118.2556057225658, 123.3783017237661, 107.35091227557392, 106.92061706307774, 74.81472264549603, 84.85846908433138, 133.57326326882122, 106.37906070861891, 109.87733417914617, 81.27372210496725, 34.737664657085894, 124.97082056688446, 94.91555076797411, 62.48485456967541, 201.23796175185012, 7.889186233570953, 150.08362207308272, 74.29398802587082, 130.900944632505, 27.72078391649287, 41.09019215160026, 119.92346178898306, 70.3366188599723, 102.33262332135162, 100.53693140364088, 155.23439542654955, 17.9814617394856, 296.9672196876897, 184.2235178181575, 48.165479119484615, 26.829314756341972, 31.90627218678851, 124.07729139183654, 194.74707470303892, 53.15898882145814, 23.33838314948812, 123.28353278952801, 124.68548531654821, 123.70209705241676, 122.85709523449694, 218.48108745688822, 175.13207633284065, 38.47321204426679, 20.556249661177862, 201.02197918830637, 112.74364978797001, 232.02787027845736, 146.3021805933866, 96.54256362477976, 137.14674059605105, 122.94197213610462, 100.32679275339467, 104.55978580255798, 221.89560996641575, 49.87895441545315, 146.5255743819192, 146.19984937131852, 70.00581605509257, 37.17392010373071, 60.318205919696744, 61.21134231821814, 55.3754864251845, 21.3604786851311, 164.7286165676182, 38.80395110040043, 177.04347640247198, 17.087075666031996, 64.08969153956846, 20.903437312515823, 36.136827486420124, 12.705512345331654, 52.36249000367027, 157.88748353849695, 120.56442122277319, 1.803074517868006, 46.472258354315045, 335.11978811636277, 78.54047862087265, 115.78026277633073, 170.63953883582886, 76.6976547068033, 76.30609043580274, 76.12833278387211, 141.96445640544368, 1.6137332412334513, 114.07706741559228, 163.08078902494807, 37.66132481431056, 147.1269998949133, 186.11634378824004, 74.78993059704754, 64.37929332508315, 115.13571640522102, 55.04715878842481, 52.94840328254248, 40.778430324188086, 152.68420571471225, 119.08025815307214, 89.54270005254858, 40.8394819305951, 75.38028916814605, 165.978358319416, 21.080209340285688, 253.43097466931764, 168.4918037635076, 15.961214814963219, 200.52627845448984, 165.44133465018257, 59.16666116892572, 94.21832932867828, 236.77058503572823, 174.79770085646476, 209.71849808527267, 40.981720161858334, 25.995319748535245, 41.161706017992586, 15.321728360834346, 74.58101737511802, 72.67920603603127, 208.5713536978404, 89.34354153230015, 38.42870365376596, 208.92154170730694, 64.48278528848037, 117.91619601145057, 57.773809246034965, 91.55285746037796, 41.90770636280711, 193.20515053356115, 118.82988444066594, 10.550401030820057, 257.67686108311955, 97.2084451001526, 75.61764198086101, 220.201059343556, 204.157657237112, 258.67457643812963, 148.48561118727292, 52.46443645940849, 186.29120748262247, 129.2520480463051, 206.8433864347127, 121.2937269937764, 135.52794996334697, 82.61633839879175, 58.87500865602307, 108.12411417570976, 107.35084475281039, 250.2678169452508, 129.29158737337215, 28.566011348149708, 173.52732505046473, 35.29854463188116, 164.9414802841897, 58.04048165908108, 134.49363526255502, 101.03560483935121, 209.1559818966552, 49.719186960940704, 60.21728554265348, 219.6724647501084, 175.24627572316666, 68.11244472425136, 131.40864602368165, 95.01887276094752, 334.1617224207432, 106.5714912155041, 119.63399486148523]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.562240705703, "mean_inference_ms": 4.862924939147376, "mean_action_processing_ms": 2.8190412771646742, "mean_env_wait_ms": 10.872245575828892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00781714916229248, "StateBufferConnector_ms": 0.004567980766296387, "ViewRequirementAgentConnector_ms": 0.13499271869659424}, "num_episodes": 18, "episode_return_max": 327.5447439559854, "episode_return_min": 34.300000000000225, "episode_return_mean": 170.93011133589687, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.67848652633172, "num_env_steps_trained_throughput_per_sec": 81.67848652633172, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 47637.017, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47636.96, "sample_time_ms": 2055.146, "learn_time_ms": 45561.417, "learn_throughput": 87.794, "synch_weights_time_ms": 16.74}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-33-57", "timestamp": 1724148237, "time_this_iter_s": 49.00679302215576, "time_total_s": 805.7059681415558, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33132e820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 805.7059681415558, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 29.958571428571435, "ram_util_percent": 83.11999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.593831394021473, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.699898207881463, "policy_loss": -0.018715380431059254, "vf_loss": 7.716213923661166, "vf_explained_var": 0.24539326867729266, "kl": 0.011998306661006555, "entropy": 1.2232399010784412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7660928986059927, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.371838043858765, "policy_loss": -0.01612589346717984, "vf_loss": 6.385594228461937, "vf_explained_var": 0.1300098488570521, "kl": 0.011848532776693227, "entropy": 1.1277245466355925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 327.5447439559854, "episode_reward_min": 41.371063300931056, "episode_reward_mean": 161.71872335266346, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -353.2601987086064, "predator_policy": 1.6137332412334513}, "policy_reward_max": {"prey_policy": 185.57860115887098, "predator_policy": 335.11978811636277}, "policy_reward_mean": {"prey_policy": -35.352385053530924, "predator_policy": 116.2117467298627}, "custom_metrics": {}, "hist_stats": {"episode_reward": [151.22797934872023, 191.5980735150857, 188.251049678634, 152.2558203618665, 216.04940297623403, 87.39340937682778, 141.1760947304527, 294.71860873751007, 225.92207154019044, 80.12205673103153, 152.0988778051233, 154.48174157256554, 180.58641368556826, 299.9000000000001, 79.8571661949477, 258.3911685613993, 141.29618166048374, 194.79423421918537, 236.42283415801924, 265.4091974817432, 59.69995180439295, 169.6813259897698, 118.25630105161085, 148.6469157528707, 66.14743611432162, 93.99153769885558, 145.20997442432272, 91.71663674348866, 219.44606654111584, 183.3885379297514, 99.761580299862, 327.5447439559854, 292.0134944457408, 225.69999999999973, 118.64027400087085, 235.35985549058117, 135.2392467834744, 147.2498187243462, 133.16131286569137, 90.5628239742744, 100.9999999999994, 178.51164101812654, 247.21356952568763, 161.4658180811914, 295.8803014923277, 237.85129047318753, 145.40135418879518, 227.30797957094498, 178.94499641485666, 107.9639444075946, 175.68060466118106, 79.42790521500639, 262.913978761361, 216.89944455893476, 186.13817571184262, 64.8000000000002, 77.10000000000004, 297.5617755680233, 241.71708772222325, 68.51479111355528, 110.40851068161602, 134.28489321409697, 165.21603227494452, 122.89999999999966, 200.51298770138305, 174.7666800486497, 69.03192167157961, 188.3859975546716, 189.5315590430407, 142.69827653416658, 119.66289571222363, 71.24864534826946, 213.13947067531308, 261.89999999999986, 170.17155534580323, 66.74772473381086, 168.66223394853318, 147.6429711189916, 185.3067359152153, 202.87535523183706, 133.4328273066676, 126.1875351158714, 134.9886826168127, 115.15249649279659, 217.18147522404172, 98.22825774037639, 88.3045709246996, 136.6390483310705, 101.25760539660448, 116.47383972768091, 214.6366381664419, 103.68627539802243, 69.44088546138683, 165.8159635816534, 242.62282256400783, 200.42197759629252, 156.34075464058472, 131.9574433401166, 41.371063300931056, 126.97285017438608], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [11.782186942860351, -20.227399323966864, -145.3631391049415, 97.00888864258704, -98.82920312045451, 95.92919651497479, 69.27283303561369, -76.72549789771695, 155.06391014256351, -96.41491250397877, -143.55705762685636, 21.82331901826299, -167.48318214975228, 84.28166678125139, 122.87001371883039, 13.226866469681896, 178.12112418675432, -113.21270658714727, -2.7501013406213075, -89.797084109671, 3.3771450235231946, -107.0495940485901, -25.05854409189179, -135.40839576271793, 56.76916664506375, -108.57174989713755, 147.27068524365802, 93.89372781321157, -205.68824316438668, -33.278956735541335, 165.7772265612155, 16.116570029237693, -32.78866104911667, -73.88417539647607, 76.4039316212493, -128.16888968897769, -336.4074164988297, 179.21708686712, 39.922963498786295, 166.4567722775127, -243.15928384134008, -10.906393330543612, 46.73077737160448, -255.37950225367808, -30.276089896013502, -85.15691327320656, -119.33215153537202, 44.71030239874347, -47.47071527667541, -212.83724437797707, -95.69471781875325, -6.718273279763406, 30.25277037493501, -101.24846137702323, 10.413905805474643, -16.18939508541271, -33.083770690309805, 135.9430084880231, 90.2309117918012, -92.9314691147991, -127.45033899717416, 11.364491794163797, 140.55376686449296, 105.81420988589184, 185.57860115887098, 49.39462848793427, 69.20784728482415, 91.42415036617373, -40.902921135476305, -118.90870962492336, 14.304293727020069, 172.78022889137867, -87.5417044091091, -190.87931554465177, -188.86825276713597, 49.69826987932231, -73.62552963990157, 53.78309736298795, -94.99689693957667, -32.533068275464245, 5.156751962967017, -19.847552619792737, 11.936977547308334, -34.16745036844012, 132.19661635148006, -218.22639050894583, -35.599162311531835, 57.895756470592694, 60.15611735249166, 65.5413089461902, 45.196497239151775, 98.92795962730561, -155.20671219222567, 28.843602513236505, 4.916482618360632, 92.00931496944048, -72.03413062462727, 9.62047955192208, 27.68067444997376, -194.22791405198225, -124.88938840451223, 116.11697448722265, -80.48884888888884, -206.05085900077773, 112.27050277443051, -2.7415145106734897, -134.97963644095037, -59.6892048923078, 94.37478222179729, -158.9368247570857, -47.316732462548856, 44.959706696021115, -3.7566181276708335, -9.046127608281331, -132.25759729262649, 148.56881312677794, 105.51526695537598, 8.429575580781444, -185.35795770289425, -19.531578179338005, -19.363820887333056, -45.917673688535615, -54.95619240654181, 55.780521797453986, -166.19810761301937, 19.37910491373709, 80.91673484368145, -226.24399695762165, 59.65210426325001, -31.965203642879885, -353.2601987086064, 103.66816217658807, -152.5866769888466, -185.54158896497665, -136.3133364261371, 85.94369003877775, -262.2284365663062, 115.66456112832923, -17.154941182012834, -96.96845924094367, 11.59789844001816, -33.42634978260986, 17.26922542337686, -161.49553900362764, 83.02085343884983, -249.44078708215952, -17.768760530127313, 77.57542413151279, -122.0185783358541, 91.95010876558645, -95.35807152346725, -30.42832066435824, -41.35139403654241, -100.17795875093063, 93.2952945612546, -55.58879594585708, -220.06192879034543, 10.449924232285966, 18.71150654204821, -15.357242058143711, -68.27041518506016, -227.47735268996277, -118.33112044093875, 18.313169479820345, -284.4257746594202, 45.77659200236469, 26.923892224728576, -143.20710048733332, 124.11502561957862, -156.24900875608606, -195.07395701179405, -103.48380024975145, -57.08848602268597, -201.41734815223532, -53.11337073953226, -45.13943752728662, -42.3005762043638, -77.06745068236954, -71.5842957331469, -107.77331602288689, 32.35239930787935, 27.97564544239017, -48.58655423873744, 2.7103465259023456, -118.24953667652389, -12.918301348935257, -27.528895559158673, 31.371143789641206, -192.26555594657103, 141.71766615631893, -80.61874416479488, 11.67894719160429, -141.41399189800975, -116.11931932083186, -315.4573774665059, 40.72526791238158, -163.17842675404123, -196.36432751427512, -105.42594421611841, -163.6865504896767], "policy_predator_policy_reward": [74.81472264549603, 84.85846908433138, 133.57326326882122, 106.37906070861891, 109.87733417914617, 81.27372210496725, 34.737664657085894, 124.97082056688446, 94.91555076797411, 62.48485456967541, 201.23796175185012, 7.889186233570953, 150.08362207308272, 74.29398802587082, 130.900944632505, 27.72078391649287, 41.09019215160026, 119.92346178898306, 70.3366188599723, 102.33262332135162, 100.53693140364088, 155.23439542654955, 17.9814617394856, 296.9672196876897, 184.2235178181575, 48.165479119484615, 26.829314756341972, 31.90627218678851, 124.07729139183654, 194.74707470303892, 53.15898882145814, 23.33838314948812, 123.28353278952801, 124.68548531654821, 123.70209705241676, 122.85709523449694, 218.48108745688822, 175.13207633284065, 38.47321204426679, 20.556249661177862, 201.02197918830637, 112.74364978797001, 232.02787027845736, 146.3021805933866, 96.54256362477976, 137.14674059605105, 122.94197213610462, 100.32679275339467, 104.55978580255798, 221.89560996641575, 49.87895441545315, 146.5255743819192, 146.19984937131852, 70.00581605509257, 37.17392010373071, 60.318205919696744, 61.21134231821814, 55.3754864251845, 21.3604786851311, 164.7286165676182, 38.80395110040043, 177.04347640247198, 17.087075666031996, 64.08969153956846, 20.903437312515823, 36.136827486420124, 12.705512345331654, 52.36249000367027, 157.88748353849695, 120.56442122277319, 1.803074517868006, 46.472258354315045, 335.11978811636277, 78.54047862087265, 115.78026277633073, 170.63953883582886, 76.6976547068033, 76.30609043580274, 76.12833278387211, 141.96445640544368, 1.6137332412334513, 114.07706741559228, 163.08078902494807, 37.66132481431056, 147.1269998949133, 186.11634378824004, 74.78993059704754, 64.37929332508315, 115.13571640522102, 55.04715878842481, 52.94840328254248, 40.778430324188086, 152.68420571471225, 119.08025815307214, 89.54270005254858, 40.8394819305951, 75.38028916814605, 165.978358319416, 21.080209340285688, 253.43097466931764, 168.4918037635076, 15.961214814963219, 200.52627845448984, 165.44133465018257, 59.16666116892572, 94.21832932867828, 236.77058503572823, 174.79770085646476, 209.71849808527267, 40.981720161858334, 25.995319748535245, 41.161706017992586, 15.321728360834346, 74.58101737511802, 72.67920603603127, 208.5713536978404, 89.34354153230015, 38.42870365376596, 208.92154170730694, 64.48278528848037, 117.91619601145057, 57.773809246034965, 91.55285746037796, 41.90770636280711, 193.20515053356115, 118.82988444066594, 10.550401030820057, 257.67686108311955, 97.2084451001526, 75.61764198086101, 220.201059343556, 204.157657237112, 258.67457643812963, 148.48561118727292, 52.46443645940849, 186.29120748262247, 129.2520480463051, 206.8433864347127, 121.2937269937764, 135.52794996334697, 82.61633839879175, 58.87500865602307, 108.12411417570976, 107.35084475281039, 250.2678169452508, 129.29158737337215, 28.566011348149708, 173.52732505046473, 35.29854463188116, 164.9414802841897, 58.04048165908108, 134.49363526255502, 101.03560483935121, 209.1559818966552, 49.719186960940704, 60.21728554265348, 219.6724647501084, 175.24627572316666, 68.11244472425136, 131.40864602368165, 95.01887276094752, 334.1617224207432, 106.5714912155041, 119.63399486148523, 224.54947081494294, 149.08839445892525, 17.060330525521593, 214.37537422987958, 47.15109913867847, 202.16435922187057, 215.82242087592633, 180.9635941259949, 175.431418735695, 171.37898636392538, 196.6159836427279, 38.27587295516189, 136.83462194158557, 83.79101034175264, 158.97415490432795, 136.8572965793868, 70.28888120297927, 84.01971221319342, 73.62572970109491, 75.93675340976306, 74.96024808854258, 125.6484753983036, 88.44460840097027, 73.52910695020118, 209.5865253634819, 83.58418699077806, 106.6450631247701, 162.71671144471324, 135.73340150654775, 278.140664352879, 324.9265864914193, 81.7629664028244, 189.63634135828227, 211.27747621096458, 179.0464191212534, 217.03892575892738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.451059335129519, "mean_inference_ms": 4.747250826735813, "mean_action_processing_ms": 2.684861448905333, "mean_env_wait_ms": 10.787152063184589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025505781173706055, "StateBufferConnector_ms": 0.004541158676147461, "ViewRequirementAgentConnector_ms": 0.14659786224365234}, "num_episodes": 18, "episode_return_max": 327.5447439559854, "episode_return_min": 41.371063300931056, "episode_return_mean": 161.71872335266346, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.65815054941181, "num_env_steps_trained_throughput_per_sec": 85.65815054941181, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 47443.506, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47443.449, "sample_time_ms": 2059.739, "learn_time_ms": 45365.133, "learn_throughput": 88.173, "synch_weights_time_ms": 15.143}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-34-44", "timestamp": 1724148284, "time_this_iter_s": 46.71210503578186, "time_total_s": 852.4180731773376, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12007aa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 852.4180731773376, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 25.598484848484844, "ram_util_percent": 80.7939393939394}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.716179990957654, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.966638083432717, "policy_loss": -0.020249521986472976, "vf_loss": 7.984346667042485, "vf_explained_var": 0.29691094973730664, "kl": 0.012704749009941542, "entropy": 1.1792256941871038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2611863167197614, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.449454292418465, "policy_loss": -0.01849475531695933, "vf_loss": 6.464968624569121, "vf_explained_var": 0.12209512711202027, "kl": 0.014902141448923401, "entropy": 1.0894493636946199, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 327.5447439559854, "episode_reward_min": 25.528897181222916, "episode_reward_mean": 154.4884302979969, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -353.2601987086064, "predator_policy": 1.6137332412334513}, "policy_reward_max": {"prey_policy": 185.57860115887098, "predator_policy": 335.11978811636277}, "policy_reward_mean": {"prey_policy": -45.980129002651346, "predator_policy": 123.22434415164986}, "custom_metrics": {}, "hist_stats": {"episode_reward": [194.79423421918537, 236.42283415801924, 265.4091974817432, 59.69995180439295, 169.6813259897698, 118.25630105161085, 148.6469157528707, 66.14743611432162, 93.99153769885558, 145.20997442432272, 91.71663674348866, 219.44606654111584, 183.3885379297514, 99.761580299862, 327.5447439559854, 292.0134944457408, 225.69999999999973, 118.64027400087085, 235.35985549058117, 135.2392467834744, 147.2498187243462, 133.16131286569137, 90.5628239742744, 100.9999999999994, 178.51164101812654, 247.21356952568763, 161.4658180811914, 295.8803014923277, 237.85129047318753, 145.40135418879518, 227.30797957094498, 178.94499641485666, 107.9639444075946, 175.68060466118106, 79.42790521500639, 262.913978761361, 216.89944455893476, 186.13817571184262, 64.8000000000002, 77.10000000000004, 297.5617755680233, 241.71708772222325, 68.51479111355528, 110.40851068161602, 134.28489321409697, 165.21603227494452, 122.89999999999966, 200.51298770138305, 174.7666800486497, 69.03192167157961, 188.3859975546716, 189.5315590430407, 142.69827653416658, 119.66289571222363, 71.24864534826946, 213.13947067531308, 261.89999999999986, 170.17155534580323, 66.74772473381086, 168.66223394853318, 147.6429711189916, 185.3067359152153, 202.87535523183706, 133.4328273066676, 126.1875351158714, 134.9886826168127, 115.15249649279659, 217.18147522404172, 98.22825774037639, 88.3045709246996, 136.6390483310705, 101.25760539660448, 116.47383972768091, 214.6366381664419, 103.68627539802243, 69.44088546138683, 165.8159635816534, 242.62282256400783, 200.42197759629252, 156.34075464058472, 131.9574433401166, 41.371063300931056, 126.97285017438608, 211.3349395745483, 210.4250171519459, 174.48226745608963, 183.66256117489058, 72.38887298987997, 156.6876340644959, 61.561463415880844, 132.0092221825465, 70.17841170381365, 95.28030663109774, 134.74582565052822, 254.87203601290219, 83.142965382093, 81.12663280294258, 25.528897181222916, 178.593156677493, 146.27660095761374], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [76.4039316212493, -128.16888968897769, -336.4074164988297, 179.21708686712, 39.922963498786295, 166.4567722775127, -243.15928384134008, -10.906393330543612, 46.73077737160448, -255.37950225367808, -30.276089896013502, -85.15691327320656, -119.33215153537202, 44.71030239874347, -47.47071527667541, -212.83724437797707, -95.69471781875325, -6.718273279763406, 30.25277037493501, -101.24846137702323, 10.413905805474643, -16.18939508541271, -33.083770690309805, 135.9430084880231, 90.2309117918012, -92.9314691147991, -127.45033899717416, 11.364491794163797, 140.55376686449296, 105.81420988589184, 185.57860115887098, 49.39462848793427, 69.20784728482415, 91.42415036617373, -40.902921135476305, -118.90870962492336, 14.304293727020069, 172.78022889137867, -87.5417044091091, -190.87931554465177, -188.86825276713597, 49.69826987932231, -73.62552963990157, 53.78309736298795, -94.99689693957667, -32.533068275464245, 5.156751962967017, -19.847552619792737, 11.936977547308334, -34.16745036844012, 132.19661635148006, -218.22639050894583, -35.599162311531835, 57.895756470592694, 60.15611735249166, 65.5413089461902, 45.196497239151775, 98.92795962730561, -155.20671219222567, 28.843602513236505, 4.916482618360632, 92.00931496944048, -72.03413062462727, 9.62047955192208, 27.68067444997376, -194.22791405198225, -124.88938840451223, 116.11697448722265, -80.48884888888884, -206.05085900077773, 112.27050277443051, -2.7415145106734897, -134.97963644095037, -59.6892048923078, 94.37478222179729, -158.9368247570857, -47.316732462548856, 44.959706696021115, -3.7566181276708335, -9.046127608281331, -132.25759729262649, 148.56881312677794, 105.51526695537598, 8.429575580781444, -185.35795770289425, -19.531578179338005, -19.363820887333056, -45.917673688535615, -54.95619240654181, 55.780521797453986, -166.19810761301937, 19.37910491373709, 80.91673484368145, -226.24399695762165, 59.65210426325001, -31.965203642879885, -353.2601987086064, 103.66816217658807, -152.5866769888466, -185.54158896497665, -136.3133364261371, 85.94369003877775, -262.2284365663062, 115.66456112832923, -17.154941182012834, -96.96845924094367, 11.59789844001816, -33.42634978260986, 17.26922542337686, -161.49553900362764, 83.02085343884983, -249.44078708215952, -17.768760530127313, 77.57542413151279, -122.0185783358541, 91.95010876558645, -95.35807152346725, -30.42832066435824, -41.35139403654241, -100.17795875093063, 93.2952945612546, -55.58879594585708, -220.06192879034543, 10.449924232285966, 18.71150654204821, -15.357242058143711, -68.27041518506016, -227.47735268996277, -118.33112044093875, 18.313169479820345, -284.4257746594202, 45.77659200236469, 26.923892224728576, -143.20710048733332, 124.11502561957862, -156.24900875608606, -195.07395701179405, -103.48380024975145, -57.08848602268597, -201.41734815223532, -53.11337073953226, -45.13943752728662, -42.3005762043638, -77.06745068236954, -71.5842957331469, -107.77331602288689, 32.35239930787935, 27.97564544239017, -48.58655423873744, 2.7103465259023456, -118.24953667652389, -12.918301348935257, -27.528895559158673, 31.371143789641206, -192.26555594657103, 141.71766615631893, -80.61874416479488, 11.67894719160429, -141.41399189800975, -116.11931932083186, -315.4573774665059, 40.72526791238158, -163.17842675404123, -196.36432751427512, -105.42594421611841, -163.6865504896767, -242.19962664038715, 137.65177307058843, -139.46726796954232, 71.94149678534241, 70.745525998709, -112.70015030992919, 136.75513374556002, -198.48808708213159, -92.15340211922317, -137.74539907198323, 48.28044425598925, -104.21624385674347, -192.89212883231494, -188.614228440558, -69.00251996512084, -40.68886120808028, -26.272772611142088, -3.30855736509505, -44.95819617226119, -228.38172431835892, 32.72159066549936, -177.07669042468518, 24.35109193359254, 78.40080162110215, -28.339721751961314, -166.2448928665785, -107.67270516626766, -241.18544476406586, -178.95245784293974, -82.96816132697627, -207.86172712935857, 39.130324944502235, -115.88046266683845, 18.240379915897282], "policy_predator_policy_reward": [123.70209705241676, 122.85709523449694, 218.48108745688822, 175.13207633284065, 38.47321204426679, 20.556249661177862, 201.02197918830637, 112.74364978797001, 232.02787027845736, 146.3021805933866, 96.54256362477976, 137.14674059605105, 122.94197213610462, 100.32679275339467, 104.55978580255798, 221.89560996641575, 49.87895441545315, 146.5255743819192, 146.19984937131852, 70.00581605509257, 37.17392010373071, 60.318205919696744, 61.21134231821814, 55.3754864251845, 21.3604786851311, 164.7286165676182, 38.80395110040043, 177.04347640247198, 17.087075666031996, 64.08969153956846, 20.903437312515823, 36.136827486420124, 12.705512345331654, 52.36249000367027, 157.88748353849695, 120.56442122277319, 1.803074517868006, 46.472258354315045, 335.11978811636277, 78.54047862087265, 115.78026277633073, 170.63953883582886, 76.6976547068033, 76.30609043580274, 76.12833278387211, 141.96445640544368, 1.6137332412334513, 114.07706741559228, 163.08078902494807, 37.66132481431056, 147.1269998949133, 186.11634378824004, 74.78993059704754, 64.37929332508315, 115.13571640522102, 55.04715878842481, 52.94840328254248, 40.778430324188086, 152.68420571471225, 119.08025815307214, 89.54270005254858, 40.8394819305951, 75.38028916814605, 165.978358319416, 21.080209340285688, 253.43097466931764, 168.4918037635076, 15.961214814963219, 200.52627845448984, 165.44133465018257, 59.16666116892572, 94.21832932867828, 236.77058503572823, 174.79770085646476, 209.71849808527267, 40.981720161858334, 25.995319748535245, 41.161706017992586, 15.321728360834346, 74.58101737511802, 72.67920603603127, 208.5713536978404, 89.34354153230015, 38.42870365376596, 208.92154170730694, 64.48278528848037, 117.91619601145057, 57.773809246034965, 91.55285746037796, 41.90770636280711, 193.20515053356115, 118.82988444066594, 10.550401030820057, 257.67686108311955, 97.2084451001526, 75.61764198086101, 220.201059343556, 204.157657237112, 258.67457643812963, 148.48561118727292, 52.46443645940849, 186.29120748262247, 129.2520480463051, 206.8433864347127, 121.2937269937764, 135.52794996334697, 82.61633839879175, 58.87500865602307, 108.12411417570976, 107.35084475281039, 250.2678169452508, 129.29158737337215, 28.566011348149708, 173.52732505046473, 35.29854463188116, 164.9414802841897, 58.04048165908108, 134.49363526255502, 101.03560483935121, 209.1559818966552, 49.719186960940704, 60.21728554265348, 219.6724647501084, 175.24627572316666, 68.11244472425136, 131.40864602368165, 95.01887276094752, 334.1617224207432, 106.5714912155041, 119.63399486148523, 224.54947081494294, 149.08839445892525, 17.060330525521593, 214.37537422987958, 47.15109913867847, 202.16435922187057, 215.82242087592633, 180.9635941259949, 175.431418735695, 171.37898636392538, 196.6159836427279, 38.27587295516189, 136.83462194158557, 83.79101034175264, 158.97415490432795, 136.8572965793868, 70.28888120297927, 84.01971221319342, 73.62572970109491, 75.93675340976306, 74.96024808854258, 125.6484753983036, 88.44460840097027, 73.52910695020118, 209.5865253634819, 83.58418699077806, 106.6450631247701, 162.71671144471324, 135.73340150654775, 278.140664352879, 324.9265864914193, 81.7629664028244, 189.63634135828227, 211.27747621096458, 179.0464191212534, 217.03892575892738, 182.25147706752148, 133.63131607682547, 194.86691345810928, 83.08387487803655, 112.84688627980952, 103.59000548750035, 8.30742742933112, 237.08808708213147, 187.12953455500644, 115.15813962607973, 51.50615353866585, 161.11728012658443, 237.11796486752598, 205.94985582122757, 58.71806577697165, 182.9825375787768, 79.22597097450229, 20.533770705548562, 147.5727957870479, 221.04743133466965, 61.41642444160369, 217.68450096811105, 61.40902149371918, 90.71112096448839, 156.59833948359469, 121.12924051703746, 251.65852010623618, 178.32626262703945, 25.54532813979722, 261.9041882113413, 120.05545382526454, 227.26910503708498, 152.4965283804942, 91.42015532806072]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.34653416598158, "mean_inference_ms": 4.651082269632678, "mean_action_processing_ms": 2.596759297983476, "mean_env_wait_ms": 10.741441883255856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04436683654785156, "StateBufferConnector_ms": 0.0050318241119384766, "ViewRequirementAgentConnector_ms": 0.1500464677810669}, "num_episodes": 17, "episode_return_max": 327.5447439559854, "episode_return_min": 25.528897181222916, "episode_return_mean": 154.4884302979969, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.05579838475354, "num_env_steps_trained_throughput_per_sec": 85.05579838475354, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 47384.739, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47384.668, "sample_time_ms": 2056.562, "learn_time_ms": 45309.347, "learn_throughput": 88.282, "synch_weights_time_ms": 15.163}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-35-31", "timestamp": 1724148331, "time_this_iter_s": 47.076552867889404, "time_total_s": 899.494626045227, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33133b3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 899.494626045227, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 25.934848484848487, "ram_util_percent": 81.75454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.049992459602457, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.150599544515055, "policy_loss": -0.019443137534135194, "vf_loss": 8.167452274050031, "vf_explained_var": 0.28818497582087443, "kl": 0.012951961219330472, "entropy": 1.140241365836411, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.707378948870159, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.708154690202582, "policy_loss": -0.01586298585657484, "vf_loss": 6.721691613222556, "vf_explained_var": 0.14998166589509873, "kl": 0.011630266754784518, "entropy": 1.0432807407997273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 297.5617755680233, "episode_reward_min": 25.528897181222916, "episode_reward_mean": 141.57910824827513, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -353.2601987086064, "predator_policy": 3.668086803472458}, "policy_reward_max": {"prey_policy": 148.56881312677794, "predator_policy": 334.1617224207432}, "policy_reward_mean": {"prey_policy": -64.97047107249392, "predator_policy": 135.76002519663157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [247.21356952568763, 161.4658180811914, 295.8803014923277, 237.85129047318753, 145.40135418879518, 227.30797957094498, 178.94499641485666, 107.9639444075946, 175.68060466118106, 79.42790521500639, 262.913978761361, 216.89944455893476, 186.13817571184262, 64.8000000000002, 77.10000000000004, 297.5617755680233, 241.71708772222325, 68.51479111355528, 110.40851068161602, 134.28489321409697, 165.21603227494452, 122.89999999999966, 200.51298770138305, 174.7666800486497, 69.03192167157961, 188.3859975546716, 189.5315590430407, 142.69827653416658, 119.66289571222363, 71.24864534826946, 213.13947067531308, 261.89999999999986, 170.17155534580323, 66.74772473381086, 168.66223394853318, 147.6429711189916, 185.3067359152153, 202.87535523183706, 133.4328273066676, 126.1875351158714, 134.9886826168127, 115.15249649279659, 217.18147522404172, 98.22825774037639, 88.3045709246996, 136.6390483310705, 101.25760539660448, 116.47383972768091, 214.6366381664419, 103.68627539802243, 69.44088546138683, 165.8159635816534, 242.62282256400783, 200.42197759629252, 156.34075464058472, 131.9574433401166, 41.371063300931056, 126.97285017438608, 211.3349395745483, 210.4250171519459, 174.48226745608963, 183.66256117489058, 72.38887298987997, 156.6876340644959, 61.561463415880844, 132.0092221825465, 70.17841170381365, 95.28030663109774, 134.74582565052822, 254.87203601290219, 83.142965382093, 81.12663280294258, 25.528897181222916, 178.593156677493, 146.27660095761374, 106.98331472956184, 84.34312403495284, 76.01341952818026, 90.76836967923657, 217.66322270446804, 94.79999999999993, 133.4375194091713, 131.02987444768658, 186.9566985020172, 69.8017807896687, 113.10000000000011, 81.17093098413498, 195.9965229896382, 91.24583926926304, 99.86499851079137, 27.716106512033825, 85.29042520661457, 121.43874489734286, 108.46866830581307, 151.03263468941736, 86.91793547088426, 98.93644252447675, 201.5318481316505, 105.11511517922091, 27.000000000000092], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [132.19661635148006, -218.22639050894583, -35.599162311531835, 57.895756470592694, 60.15611735249166, 65.5413089461902, 45.196497239151775, 98.92795962730561, -155.20671219222567, 28.843602513236505, 4.916482618360632, 92.00931496944048, -72.03413062462727, 9.62047955192208, 27.68067444997376, -194.22791405198225, -124.88938840451223, 116.11697448722265, -80.48884888888884, -206.05085900077773, 112.27050277443051, -2.7415145106734897, -134.97963644095037, -59.6892048923078, 94.37478222179729, -158.9368247570857, -47.316732462548856, 44.959706696021115, -3.7566181276708335, -9.046127608281331, -132.25759729262649, 148.56881312677794, 105.51526695537598, 8.429575580781444, -185.35795770289425, -19.531578179338005, -19.363820887333056, -45.917673688535615, -54.95619240654181, 55.780521797453986, -166.19810761301937, 19.37910491373709, 80.91673484368145, -226.24399695762165, 59.65210426325001, -31.965203642879885, -353.2601987086064, 103.66816217658807, -152.5866769888466, -185.54158896497665, -136.3133364261371, 85.94369003877775, -262.2284365663062, 115.66456112832923, -17.154941182012834, -96.96845924094367, 11.59789844001816, -33.42634978260986, 17.26922542337686, -161.49553900362764, 83.02085343884983, -249.44078708215952, -17.768760530127313, 77.57542413151279, -122.0185783358541, 91.95010876558645, -95.35807152346725, -30.42832066435824, -41.35139403654241, -100.17795875093063, 93.2952945612546, -55.58879594585708, -220.06192879034543, 10.449924232285966, 18.71150654204821, -15.357242058143711, -68.27041518506016, -227.47735268996277, -118.33112044093875, 18.313169479820345, -284.4257746594202, 45.77659200236469, 26.923892224728576, -143.20710048733332, 124.11502561957862, -156.24900875608606, -195.07395701179405, -103.48380024975145, -57.08848602268597, -201.41734815223532, -53.11337073953226, -45.13943752728662, -42.3005762043638, -77.06745068236954, -71.5842957331469, -107.77331602288689, 32.35239930787935, 27.97564544239017, -48.58655423873744, 2.7103465259023456, -118.24953667652389, -12.918301348935257, -27.528895559158673, 31.371143789641206, -192.26555594657103, 141.71766615631893, -80.61874416479488, 11.67894719160429, -141.41399189800975, -116.11931932083186, -315.4573774665059, 40.72526791238158, -163.17842675404123, -196.36432751427512, -105.42594421611841, -163.6865504896767, -242.19962664038715, 137.65177307058843, -139.46726796954232, 71.94149678534241, 70.745525998709, -112.70015030992919, 136.75513374556002, -198.48808708213159, -92.15340211922317, -137.74539907198323, 48.28044425598925, -104.21624385674347, -192.89212883231494, -188.614228440558, -69.00251996512084, -40.68886120808028, -26.272772611142088, -3.30855736509505, -44.95819617226119, -228.38172431835892, 32.72159066549936, -177.07669042468518, 24.35109193359254, 78.40080162110215, -28.339721751961314, -166.2448928665785, -107.67270516626766, -241.18544476406586, -178.95245784293974, -82.96816132697627, -207.86172712935857, 39.130324944502235, -115.88046266683845, 18.240379915897282, -170.330782622374, -43.89280715550609, -174.01427629398304, -81.09416178646562, -154.21853766300137, -113.19856378665118, -272.780360717411, -10.501990722477911, 69.51254373621373, -99.59175952607565, 16.031913196527505, -0.437748621609348, 5.024809272615512, -282.7151092894559, 0.32260525677732543, -181.52836444551596, 16.927122244554432, -253.90816997277827, -49.54511761320206, -122.36958304744668, -58.69154534327786, -55.486547109571816, 15.454277040689838, -47.649373740176614, 103.73472745901438, -176.13024398759035, -63.02609170485629, -213.83873984255408, -31.067680956763105, -161.60510568383597, -350.1499215015965, 13.656649122235752, -239.12446491456853, -199.39428933125728, -32.70965776990329, 52.76160493738219, -20.115190968105942, -59.01827634895616, -12.167887786484366, -116.25117097750488, -203.7572525094447, -67.06242797304577, -184.38346921680497, -43.6888601864702, 79.98716578197934, -177.6794622914645, -251.39280772748162, -102.98880008329623, -295.5932638141931, -41.78464893508553], "policy_predator_policy_reward": [147.1269998949133, 186.11634378824004, 74.78993059704754, 64.37929332508315, 115.13571640522102, 55.04715878842481, 52.94840328254248, 40.778430324188086, 152.68420571471225, 119.08025815307214, 89.54270005254858, 40.8394819305951, 75.38028916814605, 165.978358319416, 21.080209340285688, 253.43097466931764, 168.4918037635076, 15.961214814963219, 200.52627845448984, 165.44133465018257, 59.16666116892572, 94.21832932867828, 236.77058503572823, 174.79770085646476, 209.71849808527267, 40.981720161858334, 25.995319748535245, 41.161706017992586, 15.321728360834346, 74.58101737511802, 72.67920603603127, 208.5713536978404, 89.34354153230015, 38.42870365376596, 208.92154170730694, 64.48278528848037, 117.91619601145057, 57.773809246034965, 91.55285746037796, 41.90770636280711, 193.20515053356115, 118.82988444066594, 10.550401030820057, 257.67686108311955, 97.2084451001526, 75.61764198086101, 220.201059343556, 204.157657237112, 258.67457643812963, 148.48561118727292, 52.46443645940849, 186.29120748262247, 129.2520480463051, 206.8433864347127, 121.2937269937764, 135.52794996334697, 82.61633839879175, 58.87500865602307, 108.12411417570976, 107.35084475281039, 250.2678169452508, 129.29158737337215, 28.566011348149708, 173.52732505046473, 35.29854463188116, 164.9414802841897, 58.04048165908108, 134.49363526255502, 101.03560483935121, 209.1559818966552, 49.719186960940704, 60.21728554265348, 219.6724647501084, 175.24627572316666, 68.11244472425136, 131.40864602368165, 95.01887276094752, 334.1617224207432, 106.5714912155041, 119.63399486148523, 224.54947081494294, 149.08839445892525, 17.060330525521593, 214.37537422987958, 47.15109913867847, 202.16435922187057, 215.82242087592633, 180.9635941259949, 175.431418735695, 171.37898636392538, 196.6159836427279, 38.27587295516189, 136.83462194158557, 83.79101034175264, 158.97415490432795, 136.8572965793868, 70.28888120297927, 84.01971221319342, 73.62572970109491, 75.93675340976306, 74.96024808854258, 125.6484753983036, 88.44460840097027, 73.52910695020118, 209.5865253634819, 83.58418699077806, 106.6450631247701, 162.71671144471324, 135.73340150654775, 278.140664352879, 324.9265864914193, 81.7629664028244, 189.63634135828227, 211.27747621096458, 179.0464191212534, 217.03892575892738, 182.25147706752148, 133.63131607682547, 194.86691345810928, 83.08387487803655, 112.84688627980952, 103.59000548750035, 8.30742742933112, 237.08808708213147, 187.12953455500644, 115.15813962607973, 51.50615353866585, 161.11728012658443, 237.11796486752598, 205.94985582122757, 58.71806577697165, 182.9825375787768, 79.22597097450229, 20.533770705548562, 147.5727957870479, 221.04743133466965, 61.41642444160369, 217.68450096811105, 61.40902149371918, 90.71112096448839, 156.59833948359469, 121.12924051703746, 251.65852010623618, 178.32626262703945, 25.54532813979722, 261.9041882113413, 120.05545382526454, 227.26910503708498, 152.4965283804942, 91.42015532806072, 246.52798529101884, 74.67891921642313, 193.89015562854127, 145.56140648685994, 178.79258804839952, 164.63793292943285, 284.4588120880407, 89.59190903108525, 95.0344272825042, 152.70801121182612, 3.668086803472458, 75.53774862160907, 202.2093288024407, 208.91849062357193, 195.69224396416365, 116.5433896722619, 145.16665230944224, 278.7710939207994, 216.27487067072988, 25.441610779587897, 92.99154534327796, 134.28654710957176, 23.529861836596687, 89.8361658470251, 193.14482698061437, 75.24721253760015, 217.1265570640514, 150.98411375262168, 98.98272050320797, 193.5550646481833, 278.0365561387334, 86.17282275266092, 289.26665635847, 234.54252309397017, 64.37532168791974, 37.01147604194458, 79.08603485602303, 108.51610076685289, 33.58582282273951, 245.8658706306674, 123.65438170264784, 234.0832342507272, 291.6624607827454, 35.34631114500736, 146.34744453903627, 152.87670010209956, 271.60689733662167, 187.88982565337676, 304.8932638141932, 59.484648935085765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.256317302940087, "mean_inference_ms": 4.5495492961417705, "mean_action_processing_ms": 2.4516093070415974, "mean_env_wait_ms": 10.673391000808074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044431090354919434, "StateBufferConnector_ms": 0.005175590515136719, "ViewRequirementAgentConnector_ms": 0.13666844367980957}, "num_episodes": 25, "episode_return_max": 297.5617755680233, "episode_return_min": 25.528897181222916, "episode_return_mean": 141.57910824827513, "episodes_this_iter": 25}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.19552845673779, "num_env_steps_trained_throughput_per_sec": 85.19552845673779, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 47325.81, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47325.739, "sample_time_ms": 2063.818, "learn_time_ms": 45245.131, "learn_throughput": 88.407, "synch_weights_time_ms": 13.157}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-36-18", "timestamp": 1724148378, "time_this_iter_s": 46.9739511013031, "time_total_s": 946.4685771465302, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33132b280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 946.4685771465302, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 25.437313432835822, "ram_util_percent": 82.18507462686568}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.87084022243187, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.626522419440053, "policy_loss": -0.022481795411221882, "vf_loss": 7.646149029050554, "vf_explained_var": 0.35428991267290066, "kl": 0.014275894322674032, "entropy": 1.1038002885207927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8505676663741863, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.609519445833075, "policy_loss": -0.014774295202057277, "vf_loss": 6.622434795975054, "vf_explained_var": 0.1086001836748981, "kl": 0.009294709448318278, "entropy": 1.0270739416281383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 261.89999999999986, "episode_reward_min": 25.528897181222916, "episode_reward_mean": 129.88530277597442, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -353.2601987086064, "predator_policy": 3.668086803472458}, "policy_reward_max": {"prey_policy": 175.1070082422271, "predator_policy": 334.1617224207432}, "policy_reward_mean": {"prey_policy": -83.6925636038509, "predator_policy": 148.63521499183815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.7666800486497, 69.03192167157961, 188.3859975546716, 189.5315590430407, 142.69827653416658, 119.66289571222363, 71.24864534826946, 213.13947067531308, 261.89999999999986, 170.17155534580323, 66.74772473381086, 168.66223394853318, 147.6429711189916, 185.3067359152153, 202.87535523183706, 133.4328273066676, 126.1875351158714, 134.9886826168127, 115.15249649279659, 217.18147522404172, 98.22825774037639, 88.3045709246996, 136.6390483310705, 101.25760539660448, 116.47383972768091, 214.6366381664419, 103.68627539802243, 69.44088546138683, 165.8159635816534, 242.62282256400783, 200.42197759629252, 156.34075464058472, 131.9574433401166, 41.371063300931056, 126.97285017438608, 211.3349395745483, 210.4250171519459, 174.48226745608963, 183.66256117489058, 72.38887298987997, 156.6876340644959, 61.561463415880844, 132.0092221825465, 70.17841170381365, 95.28030663109774, 134.74582565052822, 254.87203601290219, 83.142965382093, 81.12663280294258, 25.528897181222916, 178.593156677493, 146.27660095761374, 106.98331472956184, 84.34312403495284, 76.01341952818026, 90.76836967923657, 217.66322270446804, 94.79999999999993, 133.4375194091713, 131.02987444768658, 186.9566985020172, 69.8017807896687, 113.10000000000011, 81.17093098413498, 195.9965229896382, 91.24583926926304, 99.86499851079137, 27.716106512033825, 85.29042520661457, 121.43874489734286, 108.46866830581307, 151.03263468941736, 86.91793547088426, 98.93644252447675, 201.5318481316505, 105.11511517922091, 27.000000000000092, 62.69140326732246, 182.30880318457415, 123.24366545991133, 71.47685103406499, 107.258596737961, 137.73484866706372, 198.76740106787972, 122.52364200420605, 216.63637544158541, 215.34453924093427, 104.00849484074578, 38.73586374656626, 62.25888117893852, 185.16800843992183, 143.92030956109258, 82.44966788366241, 110.06879198011025, 56.01075777851723, 125.55685203794451, 77.07276380051852, 171.64962570617968, 116.49999999999994, 125.33875104898192], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-353.2601987086064, 103.66816217658807, -152.5866769888466, -185.54158896497665, -136.3133364261371, 85.94369003877775, -262.2284365663062, 115.66456112832923, -17.154941182012834, -96.96845924094367, 11.59789844001816, -33.42634978260986, 17.26922542337686, -161.49553900362764, 83.02085343884983, -249.44078708215952, -17.768760530127313, 77.57542413151279, -122.0185783358541, 91.95010876558645, -95.35807152346725, -30.42832066435824, -41.35139403654241, -100.17795875093063, 93.2952945612546, -55.58879594585708, -220.06192879034543, 10.449924232285966, 18.71150654204821, -15.357242058143711, -68.27041518506016, -227.47735268996277, -118.33112044093875, 18.313169479820345, -284.4257746594202, 45.77659200236469, 26.923892224728576, -143.20710048733332, 124.11502561957862, -156.24900875608606, -195.07395701179405, -103.48380024975145, -57.08848602268597, -201.41734815223532, -53.11337073953226, -45.13943752728662, -42.3005762043638, -77.06745068236954, -71.5842957331469, -107.77331602288689, 32.35239930787935, 27.97564544239017, -48.58655423873744, 2.7103465259023456, -118.24953667652389, -12.918301348935257, -27.528895559158673, 31.371143789641206, -192.26555594657103, 141.71766615631893, -80.61874416479488, 11.67894719160429, -141.41399189800975, -116.11931932083186, -315.4573774665059, 40.72526791238158, -163.17842675404123, -196.36432751427512, -105.42594421611841, -163.6865504896767, -242.19962664038715, 137.65177307058843, -139.46726796954232, 71.94149678534241, 70.745525998709, -112.70015030992919, 136.75513374556002, -198.48808708213159, -92.15340211922317, -137.74539907198323, 48.28044425598925, -104.21624385674347, -192.89212883231494, -188.614228440558, -69.00251996512084, -40.68886120808028, -26.272772611142088, -3.30855736509505, -44.95819617226119, -228.38172431835892, 32.72159066549936, -177.07669042468518, 24.35109193359254, 78.40080162110215, -28.339721751961314, -166.2448928665785, -107.67270516626766, -241.18544476406586, -178.95245784293974, -82.96816132697627, -207.86172712935857, 39.130324944502235, -115.88046266683845, 18.240379915897282, -170.330782622374, -43.89280715550609, -174.01427629398304, -81.09416178646562, -154.21853766300137, -113.19856378665118, -272.780360717411, -10.501990722477911, 69.51254373621373, -99.59175952607565, 16.031913196527505, -0.437748621609348, 5.024809272615512, -282.7151092894559, 0.32260525677732543, -181.52836444551596, 16.927122244554432, -253.90816997277827, -49.54511761320206, -122.36958304744668, -58.69154534327786, -55.486547109571816, 15.454277040689838, -47.649373740176614, 103.73472745901438, -176.13024398759035, -63.02609170485629, -213.83873984255408, -31.067680956763105, -161.60510568383597, -350.1499215015965, 13.656649122235752, -239.12446491456853, -199.39428933125728, -32.70965776990329, 52.76160493738219, -20.115190968105942, -59.01827634895616, -12.167887786484366, -116.25117097750488, -203.7572525094447, -67.06242797304577, -184.38346921680497, -43.6888601864702, 79.98716578197934, -177.6794622914645, -251.39280772748162, -102.98880008329623, -295.5932638141931, -41.78464893508553, -242.75492058948998, -119.56763768774024, -38.987519351161815, 7.560023706357781, -295.9074969501031, 18.648675230555412, -70.56433596304562, -251.36721787330555, -128.35189946655424, -44.739399394420566, -63.992182668431504, 10.368123887210912, 32.955628324335024, -166.62458507923046, -271.9309520146129, -56.71305729467457, -203.35086880366242, 77.80207842200636, 175.1070082422271, -205.70659776291168, -67.58961152138934, -184.9581665293648, -207.40629994556497, -212.84964613439507, -55.378396107436906, -198.57838057422794, 56.0663380806618, -93.77750096323993, -353.1505286424932, 87.02329516670939, -126.86731761934794, 15.319864730836875, 19.74733674260537, -217.28947647306012, -88.4733562480029, 20.39939149767388, -12.114691900391476, -251.7299654035778, -289.57598113613767, -182.34824829663052, -86.94937574457485, -39.761687176141976, 5.044043458384493, -14.428235111172786, -322.190960439724, -20.517112297863946], "policy_predator_policy_reward": [220.201059343556, 204.157657237112, 258.67457643812963, 148.48561118727292, 52.46443645940849, 186.29120748262247, 129.2520480463051, 206.8433864347127, 121.2937269937764, 135.52794996334697, 82.61633839879175, 58.87500865602307, 108.12411417570976, 107.35084475281039, 250.2678169452508, 129.29158737337215, 28.566011348149708, 173.52732505046473, 35.29854463188116, 164.9414802841897, 58.04048165908108, 134.49363526255502, 101.03560483935121, 209.1559818966552, 49.719186960940704, 60.21728554265348, 219.6724647501084, 175.24627572316666, 68.11244472425136, 131.40864602368165, 95.01887276094752, 334.1617224207432, 106.5714912155041, 119.63399486148523, 224.54947081494294, 149.08839445892525, 17.060330525521593, 214.37537422987958, 47.15109913867847, 202.16435922187057, 215.82242087592633, 180.9635941259949, 175.431418735695, 171.37898636392538, 196.6159836427279, 38.27587295516189, 136.83462194158557, 83.79101034175264, 158.97415490432795, 136.8572965793868, 70.28888120297927, 84.01971221319342, 73.62572970109491, 75.93675340976306, 74.96024808854258, 125.6484753983036, 88.44460840097027, 73.52910695020118, 209.5865253634819, 83.58418699077806, 106.6450631247701, 162.71671144471324, 135.73340150654775, 278.140664352879, 324.9265864914193, 81.7629664028244, 189.63634135828227, 211.27747621096458, 179.0464191212534, 217.03892575892738, 182.25147706752148, 133.63131607682547, 194.86691345810928, 83.08387487803655, 112.84688627980952, 103.59000548750035, 8.30742742933112, 237.08808708213147, 187.12953455500644, 115.15813962607973, 51.50615353866585, 161.11728012658443, 237.11796486752598, 205.94985582122757, 58.71806577697165, 182.9825375787768, 79.22597097450229, 20.533770705548562, 147.5727957870479, 221.04743133466965, 61.41642444160369, 217.68450096811105, 61.40902149371918, 90.71112096448839, 156.59833948359469, 121.12924051703746, 251.65852010623618, 178.32626262703945, 25.54532813979722, 261.9041882113413, 120.05545382526454, 227.26910503708498, 152.4965283804942, 91.42015532806072, 246.52798529101884, 74.67891921642313, 193.89015562854127, 145.56140648685994, 178.79258804839952, 164.63793292943285, 284.4588120880407, 89.59190903108525, 95.0344272825042, 152.70801121182612, 3.668086803472458, 75.53774862160907, 202.2093288024407, 208.91849062357193, 195.69224396416365, 116.5433896722619, 145.16665230944224, 278.7710939207994, 216.27487067072988, 25.441610779587897, 92.99154534327796, 134.28654710957176, 23.529861836596687, 89.8361658470251, 193.14482698061437, 75.24721253760015, 217.1265570640514, 150.98411375262168, 98.98272050320797, 193.5550646481833, 278.0365561387334, 86.17282275266092, 289.26665635847, 234.54252309397017, 64.37532168791974, 37.01147604194458, 79.08603485602303, 108.51610076685289, 33.58582282273951, 245.8658706306674, 123.65438170264784, 234.0832342507272, 291.6624607827454, 35.34631114500736, 146.34744453903627, 152.87670010209956, 271.60689733662167, 187.88982565337676, 304.8932638141932, 59.484648935085765, 185.98567227998896, 239.02828926456357, 86.43326688408226, 127.3030319452963, 141.83363949038667, 258.6688476890721, 118.84941744518802, 274.558987425228, 117.6671871880995, 162.68270841083654, 100.00182651576576, 91.35708093251839, 243.43629304831933, 89.00006477445592, 249.8349898528563, 201.33266146063647, 130.23378001321882, 211.9513858100226, 45.97145309769681, 199.97267566392182, 246.9441619727555, 109.61211091874462, 209.15379734378024, 249.8380124827459, 172.96973422505562, 143.24592363554765, 83.38003344283723, 139.4991378796629, 214.807305923178, 195.24023711369873, 188.0918546659186, 5.905266106255192, 33.81131961903651, 273.7996120915285, 77.47871213179576, 46.60601039704941, 118.18326784528603, 271.2182414966278, 268.97618462021177, 280.0208086130748, 128.74085872561668, 169.61982990127993, 56.355956541615626, 69.52823511117283, 314.08184597347275, 153.96497781309765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.156181847302471, "mean_inference_ms": 4.463469113582, "mean_action_processing_ms": 2.3795616030940594, "mean_env_wait_ms": 10.624646396048874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044014930725097656, "StateBufferConnector_ms": 0.010324478149414062, "ViewRequirementAgentConnector_ms": 0.12609779834747314}, "num_episodes": 23, "episode_return_max": 261.89999999999986, "episode_return_min": 25.528897181222916, "episode_return_mean": 129.88530277597442, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.73017065438385, "num_env_steps_trained_throughput_per_sec": 83.73017065438385, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 47336.633, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47336.561, "sample_time_ms": 2110.644, "learn_time_ms": 45209.287, "learn_throughput": 88.477, "synch_weights_time_ms": 13.19}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-37-06", "timestamp": 1724148426, "time_this_iter_s": 47.82767724990845, "time_total_s": 994.2962543964386, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33132f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 994.2962543964386, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 26.7820895522388, "ram_util_percent": 82.55074626865672}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.051865324772224, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.769639758710508, "policy_loss": -0.019852821392416165, "vf_loss": 7.786933007063689, "vf_explained_var": 0.24415208315723158, "kl": 0.01279785824919898, "entropy": 1.1153366915132634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8169417228017535, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.1044642539251415, "policy_loss": -0.0179140548556846, "vf_loss": 6.12001671967683, "vf_explained_var": 0.14888282654777404, "kl": 0.011807911002160932, "entropy": 1.058995723787439, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 256.5661462948361, "episode_reward_min": 25.528897181222916, "episode_reward_mean": 123.07155130581668, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -353.1505286424932, "predator_policy": 3.668086803472458}, "policy_reward_max": {"prey_policy": 197.98802825434706, "predator_policy": 324.9265864914193}, "policy_reward_mean": {"prey_policy": -89.55888792325295, "predator_policy": 151.09466357616134}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.9886826168127, 115.15249649279659, 217.18147522404172, 98.22825774037639, 88.3045709246996, 136.6390483310705, 101.25760539660448, 116.47383972768091, 214.6366381664419, 103.68627539802243, 69.44088546138683, 165.8159635816534, 242.62282256400783, 200.42197759629252, 156.34075464058472, 131.9574433401166, 41.371063300931056, 126.97285017438608, 211.3349395745483, 210.4250171519459, 174.48226745608963, 183.66256117489058, 72.38887298987997, 156.6876340644959, 61.561463415880844, 132.0092221825465, 70.17841170381365, 95.28030663109774, 134.74582565052822, 254.87203601290219, 83.142965382093, 81.12663280294258, 25.528897181222916, 178.593156677493, 146.27660095761374, 106.98331472956184, 84.34312403495284, 76.01341952818026, 90.76836967923657, 217.66322270446804, 94.79999999999993, 133.4375194091713, 131.02987444768658, 186.9566985020172, 69.8017807896687, 113.10000000000011, 81.17093098413498, 195.9965229896382, 91.24583926926304, 99.86499851079137, 27.716106512033825, 85.29042520661457, 121.43874489734286, 108.46866830581307, 151.03263468941736, 86.91793547088426, 98.93644252447675, 201.5318481316505, 105.11511517922091, 27.000000000000092, 62.69140326732246, 182.30880318457415, 123.24366545991133, 71.47685103406499, 107.258596737961, 137.73484866706372, 198.76740106787972, 122.52364200420605, 216.63637544158541, 215.34453924093427, 104.00849484074578, 38.73586374656626, 62.25888117893852, 185.16800843992183, 143.92030956109258, 82.44966788366241, 110.06879198011025, 56.01075777851723, 125.55685203794451, 77.07276380051852, 171.64962570617968, 116.49999999999994, 125.33875104898192, 81.44992324590572, 68.5587977312786, 93.18365872225874, 172.8744332437946, 44.106499537177285, 39.53709730530507, 107.85462180099191, 78.75783122560993, 108.90021816586452, 38.11617043276428, 256.5661462948361, 138.85159830819111, 186.42804505045453, 131.23558084112696, 91.97379849401048, 92.78840799568775, 218.83440989361142], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-284.4257746594202, 45.77659200236469, 26.923892224728576, -143.20710048733332, 124.11502561957862, -156.24900875608606, -195.07395701179405, -103.48380024975145, -57.08848602268597, -201.41734815223532, -53.11337073953226, -45.13943752728662, -42.3005762043638, -77.06745068236954, -71.5842957331469, -107.77331602288689, 32.35239930787935, 27.97564544239017, -48.58655423873744, 2.7103465259023456, -118.24953667652389, -12.918301348935257, -27.528895559158673, 31.371143789641206, -192.26555594657103, 141.71766615631893, -80.61874416479488, 11.67894719160429, -141.41399189800975, -116.11931932083186, -315.4573774665059, 40.72526791238158, -163.17842675404123, -196.36432751427512, -105.42594421611841, -163.6865504896767, -242.19962664038715, 137.65177307058843, -139.46726796954232, 71.94149678534241, 70.745525998709, -112.70015030992919, 136.75513374556002, -198.48808708213159, -92.15340211922317, -137.74539907198323, 48.28044425598925, -104.21624385674347, -192.89212883231494, -188.614228440558, -69.00251996512084, -40.68886120808028, -26.272772611142088, -3.30855736509505, -44.95819617226119, -228.38172431835892, 32.72159066549936, -177.07669042468518, 24.35109193359254, 78.40080162110215, -28.339721751961314, -166.2448928665785, -107.67270516626766, -241.18544476406586, -178.95245784293974, -82.96816132697627, -207.86172712935857, 39.130324944502235, -115.88046266683845, 18.240379915897282, -170.330782622374, -43.89280715550609, -174.01427629398304, -81.09416178646562, -154.21853766300137, -113.19856378665118, -272.780360717411, -10.501990722477911, 69.51254373621373, -99.59175952607565, 16.031913196527505, -0.437748621609348, 5.024809272615512, -282.7151092894559, 0.32260525677732543, -181.52836444551596, 16.927122244554432, -253.90816997277827, -49.54511761320206, -122.36958304744668, -58.69154534327786, -55.486547109571816, 15.454277040689838, -47.649373740176614, 103.73472745901438, -176.13024398759035, -63.02609170485629, -213.83873984255408, -31.067680956763105, -161.60510568383597, -350.1499215015965, 13.656649122235752, -239.12446491456853, -199.39428933125728, -32.70965776990329, 52.76160493738219, -20.115190968105942, -59.01827634895616, -12.167887786484366, -116.25117097750488, -203.7572525094447, -67.06242797304577, -184.38346921680497, -43.6888601864702, 79.98716578197934, -177.6794622914645, -251.39280772748162, -102.98880008329623, -295.5932638141931, -41.78464893508553, -242.75492058948998, -119.56763768774024, -38.987519351161815, 7.560023706357781, -295.9074969501031, 18.648675230555412, -70.56433596304562, -251.36721787330555, -128.35189946655424, -44.739399394420566, -63.992182668431504, 10.368123887210912, 32.955628324335024, -166.62458507923046, -271.9309520146129, -56.71305729467457, -203.35086880366242, 77.80207842200636, 175.1070082422271, -205.70659776291168, -67.58961152138934, -184.9581665293648, -207.40629994556497, -212.84964613439507, -55.378396107436906, -198.57838057422794, 56.0663380806618, -93.77750096323993, -353.1505286424932, 87.02329516670939, -126.86731761934794, 15.319864730836875, 19.74733674260537, -217.28947647306012, -88.4733562480029, 20.39939149767388, -12.114691900391476, -251.7299654035778, -289.57598113613767, -182.34824829663052, -86.94937574457485, -39.761687176141976, 5.044043458384493, -14.428235111172786, -322.190960439724, -20.517112297863946, -69.73610545402897, -182.4353003579303, -99.6518891848056, -43.99682856048324, -101.39787668389896, 15.171697152220872, -205.4679408996067, 26.0664030573909, -298.59055541505967, -154.85373604407695, -178.32502743915975, -106.67750046214495, -182.65366944266256, -9.103808802119604, -103.92388724171231, -323.366590282774, 33.65721523097791, -201.343211826969, -28.773338850331875, -93.00828960711587, -72.23260695610634, 197.98802825434706, -282.4654779701024, -9.2151071269144, 120.522878114662, -74.73515395002131, -127.05508048339702, -198.4727677051819, -24.794828053607375, -14.7963069073965, -253.60470998909358, -102.30281761142948, -166.85406755437606, 110.0169606331331], "policy_predator_policy_reward": [224.54947081494294, 149.08839445892525, 17.060330525521593, 214.37537422987958, 47.15109913867847, 202.16435922187057, 215.82242087592633, 180.9635941259949, 175.431418735695, 171.37898636392538, 196.6159836427279, 38.27587295516189, 136.83462194158557, 83.79101034175264, 158.97415490432795, 136.8572965793868, 70.28888120297927, 84.01971221319342, 73.62572970109491, 75.93675340976306, 74.96024808854258, 125.6484753983036, 88.44460840097027, 73.52910695020118, 209.5865253634819, 83.58418699077806, 106.6450631247701, 162.71671144471324, 135.73340150654775, 278.140664352879, 324.9265864914193, 81.7629664028244, 189.63634135828227, 211.27747621096458, 179.0464191212534, 217.03892575892738, 182.25147706752148, 133.63131607682547, 194.86691345810928, 83.08387487803655, 112.84688627980952, 103.59000548750035, 8.30742742933112, 237.08808708213147, 187.12953455500644, 115.15813962607973, 51.50615353866585, 161.11728012658443, 237.11796486752598, 205.94985582122757, 58.71806577697165, 182.9825375787768, 79.22597097450229, 20.533770705548562, 147.5727957870479, 221.04743133466965, 61.41642444160369, 217.68450096811105, 61.40902149371918, 90.71112096448839, 156.59833948359469, 121.12924051703746, 251.65852010623618, 178.32626262703945, 25.54532813979722, 261.9041882113413, 120.05545382526454, 227.26910503708498, 152.4965283804942, 91.42015532806072, 246.52798529101884, 74.67891921642313, 193.89015562854127, 145.56140648685994, 178.79258804839952, 164.63793292943285, 284.4588120880407, 89.59190903108525, 95.0344272825042, 152.70801121182612, 3.668086803472458, 75.53774862160907, 202.2093288024407, 208.91849062357193, 195.69224396416365, 116.5433896722619, 145.16665230944224, 278.7710939207994, 216.27487067072988, 25.441610779587897, 92.99154534327796, 134.28654710957176, 23.529861836596687, 89.8361658470251, 193.14482698061437, 75.24721253760015, 217.1265570640514, 150.98411375262168, 98.98272050320797, 193.5550646481833, 278.0365561387334, 86.17282275266092, 289.26665635847, 234.54252309397017, 64.37532168791974, 37.01147604194458, 79.08603485602303, 108.51610076685289, 33.58582282273951, 245.8658706306674, 123.65438170264784, 234.0832342507272, 291.6624607827454, 35.34631114500736, 146.34744453903627, 152.87670010209956, 271.60689733662167, 187.88982565337676, 304.8932638141932, 59.484648935085765, 185.98567227998896, 239.02828926456357, 86.43326688408226, 127.3030319452963, 141.83363949038667, 258.6688476890721, 118.84941744518802, 274.558987425228, 117.6671871880995, 162.68270841083654, 100.00182651576576, 91.35708093251839, 243.43629304831933, 89.00006477445592, 249.8349898528563, 201.33266146063647, 130.23378001321882, 211.9513858100226, 45.97145309769681, 199.97267566392182, 246.9441619727555, 109.61211091874462, 209.15379734378024, 249.8380124827459, 172.96973422505562, 143.24592363554765, 83.38003344283723, 139.4991378796629, 214.807305923178, 195.24023711369873, 188.0918546659186, 5.905266106255192, 33.81131961903651, 273.7996120915285, 77.47871213179576, 46.60601039704941, 118.18326784528603, 271.2182414966278, 268.97618462021177, 280.0208086130748, 128.74085872561668, 169.61982990127993, 56.355956541615626, 69.52823511117283, 314.08184597347275, 153.96497781309765, 165.3713877019322, 168.2499413559336, 79.15823178773103, 133.04928368883628, 78.09050188835371, 101.31933636558341, 215.94585561681694, 136.3301154691938, 267.3253035606166, 230.22548743569712, 207.37737665626773, 117.16224855034085, 252.67331581394143, 46.93878423183313, 257.8526672318949, 248.195641518201, 59.07298619183106, 217.5132285700242, 25.43835141088668, 134.45944747932452, 79.29959204003949, 51.51113295655614, 245.67041350921866, 184.86176989598994, 86.69829579040173, 53.94202509541226, 236.4739717577195, 220.28945727198646, 90.26877599920948, 41.296157455805414, 208.07786182635368, 240.61807376985712, 82.97461063718384, 192.6969061776708]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.084588821157525, "mean_inference_ms": 4.3923658594410675, "mean_action_processing_ms": 2.3441394797792166, "mean_env_wait_ms": 10.58362114752395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04008150100708008, "StateBufferConnector_ms": 0.01005411148071289, "ViewRequirementAgentConnector_ms": 0.12667596340179443}, "num_episodes": 17, "episode_return_max": 256.5661462948361, "episode_return_min": 25.528897181222916, "episode_return_mean": 123.07155130581668, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.14665146606261, "num_env_steps_trained_throughput_per_sec": 84.14665146606261, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 47288.371, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47288.296, "sample_time_ms": 2144.064, "learn_time_ms": 45124.168, "learn_throughput": 88.644, "synch_weights_time_ms": 17.111}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-37-54", "timestamp": 1724148474, "time_this_iter_s": 47.57628393173218, "time_total_s": 1041.8725383281708, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33132b940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1041.8725383281708, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 25.928358208955224, "ram_util_percent": 82.50149253731342}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.941056105005678, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.105155508354227, "policy_loss": -0.01899615671958715, "vf_loss": 7.1215601850439, "vf_explained_var": 0.2641311590002958, "kl": 0.012957475761138888, "entropy": 1.1133861841032744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 997.4199999999983}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.763986649431249, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.8070176757832686, "policy_loss": -0.016953347870715396, "vf_loss": 5.821662491843814, "vf_explained_var": 0.17763656226415483, "kl": 0.01154267179863478, "entropy": 1.0906208791114667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 997.4199999999983}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 295.69611482692346, "episode_reward_min": 25.528897181222916, "episode_reward_mean": 120.00172750608988, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -353.1505286424932, "predator_policy": 3.668086803472458}, "policy_reward_max": {"prey_policy": 197.98802825434706, "predator_policy": 339.82173861643486}, "policy_reward_mean": {"prey_policy": -90.57704350689524, "predator_policy": 150.57790725994022}, "custom_metrics": {}, "hist_stats": {"episode_reward": [211.3349395745483, 210.4250171519459, 174.48226745608963, 183.66256117489058, 72.38887298987997, 156.6876340644959, 61.561463415880844, 132.0092221825465, 70.17841170381365, 95.28030663109774, 134.74582565052822, 254.87203601290219, 83.142965382093, 81.12663280294258, 25.528897181222916, 178.593156677493, 146.27660095761374, 106.98331472956184, 84.34312403495284, 76.01341952818026, 90.76836967923657, 217.66322270446804, 94.79999999999993, 133.4375194091713, 131.02987444768658, 186.9566985020172, 69.8017807896687, 113.10000000000011, 81.17093098413498, 195.9965229896382, 91.24583926926304, 99.86499851079137, 27.716106512033825, 85.29042520661457, 121.43874489734286, 108.46866830581307, 151.03263468941736, 86.91793547088426, 98.93644252447675, 201.5318481316505, 105.11511517922091, 27.000000000000092, 62.69140326732246, 182.30880318457415, 123.24366545991133, 71.47685103406499, 107.258596737961, 137.73484866706372, 198.76740106787972, 122.52364200420605, 216.63637544158541, 215.34453924093427, 104.00849484074578, 38.73586374656626, 62.25888117893852, 185.16800843992183, 143.92030956109258, 82.44966788366241, 110.06879198011025, 56.01075777851723, 125.55685203794451, 77.07276380051852, 171.64962570617968, 116.49999999999994, 125.33875104898192, 81.44992324590572, 68.5587977312786, 93.18365872225874, 172.8744332437946, 44.106499537177285, 39.53709730530507, 107.85462180099191, 78.75783122560993, 108.90021816586452, 38.11617043276428, 256.5661462948361, 138.85159830819111, 186.42804505045453, 131.23558084112696, 91.97379849401048, 92.78840799568775, 218.83440989361142, 48.88228422524435, 152.79999999999936, 170.66726702632488, 88.4130366237924, 79.20885020615088, 186.85818608233689, 156.39474327532258, 59.40537604017962, 156.41706796820378, 45.5337467602903, 75.19999999999943, 107.65470512209444, 295.69611482692346, 153.8022392933226, 82.83406028698296, 189.09795889800233, 69.68337975714161, 35.961254312915514], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-242.19962664038715, 137.65177307058843, -139.46726796954232, 71.94149678534241, 70.745525998709, -112.70015030992919, 136.75513374556002, -198.48808708213159, -92.15340211922317, -137.74539907198323, 48.28044425598925, -104.21624385674347, -192.89212883231494, -188.614228440558, -69.00251996512084, -40.68886120808028, -26.272772611142088, -3.30855736509505, -44.95819617226119, -228.38172431835892, 32.72159066549936, -177.07669042468518, 24.35109193359254, 78.40080162110215, -28.339721751961314, -166.2448928665785, -107.67270516626766, -241.18544476406586, -178.95245784293974, -82.96816132697627, -207.86172712935857, 39.130324944502235, -115.88046266683845, 18.240379915897282, -170.330782622374, -43.89280715550609, -174.01427629398304, -81.09416178646562, -154.21853766300137, -113.19856378665118, -272.780360717411, -10.501990722477911, 69.51254373621373, -99.59175952607565, 16.031913196527505, -0.437748621609348, 5.024809272615512, -282.7151092894559, 0.32260525677732543, -181.52836444551596, 16.927122244554432, -253.90816997277827, -49.54511761320206, -122.36958304744668, -58.69154534327786, -55.486547109571816, 15.454277040689838, -47.649373740176614, 103.73472745901438, -176.13024398759035, -63.02609170485629, -213.83873984255408, -31.067680956763105, -161.60510568383597, -350.1499215015965, 13.656649122235752, -239.12446491456853, -199.39428933125728, -32.70965776990329, 52.76160493738219, -20.115190968105942, -59.01827634895616, -12.167887786484366, -116.25117097750488, -203.7572525094447, -67.06242797304577, -184.38346921680497, -43.6888601864702, 79.98716578197934, -177.6794622914645, -251.39280772748162, -102.98880008329623, -295.5932638141931, -41.78464893508553, -242.75492058948998, -119.56763768774024, -38.987519351161815, 7.560023706357781, -295.9074969501031, 18.648675230555412, -70.56433596304562, -251.36721787330555, -128.35189946655424, -44.739399394420566, -63.992182668431504, 10.368123887210912, 32.955628324335024, -166.62458507923046, -271.9309520146129, -56.71305729467457, -203.35086880366242, 77.80207842200636, 175.1070082422271, -205.70659776291168, -67.58961152138934, -184.9581665293648, -207.40629994556497, -212.84964613439507, -55.378396107436906, -198.57838057422794, 56.0663380806618, -93.77750096323993, -353.1505286424932, 87.02329516670939, -126.86731761934794, 15.319864730836875, 19.74733674260537, -217.28947647306012, -88.4733562480029, 20.39939149767388, -12.114691900391476, -251.7299654035778, -289.57598113613767, -182.34824829663052, -86.94937574457485, -39.761687176141976, 5.044043458384493, -14.428235111172786, -322.190960439724, -20.517112297863946, -69.73610545402897, -182.4353003579303, -99.6518891848056, -43.99682856048324, -101.39787668389896, 15.171697152220872, -205.4679408996067, 26.0664030573909, -298.59055541505967, -154.85373604407695, -178.32502743915975, -106.67750046214495, -182.65366944266256, -9.103808802119604, -103.92388724171231, -323.366590282774, 33.65721523097791, -201.343211826969, -28.773338850331875, -93.00828960711587, -72.23260695610634, 197.98802825434706, -282.4654779701024, -9.2151071269144, 120.522878114662, -74.73515395002131, -127.05508048339702, -198.4727677051819, -24.794828053607375, -14.7963069073965, -253.60470998909358, -102.30281761142948, -166.85406755437606, 110.0169606331331, -153.90742019251135, -60.19400067465174, 15.75123080372188, 48.16003612847496, -127.2658083184313, 33.3603468900547, -41.9151173832819, -159.82231893006903, -92.38045557866948, 55.03649401441763, -26.51834658743714, -68.41446596620916, -184.9553288446273, 118.54893981863077, -13.798675247892193, -96.02899648737066, -88.34093848315686, -9.430530543388581, -146.21034229128614, -181.88454208039477, 20.45914049828278, -83.26443108160086, -155.03181615451493, 7.492385707111149, -20.26079733664665, -348.1023502992243, 0.5110749207247215, -200.75606413208496, -7.11521140560521, -189.13869154125337, 69.60950311447905, -297.9329879942548, -106.70324996731573, -76.73980702123214, -224.07858288646509, -146.7595128650661], "policy_predator_policy_reward": [182.25147706752148, 133.63131607682547, 194.86691345810928, 83.08387487803655, 112.84688627980952, 103.59000548750035, 8.30742742933112, 237.08808708213147, 187.12953455500644, 115.15813962607973, 51.50615353866585, 161.11728012658443, 237.11796486752598, 205.94985582122757, 58.71806577697165, 182.9825375787768, 79.22597097450229, 20.533770705548562, 147.5727957870479, 221.04743133466965, 61.41642444160369, 217.68450096811105, 61.40902149371918, 90.71112096448839, 156.59833948359469, 121.12924051703746, 251.65852010623618, 178.32626262703945, 25.54532813979722, 261.9041882113413, 120.05545382526454, 227.26910503708498, 152.4965283804942, 91.42015532806072, 246.52798529101884, 74.67891921642313, 193.89015562854127, 145.56140648685994, 178.79258804839952, 164.63793292943285, 284.4588120880407, 89.59190903108525, 95.0344272825042, 152.70801121182612, 3.668086803472458, 75.53774862160907, 202.2093288024407, 208.91849062357193, 195.69224396416365, 116.5433896722619, 145.16665230944224, 278.7710939207994, 216.27487067072988, 25.441610779587897, 92.99154534327796, 134.28654710957176, 23.529861836596687, 89.8361658470251, 193.14482698061437, 75.24721253760015, 217.1265570640514, 150.98411375262168, 98.98272050320797, 193.5550646481833, 278.0365561387334, 86.17282275266092, 289.26665635847, 234.54252309397017, 64.37532168791974, 37.01147604194458, 79.08603485602303, 108.51610076685289, 33.58582282273951, 245.8658706306674, 123.65438170264784, 234.0832342507272, 291.6624607827454, 35.34631114500736, 146.34744453903627, 152.87670010209956, 271.60689733662167, 187.88982565337676, 304.8932638141932, 59.484648935085765, 185.98567227998896, 239.02828926456357, 86.43326688408226, 127.3030319452963, 141.83363949038667, 258.6688476890721, 118.84941744518802, 274.558987425228, 117.6671871880995, 162.68270841083654, 100.00182651576576, 91.35708093251839, 243.43629304831933, 89.00006477445592, 249.8349898528563, 201.33266146063647, 130.23378001321882, 211.9513858100226, 45.97145309769681, 199.97267566392182, 246.9441619727555, 109.61211091874462, 209.15379734378024, 249.8380124827459, 172.96973422505562, 143.24592363554765, 83.38003344283723, 139.4991378796629, 214.807305923178, 195.24023711369873, 188.0918546659186, 5.905266106255192, 33.81131961903651, 273.7996120915285, 77.47871213179576, 46.60601039704941, 118.18326784528603, 271.2182414966278, 268.97618462021177, 280.0208086130748, 128.74085872561668, 169.61982990127993, 56.355956541615626, 69.52823511117283, 314.08184597347275, 153.96497781309765, 165.3713877019322, 168.2499413559336, 79.15823178773103, 133.04928368883628, 78.09050188835371, 101.31933636558341, 215.94585561681694, 136.3301154691938, 267.3253035606166, 230.22548743569712, 207.37737665626773, 117.16224855034085, 252.67331581394143, 46.93878423183313, 257.8526672318949, 248.195641518201, 59.07298619183106, 217.5132285700242, 25.43835141088668, 134.45944747932452, 79.29959204003949, 51.51113295655614, 245.67041350921866, 184.86176989598994, 86.69829579040173, 53.94202509541226, 236.4739717577195, 220.28945727198646, 90.26877599920948, 41.296157455805414, 208.07786182635368, 240.61807376985712, 82.97461063718384, 192.6969061776708, 70.56305350727801, 192.42065158512855, 69.50203020254153, 19.38670286526178, 135.44150521052407, 129.13122324417745, 39.59515423693645, 250.55531870020678, 101.5321355086466, 15.020676261756151, 3.804205224057851, 277.9867934119255, 117.94356383409195, 104.85756846722725, 132.15693649533657, 37.07611128010567, 106.38696157432737, 147.80157542042298, 237.28351699878925, 136.3451141331809, 41.24085950171735, 96.76443108160024, 164.84672746099602, 90.34740810850218, 339.82173861643486, 324.23752384635947, 227.92082943849127, 126.12639906619165, 170.7587003209353, 108.3292629129064, 179.95746318094646, 237.46398059683182, 96.46780050658451, 156.6586362391043, 286.62759600200826, 120.17175406243787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.03062896618373, "mean_inference_ms": 4.33842697598651, "mean_action_processing_ms": 2.2978055027270456, "mean_env_wait_ms": 10.529199712242013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02251601219177246, "StateBufferConnector_ms": 0.010379552841186523, "ViewRequirementAgentConnector_ms": 0.11609518527984619}, "num_episodes": 18, "episode_return_max": 295.69611482692346, "episode_return_min": 25.528897181222916, "episode_return_mean": 120.00172750608988, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.2248052146356, "num_env_steps_trained_throughput_per_sec": 84.2248052146356, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 47365.729, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47365.653, "sample_time_ms": 2180.18, "learn_time_ms": 45165.357, "learn_throughput": 88.563, "synch_weights_time_ms": 17.151}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-38-41", "timestamp": 1724148521, "time_this_iter_s": 47.535216093063354, "time_total_s": 1089.4077544212341, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12007a5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1089.4077544212341, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 25.944776119402988, "ram_util_percent": 82.77164179104477}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.350664855941893, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.297219212849935, "policy_loss": -0.018272893535953863, "vf_loss": 7.31308854799422, "vf_explained_var": 0.2631230881605199, "kl": 0.01201770257983337, "entropy": 1.0858865448091395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6182276292137368, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.450562341881808, "policy_loss": -0.016270707874120306, "vf_loss": 5.464422652582643, "vf_explained_var": 0.11512559835242216, "kl": 0.01205204103854066, "entropy": 1.0596948816032006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 295.69611482692346, "episode_reward_min": 27.000000000000092, "episode_reward_mean": 117.14916006956433, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -353.1505286424932, "predator_policy": 3.685628838138441}, "policy_reward_max": {"prey_policy": 197.98802825434706, "predator_policy": 339.82173861643486}, "policy_reward_mean": {"prey_policy": -85.60299251274947, "predator_policy": 144.17757254753164}, "custom_metrics": {}, "hist_stats": {"episode_reward": [113.10000000000011, 81.17093098413498, 195.9965229896382, 91.24583926926304, 99.86499851079137, 27.716106512033825, 85.29042520661457, 121.43874489734286, 108.46866830581307, 151.03263468941736, 86.91793547088426, 98.93644252447675, 201.5318481316505, 105.11511517922091, 27.000000000000092, 62.69140326732246, 182.30880318457415, 123.24366545991133, 71.47685103406499, 107.258596737961, 137.73484866706372, 198.76740106787972, 122.52364200420605, 216.63637544158541, 215.34453924093427, 104.00849484074578, 38.73586374656626, 62.25888117893852, 185.16800843992183, 143.92030956109258, 82.44966788366241, 110.06879198011025, 56.01075777851723, 125.55685203794451, 77.07276380051852, 171.64962570617968, 116.49999999999994, 125.33875104898192, 81.44992324590572, 68.5587977312786, 93.18365872225874, 172.8744332437946, 44.106499537177285, 39.53709730530507, 107.85462180099191, 78.75783122560993, 108.90021816586452, 38.11617043276428, 256.5661462948361, 138.85159830819111, 186.42804505045453, 131.23558084112696, 91.97379849401048, 92.78840799568775, 218.83440989361142, 48.88228422524435, 152.79999999999936, 170.66726702632488, 88.4130366237924, 79.20885020615088, 186.85818608233689, 156.39474327532258, 59.40537604017962, 156.41706796820378, 45.5337467602903, 75.19999999999943, 107.65470512209444, 295.69611482692346, 153.8022392933226, 82.83406028698296, 189.09795889800233, 69.68337975714161, 35.961254312915514, 177.81076092567176, 200.20000000000002, 147.37161248718294, 82.21321998256967, 62.3353008990822, 92.00267127693581, 62.50000000000029, 42.64769786762717, 174.0852405110994, 158.0828070929525, 79.5709708018883, 61.40000000000033, 84.04932922216278, 236.82154907151656, 121.64678362824745, 216.66373384623367, 81.83649861769503, 99.81482367311796, 83.98107704385455, 206.5981344319628, 71.47120872451401, 133.13809224779732, 145.84180613205476, 114.13906527946043, 65.5042645452006, 135.0790998385388, 42.0316430350051], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-58.69154534327786, -55.486547109571816, 15.454277040689838, -47.649373740176614, 103.73472745901438, -176.13024398759035, -63.02609170485629, -213.83873984255408, -31.067680956763105, -161.60510568383597, -350.1499215015965, 13.656649122235752, -239.12446491456853, -199.39428933125728, -32.70965776990329, 52.76160493738219, -20.115190968105942, -59.01827634895616, -12.167887786484366, -116.25117097750488, -203.7572525094447, -67.06242797304577, -184.38346921680497, -43.6888601864702, 79.98716578197934, -177.6794622914645, -251.39280772748162, -102.98880008329623, -295.5932638141931, -41.78464893508553, -242.75492058948998, -119.56763768774024, -38.987519351161815, 7.560023706357781, -295.9074969501031, 18.648675230555412, -70.56433596304562, -251.36721787330555, -128.35189946655424, -44.739399394420566, -63.992182668431504, 10.368123887210912, 32.955628324335024, -166.62458507923046, -271.9309520146129, -56.71305729467457, -203.35086880366242, 77.80207842200636, 175.1070082422271, -205.70659776291168, -67.58961152138934, -184.9581665293648, -207.40629994556497, -212.84964613439507, -55.378396107436906, -198.57838057422794, 56.0663380806618, -93.77750096323993, -353.1505286424932, 87.02329516670939, -126.86731761934794, 15.319864730836875, 19.74733674260537, -217.28947647306012, -88.4733562480029, 20.39939149767388, -12.114691900391476, -251.7299654035778, -289.57598113613767, -182.34824829663052, -86.94937574457485, -39.761687176141976, 5.044043458384493, -14.428235111172786, -322.190960439724, -20.517112297863946, -69.73610545402897, -182.4353003579303, -99.6518891848056, -43.99682856048324, -101.39787668389896, 15.171697152220872, -205.4679408996067, 26.0664030573909, -298.59055541505967, -154.85373604407695, -178.32502743915975, -106.67750046214495, -182.65366944266256, -9.103808802119604, -103.92388724171231, -323.366590282774, 33.65721523097791, -201.343211826969, -28.773338850331875, -93.00828960711587, -72.23260695610634, 197.98802825434706, -282.4654779701024, -9.2151071269144, 120.522878114662, -74.73515395002131, -127.05508048339702, -198.4727677051819, -24.794828053607375, -14.7963069073965, -253.60470998909358, -102.30281761142948, -166.85406755437606, 110.0169606331331, -153.90742019251135, -60.19400067465174, 15.75123080372188, 48.16003612847496, -127.2658083184313, 33.3603468900547, -41.9151173832819, -159.82231893006903, -92.38045557866948, 55.03649401441763, -26.51834658743714, -68.41446596620916, -184.9553288446273, 118.54893981863077, -13.798675247892193, -96.02899648737066, -88.34093848315686, -9.430530543388581, -146.21034229128614, -181.88454208039477, 20.45914049828278, -83.26443108160086, -155.03181615451493, 7.492385707111149, -20.26079733664665, -348.1023502992243, 0.5110749207247215, -200.75606413208496, -7.11521140560521, -189.13869154125337, 69.60950311447905, -297.9329879942548, -106.70324996731573, -76.73980702123214, -224.07858288646509, -146.7595128650661, -312.61716402511354, 30.770989423285833, -7.2089224943113805, 34.94030904321731, -213.3323411422996, -25.01886840761175, -105.5676913483405, -88.73191856540302, -124.88852251083547, -107.27676758398765, -68.14145383211077, 56.15842606013537, 2.9601957292428787, -41.79526231452939, -34.095090298473735, -233.80478401214052, -113.77113850245921, 98.48592003710246, -171.28981868212665, 68.22889490804857, -138.8094234715718, -279.81297180103104, -108.78638073061568, -16.989575453178265, -116.36026966055798, -54.738822638529165, -20.63686488054573, -7.035825470582177, -158.85605937625346, 47.95655967531272, 157.35887251865225, -123.12434798115187, -64.19655409670935, 27.44294446345716, -42.15415875206612, -17.42108383575747, -55.714317363784275, -122.19782050289791, 64.34303252593989, -122.15474280677603, -121.36060657653994, -88.85774834365496, -149.85422251174214, 0.6327747712582914, 91.84946331548147, -56.40751829821069, -61.89448189950846, 81.64207765477425, -121.30084131065091, -126.15951266574984, -10.798602120711887, -137.50719585830376, -8.799802275458289, -159.85197341749213], "policy_predator_policy_reward": [92.99154534327796, 134.28654710957176, 23.529861836596687, 89.8361658470251, 193.14482698061437, 75.24721253760015, 217.1265570640514, 150.98411375262168, 98.98272050320797, 193.5550646481833, 278.0365561387334, 86.17282275266092, 289.26665635847, 234.54252309397017, 64.37532168791974, 37.01147604194458, 79.08603485602303, 108.51610076685289, 33.58582282273951, 245.8658706306674, 123.65438170264784, 234.0832342507272, 291.6624607827454, 35.34631114500736, 146.34744453903627, 152.87670010209956, 271.60689733662167, 187.88982565337676, 304.8932638141932, 59.484648935085765, 185.98567227998896, 239.02828926456357, 86.43326688408226, 127.3030319452963, 141.83363949038667, 258.6688476890721, 118.84941744518802, 274.558987425228, 117.6671871880995, 162.68270841083654, 100.00182651576576, 91.35708093251839, 243.43629304831933, 89.00006477445592, 249.8349898528563, 201.33266146063647, 130.23378001321882, 211.9513858100226, 45.97145309769681, 199.97267566392182, 246.9441619727555, 109.61211091874462, 209.15379734378024, 249.8380124827459, 172.96973422505562, 143.24592363554765, 83.38003344283723, 139.4991378796629, 214.807305923178, 195.24023711369873, 188.0918546659186, 5.905266106255192, 33.81131961903651, 273.7996120915285, 77.47871213179576, 46.60601039704941, 118.18326784528603, 271.2182414966278, 268.97618462021177, 280.0208086130748, 128.74085872561668, 169.61982990127993, 56.355956541615626, 69.52823511117283, 314.08184597347275, 153.96497781309765, 165.3713877019322, 168.2499413559336, 79.15823178773103, 133.04928368883628, 78.09050188835371, 101.31933636558341, 215.94585561681694, 136.3301154691938, 267.3253035606166, 230.22548743569712, 207.37737665626773, 117.16224855034085, 252.67331581394143, 46.93878423183313, 257.8526672318949, 248.195641518201, 59.07298619183106, 217.5132285700242, 25.43835141088668, 134.45944747932452, 79.29959204003949, 51.51113295655614, 245.67041350921866, 184.86176989598994, 86.69829579040173, 53.94202509541226, 236.4739717577195, 220.28945727198646, 90.26877599920948, 41.296157455805414, 208.07786182635368, 240.61807376985712, 82.97461063718384, 192.6969061776708, 70.56305350727801, 192.42065158512855, 69.50203020254153, 19.38670286526178, 135.44150521052407, 129.13122324417745, 39.59515423693645, 250.55531870020678, 101.5321355086466, 15.020676261756151, 3.804205224057851, 277.9867934119255, 117.94356383409195, 104.85756846722725, 132.15693649533657, 37.07611128010567, 106.38696157432737, 147.80157542042298, 237.28351699878925, 136.3451141331809, 41.24085950171735, 96.76443108160024, 164.84672746099602, 90.34740810850218, 339.82173861643486, 324.23752384635947, 227.92082943849127, 126.12639906619165, 170.7587003209353, 108.3292629129064, 179.95746318094646, 237.46398059683182, 96.46780050658451, 156.6586362391043, 286.62759600200826, 120.17175406243787, 327.451924468197, 132.20501105930393, 62.771590529685646, 109.69702292140845, 206.5455378440487, 179.17728419304567, 180.44627195750886, 96.06655793880404, 118.38613287545306, 176.11445811845093, 87.2314517367583, 16.754247312152856, 15.639804270757084, 85.69526231452902, 94.17515147658946, 216.37242070165186, 135.17113850245894, 54.19932047399727, 61.78411460855394, 199.3596162584765, 261.63458286367654, 236.5587832108145, 124.68779796294493, 62.48815822084866, 67.76950692541912, 187.3789145958314, 166.88995278498663, 97.60428663765813, 116.97645963617751, 115.56982369301109, 88.58891536279751, 93.84029394593584, 17.984754140092704, 100.60535411085391, 120.64924510397269, 38.74082115696981, 118.4953944076389, 143.39782050289745, 110.81150928950629, 153.59833542329258, 109.54387224580456, 172.1456913989042, 123.22626366037512, 159.13327632790612, 69.47200915452339, 40.92785196026068, 90.7058406860563, 3.685628838138441, 123.88507592340859, 189.0795425981925, 110.86663753451955, 172.5182602830349, 179.69255913264, 30.990859595315104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.000401797265464, "mean_inference_ms": 4.266504247716203, "mean_action_processing_ms": 2.2178603709722573, "mean_env_wait_ms": 10.500418332817436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003737926483154297, "StateBufferConnector_ms": 0.009324789047241211, "ViewRequirementAgentConnector_ms": 0.11341500282287598}, "num_episodes": 27, "episode_return_max": 295.69611482692346, "episode_return_min": 27.000000000000092, "episode_return_mean": 117.14916006956433, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.00848011628253, "num_env_steps_trained_throughput_per_sec": 85.00848011628253, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 47343.337, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47343.255, "sample_time_ms": 2171.848, "learn_time_ms": 45151.275, "learn_throughput": 88.591, "synch_weights_time_ms": 17.018}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-39-28", "timestamp": 1724148568, "time_this_iter_s": 47.06848621368408, "time_total_s": 1136.4762406349182, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120023af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1136.4762406349182, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 25.48955223880597, "ram_util_percent": 82.655223880597}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.70879285032787, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.714543927914251, "policy_loss": -0.018337249838397223, "vf_loss": 7.73053897423719, "vf_explained_var": 0.21729746486144091, "kl": 0.011711073165177983, "entropy": 1.020848119984228, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8952815246960473, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.061205249614816, "policy_loss": -0.013922011029965703, "vf_loss": 6.073027192978632, "vf_explained_var": 0.13687402107728222, "kl": 0.01050031925502317, "entropy": 0.9624236568887398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 295.69611482692346, "episode_reward_min": 35.961254312915514, "episode_reward_mean": 117.05021093687566, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -353.1505286424932, "predator_policy": 0.7648377833291353}, "policy_reward_max": {"prey_policy": 197.98802825434706, "predator_policy": 339.82173861643486}, "policy_reward_mean": {"prey_policy": -82.56974290616938, "predator_policy": 141.09484837460718}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.47685103406499, 107.258596737961, 137.73484866706372, 198.76740106787972, 122.52364200420605, 216.63637544158541, 215.34453924093427, 104.00849484074578, 38.73586374656626, 62.25888117893852, 185.16800843992183, 143.92030956109258, 82.44966788366241, 110.06879198011025, 56.01075777851723, 125.55685203794451, 77.07276380051852, 171.64962570617968, 116.49999999999994, 125.33875104898192, 81.44992324590572, 68.5587977312786, 93.18365872225874, 172.8744332437946, 44.106499537177285, 39.53709730530507, 107.85462180099191, 78.75783122560993, 108.90021816586452, 38.11617043276428, 256.5661462948361, 138.85159830819111, 186.42804505045453, 131.23558084112696, 91.97379849401048, 92.78840799568775, 218.83440989361142, 48.88228422524435, 152.79999999999936, 170.66726702632488, 88.4130366237924, 79.20885020615088, 186.85818608233689, 156.39474327532258, 59.40537604017962, 156.41706796820378, 45.5337467602903, 75.19999999999943, 107.65470512209444, 295.69611482692346, 153.8022392933226, 82.83406028698296, 189.09795889800233, 69.68337975714161, 35.961254312915514, 177.81076092567176, 200.20000000000002, 147.37161248718294, 82.21321998256967, 62.3353008990822, 92.00267127693581, 62.50000000000029, 42.64769786762717, 174.0852405110994, 158.0828070929525, 79.5709708018883, 61.40000000000033, 84.04932922216278, 236.82154907151656, 121.64678362824745, 216.66373384623367, 81.83649861769503, 99.81482367311796, 83.98107704385455, 206.5981344319628, 71.47120872451401, 133.13809224779732, 145.84180613205476, 114.13906527946043, 65.5042645452006, 135.0790998385388, 42.0316430350051, 73.83292228306743, 89.65350520458249, 263.3691276515, 81.56416546458959, 72.53846964307643, 129.81714385182363, 188.79999999999987, 136.43592667296014, 170.6607624198716, 68.29727761305077, 69.35540726375906, 93.01431244056991, 38.99012404963315, 73.96217176117923, 110.42531597004503, 54.461277706909335, 146.4575633911219, 91.53969792648239], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-70.56433596304562, -251.36721787330555, -128.35189946655424, -44.739399394420566, -63.992182668431504, 10.368123887210912, 32.955628324335024, -166.62458507923046, -271.9309520146129, -56.71305729467457, -203.35086880366242, 77.80207842200636, 175.1070082422271, -205.70659776291168, -67.58961152138934, -184.9581665293648, -207.40629994556497, -212.84964613439507, -55.378396107436906, -198.57838057422794, 56.0663380806618, -93.77750096323993, -353.1505286424932, 87.02329516670939, -126.86731761934794, 15.319864730836875, 19.74733674260537, -217.28947647306012, -88.4733562480029, 20.39939149767388, -12.114691900391476, -251.7299654035778, -289.57598113613767, -182.34824829663052, -86.94937574457485, -39.761687176141976, 5.044043458384493, -14.428235111172786, -322.190960439724, -20.517112297863946, -69.73610545402897, -182.4353003579303, -99.6518891848056, -43.99682856048324, -101.39787668389896, 15.171697152220872, -205.4679408996067, 26.0664030573909, -298.59055541505967, -154.85373604407695, -178.32502743915975, -106.67750046214495, -182.65366944266256, -9.103808802119604, -103.92388724171231, -323.366590282774, 33.65721523097791, -201.343211826969, -28.773338850331875, -93.00828960711587, -72.23260695610634, 197.98802825434706, -282.4654779701024, -9.2151071269144, 120.522878114662, -74.73515395002131, -127.05508048339702, -198.4727677051819, -24.794828053607375, -14.7963069073965, -253.60470998909358, -102.30281761142948, -166.85406755437606, 110.0169606331331, -153.90742019251135, -60.19400067465174, 15.75123080372188, 48.16003612847496, -127.2658083184313, 33.3603468900547, -41.9151173832819, -159.82231893006903, -92.38045557866948, 55.03649401441763, -26.51834658743714, -68.41446596620916, -184.9553288446273, 118.54893981863077, -13.798675247892193, -96.02899648737066, -88.34093848315686, -9.430530543388581, -146.21034229128614, -181.88454208039477, 20.45914049828278, -83.26443108160086, -155.03181615451493, 7.492385707111149, -20.26079733664665, -348.1023502992243, 0.5110749207247215, -200.75606413208496, -7.11521140560521, -189.13869154125337, 69.60950311447905, -297.9329879942548, -106.70324996731573, -76.73980702123214, -224.07858288646509, -146.7595128650661, -312.61716402511354, 30.770989423285833, -7.2089224943113805, 34.94030904321731, -213.3323411422996, -25.01886840761175, -105.5676913483405, -88.73191856540302, -124.88852251083547, -107.27676758398765, -68.14145383211077, 56.15842606013537, 2.9601957292428787, -41.79526231452939, -34.095090298473735, -233.80478401214052, -113.77113850245921, 98.48592003710246, -171.28981868212665, 68.22889490804857, -138.8094234715718, -279.81297180103104, -108.78638073061568, -16.989575453178265, -116.36026966055798, -54.738822638529165, -20.63686488054573, -7.035825470582177, -158.85605937625346, 47.95655967531272, 157.35887251865225, -123.12434798115187, -64.19655409670935, 27.44294446345716, -42.15415875206612, -17.42108383575747, -55.714317363784275, -122.19782050289791, 64.34303252593989, -122.15474280677603, -121.36060657653994, -88.85774834365496, -149.85422251174214, 0.6327747712582914, 91.84946331548147, -56.40751829821069, -61.89448189950846, 81.64207765477425, -121.30084131065091, -126.15951266574984, -10.798602120711887, -137.50719585830376, -8.799802275458289, -159.85197341749213, 5.136495347551431, -194.29709539359249, -92.25807604274296, -6.660767033185625, -263.82883476883796, 140.9670526133802, -75.33473840308038, -149.41411727880143, -35.514633416938594, -50.07822181708961, -119.64014048162034, -47.199827552027614, -36.82433760297642, 80.57914196553317, 4.2750064715023655, -173.64425880558053, -86.9387960106638, 16.057898323651393, -64.47227050332573, 15.491244026113579, -103.77901177573493, -292.1094179593251, -202.8659437016673, 12.750068424065208, -40.186026662923084, -287.64663565041616, -60.57643436729268, -223.04247346383025, -16.185203702277825, -95.31177196257553, -19.25163243980278, -264.80115352353636, 36.77509796308874, -195.14477975769339, -0.9957350679375665, -117.55138067796338], "policy_predator_policy_reward": [118.84941744518802, 274.558987425228, 117.6671871880995, 162.68270841083654, 100.00182651576576, 91.35708093251839, 243.43629304831933, 89.00006477445592, 249.8349898528563, 201.33266146063647, 130.23378001321882, 211.9513858100226, 45.97145309769681, 199.97267566392182, 246.9441619727555, 109.61211091874462, 209.15379734378024, 249.8380124827459, 172.96973422505562, 143.24592363554765, 83.38003344283723, 139.4991378796629, 214.807305923178, 195.24023711369873, 188.0918546659186, 5.905266106255192, 33.81131961903651, 273.7996120915285, 77.47871213179576, 46.60601039704941, 118.18326784528603, 271.2182414966278, 268.97618462021177, 280.0208086130748, 128.74085872561668, 169.61982990127993, 56.355956541615626, 69.52823511117283, 314.08184597347275, 153.96497781309765, 165.3713877019322, 168.2499413559336, 79.15823178773103, 133.04928368883628, 78.09050188835371, 101.31933636558341, 215.94585561681694, 136.3301154691938, 267.3253035606166, 230.22548743569712, 207.37737665626773, 117.16224855034085, 252.67331581394143, 46.93878423183313, 257.8526672318949, 248.195641518201, 59.07298619183106, 217.5132285700242, 25.43835141088668, 134.45944747932452, 79.29959204003949, 51.51113295655614, 245.67041350921866, 184.86176989598994, 86.69829579040173, 53.94202509541226, 236.4739717577195, 220.28945727198646, 90.26877599920948, 41.296157455805414, 208.07786182635368, 240.61807376985712, 82.97461063718384, 192.6969061776708, 70.56305350727801, 192.42065158512855, 69.50203020254153, 19.38670286526178, 135.44150521052407, 129.13122324417745, 39.59515423693645, 250.55531870020678, 101.5321355086466, 15.020676261756151, 3.804205224057851, 277.9867934119255, 117.94356383409195, 104.85756846722725, 132.15693649533657, 37.07611128010567, 106.38696157432737, 147.80157542042298, 237.28351699878925, 136.3451141331809, 41.24085950171735, 96.76443108160024, 164.84672746099602, 90.34740810850218, 339.82173861643486, 324.23752384635947, 227.92082943849127, 126.12639906619165, 170.7587003209353, 108.3292629129064, 179.95746318094646, 237.46398059683182, 96.46780050658451, 156.6586362391043, 286.62759600200826, 120.17175406243787, 327.451924468197, 132.20501105930393, 62.771590529685646, 109.69702292140845, 206.5455378440487, 179.17728419304567, 180.44627195750886, 96.06655793880404, 118.38613287545306, 176.11445811845093, 87.2314517367583, 16.754247312152856, 15.639804270757084, 85.69526231452902, 94.17515147658946, 216.37242070165186, 135.17113850245894, 54.19932047399727, 61.78411460855394, 199.3596162584765, 261.63458286367654, 236.5587832108145, 124.68779796294493, 62.48815822084866, 67.76950692541912, 187.3789145958314, 166.88995278498663, 97.60428663765813, 116.97645963617751, 115.56982369301109, 88.58891536279751, 93.84029394593584, 17.984754140092704, 100.60535411085391, 120.64924510397269, 38.74082115696981, 118.4953944076389, 143.39782050289745, 110.81150928950629, 153.59833542329258, 109.54387224580456, 172.1456913989042, 123.22626366037512, 159.13327632790612, 69.47200915452339, 40.92785196026068, 90.7058406860563, 3.685628838138441, 123.88507592340859, 189.0795425981925, 110.86663753451955, 172.5182602830349, 179.69255913264, 30.990859595315104, 153.96632743723777, 109.02719489187099, 12.63274313436096, 175.93960514614983, 215.51400897661273, 170.71690083034505, 142.7458219963463, 163.56719915012417, 60.08148326037814, 98.04984161672625, 130.4074497095053, 166.24966217596602, 92.62433760297657, 52.420858034466846, 82.20259844587017, 223.60258056116865, 119.65198932336992, 121.88967078351453, 116.513466306933, 0.7648377833291353, 154.76991755128745, 310.4739194475316, 154.27481675394367, 128.85537096422834, 233.1422008138656, 133.6805855491069, 125.33131171905819, 232.24976787324263, 75.35752056018643, 146.56477107471167, 202.49820336579003, 136.01586030445893, 157.80984955657416, 147.01739562915247, 77.48847450051295, 132.59833917187007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.950262286657283, "mean_inference_ms": 4.231801595843995, "mean_action_processing_ms": 2.1970018966850433, "mean_env_wait_ms": 10.46183414545047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038518905639648438, "StateBufferConnector_ms": 0.009343981742858887, "ViewRequirementAgentConnector_ms": 0.10826551914215088}, "num_episodes": 18, "episode_return_max": 295.69611482692346, "episode_return_min": 35.961254312915514, "episode_return_mean": 117.05021093687566, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.40106978466436, "num_env_steps_trained_throughput_per_sec": 85.40106978466436, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 47330.39, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47330.308, "sample_time_ms": 2170.643, "learn_time_ms": 45139.203, "learn_throughput": 88.615, "synch_weights_time_ms": 17.339}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-40-15", "timestamp": 1724148615, "time_this_iter_s": 46.85996985435486, "time_total_s": 1183.336210489273, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33132e9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1183.336210489273, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 24.91969696969697, "ram_util_percent": 82.46363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.113759269600823, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.789018096873369, "policy_loss": -0.01885340070541672, "vf_loss": 7.8054371785865255, "vf_explained_var": 0.24050831340608142, "kl": 0.012171576774762894, "entropy": 1.012998668132005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.633705262153868, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.958132583375961, "policy_loss": -0.01671157483129747, "vf_loss": 5.972458291432214, "vf_explained_var": 0.10596070538752925, "kl": 0.011929328225444628, "entropy": 0.934193159032751, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 295.69611482692346, "episode_reward_min": 35.961254312915514, "episode_reward_mean": 116.22999881269712, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -348.1023502992243, "predator_policy": 0.7648377833291353}, "policy_reward_max": {"prey_policy": 197.98802825434706, "predator_policy": 339.82173861643486}, "policy_reward_mean": {"prey_policy": -78.07788716531104, "predator_policy": 136.19288657165959}, "custom_metrics": {}, "hist_stats": {"episode_reward": [82.44966788366241, 110.06879198011025, 56.01075777851723, 125.55685203794451, 77.07276380051852, 171.64962570617968, 116.49999999999994, 125.33875104898192, 81.44992324590572, 68.5587977312786, 93.18365872225874, 172.8744332437946, 44.106499537177285, 39.53709730530507, 107.85462180099191, 78.75783122560993, 108.90021816586452, 38.11617043276428, 256.5661462948361, 138.85159830819111, 186.42804505045453, 131.23558084112696, 91.97379849401048, 92.78840799568775, 218.83440989361142, 48.88228422524435, 152.79999999999936, 170.66726702632488, 88.4130366237924, 79.20885020615088, 186.85818608233689, 156.39474327532258, 59.40537604017962, 156.41706796820378, 45.5337467602903, 75.19999999999943, 107.65470512209444, 295.69611482692346, 153.8022392933226, 82.83406028698296, 189.09795889800233, 69.68337975714161, 35.961254312915514, 177.81076092567176, 200.20000000000002, 147.37161248718294, 82.21321998256967, 62.3353008990822, 92.00267127693581, 62.50000000000029, 42.64769786762717, 174.0852405110994, 158.0828070929525, 79.5709708018883, 61.40000000000033, 84.04932922216278, 236.82154907151656, 121.64678362824745, 216.66373384623367, 81.83649861769503, 99.81482367311796, 83.98107704385455, 206.5981344319628, 71.47120872451401, 133.13809224779732, 145.84180613205476, 114.13906527946043, 65.5042645452006, 135.0790998385388, 42.0316430350051, 73.83292228306743, 89.65350520458249, 263.3691276515, 81.56416546458959, 72.53846964307643, 129.81714385182363, 188.79999999999987, 136.43592667296014, 170.6607624198716, 68.29727761305077, 69.35540726375906, 93.01431244056991, 38.99012404963315, 73.96217176117923, 110.42531597004503, 54.461277706909335, 146.4575633911219, 91.53969792648239, 141.61406274804088, 222.13162657497162, 152.11658227923175, 208.2742084357522, 129.26920057957255, 59.412889632540505, 91.10602881989445, 90.14989609928209, 91.50680037933577, 67.42353733680791, 172.60141059549844, 96.20635606217894], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-126.86731761934794, 15.319864730836875, 19.74733674260537, -217.28947647306012, -88.4733562480029, 20.39939149767388, -12.114691900391476, -251.7299654035778, -289.57598113613767, -182.34824829663052, -86.94937574457485, -39.761687176141976, 5.044043458384493, -14.428235111172786, -322.190960439724, -20.517112297863946, -69.73610545402897, -182.4353003579303, -99.6518891848056, -43.99682856048324, -101.39787668389896, 15.171697152220872, -205.4679408996067, 26.0664030573909, -298.59055541505967, -154.85373604407695, -178.32502743915975, -106.67750046214495, -182.65366944266256, -9.103808802119604, -103.92388724171231, -323.366590282774, 33.65721523097791, -201.343211826969, -28.773338850331875, -93.00828960711587, -72.23260695610634, 197.98802825434706, -282.4654779701024, -9.2151071269144, 120.522878114662, -74.73515395002131, -127.05508048339702, -198.4727677051819, -24.794828053607375, -14.7963069073965, -253.60470998909358, -102.30281761142948, -166.85406755437606, 110.0169606331331, -153.90742019251135, -60.19400067465174, 15.75123080372188, 48.16003612847496, -127.2658083184313, 33.3603468900547, -41.9151173832819, -159.82231893006903, -92.38045557866948, 55.03649401441763, -26.51834658743714, -68.41446596620916, -184.9553288446273, 118.54893981863077, -13.798675247892193, -96.02899648737066, -88.34093848315686, -9.430530543388581, -146.21034229128614, -181.88454208039477, 20.45914049828278, -83.26443108160086, -155.03181615451493, 7.492385707111149, -20.26079733664665, -348.1023502992243, 0.5110749207247215, -200.75606413208496, -7.11521140560521, -189.13869154125337, 69.60950311447905, -297.9329879942548, -106.70324996731573, -76.73980702123214, -224.07858288646509, -146.7595128650661, -312.61716402511354, 30.770989423285833, -7.2089224943113805, 34.94030904321731, -213.3323411422996, -25.01886840761175, -105.5676913483405, -88.73191856540302, -124.88852251083547, -107.27676758398765, -68.14145383211077, 56.15842606013537, 2.9601957292428787, -41.79526231452939, -34.095090298473735, -233.80478401214052, -113.77113850245921, 98.48592003710246, -171.28981868212665, 68.22889490804857, -138.8094234715718, -279.81297180103104, -108.78638073061568, -16.989575453178265, -116.36026966055798, -54.738822638529165, -20.63686488054573, -7.035825470582177, -158.85605937625346, 47.95655967531272, 157.35887251865225, -123.12434798115187, -64.19655409670935, 27.44294446345716, -42.15415875206612, -17.42108383575747, -55.714317363784275, -122.19782050289791, 64.34303252593989, -122.15474280677603, -121.36060657653994, -88.85774834365496, -149.85422251174214, 0.6327747712582914, 91.84946331548147, -56.40751829821069, -61.89448189950846, 81.64207765477425, -121.30084131065091, -126.15951266574984, -10.798602120711887, -137.50719585830376, -8.799802275458289, -159.85197341749213, 5.136495347551431, -194.29709539359249, -92.25807604274296, -6.660767033185625, -263.82883476883796, 140.9670526133802, -75.33473840308038, -149.41411727880143, -35.514633416938594, -50.07822181708961, -119.64014048162034, -47.199827552027614, -36.82433760297642, 80.57914196553317, 4.2750064715023655, -173.64425880558053, -86.9387960106638, 16.057898323651393, -64.47227050332573, 15.491244026113579, -103.77901177573493, -292.1094179593251, -202.8659437016673, 12.750068424065208, -40.186026662923084, -287.64663565041616, -60.57643436729268, -223.04247346383025, -16.185203702277825, -95.31177196257553, -19.25163243980278, -264.80115352353636, 36.77509796308874, -195.14477975769339, -0.9957350679375665, -117.55138067796338, 44.86260904817923, -140.56388460426842, -217.60091671493956, 87.64553961492834, -111.00423670410345, 126.63671173317186, 90.53377024245131, -16.947142920163337, 7.784780298069387, -137.41958411474312, -168.30644282804394, -33.990068169881816, -113.988286063907, -206.48352899727004, -295.6437678467253, -62.747809710771236, 42.015685371715186, -53.32921281112193, 20.000000000000014, -181.0951514103707, -98.54173939927263, -37.29031540636486, 39.941051596645714, -83.80406664735777], "policy_predator_policy_reward": [188.0918546659186, 5.905266106255192, 33.81131961903651, 273.7996120915285, 77.47871213179576, 46.60601039704941, 118.18326784528603, 271.2182414966278, 268.97618462021177, 280.0208086130748, 128.74085872561668, 169.61982990127993, 56.355956541615626, 69.52823511117283, 314.08184597347275, 153.96497781309765, 165.3713877019322, 168.2499413559336, 79.15823178773103, 133.04928368883628, 78.09050188835371, 101.31933636558341, 215.94585561681694, 136.3301154691938, 267.3253035606166, 230.22548743569712, 207.37737665626773, 117.16224855034085, 252.67331581394143, 46.93878423183313, 257.8526672318949, 248.195641518201, 59.07298619183106, 217.5132285700242, 25.43835141088668, 134.45944747932452, 79.29959204003949, 51.51113295655614, 245.67041350921866, 184.86176989598994, 86.69829579040173, 53.94202509541226, 236.4739717577195, 220.28945727198646, 90.26877599920948, 41.296157455805414, 208.07786182635368, 240.61807376985712, 82.97461063718384, 192.6969061776708, 70.56305350727801, 192.42065158512855, 69.50203020254153, 19.38670286526178, 135.44150521052407, 129.13122324417745, 39.59515423693645, 250.55531870020678, 101.5321355086466, 15.020676261756151, 3.804205224057851, 277.9867934119255, 117.94356383409195, 104.85756846722725, 132.15693649533657, 37.07611128010567, 106.38696157432737, 147.80157542042298, 237.28351699878925, 136.3451141331809, 41.24085950171735, 96.76443108160024, 164.84672746099602, 90.34740810850218, 339.82173861643486, 324.23752384635947, 227.92082943849127, 126.12639906619165, 170.7587003209353, 108.3292629129064, 179.95746318094646, 237.46398059683182, 96.46780050658451, 156.6586362391043, 286.62759600200826, 120.17175406243787, 327.451924468197, 132.20501105930393, 62.771590529685646, 109.69702292140845, 206.5455378440487, 179.17728419304567, 180.44627195750886, 96.06655793880404, 118.38613287545306, 176.11445811845093, 87.2314517367583, 16.754247312152856, 15.639804270757084, 85.69526231452902, 94.17515147658946, 216.37242070165186, 135.17113850245894, 54.19932047399727, 61.78411460855394, 199.3596162584765, 261.63458286367654, 236.5587832108145, 124.68779796294493, 62.48815822084866, 67.76950692541912, 187.3789145958314, 166.88995278498663, 97.60428663765813, 116.97645963617751, 115.56982369301109, 88.58891536279751, 93.84029394593584, 17.984754140092704, 100.60535411085391, 120.64924510397269, 38.74082115696981, 118.4953944076389, 143.39782050289745, 110.81150928950629, 153.59833542329258, 109.54387224580456, 172.1456913989042, 123.22626366037512, 159.13327632790612, 69.47200915452339, 40.92785196026068, 90.7058406860563, 3.685628838138441, 123.88507592340859, 189.0795425981925, 110.86663753451955, 172.5182602830349, 179.69255913264, 30.990859595315104, 153.96632743723777, 109.02719489187099, 12.63274313436096, 175.93960514614983, 215.51400897661273, 170.71690083034505, 142.7458219963463, 163.56719915012417, 60.08148326037814, 98.04984161672625, 130.4074497095053, 166.24966217596602, 92.62433760297657, 52.420858034466846, 82.20259844587017, 223.60258056116865, 119.65198932336992, 121.88967078351453, 116.513466306933, 0.7648377833291353, 154.76991755128745, 310.4739194475316, 154.27481675394367, 128.85537096422834, 233.1422008138656, 133.6805855491069, 125.33131171905819, 232.24976787324263, 75.35752056018643, 146.56477107471167, 202.49820336579003, 136.01586030445893, 157.80984955657416, 147.01739562915247, 77.48847450051295, 132.59833917187007, 196.7959649230167, 40.519373381113816, 173.0443861644422, 179.0426175105409, 135.61441751127003, 0.8696897388933799, 92.65294266601023, 42.03463844745369, 81.64391844857039, 177.26008594767617, 118.63383889935915, 143.07556173110683, 203.188022793714, 208.38982108735723, 323.7437678467252, 124.79770581005323, 33.08431462828497, 69.73601319045763, 181.87201959078584, 46.646669156392406, 165.2421271317047, 143.19133826943118, 40.86530446553435, 99.20406664735698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.898747758369062, "mean_inference_ms": 4.222356810000122, "mean_action_processing_ms": 2.1892156538020187, "mean_env_wait_ms": 10.4472434744991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003917694091796875, "StateBufferConnector_ms": 0.004180312156677246, "ViewRequirementAgentConnector_ms": 0.12200498580932617}, "num_episodes": 12, "episode_return_max": 295.69611482692346, "episode_return_min": 35.961254312915514, "episode_return_mean": 116.22999881269712, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.68903416904898, "num_env_steps_trained_throughput_per_sec": 83.68903416904898, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 47413.713, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47413.595, "sample_time_ms": 2209.216, "learn_time_ms": 45182.929, "learn_throughput": 88.529, "synch_weights_time_ms": 17.542}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-41-03", "timestamp": 1724148663, "time_this_iter_s": 47.82850790023804, "time_total_s": 1231.164718389511, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120023af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1231.164718389511, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 26.722388059701494, "ram_util_percent": 82.81343283582088}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.218776379123566, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.800681254220387, "policy_loss": -0.019248917587372478, "vf_loss": 7.81752267615505, "vf_explained_var": 0.3186333567377121, "kl": 0.012037541566012555, "entropy": 1.0366111305970995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.765296618301402, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.568188842642244, "policy_loss": -0.013130077321289315, "vf_loss": 5.579185465908555, "vf_explained_var": 0.13405700612951207, "kl": 0.010667302445557816, "entropy": 0.9748521768857562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 295.69611482692346, "episode_reward_min": 26.36290158451729, "episode_reward_mean": 119.44121267922738, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -348.1023502992243, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 157.35887251865225, "predator_policy": 339.82173861643486}, "policy_reward_mean": {"prey_policy": -70.8529162669262, "predator_policy": 130.57352260653988}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.97379849401048, 92.78840799568775, 218.83440989361142, 48.88228422524435, 152.79999999999936, 170.66726702632488, 88.4130366237924, 79.20885020615088, 186.85818608233689, 156.39474327532258, 59.40537604017962, 156.41706796820378, 45.5337467602903, 75.19999999999943, 107.65470512209444, 295.69611482692346, 153.8022392933226, 82.83406028698296, 189.09795889800233, 69.68337975714161, 35.961254312915514, 177.81076092567176, 200.20000000000002, 147.37161248718294, 82.21321998256967, 62.3353008990822, 92.00267127693581, 62.50000000000029, 42.64769786762717, 174.0852405110994, 158.0828070929525, 79.5709708018883, 61.40000000000033, 84.04932922216278, 236.82154907151656, 121.64678362824745, 216.66373384623367, 81.83649861769503, 99.81482367311796, 83.98107704385455, 206.5981344319628, 71.47120872451401, 133.13809224779732, 145.84180613205476, 114.13906527946043, 65.5042645452006, 135.0790998385388, 42.0316430350051, 73.83292228306743, 89.65350520458249, 263.3691276515, 81.56416546458959, 72.53846964307643, 129.81714385182363, 188.79999999999987, 136.43592667296014, 170.6607624198716, 68.29727761305077, 69.35540726375906, 93.01431244056991, 38.99012404963315, 73.96217176117923, 110.42531597004503, 54.461277706909335, 146.4575633911219, 91.53969792648239, 141.61406274804088, 222.13162657497162, 152.11658227923175, 208.2742084357522, 129.26920057957255, 59.412889632540505, 91.10602881989445, 90.14989609928209, 91.50680037933577, 67.42353733680791, 172.60141059549844, 96.20635606217894, 183.01608229756016, 173.45365886376405, 121.10460642329669, 103.16192316470352, 131.53650150417735, 105.05775254611962, 100.1999999999998, 44.652968276705614, 70.5144064490793, 26.36290158451729, 168.61742669680135, 116.5080605001809, 137.93622404141152, 212.82442260340954, 92.80000000000001, 131.44833636655738, 108.29625264051084, 60.74166670769996, 190.0888144404509, 143.29676588358416, 174.67791197352705, 135.89253583044194], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.794828053607375, -14.7963069073965, -253.60470998909358, -102.30281761142948, -166.85406755437606, 110.0169606331331, -153.90742019251135, -60.19400067465174, 15.75123080372188, 48.16003612847496, -127.2658083184313, 33.3603468900547, -41.9151173832819, -159.82231893006903, -92.38045557866948, 55.03649401441763, -26.51834658743714, -68.41446596620916, -184.9553288446273, 118.54893981863077, -13.798675247892193, -96.02899648737066, -88.34093848315686, -9.430530543388581, -146.21034229128614, -181.88454208039477, 20.45914049828278, -83.26443108160086, -155.03181615451493, 7.492385707111149, -20.26079733664665, -348.1023502992243, 0.5110749207247215, -200.75606413208496, -7.11521140560521, -189.13869154125337, 69.60950311447905, -297.9329879942548, -106.70324996731573, -76.73980702123214, -224.07858288646509, -146.7595128650661, -312.61716402511354, 30.770989423285833, -7.2089224943113805, 34.94030904321731, -213.3323411422996, -25.01886840761175, -105.5676913483405, -88.73191856540302, -124.88852251083547, -107.27676758398765, -68.14145383211077, 56.15842606013537, 2.9601957292428787, -41.79526231452939, -34.095090298473735, -233.80478401214052, -113.77113850245921, 98.48592003710246, -171.28981868212665, 68.22889490804857, -138.8094234715718, -279.81297180103104, -108.78638073061568, -16.989575453178265, -116.36026966055798, -54.738822638529165, -20.63686488054573, -7.035825470582177, -158.85605937625346, 47.95655967531272, 157.35887251865225, -123.12434798115187, -64.19655409670935, 27.44294446345716, -42.15415875206612, -17.42108383575747, -55.714317363784275, -122.19782050289791, 64.34303252593989, -122.15474280677603, -121.36060657653994, -88.85774834365496, -149.85422251174214, 0.6327747712582914, 91.84946331548147, -56.40751829821069, -61.89448189950846, 81.64207765477425, -121.30084131065091, -126.15951266574984, -10.798602120711887, -137.50719585830376, -8.799802275458289, -159.85197341749213, 5.136495347551431, -194.29709539359249, -92.25807604274296, -6.660767033185625, -263.82883476883796, 140.9670526133802, -75.33473840308038, -149.41411727880143, -35.514633416938594, -50.07822181708961, -119.64014048162034, -47.199827552027614, -36.82433760297642, 80.57914196553317, 4.2750064715023655, -173.64425880558053, -86.9387960106638, 16.057898323651393, -64.47227050332573, 15.491244026113579, -103.77901177573493, -292.1094179593251, -202.8659437016673, 12.750068424065208, -40.186026662923084, -287.64663565041616, -60.57643436729268, -223.04247346383025, -16.185203702277825, -95.31177196257553, -19.25163243980278, -264.80115352353636, 36.77509796308874, -195.14477975769339, -0.9957350679375665, -117.55138067796338, 44.86260904817923, -140.56388460426842, -217.60091671493956, 87.64553961492834, -111.00423670410345, 126.63671173317186, 90.53377024245131, -16.947142920163337, 7.784780298069387, -137.41958411474312, -168.30644282804394, -33.990068169881816, -113.988286063907, -206.48352899727004, -295.6437678467253, -62.747809710771236, 42.015685371715186, -53.32921281112193, 20.000000000000014, -181.0951514103707, -98.54173939927263, -37.29031540636486, 39.941051596645714, -83.80406664735777, 39.16758762368738, -24.182794597268035, -151.1310622974225, -158.56406694035232, -116.08105892425918, 44.61387876489539, -210.54392273294405, -8.809835083246824, -186.194076611346, 32.199288393319115, -18.098737921454966, -89.74253613091071, 11.37399986397791, 60.506461792329134, -298.39773982050235, -25.153397176596016, 12.987133550547773, -5.508807632910001, -144.14078710141777, -111.55724989144967, 10.133371650256477, -165.573743841322, -265.6129220728864, -59.2826772574458, -42.255483129855506, -164.73272214955932, 59.563008972896, 30.128363472353485, 7.218548353853604, 34.53685493911001, -34.337464302442804, -20.71871112568318, -180.7551537580066, -43.31775145404957, -208.5965126268292, -223.20719832534692, -92.88681554008711, 3.2757008211579333, -77.06802866667084, 51.01611257330801, -39.392847422125094, -86.55848922641934, -82.90085849657157, 37.76602080852843], "policy_predator_policy_reward": [90.26877599920948, 41.296157455805414, 208.07786182635368, 240.61807376985712, 82.97461063718384, 192.6969061776708, 70.56305350727801, 192.42065158512855, 69.50203020254153, 19.38670286526178, 135.44150521052407, 129.13122324417745, 39.59515423693645, 250.55531870020678, 101.5321355086466, 15.020676261756151, 3.804205224057851, 277.9867934119255, 117.94356383409195, 104.85756846722725, 132.15693649533657, 37.07611128010567, 106.38696157432737, 147.80157542042298, 237.28351699878925, 136.3451141331809, 41.24085950171735, 96.76443108160024, 164.84672746099602, 90.34740810850218, 339.82173861643486, 324.23752384635947, 227.92082943849127, 126.12639906619165, 170.7587003209353, 108.3292629129064, 179.95746318094646, 237.46398059683182, 96.46780050658451, 156.6586362391043, 286.62759600200826, 120.17175406243787, 327.451924468197, 132.20501105930393, 62.771590529685646, 109.69702292140845, 206.5455378440487, 179.17728419304567, 180.44627195750886, 96.06655793880404, 118.38613287545306, 176.11445811845093, 87.2314517367583, 16.754247312152856, 15.639804270757084, 85.69526231452902, 94.17515147658946, 216.37242070165186, 135.17113850245894, 54.19932047399727, 61.78411460855394, 199.3596162584765, 261.63458286367654, 236.5587832108145, 124.68779796294493, 62.48815822084866, 67.76950692541912, 187.3789145958314, 166.88995278498663, 97.60428663765813, 116.97645963617751, 115.56982369301109, 88.58891536279751, 93.84029394593584, 17.984754140092704, 100.60535411085391, 120.64924510397269, 38.74082115696981, 118.4953944076389, 143.39782050289745, 110.81150928950629, 153.59833542329258, 109.54387224580456, 172.1456913989042, 123.22626366037512, 159.13327632790612, 69.47200915452339, 40.92785196026068, 90.7058406860563, 3.685628838138441, 123.88507592340859, 189.0795425981925, 110.86663753451955, 172.5182602830349, 179.69255913264, 30.990859595315104, 153.96632743723777, 109.02719489187099, 12.63274313436096, 175.93960514614983, 215.51400897661273, 170.71690083034505, 142.7458219963463, 163.56719915012417, 60.08148326037814, 98.04984161672625, 130.4074497095053, 166.24966217596602, 92.62433760297657, 52.420858034466846, 82.20259844587017, 223.60258056116865, 119.65198932336992, 121.88967078351453, 116.513466306933, 0.7648377833291353, 154.76991755128745, 310.4739194475316, 154.27481675394367, 128.85537096422834, 233.1422008138656, 133.6805855491069, 125.33131171905819, 232.24976787324263, 75.35752056018643, 146.56477107471167, 202.49820336579003, 136.01586030445893, 157.80984955657416, 147.01739562915247, 77.48847450051295, 132.59833917187007, 196.7959649230167, 40.519373381113816, 173.0443861644422, 179.0426175105409, 135.61441751127003, 0.8696897388933799, 92.65294266601023, 42.03463844745369, 81.64391844857039, 177.26008594767617, 118.63383889935915, 143.07556173110683, 203.188022793714, 208.38982108735723, 323.7437678467252, 124.79770581005323, 33.08431462828497, 69.73601319045763, 181.87201959078584, 46.646669156392406, 165.2421271317047, 143.19133826943118, 40.86530446553435, 99.20406664735698, 99.0732781444708, 68.95801112667064, 221.9974884945163, 261.15129960702257, 156.3074185797433, 36.26436800291724, 186.39097969367253, 136.12470128722185, 58.47777740420441, 227.05351231800012, 51.10730479462084, 161.79172180386453, 28.319538343692937, 0.0, 248.43567224255892, 119.76843303124502, 49.321798481671294, 13.714282049770151, 155.46055012669572, 126.60038845068787, 150.92655366243721, 173.1312452254301, 286.07227487592814, 155.33138495458496, 169.8459009658292, 175.07852835499668, 37.546338151746035, 85.58671200641456, 31.013192004755506, 20.031404702281005, 66.97406064255675, 119.53045115212784, 211.43348026895907, 120.93567758360838, 190.18005988062453, 302.3653177792513, 116.59504682858808, 163.10488233079224, 28.809367007518016, 140.53931496942903, 182.39648481726306, 118.232763804809, 154.9054429300026, 26.121930588482638]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.8444516560462985, "mean_inference_ms": 4.185626405471555, "mean_action_processing_ms": 2.1315855792863387, "mean_env_wait_ms": 10.415735999762125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014542222023010254, "StateBufferConnector_ms": 0.004398226737976074, "ViewRequirementAgentConnector_ms": 0.11224329471588135}, "num_episodes": 22, "episode_return_max": 295.69611482692346, "episode_return_min": 26.36290158451729, "episode_return_mean": 119.44121267922738, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.10889610779662, "num_env_steps_trained_throughput_per_sec": 85.10889610779662, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 47216.323, "restore_workers_time_ms": 0.015, "training_step_time_ms": 47216.205, "sample_time_ms": 2146.859, "learn_time_ms": 45048.058, "learn_throughput": 88.794, "synch_weights_time_ms": 17.439}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-41-50", "timestamp": 1724148710, "time_this_iter_s": 47.05056381225586, "time_total_s": 1278.215282201767, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33132f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1278.215282201767, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 25.480597014925372, "ram_util_percent": 82.49253731343285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.231363145384208, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.76771052779344, "policy_loss": -0.017436296067313936, "vf_loss": 7.782938456913781, "vf_explained_var": 0.41987142584942005, "kl": 0.011041881991106839, "entropy": 1.0372096086305285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.052024332713828, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.18470878853369, "policy_loss": -0.014958077989932563, "vf_loss": 5.1978943641854345, "vf_explained_var": 0.17094098528226218, "kl": 0.008862475251838092, "entropy": 0.9755728541227876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 287.05143790293164, "episode_reward_min": 1.1011890377250426, "episode_reward_mean": 118.91995125137547, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -385.5886671720855, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 157.35887251865225, "predator_policy": 381.3155178247563}, "policy_reward_mean": {"prey_policy": -71.45884843511205, "predator_policy": 130.91882406079975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [82.21321998256967, 62.3353008990822, 92.00267127693581, 62.50000000000029, 42.64769786762717, 174.0852405110994, 158.0828070929525, 79.5709708018883, 61.40000000000033, 84.04932922216278, 236.82154907151656, 121.64678362824745, 216.66373384623367, 81.83649861769503, 99.81482367311796, 83.98107704385455, 206.5981344319628, 71.47120872451401, 133.13809224779732, 145.84180613205476, 114.13906527946043, 65.5042645452006, 135.0790998385388, 42.0316430350051, 73.83292228306743, 89.65350520458249, 263.3691276515, 81.56416546458959, 72.53846964307643, 129.81714385182363, 188.79999999999987, 136.43592667296014, 170.6607624198716, 68.29727761305077, 69.35540726375906, 93.01431244056991, 38.99012404963315, 73.96217176117923, 110.42531597004503, 54.461277706909335, 146.4575633911219, 91.53969792648239, 141.61406274804088, 222.13162657497162, 152.11658227923175, 208.2742084357522, 129.26920057957255, 59.412889632540505, 91.10602881989445, 90.14989609928209, 91.50680037933577, 67.42353733680791, 172.60141059549844, 96.20635606217894, 183.01608229756016, 173.45365886376405, 121.10460642329669, 103.16192316470352, 131.53650150417735, 105.05775254611962, 100.1999999999998, 44.652968276705614, 70.5144064490793, 26.36290158451729, 168.61742669680135, 116.5080605001809, 137.93622404141152, 212.82442260340954, 92.80000000000001, 131.44833636655738, 108.29625264051084, 60.74166670769996, 190.0888144404509, 143.29676588358416, 174.67791197352705, 135.89253583044194, 140.32759915283822, 52.49432297836987, 117.62891261353106, 134.23309991198687, 97.40845581612348, 210.9842624264662, 187.07391372989542, 112.75706088251991, 157.30339152132157, 83.89999999999992, 112.39868256032445, 50.900000000000276, 36.2000000000002, 69.1207817932328, 167.50510108194342, 100.94029034840472, 110.23114065781357, 287.05143790293164, 180.53544511615524, 265.7497922825642, 122.69431085565783, 147.3984855572551, 85.42544148914183, 1.1011890377250426], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-105.5676913483405, -88.73191856540302, -124.88852251083547, -107.27676758398765, -68.14145383211077, 56.15842606013537, 2.9601957292428787, -41.79526231452939, -34.095090298473735, -233.80478401214052, -113.77113850245921, 98.48592003710246, -171.28981868212665, 68.22889490804857, -138.8094234715718, -279.81297180103104, -108.78638073061568, -16.989575453178265, -116.36026966055798, -54.738822638529165, -20.63686488054573, -7.035825470582177, -158.85605937625346, 47.95655967531272, 157.35887251865225, -123.12434798115187, -64.19655409670935, 27.44294446345716, -42.15415875206612, -17.42108383575747, -55.714317363784275, -122.19782050289791, 64.34303252593989, -122.15474280677603, -121.36060657653994, -88.85774834365496, -149.85422251174214, 0.6327747712582914, 91.84946331548147, -56.40751829821069, -61.89448189950846, 81.64207765477425, -121.30084131065091, -126.15951266574984, -10.798602120711887, -137.50719585830376, -8.799802275458289, -159.85197341749213, 5.136495347551431, -194.29709539359249, -92.25807604274296, -6.660767033185625, -263.82883476883796, 140.9670526133802, -75.33473840308038, -149.41411727880143, -35.514633416938594, -50.07822181708961, -119.64014048162034, -47.199827552027614, -36.82433760297642, 80.57914196553317, 4.2750064715023655, -173.64425880558053, -86.9387960106638, 16.057898323651393, -64.47227050332573, 15.491244026113579, -103.77901177573493, -292.1094179593251, -202.8659437016673, 12.750068424065208, -40.186026662923084, -287.64663565041616, -60.57643436729268, -223.04247346383025, -16.185203702277825, -95.31177196257553, -19.25163243980278, -264.80115352353636, 36.77509796308874, -195.14477975769339, -0.9957350679375665, -117.55138067796338, 44.86260904817923, -140.56388460426842, -217.60091671493956, 87.64553961492834, -111.00423670410345, 126.63671173317186, 90.53377024245131, -16.947142920163337, 7.784780298069387, -137.41958411474312, -168.30644282804394, -33.990068169881816, -113.988286063907, -206.48352899727004, -295.6437678467253, -62.747809710771236, 42.015685371715186, -53.32921281112193, 20.000000000000014, -181.0951514103707, -98.54173939927263, -37.29031540636486, 39.941051596645714, -83.80406664735777, 39.16758762368738, -24.182794597268035, -151.1310622974225, -158.56406694035232, -116.08105892425918, 44.61387876489539, -210.54392273294405, -8.809835083246824, -186.194076611346, 32.199288393319115, -18.098737921454966, -89.74253613091071, 11.37399986397791, 60.506461792329134, -298.39773982050235, -25.153397176596016, 12.987133550547773, -5.508807632910001, -144.14078710141777, -111.55724989144967, 10.133371650256477, -165.573743841322, -265.6129220728864, -59.2826772574458, -42.255483129855506, -164.73272214955932, 59.563008972896, 30.128363472353485, 7.218548353853604, 34.53685493911001, -34.337464302442804, -20.71871112568318, -180.7551537580066, -43.31775145404957, -208.5965126268292, -223.20719832534692, -92.88681554008711, 3.2757008211579333, -77.06802866667084, 51.01611257330801, -39.392847422125094, -86.55848922641934, -82.90085849657157, 37.76602080852843, -189.9238428797057, -127.42079547515883, -52.557168705082475, -67.2204815433596, -101.56450708738735, 13.34897334311583, -171.53895237273574, 58.90553171814532, -149.21698987032494, 21.99226277637578, -184.1978032409365, 48.48062673571497, 41.14518356921334, -251.72091148924366, 5.284125907894598, -285.90990220900795, -19.09643749024752, -67.52903993228028, -58.07130796634476, -161.88405294339418, -140.99647850063593, -385.5886671720855, -80.27237977869247, -77.29280193129286, -41.8038496464734, -41.80122372414567, -60.145624863951944, -89.24621707281436, -122.85419883546852, 37.961718407538754, -191.24979583131545, -60.85996132364737, -56.07414851846127, -240.48882031755625, 37.69134339915308, 150.37822232573194, -42.75706354071737, -39.74043158688749, 144.66496952262983, -86.45199468195902, -102.85280326761914, -91.36754109132583, 37.673634597986045, -237.52762839778353, 36.56794802412938, -233.31084953070868, -202.02645430664515, -125.54325232375143], "policy_predator_policy_reward": [180.44627195750886, 96.06655793880404, 118.38613287545306, 176.11445811845093, 87.2314517367583, 16.754247312152856, 15.639804270757084, 85.69526231452902, 94.17515147658946, 216.37242070165186, 135.17113850245894, 54.19932047399727, 61.78411460855394, 199.3596162584765, 261.63458286367654, 236.5587832108145, 124.68779796294493, 62.48815822084866, 67.76950692541912, 187.3789145958314, 166.88995278498663, 97.60428663765813, 116.97645963617751, 115.56982369301109, 88.58891536279751, 93.84029394593584, 17.984754140092704, 100.60535411085391, 120.64924510397269, 38.74082115696981, 118.4953944076389, 143.39782050289745, 110.81150928950629, 153.59833542329258, 109.54387224580456, 172.1456913989042, 123.22626366037512, 159.13327632790612, 69.47200915452339, 40.92785196026068, 90.7058406860563, 3.685628838138441, 123.88507592340859, 189.0795425981925, 110.86663753451955, 172.5182602830349, 179.69255913264, 30.990859595315104, 153.96632743723777, 109.02719489187099, 12.63274313436096, 175.93960514614983, 215.51400897661273, 170.71690083034505, 142.7458219963463, 163.56719915012417, 60.08148326037814, 98.04984161672625, 130.4074497095053, 166.24966217596602, 92.62433760297657, 52.420858034466846, 82.20259844587017, 223.60258056116865, 119.65198932336992, 121.88967078351453, 116.513466306933, 0.7648377833291353, 154.76991755128745, 310.4739194475316, 154.27481675394367, 128.85537096422834, 233.1422008138656, 133.6805855491069, 125.33131171905819, 232.24976787324263, 75.35752056018643, 146.56477107471167, 202.49820336579003, 136.01586030445893, 157.80984955657416, 147.01739562915247, 77.48847450051295, 132.59833917187007, 196.7959649230167, 40.519373381113816, 173.0443861644422, 179.0426175105409, 135.61441751127003, 0.8696897388933799, 92.65294266601023, 42.03463844745369, 81.64391844857039, 177.26008594767617, 118.63383889935915, 143.07556173110683, 203.188022793714, 208.38982108735723, 323.7437678467252, 124.79770581005323, 33.08431462828497, 69.73601319045763, 181.87201959078584, 46.646669156392406, 165.2421271317047, 143.19133826943118, 40.86530446553435, 99.20406664735698, 99.0732781444708, 68.95801112667064, 221.9974884945163, 261.15129960702257, 156.3074185797433, 36.26436800291724, 186.39097969367253, 136.12470128722185, 58.47777740420441, 227.05351231800012, 51.10730479462084, 161.79172180386453, 28.319538343692937, 0.0, 248.43567224255892, 119.76843303124502, 49.321798481671294, 13.714282049770151, 155.46055012669572, 126.60038845068787, 150.92655366243721, 173.1312452254301, 286.07227487592814, 155.33138495458496, 169.8459009658292, 175.07852835499668, 37.546338151746035, 85.58671200641456, 31.013192004755506, 20.031404702281005, 66.97406064255675, 119.53045115212784, 211.43348026895907, 120.93567758360838, 190.18005988062453, 302.3653177792513, 116.59504682858808, 163.10488233079224, 28.809367007518016, 140.53931496942903, 182.39648481726306, 118.232763804809, 154.9054429300026, 26.121930588482638, 248.64070649709916, 209.03153101060343, 85.6969814395757, 86.57499178723576, 137.79594129557674, 68.04850506222611, 123.51307291721847, 123.35344764935859, 125.00817440738221, 99.62500850269089, 142.6334765753675, 204.06796235632007, 289.77947547600576, 107.87016617392014, 201.66135615651504, 191.72148102711876, 181.18455727009535, 62.74431167375446, 144.1897432817198, 159.66561762801916, 257.66831040828924, 381.3155178247563, 95.5723797786916, 112.89280193129254, 60.90384964647361, 58.90122372414592, 82.59537875639647, 135.91724497360187, 177.62049831093387, 74.77708319893921, 224.54589104869586, 128.50415645467186, 194.21772589936097, 212.57638359446966, 85.10100454773017, 13.880867630315425, 153.67731860764366, 109.35562163611709, 91.32988909424033, 116.20692834765313, 130.582761690092, 186.33189352451066, 197.74454177211402, 149.50793758493808, 198.0691855673684, 84.09915742835247, 189.86405661470704, 138.80683905341414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.805716049296968, "mean_inference_ms": 4.141118649605634, "mean_action_processing_ms": 2.05345889547095, "mean_env_wait_ms": 10.393762516029808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015956759452819824, "StateBufferConnector_ms": 0.004175901412963867, "ViewRequirementAgentConnector_ms": 0.119529128074646}, "num_episodes": 24, "episode_return_max": 287.05143790293164, "episode_return_min": 1.1011890377250426, "episode_return_mean": 118.91995125137547, "episodes_this_iter": 24}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.27207915745296, "num_env_steps_trained_throughput_per_sec": 85.27207915745296, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 47237.466, "restore_workers_time_ms": 0.015, "training_step_time_ms": 47237.347, "sample_time_ms": 2156.711, "learn_time_ms": 45058.831, "learn_throughput": 88.773, "synch_weights_time_ms": 17.932}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-42-37", "timestamp": 1724148757, "time_this_iter_s": 46.91744089126587, "time_total_s": 1325.1327230930328, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33132b160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1325.1327230930328, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 24.828787878787875, "ram_util_percent": 82.29090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.228393036473996, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.370167672949493, "policy_loss": -0.015038096144297727, "vf_loss": 7.383110783087513, "vf_explained_var": 0.33844521086682716, "kl": 0.010474857932853477, "entropy": 1.0019084829817373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.868384614507988, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.752036353519984, "policy_loss": -0.016575930878968425, "vf_loss": 4.766708237405807, "vf_explained_var": 0.15428570691870633, "kl": 0.009520153038169223, "entropy": 1.003673658989094, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 287.05143790293164, "episode_reward_min": 1.1011890377250426, "episode_reward_mean": 128.20077165023645, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -385.5886671720855, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 381.3155178247563}, "policy_reward_mean": {"prey_policy": -67.88309213058102, "predator_policy": 131.98347795569924}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.5042645452006, 135.0790998385388, 42.0316430350051, 73.83292228306743, 89.65350520458249, 263.3691276515, 81.56416546458959, 72.53846964307643, 129.81714385182363, 188.79999999999987, 136.43592667296014, 170.6607624198716, 68.29727761305077, 69.35540726375906, 93.01431244056991, 38.99012404963315, 73.96217176117923, 110.42531597004503, 54.461277706909335, 146.4575633911219, 91.53969792648239, 141.61406274804088, 222.13162657497162, 152.11658227923175, 208.2742084357522, 129.26920057957255, 59.412889632540505, 91.10602881989445, 90.14989609928209, 91.50680037933577, 67.42353733680791, 172.60141059549844, 96.20635606217894, 183.01608229756016, 173.45365886376405, 121.10460642329669, 103.16192316470352, 131.53650150417735, 105.05775254611962, 100.1999999999998, 44.652968276705614, 70.5144064490793, 26.36290158451729, 168.61742669680135, 116.5080605001809, 137.93622404141152, 212.82442260340954, 92.80000000000001, 131.44833636655738, 108.29625264051084, 60.74166670769996, 190.0888144404509, 143.29676588358416, 174.67791197352705, 135.89253583044194, 140.32759915283822, 52.49432297836987, 117.62891261353106, 134.23309991198687, 97.40845581612348, 210.9842624264662, 187.07391372989542, 112.75706088251991, 157.30339152132157, 83.89999999999992, 112.39868256032445, 50.900000000000276, 36.2000000000002, 69.1207817932328, 167.50510108194342, 100.94029034840472, 110.23114065781357, 287.05143790293164, 180.53544511615524, 265.7497922825642, 122.69431085565783, 147.3984855572551, 85.42544148914183, 1.1011890377250426, 77.85133698041967, 283.553638080206, 71.25084389692513, 185.49235725369928, 98.25205968125954, 253.5371626943457, 182.74976356120223, 61.69994614677914, 148.95476051190977, 222.09999999999923, 199.9484204709477, 145.9164633538886, 100.5178180459657, 171.4013858885409, 165.98590578284032, 228.54142562990103, 95.8454700492111, 192.67052609565928, 213.29999999999927, 60.75241975167914, 178.60034636148936], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-121.30084131065091, -126.15951266574984, -10.798602120711887, -137.50719585830376, -8.799802275458289, -159.85197341749213, 5.136495347551431, -194.29709539359249, -92.25807604274296, -6.660767033185625, -263.82883476883796, 140.9670526133802, -75.33473840308038, -149.41411727880143, -35.514633416938594, -50.07822181708961, -119.64014048162034, -47.199827552027614, -36.82433760297642, 80.57914196553317, 4.2750064715023655, -173.64425880558053, -86.9387960106638, 16.057898323651393, -64.47227050332573, 15.491244026113579, -103.77901177573493, -292.1094179593251, -202.8659437016673, 12.750068424065208, -40.186026662923084, -287.64663565041616, -60.57643436729268, -223.04247346383025, -16.185203702277825, -95.31177196257553, -19.25163243980278, -264.80115352353636, 36.77509796308874, -195.14477975769339, -0.9957350679375665, -117.55138067796338, 44.86260904817923, -140.56388460426842, -217.60091671493956, 87.64553961492834, -111.00423670410345, 126.63671173317186, 90.53377024245131, -16.947142920163337, 7.784780298069387, -137.41958411474312, -168.30644282804394, -33.990068169881816, -113.988286063907, -206.48352899727004, -295.6437678467253, -62.747809710771236, 42.015685371715186, -53.32921281112193, 20.000000000000014, -181.0951514103707, -98.54173939927263, -37.29031540636486, 39.941051596645714, -83.80406664735777, 39.16758762368738, -24.182794597268035, -151.1310622974225, -158.56406694035232, -116.08105892425918, 44.61387876489539, -210.54392273294405, -8.809835083246824, -186.194076611346, 32.199288393319115, -18.098737921454966, -89.74253613091071, 11.37399986397791, 60.506461792329134, -298.39773982050235, -25.153397176596016, 12.987133550547773, -5.508807632910001, -144.14078710141777, -111.55724989144967, 10.133371650256477, -165.573743841322, -265.6129220728864, -59.2826772574458, -42.255483129855506, -164.73272214955932, 59.563008972896, 30.128363472353485, 7.218548353853604, 34.53685493911001, -34.337464302442804, -20.71871112568318, -180.7551537580066, -43.31775145404957, -208.5965126268292, -223.20719832534692, -92.88681554008711, 3.2757008211579333, -77.06802866667084, 51.01611257330801, -39.392847422125094, -86.55848922641934, -82.90085849657157, 37.76602080852843, -189.9238428797057, -127.42079547515883, -52.557168705082475, -67.2204815433596, -101.56450708738735, 13.34897334311583, -171.53895237273574, 58.90553171814532, -149.21698987032494, 21.99226277637578, -184.1978032409365, 48.48062673571497, 41.14518356921334, -251.72091148924366, 5.284125907894598, -285.90990220900795, -19.09643749024752, -67.52903993228028, -58.07130796634476, -161.88405294339418, -140.99647850063593, -385.5886671720855, -80.27237977869247, -77.29280193129286, -41.8038496464734, -41.80122372414567, -60.145624863951944, -89.24621707281436, -122.85419883546852, 37.961718407538754, -191.24979583131545, -60.85996132364737, -56.07414851846127, -240.48882031755625, 37.69134339915308, 150.37822232573194, -42.75706354071737, -39.74043158688749, 144.66496952262983, -86.45199468195902, -102.85280326761914, -91.36754109132583, 37.673634597986045, -237.52762839778353, 36.56794802412938, -233.31084953070868, -202.02645430664515, -125.54325232375143, -90.56516610764993, -100.41984327215715, 161.84827425695832, -31.20879630780638, -130.03236245735383, 7.3046454143500394, -139.21081138278942, 43.565906576280376, -1.230567194578363, -193.87799005964135, 147.7115204657909, -134.2117592409096, -27.834113763693722, 72.55327912112834, -220.34600800736405, -181.01968101043124, 19.425505490186538, -221.62914007310272, 200.0, 4.376084365422251, -275.82968562075246, 99.05787488397084, -193.03896748506122, 94.13738428975682, 38.1484709645742, -277.5044710159058, 63.84213776456551, -77.36654458197074, -145.30270506164646, 104.06245872679162, 110.70371261654134, -81.15350668115589, -101.63094211980919, -133.49733139310004, -181.95561333141552, 18.86497637561061, -4.871493839645112, 193.7442381951311, 37.74388436099655, -31.769315017988824, -174.35270392908325, 128.25334355049793], "policy_predator_policy_reward": [123.88507592340859, 189.0795425981925, 110.86663753451955, 172.5182602830349, 179.69255913264, 30.990859595315104, 153.96632743723777, 109.02719489187099, 12.63274313436096, 175.93960514614983, 215.51400897661273, 170.71690083034505, 142.7458219963463, 163.56719915012417, 60.08148326037814, 98.04984161672625, 130.4074497095053, 166.24966217596602, 92.62433760297657, 52.420858034466846, 82.20259844587017, 223.60258056116865, 119.65198932336992, 121.88967078351453, 116.513466306933, 0.7648377833291353, 154.76991755128745, 310.4739194475316, 154.27481675394367, 128.85537096422834, 233.1422008138656, 133.6805855491069, 125.33131171905819, 232.24976787324263, 75.35752056018643, 146.56477107471167, 202.49820336579003, 136.01586030445893, 157.80984955657416, 147.01739562915247, 77.48847450051295, 132.59833917187007, 196.7959649230167, 40.519373381113816, 173.0443861644422, 179.0426175105409, 135.61441751127003, 0.8696897388933799, 92.65294266601023, 42.03463844745369, 81.64391844857039, 177.26008594767617, 118.63383889935915, 143.07556173110683, 203.188022793714, 208.38982108735723, 323.7437678467252, 124.79770581005323, 33.08431462828497, 69.73601319045763, 181.87201959078584, 46.646669156392406, 165.2421271317047, 143.19133826943118, 40.86530446553435, 99.20406664735698, 99.0732781444708, 68.95801112667064, 221.9974884945163, 261.15129960702257, 156.3074185797433, 36.26436800291724, 186.39097969367253, 136.12470128722185, 58.47777740420441, 227.05351231800012, 51.10730479462084, 161.79172180386453, 28.319538343692937, 0.0, 248.43567224255892, 119.76843303124502, 49.321798481671294, 13.714282049770151, 155.46055012669572, 126.60038845068787, 150.92655366243721, 173.1312452254301, 286.07227487592814, 155.33138495458496, 169.8459009658292, 175.07852835499668, 37.546338151746035, 85.58671200641456, 31.013192004755506, 20.031404702281005, 66.97406064255675, 119.53045115212784, 211.43348026895907, 120.93567758360838, 190.18005988062453, 302.3653177792513, 116.59504682858808, 163.10488233079224, 28.809367007518016, 140.53931496942903, 182.39648481726306, 118.232763804809, 154.9054429300026, 26.121930588482638, 248.64070649709916, 209.03153101060343, 85.6969814395757, 86.57499178723576, 137.79594129557674, 68.04850506222611, 123.51307291721847, 123.35344764935859, 125.00817440738221, 99.62500850269089, 142.6334765753675, 204.06796235632007, 289.77947547600576, 107.87016617392014, 201.66135615651504, 191.72148102711876, 181.18455727009535, 62.74431167375446, 144.1897432817198, 159.66561762801916, 257.66831040828924, 381.3155178247563, 95.5723797786916, 112.89280193129254, 60.90384964647361, 58.90122372414592, 82.59537875639647, 135.91724497360187, 177.62049831093387, 74.77708319893921, 224.54589104869586, 128.50415645467186, 194.21772589936097, 212.57638359446966, 85.10100454773017, 13.880867630315425, 153.67731860764366, 109.35562163611709, 91.32988909424033, 116.20692834765313, 130.582761690092, 186.33189352451066, 197.74454177211402, 149.50793758493808, 198.0691855673684, 84.09915742835247, 189.86405661470704, 138.80683905341414, 147.46276918186163, 121.37357717836393, 37.23765859408802, 115.67650153696594, 143.56031351682802, 50.418247423100354, 196.08219175183243, 85.05507030837586, 124.94806520648727, 168.41255172899196, 33.62414134782071, 206.4132601216437, 93.9213218005911, 44.10927640317656, 255.02405610467198, 208.0415790599018, 94.92925502172348, 256.2291400731027, 2.917116342522665, 14.806799292055052, 258.4720589403126, 118.24817226741732, 80.29346764693905, 164.52457890225404, 54.80739048903497, 285.0664276082642, 149.31705894348084, 35.60873376246556, 166.97145301395187, 40.25469910374309, 132.48169544481985, 66.5095242496959, 142.45963407862558, 188.51410948349442, 162.7657799133149, 192.99538313814935, 22.871493839645147, 1.55576180486892, 5.808535390682379, 48.96931501798907, 111.89193877112018, 112.80776796895452]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.723439456871495, "mean_inference_ms": 4.112725969466385, "mean_action_processing_ms": 2.030663613847967, "mean_env_wait_ms": 10.3772448409159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03692793846130371, "StateBufferConnector_ms": 0.00418698787689209, "ViewRequirementAgentConnector_ms": 0.11897993087768555}, "num_episodes": 21, "episode_return_max": 287.05143790293164, "episode_return_min": 1.1011890377250426, "episode_return_mean": 128.20077165023645, "episodes_this_iter": 21}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.09931109350116, "num_env_steps_trained_throughput_per_sec": 85.09931109350116, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 47235.062, "restore_workers_time_ms": 0.016, "training_step_time_ms": 47234.955, "sample_time_ms": 2156.583, "learn_time_ms": 45057.037, "learn_throughput": 88.776, "synch_weights_time_ms": 17.591}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-43-24", "timestamp": 1724148804, "time_this_iter_s": 47.044179916381836, "time_total_s": 1372.1769030094147, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12007a3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1372.1769030094147, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 24.956060606060607, "ram_util_percent": 81.95303030303032}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.330543866611663, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.061321662468885, "policy_loss": -0.01837424630885599, "vf_loss": 7.077583249157699, "vf_explained_var": 0.25362102808775727, "kl": 0.010563328471182595, "entropy": 1.0323677882630988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 1023.4075000000012}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.328192140311791, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.279283078511556, "policy_loss": -0.012347173892828838, "vf_loss": 5.289747224913703, "vf_explained_var": 0.1385763425360281, "kl": 0.009415136637269624, "entropy": 1.0421985393478757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 1023.4075000000012}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 287.05143790293164, "episode_reward_min": 1.1011890377250426, "episode_reward_mean": 131.30881049701478, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -385.5886671720855, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 381.3155178247563}, "policy_reward_mean": {"prey_policy": -64.79207532165391, "predator_policy": 130.4464805701613}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.35540726375906, 93.01431244056991, 38.99012404963315, 73.96217176117923, 110.42531597004503, 54.461277706909335, 146.4575633911219, 91.53969792648239, 141.61406274804088, 222.13162657497162, 152.11658227923175, 208.2742084357522, 129.26920057957255, 59.412889632540505, 91.10602881989445, 90.14989609928209, 91.50680037933577, 67.42353733680791, 172.60141059549844, 96.20635606217894, 183.01608229756016, 173.45365886376405, 121.10460642329669, 103.16192316470352, 131.53650150417735, 105.05775254611962, 100.1999999999998, 44.652968276705614, 70.5144064490793, 26.36290158451729, 168.61742669680135, 116.5080605001809, 137.93622404141152, 212.82442260340954, 92.80000000000001, 131.44833636655738, 108.29625264051084, 60.74166670769996, 190.0888144404509, 143.29676588358416, 174.67791197352705, 135.89253583044194, 140.32759915283822, 52.49432297836987, 117.62891261353106, 134.23309991198687, 97.40845581612348, 210.9842624264662, 187.07391372989542, 112.75706088251991, 157.30339152132157, 83.89999999999992, 112.39868256032445, 50.900000000000276, 36.2000000000002, 69.1207817932328, 167.50510108194342, 100.94029034840472, 110.23114065781357, 287.05143790293164, 180.53544511615524, 265.7497922825642, 122.69431085565783, 147.3984855572551, 85.42544148914183, 1.1011890377250426, 77.85133698041967, 283.553638080206, 71.25084389692513, 185.49235725369928, 98.25205968125954, 253.5371626943457, 182.74976356120223, 61.69994614677914, 148.95476051190977, 222.09999999999923, 199.9484204709477, 145.9164633538886, 100.5178180459657, 171.4013858885409, 165.98590578284032, 228.54142562990103, 95.8454700492111, 192.67052609565928, 213.29999999999927, 60.75241975167914, 178.60034636148936, 128.4149911196237, 133.49999999999952, 129.9012916166803, 241.37146939379085, 195.797938014816, 91.90132316170612, 193.4218237776226, 107.64683990162337, 93.46185105984166, 156.5571598526577, 84.93219041339387, 175.64094668122036, 95.84036790812408], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-103.77901177573493, -292.1094179593251, -202.8659437016673, 12.750068424065208, -40.186026662923084, -287.64663565041616, -60.57643436729268, -223.04247346383025, -16.185203702277825, -95.31177196257553, -19.25163243980278, -264.80115352353636, 36.77509796308874, -195.14477975769339, -0.9957350679375665, -117.55138067796338, 44.86260904817923, -140.56388460426842, -217.60091671493956, 87.64553961492834, -111.00423670410345, 126.63671173317186, 90.53377024245131, -16.947142920163337, 7.784780298069387, -137.41958411474312, -168.30644282804394, -33.990068169881816, -113.988286063907, -206.48352899727004, -295.6437678467253, -62.747809710771236, 42.015685371715186, -53.32921281112193, 20.000000000000014, -181.0951514103707, -98.54173939927263, -37.29031540636486, 39.941051596645714, -83.80406664735777, 39.16758762368738, -24.182794597268035, -151.1310622974225, -158.56406694035232, -116.08105892425918, 44.61387876489539, -210.54392273294405, -8.809835083246824, -186.194076611346, 32.199288393319115, -18.098737921454966, -89.74253613091071, 11.37399986397791, 60.506461792329134, -298.39773982050235, -25.153397176596016, 12.987133550547773, -5.508807632910001, -144.14078710141777, -111.55724989144967, 10.133371650256477, -165.573743841322, -265.6129220728864, -59.2826772574458, -42.255483129855506, -164.73272214955932, 59.563008972896, 30.128363472353485, 7.218548353853604, 34.53685493911001, -34.337464302442804, -20.71871112568318, -180.7551537580066, -43.31775145404957, -208.5965126268292, -223.20719832534692, -92.88681554008711, 3.2757008211579333, -77.06802866667084, 51.01611257330801, -39.392847422125094, -86.55848922641934, -82.90085849657157, 37.76602080852843, -189.9238428797057, -127.42079547515883, -52.557168705082475, -67.2204815433596, -101.56450708738735, 13.34897334311583, -171.53895237273574, 58.90553171814532, -149.21698987032494, 21.99226277637578, -184.1978032409365, 48.48062673571497, 41.14518356921334, -251.72091148924366, 5.284125907894598, -285.90990220900795, -19.09643749024752, -67.52903993228028, -58.07130796634476, -161.88405294339418, -140.99647850063593, -385.5886671720855, -80.27237977869247, -77.29280193129286, -41.8038496464734, -41.80122372414567, -60.145624863951944, -89.24621707281436, -122.85419883546852, 37.961718407538754, -191.24979583131545, -60.85996132364737, -56.07414851846127, -240.48882031755625, 37.69134339915308, 150.37822232573194, -42.75706354071737, -39.74043158688749, 144.66496952262983, -86.45199468195902, -102.85280326761914, -91.36754109132583, 37.673634597986045, -237.52762839778353, 36.56794802412938, -233.31084953070868, -202.02645430664515, -125.54325232375143, -90.56516610764993, -100.41984327215715, 161.84827425695832, -31.20879630780638, -130.03236245735383, 7.3046454143500394, -139.21081138278942, 43.565906576280376, -1.230567194578363, -193.87799005964135, 147.7115204657909, -134.2117592409096, -27.834113763693722, 72.55327912112834, -220.34600800736405, -181.01968101043124, 19.425505490186538, -221.62914007310272, 200.0, 4.376084365422251, -275.82968562075246, 99.05787488397084, -193.03896748506122, 94.13738428975682, 38.1484709645742, -277.5044710159058, 63.84213776456551, -77.36654458197074, -145.30270506164646, 104.06245872679162, 110.70371261654134, -81.15350668115589, -101.63094211980919, -133.49733139310004, -181.95561333141552, 18.86497637561061, -4.871493839645112, 193.7442381951311, 37.74388436099655, -31.769315017988824, -174.35270392908325, 128.25334355049793, -183.48198270398933, -0.19219780838657705, -36.370305237843034, 58.54354126309236, 28.60672751087516, -68.80637192707431, 77.64621384689883, 45.36741015394812, 140.88069611035766, -141.19152362934213, -121.89150112270181, -55.25113343727119, -241.22771907958662, 148.98121853412738, -60.25697838008536, -5.749755717092961, -163.10861475711368, -195.32132249057938, -14.20056688941288, 44.62688581411214, -170.34035177146856, -46.49313977325496, 74.90889032704614, -6.688449784710894, -53.05411454602906, -135.7493967301907], "policy_predator_policy_reward": [154.76991755128745, 310.4739194475316, 154.27481675394367, 128.85537096422834, 233.1422008138656, 133.6805855491069, 125.33131171905819, 232.24976787324263, 75.35752056018643, 146.56477107471167, 202.49820336579003, 136.01586030445893, 157.80984955657416, 147.01739562915247, 77.48847450051295, 132.59833917187007, 196.7959649230167, 40.519373381113816, 173.0443861644422, 179.0426175105409, 135.61441751127003, 0.8696897388933799, 92.65294266601023, 42.03463844745369, 81.64391844857039, 177.26008594767617, 118.63383889935915, 143.07556173110683, 203.188022793714, 208.38982108735723, 323.7437678467252, 124.79770581005323, 33.08431462828497, 69.73601319045763, 181.87201959078584, 46.646669156392406, 165.2421271317047, 143.19133826943118, 40.86530446553435, 99.20406664735698, 99.0732781444708, 68.95801112667064, 221.9974884945163, 261.15129960702257, 156.3074185797433, 36.26436800291724, 186.39097969367253, 136.12470128722185, 58.47777740420441, 227.05351231800012, 51.10730479462084, 161.79172180386453, 28.319538343692937, 0.0, 248.43567224255892, 119.76843303124502, 49.321798481671294, 13.714282049770151, 155.46055012669572, 126.60038845068787, 150.92655366243721, 173.1312452254301, 286.07227487592814, 155.33138495458496, 169.8459009658292, 175.07852835499668, 37.546338151746035, 85.58671200641456, 31.013192004755506, 20.031404702281005, 66.97406064255675, 119.53045115212784, 211.43348026895907, 120.93567758360838, 190.18005988062453, 302.3653177792513, 116.59504682858808, 163.10488233079224, 28.809367007518016, 140.53931496942903, 182.39648481726306, 118.232763804809, 154.9054429300026, 26.121930588482638, 248.64070649709916, 209.03153101060343, 85.6969814395757, 86.57499178723576, 137.79594129557674, 68.04850506222611, 123.51307291721847, 123.35344764935859, 125.00817440738221, 99.62500850269089, 142.6334765753675, 204.06796235632007, 289.77947547600576, 107.87016617392014, 201.66135615651504, 191.72148102711876, 181.18455727009535, 62.74431167375446, 144.1897432817198, 159.66561762801916, 257.66831040828924, 381.3155178247563, 95.5723797786916, 112.89280193129254, 60.90384964647361, 58.90122372414592, 82.59537875639647, 135.91724497360187, 177.62049831093387, 74.77708319893921, 224.54589104869586, 128.50415645467186, 194.21772589936097, 212.57638359446966, 85.10100454773017, 13.880867630315425, 153.67731860764366, 109.35562163611709, 91.32988909424033, 116.20692834765313, 130.582761690092, 186.33189352451066, 197.74454177211402, 149.50793758493808, 198.0691855673684, 84.09915742835247, 189.86405661470704, 138.80683905341414, 147.46276918186163, 121.37357717836393, 37.23765859408802, 115.67650153696594, 143.56031351682802, 50.418247423100354, 196.08219175183243, 85.05507030837586, 124.94806520648727, 168.41255172899196, 33.62414134782071, 206.4132601216437, 93.9213218005911, 44.10927640317656, 255.02405610467198, 208.0415790599018, 94.92925502172348, 256.2291400731027, 2.917116342522665, 14.806799292055052, 258.4720589403126, 118.24817226741732, 80.29346764693905, 164.52457890225404, 54.80739048903497, 285.0664276082642, 149.31705894348084, 35.60873376246556, 166.97145301395187, 40.25469910374309, 132.48169544481985, 66.5095242496959, 142.45963407862558, 188.51410948349442, 162.7657799133149, 192.99538313814935, 22.871493839645147, 1.55576180486892, 5.808535390682379, 48.96931501798907, 111.89193877112018, 112.80776796895452, 208.23455671653736, 103.85461491546255, 110.36920944232142, 0.9575545324292857, 76.69327248912454, 93.40766354375413, 60.32525554689196, 58.03258984605194, 192.30623875721844, 3.802526776581905, 175.99148974279285, 93.05246797888589, 221.00752810238953, 64.66079622069222, 41.75952827333171, 131.89404572547062, 271.48176742046496, 180.4100208870698, 105.1178437491661, 21.012997178793547, 207.21039116568446, 94.55529079243318, 58.471497396880494, 48.94900874200521, 137.53986748995874, 147.10401169438595]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.705475989846994, "mean_inference_ms": 4.091272505516438, "mean_action_processing_ms": 1.9919513379636846, "mean_env_wait_ms": 10.36425465834729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0368504524230957, "StateBufferConnector_ms": 0.00423884391784668, "ViewRequirementAgentConnector_ms": 0.1295609474182129}, "num_episodes": 13, "episode_return_max": 287.05143790293164, "episode_return_min": 1.1011890377250426, "episode_return_mean": 131.30881049701478, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.17150625846914, "num_env_steps_trained_throughput_per_sec": 85.17150625846914, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 47236.386, "restore_workers_time_ms": 0.016, "training_step_time_ms": 47236.279, "sample_time_ms": 2162.163, "learn_time_ms": 45052.808, "learn_throughput": 88.785, "synch_weights_time_ms": 17.651}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-44-11", "timestamp": 1724148851, "time_this_iter_s": 46.97255611419678, "time_total_s": 1419.1494591236115, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120014d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1419.1494591236115, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 24.722388059701494, "ram_util_percent": 81.83283582089551}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.254707795602304, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.372361686999205, "policy_loss": -0.0184029077970615, "vf_loss": 7.388412005560738, "vf_explained_var": 0.2847213016931342, "kl": 0.011762859617980818, "entropy": 0.9887006240862387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.194238042200684, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.503747643112505, "policy_loss": -0.01468650414928715, "vf_loss": 5.516292296263276, "vf_explained_var": 0.11204824826074025, "kl": 0.010709328056318025, "entropy": 0.9713583334728524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 287.05143790293164, "episode_reward_min": -17.518060503526286, "episode_reward_mean": 129.67804131189962, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -385.5886671720855, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 381.3155178247563}, "policy_reward_mean": {"prey_policy": -58.625358957386695, "predator_policy": 123.46437961333653}, "custom_metrics": {}, "hist_stats": {"episode_reward": [121.10460642329669, 103.16192316470352, 131.53650150417735, 105.05775254611962, 100.1999999999998, 44.652968276705614, 70.5144064490793, 26.36290158451729, 168.61742669680135, 116.5080605001809, 137.93622404141152, 212.82442260340954, 92.80000000000001, 131.44833636655738, 108.29625264051084, 60.74166670769996, 190.0888144404509, 143.29676588358416, 174.67791197352705, 135.89253583044194, 140.32759915283822, 52.49432297836987, 117.62891261353106, 134.23309991198687, 97.40845581612348, 210.9842624264662, 187.07391372989542, 112.75706088251991, 157.30339152132157, 83.89999999999992, 112.39868256032445, 50.900000000000276, 36.2000000000002, 69.1207817932328, 167.50510108194342, 100.94029034840472, 110.23114065781357, 287.05143790293164, 180.53544511615524, 265.7497922825642, 122.69431085565783, 147.3984855572551, 85.42544148914183, 1.1011890377250426, 77.85133698041967, 283.553638080206, 71.25084389692513, 185.49235725369928, 98.25205968125954, 253.5371626943457, 182.74976356120223, 61.69994614677914, 148.95476051190977, 222.09999999999923, 199.9484204709477, 145.9164633538886, 100.5178180459657, 171.4013858885409, 165.98590578284032, 228.54142562990103, 95.8454700492111, 192.67052609565928, 213.29999999999927, 60.75241975167914, 178.60034636148936, 128.4149911196237, 133.49999999999952, 129.9012916166803, 241.37146939379085, 195.797938014816, 91.90132316170612, 193.4218237776226, 107.64683990162337, 93.46185105984166, 156.5571598526577, 84.93219041339387, 175.64094668122036, 95.84036790812408, 101.39462386118788, 119.79999999999919, 69.19999999999992, 193.5174549378977, 61.200000000000344, -17.518060503526286, 31.985866169458625, 182.06523347239565, 37.027965478531954, 46.60000000000031, 112.94743207487039, 185.69999999999925, 139.8305300116291, 75.30000000000035, 97.31811420726008, 170.06470450813444, 116.37208229401506, 90.4000000000002, 194.0888960021464, 117.20680896997501, 180.30325101996533, 88.60639019867408], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-116.08105892425918, 44.61387876489539, -210.54392273294405, -8.809835083246824, -186.194076611346, 32.199288393319115, -18.098737921454966, -89.74253613091071, 11.37399986397791, 60.506461792329134, -298.39773982050235, -25.153397176596016, 12.987133550547773, -5.508807632910001, -144.14078710141777, -111.55724989144967, 10.133371650256477, -165.573743841322, -265.6129220728864, -59.2826772574458, -42.255483129855506, -164.73272214955932, 59.563008972896, 30.128363472353485, 7.218548353853604, 34.53685493911001, -34.337464302442804, -20.71871112568318, -180.7551537580066, -43.31775145404957, -208.5965126268292, -223.20719832534692, -92.88681554008711, 3.2757008211579333, -77.06802866667084, 51.01611257330801, -39.392847422125094, -86.55848922641934, -82.90085849657157, 37.76602080852843, -189.9238428797057, -127.42079547515883, -52.557168705082475, -67.2204815433596, -101.56450708738735, 13.34897334311583, -171.53895237273574, 58.90553171814532, -149.21698987032494, 21.99226277637578, -184.1978032409365, 48.48062673571497, 41.14518356921334, -251.72091148924366, 5.284125907894598, -285.90990220900795, -19.09643749024752, -67.52903993228028, -58.07130796634476, -161.88405294339418, -140.99647850063593, -385.5886671720855, -80.27237977869247, -77.29280193129286, -41.8038496464734, -41.80122372414567, -60.145624863951944, -89.24621707281436, -122.85419883546852, 37.961718407538754, -191.24979583131545, -60.85996132364737, -56.07414851846127, -240.48882031755625, 37.69134339915308, 150.37822232573194, -42.75706354071737, -39.74043158688749, 144.66496952262983, -86.45199468195902, -102.85280326761914, -91.36754109132583, 37.673634597986045, -237.52762839778353, 36.56794802412938, -233.31084953070868, -202.02645430664515, -125.54325232375143, -90.56516610764993, -100.41984327215715, 161.84827425695832, -31.20879630780638, -130.03236245735383, 7.3046454143500394, -139.21081138278942, 43.565906576280376, -1.230567194578363, -193.87799005964135, 147.7115204657909, -134.2117592409096, -27.834113763693722, 72.55327912112834, -220.34600800736405, -181.01968101043124, 19.425505490186538, -221.62914007310272, 200.0, 4.376084365422251, -275.82968562075246, 99.05787488397084, -193.03896748506122, 94.13738428975682, 38.1484709645742, -277.5044710159058, 63.84213776456551, -77.36654458197074, -145.30270506164646, 104.06245872679162, 110.70371261654134, -81.15350668115589, -101.63094211980919, -133.49733139310004, -181.95561333141552, 18.86497637561061, -4.871493839645112, 193.7442381951311, 37.74388436099655, -31.769315017988824, -174.35270392908325, 128.25334355049793, -183.48198270398933, -0.19219780838657705, -36.370305237843034, 58.54354126309236, 28.60672751087516, -68.80637192707431, 77.64621384689883, 45.36741015394812, 140.88069611035766, -141.19152362934213, -121.89150112270181, -55.25113343727119, -241.22771907958662, 148.98121853412738, -60.25697838008536, -5.749755717092961, -163.10861475711368, -195.32132249057938, -14.20056688941288, 44.62688581411214, -170.34035177146856, -46.49313977325496, 74.90889032704614, -6.688449784710894, -53.05411454602906, -135.7493967301907, -193.3340771490657, -92.31907332983494, 43.74306855177962, -25.713175451925594, -56.42375416404937, -85.99557985720652, 37.389486675279606, -65.85238577747874, -76.63922770844299, -60.16804570912932, -196.80075100574032, -219.08627778425893, -102.26777846138845, -101.23405401011145, 85.17434333067362, -16.819908071773227, -37.619112270523665, -195.52553545779136, -51.871884423562534, 12.583148934340135, -90.60291915625581, 4.649306528457885, 4.610711704998287, 0.5683069316487466, 10.401866923107415, -60.6874059365948, 32.68210509719388, -8.645765042479944, -157.0402925060287, -87.62571937167246, 72.7668096126156, -57.70056832264462, -16.935106851538308, -105.0458262581902, -92.19147561325649, 61.644722768582525, -218.3977967026436, 41.064594418313746, -113.74940319288368, 31.458859084776535, -26.403073531281116, -56.19823288797503, -231.16246982120106, 30.69384113727979], "policy_predator_policy_reward": [156.3074185797433, 36.26436800291724, 186.39097969367253, 136.12470128722185, 58.47777740420441, 227.05351231800012, 51.10730479462084, 161.79172180386453, 28.319538343692937, 0.0, 248.43567224255892, 119.76843303124502, 49.321798481671294, 13.714282049770151, 155.46055012669572, 126.60038845068787, 150.92655366243721, 173.1312452254301, 286.07227487592814, 155.33138495458496, 169.8459009658292, 175.07852835499668, 37.546338151746035, 85.58671200641456, 31.013192004755506, 20.031404702281005, 66.97406064255675, 119.53045115212784, 211.43348026895907, 120.93567758360838, 190.18005988062453, 302.3653177792513, 116.59504682858808, 163.10488233079224, 28.809367007518016, 140.53931496942903, 182.39648481726306, 118.232763804809, 154.9054429300026, 26.121930588482638, 248.64070649709916, 209.03153101060343, 85.6969814395757, 86.57499178723576, 137.79594129557674, 68.04850506222611, 123.51307291721847, 123.35344764935859, 125.00817440738221, 99.62500850269089, 142.6334765753675, 204.06796235632007, 289.77947547600576, 107.87016617392014, 201.66135615651504, 191.72148102711876, 181.18455727009535, 62.74431167375446, 144.1897432817198, 159.66561762801916, 257.66831040828924, 381.3155178247563, 95.5723797786916, 112.89280193129254, 60.90384964647361, 58.90122372414592, 82.59537875639647, 135.91724497360187, 177.62049831093387, 74.77708319893921, 224.54589104869586, 128.50415645467186, 194.21772589936097, 212.57638359446966, 85.10100454773017, 13.880867630315425, 153.67731860764366, 109.35562163611709, 91.32988909424033, 116.20692834765313, 130.582761690092, 186.33189352451066, 197.74454177211402, 149.50793758493808, 198.0691855673684, 84.09915742835247, 189.86405661470704, 138.80683905341414, 147.46276918186163, 121.37357717836393, 37.23765859408802, 115.67650153696594, 143.56031351682802, 50.418247423100354, 196.08219175183243, 85.05507030837586, 124.94806520648727, 168.41255172899196, 33.62414134782071, 206.4132601216437, 93.9213218005911, 44.10927640317656, 255.02405610467198, 208.0415790599018, 94.92925502172348, 256.2291400731027, 2.917116342522665, 14.806799292055052, 258.4720589403126, 118.24817226741732, 80.29346764693905, 164.52457890225404, 54.80739048903497, 285.0664276082642, 149.31705894348084, 35.60873376246556, 166.97145301395187, 40.25469910374309, 132.48169544481985, 66.5095242496959, 142.45963407862558, 188.51410948349442, 162.7657799133149, 192.99538313814935, 22.871493839645147, 1.55576180486892, 5.808535390682379, 48.96931501798907, 111.89193877112018, 112.80776796895452, 208.23455671653736, 103.85461491546255, 110.36920944232142, 0.9575545324292857, 76.69327248912454, 93.40766354375413, 60.32525554689196, 58.03258984605194, 192.30623875721844, 3.802526776581905, 175.99148974279285, 93.05246797888589, 221.00752810238953, 64.66079622069222, 41.75952827333171, 131.89404572547062, 271.48176742046496, 180.4100208870698, 105.1178437491661, 21.012997178793547, 207.21039116568446, 94.55529079243318, 58.471497396880494, 48.94900874200521, 137.53986748995874, 147.10401169438595, 208.37703972961856, 178.6707346104696, 27.35024371179887, 74.41986318834735, 91.52375416404952, 120.0955798572065, 218.09812728020978, 3.882226759887211, 113.21968522788009, 84.787588189691, 161.0209287323506, 237.34803955412156, 103.00342792659072, 132.48427071436666, 29.234986306759197, 84.47581190673685, 13.73060389614255, 256.4420093107043, 78.9718844235627, 6.916851065659829, 138.17021135391613, 60.73083334875215, 171.75887297254326, 8.762108390809763, 140.08047393660837, 50.03559508850833, 24.417894902806115, 26.84576504248007, 138.86877539660975, 203.1153506883514, 59.87326130022345, 95.12520191794023, 53.26535569654331, 185.08765970720074, 106.29147561325568, 14.655277231417474, 243.74733908667076, 127.67475919980538, 152.54372348170475, 46.9536295963783, 191.397577162655, 71.50698027656718, 135.60459107151758, 153.47042781107743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.642059866283135, "mean_inference_ms": 4.054477359121971, "mean_action_processing_ms": 1.9510751787257643, "mean_env_wait_ms": 10.347902845284773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035415053367614746, "StateBufferConnector_ms": 0.010961174964904785, "ViewRequirementAgentConnector_ms": 0.11365628242492676}, "num_episodes": 22, "episode_return_max": 287.05143790293164, "episode_return_min": -17.518060503526286, "episode_return_mean": 129.67804131189962, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.39601634401356, "num_env_steps_trained_throughput_per_sec": 84.39601634401356, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 47198.696, "restore_workers_time_ms": 0.017, "training_step_time_ms": 47198.591, "sample_time_ms": 2110.23, "learn_time_ms": 45067.458, "learn_throughput": 88.756, "synch_weights_time_ms": 17.543}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-44-59", "timestamp": 1724148899, "time_this_iter_s": 47.449020862579346, "time_total_s": 1466.5984799861908, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33132b5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1466.5984799861908, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 25.12089552238806, "ram_util_percent": 80.94477611940299}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.714845199433583, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.689816077802547, "policy_loss": -0.018352967806569444, "vf_loss": 7.70585448300397, "vf_explained_var": 0.36997119320763483, "kl": 0.011572760046661768, "entropy": 0.9664812479069624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.039485305579251, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.676144652139573, "policy_loss": -0.01407504170669844, "vf_loss": 5.6881290397946795, "vf_explained_var": 0.1465248580647524, "kl": 0.010453282500291983, "entropy": 0.9060760778409463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 306.464465394239, "episode_reward_min": -17.518060503526286, "episode_reward_mean": 135.9742096636952, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -385.5886671720855, "predator_policy": 0.9575545324292857}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 381.3155178247563}, "policy_reward_mean": {"prey_policy": -53.58481453129672, "predator_policy": 121.57191936314437}, "custom_metrics": {}, "hist_stats": {"episode_reward": [97.40845581612348, 210.9842624264662, 187.07391372989542, 112.75706088251991, 157.30339152132157, 83.89999999999992, 112.39868256032445, 50.900000000000276, 36.2000000000002, 69.1207817932328, 167.50510108194342, 100.94029034840472, 110.23114065781357, 287.05143790293164, 180.53544511615524, 265.7497922825642, 122.69431085565783, 147.3984855572551, 85.42544148914183, 1.1011890377250426, 77.85133698041967, 283.553638080206, 71.25084389692513, 185.49235725369928, 98.25205968125954, 253.5371626943457, 182.74976356120223, 61.69994614677914, 148.95476051190977, 222.09999999999923, 199.9484204709477, 145.9164633538886, 100.5178180459657, 171.4013858885409, 165.98590578284032, 228.54142562990103, 95.8454700492111, 192.67052609565928, 213.29999999999927, 60.75241975167914, 178.60034636148936, 128.4149911196237, 133.49999999999952, 129.9012916166803, 241.37146939379085, 195.797938014816, 91.90132316170612, 193.4218237776226, 107.64683990162337, 93.46185105984166, 156.5571598526577, 84.93219041339387, 175.64094668122036, 95.84036790812408, 101.39462386118788, 119.79999999999919, 69.19999999999992, 193.5174549378977, 61.200000000000344, -17.518060503526286, 31.985866169458625, 182.06523347239565, 37.027965478531954, 46.60000000000031, 112.94743207487039, 185.69999999999925, 139.8305300116291, 75.30000000000035, 97.31811420726008, 170.06470450813444, 116.37208229401506, 90.4000000000002, 194.0888960021464, 117.20680896997501, 180.30325101996533, 88.60639019867408, 73.81886592170032, 194.8725530157226, 113.36239394829582, 122.6027561362294, 134.02983573840464, 222.62175416531187, 89.92164742000912, 218.66357802107083, 144.2999999999996, 102.09547350353408, 183.07249852407836, 209.2591203631055, 123.0999999999988, 61.203577604387235, 90.3624320658121, 201.01805418213092, 82.13437781675182, 190.89909149077872, 15.696090967255065, 170.51966186857598, 306.464465394239, 90.06761181576101, 166.3762868575664, 143.55812064874132], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-149.21698987032494, 21.99226277637578, -184.1978032409365, 48.48062673571497, 41.14518356921334, -251.72091148924366, 5.284125907894598, -285.90990220900795, -19.09643749024752, -67.52903993228028, -58.07130796634476, -161.88405294339418, -140.99647850063593, -385.5886671720855, -80.27237977869247, -77.29280193129286, -41.8038496464734, -41.80122372414567, -60.145624863951944, -89.24621707281436, -122.85419883546852, 37.961718407538754, -191.24979583131545, -60.85996132364737, -56.07414851846127, -240.48882031755625, 37.69134339915308, 150.37822232573194, -42.75706354071737, -39.74043158688749, 144.66496952262983, -86.45199468195902, -102.85280326761914, -91.36754109132583, 37.673634597986045, -237.52762839778353, 36.56794802412938, -233.31084953070868, -202.02645430664515, -125.54325232375143, -90.56516610764993, -100.41984327215715, 161.84827425695832, -31.20879630780638, -130.03236245735383, 7.3046454143500394, -139.21081138278942, 43.565906576280376, -1.230567194578363, -193.87799005964135, 147.7115204657909, -134.2117592409096, -27.834113763693722, 72.55327912112834, -220.34600800736405, -181.01968101043124, 19.425505490186538, -221.62914007310272, 200.0, 4.376084365422251, -275.82968562075246, 99.05787488397084, -193.03896748506122, 94.13738428975682, 38.1484709645742, -277.5044710159058, 63.84213776456551, -77.36654458197074, -145.30270506164646, 104.06245872679162, 110.70371261654134, -81.15350668115589, -101.63094211980919, -133.49733139310004, -181.95561333141552, 18.86497637561061, -4.871493839645112, 193.7442381951311, 37.74388436099655, -31.769315017988824, -174.35270392908325, 128.25334355049793, -183.48198270398933, -0.19219780838657705, -36.370305237843034, 58.54354126309236, 28.60672751087516, -68.80637192707431, 77.64621384689883, 45.36741015394812, 140.88069611035766, -141.19152362934213, -121.89150112270181, -55.25113343727119, -241.22771907958662, 148.98121853412738, -60.25697838008536, -5.749755717092961, -163.10861475711368, -195.32132249057938, -14.20056688941288, 44.62688581411214, -170.34035177146856, -46.49313977325496, 74.90889032704614, -6.688449784710894, -53.05411454602906, -135.7493967301907, -193.3340771490657, -92.31907332983494, 43.74306855177962, -25.713175451925594, -56.42375416404937, -85.99557985720652, 37.389486675279606, -65.85238577747874, -76.63922770844299, -60.16804570912932, -196.80075100574032, -219.08627778425893, -102.26777846138845, -101.23405401011145, 85.17434333067362, -16.819908071773227, -37.619112270523665, -195.52553545779136, -51.871884423562534, 12.583148934340135, -90.60291915625581, 4.649306528457885, 4.610711704998287, 0.5683069316487466, 10.401866923107415, -60.6874059365948, 32.68210509719388, -8.645765042479944, -157.0402925060287, -87.62571937167246, 72.7668096126156, -57.70056832264462, -16.935106851538308, -105.0458262581902, -92.19147561325649, 61.644722768582525, -218.3977967026436, 41.064594418313746, -113.74940319288368, 31.458859084776535, -26.403073531281116, -56.19823288797503, -231.16246982120106, 30.69384113727979, -25.93566868949167, -212.44813468196833, -97.2577624169456, 3.890515019145596, -111.20280839079041, -9.388287528481074, -0.6635516682915963, -19.037548109876994, 21.401631438400486, -80.82737986840374, 99.39838880693435, -125.94147654643405, 10.134356638660448, -12.626838994528994, 40.67053500992758, 1.6997108941662007, -10.465595048385321, 82.8352906941802, -66.21270604396133, -151.48286339488726, 120.09816879733268, -127.59280671147752, 105.3177282562151, -145.77779252665246, 89.08065356832917, -1.2110136647191183, -129.12192242650403, -200.44994500996927, -35.41834519955148, -130.03034837941374, -187.30147662071133, 121.45348491089219, -220.427162894648, -18.691479711502524, 33.97570867449334, 58.856013393538454, -250.9937687151157, -316.47547113893705, -89.72143625478543, 64.3983360631774, 32.43669900332509, 80.60371885637375, 19.230763920790828, -212.9089371297996, -94.44811335440265, 22.394426163157664, -60.710981776176645, -99.07364946220744], "policy_predator_policy_reward": [125.00817440738221, 99.62500850269089, 142.6334765753675, 204.06796235632007, 289.77947547600576, 107.87016617392014, 201.66135615651504, 191.72148102711876, 181.18455727009535, 62.74431167375446, 144.1897432817198, 159.66561762801916, 257.66831040828924, 381.3155178247563, 95.5723797786916, 112.89280193129254, 60.90384964647361, 58.90122372414592, 82.59537875639647, 135.91724497360187, 177.62049831093387, 74.77708319893921, 224.54589104869586, 128.50415645467186, 194.21772589936097, 212.57638359446966, 85.10100454773017, 13.880867630315425, 153.67731860764366, 109.35562163611709, 91.32988909424033, 116.20692834765313, 130.582761690092, 186.33189352451066, 197.74454177211402, 149.50793758493808, 198.0691855673684, 84.09915742835247, 189.86405661470704, 138.80683905341414, 147.46276918186163, 121.37357717836393, 37.23765859408802, 115.67650153696594, 143.56031351682802, 50.418247423100354, 196.08219175183243, 85.05507030837586, 124.94806520648727, 168.41255172899196, 33.62414134782071, 206.4132601216437, 93.9213218005911, 44.10927640317656, 255.02405610467198, 208.0415790599018, 94.92925502172348, 256.2291400731027, 2.917116342522665, 14.806799292055052, 258.4720589403126, 118.24817226741732, 80.29346764693905, 164.52457890225404, 54.80739048903497, 285.0664276082642, 149.31705894348084, 35.60873376246556, 166.97145301395187, 40.25469910374309, 132.48169544481985, 66.5095242496959, 142.45963407862558, 188.51410948349442, 162.7657799133149, 192.99538313814935, 22.871493839645147, 1.55576180486892, 5.808535390682379, 48.96931501798907, 111.89193877112018, 112.80776796895452, 208.23455671653736, 103.85461491546255, 110.36920944232142, 0.9575545324292857, 76.69327248912454, 93.40766354375413, 60.32525554689196, 58.03258984605194, 192.30623875721844, 3.802526776581905, 175.99148974279285, 93.05246797888589, 221.00752810238953, 64.66079622069222, 41.75952827333171, 131.89404572547062, 271.48176742046496, 180.4100208870698, 105.1178437491661, 21.012997178793547, 207.21039116568446, 94.55529079243318, 58.471497396880494, 48.94900874200521, 137.53986748995874, 147.10401169438595, 208.37703972961856, 178.6707346104696, 27.35024371179887, 74.41986318834735, 91.52375416404952, 120.0955798572065, 218.09812728020978, 3.882226759887211, 113.21968522788009, 84.787588189691, 161.0209287323506, 237.34803955412156, 103.00342792659072, 132.48427071436666, 29.234986306759197, 84.47581190673685, 13.73060389614255, 256.4420093107043, 78.9718844235627, 6.916851065659829, 138.17021135391613, 60.73083334875215, 171.75887297254326, 8.762108390809763, 140.08047393660837, 50.03559508850833, 24.417894902806115, 26.84576504248007, 138.86877539660975, 203.1153506883514, 59.87326130022345, 95.12520191794023, 53.26535569654331, 185.08765970720074, 106.29147561325568, 14.655277231417474, 243.74733908667076, 127.67475919980538, 152.54372348170475, 46.9536295963783, 191.397577162655, 71.50698027656718, 135.60459107151758, 153.47042781107743, 90.08653127398817, 222.11613801917164, 137.2668024051614, 150.9729980083614, 114.07854772749192, 119.87494214007543, 128.8407925930767, 13.463063321321995, 102.07860047026443, 91.3769836981444, 140.56346475676966, 108.60137714804192, 57.12483824850284, 35.289291527374786, 90.77264235048602, 85.5206897664912, 27.965595048385463, 43.96470930581986, 157.96090660343776, 161.83013633894376, 80.92150447783585, 109.64563196038736, 142.7522248327282, 106.96695980081469, 4.18208514989022, 31.048274946499195, 206.19738803002056, 184.57805701083902, 91.6847951795257, 164.12633046525133, 228.13331532385024, 38.732730568099804, 235.5184254094667, 85.73459501343645, 34.71711641039083, 63.350253012356454, 261.0898596823707, 322.0754711389376, 154.60500169152263, 41.23776036866141, 84.02642450866962, 109.39762302587025, 200.02278744131044, 83.72299758345963, 45.7953471746531, 192.6346268741581, 134.3107324134614, 169.0320194736642]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.595257380583771, "mean_inference_ms": 4.01394622743629, "mean_action_processing_ms": 1.9130762299912354, "mean_env_wait_ms": 10.323875792816322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026051044464111328, "StateBufferConnector_ms": 0.010799527168273926, "ViewRequirementAgentConnector_ms": 0.11362063884735107}, "num_episodes": 24, "episode_return_max": 306.464465394239, "episode_return_min": -17.518060503526286, "episode_return_mean": 135.9742096636952, "episodes_this_iter": 24}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.4987845793591, "num_env_steps_trained_throughput_per_sec": 85.4987845793591, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 47123.52, "restore_workers_time_ms": 0.017, "training_step_time_ms": 47123.417, "sample_time_ms": 2083.685, "learn_time_ms": 45024.117, "learn_throughput": 88.841, "synch_weights_time_ms": 12.738}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-45-46", "timestamp": 1724148946, "time_this_iter_s": 46.79397511482239, "time_total_s": 1513.3924551010132, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120014940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1513.3924551010132, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 25.26060606060606, "ram_util_percent": 81.88030303030305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.494950475453068, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.717072408918351, "policy_loss": -0.018197339140100494, "vf_loss": 7.732832276631916, "vf_explained_var": 0.21356889006322022, "kl": 0.01218738624057363, "entropy": 0.9074353792680003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.6775693475254, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.1487067643927515, "policy_loss": -0.013871691323861126, "vf_loss": 6.160452840694044, "vf_explained_var": 0.1595647757646268, "kl": 0.010628080936690803, "entropy": 0.8704393792720068, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 306.464465394239, "episode_reward_min": -17.518060503526286, "episode_reward_mean": 135.66462291911282, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -350.08767368602497, "predator_policy": 0.9575545324292857}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 322.0754711389376}, "policy_reward_mean": {"prey_policy": -47.9003015721468, "predator_policy": 115.73261303170325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.85133698041967, 283.553638080206, 71.25084389692513, 185.49235725369928, 98.25205968125954, 253.5371626943457, 182.74976356120223, 61.69994614677914, 148.95476051190977, 222.09999999999923, 199.9484204709477, 145.9164633538886, 100.5178180459657, 171.4013858885409, 165.98590578284032, 228.54142562990103, 95.8454700492111, 192.67052609565928, 213.29999999999927, 60.75241975167914, 178.60034636148936, 128.4149911196237, 133.49999999999952, 129.9012916166803, 241.37146939379085, 195.797938014816, 91.90132316170612, 193.4218237776226, 107.64683990162337, 93.46185105984166, 156.5571598526577, 84.93219041339387, 175.64094668122036, 95.84036790812408, 101.39462386118788, 119.79999999999919, 69.19999999999992, 193.5174549378977, 61.200000000000344, -17.518060503526286, 31.985866169458625, 182.06523347239565, 37.027965478531954, 46.60000000000031, 112.94743207487039, 185.69999999999925, 139.8305300116291, 75.30000000000035, 97.31811420726008, 170.06470450813444, 116.37208229401506, 90.4000000000002, 194.0888960021464, 117.20680896997501, 180.30325101996533, 88.60639019867408, 73.81886592170032, 194.8725530157226, 113.36239394829582, 122.6027561362294, 134.02983573840464, 222.62175416531187, 89.92164742000912, 218.66357802107083, 144.2999999999996, 102.09547350353408, 183.07249852407836, 209.2591203631055, 123.0999999999988, 61.203577604387235, 90.3624320658121, 201.01805418213092, 82.13437781675182, 190.89909149077872, 15.696090967255065, 170.51966186857598, 306.464465394239, 90.06761181576101, 166.3762868575664, 143.55812064874132, 92.2078213887625, 49.38202444415147, 97.89143178032121, 53.000000000000334, 220.00754851635486, 102.64344943831411, 27.226077401467897, 122.75443379068737, 100.49999999999916, 128.02854119202613, 300.9696913692951, 163.5999999999996, 222.5852481254908, 88.8126014188003, 189.7564189705744, 124.16646504615579, 59.914590432248545, 150.47213526363947, 108.43125469208002, 153.3707753308705], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-90.56516610764993, -100.41984327215715, 161.84827425695832, -31.20879630780638, -130.03236245735383, 7.3046454143500394, -139.21081138278942, 43.565906576280376, -1.230567194578363, -193.87799005964135, 147.7115204657909, -134.2117592409096, -27.834113763693722, 72.55327912112834, -220.34600800736405, -181.01968101043124, 19.425505490186538, -221.62914007310272, 200.0, 4.376084365422251, -275.82968562075246, 99.05787488397084, -193.03896748506122, 94.13738428975682, 38.1484709645742, -277.5044710159058, 63.84213776456551, -77.36654458197074, -145.30270506164646, 104.06245872679162, 110.70371261654134, -81.15350668115589, -101.63094211980919, -133.49733139310004, -181.95561333141552, 18.86497637561061, -4.871493839645112, 193.7442381951311, 37.74388436099655, -31.769315017988824, -174.35270392908325, 128.25334355049793, -183.48198270398933, -0.19219780838657705, -36.370305237843034, 58.54354126309236, 28.60672751087516, -68.80637192707431, 77.64621384689883, 45.36741015394812, 140.88069611035766, -141.19152362934213, -121.89150112270181, -55.25113343727119, -241.22771907958662, 148.98121853412738, -60.25697838008536, -5.749755717092961, -163.10861475711368, -195.32132249057938, -14.20056688941288, 44.62688581411214, -170.34035177146856, -46.49313977325496, 74.90889032704614, -6.688449784710894, -53.05411454602906, -135.7493967301907, -193.3340771490657, -92.31907332983494, 43.74306855177962, -25.713175451925594, -56.42375416404937, -85.99557985720652, 37.389486675279606, -65.85238577747874, -76.63922770844299, -60.16804570912932, -196.80075100574032, -219.08627778425893, -102.26777846138845, -101.23405401011145, 85.17434333067362, -16.819908071773227, -37.619112270523665, -195.52553545779136, -51.871884423562534, 12.583148934340135, -90.60291915625581, 4.649306528457885, 4.610711704998287, 0.5683069316487466, 10.401866923107415, -60.6874059365948, 32.68210509719388, -8.645765042479944, -157.0402925060287, -87.62571937167246, 72.7668096126156, -57.70056832264462, -16.935106851538308, -105.0458262581902, -92.19147561325649, 61.644722768582525, -218.3977967026436, 41.064594418313746, -113.74940319288368, 31.458859084776535, -26.403073531281116, -56.19823288797503, -231.16246982120106, 30.69384113727979, -25.93566868949167, -212.44813468196833, -97.2577624169456, 3.890515019145596, -111.20280839079041, -9.388287528481074, -0.6635516682915963, -19.037548109876994, 21.401631438400486, -80.82737986840374, 99.39838880693435, -125.94147654643405, 10.134356638660448, -12.626838994528994, 40.67053500992758, 1.6997108941662007, -10.465595048385321, 82.8352906941802, -66.21270604396133, -151.48286339488726, 120.09816879733268, -127.59280671147752, 105.3177282562151, -145.77779252665246, 89.08065356832917, -1.2110136647191183, -129.12192242650403, -200.44994500996927, -35.41834519955148, -130.03034837941374, -187.30147662071133, 121.45348491089219, -220.427162894648, -18.691479711502524, 33.97570867449334, 58.856013393538454, -250.9937687151157, -316.47547113893705, -89.72143625478543, 64.3983360631774, 32.43669900332509, 80.60371885637375, 19.230763920790828, -212.9089371297996, -94.44811335440265, 22.394426163157664, -60.710981776176645, -99.07364946220744, -137.8767808518188, -25.137023005651344, -54.212297184337594, -228.60090349857143, -350.08767368602497, 2.4524251751290316, -56.76279874711395, -34.374060304175195, 41.05723083208907, 64.81771757631117, -46.9881888573281, -210.14082504965626, -208.26799442782104, -82.54319208992376, -150.98628277312358, 12.88671277894917, -72.6986977958842, -6.2809985167526925, -149.7138771115403, -8.948517626806506, 15.37423458925261, 41.79624078127566, -15.366963025774902, 88.20200375407588, -59.9664998169021, 151.4851751851101, 5.7214614287085555, -245.9336976007131, 113.45455209567974, -221.89123862565435, -124.75265358265497, -22.36902871981782, -229.30995257672686, -33.104440298198114, -8.471508657169338, -26.535882947469695, 53.04102666271091, -56.07417450416695, -37.84568750334, 85.81705423646075], "policy_predator_policy_reward": [147.46276918186163, 121.37357717836393, 37.23765859408802, 115.67650153696594, 143.56031351682802, 50.418247423100354, 196.08219175183243, 85.05507030837586, 124.94806520648727, 168.41255172899196, 33.62414134782071, 206.4132601216437, 93.9213218005911, 44.10927640317656, 255.02405610467198, 208.0415790599018, 94.92925502172348, 256.2291400731027, 2.917116342522665, 14.806799292055052, 258.4720589403126, 118.24817226741732, 80.29346764693905, 164.52457890225404, 54.80739048903497, 285.0664276082642, 149.31705894348084, 35.60873376246556, 166.97145301395187, 40.25469910374309, 132.48169544481985, 66.5095242496959, 142.45963407862558, 188.51410948349442, 162.7657799133149, 192.99538313814935, 22.871493839645147, 1.55576180486892, 5.808535390682379, 48.96931501798907, 111.89193877112018, 112.80776796895452, 208.23455671653736, 103.85461491546255, 110.36920944232142, 0.9575545324292857, 76.69327248912454, 93.40766354375413, 60.32525554689196, 58.03258984605194, 192.30623875721844, 3.802526776581905, 175.99148974279285, 93.05246797888589, 221.00752810238953, 64.66079622069222, 41.75952827333171, 131.89404572547062, 271.48176742046496, 180.4100208870698, 105.1178437491661, 21.012997178793547, 207.21039116568446, 94.55529079243318, 58.471497396880494, 48.94900874200521, 137.53986748995874, 147.10401169438595, 208.37703972961856, 178.6707346104696, 27.35024371179887, 74.41986318834735, 91.52375416404952, 120.0955798572065, 218.09812728020978, 3.882226759887211, 113.21968522788009, 84.787588189691, 161.0209287323506, 237.34803955412156, 103.00342792659072, 132.48427071436666, 29.234986306759197, 84.47581190673685, 13.73060389614255, 256.4420093107043, 78.9718844235627, 6.916851065659829, 138.17021135391613, 60.73083334875215, 171.75887297254326, 8.762108390809763, 140.08047393660837, 50.03559508850833, 24.417894902806115, 26.84576504248007, 138.86877539660975, 203.1153506883514, 59.87326130022345, 95.12520191794023, 53.26535569654331, 185.08765970720074, 106.29147561325568, 14.655277231417474, 243.74733908667076, 127.67475919980538, 152.54372348170475, 46.9536295963783, 191.397577162655, 71.50698027656718, 135.60459107151758, 153.47042781107743, 90.08653127398817, 222.11613801917164, 137.2668024051614, 150.9729980083614, 114.07854772749192, 119.87494214007543, 128.8407925930767, 13.463063321321995, 102.07860047026443, 91.3769836981444, 140.56346475676966, 108.60137714804192, 57.12483824850284, 35.289291527374786, 90.77264235048602, 85.5206897664912, 27.965595048385463, 43.96470930581986, 157.96090660343776, 161.83013633894376, 80.92150447783585, 109.64563196038736, 142.7522248327282, 106.96695980081469, 4.18208514989022, 31.048274946499195, 206.19738803002056, 184.57805701083902, 91.6847951795257, 164.12633046525133, 228.13331532385024, 38.732730568099804, 235.5184254094667, 85.73459501343645, 34.71711641039083, 63.350253012356454, 261.0898596823707, 322.0754711389376, 154.60500169152263, 41.23776036866141, 84.02642450866962, 109.39762302587025, 200.02278744131044, 83.72299758345963, 45.7953471746531, 192.6346268741581, 134.3107324134614, 169.0320194736642, 64.74992344292932, 190.47170180330306, 145.01326898279072, 187.18195614426946, 233.69936344565866, 211.827316845559, 93.76279874711406, 50.37406030417542, 58.675544305669995, 55.457055802285, 163.31091289570767, 196.46155044959016, 100.33751472877391, 217.69974919043878, 146.05390956440408, 114.80009422045802, 112.27561967545523, 67.20407663718129, 120.32990713650167, 166.36102879387164, 101.57949178892228, 142.21972420984466, 36.66696302577511, 54.09799624592414, 85.4346745137403, 45.63189824354237, 195.3571848065622, 133.6676527842429, 115.21573884048979, 182.97736666005915, 119.50855738776659, 151.77958996086224, 135.9314579220163, 186.39752538515708, 111.57150865716913, 73.9080182111097, 39.190228029369315, 72.27417450416667, 50.12133547396988, 55.27807312377978]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5278109920019745, "mean_inference_ms": 3.987709178486166, "mean_action_processing_ms": 1.8969936703457215, "mean_env_wait_ms": 10.302671126069207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025660276412963867, "StateBufferConnector_ms": 0.010730624198913574, "ViewRequirementAgentConnector_ms": 0.13465261459350586}, "num_episodes": 20, "episode_return_max": 306.464465394239, "episode_return_min": -17.518060503526286, "episode_return_mean": 135.66462291911282, "episodes_this_iter": 20}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.36373478551067, "num_env_steps_trained_throughput_per_sec": 85.36373478551067, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 47060.156, "restore_workers_time_ms": 0.016, "training_step_time_ms": 47060.055, "sample_time_ms": 2077.079, "learn_time_ms": 44967.617, "learn_throughput": 88.953, "synch_weights_time_ms": 12.533}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-46-33", "timestamp": 1724148993, "time_this_iter_s": 46.90219306945801, "time_total_s": 1560.2946481704712, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12002d4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1560.2946481704712, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 24.42121212121212, "ram_util_percent": 81.18181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.1215610814473, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.55843314872217, "policy_loss": -0.02231228576958298, "vf_loss": 7.578289366020727, "vf_explained_var": 0.3651580005095749, "kl": 0.01228029691126375, "entropy": 0.922382724222052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.057965871581325, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.592144856881843, "policy_loss": -0.015557673036381996, "vf_loss": 5.605463477038833, "vf_explained_var": 0.14039346231985345, "kl": 0.011195231819766815, "entropy": 0.9121655091406807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 319.10031530253775, "episode_reward_min": -17.518060503526286, "episode_reward_mean": 128.47342851814037, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -350.08767368602497, "predator_policy": 0.9575545324292857}, "policy_reward_max": {"prey_policy": 151.4851751851101, "predator_policy": 322.0754711389376}, "policy_reward_mean": {"prey_policy": -53.983194530459734, "predator_policy": 118.21990878952997}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.75241975167914, 178.60034636148936, 128.4149911196237, 133.49999999999952, 129.9012916166803, 241.37146939379085, 195.797938014816, 91.90132316170612, 193.4218237776226, 107.64683990162337, 93.46185105984166, 156.5571598526577, 84.93219041339387, 175.64094668122036, 95.84036790812408, 101.39462386118788, 119.79999999999919, 69.19999999999992, 193.5174549378977, 61.200000000000344, -17.518060503526286, 31.985866169458625, 182.06523347239565, 37.027965478531954, 46.60000000000031, 112.94743207487039, 185.69999999999925, 139.8305300116291, 75.30000000000035, 97.31811420726008, 170.06470450813444, 116.37208229401506, 90.4000000000002, 194.0888960021464, 117.20680896997501, 180.30325101996533, 88.60639019867408, 73.81886592170032, 194.8725530157226, 113.36239394829582, 122.6027561362294, 134.02983573840464, 222.62175416531187, 89.92164742000912, 218.66357802107083, 144.2999999999996, 102.09547350353408, 183.07249852407836, 209.2591203631055, 123.0999999999988, 61.203577604387235, 90.3624320658121, 201.01805418213092, 82.13437781675182, 190.89909149077872, 15.696090967255065, 170.51966186857598, 306.464465394239, 90.06761181576101, 166.3762868575664, 143.55812064874132, 92.2078213887625, 49.38202444415147, 97.89143178032121, 53.000000000000334, 220.00754851635486, 102.64344943831411, 27.226077401467897, 122.75443379068737, 100.49999999999916, 128.02854119202613, 300.9696913692951, 163.5999999999996, 222.5852481254908, 88.8126014188003, 189.7564189705744, 124.16646504615579, 59.914590432248545, 150.47213526363947, 108.43125469208002, 153.3707753308705, 41.429834659351066, 181.81139266123967, 196.57464309066393, 119.66862324237005, 20.959265754866493, 58.18840621010745, 186.18548768596372, 89.59999999999971, 114.87944737207201, 65.18393414299467, 145.21682883965155, 134.96618962483035, 177.76936742044177, 75.1585951658879, 319.10031530253775, 95.80095329922808, 38.641077917412396, 168.11907117364822, 151.19641046318654], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [37.74388436099655, -31.769315017988824, -174.35270392908325, 128.25334355049793, -183.48198270398933, -0.19219780838657705, -36.370305237843034, 58.54354126309236, 28.60672751087516, -68.80637192707431, 77.64621384689883, 45.36741015394812, 140.88069611035766, -141.19152362934213, -121.89150112270181, -55.25113343727119, -241.22771907958662, 148.98121853412738, -60.25697838008536, -5.749755717092961, -163.10861475711368, -195.32132249057938, -14.20056688941288, 44.62688581411214, -170.34035177146856, -46.49313977325496, 74.90889032704614, -6.688449784710894, -53.05411454602906, -135.7493967301907, -193.3340771490657, -92.31907332983494, 43.74306855177962, -25.713175451925594, -56.42375416404937, -85.99557985720652, 37.389486675279606, -65.85238577747874, -76.63922770844299, -60.16804570912932, -196.80075100574032, -219.08627778425893, -102.26777846138845, -101.23405401011145, 85.17434333067362, -16.819908071773227, -37.619112270523665, -195.52553545779136, -51.871884423562534, 12.583148934340135, -90.60291915625581, 4.649306528457885, 4.610711704998287, 0.5683069316487466, 10.401866923107415, -60.6874059365948, 32.68210509719388, -8.645765042479944, -157.0402925060287, -87.62571937167246, 72.7668096126156, -57.70056832264462, -16.935106851538308, -105.0458262581902, -92.19147561325649, 61.644722768582525, -218.3977967026436, 41.064594418313746, -113.74940319288368, 31.458859084776535, -26.403073531281116, -56.19823288797503, -231.16246982120106, 30.69384113727979, -25.93566868949167, -212.44813468196833, -97.2577624169456, 3.890515019145596, -111.20280839079041, -9.388287528481074, -0.6635516682915963, -19.037548109876994, 21.401631438400486, -80.82737986840374, 99.39838880693435, -125.94147654643405, 10.134356638660448, -12.626838994528994, 40.67053500992758, 1.6997108941662007, -10.465595048385321, 82.8352906941802, -66.21270604396133, -151.48286339488726, 120.09816879733268, -127.59280671147752, 105.3177282562151, -145.77779252665246, 89.08065356832917, -1.2110136647191183, -129.12192242650403, -200.44994500996927, -35.41834519955148, -130.03034837941374, -187.30147662071133, 121.45348491089219, -220.427162894648, -18.691479711502524, 33.97570867449334, 58.856013393538454, -250.9937687151157, -316.47547113893705, -89.72143625478543, 64.3983360631774, 32.43669900332509, 80.60371885637375, 19.230763920790828, -212.9089371297996, -94.44811335440265, 22.394426163157664, -60.710981776176645, -99.07364946220744, -137.8767808518188, -25.137023005651344, -54.212297184337594, -228.60090349857143, -350.08767368602497, 2.4524251751290316, -56.76279874711395, -34.374060304175195, 41.05723083208907, 64.81771757631117, -46.9881888573281, -210.14082504965626, -208.26799442782104, -82.54319208992376, -150.98628277312358, 12.88671277894917, -72.6986977958842, -6.2809985167526925, -149.7138771115403, -8.948517626806506, 15.37423458925261, 41.79624078127566, -15.366963025774902, 88.20200375407588, -59.9664998169021, 151.4851751851101, 5.7214614287085555, -245.9336976007131, 113.45455209567974, -221.89123862565435, -124.75265358265497, -22.36902871981782, -229.30995257672686, -33.104440298198114, -8.471508657169338, -26.535882947469695, 53.04102666271091, -56.07417450416695, -37.84568750334, 85.81705423646075, -146.27149753488806, -181.15681778072747, -34.36903684327174, -137.65099559156425, -87.6754076748512, 89.97196285614504, 37.377143687549726, 20.123508220240804, -81.05049130011936, -303.3113160305615, -24.8515038562956, -150.888799646551, -25.172089890846806, -28.227289445655643, -7.074946111357587, 21.158964647395575, -41.2762003244243, -94.43961580309538, -62.89130130753041, -91.87768879956212, -222.2765155179735, 36.80060586060443, 3.5714137179036967, -204.1359491249211, -258.8817504336413, 24.260256594815164, -125.08399913759138, -253.10961042198824, 69.05803972547822, -107.31820125064678, -304.7680684363954, 4.3053959416378715, -32.258833121728465, -5.529950963127913, 76.20707766605754, -185.2773069071387, 46.57649137988224, -13.555299204723122], "policy_predator_policy_reward": [5.808535390682379, 48.96931501798907, 111.89193877112018, 112.80776796895452, 208.23455671653736, 103.85461491546255, 110.36920944232142, 0.9575545324292857, 76.69327248912454, 93.40766354375413, 60.32525554689196, 58.03258984605194, 192.30623875721844, 3.802526776581905, 175.99148974279285, 93.05246797888589, 221.00752810238953, 64.66079622069222, 41.75952827333171, 131.89404572547062, 271.48176742046496, 180.4100208870698, 105.1178437491661, 21.012997178793547, 207.21039116568446, 94.55529079243318, 58.471497396880494, 48.94900874200521, 137.53986748995874, 147.10401169438595, 208.37703972961856, 178.6707346104696, 27.35024371179887, 74.41986318834735, 91.52375416404952, 120.0955798572065, 218.09812728020978, 3.882226759887211, 113.21968522788009, 84.787588189691, 161.0209287323506, 237.34803955412156, 103.00342792659072, 132.48427071436666, 29.234986306759197, 84.47581190673685, 13.73060389614255, 256.4420093107043, 78.9718844235627, 6.916851065659829, 138.17021135391613, 60.73083334875215, 171.75887297254326, 8.762108390809763, 140.08047393660837, 50.03559508850833, 24.417894902806115, 26.84576504248007, 138.86877539660975, 203.1153506883514, 59.87326130022345, 95.12520191794023, 53.26535569654331, 185.08765970720074, 106.29147561325568, 14.655277231417474, 243.74733908667076, 127.67475919980538, 152.54372348170475, 46.9536295963783, 191.397577162655, 71.50698027656718, 135.60459107151758, 153.47042781107743, 90.08653127398817, 222.11613801917164, 137.2668024051614, 150.9729980083614, 114.07854772749192, 119.87494214007543, 128.8407925930767, 13.463063321321995, 102.07860047026443, 91.3769836981444, 140.56346475676966, 108.60137714804192, 57.12483824850284, 35.289291527374786, 90.77264235048602, 85.5206897664912, 27.965595048385463, 43.96470930581986, 157.96090660343776, 161.83013633894376, 80.92150447783585, 109.64563196038736, 142.7522248327282, 106.96695980081469, 4.18208514989022, 31.048274946499195, 206.19738803002056, 184.57805701083902, 91.6847951795257, 164.12633046525133, 228.13331532385024, 38.732730568099804, 235.5184254094667, 85.73459501343645, 34.71711641039083, 63.350253012356454, 261.0898596823707, 322.0754711389376, 154.60500169152263, 41.23776036866141, 84.02642450866962, 109.39762302587025, 200.02278744131044, 83.72299758345963, 45.7953471746531, 192.6346268741581, 134.3107324134614, 169.0320194736642, 64.74992344292932, 190.47170180330306, 145.01326898279072, 187.18195614426946, 233.69936344565866, 211.827316845559, 93.76279874711406, 50.37406030417542, 58.675544305669995, 55.457055802285, 163.31091289570767, 196.46155044959016, 100.33751472877391, 217.69974919043878, 146.05390956440408, 114.80009422045802, 112.27561967545523, 67.20407663718129, 120.32990713650167, 166.36102879387164, 101.57949178892228, 142.21972420984466, 36.66696302577511, 54.09799624592414, 85.4346745137403, 45.63189824354237, 195.3571848065622, 133.6676527842429, 115.21573884048979, 182.97736666005915, 119.50855738776659, 151.77958996086224, 135.9314579220163, 186.39752538515708, 111.57150865716913, 73.9080182111097, 39.190228029369315, 72.27417450416667, 50.12133547396988, 55.27807312377978, 182.79109870531295, 186.06705126965295, 162.8114827850788, 191.01994231099746, 106.58990436747258, 87.68818354189753, 48.5232640285341, 13.644707306046108, 92.90975705498514, 312.41131603056147, 32.27950015308115, 201.6492095598725, 205.7645307966336, 33.82033622583263, 24.97494611135768, 50.54103535260446, 143.27604602868354, 107.31921747090837, 89.39130130752999, 130.56162294255617, 261.7776258022239, 68.91511269479675, 148.44172542149684, 187.08899961035132, 291.4992050887331, 120.8916561705349, 133.0458554623948, 320.30634926307283, 172.46227551492822, 184.89820131277818, 289.6219562222542, 106.64166957173103, 8.528411952517143, 67.90145004975138, 87.28194054247662, 189.90735987225284, 63.983425986769895, 54.19179230125816]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.492050672470802, "mean_inference_ms": 3.95996573922118, "mean_action_processing_ms": 1.867380406653522, "mean_env_wait_ms": 10.29103669272629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060176849365234375, "StateBufferConnector_ms": 0.010716795921325684, "ViewRequirementAgentConnector_ms": 0.13456940650939941}, "num_episodes": 19, "episode_return_max": 319.10031530253775, "episode_return_min": -17.518060503526286, "episode_return_mean": 128.47342851814037, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.7314533357617, "num_env_steps_trained_throughput_per_sec": 84.7314533357617, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 47075.54, "restore_workers_time_ms": 0.016, "training_step_time_ms": 47075.46, "sample_time_ms": 2081.172, "learn_time_ms": 44978.869, "learn_throughput": 88.931, "synch_weights_time_ms": 12.92}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-47-20", "timestamp": 1724149040, "time_this_iter_s": 47.25692820549011, "time_total_s": 1607.5515763759613, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3311a2ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1607.5515763759613, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 25.650746268656718, "ram_util_percent": 81.97910447761193}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.100729177805484, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.779793351794046, "policy_loss": -0.01527128261366179, "vf_loss": 7.792633572078887, "vf_explained_var": 0.30433729536949644, "kl": 0.012155307055864897, "entropy": 0.9218941593296314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.287193085497649, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.783053530334795, "policy_loss": -0.011231653845903498, "vf_loss": 5.792224374650017, "vf_explained_var": 0.14285559682619003, "kl": 0.010304055157950315, "entropy": 0.8803986673947996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 319.10031530253775, "episode_reward_min": 15.696090967255065, "episode_reward_mean": 127.27398550319049, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -350.08767368602497, "predator_policy": 4.18208514989022}, "policy_reward_max": {"prey_policy": 151.4851751851101, "predator_policy": 322.0754711389376}, "policy_reward_mean": {"prey_policy": -60.94516811540657, "predator_policy": 124.58216086700185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.985866169458625, 182.06523347239565, 37.027965478531954, 46.60000000000031, 112.94743207487039, 185.69999999999925, 139.8305300116291, 75.30000000000035, 97.31811420726008, 170.06470450813444, 116.37208229401506, 90.4000000000002, 194.0888960021464, 117.20680896997501, 180.30325101996533, 88.60639019867408, 73.81886592170032, 194.8725530157226, 113.36239394829582, 122.6027561362294, 134.02983573840464, 222.62175416531187, 89.92164742000912, 218.66357802107083, 144.2999999999996, 102.09547350353408, 183.07249852407836, 209.2591203631055, 123.0999999999988, 61.203577604387235, 90.3624320658121, 201.01805418213092, 82.13437781675182, 190.89909149077872, 15.696090967255065, 170.51966186857598, 306.464465394239, 90.06761181576101, 166.3762868575664, 143.55812064874132, 92.2078213887625, 49.38202444415147, 97.89143178032121, 53.000000000000334, 220.00754851635486, 102.64344943831411, 27.226077401467897, 122.75443379068737, 100.49999999999916, 128.02854119202613, 300.9696913692951, 163.5999999999996, 222.5852481254908, 88.8126014188003, 189.7564189705744, 124.16646504615579, 59.914590432248545, 150.47213526363947, 108.43125469208002, 153.3707753308705, 41.429834659351066, 181.81139266123967, 196.57464309066393, 119.66862324237005, 20.959265754866493, 58.18840621010745, 186.18548768596372, 89.59999999999971, 114.87944737207201, 65.18393414299467, 145.21682883965155, 134.96618962483035, 177.76936742044177, 75.1585951658879, 319.10031530253775, 95.80095329922808, 38.641077917412396, 168.11907117364822, 151.19641046318654, 54.95018185059339, 120.03371599998164, 190.16500150834196, 64.80000000000014, 98.13549721619849, 160.77268214967876, 93.70113243993637, 155.66794584836572, 43.40947800484324, 151.64770344262922, 128.8211085848257, 101.58780133969984, 154.95808289505862, 170.63643954751, 78.93184764904967, 280.42064659503967, 118.00557781702084, 166.49612205743375, 27.600000000000122, 25.339684435195636, 89.31002643343788], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-102.26777846138845, -101.23405401011145, 85.17434333067362, -16.819908071773227, -37.619112270523665, -195.52553545779136, -51.871884423562534, 12.583148934340135, -90.60291915625581, 4.649306528457885, 4.610711704998287, 0.5683069316487466, 10.401866923107415, -60.6874059365948, 32.68210509719388, -8.645765042479944, -157.0402925060287, -87.62571937167246, 72.7668096126156, -57.70056832264462, -16.935106851538308, -105.0458262581902, -92.19147561325649, 61.644722768582525, -218.3977967026436, 41.064594418313746, -113.74940319288368, 31.458859084776535, -26.403073531281116, -56.19823288797503, -231.16246982120106, 30.69384113727979, -25.93566868949167, -212.44813468196833, -97.2577624169456, 3.890515019145596, -111.20280839079041, -9.388287528481074, -0.6635516682915963, -19.037548109876994, 21.401631438400486, -80.82737986840374, 99.39838880693435, -125.94147654643405, 10.134356638660448, -12.626838994528994, 40.67053500992758, 1.6997108941662007, -10.465595048385321, 82.8352906941802, -66.21270604396133, -151.48286339488726, 120.09816879733268, -127.59280671147752, 105.3177282562151, -145.77779252665246, 89.08065356832917, -1.2110136647191183, -129.12192242650403, -200.44994500996927, -35.41834519955148, -130.03034837941374, -187.30147662071133, 121.45348491089219, -220.427162894648, -18.691479711502524, 33.97570867449334, 58.856013393538454, -250.9937687151157, -316.47547113893705, -89.72143625478543, 64.3983360631774, 32.43669900332509, 80.60371885637375, 19.230763920790828, -212.9089371297996, -94.44811335440265, 22.394426163157664, -60.710981776176645, -99.07364946220744, -137.8767808518188, -25.137023005651344, -54.212297184337594, -228.60090349857143, -350.08767368602497, 2.4524251751290316, -56.76279874711395, -34.374060304175195, 41.05723083208907, 64.81771757631117, -46.9881888573281, -210.14082504965626, -208.26799442782104, -82.54319208992376, -150.98628277312358, 12.88671277894917, -72.6986977958842, -6.2809985167526925, -149.7138771115403, -8.948517626806506, 15.37423458925261, 41.79624078127566, -15.366963025774902, 88.20200375407588, -59.9664998169021, 151.4851751851101, 5.7214614287085555, -245.9336976007131, 113.45455209567974, -221.89123862565435, -124.75265358265497, -22.36902871981782, -229.30995257672686, -33.104440298198114, -8.471508657169338, -26.535882947469695, 53.04102666271091, -56.07417450416695, -37.84568750334, 85.81705423646075, -146.27149753488806, -181.15681778072747, -34.36903684327174, -137.65099559156425, -87.6754076748512, 89.97196285614504, 37.377143687549726, 20.123508220240804, -81.05049130011936, -303.3113160305615, -24.8515038562956, -150.888799646551, -25.172089890846806, -28.227289445655643, -7.074946111357587, 21.158964647395575, -41.2762003244243, -94.43961580309538, -62.89130130753041, -91.87768879956212, -222.2765155179735, 36.80060586060443, 3.5714137179036967, -204.1359491249211, -258.8817504336413, 24.260256594815164, -125.08399913759138, -253.10961042198824, 69.05803972547822, -107.31820125064678, -304.7680684363954, 4.3053959416378715, -32.258833121728465, -5.529950963127913, 76.20707766605754, -185.2773069071387, 46.57649137988224, -13.555299204723122, -183.98098005908616, -52.42314277203363, -26.313250151478112, -52.46849050562005, -20.519341364637846, -13.371541173205458, -223.55611843046916, -224.619371453828, -62.9381562591374, -49.80235101426778, 120.81697570638771, -108.88567188970234, -83.16099148671647, -133.8777692010729, 110.79789336556254, -240.4358495012351, -158.86489079105547, -184.25653701427052, -84.55117311831074, 123.00102900033107, -83.49294708929948, -239.58978960361765, -67.87326688964463, -244.95736115599396, -71.19431293699009, -54.972747496176225, -90.03588277583674, 93.93265034684859, -78.96255158222871, -38.305569104939664, -42.394766671432464, 19.2712319247307, 0.3306497288089498, -157.16605400724058, -48.85219856614833, -150.38658107061443, -38.90578774281688, -116.07609013877526, -162.13062587065386, -199.51065189898043, -107.15988518693422, -75.69087705891117], "policy_predator_policy_reward": [103.00342792659072, 132.48427071436666, 29.234986306759197, 84.47581190673685, 13.73060389614255, 256.4420093107043, 78.9718844235627, 6.916851065659829, 138.17021135391613, 60.73083334875215, 171.75887297254326, 8.762108390809763, 140.08047393660837, 50.03559508850833, 24.417894902806115, 26.84576504248007, 138.86877539660975, 203.1153506883514, 59.87326130022345, 95.12520191794023, 53.26535569654331, 185.08765970720074, 106.29147561325568, 14.655277231417474, 243.74733908667076, 127.67475919980538, 152.54372348170475, 46.9536295963783, 191.397577162655, 71.50698027656718, 135.60459107151758, 153.47042781107743, 90.08653127398817, 222.11613801917164, 137.2668024051614, 150.9729980083614, 114.07854772749192, 119.87494214007543, 128.8407925930767, 13.463063321321995, 102.07860047026443, 91.3769836981444, 140.56346475676966, 108.60137714804192, 57.12483824850284, 35.289291527374786, 90.77264235048602, 85.5206897664912, 27.965595048385463, 43.96470930581986, 157.96090660343776, 161.83013633894376, 80.92150447783585, 109.64563196038736, 142.7522248327282, 106.96695980081469, 4.18208514989022, 31.048274946499195, 206.19738803002056, 184.57805701083902, 91.6847951795257, 164.12633046525133, 228.13331532385024, 38.732730568099804, 235.5184254094667, 85.73459501343645, 34.71711641039083, 63.350253012356454, 261.0898596823707, 322.0754711389376, 154.60500169152263, 41.23776036866141, 84.02642450866962, 109.39762302587025, 200.02278744131044, 83.72299758345963, 45.7953471746531, 192.6346268741581, 134.3107324134614, 169.0320194736642, 64.74992344292932, 190.47170180330306, 145.01326898279072, 187.18195614426946, 233.69936344565866, 211.827316845559, 93.76279874711406, 50.37406030417542, 58.675544305669995, 55.457055802285, 163.31091289570767, 196.46155044959016, 100.33751472877391, 217.69974919043878, 146.05390956440408, 114.80009422045802, 112.27561967545523, 67.20407663718129, 120.32990713650167, 166.36102879387164, 101.57949178892228, 142.21972420984466, 36.66696302577511, 54.09799624592414, 85.4346745137403, 45.63189824354237, 195.3571848065622, 133.6676527842429, 115.21573884048979, 182.97736666005915, 119.50855738776659, 151.77958996086224, 135.9314579220163, 186.39752538515708, 111.57150865716913, 73.9080182111097, 39.190228029369315, 72.27417450416667, 50.12133547396988, 55.27807312377978, 182.79109870531295, 186.06705126965295, 162.8114827850788, 191.01994231099746, 106.58990436747258, 87.68818354189753, 48.5232640285341, 13.644707306046108, 92.90975705498514, 312.41131603056147, 32.27950015308115, 201.6492095598725, 205.7645307966336, 33.82033622583263, 24.97494611135768, 50.54103535260446, 143.27604602868354, 107.31921747090837, 89.39130130752999, 130.56162294255617, 261.7776258022239, 68.91511269479675, 148.44172542149684, 187.08899961035132, 291.4992050887331, 120.8916561705349, 133.0458554623948, 320.30634926307283, 172.46227551492822, 184.89820131277818, 289.6219562222542, 106.64166957173103, 8.528411952517143, 67.90145004975138, 87.28194054247662, 189.90735987225284, 63.983425986769895, 54.19179230125816, 188.08937534937468, 103.26492933233806, 110.49275914646581, 88.3226975106139, 88.86632461249722, 135.18955943368834, 260.956118430469, 252.01937145382786, 125.06619760054042, 85.8098068890632, 53.344060014699885, 95.49731831829342, 160.96772372237734, 149.77216940534856, 97.71734814587975, 187.58855383815853, 217.91745910204418, 168.61344670812414, 87.04279618081861, 26.155051379790482, 249.51639265331582, 202.38745262442765, 95.65507724303178, 318.7633521423068, 212.01567237854567, 69.1094709496793, 104.05676352159975, 62.682908454898964, 154.1099241519862, 42.09004418423171, 143.95218706027273, 159.59199428146883, 87.60501448969593, 187.2359676057566, 177.10943219482866, 188.62546949936782, 56.40578774281711, 126.17609013877468, 183.6836262917669, 203.2973359130625, 203.61708016356044, 68.54370851572266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4787706036048265, "mean_inference_ms": 3.92204080365332, "mean_action_processing_ms": 1.818165521850728, "mean_env_wait_ms": 10.28827399002411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006081223487854004, "StateBufferConnector_ms": 0.004211306571960449, "ViewRequirementAgentConnector_ms": 0.1313331127166748}, "num_episodes": 21, "episode_return_max": 319.10031530253775, "episode_return_min": 15.696090967255065, "episode_return_mean": 127.27398550319049, "episodes_this_iter": 21}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.14863030784187, "num_env_steps_trained_throughput_per_sec": 82.14863030784187, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 47260.981, "restore_workers_time_ms": 0.016, "training_step_time_ms": 47260.9, "sample_time_ms": 2097.782, "learn_time_ms": 45147.979, "learn_throughput": 88.598, "synch_weights_time_ms": 12.525}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-48-09", "timestamp": 1724149089, "time_this_iter_s": 48.73312711715698, "time_total_s": 1656.2847034931183, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12007ae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1656.2847034931183, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 30.281159420289857, "ram_util_percent": 82.24782608695652}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.571008540145936, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.440273640143178, "policy_loss": -0.017220501847338504, "vf_loss": 7.454925938762685, "vf_explained_var": 0.23527561659535404, "kl": 0.012841011604993905, "entropy": 0.9170907941129472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.672871011022537, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.964494867678042, "policy_loss": -0.017450451164348693, "vf_loss": 5.979302890212447, "vf_explained_var": 0.13680269519488017, "kl": 0.013212188026650992, "entropy": 0.8769453550457323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 319.10031530253775, "episode_reward_min": 15.696090967255065, "episode_reward_mean": 133.7082836677508, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -427.39869154945296, "predator_policy": 4.18208514989022}, "policy_reward_max": {"prey_policy": 199.1, "predator_policy": 377.1644315579748}, "policy_reward_mean": {"prey_policy": -65.61354206734167, "predator_policy": 132.46768390121707}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.62175416531187, 89.92164742000912, 218.66357802107083, 144.2999999999996, 102.09547350353408, 183.07249852407836, 209.2591203631055, 123.0999999999988, 61.203577604387235, 90.3624320658121, 201.01805418213092, 82.13437781675182, 190.89909149077872, 15.696090967255065, 170.51966186857598, 306.464465394239, 90.06761181576101, 166.3762868575664, 143.55812064874132, 92.2078213887625, 49.38202444415147, 97.89143178032121, 53.000000000000334, 220.00754851635486, 102.64344943831411, 27.226077401467897, 122.75443379068737, 100.49999999999916, 128.02854119202613, 300.9696913692951, 163.5999999999996, 222.5852481254908, 88.8126014188003, 189.7564189705744, 124.16646504615579, 59.914590432248545, 150.47213526363947, 108.43125469208002, 153.3707753308705, 41.429834659351066, 181.81139266123967, 196.57464309066393, 119.66862324237005, 20.959265754866493, 58.18840621010745, 186.18548768596372, 89.59999999999971, 114.87944737207201, 65.18393414299467, 145.21682883965155, 134.96618962483035, 177.76936742044177, 75.1585951658879, 319.10031530253775, 95.80095329922808, 38.641077917412396, 168.11907117364822, 151.19641046318654, 54.95018185059339, 120.03371599998164, 190.16500150834196, 64.80000000000014, 98.13549721619849, 160.77268214967876, 93.70113243993637, 155.66794584836572, 43.40947800484324, 151.64770344262922, 128.8211085848257, 101.58780133969984, 154.95808289505862, 170.63643954751, 78.93184764904967, 280.42064659503967, 118.00557781702084, 166.49612205743375, 27.600000000000122, 25.339684435195636, 89.31002643343788, 249.18489888689408, 163.5036246875056, 244.87911836236768, 91.22307078492723, 300.9994696166308, 26.787289802284022, 158.0277528845558, 271.11413533118036, 94.88258011045184, 185.73617632316285, 257.20010073459764, 155.98671898474814, 159.07980002625973, 110.69696437571505, 38.269677947728745, 110.60639002932474, 50.383937738454975, 157.2373454886124, 139.9046930760272, 90.71454031365245, 91.51521011835698], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [99.39838880693435, -125.94147654643405, 10.134356638660448, -12.626838994528994, 40.67053500992758, 1.6997108941662007, -10.465595048385321, 82.8352906941802, -66.21270604396133, -151.48286339488726, 120.09816879733268, -127.59280671147752, 105.3177282562151, -145.77779252665246, 89.08065356832917, -1.2110136647191183, -129.12192242650403, -200.44994500996927, -35.41834519955148, -130.03034837941374, -187.30147662071133, 121.45348491089219, -220.427162894648, -18.691479711502524, 33.97570867449334, 58.856013393538454, -250.9937687151157, -316.47547113893705, -89.72143625478543, 64.3983360631774, 32.43669900332509, 80.60371885637375, 19.230763920790828, -212.9089371297996, -94.44811335440265, 22.394426163157664, -60.710981776176645, -99.07364946220744, -137.8767808518188, -25.137023005651344, -54.212297184337594, -228.60090349857143, -350.08767368602497, 2.4524251751290316, -56.76279874711395, -34.374060304175195, 41.05723083208907, 64.81771757631117, -46.9881888573281, -210.14082504965626, -208.26799442782104, -82.54319208992376, -150.98628277312358, 12.88671277894917, -72.6986977958842, -6.2809985167526925, -149.7138771115403, -8.948517626806506, 15.37423458925261, 41.79624078127566, -15.366963025774902, 88.20200375407588, -59.9664998169021, 151.4851751851101, 5.7214614287085555, -245.9336976007131, 113.45455209567974, -221.89123862565435, -124.75265358265497, -22.36902871981782, -229.30995257672686, -33.104440298198114, -8.471508657169338, -26.535882947469695, 53.04102666271091, -56.07417450416695, -37.84568750334, 85.81705423646075, -146.27149753488806, -181.15681778072747, -34.36903684327174, -137.65099559156425, -87.6754076748512, 89.97196285614504, 37.377143687549726, 20.123508220240804, -81.05049130011936, -303.3113160305615, -24.8515038562956, -150.888799646551, -25.172089890846806, -28.227289445655643, -7.074946111357587, 21.158964647395575, -41.2762003244243, -94.43961580309538, -62.89130130753041, -91.87768879956212, -222.2765155179735, 36.80060586060443, 3.5714137179036967, -204.1359491249211, -258.8817504336413, 24.260256594815164, -125.08399913759138, -253.10961042198824, 69.05803972547822, -107.31820125064678, -304.7680684363954, 4.3053959416378715, -32.258833121728465, -5.529950963127913, 76.20707766605754, -185.2773069071387, 46.57649137988224, -13.555299204723122, -183.98098005908616, -52.42314277203363, -26.313250151478112, -52.46849050562005, -20.519341364637846, -13.371541173205458, -223.55611843046916, -224.619371453828, -62.9381562591374, -49.80235101426778, 120.81697570638771, -108.88567188970234, -83.16099148671647, -133.8777692010729, 110.79789336556254, -240.4358495012351, -158.86489079105547, -184.25653701427052, -84.55117311831074, 123.00102900033107, -83.49294708929948, -239.58978960361765, -67.87326688964463, -244.95736115599396, -71.19431293699009, -54.972747496176225, -90.03588277583674, 93.93265034684859, -78.96255158222871, -38.305569104939664, -42.394766671432464, 19.2712319247307, 0.3306497288089498, -157.16605400724058, -48.85219856614833, -150.38658107061443, -38.90578774281688, -116.07609013877526, -162.13062587065386, -199.51065189898043, -107.15988518693422, -75.69087705891117, -7.227166043966129, -94.34805428798592, -95.38525592411074, 88.16081671062243, 83.14361710483057, -143.52670783411315, -361.75844766048033, -58.78780006918957, -9.90807120654327, 137.47070144589355, -89.41501879741892, -192.9023328623847, -168.80763515169946, 73.71804328150267, -11.25969692151326, 158.57326479001253, -155.74605959927726, -135.48033120184402, 155.9, -93.68799300750784, 199.1, -181.813329022158, -61.54862976298648, -46.50803017990195, -89.02385952156315, -87.70024527851565, -67.93784714465822, -27.35108101060584, 5.241878062307075, -119.25576387397545, -427.39869154945296, -54.20256852890928, -21.970685584244656, -163.97006851400596, -48.62573085498825, -249.3629843804747, -51.1264409103066, -73.35011714126821, -11.837653137765884, -172.4541046289523, -31.052573017721954, -201.146843486211], "policy_predator_policy_reward": [140.56346475676966, 108.60137714804192, 57.12483824850284, 35.289291527374786, 90.77264235048602, 85.5206897664912, 27.965595048385463, 43.96470930581986, 157.96090660343776, 161.83013633894376, 80.92150447783585, 109.64563196038736, 142.7522248327282, 106.96695980081469, 4.18208514989022, 31.048274946499195, 206.19738803002056, 184.57805701083902, 91.6847951795257, 164.12633046525133, 228.13331532385024, 38.732730568099804, 235.5184254094667, 85.73459501343645, 34.71711641039083, 63.350253012356454, 261.0898596823707, 322.0754711389376, 154.60500169152263, 41.23776036866141, 84.02642450866962, 109.39762302587025, 200.02278744131044, 83.72299758345963, 45.7953471746531, 192.6346268741581, 134.3107324134614, 169.0320194736642, 64.74992344292932, 190.47170180330306, 145.01326898279072, 187.18195614426946, 233.69936344565866, 211.827316845559, 93.76279874711406, 50.37406030417542, 58.675544305669995, 55.457055802285, 163.31091289570767, 196.46155044959016, 100.33751472877391, 217.69974919043878, 146.05390956440408, 114.80009422045802, 112.27561967545523, 67.20407663718129, 120.32990713650167, 166.36102879387164, 101.57949178892228, 142.21972420984466, 36.66696302577511, 54.09799624592414, 85.4346745137403, 45.63189824354237, 195.3571848065622, 133.6676527842429, 115.21573884048979, 182.97736666005915, 119.50855738776659, 151.77958996086224, 135.9314579220163, 186.39752538515708, 111.57150865716913, 73.9080182111097, 39.190228029369315, 72.27417450416667, 50.12133547396988, 55.27807312377978, 182.79109870531295, 186.06705126965295, 162.8114827850788, 191.01994231099746, 106.58990436747258, 87.68818354189753, 48.5232640285341, 13.644707306046108, 92.90975705498514, 312.41131603056147, 32.27950015308115, 201.6492095598725, 205.7645307966336, 33.82033622583263, 24.97494611135768, 50.54103535260446, 143.27604602868354, 107.31921747090837, 89.39130130752999, 130.56162294255617, 261.7776258022239, 68.91511269479675, 148.44172542149684, 187.08899961035132, 291.4992050887331, 120.8916561705349, 133.0458554623948, 320.30634926307283, 172.46227551492822, 184.89820131277818, 289.6219562222542, 106.64166957173103, 8.528411952517143, 67.90145004975138, 87.28194054247662, 189.90735987225284, 63.983425986769895, 54.19179230125816, 188.08937534937468, 103.26492933233806, 110.49275914646581, 88.3226975106139, 88.86632461249722, 135.18955943368834, 260.956118430469, 252.01937145382786, 125.06619760054042, 85.8098068890632, 53.344060014699885, 95.49731831829342, 160.96772372237734, 149.77216940534856, 97.71734814587975, 187.58855383815853, 217.91745910204418, 168.61344670812414, 87.04279618081861, 26.155051379790482, 249.51639265331582, 202.38745262442765, 95.65507724303178, 318.7633521423068, 212.01567237854567, 69.1094709496793, 104.05676352159975, 62.682908454898964, 154.1099241519862, 42.09004418423171, 143.95218706027273, 159.59199428146883, 87.60501448969593, 187.2359676057566, 177.10943219482866, 188.62546949936782, 56.40578774281711, 126.17609013877468, 183.6836262917669, 203.2973359130625, 203.61708016356044, 68.54370851572266, 203.10195674615278, 147.65816247269325, 29.03679993185101, 141.69126396914288, 134.90042659516493, 170.3617824964853, 340.4287842263394, 171.34053428825757, 50.552000800954666, 122.88483857632585, 96.79561959305006, 212.3090218690367, 183.27149036315487, 69.84585439159774, 33.75827776723963, 90.0422896954412, 311.647598735729, 74.46137217584408, 56.71150381631165, 66.81266551435914, 115.38833260544293, 124.52509715131261, 39.72423127552931, 224.31914765210732, 266.4327784583447, 69.37112636799363, 113.98970693964961, 91.99618559132956, 128.5494611850689, 23.73410257432797, 377.1644315579748, 215.04321854971252, 83.48170155154781, 152.84299028515713, 232.91584666195212, 222.31021406212312, 62.09857600110841, 202.28267512649356, 104.6858241997099, 170.32047388066104, 106.26493825779004, 217.44968836450036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.463708151212863, "mean_inference_ms": 3.8980494524438973, "mean_action_processing_ms": 1.8039070972573898, "mean_env_wait_ms": 10.244796398944263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006944775581359863, "StateBufferConnector_ms": 0.0043038129806518555, "ViewRequirementAgentConnector_ms": 0.13261747360229492}, "num_episodes": 21, "episode_return_max": 319.10031530253775, "episode_return_min": 15.696090967255065, "episode_return_mean": 133.7082836677508, "episodes_this_iter": 21}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.98149704112475, "num_env_steps_trained_throughput_per_sec": 82.98149704112475, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 47301.726, "restore_workers_time_ms": 0.016, "training_step_time_ms": 47301.68, "sample_time_ms": 2100.398, "learn_time_ms": 45187.188, "learn_throughput": 88.521, "synch_weights_time_ms": 12.184}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-48-57", "timestamp": 1724149137, "time_this_iter_s": 48.25383996963501, "time_total_s": 1704.5385434627533, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12002b3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1704.5385434627533, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 27.408823529411762, "ram_util_percent": 81.78970588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.71377159716591, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.476965788684825, "policy_loss": -0.019457467517657846, "vf_loss": 7.4936207751117685, "vf_explained_var": 0.19034455197828787, "kl": 0.014012434564422442, "entropy": 0.9005701492072413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 1023.8800000000047}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.587957055858834, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.113147017564723, "policy_loss": -0.012567637706540092, "vf_loss": 6.123449994395019, "vf_explained_var": 0.09981062487950401, "kl": 0.011323379949671487, "entropy": 0.8370280009098154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 1023.8800000000047}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 319.10031530253775, "episode_reward_min": 20.959265754866493, "episode_reward_mean": 125.59882495976215, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -427.39869154945296, "predator_policy": 5.564007486241742}, "policy_reward_max": {"prey_policy": 199.1, "predator_policy": 377.1644315579748}, "policy_reward_mean": {"prey_policy": -72.67799544757159, "predator_policy": 135.47740792745265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.38202444415147, 97.89143178032121, 53.000000000000334, 220.00754851635486, 102.64344943831411, 27.226077401467897, 122.75443379068737, 100.49999999999916, 128.02854119202613, 300.9696913692951, 163.5999999999996, 222.5852481254908, 88.8126014188003, 189.7564189705744, 124.16646504615579, 59.914590432248545, 150.47213526363947, 108.43125469208002, 153.3707753308705, 41.429834659351066, 181.81139266123967, 196.57464309066393, 119.66862324237005, 20.959265754866493, 58.18840621010745, 186.18548768596372, 89.59999999999971, 114.87944737207201, 65.18393414299467, 145.21682883965155, 134.96618962483035, 177.76936742044177, 75.1585951658879, 319.10031530253775, 95.80095329922808, 38.641077917412396, 168.11907117364822, 151.19641046318654, 54.95018185059339, 120.03371599998164, 190.16500150834196, 64.80000000000014, 98.13549721619849, 160.77268214967876, 93.70113243993637, 155.66794584836572, 43.40947800484324, 151.64770344262922, 128.8211085848257, 101.58780133969984, 154.95808289505862, 170.63643954751, 78.93184764904967, 280.42064659503967, 118.00557781702084, 166.49612205743375, 27.600000000000122, 25.339684435195636, 89.31002643343788, 249.18489888689408, 163.5036246875056, 244.87911836236768, 91.22307078492723, 300.9994696166308, 26.787289802284022, 158.0277528845558, 271.11413533118036, 94.88258011045184, 185.73617632316285, 257.20010073459764, 155.98671898474814, 159.07980002625973, 110.69696437571505, 38.269677947728745, 110.60639002932474, 50.383937738454975, 157.2373454886124, 139.9046930760272, 90.71454031365245, 91.51521011835698, 97.8826173780923, 170.96918479505615, 94.44309416691715, 54.72297492790834, 67.47580859058914, 90.54535955097685, 76.21570454861022, 104.83076652669027, 50.59667701976482, 124.96462237163595, 213.40520161759713, 70.13522502319768, 99.31666883718168, 111.88731495623715, 134.87548042592022, 39.0462948362164, 56.10000000000013, 58.28058169716882, 176.85996707561904, 200.04224895362748], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-54.212297184337594, -228.60090349857143, -350.08767368602497, 2.4524251751290316, -56.76279874711395, -34.374060304175195, 41.05723083208907, 64.81771757631117, -46.9881888573281, -210.14082504965626, -208.26799442782104, -82.54319208992376, -150.98628277312358, 12.88671277894917, -72.6986977958842, -6.2809985167526925, -149.7138771115403, -8.948517626806506, 15.37423458925261, 41.79624078127566, -15.366963025774902, 88.20200375407588, -59.9664998169021, 151.4851751851101, 5.7214614287085555, -245.9336976007131, 113.45455209567974, -221.89123862565435, -124.75265358265497, -22.36902871981782, -229.30995257672686, -33.104440298198114, -8.471508657169338, -26.535882947469695, 53.04102666271091, -56.07417450416695, -37.84568750334, 85.81705423646075, -146.27149753488806, -181.15681778072747, -34.36903684327174, -137.65099559156425, -87.6754076748512, 89.97196285614504, 37.377143687549726, 20.123508220240804, -81.05049130011936, -303.3113160305615, -24.8515038562956, -150.888799646551, -25.172089890846806, -28.227289445655643, -7.074946111357587, 21.158964647395575, -41.2762003244243, -94.43961580309538, -62.89130130753041, -91.87768879956212, -222.2765155179735, 36.80060586060443, 3.5714137179036967, -204.1359491249211, -258.8817504336413, 24.260256594815164, -125.08399913759138, -253.10961042198824, 69.05803972547822, -107.31820125064678, -304.7680684363954, 4.3053959416378715, -32.258833121728465, -5.529950963127913, 76.20707766605754, -185.2773069071387, 46.57649137988224, -13.555299204723122, -183.98098005908616, -52.42314277203363, -26.313250151478112, -52.46849050562005, -20.519341364637846, -13.371541173205458, -223.55611843046916, -224.619371453828, -62.9381562591374, -49.80235101426778, 120.81697570638771, -108.88567188970234, -83.16099148671647, -133.8777692010729, 110.79789336556254, -240.4358495012351, -158.86489079105547, -184.25653701427052, -84.55117311831074, 123.00102900033107, -83.49294708929948, -239.58978960361765, -67.87326688964463, -244.95736115599396, -71.19431293699009, -54.972747496176225, -90.03588277583674, 93.93265034684859, -78.96255158222871, -38.305569104939664, -42.394766671432464, 19.2712319247307, 0.3306497288089498, -157.16605400724058, -48.85219856614833, -150.38658107061443, -38.90578774281688, -116.07609013877526, -162.13062587065386, -199.51065189898043, -107.15988518693422, -75.69087705891117, -7.227166043966129, -94.34805428798592, -95.38525592411074, 88.16081671062243, 83.14361710483057, -143.52670783411315, -361.75844766048033, -58.78780006918957, -9.90807120654327, 137.47070144589355, -89.41501879741892, -192.9023328623847, -168.80763515169946, 73.71804328150267, -11.25969692151326, 158.57326479001253, -155.74605959927726, -135.48033120184402, 155.9, -93.68799300750784, 199.1, -181.813329022158, -61.54862976298648, -46.50803017990195, -89.02385952156315, -87.70024527851565, -67.93784714465822, -27.35108101060584, 5.241878062307075, -119.25576387397545, -427.39869154945296, -54.20256852890928, -21.970685584244656, -163.97006851400596, -48.62573085498825, -249.3629843804747, -51.1264409103066, -73.35011714126821, -11.837653137765884, -172.4541046289523, -31.052573017721954, -201.146843486211, 4.542380343639928, -243.41435614932368, 84.24249955831937, -106.35635488759978, -69.67665404815767, -176.57772946037272, -138.350883056899, -81.97782760198642, -176.54333519776844, -38.81927197172081, -271.3191077879183, -9.943319520188393, -78.16864453166136, -100.5290874080715, -189.16731723906514, -108.14531344553296, -92.45616056047223, -105.87745220206631, 30.54451980908774, -247.3034260677752, 87.60891597637868, -260.03068309131083, -62.88709627229866, 15.452401610999964, -193.8477616775366, -150.24665487119503, 5.267065028618476, 14.089579221975393, -55.368022833957745, 4.060342682208718, -106.84778756653414, -41.91937289764815, -128.21916136142636, -93.38408178438685, -5.645210527655699, -137.18093387210624, -22.742447337160417, -57.4927150338421, 15.380703451616853, 8.845135324064964], "policy_predator_policy_reward": [145.01326898279072, 187.18195614426946, 233.69936344565866, 211.827316845559, 93.76279874711406, 50.37406030417542, 58.675544305669995, 55.457055802285, 163.31091289570767, 196.46155044959016, 100.33751472877391, 217.69974919043878, 146.05390956440408, 114.80009422045802, 112.27561967545523, 67.20407663718129, 120.32990713650167, 166.36102879387164, 101.57949178892228, 142.21972420984466, 36.66696302577511, 54.09799624592414, 85.4346745137403, 45.63189824354237, 195.3571848065622, 133.6676527842429, 115.21573884048979, 182.97736666005915, 119.50855738776659, 151.77958996086224, 135.9314579220163, 186.39752538515708, 111.57150865716913, 73.9080182111097, 39.190228029369315, 72.27417450416667, 50.12133547396988, 55.27807312377978, 182.79109870531295, 186.06705126965295, 162.8114827850788, 191.01994231099746, 106.58990436747258, 87.68818354189753, 48.5232640285341, 13.644707306046108, 92.90975705498514, 312.41131603056147, 32.27950015308115, 201.6492095598725, 205.7645307966336, 33.82033622583263, 24.97494611135768, 50.54103535260446, 143.27604602868354, 107.31921747090837, 89.39130130752999, 130.56162294255617, 261.7776258022239, 68.91511269479675, 148.44172542149684, 187.08899961035132, 291.4992050887331, 120.8916561705349, 133.0458554623948, 320.30634926307283, 172.46227551492822, 184.89820131277818, 289.6219562222542, 106.64166957173103, 8.528411952517143, 67.90145004975138, 87.28194054247662, 189.90735987225284, 63.983425986769895, 54.19179230125816, 188.08937534937468, 103.26492933233806, 110.49275914646581, 88.3226975106139, 88.86632461249722, 135.18955943368834, 260.956118430469, 252.01937145382786, 125.06619760054042, 85.8098068890632, 53.344060014699885, 95.49731831829342, 160.96772372237734, 149.77216940534856, 97.71734814587975, 187.58855383815853, 217.91745910204418, 168.61344670812414, 87.04279618081861, 26.155051379790482, 249.51639265331582, 202.38745262442765, 95.65507724303178, 318.7633521423068, 212.01567237854567, 69.1094709496793, 104.05676352159975, 62.682908454898964, 154.1099241519862, 42.09004418423171, 143.95218706027273, 159.59199428146883, 87.60501448969593, 187.2359676057566, 177.10943219482866, 188.62546949936782, 56.40578774281711, 126.17609013877468, 183.6836262917669, 203.2973359130625, 203.61708016356044, 68.54370851572266, 203.10195674615278, 147.65816247269325, 29.03679993185101, 141.69126396914288, 134.90042659516493, 170.3617824964853, 340.4287842263394, 171.34053428825757, 50.552000800954666, 122.88483857632585, 96.79561959305006, 212.3090218690367, 183.27149036315487, 69.84585439159774, 33.75827776723963, 90.0422896954412, 311.647598735729, 74.46137217584408, 56.71150381631165, 66.81266551435914, 115.38833260544293, 124.52509715131261, 39.72423127552931, 224.31914765210732, 266.4327784583447, 69.37112636799363, 113.98970693964961, 91.99618559132956, 128.5494611850689, 23.73410257432797, 377.1644315579748, 215.04321854971252, 83.48170155154781, 152.84299028515713, 232.91584666195212, 222.31021406212312, 62.09857600110841, 202.28267512649356, 104.6858241997099, 170.32047388066104, 106.26493825779004, 217.44968836450036, 153.91161082694134, 182.8429823568347, 103.04454568299897, 90.03849444133769, 144.62806830787574, 196.0694093675717, 190.75584046439602, 84.2958451223971, 89.79787604519734, 193.04053971488122, 198.26098664579007, 173.5468002132935, 99.2941132811922, 155.61932320714993, 238.9876723759921, 163.15572483529635, 88.38649472672215, 160.54379505558035, 217.15673278684648, 124.56679584347734, 294.10194326658814, 91.72502546594144, 35.54289404420376, 82.02702564029265, 224.3823382337233, 219.0287471521897, 5.564007486241742, 86.96666321940242, 84.01278433109444, 102.17037624657496, 82.07166644716632, 105.74178885323147, 162.4789216849198, 115.22432146089292, 25.325792224824305, 175.78093387210615, 69.05525560714615, 188.03987383947575, 48.0091347892941, 127.80727538865187]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417368855371053, "mean_inference_ms": 3.8807641967415636, "mean_action_processing_ms": 1.8052321945024667, "mean_env_wait_ms": 10.22862214819292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007048606872558594, "StateBufferConnector_ms": 0.004256725311279297, "ViewRequirementAgentConnector_ms": 0.1439000368118286}, "num_episodes": 20, "episode_return_max": 319.10031530253775, "episode_return_min": 20.959265754866493, "episode_return_mean": 125.59882495976215, "episodes_this_iter": 20}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.82687266070538, "num_env_steps_trained_throughput_per_sec": 83.82687266070538, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 47373.605, "restore_workers_time_ms": 0.016, "training_step_time_ms": 47373.559, "sample_time_ms": 2157.596, "learn_time_ms": 45201.917, "learn_throughput": 88.492, "synch_weights_time_ms": 12.147}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-49-45", "timestamp": 1724149185, "time_this_iter_s": 47.75207996368408, "time_total_s": 1752.2906234264374, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12007aca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1752.2906234264374, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 26.444117647058825, "ram_util_percent": 82.17352941176472}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.67704371403134, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.8235003473897455, "policy_loss": -0.015969176933898654, "vf_loss": 7.837257587342036, "vf_explained_var": 0.15267207549993322, "kl": 0.011059818360658865, "entropy": 0.8835201748149105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.278399908006507, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.557489585371875, "policy_loss": -0.015399458238771235, "vf_loss": 5.570688643026604, "vf_explained_var": 0.1929712736417377, "kl": 0.011001930074032062, "entropy": 0.8493860103781261, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 319.10031530253775, "episode_reward_min": 20.959265754866493, "episode_reward_mean": 122.09339025036368, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -427.39869154945296, "predator_policy": 5.564007486241742}, "policy_reward_max": {"prey_policy": 199.1, "predator_policy": 377.1644315579748}, "policy_reward_mean": {"prey_policy": -76.01825455717398, "predator_policy": 137.0649496823558}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.914590432248545, 150.47213526363947, 108.43125469208002, 153.3707753308705, 41.429834659351066, 181.81139266123967, 196.57464309066393, 119.66862324237005, 20.959265754866493, 58.18840621010745, 186.18548768596372, 89.59999999999971, 114.87944737207201, 65.18393414299467, 145.21682883965155, 134.96618962483035, 177.76936742044177, 75.1585951658879, 319.10031530253775, 95.80095329922808, 38.641077917412396, 168.11907117364822, 151.19641046318654, 54.95018185059339, 120.03371599998164, 190.16500150834196, 64.80000000000014, 98.13549721619849, 160.77268214967876, 93.70113243993637, 155.66794584836572, 43.40947800484324, 151.64770344262922, 128.8211085848257, 101.58780133969984, 154.95808289505862, 170.63643954751, 78.93184764904967, 280.42064659503967, 118.00557781702084, 166.49612205743375, 27.600000000000122, 25.339684435195636, 89.31002643343788, 249.18489888689408, 163.5036246875056, 244.87911836236768, 91.22307078492723, 300.9994696166308, 26.787289802284022, 158.0277528845558, 271.11413533118036, 94.88258011045184, 185.73617632316285, 257.20010073459764, 155.98671898474814, 159.07980002625973, 110.69696437571505, 38.269677947728745, 110.60639002932474, 50.383937738454975, 157.2373454886124, 139.9046930760272, 90.71454031365245, 91.51521011835698, 97.8826173780923, 170.96918479505615, 94.44309416691715, 54.72297492790834, 67.47580859058914, 90.54535955097685, 76.21570454861022, 104.83076652669027, 50.59667701976482, 124.96462237163595, 213.40520161759713, 70.13522502319768, 99.31666883718168, 111.88731495623715, 134.87548042592022, 39.0462948362164, 56.10000000000013, 58.28058169716882, 176.85996707561904, 200.04224895362748, 81.21854236150293, 81.78229636944663, 205.99782626208844, 121.90517533730582, 74.6893773677638, 52.35341304641867, 84.49569095479023, 73.75303514838072, 143.38222290417025, 76.82335159793617, 61.611814940179414, 205.31053931454352, 196.36729869762058, 98.53978676776306, 82.55008948388084], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-229.30995257672686, -33.104440298198114, -8.471508657169338, -26.535882947469695, 53.04102666271091, -56.07417450416695, -37.84568750334, 85.81705423646075, -146.27149753488806, -181.15681778072747, -34.36903684327174, -137.65099559156425, -87.6754076748512, 89.97196285614504, 37.377143687549726, 20.123508220240804, -81.05049130011936, -303.3113160305615, -24.8515038562956, -150.888799646551, -25.172089890846806, -28.227289445655643, -7.074946111357587, 21.158964647395575, -41.2762003244243, -94.43961580309538, -62.89130130753041, -91.87768879956212, -222.2765155179735, 36.80060586060443, 3.5714137179036967, -204.1359491249211, -258.8817504336413, 24.260256594815164, -125.08399913759138, -253.10961042198824, 69.05803972547822, -107.31820125064678, -304.7680684363954, 4.3053959416378715, -32.258833121728465, -5.529950963127913, 76.20707766605754, -185.2773069071387, 46.57649137988224, -13.555299204723122, -183.98098005908616, -52.42314277203363, -26.313250151478112, -52.46849050562005, -20.519341364637846, -13.371541173205458, -223.55611843046916, -224.619371453828, -62.9381562591374, -49.80235101426778, 120.81697570638771, -108.88567188970234, -83.16099148671647, -133.8777692010729, 110.79789336556254, -240.4358495012351, -158.86489079105547, -184.25653701427052, -84.55117311831074, 123.00102900033107, -83.49294708929948, -239.58978960361765, -67.87326688964463, -244.95736115599396, -71.19431293699009, -54.972747496176225, -90.03588277583674, 93.93265034684859, -78.96255158222871, -38.305569104939664, -42.394766671432464, 19.2712319247307, 0.3306497288089498, -157.16605400724058, -48.85219856614833, -150.38658107061443, -38.90578774281688, -116.07609013877526, -162.13062587065386, -199.51065189898043, -107.15988518693422, -75.69087705891117, -7.227166043966129, -94.34805428798592, -95.38525592411074, 88.16081671062243, 83.14361710483057, -143.52670783411315, -361.75844766048033, -58.78780006918957, -9.90807120654327, 137.47070144589355, -89.41501879741892, -192.9023328623847, -168.80763515169946, 73.71804328150267, -11.25969692151326, 158.57326479001253, -155.74605959927726, -135.48033120184402, 155.9, -93.68799300750784, 199.1, -181.813329022158, -61.54862976298648, -46.50803017990195, -89.02385952156315, -87.70024527851565, -67.93784714465822, -27.35108101060584, 5.241878062307075, -119.25576387397545, -427.39869154945296, -54.20256852890928, -21.970685584244656, -163.97006851400596, -48.62573085498825, -249.3629843804747, -51.1264409103066, -73.35011714126821, -11.837653137765884, -172.4541046289523, -31.052573017721954, -201.146843486211, 4.542380343639928, -243.41435614932368, 84.24249955831937, -106.35635488759978, -69.67665404815767, -176.57772946037272, -138.350883056899, -81.97782760198642, -176.54333519776844, -38.81927197172081, -271.3191077879183, -9.943319520188393, -78.16864453166136, -100.5290874080715, -189.16731723906514, -108.14531344553296, -92.45616056047223, -105.87745220206631, 30.54451980908774, -247.3034260677752, 87.60891597637868, -260.03068309131083, -62.88709627229866, 15.452401610999964, -193.8477616775366, -150.24665487119503, 5.267065028618476, 14.089579221975393, -55.368022833957745, 4.060342682208718, -106.84778756653414, -41.91937289764815, -128.21916136142636, -93.38408178438685, -5.645210527655699, -137.18093387210624, -22.742447337160417, -57.4927150338421, 15.380703451616853, 8.845135324064964, -0.9360050060422171, -208.14383867844467, -119.6100657167505, -118.24642481337521, 20.516997906923592, -119.4745100804226, -81.67160039441141, -22.961318933433894, -76.84342425369503, -23.22066635978894, -252.93118680184315, -8.908927333154397, -128.40279675131208, -47.17424639817999, -193.87840753737186, -72.21569636024782, -76.26535353748754, -95.93165209972781, -50.3881848624335, -84.497274180268, -10.14438530719473, -171.01316657774626, -241.10214856561598, 135.5428078057784, 40.84759272065511, -17.7020881670274, -188.43691355381722, -57.150992790419195, -189.76077395060264, -21.585806187017603], "policy_predator_policy_reward": [135.9314579220163, 186.39752538515708, 111.57150865716913, 73.9080182111097, 39.190228029369315, 72.27417450416667, 50.12133547396988, 55.27807312377978, 182.79109870531295, 186.06705126965295, 162.8114827850788, 191.01994231099746, 106.58990436747258, 87.68818354189753, 48.5232640285341, 13.644707306046108, 92.90975705498514, 312.41131603056147, 32.27950015308115, 201.6492095598725, 205.7645307966336, 33.82033622583263, 24.97494611135768, 50.54103535260446, 143.27604602868354, 107.31921747090837, 89.39130130752999, 130.56162294255617, 261.7776258022239, 68.91511269479675, 148.44172542149684, 187.08899961035132, 291.4992050887331, 120.8916561705349, 133.0458554623948, 320.30634926307283, 172.46227551492822, 184.89820131277818, 289.6219562222542, 106.64166957173103, 8.528411952517143, 67.90145004975138, 87.28194054247662, 189.90735987225284, 63.983425986769895, 54.19179230125816, 188.08937534937468, 103.26492933233806, 110.49275914646581, 88.3226975106139, 88.86632461249722, 135.18955943368834, 260.956118430469, 252.01937145382786, 125.06619760054042, 85.8098068890632, 53.344060014699885, 95.49731831829342, 160.96772372237734, 149.77216940534856, 97.71734814587975, 187.58855383815853, 217.91745910204418, 168.61344670812414, 87.04279618081861, 26.155051379790482, 249.51639265331582, 202.38745262442765, 95.65507724303178, 318.7633521423068, 212.01567237854567, 69.1094709496793, 104.05676352159975, 62.682908454898964, 154.1099241519862, 42.09004418423171, 143.95218706027273, 159.59199428146883, 87.60501448969593, 187.2359676057566, 177.10943219482866, 188.62546949936782, 56.40578774281711, 126.17609013877468, 183.6836262917669, 203.2973359130625, 203.61708016356044, 68.54370851572266, 203.10195674615278, 147.65816247269325, 29.03679993185101, 141.69126396914288, 134.90042659516493, 170.3617824964853, 340.4287842263394, 171.34053428825757, 50.552000800954666, 122.88483857632585, 96.79561959305006, 212.3090218690367, 183.27149036315487, 69.84585439159774, 33.75827776723963, 90.0422896954412, 311.647598735729, 74.46137217584408, 56.71150381631165, 66.81266551435914, 115.38833260544293, 124.52509715131261, 39.72423127552931, 224.31914765210732, 266.4327784583447, 69.37112636799363, 113.98970693964961, 91.99618559132956, 128.5494611850689, 23.73410257432797, 377.1644315579748, 215.04321854971252, 83.48170155154781, 152.84299028515713, 232.91584666195212, 222.31021406212312, 62.09857600110841, 202.28267512649356, 104.6858241997099, 170.32047388066104, 106.26493825779004, 217.44968836450036, 153.91161082694134, 182.8429823568347, 103.04454568299897, 90.03849444133769, 144.62806830787574, 196.0694093675717, 190.75584046439602, 84.2958451223971, 89.79787604519734, 193.04053971488122, 198.26098664579007, 173.5468002132935, 99.2941132811922, 155.61932320714993, 238.9876723759921, 163.15572483529635, 88.38649472672215, 160.54379505558035, 217.15673278684648, 124.56679584347734, 294.10194326658814, 91.72502546594144, 35.54289404420376, 82.02702564029265, 224.3823382337233, 219.0287471521897, 5.564007486241742, 86.96666321940242, 84.01278433109444, 102.17037624657496, 82.07166644716632, 105.74178885323147, 162.4789216849198, 115.22432146089292, 25.325792224824305, 175.78093387210615, 69.05525560714615, 188.03987383947575, 48.0091347892941, 127.80727538865187, 162.34214993400178, 127.95623611198809, 152.33011457983682, 167.30867231973536, 68.04926240180086, 236.90607603378675, 163.17473714027955, 63.36335752487182, 90.2663008462145, 84.48716713503322, 153.85554729892837, 160.3379798824877, 99.58932634303291, 160.4834077612483, 206.33886260565617, 133.50827644034393, 159.3163261935329, 156.26290234785276, 77.62050644840745, 134.08830419223, 52.09921629347148, 190.67015053164855, 162.3013881234266, 148.56849195095432, 107.3727762846095, 65.84901785938368, 189.33175533294337, 154.79593777905592, 141.9429649453271, 151.95370467617371]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.393918724635901, "mean_inference_ms": 3.867476173840851, "mean_action_processing_ms": 1.8181886909450666, "mean_env_wait_ms": 10.207264997965042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061904191970825195, "StateBufferConnector_ms": 0.004296422004699707, "ViewRequirementAgentConnector_ms": 0.12326908111572266}, "num_episodes": 15, "episode_return_max": 319.10031530253775, "episode_return_min": 20.959265754866493, "episode_return_mean": 122.09339025036368, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.5396905864989, "num_env_steps_trained_throughput_per_sec": 84.5396905864989, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 47414.243, "restore_workers_time_ms": 0.016, "training_step_time_ms": 47414.197, "sample_time_ms": 2140.314, "learn_time_ms": 45259.831, "learn_throughput": 88.379, "synch_weights_time_ms": 12.07}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-50-32", "timestamp": 1724149232, "time_this_iter_s": 47.38116717338562, "time_total_s": 1799.671790599823, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120023d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1799.671790599823, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 25.246268656716417, "ram_util_percent": 82.6044776119403}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.67541255868932, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.22112615978907, "policy_loss": -0.016656236490727495, "vf_loss": 7.235841203618933, "vf_explained_var": 0.2302979084865126, "kl": 0.009705990842339045, "entropy": 0.879471065001513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9935781727392206, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.377298691663793, "policy_loss": -0.015049845346116595, "vf_loss": 5.390347941968807, "vf_explained_var": 0.13041124791695327, "kl": 0.010003039236648609, "entropy": 0.8654878868943169, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 351.13787432794516, "episode_reward_min": 25.339684435195636, "episode_reward_mean": 124.17811057711751, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -427.39869154945296, "predator_policy": 5.564007486241742}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 377.1644315579748}, "policy_reward_mean": {"prey_policy": -77.24694897943289, "predator_policy": 139.33600426799163}, "custom_metrics": {}, "hist_stats": {"episode_reward": [168.11907117364822, 151.19641046318654, 54.95018185059339, 120.03371599998164, 190.16500150834196, 64.80000000000014, 98.13549721619849, 160.77268214967876, 93.70113243993637, 155.66794584836572, 43.40947800484324, 151.64770344262922, 128.8211085848257, 101.58780133969984, 154.95808289505862, 170.63643954751, 78.93184764904967, 280.42064659503967, 118.00557781702084, 166.49612205743375, 27.600000000000122, 25.339684435195636, 89.31002643343788, 249.18489888689408, 163.5036246875056, 244.87911836236768, 91.22307078492723, 300.9994696166308, 26.787289802284022, 158.0277528845558, 271.11413533118036, 94.88258011045184, 185.73617632316285, 257.20010073459764, 155.98671898474814, 159.07980002625973, 110.69696437571505, 38.269677947728745, 110.60639002932474, 50.383937738454975, 157.2373454886124, 139.9046930760272, 90.71454031365245, 91.51521011835698, 97.8826173780923, 170.96918479505615, 94.44309416691715, 54.72297492790834, 67.47580859058914, 90.54535955097685, 76.21570454861022, 104.83076652669027, 50.59667701976482, 124.96462237163595, 213.40520161759713, 70.13522502319768, 99.31666883718168, 111.88731495623715, 134.87548042592022, 39.0462948362164, 56.10000000000013, 58.28058169716882, 176.85996707561904, 200.04224895362748, 81.21854236150293, 81.78229636944663, 205.99782626208844, 121.90517533730582, 74.6893773677638, 52.35341304641867, 84.49569095479023, 73.75303514838072, 143.38222290417025, 76.82335159793617, 61.611814940179414, 205.31053931454352, 196.36729869762058, 98.53978676776306, 82.55008948388084, 96.22387637002961, 55.000000000000114, 66.80920878642172, 104.05105389436852, 40.89285429353268, 111.86324133144866, 233.69276546569054, 25.506264798013213, 214.71684251476952, 329.3695574550838, 70.8148841597472, 100.9301711275794, 123.98514383588643, 124.09999999999911, 351.13787432794516, 115.56635610885951, 188.12058538800767, 98.82287041878108, 100.83623578066403, 49.3553647270137, 139.99999999999903], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [76.20707766605754, -185.2773069071387, 46.57649137988224, -13.555299204723122, -183.98098005908616, -52.42314277203363, -26.313250151478112, -52.46849050562005, -20.519341364637846, -13.371541173205458, -223.55611843046916, -224.619371453828, -62.9381562591374, -49.80235101426778, 120.81697570638771, -108.88567188970234, -83.16099148671647, -133.8777692010729, 110.79789336556254, -240.4358495012351, -158.86489079105547, -184.25653701427052, -84.55117311831074, 123.00102900033107, -83.49294708929948, -239.58978960361765, -67.87326688964463, -244.95736115599396, -71.19431293699009, -54.972747496176225, -90.03588277583674, 93.93265034684859, -78.96255158222871, -38.305569104939664, -42.394766671432464, 19.2712319247307, 0.3306497288089498, -157.16605400724058, -48.85219856614833, -150.38658107061443, -38.90578774281688, -116.07609013877526, -162.13062587065386, -199.51065189898043, -107.15988518693422, -75.69087705891117, -7.227166043966129, -94.34805428798592, -95.38525592411074, 88.16081671062243, 83.14361710483057, -143.52670783411315, -361.75844766048033, -58.78780006918957, -9.90807120654327, 137.47070144589355, -89.41501879741892, -192.9023328623847, -168.80763515169946, 73.71804328150267, -11.25969692151326, 158.57326479001253, -155.74605959927726, -135.48033120184402, 155.9, -93.68799300750784, 199.1, -181.813329022158, -61.54862976298648, -46.50803017990195, -89.02385952156315, -87.70024527851565, -67.93784714465822, -27.35108101060584, 5.241878062307075, -119.25576387397545, -427.39869154945296, -54.20256852890928, -21.970685584244656, -163.97006851400596, -48.62573085498825, -249.3629843804747, -51.1264409103066, -73.35011714126821, -11.837653137765884, -172.4541046289523, -31.052573017721954, -201.146843486211, 4.542380343639928, -243.41435614932368, 84.24249955831937, -106.35635488759978, -69.67665404815767, -176.57772946037272, -138.350883056899, -81.97782760198642, -176.54333519776844, -38.81927197172081, -271.3191077879183, -9.943319520188393, -78.16864453166136, -100.5290874080715, -189.16731723906514, -108.14531344553296, -92.45616056047223, -105.87745220206631, 30.54451980908774, -247.3034260677752, 87.60891597637868, -260.03068309131083, -62.88709627229866, 15.452401610999964, -193.8477616775366, -150.24665487119503, 5.267065028618476, 14.089579221975393, -55.368022833957745, 4.060342682208718, -106.84778756653414, -41.91937289764815, -128.21916136142636, -93.38408178438685, -5.645210527655699, -137.18093387210624, -22.742447337160417, -57.4927150338421, 15.380703451616853, 8.845135324064964, -0.9360050060422171, -208.14383867844467, -119.6100657167505, -118.24642481337521, 20.516997906923592, -119.4745100804226, -81.67160039441141, -22.961318933433894, -76.84342425369503, -23.22066635978894, -252.93118680184315, -8.908927333154397, -128.40279675131208, -47.17424639817999, -193.87840753737186, -72.21569636024782, -76.26535353748754, -95.93165209972781, -50.3881848624335, -84.497274180268, -10.14438530719473, -171.01316657774626, -241.10214856561598, 135.5428078057784, 40.84759272065511, -17.7020881670274, -188.43691355381722, -57.150992790419195, -189.76077395060264, -21.585806187017603, -141.82797202917288, -117.32487229647221, -64.18652081313711, -95.15407623625883, -23.035812790660554, -111.19561664611236, -50.45238120909797, -69.76480484234224, -222.3762171003055, -295.5509422907671, -244.49888891978725, 22.170745362382448, 76.7315302089842, -150.52799859320197, -108.17463803950947, -219.58783625280503, 178.3337449992203, -36.22111285098544, 2.421481795685253, 172.63239615958616, -100.96252352097895, -202.61614002290176, -141.07296058677636, -222.90981453902313, -233.1472952574591, -90.52945224476251, 45.15911097996781, -91.79331817686638, 200.0, 0.2591508284675754, -87.33589562922597, -0.9084629623585245, 110.5480692894219, -283.9787004935191, -16.488669728119675, -201.57960364551263, -151.9611457397685, -81.60156308764859, -147.73885279290724, -43.86997753244139, -25.204822779201066, 62.179624889144804], "policy_predator_policy_reward": [87.28194054247662, 189.90735987225284, 63.983425986769895, 54.19179230125816, 188.08937534937468, 103.26492933233806, 110.49275914646581, 88.3226975106139, 88.86632461249722, 135.18955943368834, 260.956118430469, 252.01937145382786, 125.06619760054042, 85.8098068890632, 53.344060014699885, 95.49731831829342, 160.96772372237734, 149.77216940534856, 97.71734814587975, 187.58855383815853, 217.91745910204418, 168.61344670812414, 87.04279618081861, 26.155051379790482, 249.51639265331582, 202.38745262442765, 95.65507724303178, 318.7633521423068, 212.01567237854567, 69.1094709496793, 104.05676352159975, 62.682908454898964, 154.1099241519862, 42.09004418423171, 143.95218706027273, 159.59199428146883, 87.60501448969593, 187.2359676057566, 177.10943219482866, 188.62546949936782, 56.40578774281711, 126.17609013877468, 183.6836262917669, 203.2973359130625, 203.61708016356044, 68.54370851572266, 203.10195674615278, 147.65816247269325, 29.03679993185101, 141.69126396914288, 134.90042659516493, 170.3617824964853, 340.4287842263394, 171.34053428825757, 50.552000800954666, 122.88483857632585, 96.79561959305006, 212.3090218690367, 183.27149036315487, 69.84585439159774, 33.75827776723963, 90.0422896954412, 311.647598735729, 74.46137217584408, 56.71150381631165, 66.81266551435914, 115.38833260544293, 124.52509715131261, 39.72423127552931, 224.31914765210732, 266.4327784583447, 69.37112636799363, 113.98970693964961, 91.99618559132956, 128.5494611850689, 23.73410257432797, 377.1644315579748, 215.04321854971252, 83.48170155154781, 152.84299028515713, 232.91584666195212, 222.31021406212312, 62.09857600110841, 202.28267512649356, 104.6858241997099, 170.32047388066104, 106.26493825779004, 217.44968836450036, 153.91161082694134, 182.8429823568347, 103.04454568299897, 90.03849444133769, 144.62806830787574, 196.0694093675717, 190.75584046439602, 84.2958451223971, 89.79787604519734, 193.04053971488122, 198.26098664579007, 173.5468002132935, 99.2941132811922, 155.61932320714993, 238.9876723759921, 163.15572483529635, 88.38649472672215, 160.54379505558035, 217.15673278684648, 124.56679584347734, 294.10194326658814, 91.72502546594144, 35.54289404420376, 82.02702564029265, 224.3823382337233, 219.0287471521897, 5.564007486241742, 86.96666321940242, 84.01278433109444, 102.17037624657496, 82.07166644716632, 105.74178885323147, 162.4789216849198, 115.22432146089292, 25.325792224824305, 175.78093387210615, 69.05525560714615, 188.03987383947575, 48.0091347892941, 127.80727538865187, 162.34214993400178, 127.95623611198809, 152.33011457983682, 167.30867231973536, 68.04926240180086, 236.90607603378675, 163.17473714027955, 63.36335752487182, 90.2663008462145, 84.48716713503322, 153.85554729892837, 160.3379798824877, 99.58932634303291, 160.4834077612483, 206.33886260565617, 133.50827644034393, 159.3163261935329, 156.26290234785276, 77.62050644840745, 134.08830419223, 52.09921629347148, 190.67015053164855, 162.3013881234266, 148.56849195095432, 107.3727762846095, 65.84901785938368, 189.33175533294337, 154.79593777905592, 141.9429649453271, 151.95370467617371, 232.15970875410207, 123.21701194157238, 61.80529101572234, 152.5353060336729, 58.18060550526477, 142.86003271792987, 169.15630650593107, 55.11193343987732, 237.62388629366998, 321.196127390935, 152.05875624038433, 182.13262864846948, 122.40251486716366, 185.0867189827448, 196.46384018373155, 156.80489890659572, 15.962960155532656, 56.64125021100293, 116.61494216024963, 37.70073733956276, 162.25330256054906, 212.14024514307815, 190.85010777833318, 274.0628384750455, 202.85964202375524, 244.80224931435288, 40.84088902003229, 129.89331817686582, 39.38408735395095, 111.4946361455266, 57.346033208747, 146.46468149169723, 156.4319215344483, 205.11929505765676, 167.56643635746863, 149.32470743494443, 72.59294317735943, 261.80600143072184, 104.11172770636924, 136.85246734599264, 92.30482277920056, 10.720375110855354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.391422447321469, "mean_inference_ms": 3.847603342829332, "mean_action_processing_ms": 1.7947283740027649, "mean_env_wait_ms": 10.188693965469549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048542022705078125, "StateBufferConnector_ms": 0.005177021026611328, "ViewRequirementAgentConnector_ms": 0.14135420322418213}, "num_episodes": 21, "episode_return_max": 351.13787432794516, "episode_return_min": 25.339684435195636, "episode_return_mean": 124.17811057711751, "episodes_this_iter": 21}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.48903089967366, "num_env_steps_trained_throughput_per_sec": 84.48903089967366, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 47448.194, "restore_workers_time_ms": 0.015, "training_step_time_ms": 47448.15, "sample_time_ms": 2142.447, "learn_time_ms": 45290.586, "learn_throughput": 88.319, "synch_weights_time_ms": 12.892}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-51-19", "timestamp": 1724149279, "time_this_iter_s": 47.39024376869202, "time_total_s": 1847.062034368515, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12002d9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1847.062034368515, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 28.335294117647063, "ram_util_percent": 82.73970588235295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.714750553943492, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.200598316091709, "policy_loss": -0.01672725444869015, "vf_loss": 7.215173127411535, "vf_explained_var": 0.3311260058450951, "kl": 0.010762244369834662, "entropy": 0.9056903505136096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 997.4199999999983}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.977566604261045, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.905146666935512, "policy_loss": -0.014741458700447485, "vf_loss": 4.918052338796949, "vf_explained_var": 0.17266949027303666, "kl": 0.009178964498516901, "entropy": 0.9283895874464954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 997.4199999999983}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 351.13787432794516, "episode_reward_min": 25.339684435195636, "episode_reward_mean": 124.21762470757598, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -427.39869154945296, "predator_policy": 5.564007486241742}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 377.1644315579748}, "policy_reward_mean": {"prey_policy": -72.04300299182925, "predator_policy": 134.1518153456172}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.339684435195636, 89.31002643343788, 249.18489888689408, 163.5036246875056, 244.87911836236768, 91.22307078492723, 300.9994696166308, 26.787289802284022, 158.0277528845558, 271.11413533118036, 94.88258011045184, 185.73617632316285, 257.20010073459764, 155.98671898474814, 159.07980002625973, 110.69696437571505, 38.269677947728745, 110.60639002932474, 50.383937738454975, 157.2373454886124, 139.9046930760272, 90.71454031365245, 91.51521011835698, 97.8826173780923, 170.96918479505615, 94.44309416691715, 54.72297492790834, 67.47580859058914, 90.54535955097685, 76.21570454861022, 104.83076652669027, 50.59667701976482, 124.96462237163595, 213.40520161759713, 70.13522502319768, 99.31666883718168, 111.88731495623715, 134.87548042592022, 39.0462948362164, 56.10000000000013, 58.28058169716882, 176.85996707561904, 200.04224895362748, 81.21854236150293, 81.78229636944663, 205.99782626208844, 121.90517533730582, 74.6893773677638, 52.35341304641867, 84.49569095479023, 73.75303514838072, 143.38222290417025, 76.82335159793617, 61.611814940179414, 205.31053931454352, 196.36729869762058, 98.53978676776306, 82.55008948388084, 96.22387637002961, 55.000000000000114, 66.80920878642172, 104.05105389436852, 40.89285429353268, 111.86324133144866, 233.69276546569054, 25.506264798013213, 214.71684251476952, 329.3695574550838, 70.8148841597472, 100.9301711275794, 123.98514383588643, 124.09999999999911, 351.13787432794516, 115.56635610885951, 188.12058538800767, 98.82287041878108, 100.83623578066403, 49.3553647270137, 139.99999999999903, 187.70441656154944, 70.99204865520298, 36.517477614835485, 213.39999999999984, 137.68572997613668, 50.0531902095933, 154.56615538925854, 151.4100478176148, 101.5550801162043, 169.38758305225323, 110.56003828387836, 33.80328773878792, 54.875020944365566, 154.93489683030253, 173.21584400598252, 209.8170134918284, 98.222904257788, 86.69999999999978, 132.87308608280944, 166.6791236676807, 189.05491493281545], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-162.13062587065386, -199.51065189898043, -107.15988518693422, -75.69087705891117, -7.227166043966129, -94.34805428798592, -95.38525592411074, 88.16081671062243, 83.14361710483057, -143.52670783411315, -361.75844766048033, -58.78780006918957, -9.90807120654327, 137.47070144589355, -89.41501879741892, -192.9023328623847, -168.80763515169946, 73.71804328150267, -11.25969692151326, 158.57326479001253, -155.74605959927726, -135.48033120184402, 155.9, -93.68799300750784, 199.1, -181.813329022158, -61.54862976298648, -46.50803017990195, -89.02385952156315, -87.70024527851565, -67.93784714465822, -27.35108101060584, 5.241878062307075, -119.25576387397545, -427.39869154945296, -54.20256852890928, -21.970685584244656, -163.97006851400596, -48.62573085498825, -249.3629843804747, -51.1264409103066, -73.35011714126821, -11.837653137765884, -172.4541046289523, -31.052573017721954, -201.146843486211, 4.542380343639928, -243.41435614932368, 84.24249955831937, -106.35635488759978, -69.67665404815767, -176.57772946037272, -138.350883056899, -81.97782760198642, -176.54333519776844, -38.81927197172081, -271.3191077879183, -9.943319520188393, -78.16864453166136, -100.5290874080715, -189.16731723906514, -108.14531344553296, -92.45616056047223, -105.87745220206631, 30.54451980908774, -247.3034260677752, 87.60891597637868, -260.03068309131083, -62.88709627229866, 15.452401610999964, -193.8477616775366, -150.24665487119503, 5.267065028618476, 14.089579221975393, -55.368022833957745, 4.060342682208718, -106.84778756653414, -41.91937289764815, -128.21916136142636, -93.38408178438685, -5.645210527655699, -137.18093387210624, -22.742447337160417, -57.4927150338421, 15.380703451616853, 8.845135324064964, -0.9360050060422171, -208.14383867844467, -119.6100657167505, -118.24642481337521, 20.516997906923592, -119.4745100804226, -81.67160039441141, -22.961318933433894, -76.84342425369503, -23.22066635978894, -252.93118680184315, -8.908927333154397, -128.40279675131208, -47.17424639817999, -193.87840753737186, -72.21569636024782, -76.26535353748754, -95.93165209972781, -50.3881848624335, -84.497274180268, -10.14438530719473, -171.01316657774626, -241.10214856561598, 135.5428078057784, 40.84759272065511, -17.7020881670274, -188.43691355381722, -57.150992790419195, -189.76077395060264, -21.585806187017603, -141.82797202917288, -117.32487229647221, -64.18652081313711, -95.15407623625883, -23.035812790660554, -111.19561664611236, -50.45238120909797, -69.76480484234224, -222.3762171003055, -295.5509422907671, -244.49888891978725, 22.170745362382448, 76.7315302089842, -150.52799859320197, -108.17463803950947, -219.58783625280503, 178.3337449992203, -36.22111285098544, 2.421481795685253, 172.63239615958616, -100.96252352097895, -202.61614002290176, -141.07296058677636, -222.90981453902313, -233.1472952574591, -90.52945224476251, 45.15911097996781, -91.79331817686638, 200.0, 0.2591508284675754, -87.33589562922597, -0.9084629623585245, 110.5480692894219, -283.9787004935191, -16.488669728119675, -201.57960364551263, -151.9611457397685, -81.60156308764859, -147.73885279290724, -43.86997753244139, -25.204822779201066, 62.179624889144804, -181.14823295208996, 152.05770968263374, -136.322246347064, -5.924855684772597, -60.42778028153805, -161.1900878523939, 129.57420612591966, -74.29170219574905, 9.112017544239677, -243.35287476982455, -132.19143927291236, -54.95977981700808, -12.334272937925284, -133.761268644452, 83.10781382135728, -0.162166074196422, 23.723309297064993, -194.51761306998392, 71.1897695935111, 1.862069827509136, -113.27843415095045, -125.81932315272158, -31.102007381397378, -66.54393757638226, -191.18387674511257, -38.16129746399027, -48.48718662535246, -101.41777376901646, 123.68968838109126, -34.91873949305211, -115.73171194247712, 123.53903488680325, -10.626650896523103, -29.622583144531042, -0.5789220817407804, -181.29339355817382, -216.41258177224245, 73.7696178968052, 21.201421185592565, -25.537102838006025, -87.21484185587211, 1.3870836145157526], "policy_predator_policy_reward": [183.6836262917669, 203.2973359130625, 203.61708016356044, 68.54370851572266, 203.10195674615278, 147.65816247269325, 29.03679993185101, 141.69126396914288, 134.90042659516493, 170.3617824964853, 340.4287842263394, 171.34053428825757, 50.552000800954666, 122.88483857632585, 96.79561959305006, 212.3090218690367, 183.27149036315487, 69.84585439159774, 33.75827776723963, 90.0422896954412, 311.647598735729, 74.46137217584408, 56.71150381631165, 66.81266551435914, 115.38833260544293, 124.52509715131261, 39.72423127552931, 224.31914765210732, 266.4327784583447, 69.37112636799363, 113.98970693964961, 91.99618559132956, 128.5494611850689, 23.73410257432797, 377.1644315579748, 215.04321854971252, 83.48170155154781, 152.84299028515713, 232.91584666195212, 222.31021406212312, 62.09857600110841, 202.28267512649356, 104.6858241997099, 170.32047388066104, 106.26493825779004, 217.44968836450036, 153.91161082694134, 182.8429823568347, 103.04454568299897, 90.03849444133769, 144.62806830787574, 196.0694093675717, 190.75584046439602, 84.2958451223971, 89.79787604519734, 193.04053971488122, 198.26098664579007, 173.5468002132935, 99.2941132811922, 155.61932320714993, 238.9876723759921, 163.15572483529635, 88.38649472672215, 160.54379505558035, 217.15673278684648, 124.56679584347734, 294.10194326658814, 91.72502546594144, 35.54289404420376, 82.02702564029265, 224.3823382337233, 219.0287471521897, 5.564007486241742, 86.96666321940242, 84.01278433109444, 102.17037624657496, 82.07166644716632, 105.74178885323147, 162.4789216849198, 115.22432146089292, 25.325792224824305, 175.78093387210615, 69.05525560714615, 188.03987383947575, 48.0091347892941, 127.80727538865187, 162.34214993400178, 127.95623611198809, 152.33011457983682, 167.30867231973536, 68.04926240180086, 236.90607603378675, 163.17473714027955, 63.36335752487182, 90.2663008462145, 84.48716713503322, 153.85554729892837, 160.3379798824877, 99.58932634303291, 160.4834077612483, 206.33886260565617, 133.50827644034393, 159.3163261935329, 156.26290234785276, 77.62050644840745, 134.08830419223, 52.09921629347148, 190.67015053164855, 162.3013881234266, 148.56849195095432, 107.3727762846095, 65.84901785938368, 189.33175533294337, 154.79593777905592, 141.9429649453271, 151.95370467617371, 232.15970875410207, 123.21701194157238, 61.80529101572234, 152.5353060336729, 58.18060550526477, 142.86003271792987, 169.15630650593107, 55.11193343987732, 237.62388629366998, 321.196127390935, 152.05875624038433, 182.13262864846948, 122.40251486716366, 185.0867189827448, 196.46384018373155, 156.80489890659572, 15.962960155532656, 56.64125021100293, 116.61494216024963, 37.70073733956276, 162.25330256054906, 212.14024514307815, 190.85010777833318, 274.0628384750455, 202.85964202375524, 244.80224931435288, 40.84088902003229, 129.89331817686582, 39.38408735395095, 111.4946361455266, 57.346033208747, 146.46468149169723, 156.4319215344483, 205.11929505765676, 167.56643635746863, 149.32470743494443, 72.59294317735943, 261.80600143072184, 104.11172770636924, 136.85246734599264, 92.30482277920056, 10.720375110855354, 196.91454331690434, 19.880396514101168, 73.31072391359294, 139.92842677344612, 132.5991105468613, 125.5362352019052, 7.625793874080248, 150.49170219574893, 159.7099006260419, 212.21668657567943, 157.97987504818437, 79.22453425132869, 99.85272900294716, 200.8089679686889, 32.17310634490747, 36.29129372554688, 42.76036555586652, 229.58901833325652, 72.85206529181583, 23.483678339417583, 234.48968570531994, 115.16810988223027, 49.70529512018533, 81.7439375763814, 72.6942444226909, 211.5259507307773, 174.25241209057648, 130.58744513409493, 29.731507349447796, 54.71338776849634, 113.3035090114481, 88.70618153605415, 34.23103678534683, 104.2411015134955, 77.47892208174078, 191.09339355817323, 231.24015253408447, 44.27589742416255, 132.07948964008722, 38.935315680007434, 190.4030411320121, 84.47963204215986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.368202917818575, "mean_inference_ms": 3.8331375984951985, "mean_action_processing_ms": 1.7890430058008298, "mean_env_wait_ms": 10.162273498455255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004880189895629883, "StateBufferConnector_ms": 0.005414247512817383, "ViewRequirementAgentConnector_ms": 0.14347398281097412}, "num_episodes": 21, "episode_return_max": 351.13787432794516, "episode_return_min": 25.339684435195636, "episode_return_mean": 124.21762470757598, "episodes_this_iter": 21}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.19673564370042, "num_env_steps_trained_throughput_per_sec": 84.19673564370042, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 47502.566, "restore_workers_time_ms": 0.015, "training_step_time_ms": 47502.521, "sample_time_ms": 2139.647, "learn_time_ms": 45347.371, "learn_throughput": 88.208, "synch_weights_time_ms": 13.005}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-52-07", "timestamp": 1724149327, "time_this_iter_s": 47.55295276641846, "time_total_s": 1894.6149871349335, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33133bf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1894.6149871349335, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 26.24477611940298, "ram_util_percent": 82.56417910447762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.076906526025642, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.396257628839483, "policy_loss": -0.017938020419595496, "vf_loss": 7.411905753675592, "vf_explained_var": 0.25161491790145796, "kl": 0.011449556251761145, "entropy": 0.8676292332707258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 997.4199999999983}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.263972228670877, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.966060155661649, "policy_loss": -0.013346733040393148, "vf_loss": 4.977288700790002, "vf_explained_var": 0.2025155249411467, "kl": 0.010590865623043288, "entropy": 0.8799502367380435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 997.4199999999983}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 351.13787432794516, "episode_reward_min": 25.506264798013213, "episode_reward_mean": 119.74271438836271, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -295.5509422907671, "predator_policy": 5.564007486241742}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 321.196127390935}, "policy_reward_mean": {"prey_policy": -71.16027858952062, "predator_policy": 131.03163578370194}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.51521011835698, 97.8826173780923, 170.96918479505615, 94.44309416691715, 54.72297492790834, 67.47580859058914, 90.54535955097685, 76.21570454861022, 104.83076652669027, 50.59667701976482, 124.96462237163595, 213.40520161759713, 70.13522502319768, 99.31666883718168, 111.88731495623715, 134.87548042592022, 39.0462948362164, 56.10000000000013, 58.28058169716882, 176.85996707561904, 200.04224895362748, 81.21854236150293, 81.78229636944663, 205.99782626208844, 121.90517533730582, 74.6893773677638, 52.35341304641867, 84.49569095479023, 73.75303514838072, 143.38222290417025, 76.82335159793617, 61.611814940179414, 205.31053931454352, 196.36729869762058, 98.53978676776306, 82.55008948388084, 96.22387637002961, 55.000000000000114, 66.80920878642172, 104.05105389436852, 40.89285429353268, 111.86324133144866, 233.69276546569054, 25.506264798013213, 214.71684251476952, 329.3695574550838, 70.8148841597472, 100.9301711275794, 123.98514383588643, 124.09999999999911, 351.13787432794516, 115.56635610885951, 188.12058538800767, 98.82287041878108, 100.83623578066403, 49.3553647270137, 139.99999999999903, 187.70441656154944, 70.99204865520298, 36.517477614835485, 213.39999999999984, 137.68572997613668, 50.0531902095933, 154.56615538925854, 151.4100478176148, 101.5550801162043, 169.38758305225323, 110.56003828387836, 33.80328773878792, 54.875020944365566, 154.93489683030253, 173.21584400598252, 209.8170134918284, 98.222904257788, 86.69999999999978, 132.87308608280944, 166.6791236676807, 189.05491493281545, 222.40000000000006, 162.0279001685851, 132.66629312223836, 92.87101641188161, 96.5438225527136, 107.86385174974328, 106.77104736038041, 243.13961899546152, 119.45811964003809, 116.05612420610342, 144.16495340444746, 64.50283567553157, 169.91915437341373, 66.95073803637106, 110.77009671318166, 58.886119238336214, 217.85066585733605, 153.98586304994728, 44.781584095995505, 170.5221381096063, 83.81881623930408, 37.62620545177101], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-31.052573017721954, -201.146843486211, 4.542380343639928, -243.41435614932368, 84.24249955831937, -106.35635488759978, -69.67665404815767, -176.57772946037272, -138.350883056899, -81.97782760198642, -176.54333519776844, -38.81927197172081, -271.3191077879183, -9.943319520188393, -78.16864453166136, -100.5290874080715, -189.16731723906514, -108.14531344553296, -92.45616056047223, -105.87745220206631, 30.54451980908774, -247.3034260677752, 87.60891597637868, -260.03068309131083, -62.88709627229866, 15.452401610999964, -193.8477616775366, -150.24665487119503, 5.267065028618476, 14.089579221975393, -55.368022833957745, 4.060342682208718, -106.84778756653414, -41.91937289764815, -128.21916136142636, -93.38408178438685, -5.645210527655699, -137.18093387210624, -22.742447337160417, -57.4927150338421, 15.380703451616853, 8.845135324064964, -0.9360050060422171, -208.14383867844467, -119.6100657167505, -118.24642481337521, 20.516997906923592, -119.4745100804226, -81.67160039441141, -22.961318933433894, -76.84342425369503, -23.22066635978894, -252.93118680184315, -8.908927333154397, -128.40279675131208, -47.17424639817999, -193.87840753737186, -72.21569636024782, -76.26535353748754, -95.93165209972781, -50.3881848624335, -84.497274180268, -10.14438530719473, -171.01316657774626, -241.10214856561598, 135.5428078057784, 40.84759272065511, -17.7020881670274, -188.43691355381722, -57.150992790419195, -189.76077395060264, -21.585806187017603, -141.82797202917288, -117.32487229647221, -64.18652081313711, -95.15407623625883, -23.035812790660554, -111.19561664611236, -50.45238120909797, -69.76480484234224, -222.3762171003055, -295.5509422907671, -244.49888891978725, 22.170745362382448, 76.7315302089842, -150.52799859320197, -108.17463803950947, -219.58783625280503, 178.3337449992203, -36.22111285098544, 2.421481795685253, 172.63239615958616, -100.96252352097895, -202.61614002290176, -141.07296058677636, -222.90981453902313, -233.1472952574591, -90.52945224476251, 45.15911097996781, -91.79331817686638, 200.0, 0.2591508284675754, -87.33589562922597, -0.9084629623585245, 110.5480692894219, -283.9787004935191, -16.488669728119675, -201.57960364551263, -151.9611457397685, -81.60156308764859, -147.73885279290724, -43.86997753244139, -25.204822779201066, 62.179624889144804, -181.14823295208996, 152.05770968263374, -136.322246347064, -5.924855684772597, -60.42778028153805, -161.1900878523939, 129.57420612591966, -74.29170219574905, 9.112017544239677, -243.35287476982455, -132.19143927291236, -54.95977981700808, -12.334272937925284, -133.761268644452, 83.10781382135728, -0.162166074196422, 23.723309297064993, -194.51761306998392, 71.1897695935111, 1.862069827509136, -113.27843415095045, -125.81932315272158, -31.102007381397378, -66.54393757638226, -191.18387674511257, -38.16129746399027, -48.48718662535246, -101.41777376901646, 123.68968838109126, -34.91873949305211, -115.73171194247712, 123.53903488680325, -10.626650896523103, -29.622583144531042, -0.5789220817407804, -181.29339355817382, -216.41258177224245, 73.7696178968052, 21.201421185592565, -25.537102838006025, -87.21484185587211, 1.3870836145157526, 41.24502530143356, 32.48043193790526, 75.19055216681762, -79.45111511089115, -53.29181083324606, -154.5437122355718, -59.862094513064235, -101.09375960589585, 7.302412546138825, -254.63527699424912, -69.8497308061377, 2.900456448188501, -9.32012435098882, -12.612400024495233, 164.17224482368098, -131.62883129665826, -4.035011676204718, -229.44973006214735, -15.062067464223048, -167.66421463993723, -120.16078037869846, -148.17990857870078, -151.602029949639, -157.512426827885, -254.17548741400896, 79.26722870776408, -110.51585644054813, -268.6054455930396, -85.64295205410572, -31.666893058394038, -94.0403055110906, 1.8822875207715104, 189.0151409057376, -9.527198574395607, 71.04455468345955, 0.6347280463979882, -75.26417682106309, -115.63143618328925, 61.10089523247313, -106.66295535559826, -258.2356842622904, -104.81695220478437, -269.4583399634077, -62.35448928747177], "policy_predator_policy_reward": [106.26493825779004, 217.44968836450036, 153.91161082694134, 182.8429823568347, 103.04454568299897, 90.03849444133769, 144.62806830787574, 196.0694093675717, 190.75584046439602, 84.2958451223971, 89.79787604519734, 193.04053971488122, 198.26098664579007, 173.5468002132935, 99.2941132811922, 155.61932320714993, 238.9876723759921, 163.15572483529635, 88.38649472672215, 160.54379505558035, 217.15673278684648, 124.56679584347734, 294.10194326658814, 91.72502546594144, 35.54289404420376, 82.02702564029265, 224.3823382337233, 219.0287471521897, 5.564007486241742, 86.96666321940242, 84.01278433109444, 102.17037624657496, 82.07166644716632, 105.74178885323147, 162.4789216849198, 115.22432146089292, 25.325792224824305, 175.78093387210615, 69.05525560714615, 188.03987383947575, 48.0091347892941, 127.80727538865187, 162.34214993400178, 127.95623611198809, 152.33011457983682, 167.30867231973536, 68.04926240180086, 236.90607603378675, 163.17473714027955, 63.36335752487182, 90.2663008462145, 84.48716713503322, 153.85554729892837, 160.3379798824877, 99.58932634303291, 160.4834077612483, 206.33886260565617, 133.50827644034393, 159.3163261935329, 156.26290234785276, 77.62050644840745, 134.08830419223, 52.09921629347148, 190.67015053164855, 162.3013881234266, 148.56849195095432, 107.3727762846095, 65.84901785938368, 189.33175533294337, 154.79593777905592, 141.9429649453271, 151.95370467617371, 232.15970875410207, 123.21701194157238, 61.80529101572234, 152.5353060336729, 58.18060550526477, 142.86003271792987, 169.15630650593107, 55.11193343987732, 237.62388629366998, 321.196127390935, 152.05875624038433, 182.13262864846948, 122.40251486716366, 185.0867189827448, 196.46384018373155, 156.80489890659572, 15.962960155532656, 56.64125021100293, 116.61494216024963, 37.70073733956276, 162.25330256054906, 212.14024514307815, 190.85010777833318, 274.0628384750455, 202.85964202375524, 244.80224931435288, 40.84088902003229, 129.89331817686582, 39.38408735395095, 111.4946361455266, 57.346033208747, 146.46468149169723, 156.4319215344483, 205.11929505765676, 167.56643635746863, 149.32470743494443, 72.59294317735943, 261.80600143072184, 104.11172770636924, 136.85246734599264, 92.30482277920056, 10.720375110855354, 196.91454331690434, 19.880396514101168, 73.31072391359294, 139.92842677344612, 132.5991105468613, 125.5362352019052, 7.625793874080248, 150.49170219574893, 159.7099006260419, 212.21668657567943, 157.97987504818437, 79.22453425132869, 99.85272900294716, 200.8089679686889, 32.17310634490747, 36.29129372554688, 42.76036555586652, 229.58901833325652, 72.85206529181583, 23.483678339417583, 234.48968570531994, 115.16810988223027, 49.70529512018533, 81.7439375763814, 72.6942444226909, 211.5259507307773, 174.25241209057648, 130.58744513409493, 29.731507349447796, 54.71338776849634, 113.3035090114481, 88.70618153605415, 34.23103678534683, 104.2411015134955, 77.47892208174078, 191.09339355817323, 231.24015253408447, 44.27589742416255, 132.07948964008722, 38.935315680007434, 190.4030411320121, 84.47963204215986, 87.05497469856638, 61.619568062094835, 35.73734800176879, 130.55111511089066, 66.90916512866555, 273.59265106239053, 181.86527379694746, 71.9615967338942, 143.02644893177884, 200.85023806904445, 32.75947347543854, 142.05365263225423, 74.2793602616954, 54.424211474170065, 32.355762724930266, 178.2404427435085, 123.9318698689982, 229.010991509392, 159.8868278830372, 138.89557842722655, 220.49040546905377, 192.01523689279293, 172.08241906437655, 201.53487338867836, 257.5567110522959, 87.27070202736279, 158.25373158799425, 287.8183084819641, 96.82925461016676, 131.25068721551463, 84.6749138746587, 66.36922335399622, 31.012057668658116, 7.350665857336815, 59.78027720625095, 22.526303113839113, 96.9735515858301, 138.70364551451706, 80.85785844878036, 135.22633978395095, 282.3678320038991, 164.50362070247922, 281.470366105962, 87.96866859668765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.338735447890392, "mean_inference_ms": 3.8121570358751535, "mean_action_processing_ms": 1.7734035941035158, "mean_env_wait_ms": 10.158714211812779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004017949104309082, "StateBufferConnector_ms": 0.005182623863220215, "ViewRequirementAgentConnector_ms": 0.15012168884277344}, "num_episodes": 22, "episode_return_max": 351.13787432794516, "episode_return_min": 25.506264798013213, "episode_return_mean": 119.74271438836271, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.69303818211803, "num_env_steps_trained_throughput_per_sec": 82.69303818211803, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 47600.172, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47600.128, "sample_time_ms": 2139.571, "learn_time_ms": 45444.952, "learn_throughput": 88.019, "synch_weights_time_ms": 13.0}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-52-55", "timestamp": 1724149375, "time_this_iter_s": 48.39244627952576, "time_total_s": 1943.0074334144592, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120037f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1943.0074334144592, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 28.352173913043476, "ram_util_percent": 82.41014492753622}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.25554634250661, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.5115184223841105, "policy_loss": -0.015338934695091906, "vf_loss": 7.524471646768076, "vf_explained_var": 0.2773983787922632, "kl": 0.011928533487977884, "entropy": 0.8309947693789447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.53363320859021, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.454778175000791, "policy_loss": -0.012023954101586862, "vf_loss": 5.464841503567166, "vf_explained_var": 0.1950337078836229, "kl": 0.009803157994060447, "entropy": 0.838577647404696, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 356.7664163814079, "episode_reward_min": 25.506264798013213, "episode_reward_mean": 131.4794391762972, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -295.5509422907671, "predator_policy": 3.1192993306958714}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 321.196127390935}, "policy_reward_mean": {"prey_policy": -58.0674108761705, "predator_policy": 123.8071304643191}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.28058169716882, 176.85996707561904, 200.04224895362748, 81.21854236150293, 81.78229636944663, 205.99782626208844, 121.90517533730582, 74.6893773677638, 52.35341304641867, 84.49569095479023, 73.75303514838072, 143.38222290417025, 76.82335159793617, 61.611814940179414, 205.31053931454352, 196.36729869762058, 98.53978676776306, 82.55008948388084, 96.22387637002961, 55.000000000000114, 66.80920878642172, 104.05105389436852, 40.89285429353268, 111.86324133144866, 233.69276546569054, 25.506264798013213, 214.71684251476952, 329.3695574550838, 70.8148841597472, 100.9301711275794, 123.98514383588643, 124.09999999999911, 351.13787432794516, 115.56635610885951, 188.12058538800767, 98.82287041878108, 100.83623578066403, 49.3553647270137, 139.99999999999903, 187.70441656154944, 70.99204865520298, 36.517477614835485, 213.39999999999984, 137.68572997613668, 50.0531902095933, 154.56615538925854, 151.4100478176148, 101.5550801162043, 169.38758305225323, 110.56003828387836, 33.80328773878792, 54.875020944365566, 154.93489683030253, 173.21584400598252, 209.8170134918284, 98.222904257788, 86.69999999999978, 132.87308608280944, 166.6791236676807, 189.05491493281545, 222.40000000000006, 162.0279001685851, 132.66629312223836, 92.87101641188161, 96.5438225527136, 107.86385174974328, 106.77104736038041, 243.13961899546152, 119.45811964003809, 116.05612420610342, 144.16495340444746, 64.50283567553157, 169.91915437341373, 66.95073803637106, 110.77009671318166, 58.886119238336214, 217.85066585733605, 153.98586304994728, 44.781584095995505, 170.5221381096063, 83.81881623930408, 37.62620545177101, 52.408075767434404, 173.9822277820773, 126.33615632559153, 190.89999999999927, 119.80940888317885, 169.33804841468387, 70.60613446876343, 356.7664163814079, 171.48451375631117, 191.87384076238786, 101.00842760415145, 149.46868347708855, 214.96498986270427, 150.82151405782955, 45.63224694079264, 191.1999999999994, 112.29999999999899, 333.7000000000002], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-5.645210527655699, -137.18093387210624, -22.742447337160417, -57.4927150338421, 15.380703451616853, 8.845135324064964, -0.9360050060422171, -208.14383867844467, -119.6100657167505, -118.24642481337521, 20.516997906923592, -119.4745100804226, -81.67160039441141, -22.961318933433894, -76.84342425369503, -23.22066635978894, -252.93118680184315, -8.908927333154397, -128.40279675131208, -47.17424639817999, -193.87840753737186, -72.21569636024782, -76.26535353748754, -95.93165209972781, -50.3881848624335, -84.497274180268, -10.14438530719473, -171.01316657774626, -241.10214856561598, 135.5428078057784, 40.84759272065511, -17.7020881670274, -188.43691355381722, -57.150992790419195, -189.76077395060264, -21.585806187017603, -141.82797202917288, -117.32487229647221, -64.18652081313711, -95.15407623625883, -23.035812790660554, -111.19561664611236, -50.45238120909797, -69.76480484234224, -222.3762171003055, -295.5509422907671, -244.49888891978725, 22.170745362382448, 76.7315302089842, -150.52799859320197, -108.17463803950947, -219.58783625280503, 178.3337449992203, -36.22111285098544, 2.421481795685253, 172.63239615958616, -100.96252352097895, -202.61614002290176, -141.07296058677636, -222.90981453902313, -233.1472952574591, -90.52945224476251, 45.15911097996781, -91.79331817686638, 200.0, 0.2591508284675754, -87.33589562922597, -0.9084629623585245, 110.5480692894219, -283.9787004935191, -16.488669728119675, -201.57960364551263, -151.9611457397685, -81.60156308764859, -147.73885279290724, -43.86997753244139, -25.204822779201066, 62.179624889144804, -181.14823295208996, 152.05770968263374, -136.322246347064, -5.924855684772597, -60.42778028153805, -161.1900878523939, 129.57420612591966, -74.29170219574905, 9.112017544239677, -243.35287476982455, -132.19143927291236, -54.95977981700808, -12.334272937925284, -133.761268644452, 83.10781382135728, -0.162166074196422, 23.723309297064993, -194.51761306998392, 71.1897695935111, 1.862069827509136, -113.27843415095045, -125.81932315272158, -31.102007381397378, -66.54393757638226, -191.18387674511257, -38.16129746399027, -48.48718662535246, -101.41777376901646, 123.68968838109126, -34.91873949305211, -115.73171194247712, 123.53903488680325, -10.626650896523103, -29.622583144531042, -0.5789220817407804, -181.29339355817382, -216.41258177224245, 73.7696178968052, 21.201421185592565, -25.537102838006025, -87.21484185587211, 1.3870836145157526, 41.24502530143356, 32.48043193790526, 75.19055216681762, -79.45111511089115, -53.29181083324606, -154.5437122355718, -59.862094513064235, -101.09375960589585, 7.302412546138825, -254.63527699424912, -69.8497308061377, 2.900456448188501, -9.32012435098882, -12.612400024495233, 164.17224482368098, -131.62883129665826, -4.035011676204718, -229.44973006214735, -15.062067464223048, -167.66421463993723, -120.16078037869846, -148.17990857870078, -151.602029949639, -157.512426827885, -254.17548741400896, 79.26722870776408, -110.51585644054813, -268.6054455930396, -85.64295205410572, -31.666893058394038, -94.0403055110906, 1.8822875207715104, 189.0151409057376, -9.527198574395607, 71.04455468345955, 0.6347280463979882, -75.26417682106309, -115.63143618328925, 61.10089523247313, -106.66295535559826, -258.2356842622904, -104.81695220478437, -269.4583399634077, -62.35448928747177, -182.98367032347596, -94.6432096697578, 120.04082566552523, -37.68190787599449, -69.81845588695688, -6.481865331585546, 18.175538465708236, 161.29999999999993, -37.43417282464628, -171.51193618698542, 41.555125281569204, -146.01545502743923, 0.9435208505391142, -58.63802592100751, 196.17058583329478, 79.2622870432213, -36.011846011438465, -10.878003572298457, 165.67576665936636, -165.02017394633262, -128.21233990697647, 7.3148153934679865, -238.69086637568705, 98.88631351325596, -13.171580506343709, -21.60800012293599, 10.2707415665392, -218.4136660633196, -170.9334985119703, -126.41896069481392, 112.54688921063529, -19.208632099158066, -19.3267904531847, 6.480562777132067, 118.30147934302946, 140.98357261346968], "policy_predator_policy_reward": [25.325792224824305, 175.78093387210615, 69.05525560714615, 188.03987383947575, 48.0091347892941, 127.80727538865187, 162.34214993400178, 127.95623611198809, 152.33011457983682, 167.30867231973536, 68.04926240180086, 236.90607603378675, 163.17473714027955, 63.36335752487182, 90.2663008462145, 84.48716713503322, 153.85554729892837, 160.3379798824877, 99.58932634303291, 160.4834077612483, 206.33886260565617, 133.50827644034393, 159.3163261935329, 156.26290234785276, 77.62050644840745, 134.08830419223, 52.09921629347148, 190.67015053164855, 162.3013881234266, 148.56849195095432, 107.3727762846095, 65.84901785938368, 189.33175533294337, 154.79593777905592, 141.9429649453271, 151.95370467617371, 232.15970875410207, 123.21701194157238, 61.80529101572234, 152.5353060336729, 58.18060550526477, 142.86003271792987, 169.15630650593107, 55.11193343987732, 237.62388629366998, 321.196127390935, 152.05875624038433, 182.13262864846948, 122.40251486716366, 185.0867189827448, 196.46384018373155, 156.80489890659572, 15.962960155532656, 56.64125021100293, 116.61494216024963, 37.70073733956276, 162.25330256054906, 212.14024514307815, 190.85010777833318, 274.0628384750455, 202.85964202375524, 244.80224931435288, 40.84088902003229, 129.89331817686582, 39.38408735395095, 111.4946361455266, 57.346033208747, 146.46468149169723, 156.4319215344483, 205.11929505765676, 167.56643635746863, 149.32470743494443, 72.59294317735943, 261.80600143072184, 104.11172770636924, 136.85246734599264, 92.30482277920056, 10.720375110855354, 196.91454331690434, 19.880396514101168, 73.31072391359294, 139.92842677344612, 132.5991105468613, 125.5362352019052, 7.625793874080248, 150.49170219574893, 159.7099006260419, 212.21668657567943, 157.97987504818437, 79.22453425132869, 99.85272900294716, 200.8089679686889, 32.17310634490747, 36.29129372554688, 42.76036555586652, 229.58901833325652, 72.85206529181583, 23.483678339417583, 234.48968570531994, 115.16810988223027, 49.70529512018533, 81.7439375763814, 72.6942444226909, 211.5259507307773, 174.25241209057648, 130.58744513409493, 29.731507349447796, 54.71338776849634, 113.3035090114481, 88.70618153605415, 34.23103678534683, 104.2411015134955, 77.47892208174078, 191.09339355817323, 231.24015253408447, 44.27589742416255, 132.07948964008722, 38.935315680007434, 190.4030411320121, 84.47963204215986, 87.05497469856638, 61.619568062094835, 35.73734800176879, 130.55111511089066, 66.90916512866555, 273.59265106239053, 181.86527379694746, 71.9615967338942, 143.02644893177884, 200.85023806904445, 32.75947347543854, 142.05365263225423, 74.2793602616954, 54.424211474170065, 32.355762724930266, 178.2404427435085, 123.9318698689982, 229.010991509392, 159.8868278830372, 138.89557842722655, 220.49040546905377, 192.01523689279293, 172.08241906437655, 201.53487338867836, 257.5567110522959, 87.27070202736279, 158.25373158799425, 287.8183084819641, 96.82925461016676, 131.25068721551463, 84.6749138746587, 66.36922335399622, 31.012057668658116, 7.350665857336815, 59.78027720625095, 22.526303113839113, 96.9735515858301, 138.70364551451706, 80.85785844878036, 135.22633978395095, 282.3678320038991, 164.50362070247922, 281.470366105962, 87.96866859668765, 104.82642912264232, 225.2085266380251, 80.19635806284364, 11.42695192970364, 97.70929360667553, 104.92718393745855, 3.1192993306958714, 8.305162203595883, 127.05213900434326, 201.70337889046732, 93.40812234811557, 180.39025581243837, 51.97317711371171, 76.32746242551983, 20.157856323258173, 61.175687181633656, 98.24083969290628, 120.13352364714231, 125.88190698658097, 65.336341062773, 78.77760810941082, 143.1283440082494, 165.009586160025, 124.26365017949465, 95.92384542636125, 153.8207250656228, 244.85881183827985, 114.10562671633004, 180.4431069643094, 162.54159918326664, 53.65311078936472, 44.20863209915831, 76.97964901721306, 48.16657865883976, 39.198520656970494, 35.21642738653031]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.328223078644208, "mean_inference_ms": 3.7974359782926372, "mean_action_processing_ms": 1.756580925647942, "mean_env_wait_ms": 10.154905062029075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038524866104125977, "StateBufferConnector_ms": 0.00508570671081543, "ViewRequirementAgentConnector_ms": 0.1387941837310791}, "num_episodes": 18, "episode_return_max": 356.7664163814079, "episode_return_min": 25.506264798013213, "episode_return_mean": 131.4794391762972, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.14084317631088, "num_env_steps_trained_throughput_per_sec": 85.14084317631088, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 47619.84, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47619.797, "sample_time_ms": 2141.988, "learn_time_ms": 45461.523, "learn_throughput": 87.986, "synch_weights_time_ms": 13.565}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-53-43", "timestamp": 1724149423, "time_this_iter_s": 47.01933217048645, "time_total_s": 1990.0267655849457, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12002bf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1990.0267655849457, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 25.901515151515152, "ram_util_percent": 82.73030303030303}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.55118216244632, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.408406025013596, "policy_loss": -0.01613470057343384, "vf_loss": 7.421995132183903, "vf_explained_var": 0.31198075915139817, "kl": 0.012728063149560025, "entropy": 0.8560141706908191, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.376047624608196, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.362333322454382, "policy_loss": -0.016603919857541324, "vf_loss": 5.376895513484087, "vf_explained_var": 0.21827085607897037, "kl": 0.0102086059352452, "entropy": 0.8406378767793141, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 356.7664163814079, "episode_reward_min": 25.506264798013213, "episode_reward_mean": 130.48266836676535, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -295.5509422907671, "predator_policy": 3.1192993306958714}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 321.196127390935}, "policy_reward_mean": {"prey_policy": -57.40140628840173, "predator_policy": 122.64274047178438}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.000000000000114, 66.80920878642172, 104.05105389436852, 40.89285429353268, 111.86324133144866, 233.69276546569054, 25.506264798013213, 214.71684251476952, 329.3695574550838, 70.8148841597472, 100.9301711275794, 123.98514383588643, 124.09999999999911, 351.13787432794516, 115.56635610885951, 188.12058538800767, 98.82287041878108, 100.83623578066403, 49.3553647270137, 139.99999999999903, 187.70441656154944, 70.99204865520298, 36.517477614835485, 213.39999999999984, 137.68572997613668, 50.0531902095933, 154.56615538925854, 151.4100478176148, 101.5550801162043, 169.38758305225323, 110.56003828387836, 33.80328773878792, 54.875020944365566, 154.93489683030253, 173.21584400598252, 209.8170134918284, 98.222904257788, 86.69999999999978, 132.87308608280944, 166.6791236676807, 189.05491493281545, 222.40000000000006, 162.0279001685851, 132.66629312223836, 92.87101641188161, 96.5438225527136, 107.86385174974328, 106.77104736038041, 243.13961899546152, 119.45811964003809, 116.05612420610342, 144.16495340444746, 64.50283567553157, 169.91915437341373, 66.95073803637106, 110.77009671318166, 58.886119238336214, 217.85066585733605, 153.98586304994728, 44.781584095995505, 170.5221381096063, 83.81881623930408, 37.62620545177101, 52.408075767434404, 173.9822277820773, 126.33615632559153, 190.89999999999927, 119.80940888317885, 169.33804841468387, 70.60613446876343, 356.7664163814079, 171.48451375631117, 191.87384076238786, 101.00842760415145, 149.46868347708855, 214.96498986270427, 150.82151405782955, 45.63224694079264, 191.1999999999994, 112.29999999999899, 333.7000000000002, 231.09999999999988, 168.98580948864907, 100.63875956318907, 72.36953466182523, 35.31254180658495, 90.59326908684065, 93.82129876593723, 42.49734784410317, 184.7750823866895, 95.7984227905797, 140.07272359483983, 69.73915147237236, 142.08663148095184, 86.19594752423436, 133.6077187840654, 135.0162849677379, 158.47702152296034, 61.95970957943907, 29.46279837604841], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-64.18652081313711, -95.15407623625883, -23.035812790660554, -111.19561664611236, -50.45238120909797, -69.76480484234224, -222.3762171003055, -295.5509422907671, -244.49888891978725, 22.170745362382448, 76.7315302089842, -150.52799859320197, -108.17463803950947, -219.58783625280503, 178.3337449992203, -36.22111285098544, 2.421481795685253, 172.63239615958616, -100.96252352097895, -202.61614002290176, -141.07296058677636, -222.90981453902313, -233.1472952574591, -90.52945224476251, 45.15911097996781, -91.79331817686638, 200.0, 0.2591508284675754, -87.33589562922597, -0.9084629623585245, 110.5480692894219, -283.9787004935191, -16.488669728119675, -201.57960364551263, -151.9611457397685, -81.60156308764859, -147.73885279290724, -43.86997753244139, -25.204822779201066, 62.179624889144804, -181.14823295208996, 152.05770968263374, -136.322246347064, -5.924855684772597, -60.42778028153805, -161.1900878523939, 129.57420612591966, -74.29170219574905, 9.112017544239677, -243.35287476982455, -132.19143927291236, -54.95977981700808, -12.334272937925284, -133.761268644452, 83.10781382135728, -0.162166074196422, 23.723309297064993, -194.51761306998392, 71.1897695935111, 1.862069827509136, -113.27843415095045, -125.81932315272158, -31.102007381397378, -66.54393757638226, -191.18387674511257, -38.16129746399027, -48.48718662535246, -101.41777376901646, 123.68968838109126, -34.91873949305211, -115.73171194247712, 123.53903488680325, -10.626650896523103, -29.622583144531042, -0.5789220817407804, -181.29339355817382, -216.41258177224245, 73.7696178968052, 21.201421185592565, -25.537102838006025, -87.21484185587211, 1.3870836145157526, 41.24502530143356, 32.48043193790526, 75.19055216681762, -79.45111511089115, -53.29181083324606, -154.5437122355718, -59.862094513064235, -101.09375960589585, 7.302412546138825, -254.63527699424912, -69.8497308061377, 2.900456448188501, -9.32012435098882, -12.612400024495233, 164.17224482368098, -131.62883129665826, -4.035011676204718, -229.44973006214735, -15.062067464223048, -167.66421463993723, -120.16078037869846, -148.17990857870078, -151.602029949639, -157.512426827885, -254.17548741400896, 79.26722870776408, -110.51585644054813, -268.6054455930396, -85.64295205410572, -31.666893058394038, -94.0403055110906, 1.8822875207715104, 189.0151409057376, -9.527198574395607, 71.04455468345955, 0.6347280463979882, -75.26417682106309, -115.63143618328925, 61.10089523247313, -106.66295535559826, -258.2356842622904, -104.81695220478437, -269.4583399634077, -62.35448928747177, -182.98367032347596, -94.6432096697578, 120.04082566552523, -37.68190787599449, -69.81845588695688, -6.481865331585546, 18.175538465708236, 161.29999999999993, -37.43417282464628, -171.51193618698542, 41.555125281569204, -146.01545502743923, 0.9435208505391142, -58.63802592100751, 196.17058583329478, 79.2622870432213, -36.011846011438465, -10.878003572298457, 165.67576665936636, -165.02017394633262, -128.21233990697647, 7.3148153934679865, -238.69086637568705, 98.88631351325596, -13.171580506343709, -21.60800012293599, 10.2707415665392, -218.4136660633196, -170.9334985119703, -126.41896069481392, 112.54688921063529, -19.208632099158066, -19.3267904531847, 6.480562777132067, 118.30147934302946, 140.98357261346968, 26.920433478369617, 18.960220514169023, -87.64972342808925, 41.7701836343076, -137.4097232411235, -64.32494918137637, -60.637482830549516, -76.69454817320303, -171.37776058782885, 1.959316395298998, -109.219235117349, -98.2593710570487, -78.16898844258367, 35.14128114315942, -110.32771222385165, -246.23723873467236, -208.75054369892433, 110.89769107911943, -9.76319217821752, -37.04714515197772, -26.917367452865914, -217.89963278101953, -128.62593779640972, -114.25718017830214, 3.178172216137752, -224.33325216875917, -200.62729541085366, -79.67678437006057, 48.02422518883504, -198.83892265113312, 46.42612564477031, -7.58504050673058, -16.822757097032493, 67.79902858479095, -38.454399060965414, -149.4347623760152, -52.52079268252397, -255.69279083094008], "policy_predator_policy_reward": [61.80529101572234, 152.5353060336729, 58.18060550526477, 142.86003271792987, 169.15630650593107, 55.11193343987732, 237.62388629366998, 321.196127390935, 152.05875624038433, 182.13262864846948, 122.40251486716366, 185.0867189827448, 196.46384018373155, 156.80489890659572, 15.962960155532656, 56.64125021100293, 116.61494216024963, 37.70073733956276, 162.25330256054906, 212.14024514307815, 190.85010777833318, 274.0628384750455, 202.85964202375524, 244.80224931435288, 40.84088902003229, 129.89331817686582, 39.38408735395095, 111.4946361455266, 57.346033208747, 146.46468149169723, 156.4319215344483, 205.11929505765676, 167.56643635746863, 149.32470743494443, 72.59294317735943, 261.80600143072184, 104.11172770636924, 136.85246734599264, 92.30482277920056, 10.720375110855354, 196.91454331690434, 19.880396514101168, 73.31072391359294, 139.92842677344612, 132.5991105468613, 125.5362352019052, 7.625793874080248, 150.49170219574893, 159.7099006260419, 212.21668657567943, 157.97987504818437, 79.22453425132869, 99.85272900294716, 200.8089679686889, 32.17310634490747, 36.29129372554688, 42.76036555586652, 229.58901833325652, 72.85206529181583, 23.483678339417583, 234.48968570531994, 115.16810988223027, 49.70529512018533, 81.7439375763814, 72.6942444226909, 211.5259507307773, 174.25241209057648, 130.58744513409493, 29.731507349447796, 54.71338776849634, 113.3035090114481, 88.70618153605415, 34.23103678534683, 104.2411015134955, 77.47892208174078, 191.09339355817323, 231.24015253408447, 44.27589742416255, 132.07948964008722, 38.935315680007434, 190.4030411320121, 84.47963204215986, 87.05497469856638, 61.619568062094835, 35.73734800176879, 130.55111511089066, 66.90916512866555, 273.59265106239053, 181.86527379694746, 71.9615967338942, 143.02644893177884, 200.85023806904445, 32.75947347543854, 142.05365263225423, 74.2793602616954, 54.424211474170065, 32.355762724930266, 178.2404427435085, 123.9318698689982, 229.010991509392, 159.8868278830372, 138.89557842722655, 220.49040546905377, 192.01523689279293, 172.08241906437655, 201.53487338867836, 257.5567110522959, 87.27070202736279, 158.25373158799425, 287.8183084819641, 96.82925461016676, 131.25068721551463, 84.6749138746587, 66.36922335399622, 31.012057668658116, 7.350665857336815, 59.78027720625095, 22.526303113839113, 96.9735515858301, 138.70364551451706, 80.85785844878036, 135.22633978395095, 282.3678320038991, 164.50362070247922, 281.470366105962, 87.96866859668765, 104.82642912264232, 225.2085266380251, 80.19635806284364, 11.42695192970364, 97.70929360667553, 104.92718393745855, 3.1192993306958714, 8.305162203595883, 127.05213900434326, 201.70337889046732, 93.40812234811557, 180.39025581243837, 51.97317711371171, 76.32746242551983, 20.157856323258173, 61.175687181633656, 98.24083969290628, 120.13352364714231, 125.88190698658097, 65.336341062773, 78.77760810941082, 143.1283440082494, 165.009586160025, 124.26365017949465, 95.92384542636125, 153.8207250656228, 244.85881183827985, 114.10562671633004, 180.4431069643094, 162.54159918326664, 53.65311078936472, 44.20863209915831, 76.97964901721306, 48.16657865883976, 39.198520656970494, 35.21642738653031, 164.93831890426196, 20.28102710319954, 107.48568754765053, 107.3796617347811, 118.62402698950959, 183.74940499617853, 107.65815283978654, 102.04341282579072, 116.09440746820613, 88.63657853090776, 138.48787228609473, 159.58400297514297, 96.49963965991861, 40.349366405442794, 154.02272442141285, 245.03957438121344, 166.59391945028915, 116.03401555620566, 41.05450726975753, 101.55425285101776, 99.36586184568688, 285.5238619830383, 158.60973143414714, 154.01253801293672, 136.23892982988974, 227.0027816036835, 211.60354973489282, 154.8964775702555, 207.20318750626927, 77.21922874009421, 44.375957757334135, 51.79924207236442, 100.94356803614883, 6.557181999052406, 53.77909451832878, 196.0697764980906, 77.82904273510403, 259.8473391544081]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.313741537447263, "mean_inference_ms": 3.781448091230778, "mean_action_processing_ms": 1.7168771728178127, "mean_env_wait_ms": 10.148210115722772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035294294357299805, "StateBufferConnector_ms": 0.006582856178283691, "ViewRequirementAgentConnector_ms": 0.13135790824890137}, "num_episodes": 19, "episode_return_max": 356.7664163814079, "episode_return_min": 25.506264798013213, "episode_return_mean": 130.48266836676535, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.1855891438856, "num_env_steps_trained_throughput_per_sec": 85.1855891438856, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 47629.639, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47629.596, "sample_time_ms": 2120.555, "learn_time_ms": 45492.486, "learn_throughput": 87.927, "synch_weights_time_ms": 13.859}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-54-30", "timestamp": 1724149470, "time_this_iter_s": 46.96459984779358, "time_total_s": 2036.9913654327393, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120037e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2036.9913654327393, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 25.256716417910447, "ram_util_percent": 82.47611940298508}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.23943965945925, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.591638704330202, "policy_loss": -0.014676625822256836, "vf_loss": 7.604030003623357, "vf_explained_var": 0.17127181408266542, "kl": 0.01142664471894956, "entropy": 0.8322707072767631, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.584506283172224, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.4743812518145045, "policy_loss": -0.015128065644709206, "vf_loss": 5.487310669409535, "vf_explained_var": 0.14082224397432236, "kl": 0.010993292520596354, "entropy": 0.8716430633156388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 356.7664163814079, "episode_reward_min": 29.46279837604841, "episode_reward_mean": 136.32685421216092, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -272.06749375985925, "predator_policy": 3.1192993306958714}, "policy_reward_max": {"prey_policy": 196.17058583329478, "predator_policy": 302.69457019869566}, "policy_reward_mean": {"prey_policy": -53.00016517288239, "predator_policy": 121.16359227896282}, "custom_metrics": {}, "hist_stats": {"episode_reward": [187.70441656154944, 70.99204865520298, 36.517477614835485, 213.39999999999984, 137.68572997613668, 50.0531902095933, 154.56615538925854, 151.4100478176148, 101.5550801162043, 169.38758305225323, 110.56003828387836, 33.80328773878792, 54.875020944365566, 154.93489683030253, 173.21584400598252, 209.8170134918284, 98.222904257788, 86.69999999999978, 132.87308608280944, 166.6791236676807, 189.05491493281545, 222.40000000000006, 162.0279001685851, 132.66629312223836, 92.87101641188161, 96.5438225527136, 107.86385174974328, 106.77104736038041, 243.13961899546152, 119.45811964003809, 116.05612420610342, 144.16495340444746, 64.50283567553157, 169.91915437341373, 66.95073803637106, 110.77009671318166, 58.886119238336214, 217.85066585733605, 153.98586304994728, 44.781584095995505, 170.5221381096063, 83.81881623930408, 37.62620545177101, 52.408075767434404, 173.9822277820773, 126.33615632559153, 190.89999999999927, 119.80940888317885, 169.33804841468387, 70.60613446876343, 356.7664163814079, 171.48451375631117, 191.87384076238786, 101.00842760415145, 149.46868347708855, 214.96498986270427, 150.82151405782955, 45.63224694079264, 191.1999999999994, 112.29999999999899, 333.7000000000002, 231.09999999999988, 168.98580948864907, 100.63875956318907, 72.36953466182523, 35.31254180658495, 90.59326908684065, 93.82129876593723, 42.49734784410317, 184.7750823866895, 95.7984227905797, 140.07272359483983, 69.73915147237236, 142.08663148095184, 86.19594752423436, 133.6077187840654, 135.0162849677379, 158.47702152296034, 61.95970957943907, 29.46279837604841, 184.86941726347982, 116.81534089987659, 177.16495815517308, 59.8060195324236, 251.52792959586702, 79.40272886998615, 104.45933487718794, 253.19999999999956, 138.77561634002774, 126.79999999999995, 256.8593861382675, 39.100000000000236, 351.1697021280947, 85.14017166249658, 227.54711472833546, 216.25770905853696, 168.71082425296274, 112.95145840848224, 108.87954584248676, 170.55260119968514], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-181.14823295208996, 152.05770968263374, -136.322246347064, -5.924855684772597, -60.42778028153805, -161.1900878523939, 129.57420612591966, -74.29170219574905, 9.112017544239677, -243.35287476982455, -132.19143927291236, -54.95977981700808, -12.334272937925284, -133.761268644452, 83.10781382135728, -0.162166074196422, 23.723309297064993, -194.51761306998392, 71.1897695935111, 1.862069827509136, -113.27843415095045, -125.81932315272158, -31.102007381397378, -66.54393757638226, -191.18387674511257, -38.16129746399027, -48.48718662535246, -101.41777376901646, 123.68968838109126, -34.91873949305211, -115.73171194247712, 123.53903488680325, -10.626650896523103, -29.622583144531042, -0.5789220817407804, -181.29339355817382, -216.41258177224245, 73.7696178968052, 21.201421185592565, -25.537102838006025, -87.21484185587211, 1.3870836145157526, 41.24502530143356, 32.48043193790526, 75.19055216681762, -79.45111511089115, -53.29181083324606, -154.5437122355718, -59.862094513064235, -101.09375960589585, 7.302412546138825, -254.63527699424912, -69.8497308061377, 2.900456448188501, -9.32012435098882, -12.612400024495233, 164.17224482368098, -131.62883129665826, -4.035011676204718, -229.44973006214735, -15.062067464223048, -167.66421463993723, -120.16078037869846, -148.17990857870078, -151.602029949639, -157.512426827885, -254.17548741400896, 79.26722870776408, -110.51585644054813, -268.6054455930396, -85.64295205410572, -31.666893058394038, -94.0403055110906, 1.8822875207715104, 189.0151409057376, -9.527198574395607, 71.04455468345955, 0.6347280463979882, -75.26417682106309, -115.63143618328925, 61.10089523247313, -106.66295535559826, -258.2356842622904, -104.81695220478437, -269.4583399634077, -62.35448928747177, -182.98367032347596, -94.6432096697578, 120.04082566552523, -37.68190787599449, -69.81845588695688, -6.481865331585546, 18.175538465708236, 161.29999999999993, -37.43417282464628, -171.51193618698542, 41.555125281569204, -146.01545502743923, 0.9435208505391142, -58.63802592100751, 196.17058583329478, 79.2622870432213, -36.011846011438465, -10.878003572298457, 165.67576665936636, -165.02017394633262, -128.21233990697647, 7.3148153934679865, -238.69086637568705, 98.88631351325596, -13.171580506343709, -21.60800012293599, 10.2707415665392, -218.4136660633196, -170.9334985119703, -126.41896069481392, 112.54688921063529, -19.208632099158066, -19.3267904531847, 6.480562777132067, 118.30147934302946, 140.98357261346968, 26.920433478369617, 18.960220514169023, -87.64972342808925, 41.7701836343076, -137.4097232411235, -64.32494918137637, -60.637482830549516, -76.69454817320303, -171.37776058782885, 1.959316395298998, -109.219235117349, -98.2593710570487, -78.16898844258367, 35.14128114315942, -110.32771222385165, -246.23723873467236, -208.75054369892433, 110.89769107911943, -9.76319217821752, -37.04714515197772, -26.917367452865914, -217.89963278101953, -128.62593779640972, -114.25718017830214, 3.178172216137752, -224.33325216875917, -200.62729541085366, -79.67678437006057, 48.02422518883504, -198.83892265113312, 46.42612564477031, -7.58504050673058, -16.822757097032493, 67.79902858479095, -38.454399060965414, -149.4347623760152, -52.52079268252397, -255.69279083094008, 93.85243660603676, -103.97465605838464, 40.31887562600386, -208.78756368391024, 63.266406471448896, -243.90282644883197, -71.12067239237146, -163.89262764682465, 143.9448645847304, 45.26916125068066, -211.62761181234308, -36.81629727256919, -168.83085294993532, -18.225323591315018, 173.67301689864166, 29.28745427112669, 25.426650813629625, -235.93782831585827, -86.34362908206279, -80.51020775797639, -118.8778794152985, 124.67018522799468, -160.7632390912969, -88.59742418655054, 31.643947800807226, 86.92015774970099, -42.68673689076757, -272.06749375985925, 18.544282146891643, 38.019357161590676, -180.27670647861643, 29.766226411019087, -7.003903735251159, -65.99188635215212, -65.22251662142497, -91.05295020203327, -5.0240804704306425, -214.69737646296952, -115.79129923148447, 49.678599182502055], "policy_predator_policy_reward": [196.91454331690434, 19.880396514101168, 73.31072391359294, 139.92842677344612, 132.5991105468613, 125.5362352019052, 7.625793874080248, 150.49170219574893, 159.7099006260419, 212.21668657567943, 157.97987504818437, 79.22453425132869, 99.85272900294716, 200.8089679686889, 32.17310634490747, 36.29129372554688, 42.76036555586652, 229.58901833325652, 72.85206529181583, 23.483678339417583, 234.48968570531994, 115.16810988223027, 49.70529512018533, 81.7439375763814, 72.6942444226909, 211.5259507307773, 174.25241209057648, 130.58744513409493, 29.731507349447796, 54.71338776849634, 113.3035090114481, 88.70618153605415, 34.23103678534683, 104.2411015134955, 77.47892208174078, 191.09339355817323, 231.24015253408447, 44.27589742416255, 132.07948964008722, 38.935315680007434, 190.4030411320121, 84.47963204215986, 87.05497469856638, 61.619568062094835, 35.73734800176879, 130.55111511089066, 66.90916512866555, 273.59265106239053, 181.86527379694746, 71.9615967338942, 143.02644893177884, 200.85023806904445, 32.75947347543854, 142.05365263225423, 74.2793602616954, 54.424211474170065, 32.355762724930266, 178.2404427435085, 123.9318698689982, 229.010991509392, 159.8868278830372, 138.89557842722655, 220.49040546905377, 192.01523689279293, 172.08241906437655, 201.53487338867836, 257.5567110522959, 87.27070202736279, 158.25373158799425, 287.8183084819641, 96.82925461016676, 131.25068721551463, 84.6749138746587, 66.36922335399622, 31.012057668658116, 7.350665857336815, 59.78027720625095, 22.526303113839113, 96.9735515858301, 138.70364551451706, 80.85785844878036, 135.22633978395095, 282.3678320038991, 164.50362070247922, 281.470366105962, 87.96866859668765, 104.82642912264232, 225.2085266380251, 80.19635806284364, 11.42695192970364, 97.70929360667553, 104.92718393745855, 3.1192993306958714, 8.305162203595883, 127.05213900434326, 201.70337889046732, 93.40812234811557, 180.39025581243837, 51.97317711371171, 76.32746242551983, 20.157856323258173, 61.175687181633656, 98.24083969290628, 120.13352364714231, 125.88190698658097, 65.336341062773, 78.77760810941082, 143.1283440082494, 165.009586160025, 124.26365017949465, 95.92384542636125, 153.8207250656228, 244.85881183827985, 114.10562671633004, 180.4431069643094, 162.54159918326664, 53.65311078936472, 44.20863209915831, 76.97964901721306, 48.16657865883976, 39.198520656970494, 35.21642738653031, 164.93831890426196, 20.28102710319954, 107.48568754765053, 107.3796617347811, 118.62402698950959, 183.74940499617853, 107.65815283978654, 102.04341282579072, 116.09440746820613, 88.63657853090776, 138.48787228609473, 159.58400297514297, 96.49963965991861, 40.349366405442794, 154.02272442141285, 245.03957438121344, 166.59391945028915, 116.03401555620566, 41.05450726975753, 101.55425285101776, 99.36586184568688, 285.5238619830383, 158.60973143414714, 154.01253801293672, 136.23892982988974, 227.0027816036835, 211.60354973489282, 154.8964775702555, 207.20318750626927, 77.21922874009421, 44.375957757334135, 51.79924207236442, 100.94356803614883, 6.557181999052406, 53.77909451832878, 196.0697764980906, 77.82904273510403, 259.8473391544081, 157.56442636605325, 37.427210349774654, 117.06325776468647, 168.22077119309628, 127.3596348316112, 230.44174330094518, 195.03972468405286, 99.779594887566, 57.28597416458895, 5.0279295958674535, 124.36416344029594, 203.48247451460242, 196.1469077908485, 95.36860362758937, 44.03463346849751, 6.20489536173413, 78.33677183561493, 270.95002200664146, 121.99872577409538, 171.6551110659437, 166.83905987219237, 84.22802045337906, 167.8632390912965, 120.59742418654996, 139.03273072864167, 93.57286584894484, 302.69457019869566, 97.19983211442741, 74.18476623357385, 96.79870918627934, 243.0315912304009, 123.73659789573352, 195.45397047018685, 46.25264387017966, 197.03204469525116, 72.19488053668937, 118.02495552378048, 210.57604725210658, 180.78945992070084, 55.875841327966505]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.278387458490092, "mean_inference_ms": 3.764475442635624, "mean_action_processing_ms": 1.7135892599881941, "mean_env_wait_ms": 10.140554784631576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003573298454284668, "StateBufferConnector_ms": 0.0056209564208984375, "ViewRequirementAgentConnector_ms": 0.11112654209136963}, "num_episodes": 20, "episode_return_max": 356.7664163814079, "episode_return_min": 29.46279837604841, "episode_return_mean": 136.32685421216092, "episodes_this_iter": 20}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.94525645658926, "num_env_steps_trained_throughput_per_sec": 84.94525645658926, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 47617.757, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47617.714, "sample_time_ms": 2117.1, "learn_time_ms": 45484.195, "learn_throughput": 87.943, "synch_weights_time_ms": 13.71}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-55-17", "timestamp": 1724149517, "time_this_iter_s": 47.12511897087097, "time_total_s": 2084.1164844036102, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33132b940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2084.1164844036102, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 25.924242424242426, "ram_util_percent": 82.58181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.63902465174438, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.825512307283109, "policy_loss": -0.015598118267633099, "vf_loss": 6.838941998708815, "vf_explained_var": 0.3143805641030508, "kl": 0.010842040819042022, "entropy": 0.8510609475077775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.542416542043131, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.013067156171042, "policy_loss": -0.013101052744412627, "vf_loss": 5.024184391738245, "vf_explained_var": 0.1909005763354125, "kl": 0.009919060784559598, "entropy": 0.901584705000832, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 356.7664163814079, "episode_reward_min": 29.46279837604841, "episode_reward_mean": 135.20726003486018, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -326.06204737921144, "predator_policy": 3.1192993306958714}, "policy_reward_max": {"prey_policy": 196.17058583329478, "predator_policy": 334.72427972427516}, "policy_reward_mean": {"prey_policy": -56.507106109872254, "predator_policy": 124.11073612730233}, "custom_metrics": {}, "hist_stats": {"episode_reward": [162.0279001685851, 132.66629312223836, 92.87101641188161, 96.5438225527136, 107.86385174974328, 106.77104736038041, 243.13961899546152, 119.45811964003809, 116.05612420610342, 144.16495340444746, 64.50283567553157, 169.91915437341373, 66.95073803637106, 110.77009671318166, 58.886119238336214, 217.85066585733605, 153.98586304994728, 44.781584095995505, 170.5221381096063, 83.81881623930408, 37.62620545177101, 52.408075767434404, 173.9822277820773, 126.33615632559153, 190.89999999999927, 119.80940888317885, 169.33804841468387, 70.60613446876343, 356.7664163814079, 171.48451375631117, 191.87384076238786, 101.00842760415145, 149.46868347708855, 214.96498986270427, 150.82151405782955, 45.63224694079264, 191.1999999999994, 112.29999999999899, 333.7000000000002, 231.09999999999988, 168.98580948864907, 100.63875956318907, 72.36953466182523, 35.31254180658495, 90.59326908684065, 93.82129876593723, 42.49734784410317, 184.7750823866895, 95.7984227905797, 140.07272359483983, 69.73915147237236, 142.08663148095184, 86.19594752423436, 133.6077187840654, 135.0162849677379, 158.47702152296034, 61.95970957943907, 29.46279837604841, 184.86941726347982, 116.81534089987659, 177.16495815517308, 59.8060195324236, 251.52792959586702, 79.40272886998615, 104.45933487718794, 253.19999999999956, 138.77561634002774, 126.79999999999995, 256.8593861382675, 39.100000000000236, 351.1697021280947, 85.14017166249658, 227.54711472833546, 216.25770905853696, 168.71082425296274, 112.95145840848224, 108.87954584248676, 170.55260119968514, 161.99495974800837, 91.06761444861692, 131.54328347820066, 145.1114792046517, 209.66732573857774, 92.84139426891127, 173.62732900493063, 67.47913731999431, 128.056158593988, 75.20610495817209, 182.17222263238796, 136.01279973081324, 111.59325207408125, 49.500000000000156, 122.43250024380484, 246.02879326930127, 71.25336409877224, 268.9993817958573, 41.40000000000021, 89.78254035411092, 151.47327940755596, 47.205521528078606], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [75.19055216681762, -79.45111511089115, -53.29181083324606, -154.5437122355718, -59.862094513064235, -101.09375960589585, 7.302412546138825, -254.63527699424912, -69.8497308061377, 2.900456448188501, -9.32012435098882, -12.612400024495233, 164.17224482368098, -131.62883129665826, -4.035011676204718, -229.44973006214735, -15.062067464223048, -167.66421463993723, -120.16078037869846, -148.17990857870078, -151.602029949639, -157.512426827885, -254.17548741400896, 79.26722870776408, -110.51585644054813, -268.6054455930396, -85.64295205410572, -31.666893058394038, -94.0403055110906, 1.8822875207715104, 189.0151409057376, -9.527198574395607, 71.04455468345955, 0.6347280463979882, -75.26417682106309, -115.63143618328925, 61.10089523247313, -106.66295535559826, -258.2356842622904, -104.81695220478437, -269.4583399634077, -62.35448928747177, -182.98367032347596, -94.6432096697578, 120.04082566552523, -37.68190787599449, -69.81845588695688, -6.481865331585546, 18.175538465708236, 161.29999999999993, -37.43417282464628, -171.51193618698542, 41.555125281569204, -146.01545502743923, 0.9435208505391142, -58.63802592100751, 196.17058583329478, 79.2622870432213, -36.011846011438465, -10.878003572298457, 165.67576665936636, -165.02017394633262, -128.21233990697647, 7.3148153934679865, -238.69086637568705, 98.88631351325596, -13.171580506343709, -21.60800012293599, 10.2707415665392, -218.4136660633196, -170.9334985119703, -126.41896069481392, 112.54688921063529, -19.208632099158066, -19.3267904531847, 6.480562777132067, 118.30147934302946, 140.98357261346968, 26.920433478369617, 18.960220514169023, -87.64972342808925, 41.7701836343076, -137.4097232411235, -64.32494918137637, -60.637482830549516, -76.69454817320303, -171.37776058782885, 1.959316395298998, -109.219235117349, -98.2593710570487, -78.16898844258367, 35.14128114315942, -110.32771222385165, -246.23723873467236, -208.75054369892433, 110.89769107911943, -9.76319217821752, -37.04714515197772, -26.917367452865914, -217.89963278101953, -128.62593779640972, -114.25718017830214, 3.178172216137752, -224.33325216875917, -200.62729541085366, -79.67678437006057, 48.02422518883504, -198.83892265113312, 46.42612564477031, -7.58504050673058, -16.822757097032493, 67.79902858479095, -38.454399060965414, -149.4347623760152, -52.52079268252397, -255.69279083094008, 93.85243660603676, -103.97465605838464, 40.31887562600386, -208.78756368391024, 63.266406471448896, -243.90282644883197, -71.12067239237146, -163.89262764682465, 143.9448645847304, 45.26916125068066, -211.62761181234308, -36.81629727256919, -168.83085294993532, -18.225323591315018, 173.67301689864166, 29.28745427112669, 25.426650813629625, -235.93782831585827, -86.34362908206279, -80.51020775797639, -118.8778794152985, 124.67018522799468, -160.7632390912969, -88.59742418655054, 31.643947800807226, 86.92015774970099, -42.68673689076757, -272.06749375985925, 18.544282146891643, 38.019357161590676, -180.27670647861643, 29.766226411019087, -7.003903735251159, -65.99188635215212, -65.22251662142497, -91.05295020203327, -5.0240804704306425, -214.69737646296952, -115.79129923148447, 49.678599182502055, -58.15460241985961, 114.4701091703212, 27.935424844632756, -148.22975709448693, -12.719257734023488, 67.7359761676928, 37.89237274336816, -40.963443584483336, 55.945443783367374, 42.066427834285406, -132.70690966557623, -85.18220435777212, 118.26106106229739, -262.4817913153877, -144.01081511302914, -54.149580473890055, -69.62601292622055, -200.217567926556, -42.14374790153025, -107.69680666933789, 125.23209633179388, -168.71756617330786, -300.2456277130118, -14.809102922200509, -56.85151480960663, -58.81077147669514, -26.857728254911176, -18.5646577087917, 24.290306288630752, -178.97026242425403, 101.56883776773597, -7.830380702520682, -68.11149236673478, -326.06204737921144, 28.696863783217857, -194.45787751990983, -37.51879333222997, -165.01813879493784, -36.259326348720094, -102.48399957590411, -99.7169930818659, -6.152606993009506, -133.28307327021562, -7.054134396194325], "policy_predator_policy_reward": [35.73734800176879, 130.55111511089066, 66.90916512866555, 273.59265106239053, 181.86527379694746, 71.9615967338942, 143.02644893177884, 200.85023806904445, 32.75947347543854, 142.05365263225423, 74.2793602616954, 54.424211474170065, 32.355762724930266, 178.2404427435085, 123.9318698689982, 229.010991509392, 159.8868278830372, 138.89557842722655, 220.49040546905377, 192.01523689279293, 172.08241906437655, 201.53487338867836, 257.5567110522959, 87.27070202736279, 158.25373158799425, 287.8183084819641, 96.82925461016676, 131.25068721551463, 84.6749138746587, 66.36922335399622, 31.012057668658116, 7.350665857336815, 59.78027720625095, 22.526303113839113, 96.9735515858301, 138.70364551451706, 80.85785844878036, 135.22633978395095, 282.3678320038991, 164.50362070247922, 281.470366105962, 87.96866859668765, 104.82642912264232, 225.2085266380251, 80.19635806284364, 11.42695192970364, 97.70929360667553, 104.92718393745855, 3.1192993306958714, 8.305162203595883, 127.05213900434326, 201.70337889046732, 93.40812234811557, 180.39025581243837, 51.97317711371171, 76.32746242551983, 20.157856323258173, 61.175687181633656, 98.24083969290628, 120.13352364714231, 125.88190698658097, 65.336341062773, 78.77760810941082, 143.1283440082494, 165.009586160025, 124.26365017949465, 95.92384542636125, 153.8207250656228, 244.85881183827985, 114.10562671633004, 180.4431069643094, 162.54159918326664, 53.65311078936472, 44.20863209915831, 76.97964901721306, 48.16657865883976, 39.198520656970494, 35.21642738653031, 164.93831890426196, 20.28102710319954, 107.48568754765053, 107.3796617347811, 118.62402698950959, 183.74940499617853, 107.65815283978654, 102.04341282579072, 116.09440746820613, 88.63657853090776, 138.48787228609473, 159.58400297514297, 96.49963965991861, 40.349366405442794, 154.02272442141285, 245.03957438121344, 166.59391945028915, 116.03401555620566, 41.05450726975753, 101.55425285101776, 99.36586184568688, 285.5238619830383, 158.60973143414714, 154.01253801293672, 136.23892982988974, 227.0027816036835, 211.60354973489282, 154.8964775702555, 207.20318750626927, 77.21922874009421, 44.375957757334135, 51.79924207236442, 100.94356803614883, 6.557181999052406, 53.77909451832878, 196.0697764980906, 77.82904273510403, 259.8473391544081, 157.56442636605325, 37.427210349774654, 117.06325776468647, 168.22077119309628, 127.3596348316112, 230.44174330094518, 195.03972468405286, 99.779594887566, 57.28597416458895, 5.0279295958674535, 124.36416344029594, 203.48247451460242, 196.1469077908485, 95.36860362758937, 44.03463346849751, 6.20489536173413, 78.33677183561493, 270.95002200664146, 121.99872577409538, 171.6551110659437, 166.83905987219237, 84.22802045337906, 167.8632390912965, 120.59742418654996, 139.03273072864167, 93.57286584894484, 302.69457019869566, 97.19983211442741, 74.18476623357385, 96.79870918627934, 243.0315912304009, 123.73659789573352, 195.45397047018685, 46.25264387017966, 197.03204469525116, 72.19488053668937, 118.02495552378048, 210.57604725210658, 180.78945992070084, 55.875841327966505, 59.55412905675759, 46.12532394078926, 154.66761929303158, 56.69432740543982, 33.84886229298805, 42.67770275154391, 46.09088789363021, 102.09166215213718, 63.82188195521077, 47.83357216571431, 196.93291820029285, 113.79759009196736, 234.02912885650284, 83.81893040151812, 126.51408230254833, 139.12545060436523, 216.65341654114584, 181.24632290561863, 59.88996227474681, 165.15669725429305, 36.00792670950196, 189.64976576439986, 301.8305657369415, 149.23696462908376, 125.44780860848174, 101.80772975190143, 58.95772825491127, 35.96465770879195, 93.96198449385548, 183.15047188557267, 82.43662954016939, 69.85370666391663, 334.72427972427516, 130.70262412044298, 170.7916034865613, 263.9687920459881, 68.51879333223019, 175.41813879493725, 67.57482767103205, 160.95103860770314, 164.02379735636717, 93.319082126064, 17.095002041019615, 170.4477271534687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.258921325763136, "mean_inference_ms": 3.744020585932665, "mean_action_processing_ms": 1.6954827637379482, "mean_env_wait_ms": 10.136875479091184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003726482391357422, "StateBufferConnector_ms": 0.00532078742980957, "ViewRequirementAgentConnector_ms": 0.11379051208496094}, "num_episodes": 22, "episode_return_max": 356.7664163814079, "episode_return_min": 29.46279837604841, "episode_return_mean": 135.20726003486018, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.73904286814042, "num_env_steps_trained_throughput_per_sec": 84.73904286814042, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 47468.908, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47468.862, "sample_time_ms": 2115.359, "learn_time_ms": 45336.505, "learn_throughput": 88.229, "synch_weights_time_ms": 14.012}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-56-04", "timestamp": 1724149564, "time_this_iter_s": 47.244359254837036, "time_total_s": 2131.3608436584473, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120009790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2131.3608436584473, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 25.810447761194027, "ram_util_percent": 82.45820895522388}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.998914868680258, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.158925887516567, "policy_loss": -0.011036300802450607, "vf_loss": 7.167873514770831, "vf_explained_var": 0.17724929149188692, "kl": 0.010443325204006027, "entropy": 0.8216738065083822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.797760863594277, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.526526921892923, "policy_loss": -0.015221667342952319, "vf_loss": 5.539804059866245, "vf_explained_var": 0.15331006567314187, "kl": 0.009722653618168637, "entropy": 0.8644255436286724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 356.7664163814079, "episode_reward_min": 29.46279837604841, "episode_reward_mean": 132.30163504654746, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -334.361240019924, "predator_policy": 3.1192993306958714}, "policy_reward_max": {"prey_policy": 196.17058583329478, "predator_policy": 334.72427972427516}, "policy_reward_mean": {"prey_policy": -55.682515046440045, "predator_policy": 121.83333256971375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.62620545177101, 52.408075767434404, 173.9822277820773, 126.33615632559153, 190.89999999999927, 119.80940888317885, 169.33804841468387, 70.60613446876343, 356.7664163814079, 171.48451375631117, 191.87384076238786, 101.00842760415145, 149.46868347708855, 214.96498986270427, 150.82151405782955, 45.63224694079264, 191.1999999999994, 112.29999999999899, 333.7000000000002, 231.09999999999988, 168.98580948864907, 100.63875956318907, 72.36953466182523, 35.31254180658495, 90.59326908684065, 93.82129876593723, 42.49734784410317, 184.7750823866895, 95.7984227905797, 140.07272359483983, 69.73915147237236, 142.08663148095184, 86.19594752423436, 133.6077187840654, 135.0162849677379, 158.47702152296034, 61.95970957943907, 29.46279837604841, 184.86941726347982, 116.81534089987659, 177.16495815517308, 59.8060195324236, 251.52792959586702, 79.40272886998615, 104.45933487718794, 253.19999999999956, 138.77561634002774, 126.79999999999995, 256.8593861382675, 39.100000000000236, 351.1697021280947, 85.14017166249658, 227.54711472833546, 216.25770905853696, 168.71082425296274, 112.95145840848224, 108.87954584248676, 170.55260119968514, 161.99495974800837, 91.06761444861692, 131.54328347820066, 145.1114792046517, 209.66732573857774, 92.84139426891127, 173.62732900493063, 67.47913731999431, 128.056158593988, 75.20610495817209, 182.17222263238796, 136.01279973081324, 111.59325207408125, 49.500000000000156, 122.43250024380484, 246.02879326930127, 71.25336409877224, 268.9993817958573, 41.40000000000021, 89.78254035411092, 151.47327940755596, 47.205521528078606, 64.30000000000028, 157.96255156931878, 46.33751965876521, 117.23671209719706, 49.00503347164589, 74.43550905423942, 82.57451185327145, 165.36226010585213, 113.24018915240958, 180.8610148992483, 111.66632996917144, 188.42496252691603, 80.52313930675042, 178.12992516671534, 139.13989970573274, 57.52831050884943, 79.60871269337441, 70.16686274890381, 110.06524966716923, 106.4195660138078], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-269.4583399634077, -62.35448928747177, -182.98367032347596, -94.6432096697578, 120.04082566552523, -37.68190787599449, -69.81845588695688, -6.481865331585546, 18.175538465708236, 161.29999999999993, -37.43417282464628, -171.51193618698542, 41.555125281569204, -146.01545502743923, 0.9435208505391142, -58.63802592100751, 196.17058583329478, 79.2622870432213, -36.011846011438465, -10.878003572298457, 165.67576665936636, -165.02017394633262, -128.21233990697647, 7.3148153934679865, -238.69086637568705, 98.88631351325596, -13.171580506343709, -21.60800012293599, 10.2707415665392, -218.4136660633196, -170.9334985119703, -126.41896069481392, 112.54688921063529, -19.208632099158066, -19.3267904531847, 6.480562777132067, 118.30147934302946, 140.98357261346968, 26.920433478369617, 18.960220514169023, -87.64972342808925, 41.7701836343076, -137.4097232411235, -64.32494918137637, -60.637482830549516, -76.69454817320303, -171.37776058782885, 1.959316395298998, -109.219235117349, -98.2593710570487, -78.16898844258367, 35.14128114315942, -110.32771222385165, -246.23723873467236, -208.75054369892433, 110.89769107911943, -9.76319217821752, -37.04714515197772, -26.917367452865914, -217.89963278101953, -128.62593779640972, -114.25718017830214, 3.178172216137752, -224.33325216875917, -200.62729541085366, -79.67678437006057, 48.02422518883504, -198.83892265113312, 46.42612564477031, -7.58504050673058, -16.822757097032493, 67.79902858479095, -38.454399060965414, -149.4347623760152, -52.52079268252397, -255.69279083094008, 93.85243660603676, -103.97465605838464, 40.31887562600386, -208.78756368391024, 63.266406471448896, -243.90282644883197, -71.12067239237146, -163.89262764682465, 143.9448645847304, 45.26916125068066, -211.62761181234308, -36.81629727256919, -168.83085294993532, -18.225323591315018, 173.67301689864166, 29.28745427112669, 25.426650813629625, -235.93782831585827, -86.34362908206279, -80.51020775797639, -118.8778794152985, 124.67018522799468, -160.7632390912969, -88.59742418655054, 31.643947800807226, 86.92015774970099, -42.68673689076757, -272.06749375985925, 18.544282146891643, 38.019357161590676, -180.27670647861643, 29.766226411019087, -7.003903735251159, -65.99188635215212, -65.22251662142497, -91.05295020203327, -5.0240804704306425, -214.69737646296952, -115.79129923148447, 49.678599182502055, -58.15460241985961, 114.4701091703212, 27.935424844632756, -148.22975709448693, -12.719257734023488, 67.7359761676928, 37.89237274336816, -40.963443584483336, 55.945443783367374, 42.066427834285406, -132.70690966557623, -85.18220435777212, 118.26106106229739, -262.4817913153877, -144.01081511302914, -54.149580473890055, -69.62601292622055, -200.217567926556, -42.14374790153025, -107.69680666933789, 125.23209633179388, -168.71756617330786, -300.2456277130118, -14.809102922200509, -56.85151480960663, -58.81077147669514, -26.857728254911176, -18.5646577087917, 24.290306288630752, -178.97026242425403, 101.56883776773597, -7.830380702520682, -68.11149236673478, -326.06204737921144, 28.696863783217857, -194.45787751990983, -37.51879333222997, -165.01813879493784, -36.259326348720094, -102.48399957590411, -99.7169930818659, -6.152606993009506, -133.28307327021562, -7.054134396194325, 0.19515321737197025, -30.11593189208662, 10.553955374520484, 8.992073436040934, -18.548271907327056, -133.30667002566818, 15.004307235471222, -86.54497663924495, -119.97175642865136, -0.07198597921027455, -171.0174984679613, -152.69445676680593, -103.14244966949715, -80.77123232730123, -121.95188388258448, -40.552771923068555, 14.588280086259193, -109.21866464634152, -36.83471059066105, -113.90530027019967, 0.10862279131173125, -199.87498788674554, 57.799433775425065, -334.361240019924, -106.62056691979838, -62.62329618642279, 139.82331428019813, -132.27429841853288, 58.9889600692807, -46.99374509475279, -129.18537754873373, -82.40249204674885, -4.47057328533581, -186.82837854443912, -141.61223471391227, -64.6668551008861, -115.91961036541878, -60.863035775588656, 45.79417151223411, 18.18532649236431], "policy_predator_policy_reward": [281.470366105962, 87.96866859668765, 104.82642912264232, 225.2085266380251, 80.19635806284364, 11.42695192970364, 97.70929360667553, 104.92718393745855, 3.1192993306958714, 8.305162203595883, 127.05213900434326, 201.70337889046732, 93.40812234811557, 180.39025581243837, 51.97317711371171, 76.32746242551983, 20.157856323258173, 61.175687181633656, 98.24083969290628, 120.13352364714231, 125.88190698658097, 65.336341062773, 78.77760810941082, 143.1283440082494, 165.009586160025, 124.26365017949465, 95.92384542636125, 153.8207250656228, 244.85881183827985, 114.10562671633004, 180.4431069643094, 162.54159918326664, 53.65311078936472, 44.20863209915831, 76.97964901721306, 48.16657865883976, 39.198520656970494, 35.21642738653031, 164.93831890426196, 20.28102710319954, 107.48568754765053, 107.3796617347811, 118.62402698950959, 183.74940499617853, 107.65815283978654, 102.04341282579072, 116.09440746820613, 88.63657853090776, 138.48787228609473, 159.58400297514297, 96.49963965991861, 40.349366405442794, 154.02272442141285, 245.03957438121344, 166.59391945028915, 116.03401555620566, 41.05450726975753, 101.55425285101776, 99.36586184568688, 285.5238619830383, 158.60973143414714, 154.01253801293672, 136.23892982988974, 227.0027816036835, 211.60354973489282, 154.8964775702555, 207.20318750626927, 77.21922874009421, 44.375957757334135, 51.79924207236442, 100.94356803614883, 6.557181999052406, 53.77909451832878, 196.0697764980906, 77.82904273510403, 259.8473391544081, 157.56442636605325, 37.427210349774654, 117.06325776468647, 168.22077119309628, 127.3596348316112, 230.44174330094518, 195.03972468405286, 99.779594887566, 57.28597416458895, 5.0279295958674535, 124.36416344029594, 203.48247451460242, 196.1469077908485, 95.36860362758937, 44.03463346849751, 6.20489536173413, 78.33677183561493, 270.95002200664146, 121.99872577409538, 171.6551110659437, 166.83905987219237, 84.22802045337906, 167.8632390912965, 120.59742418654996, 139.03273072864167, 93.57286584894484, 302.69457019869566, 97.19983211442741, 74.18476623357385, 96.79870918627934, 243.0315912304009, 123.73659789573352, 195.45397047018685, 46.25264387017966, 197.03204469525116, 72.19488053668937, 118.02495552378048, 210.57604725210658, 180.78945992070084, 55.875841327966505, 59.55412905675759, 46.12532394078926, 154.66761929303158, 56.69432740543982, 33.84886229298805, 42.67770275154391, 46.09088789363021, 102.09166215213718, 63.82188195521077, 47.83357216571431, 196.93291820029285, 113.79759009196736, 234.02912885650284, 83.81893040151812, 126.51408230254833, 139.12545060436523, 216.65341654114584, 181.24632290561863, 59.88996227474681, 165.15669725429305, 36.00792670950196, 189.64976576439986, 301.8305657369415, 149.23696462908376, 125.44780860848174, 101.80772975190143, 58.95772825491127, 35.96465770879195, 93.96198449385548, 183.15047188557267, 82.43662954016939, 69.85370666391663, 334.72427972427516, 130.70262412044298, 170.7916034865613, 263.9687920459881, 68.51879333223019, 175.41813879493725, 67.57482767103205, 160.95103860770314, 164.02379735636717, 93.319082126064, 17.095002041019615, 170.4477271534687, 18.204846782628014, 76.01593189208674, 32.679225853918936, 105.73729690483952, 94.93070996941385, 103.26175162234661, 54.1089013475453, 134.66848015342583, 156.77854099143923, 12.27023488806775, 123.32234286880814, 274.8251214201978, 142.11848702189934, 124.36970682817012, 83.08760669884231, 244.7793092126629, 126.74704161051952, 81.12353210197271, 165.03909671700129, 166.56192904310748, 80.50343269264565, 230.9292623719592, 167.42023633410838, 297.5665324373073, 122.91243276556212, 126.85456964740888, 26.310997274695293, 144.2699120303546, 67.49374509475302, 59.6509396364527, 90.60022140735762, 178.51595869697317, 72.7959214481607, 198.11174307498837, 170.80583595213187, 105.64011661156994, 152.0197997168761, 134.82809609130067, 27.592998923921915, 14.847069085287472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.240529224596922, "mean_inference_ms": 3.7342430541678393, "mean_action_processing_ms": 1.6743850776275107, "mean_env_wait_ms": 10.129206498123395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037953853607177734, "StateBufferConnector_ms": 0.006339550018310547, "ViewRequirementAgentConnector_ms": 0.10569989681243896}, "num_episodes": 20, "episode_return_max": 356.7664163814079, "episode_return_min": 29.46279837604841, "episode_return_mean": 132.30163504654746, "episodes_this_iter": 20}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.33544145832907, "num_env_steps_trained_throughput_per_sec": 85.33544145832907, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 47335.941, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47335.895, "sample_time_ms": 2090.649, "learn_time_ms": 45228.067, "learn_throughput": 88.441, "synch_weights_time_ms": 14.264}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-56-51", "timestamp": 1724149611, "time_this_iter_s": 46.901182889938354, "time_total_s": 2178.2620265483856, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1200370d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2178.2620265483856, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 25.51212121212121, "ram_util_percent": 82.48636363636362}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.73331837811798, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.220965055435423, "policy_loss": -0.01378043285822348, "vf_loss": 7.232433097829263, "vf_explained_var": 0.08655931637400673, "kl": 0.011561963262982549, "entropy": 0.7979613821973246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.483115286044973, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.701355750977047, "policy_loss": -0.01613189327781872, "vf_loss": 5.715153628556186, "vf_explained_var": 0.15513029312961316, "kl": 0.011670041146747296, "entropy": 0.8228807828413747, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 351.1697021280947, "episode_reward_min": 29.46279837604841, "episode_reward_mean": 130.32928659117465, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -334.361240019924, "predator_policy": 3.191715454200097}, "policy_reward_max": {"prey_policy": 173.67301689864166, "predator_policy": 334.72427972427516}, "policy_reward_mean": {"prey_policy": -58.019807461154485, "predator_policy": 123.1844507567418}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.7000000000002, 231.09999999999988, 168.98580948864907, 100.63875956318907, 72.36953466182523, 35.31254180658495, 90.59326908684065, 93.82129876593723, 42.49734784410317, 184.7750823866895, 95.7984227905797, 140.07272359483983, 69.73915147237236, 142.08663148095184, 86.19594752423436, 133.6077187840654, 135.0162849677379, 158.47702152296034, 61.95970957943907, 29.46279837604841, 184.86941726347982, 116.81534089987659, 177.16495815517308, 59.8060195324236, 251.52792959586702, 79.40272886998615, 104.45933487718794, 253.19999999999956, 138.77561634002774, 126.79999999999995, 256.8593861382675, 39.100000000000236, 351.1697021280947, 85.14017166249658, 227.54711472833546, 216.25770905853696, 168.71082425296274, 112.95145840848224, 108.87954584248676, 170.55260119968514, 161.99495974800837, 91.06761444861692, 131.54328347820066, 145.1114792046517, 209.66732573857774, 92.84139426891127, 173.62732900493063, 67.47913731999431, 128.056158593988, 75.20610495817209, 182.17222263238796, 136.01279973081324, 111.59325207408125, 49.500000000000156, 122.43250024380484, 246.02879326930127, 71.25336409877224, 268.9993817958573, 41.40000000000021, 89.78254035411092, 151.47327940755596, 47.205521528078606, 64.30000000000028, 157.96255156931878, 46.33751965876521, 117.23671209719706, 49.00503347164589, 74.43550905423942, 82.57451185327145, 165.36226010585213, 113.24018915240958, 180.8610148992483, 111.66632996917144, 188.42496252691603, 80.52313930675042, 178.12992516671534, 139.13989970573274, 57.52831050884943, 79.60871269337441, 70.16686274890381, 110.06524966716923, 106.4195660138078, 137.98134158128013, 285.75827155974133, 66.0913588752538, 205.59549927399684, 164.38623729730838, 200.60459912214966, 55.20000000000042, 73.6053568865928, 105.21871839174415, 124.37933102071943, 186.4999999999993, 88.10764096636458, 40.162011322277635, 164.79263842358304, 224.53190100562244, 156.9999999999996, 94.50906638963338, 54.868072282625626], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [118.30147934302946, 140.98357261346968, 26.920433478369617, 18.960220514169023, -87.64972342808925, 41.7701836343076, -137.4097232411235, -64.32494918137637, -60.637482830549516, -76.69454817320303, -171.37776058782885, 1.959316395298998, -109.219235117349, -98.2593710570487, -78.16898844258367, 35.14128114315942, -110.32771222385165, -246.23723873467236, -208.75054369892433, 110.89769107911943, -9.76319217821752, -37.04714515197772, -26.917367452865914, -217.89963278101953, -128.62593779640972, -114.25718017830214, 3.178172216137752, -224.33325216875917, -200.62729541085366, -79.67678437006057, 48.02422518883504, -198.83892265113312, 46.42612564477031, -7.58504050673058, -16.822757097032493, 67.79902858479095, -38.454399060965414, -149.4347623760152, -52.52079268252397, -255.69279083094008, 93.85243660603676, -103.97465605838464, 40.31887562600386, -208.78756368391024, 63.266406471448896, -243.90282644883197, -71.12067239237146, -163.89262764682465, 143.9448645847304, 45.26916125068066, -211.62761181234308, -36.81629727256919, -168.83085294993532, -18.225323591315018, 173.67301689864166, 29.28745427112669, 25.426650813629625, -235.93782831585827, -86.34362908206279, -80.51020775797639, -118.8778794152985, 124.67018522799468, -160.7632390912969, -88.59742418655054, 31.643947800807226, 86.92015774970099, -42.68673689076757, -272.06749375985925, 18.544282146891643, 38.019357161590676, -180.27670647861643, 29.766226411019087, -7.003903735251159, -65.99188635215212, -65.22251662142497, -91.05295020203327, -5.0240804704306425, -214.69737646296952, -115.79129923148447, 49.678599182502055, -58.15460241985961, 114.4701091703212, 27.935424844632756, -148.22975709448693, -12.719257734023488, 67.7359761676928, 37.89237274336816, -40.963443584483336, 55.945443783367374, 42.066427834285406, -132.70690966557623, -85.18220435777212, 118.26106106229739, -262.4817913153877, -144.01081511302914, -54.149580473890055, -69.62601292622055, -200.217567926556, -42.14374790153025, -107.69680666933789, 125.23209633179388, -168.71756617330786, -300.2456277130118, -14.809102922200509, -56.85151480960663, -58.81077147669514, -26.857728254911176, -18.5646577087917, 24.290306288630752, -178.97026242425403, 101.56883776773597, -7.830380702520682, -68.11149236673478, -326.06204737921144, 28.696863783217857, -194.45787751990983, -37.51879333222997, -165.01813879493784, -36.259326348720094, -102.48399957590411, -99.7169930818659, -6.152606993009506, -133.28307327021562, -7.054134396194325, 0.19515321737197025, -30.11593189208662, 10.553955374520484, 8.992073436040934, -18.548271907327056, -133.30667002566818, 15.004307235471222, -86.54497663924495, -119.97175642865136, -0.07198597921027455, -171.0174984679613, -152.69445676680593, -103.14244966949715, -80.77123232730123, -121.95188388258448, -40.552771923068555, 14.588280086259193, -109.21866464634152, -36.83471059066105, -113.90530027019967, 0.10862279131173125, -199.87498788674554, 57.799433775425065, -334.361240019924, -106.62056691979838, -62.62329618642279, 139.82331428019813, -132.27429841853288, 58.9889600692807, -46.99374509475279, -129.18537754873373, -82.40249204674885, -4.47057328533581, -186.82837854443912, -141.61223471391227, -64.6668551008861, -115.91961036541878, -60.863035775588656, 45.79417151223411, 18.18532649236431, -211.52272268170717, -16.01151838155574, -9.968650576023089, 156.79999999999998, -13.66917367445977, -58.43313672519788, 33.12430790501752, -86.48347436302289, 51.307384831411, -27.660266892178463, -96.27515068249977, -25.99886534147408, -17.694903614143016, -42.00210449218856, -20.55100121541304, -47.285392522862, 22.283309653130488, -154.53596462340943, -52.86458517300005, -128.82824105139758, -161.17519114230814, 171.30828454579986, -56.11203934613781, -18.83458500924472, -269.6263907081659, -23.61284677643151, -117.06818337915007, 3.088291148189513, 70.15880093429126, 9.76605748074978, -37.53944684421853, 87.85562575726362, -165.41001565582044, -150.10765143656727, -247.57161197757685, -102.60034521552004], "policy_predator_policy_reward": [39.198520656970494, 35.21642738653031, 164.93831890426196, 20.28102710319954, 107.48568754765053, 107.3796617347811, 118.62402698950959, 183.74940499617853, 107.65815283978654, 102.04341282579072, 116.09440746820613, 88.63657853090776, 138.48787228609473, 159.58400297514297, 96.49963965991861, 40.349366405442794, 154.02272442141285, 245.03957438121344, 166.59391945028915, 116.03401555620566, 41.05450726975753, 101.55425285101776, 99.36586184568688, 285.5238619830383, 158.60973143414714, 154.01253801293672, 136.23892982988974, 227.0027816036835, 211.60354973489282, 154.8964775702555, 207.20318750626927, 77.21922874009421, 44.375957757334135, 51.79924207236442, 100.94356803614883, 6.557181999052406, 53.77909451832878, 196.0697764980906, 77.82904273510403, 259.8473391544081, 157.56442636605325, 37.427210349774654, 117.06325776468647, 168.22077119309628, 127.3596348316112, 230.44174330094518, 195.03972468405286, 99.779594887566, 57.28597416458895, 5.0279295958674535, 124.36416344029594, 203.48247451460242, 196.1469077908485, 95.36860362758937, 44.03463346849751, 6.20489536173413, 78.33677183561493, 270.95002200664146, 121.99872577409538, 171.6551110659437, 166.83905987219237, 84.22802045337906, 167.8632390912965, 120.59742418654996, 139.03273072864167, 93.57286584894484, 302.69457019869566, 97.19983211442741, 74.18476623357385, 96.79870918627934, 243.0315912304009, 123.73659789573352, 195.45397047018685, 46.25264387017966, 197.03204469525116, 72.19488053668937, 118.02495552378048, 210.57604725210658, 180.78945992070084, 55.875841327966505, 59.55412905675759, 46.12532394078926, 154.66761929303158, 56.69432740543982, 33.84886229298805, 42.67770275154391, 46.09088789363021, 102.09166215213718, 63.82188195521077, 47.83357216571431, 196.93291820029285, 113.79759009196736, 234.02912885650284, 83.81893040151812, 126.51408230254833, 139.12545060436523, 216.65341654114584, 181.24632290561863, 59.88996227474681, 165.15669725429305, 36.00792670950196, 189.64976576439986, 301.8305657369415, 149.23696462908376, 125.44780860848174, 101.80772975190143, 58.95772825491127, 35.96465770879195, 93.96198449385548, 183.15047188557267, 82.43662954016939, 69.85370666391663, 334.72427972427516, 130.70262412044298, 170.7916034865613, 263.9687920459881, 68.51879333223019, 175.41813879493725, 67.57482767103205, 160.95103860770314, 164.02379735636717, 93.319082126064, 17.095002041019615, 170.4477271534687, 18.204846782628014, 76.01593189208674, 32.679225853918936, 105.73729690483952, 94.93070996941385, 103.26175162234661, 54.1089013475453, 134.66848015342583, 156.77854099143923, 12.27023488806775, 123.32234286880814, 274.8251214201978, 142.11848702189934, 124.36970682817012, 83.08760669884231, 244.7793092126629, 126.74704161051952, 81.12353210197271, 165.03909671700129, 166.56192904310748, 80.50343269264565, 230.9292623719592, 167.42023633410838, 297.5665324373073, 122.91243276556212, 126.85456964740888, 26.310997274695293, 144.2699120303546, 67.49374509475302, 59.6509396364527, 90.60022140735762, 178.51595869697317, 72.7959214481607, 198.11174307498837, 170.80583595213187, 105.64011661156994, 152.0197997168761, 134.82809609130067, 27.592998923921915, 14.847069085287472, 180.1279683312245, 185.3876143133187, 45.19582895283445, 93.73109318292968, 96.97883391374879, 41.21483536116218, 138.91177647506566, 120.04288925693643, 121.42664117077885, 19.31247818729718, 126.1312476086321, 196.7473675374916, 44.53476659669855, 70.36224150963346, 6.53980682662695, 134.90194379824155, 35.236976940196655, 202.23439642182672, 135.57608826026402, 170.49606898485288, 173.17519114230745, 3.191715454200097, 125.91203934613759, 37.14222597560994, 138.35995585239272, 195.04129295448237, 124.89957265096974, 153.87295800357455, 81.15281264858706, 63.454229941994456, 95.77815489976855, 10.905666187186581, 213.72440803129362, 196.3023254507272, 186.40346867188478, 218.63656080383666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.219326564702394, "mean_inference_ms": 3.723898618516699, "mean_action_processing_ms": 1.6583966916103066, "mean_env_wait_ms": 10.12862913492122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004896879196166992, "StateBufferConnector_ms": 0.006576895713806152, "ViewRequirementAgentConnector_ms": 0.13680148124694824}, "num_episodes": 18, "episode_return_max": 351.1697021280947, "episode_return_min": 29.46279837604841, "episode_return_mean": 130.32928659117465, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.6894353522001, "num_env_steps_trained_throughput_per_sec": 83.6894353522001, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 47343.777, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47343.729, "sample_time_ms": 2092.64, "learn_time_ms": 45233.491, "learn_throughput": 88.43, "synch_weights_time_ms": 14.52}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-57-39", "timestamp": 1724149659, "time_this_iter_s": 47.84444999694824, "time_total_s": 2226.106476545334, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12002bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2226.106476545334, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 27.820588235294117, "ram_util_percent": 82.87205882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.873333220002513, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.88125395547776, "policy_loss": -0.01696079928223438, "vf_loss": 6.896032906840087, "vf_explained_var": 0.2674589760404415, "kl": 0.01090931186289896, "entropy": 0.8011010458860448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.573606057835635, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.111668050099933, "policy_loss": -0.016501976321352814, "vf_loss": 5.126162138313212, "vf_explained_var": 0.15550522810567624, "kl": 0.010039461432295857, "entropy": 0.883396349224464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 351.1697021280947, "episode_reward_min": 39.100000000000236, "episode_reward_mean": 129.58007542585915, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -334.361240019924, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 173.67301689864166, "predator_policy": 334.72427972427516}, "policy_reward_mean": {"prey_policy": -57.24040136848835, "predator_policy": 122.03043908141794}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.81534089987659, 177.16495815517308, 59.8060195324236, 251.52792959586702, 79.40272886998615, 104.45933487718794, 253.19999999999956, 138.77561634002774, 126.79999999999995, 256.8593861382675, 39.100000000000236, 351.1697021280947, 85.14017166249658, 227.54711472833546, 216.25770905853696, 168.71082425296274, 112.95145840848224, 108.87954584248676, 170.55260119968514, 161.99495974800837, 91.06761444861692, 131.54328347820066, 145.1114792046517, 209.66732573857774, 92.84139426891127, 173.62732900493063, 67.47913731999431, 128.056158593988, 75.20610495817209, 182.17222263238796, 136.01279973081324, 111.59325207408125, 49.500000000000156, 122.43250024380484, 246.02879326930127, 71.25336409877224, 268.9993817958573, 41.40000000000021, 89.78254035411092, 151.47327940755596, 47.205521528078606, 64.30000000000028, 157.96255156931878, 46.33751965876521, 117.23671209719706, 49.00503347164589, 74.43550905423942, 82.57451185327145, 165.36226010585213, 113.24018915240958, 180.8610148992483, 111.66632996917144, 188.42496252691603, 80.52313930675042, 178.12992516671534, 139.13989970573274, 57.52831050884943, 79.60871269337441, 70.16686274890381, 110.06524966716923, 106.4195660138078, 137.98134158128013, 285.75827155974133, 66.0913588752538, 205.59549927399684, 164.38623729730838, 200.60459912214966, 55.20000000000042, 73.6053568865928, 105.21871839174415, 124.37933102071943, 186.4999999999993, 88.10764096636458, 40.162011322277635, 164.79263842358304, 224.53190100562244, 156.9999999999996, 94.50906638963338, 54.868072282625626, 108.7563883366509, 134.59691985952438, 67.29270612427557, 164.72757520741754, 179.6787295360263, 177.15132293470046, 167.39999999999915, 104.10133082092335, 39.383163612577604, 203.5999999999993, 164.5, 90.48407318748087, 118.71602031082926, 48.74216693453219, 157.36687735021502, 96.70373505065105, 55.897780210731256, 49.12277721203025, 73.79164404673489, 179.47127511489043, 134.67386857879012], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [40.31887562600386, -208.78756368391024, 63.266406471448896, -243.90282644883197, -71.12067239237146, -163.89262764682465, 143.9448645847304, 45.26916125068066, -211.62761181234308, -36.81629727256919, -168.83085294993532, -18.225323591315018, 173.67301689864166, 29.28745427112669, 25.426650813629625, -235.93782831585827, -86.34362908206279, -80.51020775797639, -118.8778794152985, 124.67018522799468, -160.7632390912969, -88.59742418655054, 31.643947800807226, 86.92015774970099, -42.68673689076757, -272.06749375985925, 18.544282146891643, 38.019357161590676, -180.27670647861643, 29.766226411019087, -7.003903735251159, -65.99188635215212, -65.22251662142497, -91.05295020203327, -5.0240804704306425, -214.69737646296952, -115.79129923148447, 49.678599182502055, -58.15460241985961, 114.4701091703212, 27.935424844632756, -148.22975709448693, -12.719257734023488, 67.7359761676928, 37.89237274336816, -40.963443584483336, 55.945443783367374, 42.066427834285406, -132.70690966557623, -85.18220435777212, 118.26106106229739, -262.4817913153877, -144.01081511302914, -54.149580473890055, -69.62601292622055, -200.217567926556, -42.14374790153025, -107.69680666933789, 125.23209633179388, -168.71756617330786, -300.2456277130118, -14.809102922200509, -56.85151480960663, -58.81077147669514, -26.857728254911176, -18.5646577087917, 24.290306288630752, -178.97026242425403, 101.56883776773597, -7.830380702520682, -68.11149236673478, -326.06204737921144, 28.696863783217857, -194.45787751990983, -37.51879333222997, -165.01813879493784, -36.259326348720094, -102.48399957590411, -99.7169930818659, -6.152606993009506, -133.28307327021562, -7.054134396194325, 0.19515321737197025, -30.11593189208662, 10.553955374520484, 8.992073436040934, -18.548271907327056, -133.30667002566818, 15.004307235471222, -86.54497663924495, -119.97175642865136, -0.07198597921027455, -171.0174984679613, -152.69445676680593, -103.14244966949715, -80.77123232730123, -121.95188388258448, -40.552771923068555, 14.588280086259193, -109.21866464634152, -36.83471059066105, -113.90530027019967, 0.10862279131173125, -199.87498788674554, 57.799433775425065, -334.361240019924, -106.62056691979838, -62.62329618642279, 139.82331428019813, -132.27429841853288, 58.9889600692807, -46.99374509475279, -129.18537754873373, -82.40249204674885, -4.47057328533581, -186.82837854443912, -141.61223471391227, -64.6668551008861, -115.91961036541878, -60.863035775588656, 45.79417151223411, 18.18532649236431, -211.52272268170717, -16.01151838155574, -9.968650576023089, 156.79999999999998, -13.66917367445977, -58.43313672519788, 33.12430790501752, -86.48347436302289, 51.307384831411, -27.660266892178463, -96.27515068249977, -25.99886534147408, -17.694903614143016, -42.00210449218856, -20.55100121541304, -47.285392522862, 22.283309653130488, -154.53596462340943, -52.86458517300005, -128.82824105139758, -161.17519114230814, 171.30828454579986, -56.11203934613781, -18.83458500924472, -269.6263907081659, -23.61284677643151, -117.06818337915007, 3.088291148189513, 70.15880093429126, 9.76605748074978, -37.53944684421853, 87.85562575726362, -165.41001565582044, -150.10765143656727, -247.57161197757685, -102.60034521552004, -131.90683268797213, -44.06382597748678, -72.25397772081396, -98.7766520799188, -24.527358361208258, -0.21703373227236786, -141.6221115734233, -31.02413932870416, 49.7313318127737, -278.97138845221826, -187.21376378724193, 35.546108216406964, 63.61129520677576, 66.06722018744823, 31.810774803768226, -9.177340241298074, -233.29301069548418, -168.11106985259082, 138.98695409121723, 15.487647583556573, 69.8044917781849, 15.68204774806334, -53.555088216273916, -162.88505099805133, -65.88217864882702, -145.2095360309618, -80.29188882567756, -53.09971637944936, 16.71438452308765, -7.600851966500031, -81.02342658206356, -22.121000778823785, -204.56288742690742, -86.2210981331375, 1.9034452114050386, -255.38067769439067, -131.2027352907141, -272.43588078364724, 159.5, -19.93196900397617, 17.226299580693386, -20.943309987417116], "policy_predator_policy_reward": [117.06325776468647, 168.22077119309628, 127.3596348316112, 230.44174330094518, 195.03972468405286, 99.779594887566, 57.28597416458895, 5.0279295958674535, 124.36416344029594, 203.48247451460242, 196.1469077908485, 95.36860362758937, 44.03463346849751, 6.20489536173413, 78.33677183561493, 270.95002200664146, 121.99872577409538, 171.6551110659437, 166.83905987219237, 84.22802045337906, 167.8632390912965, 120.59742418654996, 139.03273072864167, 93.57286584894484, 302.69457019869566, 97.19983211442741, 74.18476623357385, 96.79870918627934, 243.0315912304009, 123.73659789573352, 195.45397047018685, 46.25264387017966, 197.03204469525116, 72.19488053668937, 118.02495552378048, 210.57604725210658, 180.78945992070084, 55.875841327966505, 59.55412905675759, 46.12532394078926, 154.66761929303158, 56.69432740543982, 33.84886229298805, 42.67770275154391, 46.09088789363021, 102.09166215213718, 63.82188195521077, 47.83357216571431, 196.93291820029285, 113.79759009196736, 234.02912885650284, 83.81893040151812, 126.51408230254833, 139.12545060436523, 216.65341654114584, 181.24632290561863, 59.88996227474681, 165.15669725429305, 36.00792670950196, 189.64976576439986, 301.8305657369415, 149.23696462908376, 125.44780860848174, 101.80772975190143, 58.95772825491127, 35.96465770879195, 93.96198449385548, 183.15047188557267, 82.43662954016939, 69.85370666391663, 334.72427972427516, 130.70262412044298, 170.7916034865613, 263.9687920459881, 68.51879333223019, 175.41813879493725, 67.57482767103205, 160.95103860770314, 164.02379735636717, 93.319082126064, 17.095002041019615, 170.4477271534687, 18.204846782628014, 76.01593189208674, 32.679225853918936, 105.73729690483952, 94.93070996941385, 103.26175162234661, 54.1089013475453, 134.66848015342583, 156.77854099143923, 12.27023488806775, 123.32234286880814, 274.8251214201978, 142.11848702189934, 124.36970682817012, 83.08760669884231, 244.7793092126629, 126.74704161051952, 81.12353210197271, 165.03909671700129, 166.56192904310748, 80.50343269264565, 230.9292623719592, 167.42023633410838, 297.5665324373073, 122.91243276556212, 126.85456964740888, 26.310997274695293, 144.2699120303546, 67.49374509475302, 59.6509396364527, 90.60022140735762, 178.51595869697317, 72.7959214481607, 198.11174307498837, 170.80583595213187, 105.64011661156994, 152.0197997168761, 134.82809609130067, 27.592998923921915, 14.847069085287472, 180.1279683312245, 185.3876143133187, 45.19582895283445, 93.73109318292968, 96.97883391374879, 41.21483536116218, 138.91177647506566, 120.04288925693643, 121.42664117077885, 19.31247818729718, 126.1312476086321, 196.7473675374916, 44.53476659669855, 70.36224150963346, 6.53980682662695, 134.90194379824155, 35.236976940196655, 202.23439642182672, 135.57608826026402, 170.49606898485288, 173.17519114230745, 3.191715454200097, 125.91203934613759, 37.14222597560994, 138.35995585239272, 195.04129295448237, 124.89957265096974, 153.87295800357455, 81.15281264858706, 63.454229941994456, 95.77815489976855, 10.905666187186581, 213.72440803129362, 196.3023254507272, 186.40346867188478, 218.63656080383666, 225.561493178003, 59.16555382410672, 143.58572640856528, 162.04182325169208, 19.111918262054182, 72.9251799557019, 208.21283400434095, 129.1609921052042, 255.84233400659477, 153.07645216887755, 195.47694329117087, 133.34203521436444, 37.72148460577619, 0.0, 46.55474727294718, 34.91314898550618, 257.69356301598566, 183.09368114466668, 45.904979428592156, 3.220418896633992, 55.70633057217468, 23.30712990157724, 83.68830442661462, 223.23590797519174, 188.83003181759486, 140.9777031730232, 42.01454621828732, 140.11922592137154, 15.560919777762878, 132.6924250158649, 181.86170505655625, 17.986457354981912, 192.18400317213172, 154.49776259864385, 61.942037531010214, 240.65797216400526, 181.1626504037162, 296.2676097173802, 1.6712751148909768, 38.2319690039764, 57.61224667592159, 80.77863230959247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.214250991602175, "mean_inference_ms": 3.7142222298552934, "mean_action_processing_ms": 1.651251468096632, "mean_env_wait_ms": 10.129089269500547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005576014518737793, "StateBufferConnector_ms": 0.0059593915939331055, "ViewRequirementAgentConnector_ms": 0.15633225440979004}, "num_episodes": 21, "episode_return_max": 351.1697021280947, "episode_return_min": 39.100000000000236, "episode_return_mean": 129.58007542585915, "episodes_this_iter": 21}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.02659643193202, "num_env_steps_trained_throughput_per_sec": 76.02659643193202, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 47873.588, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47873.54, "sample_time_ms": 2136.539, "learn_time_ms": 45718.095, "learn_throughput": 87.493, "synch_weights_time_ms": 15.347}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-58-31", "timestamp": 1724149711, "time_this_iter_s": 52.64174485206604, "time_total_s": 2278.7482213974, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1200a1280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2278.7482213974, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 39.00666666666666, "ram_util_percent": 82.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.461368649977224, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.030930926560094, "policy_loss": -0.01661340447830125, "vf_loss": 7.0451649897943724, "vf_explained_var": 0.18584423686461474, "kl": 0.011896651002169445, "entropy": 0.7787174673622879, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.337485612889446, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.699244739138891, "policy_loss": -0.014509177035602824, "vf_loss": 5.711506586226206, "vf_explained_var": 0.15466621461368743, "kl": 0.01123660184213862, "entropy": 0.8095773746412267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 285.75827155974133, "episode_reward_min": 22.424200949617124, "episode_reward_mean": 116.9774166747294, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -334.361240019924, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.30828454579986, "predator_policy": 334.72427972427516}, "policy_reward_mean": {"prey_policy": -64.8548531875629, "predator_policy": 123.34356152492757}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.84139426891127, 173.62732900493063, 67.47913731999431, 128.056158593988, 75.20610495817209, 182.17222263238796, 136.01279973081324, 111.59325207408125, 49.500000000000156, 122.43250024380484, 246.02879326930127, 71.25336409877224, 268.9993817958573, 41.40000000000021, 89.78254035411092, 151.47327940755596, 47.205521528078606, 64.30000000000028, 157.96255156931878, 46.33751965876521, 117.23671209719706, 49.00503347164589, 74.43550905423942, 82.57451185327145, 165.36226010585213, 113.24018915240958, 180.8610148992483, 111.66632996917144, 188.42496252691603, 80.52313930675042, 178.12992516671534, 139.13989970573274, 57.52831050884943, 79.60871269337441, 70.16686274890381, 110.06524966716923, 106.4195660138078, 137.98134158128013, 285.75827155974133, 66.0913588752538, 205.59549927399684, 164.38623729730838, 200.60459912214966, 55.20000000000042, 73.6053568865928, 105.21871839174415, 124.37933102071943, 186.4999999999993, 88.10764096636458, 40.162011322277635, 164.79263842358304, 224.53190100562244, 156.9999999999996, 94.50906638963338, 54.868072282625626, 108.7563883366509, 134.59691985952438, 67.29270612427557, 164.72757520741754, 179.6787295360263, 177.15132293470046, 167.39999999999915, 104.10133082092335, 39.383163612577604, 203.5999999999993, 164.5, 90.48407318748087, 118.71602031082926, 48.74216693453219, 157.36687735021502, 96.70373505065105, 55.897780210731256, 49.12277721203025, 73.79164404673489, 179.47127511489043, 134.67386857879012, 81.92562122616134, 73.69998994197091, 22.424200949617124, 28.19308214579184, 87.69977026983375, 145.30128511913978, 49.26628488293568, 39.90154820465489, 121.89999999999952, 81.58952966447063, 53.838542110433835, 223.42773597180843, 134.16863138656873, 64.0155526214176, 56.22405151528324, 161.4999999999996, 100.698843469651, 188.223481592549, 144.9937742973146, 108.11524173502798, 158.18356629938307, 199.2455983564919, 147.97960210526495, 51.72329532919876], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-132.70690966557623, -85.18220435777212, 118.26106106229739, -262.4817913153877, -144.01081511302914, -54.149580473890055, -69.62601292622055, -200.217567926556, -42.14374790153025, -107.69680666933789, 125.23209633179388, -168.71756617330786, -300.2456277130118, -14.809102922200509, -56.85151480960663, -58.81077147669514, -26.857728254911176, -18.5646577087917, 24.290306288630752, -178.97026242425403, 101.56883776773597, -7.830380702520682, -68.11149236673478, -326.06204737921144, 28.696863783217857, -194.45787751990983, -37.51879333222997, -165.01813879493784, -36.259326348720094, -102.48399957590411, -99.7169930818659, -6.152606993009506, -133.28307327021562, -7.054134396194325, 0.19515321737197025, -30.11593189208662, 10.553955374520484, 8.992073436040934, -18.548271907327056, -133.30667002566818, 15.004307235471222, -86.54497663924495, -119.97175642865136, -0.07198597921027455, -171.0174984679613, -152.69445676680593, -103.14244966949715, -80.77123232730123, -121.95188388258448, -40.552771923068555, 14.588280086259193, -109.21866464634152, -36.83471059066105, -113.90530027019967, 0.10862279131173125, -199.87498788674554, 57.799433775425065, -334.361240019924, -106.62056691979838, -62.62329618642279, 139.82331428019813, -132.27429841853288, 58.9889600692807, -46.99374509475279, -129.18537754873373, -82.40249204674885, -4.47057328533581, -186.82837854443912, -141.61223471391227, -64.6668551008861, -115.91961036541878, -60.863035775588656, 45.79417151223411, 18.18532649236431, -211.52272268170717, -16.01151838155574, -9.968650576023089, 156.79999999999998, -13.66917367445977, -58.43313672519788, 33.12430790501752, -86.48347436302289, 51.307384831411, -27.660266892178463, -96.27515068249977, -25.99886534147408, -17.694903614143016, -42.00210449218856, -20.55100121541304, -47.285392522862, 22.283309653130488, -154.53596462340943, -52.86458517300005, -128.82824105139758, -161.17519114230814, 171.30828454579986, -56.11203934613781, -18.83458500924472, -269.6263907081659, -23.61284677643151, -117.06818337915007, 3.088291148189513, 70.15880093429126, 9.76605748074978, -37.53944684421853, 87.85562575726362, -165.41001565582044, -150.10765143656727, -247.57161197757685, -102.60034521552004, -131.90683268797213, -44.06382597748678, -72.25397772081396, -98.7766520799188, -24.527358361208258, -0.21703373227236786, -141.6221115734233, -31.02413932870416, 49.7313318127737, -278.97138845221826, -187.21376378724193, 35.546108216406964, 63.61129520677576, 66.06722018744823, 31.810774803768226, -9.177340241298074, -233.29301069548418, -168.11106985259082, 138.98695409121723, 15.487647583556573, 69.8044917781849, 15.68204774806334, -53.555088216273916, -162.88505099805133, -65.88217864882702, -145.2095360309618, -80.29188882567756, -53.09971637944936, 16.71438452308765, -7.600851966500031, -81.02342658206356, -22.121000778823785, -204.56288742690742, -86.2210981331375, 1.9034452114050386, -255.38067769439067, -131.2027352907141, -272.43588078364724, 159.5, -19.93196900397617, 17.226299580693386, -20.943309987417116, 4.873738457841874, -298.24961111157825, -83.78963415150997, -258.91912780222555, -244.68376312347738, -122.8218608014226, -20.27000229269707, -221.9329342217624, -44.66111996915771, -63.350795551813476, -117.76757634365275, -12.78905709052746, -229.64727114036998, -37.919035140276456, -28.18399410814859, -145.42842752771435, -25.630266659321595, 27.54421997937121, -78.2382804668246, -21.784331642456195, -83.81319015840597, -119.67828713676224, -27.134243383400005, 141.2384578540425, -62.40560903208396, 25.135806400869352, -235.83310018236858, -52.057796120787515, -63.41866345274272, -168.12905562470246, -31.84420115764442, 85.98608198817809, -25.173383997133335, -82.36434355048787, -205.86138143186682, 25.97962177157468, 11.441174635508007, -25.82504095603585, -119.56304743858146, -139.2819527185633, -28.202313352009664, -101.68813585257914, -90.78467957439145, 91.12673570652977, -162.53946755041756, 43.27593615030192, 20.000000000000014, -85.46820948777543], "policy_predator_policy_reward": [196.93291820029285, 113.79759009196736, 234.02912885650284, 83.81893040151812, 126.51408230254833, 139.12545060436523, 216.65341654114584, 181.24632290561863, 59.88996227474681, 165.15669725429305, 36.00792670950196, 189.64976576439986, 301.8305657369415, 149.23696462908376, 125.44780860848174, 101.80772975190143, 58.95772825491127, 35.96465770879195, 93.96198449385548, 183.15047188557267, 82.43662954016939, 69.85370666391663, 334.72427972427516, 130.70262412044298, 170.7916034865613, 263.9687920459881, 68.51879333223019, 175.41813879493725, 67.57482767103205, 160.95103860770314, 164.02379735636717, 93.319082126064, 17.095002041019615, 170.4477271534687, 18.204846782628014, 76.01593189208674, 32.679225853918936, 105.73729690483952, 94.93070996941385, 103.26175162234661, 54.1089013475453, 134.66848015342583, 156.77854099143923, 12.27023488806775, 123.32234286880814, 274.8251214201978, 142.11848702189934, 124.36970682817012, 83.08760669884231, 244.7793092126629, 126.74704161051952, 81.12353210197271, 165.03909671700129, 166.56192904310748, 80.50343269264565, 230.9292623719592, 167.42023633410838, 297.5665324373073, 122.91243276556212, 126.85456964740888, 26.310997274695293, 144.2699120303546, 67.49374509475302, 59.6509396364527, 90.60022140735762, 178.51595869697317, 72.7959214481607, 198.11174307498837, 170.80583595213187, 105.64011661156994, 152.0197997168761, 134.82809609130067, 27.592998923921915, 14.847069085287472, 180.1279683312245, 185.3876143133187, 45.19582895283445, 93.73109318292968, 96.97883391374879, 41.21483536116218, 138.91177647506566, 120.04288925693643, 121.42664117077885, 19.31247818729718, 126.1312476086321, 196.7473675374916, 44.53476659669855, 70.36224150963346, 6.53980682662695, 134.90194379824155, 35.236976940196655, 202.23439642182672, 135.57608826026402, 170.49606898485288, 173.17519114230745, 3.191715454200097, 125.91203934613759, 37.14222597560994, 138.35995585239272, 195.04129295448237, 124.89957265096974, 153.87295800357455, 81.15281264858706, 63.454229941994456, 95.77815489976855, 10.905666187186581, 213.72440803129362, 196.3023254507272, 186.40346867188478, 218.63656080383666, 225.561493178003, 59.16555382410672, 143.58572640856528, 162.04182325169208, 19.111918262054182, 72.9251799557019, 208.21283400434095, 129.1609921052042, 255.84233400659477, 153.07645216887755, 195.47694329117087, 133.34203521436444, 37.72148460577619, 0.0, 46.55474727294718, 34.91314898550618, 257.69356301598566, 183.09368114466668, 45.904979428592156, 3.220418896633992, 55.70633057217468, 23.30712990157724, 83.68830442661462, 223.23590797519174, 188.83003181759486, 140.9777031730232, 42.01454621828732, 140.11922592137154, 15.560919777762878, 132.6924250158649, 181.86170505655625, 17.986457354981912, 192.18400317213172, 154.49776259864385, 61.942037531010214, 240.65797216400526, 181.1626504037162, 296.2676097173802, 1.6712751148909768, 38.2319690039764, 57.61224667592159, 80.77863230959247, 106.24573563094899, 269.0557582489486, 141.9076100670942, 274.50114182861216, 265.126034236764, 124.80379063775268, 73.93055945243874, 196.46545920781233, 95.09320324034499, 100.61848255045857, 106.45401388221549, 169.40390467110484, 247.12982426761303, 69.70276689596889, 51.828946402989686, 161.68502343752795, 86.34775298833847, 33.638293691611906, 55.73626596565801, 125.87587580809394, 168.7930147973831, 88.53700460821793, 108.39817836657993, 0.9253431345859633, 147.10137898550505, 24.337055032278467, 197.6328803043941, 154.2735686201789, 106.92349963198478, 180.8482709607435, 68.91578342241618, 38.4423357470502, 110.61485924134647, 97.62171177592529, 176.42693356636315, 191.67830768647855, 87.0426414591756, 72.33499915866702, 189.17616572325431, 177.7840761689185, 174.54086414447286, 113.53315135949919, 160.79970464611517, 38.10383757823844, 57.00428807762181, 210.23884542775855, 5.623295329198483, 111.568209487775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.217827130065035, "mean_inference_ms": 3.7052874388240538, "mean_action_processing_ms": 1.629737676241299, "mean_env_wait_ms": 10.128111881559693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005599379539489746, "StateBufferConnector_ms": 0.006170511245727539, "ViewRequirementAgentConnector_ms": 0.19067513942718506}, "num_episodes": 24, "episode_return_max": 285.75827155974133, "episode_return_min": 22.424200949617124, "episode_return_mean": 116.9774166747294, "episodes_this_iter": 24}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.34023963213636, "num_env_steps_trained_throughput_per_sec": 75.34023963213636, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 48448.494, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48448.422, "sample_time_ms": 2137.505, "learn_time_ms": 46291.699, "learn_throughput": 86.409, "synch_weights_time_ms": 15.488}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "2ee0d_00000", "date": "2024-08-20_15-59-25", "timestamp": 1724149765, "time_this_iter_s": 53.14046001434326, "time_total_s": 2331.888681411743, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12002b280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2331.888681411743, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 39.07236842105263, "ram_util_percent": 81.46447368421053}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.441018249938097, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.112808328709274, "policy_loss": -0.015464666693486156, "vf_loss": 7.12618063139537, "vf_explained_var": 0.24403161917413985, "kl": 0.010461749804018943, "entropy": 0.7933807918318996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.844284876755306, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.780433421412473, "policy_loss": -0.013768163140340852, "vf_loss": 5.7921625800864405, "vf_explained_var": 0.2136547596997054, "kl": 0.010195002909725108, "entropy": 0.792557898368785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 285.75827155974133, "episode_reward_min": 22.424200949617124, "episode_reward_mean": 117.06565012982712, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -342.9175236893535, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.30828454579986, "predator_policy": 360.5124967565016}, "policy_reward_mean": {"prey_policy": -64.1508277417041, "predator_policy": 122.68365280661766}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.33751965876521, 117.23671209719706, 49.00503347164589, 74.43550905423942, 82.57451185327145, 165.36226010585213, 113.24018915240958, 180.8610148992483, 111.66632996917144, 188.42496252691603, 80.52313930675042, 178.12992516671534, 139.13989970573274, 57.52831050884943, 79.60871269337441, 70.16686274890381, 110.06524966716923, 106.4195660138078, 137.98134158128013, 285.75827155974133, 66.0913588752538, 205.59549927399684, 164.38623729730838, 200.60459912214966, 55.20000000000042, 73.6053568865928, 105.21871839174415, 124.37933102071943, 186.4999999999993, 88.10764096636458, 40.162011322277635, 164.79263842358304, 224.53190100562244, 156.9999999999996, 94.50906638963338, 54.868072282625626, 108.7563883366509, 134.59691985952438, 67.29270612427557, 164.72757520741754, 179.6787295360263, 177.15132293470046, 167.39999999999915, 104.10133082092335, 39.383163612577604, 203.5999999999993, 164.5, 90.48407318748087, 118.71602031082926, 48.74216693453219, 157.36687735021502, 96.70373505065105, 55.897780210731256, 49.12277721203025, 73.79164404673489, 179.47127511489043, 134.67386857879012, 81.92562122616134, 73.69998994197091, 22.424200949617124, 28.19308214579184, 87.69977026983375, 145.30128511913978, 49.26628488293568, 39.90154820465489, 121.89999999999952, 81.58952966447063, 53.838542110433835, 223.42773597180843, 134.16863138656873, 64.0155526214176, 56.22405151528324, 161.4999999999996, 100.698843469651, 188.223481592549, 144.9937742973146, 108.11524173502798, 158.18356629938307, 199.2455983564919, 147.97960210526495, 51.72329532919876, 139.2210824915694, 182.54492433929082, 59.80000000000009, 39.38658640868724, 146.07595686560327, 87.3579612521, 153.11525583557722, 113.46411579355771, 127.41072834477447, 108.19765766627299, 45.80000000000041, 210.04728307640636, 114.81741272962145, 45.10000000000023, 272.1020343629796, 116.90128632731303, 79.80739086609972, 55.9000000000004, 189.0999999999994], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.548271907327056, -133.30667002566818, 15.004307235471222, -86.54497663924495, -119.97175642865136, -0.07198597921027455, -171.0174984679613, -152.69445676680593, -103.14244966949715, -80.77123232730123, -121.95188388258448, -40.552771923068555, 14.588280086259193, -109.21866464634152, -36.83471059066105, -113.90530027019967, 0.10862279131173125, -199.87498788674554, 57.799433775425065, -334.361240019924, -106.62056691979838, -62.62329618642279, 139.82331428019813, -132.27429841853288, 58.9889600692807, -46.99374509475279, -129.18537754873373, -82.40249204674885, -4.47057328533581, -186.82837854443912, -141.61223471391227, -64.6668551008861, -115.91961036541878, -60.863035775588656, 45.79417151223411, 18.18532649236431, -211.52272268170717, -16.01151838155574, -9.968650576023089, 156.79999999999998, -13.66917367445977, -58.43313672519788, 33.12430790501752, -86.48347436302289, 51.307384831411, -27.660266892178463, -96.27515068249977, -25.99886534147408, -17.694903614143016, -42.00210449218856, -20.55100121541304, -47.285392522862, 22.283309653130488, -154.53596462340943, -52.86458517300005, -128.82824105139758, -161.17519114230814, 171.30828454579986, -56.11203934613781, -18.83458500924472, -269.6263907081659, -23.61284677643151, -117.06818337915007, 3.088291148189513, 70.15880093429126, 9.76605748074978, -37.53944684421853, 87.85562575726362, -165.41001565582044, -150.10765143656727, -247.57161197757685, -102.60034521552004, -131.90683268797213, -44.06382597748678, -72.25397772081396, -98.7766520799188, -24.527358361208258, -0.21703373227236786, -141.6221115734233, -31.02413932870416, 49.7313318127737, -278.97138845221826, -187.21376378724193, 35.546108216406964, 63.61129520677576, 66.06722018744823, 31.810774803768226, -9.177340241298074, -233.29301069548418, -168.11106985259082, 138.98695409121723, 15.487647583556573, 69.8044917781849, 15.68204774806334, -53.555088216273916, -162.88505099805133, -65.88217864882702, -145.2095360309618, -80.29188882567756, -53.09971637944936, 16.71438452308765, -7.600851966500031, -81.02342658206356, -22.121000778823785, -204.56288742690742, -86.2210981331375, 1.9034452114050386, -255.38067769439067, -131.2027352907141, -272.43588078364724, 159.5, -19.93196900397617, 17.226299580693386, -20.943309987417116, 4.873738457841874, -298.24961111157825, -83.78963415150997, -258.91912780222555, -244.68376312347738, -122.8218608014226, -20.27000229269707, -221.9329342217624, -44.66111996915771, -63.350795551813476, -117.76757634365275, -12.78905709052746, -229.64727114036998, -37.919035140276456, -28.18399410814859, -145.42842752771435, -25.630266659321595, 27.54421997937121, -78.2382804668246, -21.784331642456195, -83.81319015840597, -119.67828713676224, -27.134243383400005, 141.2384578540425, -62.40560903208396, 25.135806400869352, -235.83310018236858, -52.057796120787515, -63.41866345274272, -168.12905562470246, -31.84420115764442, 85.98608198817809, -25.173383997133335, -82.36434355048787, -205.86138143186682, 25.97962177157468, 11.441174635508007, -25.82504095603585, -119.56304743858146, -139.2819527185633, -28.202313352009664, -101.68813585257914, -90.78467957439145, 91.12673570652977, -162.53946755041756, 43.27593615030192, 20.000000000000014, -85.46820948777543, -142.5464517659056, -161.42743698074332, -34.14615034435572, -126.11791402551042, -103.7808956701938, -101.78165334111978, -195.0394895526814, -152.51234752779914, -169.25062823643552, 56.35546894571767, -10.740488105321383, -132.04764129794464, -52.58185404132142, -124.90326105229035, -95.56214079492717, 10.389624425278635, -265.64205276269945, 48.864725648027964, 8.421862161747288, 17.874083281548195, -66.91200178674472, 20.185927230258866, 68.2080431902781, -342.9175236893535, -130.35035667284546, 31.23901933662325, -108.61482583679975, -146.09301179244463, -20.05788143491, 111.52413428073895, -73.1609602623135, -87.53615918105488, -65.30123615685864, -125.30903347336807, -25.747659225900556, -16.20625274514661, 122.24620022343166, 3.4661919810869373], "policy_predator_policy_reward": [94.93070996941385, 103.26175162234661, 54.1089013475453, 134.66848015342583, 156.77854099143923, 12.27023488806775, 123.32234286880814, 274.8251214201978, 142.11848702189934, 124.36970682817012, 83.08760669884231, 244.7793092126629, 126.74704161051952, 81.12353210197271, 165.03909671700129, 166.56192904310748, 80.50343269264565, 230.9292623719592, 167.42023633410838, 297.5665324373073, 122.91243276556212, 126.85456964740888, 26.310997274695293, 144.2699120303546, 67.49374509475302, 59.6509396364527, 90.60022140735762, 178.51595869697317, 72.7959214481607, 198.11174307498837, 170.80583595213187, 105.64011661156994, 152.0197997168761, 134.82809609130067, 27.592998923921915, 14.847069085287472, 180.1279683312245, 185.3876143133187, 45.19582895283445, 93.73109318292968, 96.97883391374879, 41.21483536116218, 138.91177647506566, 120.04288925693643, 121.42664117077885, 19.31247818729718, 126.1312476086321, 196.7473675374916, 44.53476659669855, 70.36224150963346, 6.53980682662695, 134.90194379824155, 35.236976940196655, 202.23439642182672, 135.57608826026402, 170.49606898485288, 173.17519114230745, 3.191715454200097, 125.91203934613759, 37.14222597560994, 138.35995585239272, 195.04129295448237, 124.89957265096974, 153.87295800357455, 81.15281264858706, 63.454229941994456, 95.77815489976855, 10.905666187186581, 213.72440803129362, 196.3023254507272, 186.40346867188478, 218.63656080383666, 225.561493178003, 59.16555382410672, 143.58572640856528, 162.04182325169208, 19.111918262054182, 72.9251799557019, 208.21283400434095, 129.1609921052042, 255.84233400659477, 153.07645216887755, 195.47694329117087, 133.34203521436444, 37.72148460577619, 0.0, 46.55474727294718, 34.91314898550618, 257.69356301598566, 183.09368114466668, 45.904979428592156, 3.220418896633992, 55.70633057217468, 23.30712990157724, 83.68830442661462, 223.23590797519174, 188.83003181759486, 140.9777031730232, 42.01454621828732, 140.11922592137154, 15.560919777762878, 132.6924250158649, 181.86170505655625, 17.986457354981912, 192.18400317213172, 154.49776259864385, 61.942037531010214, 240.65797216400526, 181.1626504037162, 296.2676097173802, 1.6712751148909768, 38.2319690039764, 57.61224667592159, 80.77863230959247, 106.24573563094899, 269.0557582489486, 141.9076100670942, 274.50114182861216, 265.126034236764, 124.80379063775268, 73.93055945243874, 196.46545920781233, 95.09320324034499, 100.61848255045857, 106.45401388221549, 169.40390467110484, 247.12982426761303, 69.70276689596889, 51.828946402989686, 161.68502343752795, 86.34775298833847, 33.638293691611906, 55.73626596565801, 125.87587580809394, 168.7930147973831, 88.53700460821793, 108.39817836657993, 0.9253431345859633, 147.10137898550505, 24.337055032278467, 197.6328803043941, 154.2735686201789, 106.92349963198478, 180.8482709607435, 68.91578342241618, 38.4423357470502, 110.61485924134647, 97.62171177592529, 176.42693356636315, 191.67830768647855, 87.0426414591756, 72.33499915866702, 189.17616572325431, 177.7840761689185, 174.54086414447286, 113.53315135949919, 160.79970464611517, 38.10383757823844, 57.00428807762181, 210.23884542775855, 5.623295329198483, 111.568209487775, 244.1434269822024, 199.05154425601575, 213.7948893847166, 129.01409932444068, 132.3808956701934, 132.98165334111954, 218.52174972806122, 168.41667376110604, 96.68695735734677, 162.2841587989746, 92.66996162315226, 137.476129032213, 152.43685878900757, 178.16351214018147, 168.94486982767717, 29.691762335528658, 119.73788065553096, 224.45017480391698, 25.97579550452614, 55.92591671845189, 81.31200178674392, 11.214072769741149, 360.5124967565016, 124.24426681898021, 95.66324803035683, 118.2655020354873, 122.31482583679897, 177.49301179244452, 95.97135498846181, 84.66442652868894, 70.83604042208276, 206.76236534859837, 90.8125996736248, 179.60506082270132, 51.02491354029909, 46.8289984307485, 48.25379977656836, 15.133808018913028]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.209370980942501, "mean_inference_ms": 3.7080338850835095, "mean_action_processing_ms": 1.6133107094723191, "mean_env_wait_ms": 10.140278817746818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005622386932373047, "StateBufferConnector_ms": 0.006371855735778809, "ViewRequirementAgentConnector_ms": 0.18332254886627197}, "num_episodes": 19, "episode_return_max": 285.75827155974133, "episode_return_min": 22.424200949617124, "episode_return_mean": 117.06565012982712, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.40307408697089, "num_env_steps_trained_throughput_per_sec": 72.40307408697089, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 49222.343, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49222.271, "sample_time_ms": 2225.237, "learn_time_ms": 46976.906, "learn_throughput": 85.148, "synch_weights_time_ms": 16.366}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-00-20", "timestamp": 1724149820, "time_this_iter_s": 55.28772807121277, "time_total_s": 2387.176409482956, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120023550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2387.176409482956, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 43.37435897435898, "ram_util_percent": 82.1179487179487}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.01846241017498, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.788144040738464, "policy_loss": -0.016014474109505062, "vf_loss": 6.801836402832516, "vf_explained_var": 0.2011614895371533, "kl": 0.011610566777492523, "entropy": 0.790590970604508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.409086918767798, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.622216292285414, "policy_loss": -0.012594894038897658, "vf_loss": 5.632873551555411, "vf_explained_var": 0.20927843016291423, "kl": 0.009688118320801074, "entropy": 0.8315650675347243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 285.75827155974133, "episode_reward_min": 22.424200949617124, "episode_reward_mean": 114.92755438934739, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -342.9175236893535, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.30828454579986, "predator_policy": 360.5124967565016}, "policy_reward_mean": {"prey_policy": -67.1886461818905, "predator_policy": 124.6524233765642}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.52831050884943, 79.60871269337441, 70.16686274890381, 110.06524966716923, 106.4195660138078, 137.98134158128013, 285.75827155974133, 66.0913588752538, 205.59549927399684, 164.38623729730838, 200.60459912214966, 55.20000000000042, 73.6053568865928, 105.21871839174415, 124.37933102071943, 186.4999999999993, 88.10764096636458, 40.162011322277635, 164.79263842358304, 224.53190100562244, 156.9999999999996, 94.50906638963338, 54.868072282625626, 108.7563883366509, 134.59691985952438, 67.29270612427557, 164.72757520741754, 179.6787295360263, 177.15132293470046, 167.39999999999915, 104.10133082092335, 39.383163612577604, 203.5999999999993, 164.5, 90.48407318748087, 118.71602031082926, 48.74216693453219, 157.36687735021502, 96.70373505065105, 55.897780210731256, 49.12277721203025, 73.79164404673489, 179.47127511489043, 134.67386857879012, 81.92562122616134, 73.69998994197091, 22.424200949617124, 28.19308214579184, 87.69977026983375, 145.30128511913978, 49.26628488293568, 39.90154820465489, 121.89999999999952, 81.58952966447063, 53.838542110433835, 223.42773597180843, 134.16863138656873, 64.0155526214176, 56.22405151528324, 161.4999999999996, 100.698843469651, 188.223481592549, 144.9937742973146, 108.11524173502798, 158.18356629938307, 199.2455983564919, 147.97960210526495, 51.72329532919876, 139.2210824915694, 182.54492433929082, 59.80000000000009, 39.38658640868724, 146.07595686560327, 87.3579612521, 153.11525583557722, 113.46411579355771, 127.41072834477447, 108.19765766627299, 45.80000000000041, 210.04728307640636, 114.81741272962145, 45.10000000000023, 272.1020343629796, 116.90128632731303, 79.80739086609972, 55.9000000000004, 189.0999999999994, 89.28142903215252, 67.01422433074468, 105.79491571438139, 61.839738214414126, 196.53825647644268, 161.26394149607418, 59.26967198331379, 67.80598434537076, 87.78549042237115, 35.78066120659691, 124.03517039233152, 207.90791291030837, 48.810036395440456], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-129.18537754873373, -82.40249204674885, -4.47057328533581, -186.82837854443912, -141.61223471391227, -64.6668551008861, -115.91961036541878, -60.863035775588656, 45.79417151223411, 18.18532649236431, -211.52272268170717, -16.01151838155574, -9.968650576023089, 156.79999999999998, -13.66917367445977, -58.43313672519788, 33.12430790501752, -86.48347436302289, 51.307384831411, -27.660266892178463, -96.27515068249977, -25.99886534147408, -17.694903614143016, -42.00210449218856, -20.55100121541304, -47.285392522862, 22.283309653130488, -154.53596462340943, -52.86458517300005, -128.82824105139758, -161.17519114230814, 171.30828454579986, -56.11203934613781, -18.83458500924472, -269.6263907081659, -23.61284677643151, -117.06818337915007, 3.088291148189513, 70.15880093429126, 9.76605748074978, -37.53944684421853, 87.85562575726362, -165.41001565582044, -150.10765143656727, -247.57161197757685, -102.60034521552004, -131.90683268797213, -44.06382597748678, -72.25397772081396, -98.7766520799188, -24.527358361208258, -0.21703373227236786, -141.6221115734233, -31.02413932870416, 49.7313318127737, -278.97138845221826, -187.21376378724193, 35.546108216406964, 63.61129520677576, 66.06722018744823, 31.810774803768226, -9.177340241298074, -233.29301069548418, -168.11106985259082, 138.98695409121723, 15.487647583556573, 69.8044917781849, 15.68204774806334, -53.555088216273916, -162.88505099805133, -65.88217864882702, -145.2095360309618, -80.29188882567756, -53.09971637944936, 16.71438452308765, -7.600851966500031, -81.02342658206356, -22.121000778823785, -204.56288742690742, -86.2210981331375, 1.9034452114050386, -255.38067769439067, -131.2027352907141, -272.43588078364724, 159.5, -19.93196900397617, 17.226299580693386, -20.943309987417116, 4.873738457841874, -298.24961111157825, -83.78963415150997, -258.91912780222555, -244.68376312347738, -122.8218608014226, -20.27000229269707, -221.9329342217624, -44.66111996915771, -63.350795551813476, -117.76757634365275, -12.78905709052746, -229.64727114036998, -37.919035140276456, -28.18399410814859, -145.42842752771435, -25.630266659321595, 27.54421997937121, -78.2382804668246, -21.784331642456195, -83.81319015840597, -119.67828713676224, -27.134243383400005, 141.2384578540425, -62.40560903208396, 25.135806400869352, -235.83310018236858, -52.057796120787515, -63.41866345274272, -168.12905562470246, -31.84420115764442, 85.98608198817809, -25.173383997133335, -82.36434355048787, -205.86138143186682, 25.97962177157468, 11.441174635508007, -25.82504095603585, -119.56304743858146, -139.2819527185633, -28.202313352009664, -101.68813585257914, -90.78467957439145, 91.12673570652977, -162.53946755041756, 43.27593615030192, 20.000000000000014, -85.46820948777543, -142.5464517659056, -161.42743698074332, -34.14615034435572, -126.11791402551042, -103.7808956701938, -101.78165334111978, -195.0394895526814, -152.51234752779914, -169.25062823643552, 56.35546894571767, -10.740488105321383, -132.04764129794464, -52.58185404132142, -124.90326105229035, -95.56214079492717, 10.389624425278635, -265.64205276269945, 48.864725648027964, 8.421862161747288, 17.874083281548195, -66.91200178674472, 20.185927230258866, 68.2080431902781, -342.9175236893535, -130.35035667284546, 31.23901933662325, -108.61482583679975, -146.09301179244463, -20.05788143491, 111.52413428073895, -73.1609602623135, -87.53615918105488, -65.30123615685864, -125.30903347336807, -25.747659225900556, -16.20625274514661, 122.24620022343166, 3.4661919810869373, -171.12870431281914, -107.21203260852093, -7.5835170687848485, -205.30396450339654, -86.95340236493206, -57.563307559956684, -148.1586417299576, -13.745649513347663, -106.6323194587215, -58.355936789713134, -244.77612242435538, 106.39469460443499, 39.156187311759425, -159.70564968473522, -294.7018417919551, -2.593003324011971, -11.683341112636565, -196.58878466817123, -49.31763152815643, -205.04061922421005, 24.135108930042612, -196.95818784750202, 61.37054553013214, -23.981108430950044, -284.70002784193525, -90.90427643763421], "policy_predator_policy_reward": [90.60022140735762, 178.51595869697317, 72.7959214481607, 198.11174307498837, 170.80583595213187, 105.64011661156994, 152.0197997168761, 134.82809609130067, 27.592998923921915, 14.847069085287472, 180.1279683312245, 185.3876143133187, 45.19582895283445, 93.73109318292968, 96.97883391374879, 41.21483536116218, 138.91177647506566, 120.04288925693643, 121.42664117077885, 19.31247818729718, 126.1312476086321, 196.7473675374916, 44.53476659669855, 70.36224150963346, 6.53980682662695, 134.90194379824155, 35.236976940196655, 202.23439642182672, 135.57608826026402, 170.49606898485288, 173.17519114230745, 3.191715454200097, 125.91203934613759, 37.14222597560994, 138.35995585239272, 195.04129295448237, 124.89957265096974, 153.87295800357455, 81.15281264858706, 63.454229941994456, 95.77815489976855, 10.905666187186581, 213.72440803129362, 196.3023254507272, 186.40346867188478, 218.63656080383666, 225.561493178003, 59.16555382410672, 143.58572640856528, 162.04182325169208, 19.111918262054182, 72.9251799557019, 208.21283400434095, 129.1609921052042, 255.84233400659477, 153.07645216887755, 195.47694329117087, 133.34203521436444, 37.72148460577619, 0.0, 46.55474727294718, 34.91314898550618, 257.69356301598566, 183.09368114466668, 45.904979428592156, 3.220418896633992, 55.70633057217468, 23.30712990157724, 83.68830442661462, 223.23590797519174, 188.83003181759486, 140.9777031730232, 42.01454621828732, 140.11922592137154, 15.560919777762878, 132.6924250158649, 181.86170505655625, 17.986457354981912, 192.18400317213172, 154.49776259864385, 61.942037531010214, 240.65797216400526, 181.1626504037162, 296.2676097173802, 1.6712751148909768, 38.2319690039764, 57.61224667592159, 80.77863230959247, 106.24573563094899, 269.0557582489486, 141.9076100670942, 274.50114182861216, 265.126034236764, 124.80379063775268, 73.93055945243874, 196.46545920781233, 95.09320324034499, 100.61848255045857, 106.45401388221549, 169.40390467110484, 247.12982426761303, 69.70276689596889, 51.828946402989686, 161.68502343752795, 86.34775298833847, 33.638293691611906, 55.73626596565801, 125.87587580809394, 168.7930147973831, 88.53700460821793, 108.39817836657993, 0.9253431345859633, 147.10137898550505, 24.337055032278467, 197.6328803043941, 154.2735686201789, 106.92349963198478, 180.8482709607435, 68.91578342241618, 38.4423357470502, 110.61485924134647, 97.62171177592529, 176.42693356636315, 191.67830768647855, 87.0426414591756, 72.33499915866702, 189.17616572325431, 177.7840761689185, 174.54086414447286, 113.53315135949919, 160.79970464611517, 38.10383757823844, 57.00428807762181, 210.23884542775855, 5.623295329198483, 111.568209487775, 244.1434269822024, 199.05154425601575, 213.7948893847166, 129.01409932444068, 132.3808956701934, 132.98165334111954, 218.52174972806122, 168.41667376110604, 96.68695735734677, 162.2841587989746, 92.66996162315226, 137.476129032213, 152.43685878900757, 178.16351214018147, 168.94486982767717, 29.691762335528658, 119.73788065553096, 224.45017480391698, 25.97579550452614, 55.92591671845189, 81.31200178674392, 11.214072769741149, 360.5124967565016, 124.24426681898021, 95.66324803035683, 118.2655020354873, 122.31482583679897, 177.49301179244452, 95.97135498846181, 84.66442652868894, 70.83604042208276, 206.76236534859837, 90.8125996736248, 179.60506082270132, 51.02491354029909, 46.8289984307485, 48.25379977656836, 15.133808018913028, 249.8382345029625, 117.78393145053006, 165.67618073013566, 114.22552517278984, 129.06358835575617, 121.24803728351371, 155.9586417299572, 67.78538772776166, 174.96750116029273, 186.55901156458475, 104.93335751906787, 194.7120117969268, 178.87825939597832, 0.9408749603107672, 195.16802014197523, 169.93280931936215, 90.36048342451289, 205.6971327786657, 73.3729973573996, 216.76591460156382, 220.5654336214281, 76.2928156883634, 48.33736738017627, 122.18110843095, 310.3274929308834, 114.08684774412677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.214858743121134, "mean_inference_ms": 3.714624815360404, "mean_action_processing_ms": 1.6204407650073114, "mean_env_wait_ms": 10.148581163328995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005658745765686035, "StateBufferConnector_ms": 0.006346225738525391, "ViewRequirementAgentConnector_ms": 0.18832242488861084}, "num_episodes": 13, "episode_return_max": 285.75827155974133, "episode_return_min": 22.424200949617124, "episode_return_mean": 114.92755438934739, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.23232518334002, "num_env_steps_trained_throughput_per_sec": 73.23232518334002, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 49847.245, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49847.165, "sample_time_ms": 2408.381, "learn_time_ms": 47418.769, "learn_throughput": 84.355, "synch_weights_time_ms": 16.323}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-01-15", "timestamp": 1724149875, "time_this_iter_s": 54.67295217514038, "time_total_s": 2441.8493616580963, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120014e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2441.8493616580963, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 41.685897435897445, "ram_util_percent": 82.9730769230769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.332833073126576, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.741044084861795, "policy_loss": -0.015748120132074862, "vf_loss": 6.754547701941596, "vf_explained_var": 0.07039745383792453, "kl": 0.011222535331866571, "entropy": 0.7920031706176738, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 996.4750000000058}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.423578692933239, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.539475023431122, "policy_loss": -0.01642975263499591, "vf_loss": 5.553736186910559, "vf_explained_var": 0.12744941809190014, "kl": 0.01084292709911193, "entropy": 0.8241533403358762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 996.4750000000058}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 272.1020343629796, "episode_reward_min": 22.424200949617124, "episode_reward_mean": 114.11787280564468, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -440.18887430252636, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 159.5, "predator_policy": 360.5124967565016}, "policy_reward_mean": {"prey_policy": -75.56091551464337, "predator_policy": 132.61985191746572}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.29270612427557, 164.72757520741754, 179.6787295360263, 177.15132293470046, 167.39999999999915, 104.10133082092335, 39.383163612577604, 203.5999999999993, 164.5, 90.48407318748087, 118.71602031082926, 48.74216693453219, 157.36687735021502, 96.70373505065105, 55.897780210731256, 49.12277721203025, 73.79164404673489, 179.47127511489043, 134.67386857879012, 81.92562122616134, 73.69998994197091, 22.424200949617124, 28.19308214579184, 87.69977026983375, 145.30128511913978, 49.26628488293568, 39.90154820465489, 121.89999999999952, 81.58952966447063, 53.838542110433835, 223.42773597180843, 134.16863138656873, 64.0155526214176, 56.22405151528324, 161.4999999999996, 100.698843469651, 188.223481592549, 144.9937742973146, 108.11524173502798, 158.18356629938307, 199.2455983564919, 147.97960210526495, 51.72329532919876, 139.2210824915694, 182.54492433929082, 59.80000000000009, 39.38658640868724, 146.07595686560327, 87.3579612521, 153.11525583557722, 113.46411579355771, 127.41072834477447, 108.19765766627299, 45.80000000000041, 210.04728307640636, 114.81741272962145, 45.10000000000023, 272.1020343629796, 116.90128632731303, 79.80739086609972, 55.9000000000004, 189.0999999999994, 89.28142903215252, 67.01422433074468, 105.79491571438139, 61.839738214414126, 196.53825647644268, 161.26394149607418, 59.26967198331379, 67.80598434537076, 87.78549042237115, 35.78066120659691, 124.03517039233152, 207.90791291030837, 48.810036395440456, 206.63122209302963, 165.85711860405453, 267.67933699259277, 60.569106598434715, 140.29833589446022, 165.3483064212203, 225.9864180197391, 115.15842979861597, 118.71094176356364, 146.42596564305748, 105.54136854878796, 68.18008777068673, 115.1480352239762, 44.263378324821915, 102.62738729188263, 121.59999999999981, 56.31913149793471, 40.58845257501225, 86.8610817775476, 74.88782232900819, 33.99975591936299, 185.69027369356488, 140.56587828274354, 186.94058187412554, 39.58747891867627], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.527358361208258, -0.21703373227236786, -141.6221115734233, -31.02413932870416, 49.7313318127737, -278.97138845221826, -187.21376378724193, 35.546108216406964, 63.61129520677576, 66.06722018744823, 31.810774803768226, -9.177340241298074, -233.29301069548418, -168.11106985259082, 138.98695409121723, 15.487647583556573, 69.8044917781849, 15.68204774806334, -53.555088216273916, -162.88505099805133, -65.88217864882702, -145.2095360309618, -80.29188882567756, -53.09971637944936, 16.71438452308765, -7.600851966500031, -81.02342658206356, -22.121000778823785, -204.56288742690742, -86.2210981331375, 1.9034452114050386, -255.38067769439067, -131.2027352907141, -272.43588078364724, 159.5, -19.93196900397617, 17.226299580693386, -20.943309987417116, 4.873738457841874, -298.24961111157825, -83.78963415150997, -258.91912780222555, -244.68376312347738, -122.8218608014226, -20.27000229269707, -221.9329342217624, -44.66111996915771, -63.350795551813476, -117.76757634365275, -12.78905709052746, -229.64727114036998, -37.919035140276456, -28.18399410814859, -145.42842752771435, -25.630266659321595, 27.54421997937121, -78.2382804668246, -21.784331642456195, -83.81319015840597, -119.67828713676224, -27.134243383400005, 141.2384578540425, -62.40560903208396, 25.135806400869352, -235.83310018236858, -52.057796120787515, -63.41866345274272, -168.12905562470246, -31.84420115764442, 85.98608198817809, -25.173383997133335, -82.36434355048787, -205.86138143186682, 25.97962177157468, 11.441174635508007, -25.82504095603585, -119.56304743858146, -139.2819527185633, -28.202313352009664, -101.68813585257914, -90.78467957439145, 91.12673570652977, -162.53946755041756, 43.27593615030192, 20.000000000000014, -85.46820948777543, -142.5464517659056, -161.42743698074332, -34.14615034435572, -126.11791402551042, -103.7808956701938, -101.78165334111978, -195.0394895526814, -152.51234752779914, -169.25062823643552, 56.35546894571767, -10.740488105321383, -132.04764129794464, -52.58185404132142, -124.90326105229035, -95.56214079492717, 10.389624425278635, -265.64205276269945, 48.864725648027964, 8.421862161747288, 17.874083281548195, -66.91200178674472, 20.185927230258866, 68.2080431902781, -342.9175236893535, -130.35035667284546, 31.23901933662325, -108.61482583679975, -146.09301179244463, -20.05788143491, 111.52413428073895, -73.1609602623135, -87.53615918105488, -65.30123615685864, -125.30903347336807, -25.747659225900556, -16.20625274514661, 122.24620022343166, 3.4661919810869373, -171.12870431281914, -107.21203260852093, -7.5835170687848485, -205.30396450339654, -86.95340236493206, -57.563307559956684, -148.1586417299576, -13.745649513347663, -106.6323194587215, -58.355936789713134, -244.77612242435538, 106.39469460443499, 39.156187311759425, -159.70564968473522, -294.7018417919551, -2.593003324011971, -11.683341112636565, -196.58878466817123, -49.31763152815643, -205.04061922421005, 24.135108930042612, -196.95818784750202, 61.37054553013214, -23.981108430950044, -284.70002784193525, -90.90427643763421, -34.03348623146087, -295.8253729486263, -336.57078952000984, 111.08354069728558, 120.7679460410618, 18.465216297410777, -59.74169514202824, -97.28312300951623, -62.00060855544764, -52.436844391968705, -348.8609629958657, 103.88343801952745, 48.09007048045019, -279.29511529145503, 6.400823976784225, -81.61002428204995, -75.10067861141178, 42.76738950088027, -40.024714935406095, -141.0424571944142, -261.36214333736757, -10.784375822127894, -46.698052443277405, -142.75886317529, 56.353422139550794, -384.8176167350688, -18.85070542977231, -131.0698966848759, 10.520997895316361, -440.18887430252636, 7.612670804736037, -184.940806136346, -204.21689702501, -53.3364489114771, -169.13974398991272, -178.09478003740122, -13.416406975869801, -266.36415856382155, -30.59615414386507, 39.503503399292654, -17.79480905545693, -247.6637126726555, -47.0838062674837, 0.10801882701357357, 65.66428403674499, -194.32639484221744, -220.5185351474385, 39.36664277907182, -19.9947852301908, 20.080263504936575], "policy_predator_policy_reward": [19.111918262054182, 72.9251799557019, 208.21283400434095, 129.1609921052042, 255.84233400659477, 153.07645216887755, 195.47694329117087, 133.34203521436444, 37.72148460577619, 0.0, 46.55474727294718, 34.91314898550618, 257.69356301598566, 183.09368114466668, 45.904979428592156, 3.220418896633992, 55.70633057217468, 23.30712990157724, 83.68830442661462, 223.23590797519174, 188.83003181759486, 140.9777031730232, 42.01454621828732, 140.11922592137154, 15.560919777762878, 132.6924250158649, 181.86170505655625, 17.986457354981912, 192.18400317213172, 154.49776259864385, 61.942037531010214, 240.65797216400526, 181.1626504037162, 296.2676097173802, 1.6712751148909768, 38.2319690039764, 57.61224667592159, 80.77863230959247, 106.24573563094899, 269.0557582489486, 141.9076100670942, 274.50114182861216, 265.126034236764, 124.80379063775268, 73.93055945243874, 196.46545920781233, 95.09320324034499, 100.61848255045857, 106.45401388221549, 169.40390467110484, 247.12982426761303, 69.70276689596889, 51.828946402989686, 161.68502343752795, 86.34775298833847, 33.638293691611906, 55.73626596565801, 125.87587580809394, 168.7930147973831, 88.53700460821793, 108.39817836657993, 0.9253431345859633, 147.10137898550505, 24.337055032278467, 197.6328803043941, 154.2735686201789, 106.92349963198478, 180.8482709607435, 68.91578342241618, 38.4423357470502, 110.61485924134647, 97.62171177592529, 176.42693356636315, 191.67830768647855, 87.0426414591756, 72.33499915866702, 189.17616572325431, 177.7840761689185, 174.54086414447286, 113.53315135949919, 160.79970464611517, 38.10383757823844, 57.00428807762181, 210.23884542775855, 5.623295329198483, 111.568209487775, 244.1434269822024, 199.05154425601575, 213.7948893847166, 129.01409932444068, 132.3808956701934, 132.98165334111954, 218.52174972806122, 168.41667376110604, 96.68695735734677, 162.2841587989746, 92.66996162315226, 137.476129032213, 152.43685878900757, 178.16351214018147, 168.94486982767717, 29.691762335528658, 119.73788065553096, 224.45017480391698, 25.97579550452614, 55.92591671845189, 81.31200178674392, 11.214072769741149, 360.5124967565016, 124.24426681898021, 95.66324803035683, 118.2655020354873, 122.31482583679897, 177.49301179244452, 95.97135498846181, 84.66442652868894, 70.83604042208276, 206.76236534859837, 90.8125996736248, 179.60506082270132, 51.02491354029909, 46.8289984307485, 48.25379977656836, 15.133808018913028, 249.8382345029625, 117.78393145053006, 165.67618073013566, 114.22552517278984, 129.06358835575617, 121.24803728351371, 155.9586417299572, 67.78538772776166, 174.96750116029273, 186.55901156458475, 104.93335751906787, 194.7120117969268, 178.87825939597832, 0.9408749603107672, 195.16802014197523, 169.93280931936215, 90.36048342451289, 205.6971327786657, 73.3729973573996, 216.76591460156382, 220.5654336214281, 76.2928156883634, 48.33736738017627, 122.18110843095, 310.3274929308834, 114.08684774412677, 291.5504547252604, 244.93962654785616, 241.2684487458079, 150.0759186809709, 51.152718782745154, 77.2934558713744, 84.26255221568822, 133.33137253429038, 134.33322887046955, 120.40255997140711, 242.92564459019923, 167.40018680735986, 265.49802486207585, 191.69343796866877, 103.07283573627471, 87.29479436760715, 119.7398754180405, 31.30435545605454, 147.8669005558812, 179.62623721699677, 112.99164728219053, 264.696240426093, 95.49805244327707, 162.13895094597612, 170.9763008565495, 272.6359289629449, 98.63128776942837, 95.55269267004124, 195.7661128160438, 336.5291508830498, 88.787329195264, 210.14080613634576, 244.11689702500973, 69.75558040941168, 138.93353082488096, 248.8894457774444, 259.8160494550225, 106.82559786221894, 6.690766322585343, 59.2897067509954, 35.44710584266172, 264.011171804814, 65.56102244087623, 167.10503869315897, 90.68899936925543, 178.53898971896098, 214.92374001371812, 153.16873422877427, 38.62530908861536, 0.8766915553150988]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.253452736332532, "mean_inference_ms": 3.73121049611471, "mean_action_processing_ms": 1.6375343460138003, "mean_env_wait_ms": 10.15516150383059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062901973724365234, "StateBufferConnector_ms": 0.00537109375, "ViewRequirementAgentConnector_ms": 0.18129324913024902}, "num_episodes": 25, "episode_return_max": 272.1020343629796, "episode_return_min": 22.424200949617124, "episode_return_mean": 114.11787280564468, "episodes_this_iter": 25}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 28.670297701074, "num_env_steps_trained_throughput_per_sec": 28.670297701074, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 59100.883, "restore_workers_time_ms": 0.014, "training_step_time_ms": 59100.763, "sample_time_ms": 2526.888, "learn_time_ms": 56455.328, "learn_throughput": 70.852, "synch_weights_time_ms": 112.189}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-03-38", "timestamp": 1724150018, "time_this_iter_s": 143.48086786270142, "time_total_s": 2585.3302295207977, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12002d790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2585.3302295207977, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 80.60113636363636, "ram_util_percent": 83.60284090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.078420344278925, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000002, "total_loss": 6.8291094046263465, "policy_loss": -0.013147878414089237, "vf_loss": 6.8401539097229636, "vf_explained_var": 0.2178250647903908, "kl": 0.010516936254896877, "entropy": 0.7600025958248547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.14285714285714, "num_grad_updates_lifetime": 98070.5, "diff_num_grad_updates_vs_sampler_policy": 1679.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.518003788874263, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000002, "total_loss": 5.942480602150872, "policy_loss": -0.011255741188194536, "vf_loss": 5.95209847447418, "vf_explained_var": 0.2260584257543087, "kl": 0.00818932175804678, "entropy": 0.792768025682086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.14285714285714, "num_grad_updates_lifetime": 98070.5, "diff_num_grad_updates_vs_sampler_policy": 1679.5}}, "num_env_steps_sampled": 211120, "num_env_steps_trained": 211120, "num_agent_steps_sampled": 844480, "num_agent_steps_trained": 844480}, "env_runners": {"episode_reward_max": 272.1020343629796, "episode_reward_min": 16.62155659148304, "episode_reward_mean": 111.18200231153634, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -440.18887430252636, "predator_policy": 0.8766915553150988}, "policy_reward_max": {"prey_policy": 173.78296229694658, "predator_policy": 360.5124967565016}, "policy_reward_mean": {"prey_policy": -85.84924766206028, "predator_policy": 141.4402488178284}, "custom_metrics": {}, "hist_stats": {"episode_reward": [188.223481592549, 144.9937742973146, 108.11524173502798, 158.18356629938307, 199.2455983564919, 147.97960210526495, 51.72329532919876, 139.2210824915694, 182.54492433929082, 59.80000000000009, 39.38658640868724, 146.07595686560327, 87.3579612521, 153.11525583557722, 113.46411579355771, 127.41072834477447, 108.19765766627299, 45.80000000000041, 210.04728307640636, 114.81741272962145, 45.10000000000023, 272.1020343629796, 116.90128632731303, 79.80739086609972, 55.9000000000004, 189.0999999999994, 89.28142903215252, 67.01422433074468, 105.79491571438139, 61.839738214414126, 196.53825647644268, 161.26394149607418, 59.26967198331379, 67.80598434537076, 87.78549042237115, 35.78066120659691, 124.03517039233152, 207.90791291030837, 48.810036395440456, 206.63122209302963, 165.85711860405453, 267.67933699259277, 60.569106598434715, 140.29833589446022, 165.3483064212203, 225.9864180197391, 115.15842979861597, 118.71094176356364, 146.42596564305748, 105.54136854878796, 68.18008777068673, 115.1480352239762, 44.263378324821915, 102.62738729188263, 121.59999999999981, 56.31913149793471, 40.58845257501225, 86.8610817775476, 74.88782232900819, 33.99975591936299, 185.69027369356488, 140.56587828274354, 186.94058187412554, 39.58747891867627, 71.50777478772406, 80.8746197601539, 138.67712881138365, 142.9999999999995, 49.23049218563365, 54.66788585543539, 67.48760545109548, 202.8101397793896, 72.85179644323759, 41.66852073878741, 134.52835206514183, 53.9237031602332, 111.00956412392203, 38.428278012665665, 69.1567507015198, 185.99999999999977, 166.20028177396966, 38.21488388984654, 74.90595960434318, 35.763275861735806, 213.21429870377005, 125.84318319660969, 209.80027819325312, 144.1556093137161, 99.41003098231357, 56.25507569675191, 56.88486388348265, 102.15427587510227, 110.0728200668421, 146.1036376450434, 83.87747561222402, 60.4992523826839, 105.84143862877359, 16.62155659148304, 72.25120468850224, 71.10065183493795], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-205.86138143186682, 25.97962177157468, 11.441174635508007, -25.82504095603585, -119.56304743858146, -139.2819527185633, -28.202313352009664, -101.68813585257914, -90.78467957439145, 91.12673570652977, -162.53946755041756, 43.27593615030192, 20.000000000000014, -85.46820948777543, -142.5464517659056, -161.42743698074332, -34.14615034435572, -126.11791402551042, -103.7808956701938, -101.78165334111978, -195.0394895526814, -152.51234752779914, -169.25062823643552, 56.35546894571767, -10.740488105321383, -132.04764129794464, -52.58185404132142, -124.90326105229035, -95.56214079492717, 10.389624425278635, -265.64205276269945, 48.864725648027964, 8.421862161747288, 17.874083281548195, -66.91200178674472, 20.185927230258866, 68.2080431902781, -342.9175236893535, -130.35035667284546, 31.23901933662325, -108.61482583679975, -146.09301179244463, -20.05788143491, 111.52413428073895, -73.1609602623135, -87.53615918105488, -65.30123615685864, -125.30903347336807, -25.747659225900556, -16.20625274514661, 122.24620022343166, 3.4661919810869373, -171.12870431281914, -107.21203260852093, -7.5835170687848485, -205.30396450339654, -86.95340236493206, -57.563307559956684, -148.1586417299576, -13.745649513347663, -106.6323194587215, -58.355936789713134, -244.77612242435538, 106.39469460443499, 39.156187311759425, -159.70564968473522, -294.7018417919551, -2.593003324011971, -11.683341112636565, -196.58878466817123, -49.31763152815643, -205.04061922421005, 24.135108930042612, -196.95818784750202, 61.37054553013214, -23.981108430950044, -284.70002784193525, -90.90427643763421, -34.03348623146087, -295.8253729486263, -336.57078952000984, 111.08354069728558, 120.7679460410618, 18.465216297410777, -59.74169514202824, -97.28312300951623, -62.00060855544764, -52.436844391968705, -348.8609629958657, 103.88343801952745, 48.09007048045019, -279.29511529145503, 6.400823976784225, -81.61002428204995, -75.10067861141178, 42.76738950088027, -40.024714935406095, -141.0424571944142, -261.36214333736757, -10.784375822127894, -46.698052443277405, -142.75886317529, 56.353422139550794, -384.8176167350688, -18.85070542977231, -131.0698966848759, 10.520997895316361, -440.18887430252636, 7.612670804736037, -184.940806136346, -204.21689702501, -53.3364489114771, -169.13974398991272, -178.09478003740122, -13.416406975869801, -266.36415856382155, -30.59615414386507, 39.503503399292654, -17.79480905545693, -247.6637126726555, -47.0838062674837, 0.10801882701357357, 65.66428403674499, -194.32639484221744, -220.5185351474385, 39.36664277907182, -19.9947852301908, 20.080263504936575, -71.67401587311285, -166.57176252484717, 20.000000000000014, -178.06463760514634, -306.08922147010196, -75.95391329673038, -82.23355915107514, 81.27248845434643, -23.155821364895175, -235.78481961759113, -32.11366006043988, -421.3952334824777, -82.91252310236452, -223.56715714052368, 97.92501647334781, -75.9579056588536, -123.09412325151621, -294.2215015864982, -170.83299792763597, -79.54304600246147, -108.27997427371004, 79.47705818846214, -115.6248947135029, -187.89008935397095, -215.5386954039323, -14.052658290191715, -148.21692238436034, -30.26925778299517, -95.03854203097073, -4.861553737312303, 21.799898096167215, 49.48022857817864, -147.28877859455937, 53.89080488513944, -10.705076375390165, -138.6280596031105, -86.96440096495246, -93.27591339666986, -258.3265858904641, -33.458030615246095, -242.23048465820543, 173.78296229694658, -57.33258955706905, 4.740130654850783, 113.53929616252431, -169.53525912517028, -241.37677642170476, 94.01863401628688, -135.6138568371008, -245.2812688965758, 21.163739392580137, 12.826266400188288, -287.74349892165566, -36.7330615986355, -95.27052694006571, 56.34786106146613, -100.61257222087431, -223.99683640667521, -221.21668020981312, 55.71287650455124, -151.68554448692058, -69.67782727356096, -190.2985761928723, -9.014888033937039, -82.47779840041233, -77.08265323606834, -271.0454570313555, -225.79235639978614, -93.03210694443335, -42.37295678801604, -14.684602977671204, -155.52334885126], "policy_predator_policy_reward": [176.42693356636315, 191.67830768647855, 87.0426414591756, 72.33499915866702, 189.17616572325431, 177.7840761689185, 174.54086414447286, 113.53315135949919, 160.79970464611517, 38.10383757823844, 57.00428807762181, 210.23884542775855, 5.623295329198483, 111.568209487775, 244.1434269822024, 199.05154425601575, 213.7948893847166, 129.01409932444068, 132.3808956701934, 132.98165334111954, 218.52174972806122, 168.41667376110604, 96.68695735734677, 162.2841587989746, 92.66996162315226, 137.476129032213, 152.43685878900757, 178.16351214018147, 168.94486982767717, 29.691762335528658, 119.73788065553096, 224.45017480391698, 25.97579550452614, 55.92591671845189, 81.31200178674392, 11.214072769741149, 360.5124967565016, 124.24426681898021, 95.66324803035683, 118.2655020354873, 122.31482583679897, 177.49301179244452, 95.97135498846181, 84.66442652868894, 70.83604042208276, 206.76236534859837, 90.8125996736248, 179.60506082270132, 51.02491354029909, 46.8289984307485, 48.25379977656836, 15.133808018913028, 249.8382345029625, 117.78393145053006, 165.67618073013566, 114.22552517278984, 129.06358835575617, 121.24803728351371, 155.9586417299572, 67.78538772776166, 174.96750116029273, 186.55901156458475, 104.93335751906787, 194.7120117969268, 178.87825939597832, 0.9408749603107672, 195.16802014197523, 169.93280931936215, 90.36048342451289, 205.6971327786657, 73.3729973573996, 216.76591460156382, 220.5654336214281, 76.2928156883634, 48.33736738017627, 122.18110843095, 310.3274929308834, 114.08684774412677, 291.5504547252604, 244.93962654785616, 241.2684487458079, 150.0759186809709, 51.152718782745154, 77.2934558713744, 84.26255221568822, 133.33137253429038, 134.33322887046955, 120.40255997140711, 242.92564459019923, 167.40018680735986, 265.49802486207585, 191.69343796866877, 103.07283573627471, 87.29479436760715, 119.7398754180405, 31.30435545605454, 147.8669005558812, 179.62623721699677, 112.99164728219053, 264.696240426093, 95.49805244327707, 162.13895094597612, 170.9763008565495, 272.6359289629449, 98.63128776942837, 95.55269267004124, 195.7661128160438, 336.5291508830498, 88.787329195264, 210.14080613634576, 244.11689702500973, 69.75558040941168, 138.93353082488096, 248.8894457774444, 259.8160494550225, 106.82559786221894, 6.690766322585343, 59.2897067509954, 35.44710584266172, 264.011171804814, 65.56102244087623, 167.10503869315897, 90.68899936925543, 178.53898971896098, 214.92374001371812, 153.16873422877427, 38.62530908861536, 0.8766915553150988, 146.5266815182566, 163.2268716674271, 59.00155269249253, 179.93770467280797, 211.78577370968335, 308.93448986853303, 108.53355915107466, 35.4275115456535, 146.43632959530038, 161.73480357281917, 155.47669203702196, 352.7000873613309, 148.5446840755715, 225.42260161841196, 86.03114612300755, 94.81188284188786, 228.3970779841009, 261.7703432971511, 202.44114010276053, 89.60342456612332, 141.3376625672763, 21.993605583113116, 153.16724573323918, 204.27144149446698, 190.18184422334127, 150.41907359470517, 112.43559799948162, 104.47886018053948, 126.49548613150978, 42.561360338292246, 37.50829871842198, 77.21157460723232, 47.70424303716568, 211.89401244622397, 25.508244458953815, 162.0397754093932, 117.5066732441641, 137.63960072180012, 232.77184087909308, 94.7760514883528, 260.0304846582055, 21.631336406823436, 84.99112667892192, 93.44451541990702, 136.53871207469095, 129.25752908120822, 225.75862254373232, 65.75512917540146, 254.81878062917752, 225.4863760868122, 4.497527011379756, 17.76754289260328, 197.48229350630524, 183.8791308974685, 121.07800199326952, 19.998939760432922, 183.8155633155736, 250.86666537881797, 151.39175033306137, 160.21569101724373, 175.9405537650738, 129.30029360763194, 201.87382686973845, 57.93888973975423, 117.5312728925047, 147.87061737274914, 284.4097823943528, 229.04958762827127, 121.08407028070629, 86.57219814024438, 97.27906136583589, 144.0295422980331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.728949573719647, "mean_inference_ms": 4.740597030467042, "mean_action_processing_ms": 3.0299124016036556, "mean_env_wait_ms": 11.034792781468791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06918418407440186, "StateBufferConnector_ms": 0.04570627212524414, "ViewRequirementAgentConnector_ms": 1.0894105434417725}, "num_episodes": 36, "episode_return_max": 272.1020343629796, "episode_return_min": 16.62155659148304, "episode_return_mean": 111.18200231153634, "episodes_this_iter": 36}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 844480, "num_agent_steps_trained": 844480, "num_env_steps_sampled": 211120, "num_env_steps_trained": 211120, "num_env_steps_sampled_this_iter": 7120, "num_env_steps_trained_this_iter": 7120, "num_env_steps_sampled_throughput_per_sec": 22.316565562601177, "num_env_steps_trained_throughput_per_sec": 22.316565562601177, "timesteps_total": 211120, "num_env_steps_sampled_lifetime": 211120, "num_agent_steps_sampled_lifetime": 844480, "num_steps_trained_this_iter": 7120, "agent_timesteps_total": 844480, "timers": {"training_iteration_time_ms": 86318.118, "restore_workers_time_ms": 2.983, "training_step_time_ms": 86306.696, "sample_time_ms": 15187.776, "learn_time_ms": 70990.446, "learn_throughput": 60.741, "synch_weights_time_ms": 112.428}, "counters": {"num_env_steps_sampled": 211120, "num_env_steps_trained": 211120, "num_agent_steps_sampled": 844480, "num_agent_steps_trained": 844480}, "done": false, "training_iteration": 52, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-09-03", "timestamp": 1724150343, "time_this_iter_s": 319.76650977134705, "time_total_s": 2905.096739292145, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12002de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2905.096739292145, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 77.93582766439908, "ram_util_percent": 84.91972789115646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.438595296529234, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.917708014432716, "policy_loss": -0.017060819090092702, "vf_loss": 6.932237283514921, "vf_explained_var": 0.08212712328269998, "kl": 0.012657608949239292, "entropy": 0.713850465779582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 100695.5, "diff_num_grad_updates_vs_sampler_policy": 990.6999999999972}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9866044417260187, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.604342006501698, "policy_loss": -0.014796817833779468, "vf_loss": 5.617428355242209, "vf_explained_var": 0.17344684991887008, "kl": 0.008552368394488459, "entropy": 0.794983402698759, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 100695.5, "diff_num_grad_updates_vs_sampler_policy": 990.6999999999972}}, "num_env_steps_sampled": 215120, "num_env_steps_trained": 215120, "num_agent_steps_sampled": 860480, "num_agent_steps_trained": 860480}, "env_runners": {"episode_reward_max": 267.67933699259277, "episode_reward_min": 16.62155659148304, "episode_reward_mean": 103.91226889277344, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -440.18887430252636, "predator_policy": 0.7928504905228818}, "policy_reward_max": {"prey_policy": 173.78296229694658, "predator_policy": 375.2241130814009}, "policy_reward_mean": {"prey_policy": -85.9877949392503, "predator_policy": 137.94392938563698}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.80739086609972, 55.9000000000004, 189.0999999999994, 89.28142903215252, 67.01422433074468, 105.79491571438139, 61.839738214414126, 196.53825647644268, 161.26394149607418, 59.26967198331379, 67.80598434537076, 87.78549042237115, 35.78066120659691, 124.03517039233152, 207.90791291030837, 48.810036395440456, 206.63122209302963, 165.85711860405453, 267.67933699259277, 60.569106598434715, 140.29833589446022, 165.3483064212203, 225.9864180197391, 115.15842979861597, 118.71094176356364, 146.42596564305748, 105.54136854878796, 68.18008777068673, 115.1480352239762, 44.263378324821915, 102.62738729188263, 121.59999999999981, 56.31913149793471, 40.58845257501225, 86.8610817775476, 74.88782232900819, 33.99975591936299, 185.69027369356488, 140.56587828274354, 186.94058187412554, 39.58747891867627, 71.50777478772406, 80.8746197601539, 138.67712881138365, 142.9999999999995, 49.23049218563365, 54.66788585543539, 67.48760545109548, 202.8101397793896, 72.85179644323759, 41.66852073878741, 134.52835206514183, 53.9237031602332, 111.00956412392203, 38.428278012665665, 69.1567507015198, 185.99999999999977, 166.20028177396966, 38.21488388984654, 74.90595960434318, 35.763275861735806, 213.21429870377005, 125.84318319660969, 209.80027819325312, 144.1556093137161, 99.41003098231357, 56.25507569675191, 56.88486388348265, 102.15427587510227, 110.0728200668421, 146.1036376450434, 83.87747561222402, 60.4992523826839, 105.84143862877359, 16.62155659148304, 72.25120468850224, 71.10065183493795, 72.31428998214385, 65.19806516144645, 133.48767450923768, 182.77564502364996, 100.64334600910871, 127.1426821473527, 36.16854847737069, 106.97082923634827, 92.56588096558599, 247.578767485011, 163.5205471669292, 37.70000000000018, 62.42983504018999, 89.93279141495117, 36.80000000000025, 143.99999999999943, 22.360739888817342, 193.00991677588868, 35.645568675085045, 33.15941896971588, 86.84201340327546, 88.24309411257897, 74.34384888800878], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-65.30123615685864, -125.30903347336807, -25.747659225900556, -16.20625274514661, 122.24620022343166, 3.4661919810869373, -171.12870431281914, -107.21203260852093, -7.5835170687848485, -205.30396450339654, -86.95340236493206, -57.563307559956684, -148.1586417299576, -13.745649513347663, -106.6323194587215, -58.355936789713134, -244.77612242435538, 106.39469460443499, 39.156187311759425, -159.70564968473522, -294.7018417919551, -2.593003324011971, -11.683341112636565, -196.58878466817123, -49.31763152815643, -205.04061922421005, 24.135108930042612, -196.95818784750202, 61.37054553013214, -23.981108430950044, -284.70002784193525, -90.90427643763421, -34.03348623146087, -295.8253729486263, -336.57078952000984, 111.08354069728558, 120.7679460410618, 18.465216297410777, -59.74169514202824, -97.28312300951623, -62.00060855544764, -52.436844391968705, -348.8609629958657, 103.88343801952745, 48.09007048045019, -279.29511529145503, 6.400823976784225, -81.61002428204995, -75.10067861141178, 42.76738950088027, -40.024714935406095, -141.0424571944142, -261.36214333736757, -10.784375822127894, -46.698052443277405, -142.75886317529, 56.353422139550794, -384.8176167350688, -18.85070542977231, -131.0698966848759, 10.520997895316361, -440.18887430252636, 7.612670804736037, -184.940806136346, -204.21689702501, -53.3364489114771, -169.13974398991272, -178.09478003740122, -13.416406975869801, -266.36415856382155, -30.59615414386507, 39.503503399292654, -17.79480905545693, -247.6637126726555, -47.0838062674837, 0.10801882701357357, 65.66428403674499, -194.32639484221744, -220.5185351474385, 39.36664277907182, -19.9947852301908, 20.080263504936575, -71.67401587311285, -166.57176252484717, 20.000000000000014, -178.06463760514634, -306.08922147010196, -75.95391329673038, -82.23355915107514, 81.27248845434643, -23.155821364895175, -235.78481961759113, -32.11366006043988, -421.3952334824777, -82.91252310236452, -223.56715714052368, 97.92501647334781, -75.9579056588536, -123.09412325151621, -294.2215015864982, -170.83299792763597, -79.54304600246147, -108.27997427371004, 79.47705818846214, -115.6248947135029, -187.89008935397095, -215.5386954039323, -14.052658290191715, -148.21692238436034, -30.26925778299517, -95.03854203097073, -4.861553737312303, 21.799898096167215, 49.48022857817864, -147.28877859455937, 53.89080488513944, -10.705076375390165, -138.6280596031105, -86.96440096495246, -93.27591339666986, -258.3265858904641, -33.458030615246095, -242.23048465820543, 173.78296229694658, -57.33258955706905, 4.740130654850783, 113.53929616252431, -169.53525912517028, -241.37677642170476, 94.01863401628688, -135.6138568371008, -245.2812688965758, 21.163739392580137, 12.826266400188288, -287.74349892165566, -36.7330615986355, -95.27052694006571, 56.34786106146613, -100.61257222087431, -223.99683640667521, -221.21668020981312, 55.71287650455124, -151.68554448692058, -69.67782727356096, -190.2985761928723, -9.014888033937039, -82.47779840041233, -77.08265323606834, -271.0454570313555, -225.79235639978614, -93.03210694443335, -42.37295678801604, -14.684602977671204, -155.52334885126, -233.76374744745473, 44.15392127585968, -30.019123723862513, -43.67120244106156, -7.76812792439028, 2.4131448036343146, -41.33199219057835, 6.066014203073394, -15.196915690111995, -90.71432483941759, -119.00646526069103, -24.86876113744405, -252.24840858808025, -48.59605958973865, -65.11324288918887, 5.171807305628093, -133.1991871739373, 29.28024045835307, 44.53891749806478, -39.67530404609471, 94.64516111242061, -36.15393277023253, -94.64330820049695, -119.54022178619965, -33.43984288928571, -373.0241130814009, -64.83397204945581, -52.70155278361455, -40.3577384827638, 19.10714950947712, 69.19560506797966, -13.962420687748073, -227.07214135422421, -105.98817421210785, -6.387474404258501, -29.62909800691255, -95.04193208461082, -224.8060343491688, -67.4836415003889, -135.91639172772958, 17.02495678583624, -218.5605991545324, -120.48965667247909, -230.192033022734, -138.54740306758822, -23.412825982148988], "policy_predator_policy_reward": [90.8125996736248, 179.60506082270132, 51.02491354029909, 46.8289984307485, 48.25379977656836, 15.133808018913028, 249.8382345029625, 117.78393145053006, 165.67618073013566, 114.22552517278984, 129.06358835575617, 121.24803728351371, 155.9586417299572, 67.78538772776166, 174.96750116029273, 186.55901156458475, 104.93335751906787, 194.7120117969268, 178.87825939597832, 0.9408749603107672, 195.16802014197523, 169.93280931936215, 90.36048342451289, 205.6971327786657, 73.3729973573996, 216.76591460156382, 220.5654336214281, 76.2928156883634, 48.33736738017627, 122.18110843095, 310.3274929308834, 114.08684774412677, 291.5504547252604, 244.93962654785616, 241.2684487458079, 150.0759186809709, 51.152718782745154, 77.2934558713744, 84.26255221568822, 133.33137253429038, 134.33322887046955, 120.40255997140711, 242.92564459019923, 167.40018680735986, 265.49802486207585, 191.69343796866877, 103.07283573627471, 87.29479436760715, 119.7398754180405, 31.30435545605454, 147.8669005558812, 179.62623721699677, 112.99164728219053, 264.696240426093, 95.49805244327707, 162.13895094597612, 170.9763008565495, 272.6359289629449, 98.63128776942837, 95.55269267004124, 195.7661128160438, 336.5291508830498, 88.787329195264, 210.14080613634576, 244.11689702500973, 69.75558040941168, 138.93353082488096, 248.8894457774444, 259.8160494550225, 106.82559786221894, 6.690766322585343, 59.2897067509954, 35.44710584266172, 264.011171804814, 65.56102244087623, 167.10503869315897, 90.68899936925543, 178.53898971896098, 214.92374001371812, 153.16873422877427, 38.62530908861536, 0.8766915553150988, 146.5266815182566, 163.2268716674271, 59.00155269249253, 179.93770467280797, 211.78577370968335, 308.93448986853303, 108.53355915107466, 35.4275115456535, 146.43632959530038, 161.73480357281917, 155.47669203702196, 352.7000873613309, 148.5446840755715, 225.42260161841196, 86.03114612300755, 94.81188284188786, 228.3970779841009, 261.7703432971511, 202.44114010276053, 89.60342456612332, 141.3376625672763, 21.993605583113116, 153.16724573323918, 204.27144149446698, 190.18184422334127, 150.41907359470517, 112.43559799948162, 104.47886018053948, 126.49548613150978, 42.561360338292246, 37.50829871842198, 77.21157460723232, 47.70424303716568, 211.89401244622397, 25.508244458953815, 162.0397754093932, 117.5066732441641, 137.63960072180012, 232.77184087909308, 94.7760514883528, 260.0304846582055, 21.631336406823436, 84.99112667892192, 93.44451541990702, 136.53871207469095, 129.25752908120822, 225.75862254373232, 65.75512917540146, 254.81878062917752, 225.4863760868122, 4.497527011379756, 17.76754289260328, 197.48229350630524, 183.8791308974685, 121.07800199326952, 19.998939760432922, 183.8155633155736, 250.86666537881797, 151.39175033306137, 160.21569101724373, 175.9405537650738, 129.30029360763194, 201.87382686973845, 57.93888973975423, 117.5312728925047, 147.87061737274914, 284.4097823943528, 229.04958762827127, 121.08407028070629, 86.57219814024438, 97.27906136583589, 144.0295422980331, 222.0128793859604, 39.91123676777841, 79.33332499681893, 59.55506632955139, 92.75580243362873, 46.086855196365725, 142.56588664420968, 75.47573636694608, 58.69345584085511, 147.86113069778366, 120.33166812929751, 150.68624041619043, 185.67750355976276, 151.33551309542702, 129.17981426661925, 37.73245055328969, 161.9193063997869, 34.56552128138378, 156.04344101032694, 86.67171302271394, 75.6803513291104, 29.34896749563079, 107.54330820049623, 144.3402217861988, 93.66967792947557, 375.2241130814009, 68.12841317325505, 139.33990307476665, 57.25773848276404, 0.7928504905228818, 57.60439493202028, 31.162420687748273, 158.9530009471509, 196.46805450799764, 159.01207652235954, 70.01441266470054, 129.605548886558, 225.88798622230604, 104.8603764500469, 131.69907574778577, 157.12708445596553, 131.25057131600613, 134.73088180001866, 304.19390200777326, 164.74901772224615, 71.55506021549974]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.631264595227958, "mean_inference_ms": 5.381180750478734, "mean_action_processing_ms": 4.069726262181956, "mean_env_wait_ms": 11.556072549434084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07290875911712646, "StateBufferConnector_ms": 0.04761803150177002, "ViewRequirementAgentConnector_ms": 1.1612461805343628}, "num_episodes": 23, "episode_return_max": 267.67933699259277, "episode_return_min": 16.62155659148304, "episode_return_mean": 103.91226889277344, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 860480, "num_agent_steps_trained": 860480, "num_env_steps_sampled": 215120, "num_env_steps_trained": 215120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 68.98334852959468, "num_env_steps_trained_throughput_per_sec": 68.98334852959468, "timesteps_total": 215120, "num_env_steps_sampled_lifetime": 215120, "num_agent_steps_sampled_lifetime": 860480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 860480, "timers": {"training_iteration_time_ms": 87407.704, "restore_workers_time_ms": 2.984, "training_step_time_ms": 87396.28, "sample_time_ms": 15444.94, "learn_time_ms": 71822.3, "learn_throughput": 60.037, "synch_weights_time_ms": 112.581}, "counters": {"num_env_steps_sampled": 215120, "num_env_steps_trained": 215120, "num_agent_steps_sampled": 860480, "num_agent_steps_trained": 860480}, "done": false, "training_iteration": 53, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-10-01", "timestamp": 1724150401, "time_this_iter_s": 58.07823586463928, "time_total_s": 2963.174975156784, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33132b940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2963.174975156784, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 54.55301204819279, "ram_util_percent": 83.59759036144578}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.573816139609725, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.820841940117892, "policy_loss": -0.014102278546449881, "vf_loss": 6.833092071139624, "vf_explained_var": 0.1715485097239257, "kl": 0.00926079721838019, "entropy": 0.7171953341632924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 102585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.654981415233915, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.5313847413138735, "policy_loss": -0.014256854794387307, "vf_loss": 5.543888401859021, "vf_explained_var": 0.17678629960963335, "kl": 0.00876597729511559, "entropy": 0.7908772362603081, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 102585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 219120, "num_env_steps_trained": 219120, "num_agent_steps_sampled": 876480, "num_agent_steps_trained": 876480}, "env_runners": {"episode_reward_max": 247.578767485011, "episode_reward_min": -11.094586726350926, "episode_reward_mean": 98.97749613977058, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -440.18887430252636, "predator_policy": 0.7928504905228818}, "policy_reward_max": {"prey_policy": 173.78296229694658, "predator_policy": 375.2241130814009}, "policy_reward_mean": {"prey_policy": -89.21719019467302, "predator_policy": 138.7059382645583}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.42596564305748, 105.54136854878796, 68.18008777068673, 115.1480352239762, 44.263378324821915, 102.62738729188263, 121.59999999999981, 56.31913149793471, 40.58845257501225, 86.8610817775476, 74.88782232900819, 33.99975591936299, 185.69027369356488, 140.56587828274354, 186.94058187412554, 39.58747891867627, 71.50777478772406, 80.8746197601539, 138.67712881138365, 142.9999999999995, 49.23049218563365, 54.66788585543539, 67.48760545109548, 202.8101397793896, 72.85179644323759, 41.66852073878741, 134.52835206514183, 53.9237031602332, 111.00956412392203, 38.428278012665665, 69.1567507015198, 185.99999999999977, 166.20028177396966, 38.21488388984654, 74.90595960434318, 35.763275861735806, 213.21429870377005, 125.84318319660969, 209.80027819325312, 144.1556093137161, 99.41003098231357, 56.25507569675191, 56.88486388348265, 102.15427587510227, 110.0728200668421, 146.1036376450434, 83.87747561222402, 60.4992523826839, 105.84143862877359, 16.62155659148304, 72.25120468850224, 71.10065183493795, 72.31428998214385, 65.19806516144645, 133.48767450923768, 182.77564502364996, 100.64334600910871, 127.1426821473527, 36.16854847737069, 106.97082923634827, 92.56588096558599, 247.578767485011, 163.5205471669292, 37.70000000000018, 62.42983504018999, 89.93279141495117, 36.80000000000025, 143.99999999999943, 22.360739888817342, 193.00991677588868, 35.645568675085045, 33.15941896971588, 86.84201340327546, 88.24309411257897, 74.34384888800878, -11.094586726350926, 76.93470348974225, 28.363903118831587, 71.6962223659815, 122.9685141038876, 48.933066785059374, 138.8191730623174, 186.76441152072354, 64.6000000000002, 115.45090076646565, 38.73801563921989, 30.60196923509085, 93.76334342214759, 162.49950198839727, 96.60593544786948, 127.7385186780784, 48.3677545201458, 85.38047508092284, 199.59999999999928, 143.2064648151114, 135.5782596345528, 137.77451057140402, 106.76863911431559, 195.56664213909028, 165.07042589846293], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-40.024714935406095, -141.0424571944142, -261.36214333736757, -10.784375822127894, -46.698052443277405, -142.75886317529, 56.353422139550794, -384.8176167350688, -18.85070542977231, -131.0698966848759, 10.520997895316361, -440.18887430252636, 7.612670804736037, -184.940806136346, -204.21689702501, -53.3364489114771, -169.13974398991272, -178.09478003740122, -13.416406975869801, -266.36415856382155, -30.59615414386507, 39.503503399292654, -17.79480905545693, -247.6637126726555, -47.0838062674837, 0.10801882701357357, 65.66428403674499, -194.32639484221744, -220.5185351474385, 39.36664277907182, -19.9947852301908, 20.080263504936575, -71.67401587311285, -166.57176252484717, 20.000000000000014, -178.06463760514634, -306.08922147010196, -75.95391329673038, -82.23355915107514, 81.27248845434643, -23.155821364895175, -235.78481961759113, -32.11366006043988, -421.3952334824777, -82.91252310236452, -223.56715714052368, 97.92501647334781, -75.9579056588536, -123.09412325151621, -294.2215015864982, -170.83299792763597, -79.54304600246147, -108.27997427371004, 79.47705818846214, -115.6248947135029, -187.89008935397095, -215.5386954039323, -14.052658290191715, -148.21692238436034, -30.26925778299517, -95.03854203097073, -4.861553737312303, 21.799898096167215, 49.48022857817864, -147.28877859455937, 53.89080488513944, -10.705076375390165, -138.6280596031105, -86.96440096495246, -93.27591339666986, -258.3265858904641, -33.458030615246095, -242.23048465820543, 173.78296229694658, -57.33258955706905, 4.740130654850783, 113.53929616252431, -169.53525912517028, -241.37677642170476, 94.01863401628688, -135.6138568371008, -245.2812688965758, 21.163739392580137, 12.826266400188288, -287.74349892165566, -36.7330615986355, -95.27052694006571, 56.34786106146613, -100.61257222087431, -223.99683640667521, -221.21668020981312, 55.71287650455124, -151.68554448692058, -69.67782727356096, -190.2985761928723, -9.014888033937039, -82.47779840041233, -77.08265323606834, -271.0454570313555, -225.79235639978614, -93.03210694443335, -42.37295678801604, -14.684602977671204, -155.52334885126, -233.76374744745473, 44.15392127585968, -30.019123723862513, -43.67120244106156, -7.76812792439028, 2.4131448036343146, -41.33199219057835, 6.066014203073394, -15.196915690111995, -90.71432483941759, -119.00646526069103, -24.86876113744405, -252.24840858808025, -48.59605958973865, -65.11324288918887, 5.171807305628093, -133.1991871739373, 29.28024045835307, 44.53891749806478, -39.67530404609471, 94.64516111242061, -36.15393277023253, -94.64330820049695, -119.54022178619965, -33.43984288928571, -373.0241130814009, -64.83397204945581, -52.70155278361455, -40.3577384827638, 19.10714950947712, 69.19560506797966, -13.962420687748073, -227.07214135422421, -105.98817421210785, -6.387474404258501, -29.62909800691255, -95.04193208461082, -224.8060343491688, -67.4836415003889, -135.91639172772958, 17.02495678583624, -218.5605991545324, -120.48965667247909, -230.192033022734, -138.54740306758822, -23.412825982148988, -120.1609430224899, -332.4039181422927, -79.68929161259867, -327.66086851473835, 4.643337274408115, -57.76028528861733, -230.48749793018212, -58.2142540642894, -26.31570046283016, 14.965741343945403, 17.114363071632184, -201.73801097265152, -276.0866163365276, -179.33283027957725, 75.04423917623174, -297.8715358493626, -101.71279666204957, -33.39303691168629, -111.82309476522187, 15.331486932183026, -184.56491241857807, -284.9913077510258, -34.024670637965485, -101.31192960094607, -18.323399657038806, -62.87923264792377, 86.35599475680853, -141.4823549701738, -117.0687662860517, -44.73118193745254, 68.97852961562008, -75.3369974932884, -1.3873539587999342, -12.795931064596857, -116.2550908059227, -227.63096562521358, 140.96953198931925, -27.111988400114978, -277.2442783626125, 21.350988775195322, 85.69902069259467, -243.83045496921065, -109.68655137683004, -200.74342488463938, 22.822874495194313, -56.89283472485769, -73.81965690313591, -15.205559934446399, -174.69417985682583, -33.17505333814355], "policy_predator_policy_reward": [147.8669005558812, 179.62623721699677, 112.99164728219053, 264.696240426093, 95.49805244327707, 162.13895094597612, 170.9763008565495, 272.6359289629449, 98.63128776942837, 95.55269267004124, 195.7661128160438, 336.5291508830498, 88.787329195264, 210.14080613634576, 244.11689702500973, 69.75558040941168, 138.93353082488096, 248.8894457774444, 259.8160494550225, 106.82559786221894, 6.690766322585343, 59.2897067509954, 35.44710584266172, 264.011171804814, 65.56102244087623, 167.10503869315897, 90.68899936925543, 178.53898971896098, 214.92374001371812, 153.16873422877427, 38.62530908861536, 0.8766915553150988, 146.5266815182566, 163.2268716674271, 59.00155269249253, 179.93770467280797, 211.78577370968335, 308.93448986853303, 108.53355915107466, 35.4275115456535, 146.43632959530038, 161.73480357281917, 155.47669203702196, 352.7000873613309, 148.5446840755715, 225.42260161841196, 86.03114612300755, 94.81188284188786, 228.3970779841009, 261.7703432971511, 202.44114010276053, 89.60342456612332, 141.3376625672763, 21.993605583113116, 153.16724573323918, 204.27144149446698, 190.18184422334127, 150.41907359470517, 112.43559799948162, 104.47886018053948, 126.49548613150978, 42.561360338292246, 37.50829871842198, 77.21157460723232, 47.70424303716568, 211.89401244622397, 25.508244458953815, 162.0397754093932, 117.5066732441641, 137.63960072180012, 232.77184087909308, 94.7760514883528, 260.0304846582055, 21.631336406823436, 84.99112667892192, 93.44451541990702, 136.53871207469095, 129.25752908120822, 225.75862254373232, 65.75512917540146, 254.81878062917752, 225.4863760868122, 4.497527011379756, 17.76754289260328, 197.48229350630524, 183.8791308974685, 121.07800199326952, 19.998939760432922, 183.8155633155736, 250.86666537881797, 151.39175033306137, 160.21569101724373, 175.9405537650738, 129.30029360763194, 201.87382686973845, 57.93888973975423, 117.5312728925047, 147.87061737274914, 284.4097823943528, 229.04958762827127, 121.08407028070629, 86.57219814024438, 97.27906136583589, 144.0295422980331, 222.0128793859604, 39.91123676777841, 79.33332499681893, 59.55506632955139, 92.75580243362873, 46.086855196365725, 142.56588664420968, 75.47573636694608, 58.69345584085511, 147.86113069778366, 120.33166812929751, 150.68624041619043, 185.67750355976276, 151.33551309542702, 129.17981426661925, 37.73245055328969, 161.9193063997869, 34.56552128138378, 156.04344101032694, 86.67171302271394, 75.6803513291104, 29.34896749563079, 107.54330820049623, 144.3402217861988, 93.66967792947557, 375.2241130814009, 68.12841317325505, 139.33990307476665, 57.25773848276404, 0.7928504905228818, 57.60439493202028, 31.162420687748273, 158.9530009471509, 196.46805450799764, 159.01207652235954, 70.01441266470054, 129.605548886558, 225.88798622230604, 104.8603764500469, 131.69907574778577, 157.12708445596553, 131.25057131600613, 134.73088180001866, 304.19390200777326, 164.74901772224615, 71.55506021549974, 79.11039014981927, 362.3598842886127, 156.22399510234078, 328.06086851473833, 8.108131642470523, 73.37271949056978, 147.02381679046573, 213.37415756998695, 51.375463833026615, 82.94300938974592, 99.67230591029382, 133.88440877578424, 258.2586831509205, 335.9799365275027, 241.60459073422325, 167.9871174596313, 113.11279666204904, 86.59303691168643, 153.3922796884168, 58.55022891108821, 164.11543080461811, 344.17880500420705, 51.45375833784899, 114.48481113615259, 64.35457944884236, 110.61139627826844, 34.14350723158887, 183.48235497017367, 186.86876628605162, 71.53711738532219, 32.677622065240904, 101.4193644905056, 25.943223761423123, 36.60781578211923, 177.76055507670998, 251.50597643534908, 22.01883997878175, 63.72361643201379, 143.40369206992455, 255.696062332606, 36.695633829659535, 257.01406008150923, 273.1636977624989, 175.04078907037473, 31.919360701113803, 108.91923864286565, 172.75913888754454, 111.83272008912826, 206.59417985682558, 166.34547923660676]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.594398962113705, "mean_inference_ms": 6.051463160064065, "mean_action_processing_ms": 4.7446012654903384, "mean_env_wait_ms": 12.18832684002476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07721781730651855, "StateBufferConnector_ms": 0.054485321044921875, "ViewRequirementAgentConnector_ms": 1.1689000129699707}, "num_episodes": 25, "episode_return_max": 247.578767485011, "episode_return_min": -11.094586726350926, "episode_return_mean": 98.97749613977058, "episodes_this_iter": 25}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876480, "num_agent_steps_trained": 876480, "num_env_steps_sampled": 219120, "num_env_steps_trained": 219120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.32256794340758, "num_env_steps_trained_throughput_per_sec": 70.32256794340758, "timesteps_total": 219120, "num_env_steps_sampled_lifetime": 219120, "num_agent_steps_sampled_lifetime": 876480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 876480, "timers": {"training_iteration_time_ms": 88375.404, "restore_workers_time_ms": 2.984, "training_step_time_ms": 88363.983, "sample_time_ms": 15557.491, "learn_time_ms": 72676.83, "learn_throughput": 59.331, "synch_weights_time_ms": 112.926}, "counters": {"num_env_steps_sampled": 219120, "num_env_steps_trained": 219120, "num_agent_steps_sampled": 876480, "num_agent_steps_trained": 876480}, "done": false, "training_iteration": 54, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-10-58", "timestamp": 1724150458, "time_this_iter_s": 56.95173192024231, "time_total_s": 3020.1267070770264, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12002bb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3020.1267070770264, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 56.33125, "ram_util_percent": 83.45750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.696101114485, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.331027804732954, "policy_loss": -0.015570190399835902, "vf_loss": 7.344468891809857, "vf_explained_var": 0.0264530635700024, "kl": 0.010645621996028004, "entropy": 0.7028691393673104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.009684131889747, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.274882130143504, "policy_loss": -0.01881398343968959, "vf_loss": 6.291521209131473, "vf_explained_var": 0.12963752863268374, "kl": 0.0108745638803436, "entropy": 0.7565408732840624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 223120, "num_env_steps_trained": 223120, "num_agent_steps_sampled": 892480, "num_agent_steps_trained": 892480}, "env_runners": {"episode_reward_max": 247.578767485011, "episode_reward_min": -11.094586726350926, "episode_reward_mean": 100.65969089832069, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -421.3952334824777, "predator_policy": 0.7928504905228818}, "policy_reward_max": {"prey_policy": 185.97728007271178, "predator_policy": 375.2241130814009}, "policy_reward_mean": {"prey_policy": -88.68396032360266, "predator_policy": 139.01380577276296}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.8746197601539, 138.67712881138365, 142.9999999999995, 49.23049218563365, 54.66788585543539, 67.48760545109548, 202.8101397793896, 72.85179644323759, 41.66852073878741, 134.52835206514183, 53.9237031602332, 111.00956412392203, 38.428278012665665, 69.1567507015198, 185.99999999999977, 166.20028177396966, 38.21488388984654, 74.90595960434318, 35.763275861735806, 213.21429870377005, 125.84318319660969, 209.80027819325312, 144.1556093137161, 99.41003098231357, 56.25507569675191, 56.88486388348265, 102.15427587510227, 110.0728200668421, 146.1036376450434, 83.87747561222402, 60.4992523826839, 105.84143862877359, 16.62155659148304, 72.25120468850224, 71.10065183493795, 72.31428998214385, 65.19806516144645, 133.48767450923768, 182.77564502364996, 100.64334600910871, 127.1426821473527, 36.16854847737069, 106.97082923634827, 92.56588096558599, 247.578767485011, 163.5205471669292, 37.70000000000018, 62.42983504018999, 89.93279141495117, 36.80000000000025, 143.99999999999943, 22.360739888817342, 193.00991677588868, 35.645568675085045, 33.15941896971588, 86.84201340327546, 88.24309411257897, 74.34384888800878, -11.094586726350926, 76.93470348974225, 28.363903118831587, 71.6962223659815, 122.9685141038876, 48.933066785059374, 138.8191730623174, 186.76441152072354, 64.6000000000002, 115.45090076646565, 38.73801563921989, 30.60196923509085, 93.76334342214759, 162.49950198839727, 96.60593544786948, 127.7385186780784, 48.3677545201458, 85.38047508092284, 199.59999999999928, 143.2064648151114, 135.5782596345528, 137.77451057140402, 106.76863911431559, 195.56664213909028, 165.07042589846293, 164.98163672108626, 34.51234749325603, 120.94975864097434, 56.13377567343875, 95.38357174273517, 72.58493626693004, 83.61232866855636, 61.42920239253603, 131.80169101380142, 66.00000000000001, 88.1142976989129, 51.60254738836585, 160.94107358669328, 41.156964145066624, 211.07938142561716, 140.57236588515903, 208.09805157079512], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.000000000000014, -178.06463760514634, -306.08922147010196, -75.95391329673038, -82.23355915107514, 81.27248845434643, -23.155821364895175, -235.78481961759113, -32.11366006043988, -421.3952334824777, -82.91252310236452, -223.56715714052368, 97.92501647334781, -75.9579056588536, -123.09412325151621, -294.2215015864982, -170.83299792763597, -79.54304600246147, -108.27997427371004, 79.47705818846214, -115.6248947135029, -187.89008935397095, -215.5386954039323, -14.052658290191715, -148.21692238436034, -30.26925778299517, -95.03854203097073, -4.861553737312303, 21.799898096167215, 49.48022857817864, -147.28877859455937, 53.89080488513944, -10.705076375390165, -138.6280596031105, -86.96440096495246, -93.27591339666986, -258.3265858904641, -33.458030615246095, -242.23048465820543, 173.78296229694658, -57.33258955706905, 4.740130654850783, 113.53929616252431, -169.53525912517028, -241.37677642170476, 94.01863401628688, -135.6138568371008, -245.2812688965758, 21.163739392580137, 12.826266400188288, -287.74349892165566, -36.7330615986355, -95.27052694006571, 56.34786106146613, -100.61257222087431, -223.99683640667521, -221.21668020981312, 55.71287650455124, -151.68554448692058, -69.67782727356096, -190.2985761928723, -9.014888033937039, -82.47779840041233, -77.08265323606834, -271.0454570313555, -225.79235639978614, -93.03210694443335, -42.37295678801604, -14.684602977671204, -155.52334885126, -233.76374744745473, 44.15392127585968, -30.019123723862513, -43.67120244106156, -7.76812792439028, 2.4131448036343146, -41.33199219057835, 6.066014203073394, -15.196915690111995, -90.71432483941759, -119.00646526069103, -24.86876113744405, -252.24840858808025, -48.59605958973865, -65.11324288918887, 5.171807305628093, -133.1991871739373, 29.28024045835307, 44.53891749806478, -39.67530404609471, 94.64516111242061, -36.15393277023253, -94.64330820049695, -119.54022178619965, -33.43984288928571, -373.0241130814009, -64.83397204945581, -52.70155278361455, -40.3577384827638, 19.10714950947712, 69.19560506797966, -13.962420687748073, -227.07214135422421, -105.98817421210785, -6.387474404258501, -29.62909800691255, -95.04193208461082, -224.8060343491688, -67.4836415003889, -135.91639172772958, 17.02495678583624, -218.5605991545324, -120.48965667247909, -230.192033022734, -138.54740306758822, -23.412825982148988, -120.1609430224899, -332.4039181422927, -79.68929161259867, -327.66086851473835, 4.643337274408115, -57.76028528861733, -230.48749793018212, -58.2142540642894, -26.31570046283016, 14.965741343945403, 17.114363071632184, -201.73801097265152, -276.0866163365276, -179.33283027957725, 75.04423917623174, -297.8715358493626, -101.71279666204957, -33.39303691168629, -111.82309476522187, 15.331486932183026, -184.56491241857807, -284.9913077510258, -34.024670637965485, -101.31192960094607, -18.323399657038806, -62.87923264792377, 86.35599475680853, -141.4823549701738, -117.0687662860517, -44.73118193745254, 68.97852961562008, -75.3369974932884, -1.3873539587999342, -12.795931064596857, -116.2550908059227, -227.63096562521358, 140.96953198931925, -27.111988400114978, -277.2442783626125, 21.350988775195322, 85.69902069259467, -243.83045496921065, -109.68655137683004, -200.74342488463938, 22.822874495194313, -56.89283472485769, -73.81965690313591, -15.205559934446399, -174.69417985682583, -33.17505333814355, -83.80632864884294, 16.045176674287717, -77.70556473862531, -136.282384721199, -4.902301951219044, -288.10273052679906, -201.60286541617077, -17.623828027183947, -103.34345905559013, -148.5159310192589, -168.18174273329703, -36.29750025847541, -365.91599460135166, -48.3715256399325, -48.42843813346465, -226.0433817275555, -92.40651758229963, -45.861110982419675, -108.96990369300687, -100.82651166625101, -83.78495045423992, -204.2740251664841, -32.50884032832175, -333.5549965580934, -172.34609867274744, 43.15417472772533, -92.80731425245848, -89.65362076004241, 185.97728007271178, -80.96520733208021, 53.72944824399943, -78.52210885539161, 159.79296513935884, -344.56900121177574], "policy_predator_policy_reward": [59.00155269249253, 179.93770467280797, 211.78577370968335, 308.93448986853303, 108.53355915107466, 35.4275115456535, 146.43632959530038, 161.73480357281917, 155.47669203702196, 352.7000873613309, 148.5446840755715, 225.42260161841196, 86.03114612300755, 94.81188284188786, 228.3970779841009, 261.7703432971511, 202.44114010276053, 89.60342456612332, 141.3376625672763, 21.993605583113116, 153.16724573323918, 204.27144149446698, 190.18184422334127, 150.41907359470517, 112.43559799948162, 104.47886018053948, 126.49548613150978, 42.561360338292246, 37.50829871842198, 77.21157460723232, 47.70424303716568, 211.89401244622397, 25.508244458953815, 162.0397754093932, 117.5066732441641, 137.63960072180012, 232.77184087909308, 94.7760514883528, 260.0304846582055, 21.631336406823436, 84.99112667892192, 93.44451541990702, 136.53871207469095, 129.25752908120822, 225.75862254373232, 65.75512917540146, 254.81878062917752, 225.4863760868122, 4.497527011379756, 17.76754289260328, 197.48229350630524, 183.8791308974685, 121.07800199326952, 19.998939760432922, 183.8155633155736, 250.86666537881797, 151.39175033306137, 160.21569101724373, 175.9405537650738, 129.30029360763194, 201.87382686973845, 57.93888973975423, 117.5312728925047, 147.87061737274914, 284.4097823943528, 229.04958762827127, 121.08407028070629, 86.57219814024438, 97.27906136583589, 144.0295422980331, 222.0128793859604, 39.91123676777841, 79.33332499681893, 59.55506632955139, 92.75580243362873, 46.086855196365725, 142.56588664420968, 75.47573636694608, 58.69345584085511, 147.86113069778366, 120.33166812929751, 150.68624041619043, 185.67750355976276, 151.33551309542702, 129.17981426661925, 37.73245055328969, 161.9193063997869, 34.56552128138378, 156.04344101032694, 86.67171302271394, 75.6803513291104, 29.34896749563079, 107.54330820049623, 144.3402217861988, 93.66967792947557, 375.2241130814009, 68.12841317325505, 139.33990307476665, 57.25773848276404, 0.7928504905228818, 57.60439493202028, 31.162420687748273, 158.9530009471509, 196.46805450799764, 159.01207652235954, 70.01441266470054, 129.605548886558, 225.88798622230604, 104.8603764500469, 131.69907574778577, 157.12708445596553, 131.25057131600613, 134.73088180001866, 304.19390200777326, 164.74901772224615, 71.55506021549974, 79.11039014981927, 362.3598842886127, 156.22399510234078, 328.06086851473833, 8.108131642470523, 73.37271949056978, 147.02381679046573, 213.37415756998695, 51.375463833026615, 82.94300938974592, 99.67230591029382, 133.88440877578424, 258.2586831509205, 335.9799365275027, 241.60459073422325, 167.9871174596313, 113.11279666204904, 86.59303691168643, 153.3922796884168, 58.55022891108821, 164.11543080461811, 344.17880500420705, 51.45375833784899, 114.48481113615259, 64.35457944884236, 110.61139627826844, 34.14350723158887, 183.48235497017367, 186.86876628605162, 71.53711738532219, 32.677622065240904, 101.4193644905056, 25.943223761423123, 36.60781578211923, 177.76055507670998, 251.50597643534908, 22.01883997878175, 63.72361643201379, 143.40369206992455, 255.696062332606, 36.695633829659535, 257.01406008150923, 273.1636977624989, 175.04078907037473, 31.919360701113803, 108.91923864286565, 172.75913888754454, 111.83272008912826, 206.59417985682558, 166.34547923660676, 76.88487352163142, 155.8579151740106, 92.12142387843551, 156.37887307464393, 159.74937815791154, 254.2054129610815, 231.67117865669306, 43.689290460100366, 145.7664366422585, 201.47652517532526, 166.88870128108428, 110.1754779776181, 179.09671065150573, 318.80313825833406, 63.13921726222902, 272.7618049913267, 89.50174664470559, 180.56757293381477, 141.0699036930069, 134.7265116662505, 60.83798936224365, 315.33528395739336, 147.24357523667712, 270.42280903810416, 100.29798396649699, 189.83501356521813, 98.76662053643813, 124.8512786211282, 89.54023134445923, 16.527077340526183, 124.18150837914091, 41.18351811741119, 48.20975007749616, 344.66433756571604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.233557816255257, "mean_inference_ms": 6.476698886667797, "mean_action_processing_ms": 5.687529895890794, "mean_env_wait_ms": 12.55926148821344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07742953300476074, "StateBufferConnector_ms": 0.055457472801208496, "ViewRequirementAgentConnector_ms": 1.1987413167953491}, "num_episodes": 17, "episode_return_max": 247.578767485011, "episode_return_min": -11.094586726350926, "episode_return_mean": 100.65969089832069, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 892480, "num_agent_steps_trained": 892480, "num_env_steps_sampled": 223120, "num_env_steps_trained": 223120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.04241619748716, "num_env_steps_trained_throughput_per_sec": 69.04241619748716, "timesteps_total": 223120, "num_env_steps_sampled_lifetime": 223120, "num_agent_steps_sampled_lifetime": 892480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 892480, "timers": {"training_iteration_time_ms": 89481.56, "restore_workers_time_ms": 2.984, "training_step_time_ms": 89470.135, "sample_time_ms": 15731.043, "learn_time_ms": 73607.654, "learn_throughput": 58.581, "synch_weights_time_ms": 113.684}, "counters": {"num_env_steps_sampled": 223120, "num_env_steps_trained": 223120, "num_agent_steps_sampled": 892480, "num_agent_steps_trained": 892480}, "done": false, "training_iteration": 55, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-11-56", "timestamp": 1724150516, "time_this_iter_s": 58.05635190010071, "time_total_s": 3078.183058977127, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1200825e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3078.183058977127, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 52.8109756097561, "ram_util_percent": 83.34634146341465}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.939446903915002, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.678100049306476, "policy_loss": -0.015143632307579672, "vf_loss": 7.691150446291323, "vf_explained_var": 0.07815388904677498, "kl": 0.01046622523892592, "entropy": 0.7040704308994232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.06280462319258, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.663196813997137, "policy_loss": -0.01373848405188669, "vf_loss": 6.67505313000351, "vf_explained_var": 0.12830879915328253, "kl": 0.009410856825437535, "entropy": 0.7082194907324655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 227120, "num_env_steps_trained": 227120, "num_agent_steps_sampled": 908480, "num_agent_steps_trained": 908480}, "env_runners": {"episode_reward_max": 247.578767485011, "episode_reward_min": -11.094586726350926, "episode_reward_mean": 95.90899900438775, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -375.5456129195655, "predator_policy": 0.7928504905228818}, "policy_reward_max": {"prey_policy": 185.97728007271178, "predator_policy": 379.34561291956527}, "policy_reward_mean": {"prey_policy": -90.91565492587212, "predator_policy": 138.87015442806594}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.21488388984654, 74.90595960434318, 35.763275861735806, 213.21429870377005, 125.84318319660969, 209.80027819325312, 144.1556093137161, 99.41003098231357, 56.25507569675191, 56.88486388348265, 102.15427587510227, 110.0728200668421, 146.1036376450434, 83.87747561222402, 60.4992523826839, 105.84143862877359, 16.62155659148304, 72.25120468850224, 71.10065183493795, 72.31428998214385, 65.19806516144645, 133.48767450923768, 182.77564502364996, 100.64334600910871, 127.1426821473527, 36.16854847737069, 106.97082923634827, 92.56588096558599, 247.578767485011, 163.5205471669292, 37.70000000000018, 62.42983504018999, 89.93279141495117, 36.80000000000025, 143.99999999999943, 22.360739888817342, 193.00991677588868, 35.645568675085045, 33.15941896971588, 86.84201340327546, 88.24309411257897, 74.34384888800878, -11.094586726350926, 76.93470348974225, 28.363903118831587, 71.6962223659815, 122.9685141038876, 48.933066785059374, 138.8191730623174, 186.76441152072354, 64.6000000000002, 115.45090076646565, 38.73801563921989, 30.60196923509085, 93.76334342214759, 162.49950198839727, 96.60593544786948, 127.7385186780784, 48.3677545201458, 85.38047508092284, 199.59999999999928, 143.2064648151114, 135.5782596345528, 137.77451057140402, 106.76863911431559, 195.56664213909028, 165.07042589846293, 164.98163672108626, 34.51234749325603, 120.94975864097434, 56.13377567343875, 95.38357174273517, 72.58493626693004, 83.61232866855636, 61.42920239253603, 131.80169101380142, 66.00000000000001, 88.1142976989129, 51.60254738836585, 160.94107358669328, 41.156964145066624, 211.07938142561716, 140.57236588515903, 208.09805157079512, 67.46048730122845, 32.591745538805554, 89.45037365953401, 46.68336317844219, 98.86141037904241, 55.50000000000039, 198.49760791628734, 24.30000000000009, 41.24627993206999, 36.62992059636219, 36.79512472828809, 64.24123774839329, 108.55766547672931, 111.36280454506934, 75.1999999999999, 48.067908469018114], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.705076375390165, -138.6280596031105, -86.96440096495246, -93.27591339666986, -258.3265858904641, -33.458030615246095, -242.23048465820543, 173.78296229694658, -57.33258955706905, 4.740130654850783, 113.53929616252431, -169.53525912517028, -241.37677642170476, 94.01863401628688, -135.6138568371008, -245.2812688965758, 21.163739392580137, 12.826266400188288, -287.74349892165566, -36.7330615986355, -95.27052694006571, 56.34786106146613, -100.61257222087431, -223.99683640667521, -221.21668020981312, 55.71287650455124, -151.68554448692058, -69.67782727356096, -190.2985761928723, -9.014888033937039, -82.47779840041233, -77.08265323606834, -271.0454570313555, -225.79235639978614, -93.03210694443335, -42.37295678801604, -14.684602977671204, -155.52334885126, -233.76374744745473, 44.15392127585968, -30.019123723862513, -43.67120244106156, -7.76812792439028, 2.4131448036343146, -41.33199219057835, 6.066014203073394, -15.196915690111995, -90.71432483941759, -119.00646526069103, -24.86876113744405, -252.24840858808025, -48.59605958973865, -65.11324288918887, 5.171807305628093, -133.1991871739373, 29.28024045835307, 44.53891749806478, -39.67530404609471, 94.64516111242061, -36.15393277023253, -94.64330820049695, -119.54022178619965, -33.43984288928571, -373.0241130814009, -64.83397204945581, -52.70155278361455, -40.3577384827638, 19.10714950947712, 69.19560506797966, -13.962420687748073, -227.07214135422421, -105.98817421210785, -6.387474404258501, -29.62909800691255, -95.04193208461082, -224.8060343491688, -67.4836415003889, -135.91639172772958, 17.02495678583624, -218.5605991545324, -120.48965667247909, -230.192033022734, -138.54740306758822, -23.412825982148988, -120.1609430224899, -332.4039181422927, -79.68929161259867, -327.66086851473835, 4.643337274408115, -57.76028528861733, -230.48749793018212, -58.2142540642894, -26.31570046283016, 14.965741343945403, 17.114363071632184, -201.73801097265152, -276.0866163365276, -179.33283027957725, 75.04423917623174, -297.8715358493626, -101.71279666204957, -33.39303691168629, -111.82309476522187, 15.331486932183026, -184.56491241857807, -284.9913077510258, -34.024670637965485, -101.31192960094607, -18.323399657038806, -62.87923264792377, 86.35599475680853, -141.4823549701738, -117.0687662860517, -44.73118193745254, 68.97852961562008, -75.3369974932884, -1.3873539587999342, -12.795931064596857, -116.2550908059227, -227.63096562521358, 140.96953198931925, -27.111988400114978, -277.2442783626125, 21.350988775195322, 85.69902069259467, -243.83045496921065, -109.68655137683004, -200.74342488463938, 22.822874495194313, -56.89283472485769, -73.81965690313591, -15.205559934446399, -174.69417985682583, -33.17505333814355, -83.80632864884294, 16.045176674287717, -77.70556473862531, -136.282384721199, -4.902301951219044, -288.10273052679906, -201.60286541617077, -17.623828027183947, -103.34345905559013, -148.5159310192589, -168.18174273329703, -36.29750025847541, -365.91599460135166, -48.3715256399325, -48.42843813346465, -226.0433817275555, -92.40651758229963, -45.861110982419675, -108.96990369300687, -100.82651166625101, -83.78495045423992, -204.2740251664841, -32.50884032832175, -333.5549965580934, -172.34609867274744, 43.15417472772533, -92.80731425245848, -89.65362076004241, 185.97728007271178, -80.96520733208021, 53.72944824399943, -78.52210885539161, 159.79296513935884, -344.56900121177574, -216.46488618356963, -43.459047979752526, -110.54005360034874, -235.11636243759105, -77.64757467362789, -27.92938609527154, -127.18939532596362, -208.0894011089943, -198.3376945835824, -108.64630023293947, 18.328956132939584, -65.341862514093, -23.256032466716274, 60.36543249629008, -67.93359745700224, -375.5456129195655, -71.95429241014378, 11.036363334503953, -103.22962686546747, -202.47198654492678, -189.64731653235438, -193.5468358076239, -117.1248678794598, 4.354505379470376, -68.45250956881026, -80.77462315877675, 7.900320987585234, -121.99926316946261, -152.75005072601655, -88.17737344002873, -275.603659115743, -65.23087859502415], "policy_predator_policy_reward": [25.508244458953815, 162.0397754093932, 117.5066732441641, 137.63960072180012, 232.77184087909308, 94.7760514883528, 260.0304846582055, 21.631336406823436, 84.99112667892192, 93.44451541990702, 136.53871207469095, 129.25752908120822, 225.75862254373232, 65.75512917540146, 254.81878062917752, 225.4863760868122, 4.497527011379756, 17.76754289260328, 197.48229350630524, 183.8791308974685, 121.07800199326952, 19.998939760432922, 183.8155633155736, 250.86666537881797, 151.39175033306137, 160.21569101724373, 175.9405537650738, 129.30029360763194, 201.87382686973845, 57.93888973975423, 117.5312728925047, 147.87061737274914, 284.4097823943528, 229.04958762827127, 121.08407028070629, 86.57219814024438, 97.27906136583589, 144.0295422980331, 222.0128793859604, 39.91123676777841, 79.33332499681893, 59.55506632955139, 92.75580243362873, 46.086855196365725, 142.56588664420968, 75.47573636694608, 58.69345584085511, 147.86113069778366, 120.33166812929751, 150.68624041619043, 185.67750355976276, 151.33551309542702, 129.17981426661925, 37.73245055328969, 161.9193063997869, 34.56552128138378, 156.04344101032694, 86.67171302271394, 75.6803513291104, 29.34896749563079, 107.54330820049623, 144.3402217861988, 93.66967792947557, 375.2241130814009, 68.12841317325505, 139.33990307476665, 57.25773848276404, 0.7928504905228818, 57.60439493202028, 31.162420687748273, 158.9530009471509, 196.46805450799764, 159.01207652235954, 70.01441266470054, 129.605548886558, 225.88798622230604, 104.8603764500469, 131.69907574778577, 157.12708445596553, 131.25057131600613, 134.73088180001866, 304.19390200777326, 164.74901772224615, 71.55506021549974, 79.11039014981927, 362.3598842886127, 156.22399510234078, 328.06086851473833, 8.108131642470523, 73.37271949056978, 147.02381679046573, 213.37415756998695, 51.375463833026615, 82.94300938974592, 99.67230591029382, 133.88440877578424, 258.2586831509205, 335.9799365275027, 241.60459073422325, 167.9871174596313, 113.11279666204904, 86.59303691168643, 153.3922796884168, 58.55022891108821, 164.11543080461811, 344.17880500420705, 51.45375833784899, 114.48481113615259, 64.35457944884236, 110.61139627826844, 34.14350723158887, 183.48235497017367, 186.86876628605162, 71.53711738532219, 32.677622065240904, 101.4193644905056, 25.943223761423123, 36.60781578211923, 177.76055507670998, 251.50597643534908, 22.01883997878175, 63.72361643201379, 143.40369206992455, 255.696062332606, 36.695633829659535, 257.01406008150923, 273.1636977624989, 175.04078907037473, 31.919360701113803, 108.91923864286565, 172.75913888754454, 111.83272008912826, 206.59417985682558, 166.34547923660676, 76.88487352163142, 155.8579151740106, 92.12142387843551, 156.37887307464393, 159.74937815791154, 254.2054129610815, 231.67117865669306, 43.689290460100366, 145.7664366422585, 201.47652517532526, 166.88870128108428, 110.1754779776181, 179.09671065150573, 318.80313825833406, 63.13921726222902, 272.7618049913267, 89.50174664470559, 180.56757293381477, 141.0699036930069, 134.7265116662505, 60.83798936224365, 315.33528395739336, 147.24357523667712, 270.42280903810416, 100.29798396649699, 189.83501356521813, 98.76662053643813, 124.8512786211282, 89.54023134445923, 16.527077340526183, 124.18150837914091, 41.18351811741119, 48.20975007749616, 344.66433756571604, 221.9979601603934, 105.3864613041571, 231.36127600044108, 146.8868855763036, 103.88227673367213, 91.14505769476077, 82.23093184608689, 299.7312277673132, 196.86935863703218, 208.97604655853232, 55.652553594067996, 46.86035278708554, 129.68319682039936, 31.70501106631479, 88.43359745700151, 379.34561291956527, 91.25429241014302, 10.909916597565672, 158.79805267092894, 183.53348133582602, 192.46129126612988, 227.527985802136, 50.44455491595753, 126.56704533242464, 199.59602501696963, 58.18877318734743, 24.03384424468278, 201.42790248226385, 204.98558455120533, 111.14183961483961, 198.40607053852275, 190.49637564126172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.3219106670052, "mean_inference_ms": 6.493818797692456, "mean_action_processing_ms": 5.69082504705083, "mean_env_wait_ms": 12.635171078914587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08202540874481201, "StateBufferConnector_ms": 0.050910353660583496, "ViewRequirementAgentConnector_ms": 1.1339898109436035}, "num_episodes": 16, "episode_return_max": 247.578767485011, "episode_return_min": -11.094586726350926, "episode_return_mean": 95.90899900438775, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 908480, "num_agent_steps_trained": 908480, "num_env_steps_sampled": 227120, "num_env_steps_trained": 227120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.00545635535956, "num_env_steps_trained_throughput_per_sec": 67.00545635535956, "timesteps_total": 227120, "num_env_steps_sampled_lifetime": 227120, "num_agent_steps_sampled_lifetime": 908480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 908480, "timers": {"training_iteration_time_ms": 90671.647, "restore_workers_time_ms": 2.984, "training_step_time_ms": 90660.215, "sample_time_ms": 15978.368, "learn_time_ms": 74549.766, "learn_throughput": 57.841, "synch_weights_time_ms": 114.11}, "counters": {"num_env_steps_sampled": 227120, "num_env_steps_trained": 227120, "num_agent_steps_sampled": 908480, "num_agent_steps_trained": 908480}, "done": false, "training_iteration": 56, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-12-56", "timestamp": 1724150576, "time_this_iter_s": 59.794055223464966, "time_total_s": 3137.977114200592, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1200a1e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3137.977114200592, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 57.7129411764706, "ram_util_percent": 83.49411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.81915361521736, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.297954590358431, "policy_loss": -0.016298961896996294, "vf_loss": 7.312064346434578, "vf_explained_var": 0.0936811244992352, "kl": 0.010945938204824136, "entropy": 0.7128854339084928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.714431026309886, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.385989542108364, "policy_loss": -0.0163243312851856, "vf_loss": 6.400037777360785, "vf_explained_var": 0.06558260621217193, "kl": 0.01138054699163943, "entropy": 0.7139318426134725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 231120, "num_env_steps_trained": 231120, "num_agent_steps_sampled": 924480, "num_agent_steps_trained": 924480}, "env_runners": {"episode_reward_max": 247.578767485011, "episode_reward_min": -11.094586726350926, "episode_reward_mean": 99.12593066795814, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -514.3127875459982, "predator_policy": 0.7928504905228818}, "policy_reward_max": {"prey_policy": 185.97728007271178, "predator_policy": 472.8032346258198}, "policy_reward_mean": {"prey_policy": -94.112912547098, "predator_policy": 143.67587788107704}, "custom_metrics": {}, "hist_stats": {"episode_reward": [127.1426821473527, 36.16854847737069, 106.97082923634827, 92.56588096558599, 247.578767485011, 163.5205471669292, 37.70000000000018, 62.42983504018999, 89.93279141495117, 36.80000000000025, 143.99999999999943, 22.360739888817342, 193.00991677588868, 35.645568675085045, 33.15941896971588, 86.84201340327546, 88.24309411257897, 74.34384888800878, -11.094586726350926, 76.93470348974225, 28.363903118831587, 71.6962223659815, 122.9685141038876, 48.933066785059374, 138.8191730623174, 186.76441152072354, 64.6000000000002, 115.45090076646565, 38.73801563921989, 30.60196923509085, 93.76334342214759, 162.49950198839727, 96.60593544786948, 127.7385186780784, 48.3677545201458, 85.38047508092284, 199.59999999999928, 143.2064648151114, 135.5782596345528, 137.77451057140402, 106.76863911431559, 195.56664213909028, 165.07042589846293, 164.98163672108626, 34.51234749325603, 120.94975864097434, 56.13377567343875, 95.38357174273517, 72.58493626693004, 83.61232866855636, 61.42920239253603, 131.80169101380142, 66.00000000000001, 88.1142976989129, 51.60254738836585, 160.94107358669328, 41.156964145066624, 211.07938142561716, 140.57236588515903, 208.09805157079512, 67.46048730122845, 32.591745538805554, 89.45037365953401, 46.68336317844219, 98.86141037904241, 55.50000000000039, 198.49760791628734, 24.30000000000009, 41.24627993206999, 36.62992059636219, 36.79512472828809, 64.24123774839329, 108.55766547672931, 111.36280454506934, 75.1999999999999, 48.067908469018114, 36.50000000000025, 189.66079038343725, 95.91006582305201, 21.35875422893687, 33.822708866195825, 75.33441036197073, 189.46934755928154, 150.79522467964142, 164.97732416379748, 139.28231897522738, 237.8880810088217, 197.64502248102784, 96.72299900571865, 37.58991354451216, 102.7871131489238, 120.30576240637662, 57.253019371534606, 99.89999999999945, 78.41288989002379, 34.00656596317117, 160.68711904296308, 155.65650181806598, 96.33459387222412, 126.7814330991386], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-119.00646526069103, -24.86876113744405, -252.24840858808025, -48.59605958973865, -65.11324288918887, 5.171807305628093, -133.1991871739373, 29.28024045835307, 44.53891749806478, -39.67530404609471, 94.64516111242061, -36.15393277023253, -94.64330820049695, -119.54022178619965, -33.43984288928571, -373.0241130814009, -64.83397204945581, -52.70155278361455, -40.3577384827638, 19.10714950947712, 69.19560506797966, -13.962420687748073, -227.07214135422421, -105.98817421210785, -6.387474404258501, -29.62909800691255, -95.04193208461082, -224.8060343491688, -67.4836415003889, -135.91639172772958, 17.02495678583624, -218.5605991545324, -120.48965667247909, -230.192033022734, -138.54740306758822, -23.412825982148988, -120.1609430224899, -332.4039181422927, -79.68929161259867, -327.66086851473835, 4.643337274408115, -57.76028528861733, -230.48749793018212, -58.2142540642894, -26.31570046283016, 14.965741343945403, 17.114363071632184, -201.73801097265152, -276.0866163365276, -179.33283027957725, 75.04423917623174, -297.8715358493626, -101.71279666204957, -33.39303691168629, -111.82309476522187, 15.331486932183026, -184.56491241857807, -284.9913077510258, -34.024670637965485, -101.31192960094607, -18.323399657038806, -62.87923264792377, 86.35599475680853, -141.4823549701738, -117.0687662860517, -44.73118193745254, 68.97852961562008, -75.3369974932884, -1.3873539587999342, -12.795931064596857, -116.2550908059227, -227.63096562521358, 140.96953198931925, -27.111988400114978, -277.2442783626125, 21.350988775195322, 85.69902069259467, -243.83045496921065, -109.68655137683004, -200.74342488463938, 22.822874495194313, -56.89283472485769, -73.81965690313591, -15.205559934446399, -174.69417985682583, -33.17505333814355, -83.80632864884294, 16.045176674287717, -77.70556473862531, -136.282384721199, -4.902301951219044, -288.10273052679906, -201.60286541617077, -17.623828027183947, -103.34345905559013, -148.5159310192589, -168.18174273329703, -36.29750025847541, -365.91599460135166, -48.3715256399325, -48.42843813346465, -226.0433817275555, -92.40651758229963, -45.861110982419675, -108.96990369300687, -100.82651166625101, -83.78495045423992, -204.2740251664841, -32.50884032832175, -333.5549965580934, -172.34609867274744, 43.15417472772533, -92.80731425245848, -89.65362076004241, 185.97728007271178, -80.96520733208021, 53.72944824399943, -78.52210885539161, 159.79296513935884, -344.56900121177574, -216.46488618356963, -43.459047979752526, -110.54005360034874, -235.11636243759105, -77.64757467362789, -27.92938609527154, -127.18939532596362, -208.0894011089943, -198.3376945835824, -108.64630023293947, 18.328956132939584, -65.341862514093, -23.256032466716274, 60.36543249629008, -67.93359745700224, -375.5456129195655, -71.95429241014378, 11.036363334503953, -103.22962686546747, -202.47198654492678, -189.64731653235438, -193.5468358076239, -117.1248678794598, 4.354505379470376, -68.45250956881026, -80.77462315877675, 7.900320987585234, -121.99926316946261, -152.75005072601655, -88.17737344002873, -275.603659115743, -65.23087859502415, -15.36903208492708, 8.284917517459904, 47.02534378064107, -71.24452675621119, -277.7108785486498, -26.048932685195425, -91.1463472578097, -166.25021467843652, -64.7176030091654, -180.39611297311555, -81.48380229797084, -77.654597757424, -371.341242487991, 126.93056705743396, -128.81788563697341, 28.884512046856187, -42.94438037180098, 82.79662462346485, 57.206676431593344, -193.11317667602964, -42.982487469292806, -322.27362270292195, -114.68566316705177, -6.053308738632495, -145.17616514351715, -28.06877063268746, -98.72388275165954, -154.14107905354453, -154.78163237764545, -90.77846396713963, 3.050794010159923, -222.19117393669472, -215.55157434678742, -135.1730531460798, 1.4971160307634774, -13.81207551676028, -145.8677941284364, -21.58281406206052, -246.1909343317213, 20.000000000000014, 59.360064184722916, -160.7198528660955, -514.3127875459982, -19.661722651970464, -35.70497384973455, -92.37028106491785, -207.09691629881158, -37.03855969699719], "policy_predator_policy_reward": [120.33166812929751, 150.68624041619043, 185.67750355976276, 151.33551309542702, 129.17981426661925, 37.73245055328969, 161.9193063997869, 34.56552128138378, 156.04344101032694, 86.67171302271394, 75.6803513291104, 29.34896749563079, 107.54330820049623, 144.3402217861988, 93.66967792947557, 375.2241130814009, 68.12841317325505, 139.33990307476665, 57.25773848276404, 0.7928504905228818, 57.60439493202028, 31.162420687748273, 158.9530009471509, 196.46805450799764, 159.01207652235954, 70.01441266470054, 129.605548886558, 225.88798622230604, 104.8603764500469, 131.69907574778577, 157.12708445596553, 131.25057131600613, 134.73088180001866, 304.19390200777326, 164.74901772224615, 71.55506021549974, 79.11039014981927, 362.3598842886127, 156.22399510234078, 328.06086851473833, 8.108131642470523, 73.37271949056978, 147.02381679046573, 213.37415756998695, 51.375463833026615, 82.94300938974592, 99.67230591029382, 133.88440877578424, 258.2586831509205, 335.9799365275027, 241.60459073422325, 167.9871174596313, 113.11279666204904, 86.59303691168643, 153.3922796884168, 58.55022891108821, 164.11543080461811, 344.17880500420705, 51.45375833784899, 114.48481113615259, 64.35457944884236, 110.61139627826844, 34.14350723158887, 183.48235497017367, 186.86876628605162, 71.53711738532219, 32.677622065240904, 101.4193644905056, 25.943223761423123, 36.60781578211923, 177.76055507670998, 251.50597643534908, 22.01883997878175, 63.72361643201379, 143.40369206992455, 255.696062332606, 36.695633829659535, 257.01406008150923, 273.1636977624989, 175.04078907037473, 31.919360701113803, 108.91923864286565, 172.75913888754454, 111.83272008912826, 206.59417985682558, 166.34547923660676, 76.88487352163142, 155.8579151740106, 92.12142387843551, 156.37887307464393, 159.74937815791154, 254.2054129610815, 231.67117865669306, 43.689290460100366, 145.7664366422585, 201.47652517532526, 166.88870128108428, 110.1754779776181, 179.09671065150573, 318.80313825833406, 63.13921726222902, 272.7618049913267, 89.50174664470559, 180.56757293381477, 141.0699036930069, 134.7265116662505, 60.83798936224365, 315.33528395739336, 147.24357523667712, 270.42280903810416, 100.29798396649699, 189.83501356521813, 98.76662053643813, 124.8512786211282, 89.54023134445923, 16.527077340526183, 124.18150837914091, 41.18351811741119, 48.20975007749616, 344.66433756571604, 221.9979601603934, 105.3864613041571, 231.36127600044108, 146.8868855763036, 103.88227673367213, 91.14505769476077, 82.23093184608689, 299.7312277673132, 196.86935863703218, 208.97604655853232, 55.652553594067996, 46.86035278708554, 129.68319682039936, 31.70501106631479, 88.43359745700151, 379.34561291956527, 91.25429241014302, 10.909916597565672, 158.79805267092894, 183.53348133582602, 192.46129126612988, 227.527985802136, 50.44455491595753, 126.56704533242464, 199.59602501696963, 58.18877318734743, 24.03384424468278, 201.42790248226385, 204.98558455120533, 111.14183961483961, 198.40607053852275, 190.49637564126172, 32.76903208492731, 10.815082482540062, 127.46635125173039, 86.4136221072768, 169.42958044108346, 230.2402966158141, 196.07776408668377, 82.67755207849821, 200.40707811164518, 78.52934673683033, 110.28127109586634, 124.19153932149928, 80.18385359083322, 353.6961693990052, 105.85941846215835, 144.8691798076007, 46.574575107606, 78.5505048045285, 48.891903008387104, 226.29691621127662, 319.4196311469632, 283.7245600340738, 214.5329137812296, 103.85108060548244, 94.17709977809297, 175.7908350038298, 116.91251533096764, 173.54236001874827, 177.91824543601632, 170.42896405769244, 159.48161878439498, 179.96452354851635, 143.32045569538352, 264.65719116901784, 48.17280953775625, 64.04214994824075, 146.37286744225386, 99.49063063826677, 256.3909343317209, 3.80656596317096, 124.37119546271443, 137.67571226162121, 216.8277773902145, 472.8032346258198, 144.2828029653022, 80.12704582157438, 164.6706015605956, 206.24630753435176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.304422765825132, "mean_inference_ms": 6.51450104600379, "mean_action_processing_ms": 5.284449360382635, "mean_env_wait_ms": 12.737301323363056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05206298828125, "StateBufferConnector_ms": 0.013560295104980469, "ViewRequirementAgentConnector_ms": 0.4808255434036255}, "num_episodes": 24, "episode_return_max": 247.578767485011, "episode_return_min": -11.094586726350926, "episode_return_mean": 99.12593066795814, "episodes_this_iter": 24}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924480, "num_agent_steps_trained": 924480, "num_env_steps_sampled": 231120, "num_env_steps_trained": 231120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.22670407613415, "num_env_steps_trained_throughput_per_sec": 67.22670407613415, "timesteps_total": 231120, "num_env_steps_sampled_lifetime": 231120, "num_agent_steps_sampled_lifetime": 924480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 924480, "timers": {"training_iteration_time_ms": 91360.347, "restore_workers_time_ms": 2.984, "training_step_time_ms": 91348.914, "sample_time_ms": 16394.215, "learn_time_ms": 74822.73, "learn_throughput": 57.63, "synch_weights_time_ms": 114.391}, "counters": {"num_env_steps_sampled": 231120, "num_env_steps_trained": 231120, "num_agent_steps_sampled": 924480, "num_agent_steps_trained": 924480}, "done": false, "training_iteration": 57, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-13-55", "timestamp": 1724150635, "time_this_iter_s": 59.5634708404541, "time_total_s": 3197.540585041046, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12002d790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3197.540585041046, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 56.76309523809523, "ram_util_percent": 83.47261904761903}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.246402394897725, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.596933262688773, "policy_loss": -0.019968426267976166, "vf_loss": 6.614402796730163, "vf_explained_var": 0.1230608377507124, "kl": 0.012494391988884046, "entropy": 0.7285581438629716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110145.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.105703072762363, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.2683020850338, "policy_loss": -0.01974624131372563, "vf_loss": 5.28544807194402, "vf_explained_var": 0.10334056637905262, "kl": 0.013001287501384184, "entropy": 0.7859467806324126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110145.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}}, "num_env_steps_sampled": 235120, "num_env_steps_trained": 235120, "num_agent_steps_sampled": 940480, "num_agent_steps_trained": 940480}, "env_runners": {"episode_reward_max": 237.8880810088217, "episode_reward_min": 14.88059500321684, "episode_reward_mean": 101.19490901803911, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -514.3127875459982, "predator_policy": 3.80656596317096}, "policy_reward_max": {"prey_policy": 185.97728007271178, "predator_policy": 472.8032346258198}, "policy_reward_mean": {"prey_policy": -96.28356778183708, "predator_policy": 146.8810222908566}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.6962223659815, 122.9685141038876, 48.933066785059374, 138.8191730623174, 186.76441152072354, 64.6000000000002, 115.45090076646565, 38.73801563921989, 30.60196923509085, 93.76334342214759, 162.49950198839727, 96.60593544786948, 127.7385186780784, 48.3677545201458, 85.38047508092284, 199.59999999999928, 143.2064648151114, 135.5782596345528, 137.77451057140402, 106.76863911431559, 195.56664213909028, 165.07042589846293, 164.98163672108626, 34.51234749325603, 120.94975864097434, 56.13377567343875, 95.38357174273517, 72.58493626693004, 83.61232866855636, 61.42920239253603, 131.80169101380142, 66.00000000000001, 88.1142976989129, 51.60254738836585, 160.94107358669328, 41.156964145066624, 211.07938142561716, 140.57236588515903, 208.09805157079512, 67.46048730122845, 32.591745538805554, 89.45037365953401, 46.68336317844219, 98.86141037904241, 55.50000000000039, 198.49760791628734, 24.30000000000009, 41.24627993206999, 36.62992059636219, 36.79512472828809, 64.24123774839329, 108.55766547672931, 111.36280454506934, 75.1999999999999, 48.067908469018114, 36.50000000000025, 189.66079038343725, 95.91006582305201, 21.35875422893687, 33.822708866195825, 75.33441036197073, 189.46934755928154, 150.79522467964142, 164.97732416379748, 139.28231897522738, 237.8880810088217, 197.64502248102784, 96.72299900571865, 37.58991354451216, 102.7871131489238, 120.30576240637662, 57.253019371534606, 99.89999999999945, 78.41288989002379, 34.00656596317117, 160.68711904296308, 155.65650181806598, 96.33459387222412, 126.7814330991386, 118.23781035600285, 14.88059500321684, 32.800000000000196, 136.04365937111186, 67.72046874777578, 60.43050535164927, 196.22994277005824, 103.7382855514266, 93.90198261162085, 121.66858919709422, 61.8712567501542, 144.57250200346914, 71.24208618071198, 35.96725139989462, 110.7804508186399, 50.71965139563366, 90.64382410381958, 208.69669786725962, 65.14898869652373, 66.86047718984024, 127.36131217152534], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-230.48749793018212, -58.2142540642894, -26.31570046283016, 14.965741343945403, 17.114363071632184, -201.73801097265152, -276.0866163365276, -179.33283027957725, 75.04423917623174, -297.8715358493626, -101.71279666204957, -33.39303691168629, -111.82309476522187, 15.331486932183026, -184.56491241857807, -284.9913077510258, -34.024670637965485, -101.31192960094607, -18.323399657038806, -62.87923264792377, 86.35599475680853, -141.4823549701738, -117.0687662860517, -44.73118193745254, 68.97852961562008, -75.3369974932884, -1.3873539587999342, -12.795931064596857, -116.2550908059227, -227.63096562521358, 140.96953198931925, -27.111988400114978, -277.2442783626125, 21.350988775195322, 85.69902069259467, -243.83045496921065, -109.68655137683004, -200.74342488463938, 22.822874495194313, -56.89283472485769, -73.81965690313591, -15.205559934446399, -174.69417985682583, -33.17505333814355, -83.80632864884294, 16.045176674287717, -77.70556473862531, -136.282384721199, -4.902301951219044, -288.10273052679906, -201.60286541617077, -17.623828027183947, -103.34345905559013, -148.5159310192589, -168.18174273329703, -36.29750025847541, -365.91599460135166, -48.3715256399325, -48.42843813346465, -226.0433817275555, -92.40651758229963, -45.861110982419675, -108.96990369300687, -100.82651166625101, -83.78495045423992, -204.2740251664841, -32.50884032832175, -333.5549965580934, -172.34609867274744, 43.15417472772533, -92.80731425245848, -89.65362076004241, 185.97728007271178, -80.96520733208021, 53.72944824399943, -78.52210885539161, 159.79296513935884, -344.56900121177574, -216.46488618356963, -43.459047979752526, -110.54005360034874, -235.11636243759105, -77.64757467362789, -27.92938609527154, -127.18939532596362, -208.0894011089943, -198.3376945835824, -108.64630023293947, 18.328956132939584, -65.341862514093, -23.256032466716274, 60.36543249629008, -67.93359745700224, -375.5456129195655, -71.95429241014378, 11.036363334503953, -103.22962686546747, -202.47198654492678, -189.64731653235438, -193.5468358076239, -117.1248678794598, 4.354505379470376, -68.45250956881026, -80.77462315877675, 7.900320987585234, -121.99926316946261, -152.75005072601655, -88.17737344002873, -275.603659115743, -65.23087859502415, -15.36903208492708, 8.284917517459904, 47.02534378064107, -71.24452675621119, -277.7108785486498, -26.048932685195425, -91.1463472578097, -166.25021467843652, -64.7176030091654, -180.39611297311555, -81.48380229797084, -77.654597757424, -371.341242487991, 126.93056705743396, -128.81788563697341, 28.884512046856187, -42.94438037180098, 82.79662462346485, 57.206676431593344, -193.11317667602964, -42.982487469292806, -322.27362270292195, -114.68566316705177, -6.053308738632495, -145.17616514351715, -28.06877063268746, -98.72388275165954, -154.14107905354453, -154.78163237764545, -90.77846396713963, 3.050794010159923, -222.19117393669472, -215.55157434678742, -135.1730531460798, 1.4971160307634774, -13.81207551676028, -145.8677941284364, -21.58281406206052, -246.1909343317213, 20.000000000000014, 59.360064184722916, -160.7198528660955, -514.3127875459982, -19.661722651970464, -35.70497384973455, -92.37028106491785, -207.09691629881158, -37.03855969699719, -46.668812149247294, -204.74270249166614, -186.26762838422655, -231.43239796899218, 0.432117364225756, -61.906058654604315, -54.172941738943514, -23.39041109304394, -132.12329599281503, -256.68957917614716, 13.949729955440198, -16.75791323232285, -112.68164971151879, 26.228643644650077, -15.397285283403303, -108.5510140844007, -5.34953314915394, -93.73642121355502, -10.747133336961639, -158.1966279333154, -32.79901242193754, -47.49819783530795, 43.70591723196696, -76.98708924637667, -40.678806211326815, -61.29937583961649, -374.72012815566626, -225.80665891531376, -12.693260456135452, -142.5744493754143, -146.58296375347092, -195.2821245577917, -189.25618282053534, -103.63179950004806, 169.10010717851202, -299.73368592257424, 30.350474406994056, -154.7601072016674, -140.9574108429415, -236.2480725147838, -99.54301471523135, -186.99435937297707], "policy_predator_policy_reward": [147.02381679046573, 213.37415756998695, 51.375463833026615, 82.94300938974592, 99.67230591029382, 133.88440877578424, 258.2586831509205, 335.9799365275027, 241.60459073422325, 167.9871174596313, 113.11279666204904, 86.59303691168643, 153.3922796884168, 58.55022891108821, 164.11543080461811, 344.17880500420705, 51.45375833784899, 114.48481113615259, 64.35457944884236, 110.61139627826844, 34.14350723158887, 183.48235497017367, 186.86876628605162, 71.53711738532219, 32.677622065240904, 101.4193644905056, 25.943223761423123, 36.60781578211923, 177.76055507670998, 251.50597643534908, 22.01883997878175, 63.72361643201379, 143.40369206992455, 255.696062332606, 36.695633829659535, 257.01406008150923, 273.1636977624989, 175.04078907037473, 31.919360701113803, 108.91923864286565, 172.75913888754454, 111.83272008912826, 206.59417985682558, 166.34547923660676, 76.88487352163142, 155.8579151740106, 92.12142387843551, 156.37887307464393, 159.74937815791154, 254.2054129610815, 231.67117865669306, 43.689290460100366, 145.7664366422585, 201.47652517532526, 166.88870128108428, 110.1754779776181, 179.09671065150573, 318.80313825833406, 63.13921726222902, 272.7618049913267, 89.50174664470559, 180.56757293381477, 141.0699036930069, 134.7265116662505, 60.83798936224365, 315.33528395739336, 147.24357523667712, 270.42280903810416, 100.29798396649699, 189.83501356521813, 98.76662053643813, 124.8512786211282, 89.54023134445923, 16.527077340526183, 124.18150837914091, 41.18351811741119, 48.20975007749616, 344.66433756571604, 221.9979601603934, 105.3864613041571, 231.36127600044108, 146.8868855763036, 103.88227673367213, 91.14505769476077, 82.23093184608689, 299.7312277673132, 196.86935863703218, 208.97604655853232, 55.652553594067996, 46.86035278708554, 129.68319682039936, 31.70501106631479, 88.43359745700151, 379.34561291956527, 91.25429241014302, 10.909916597565672, 158.79805267092894, 183.53348133582602, 192.46129126612988, 227.527985802136, 50.44455491595753, 126.56704533242464, 199.59602501696963, 58.18877318734743, 24.03384424468278, 201.42790248226385, 204.98558455120533, 111.14183961483961, 198.40607053852275, 190.49637564126172, 32.76903208492731, 10.815082482540062, 127.46635125173039, 86.4136221072768, 169.42958044108346, 230.2402966158141, 196.07776408668377, 82.67755207849821, 200.40707811164518, 78.52934673683033, 110.28127109586634, 124.19153932149928, 80.18385359083322, 353.6961693990052, 105.85941846215835, 144.8691798076007, 46.574575107606, 78.5505048045285, 48.891903008387104, 226.29691621127662, 319.4196311469632, 283.7245600340738, 214.5329137812296, 103.85108060548244, 94.17709977809297, 175.7908350038298, 116.91251533096764, 173.54236001874827, 177.91824543601632, 170.42896405769244, 159.48161878439498, 179.96452354851635, 143.32045569538352, 264.65719116901784, 48.17280953775625, 64.04214994824075, 146.37286744225386, 99.49063063826677, 256.3909343317209, 3.80656596317096, 124.37119546271443, 137.67571226162121, 216.8277773902145, 472.8032346258198, 144.2828029653022, 80.12704582157438, 164.6706015605956, 206.24630753435176, 245.66620460626197, 123.98312039065412, 223.54077757486652, 209.03984378156863, 17.7678826357742, 76.50605865460363, 120.02785978283217, 93.57915242026759, 209.61438299630362, 246.91896092043444, 14.20003968569865, 49.03864894283314, 130.89664172812874, 151.7863071087985, 52.43132798117459, 175.25525693805625, 31.794169948663278, 161.19376702566635, 115.71550734523329, 174.89684312213797, 62.93631813044689, 79.23214887695265, 121.02911016781181, 56.82456385006709, 91.21119690767796, 82.00907132397596, 314.31492762843953, 322.17911084243474, 101.83215105390774, 164.2160095962821, 304.5626388170329, 88.02210088986254, 251.8306711443059, 131.7011352800967, 270.72934611510124, 68.600930496221, 121.42577989484462, 68.13284159635245, 232.36300605899177, 211.70295448857274, 217.81428042697675, 196.084405832757]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.257609944702514, "mean_inference_ms": 6.484978305966304, "mean_action_processing_ms": 5.195200472626973, "mean_env_wait_ms": 12.874173942311714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050629615783691406, "StateBufferConnector_ms": 0.022252321243286133, "ViewRequirementAgentConnector_ms": 0.48489344120025635}, "num_episodes": 21, "episode_return_max": 237.8880810088217, "episode_return_min": 14.88059500321684, "episode_return_mean": 101.19490901803911, "episodes_this_iter": 21}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 940480, "num_agent_steps_trained": 940480, "num_env_steps_sampled": 235120, "num_env_steps_trained": 235120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.8002058619615, "num_env_steps_trained_throughput_per_sec": 73.8002058619615, "timesteps_total": 235120, "num_env_steps_sampled_lifetime": 235120, "num_agent_steps_sampled_lifetime": 940480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 940480, "timers": {"training_iteration_time_ms": 91471.138, "restore_workers_time_ms": 2.984, "training_step_time_ms": 91459.729, "sample_time_ms": 16583.675, "learn_time_ms": 74743.993, "learn_throughput": 57.69, "synch_weights_time_ms": 114.666}, "counters": {"num_env_steps_sampled": 235120, "num_env_steps_trained": 235120, "num_agent_steps_sampled": 940480, "num_agent_steps_trained": 940480}, "done": false, "training_iteration": 58, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-14-50", "timestamp": 1724150690, "time_this_iter_s": 54.24888896942139, "time_total_s": 3251.7894740104675, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1200991f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3251.7894740104675, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 50.82857142857143, "ram_util_percent": 83.38311688311687}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.612828552281414, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.672288911557072, "policy_loss": -0.015855665670747244, "vf_loss": 6.685723314840327, "vf_explained_var": 0.13475627539649843, "kl": 0.012106272911224219, "entropy": 0.7234711958933129, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.211598913820963, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.090590510923396, "policy_loss": -0.011605582240890101, "vf_loss": 5.099878617569252, "vf_explained_var": 0.23224676919992637, "kl": 0.01158740228342592, "entropy": 0.8475266780802813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 239120, "num_env_steps_trained": 239120, "num_agent_steps_sampled": 956480, "num_agent_steps_trained": 956480}, "env_runners": {"episode_reward_max": 237.8880810088217, "episode_reward_min": 14.88059500321684, "episode_reward_mean": 97.8842736762387, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -514.3127875459982, "predator_policy": 3.80656596317096}, "policy_reward_max": {"prey_policy": 185.97728007271178, "predator_policy": 472.8032346258198}, "policy_reward_mean": {"prey_policy": -95.36040633988239, "predator_policy": 144.30254317800166}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.77451057140402, 106.76863911431559, 195.56664213909028, 165.07042589846293, 164.98163672108626, 34.51234749325603, 120.94975864097434, 56.13377567343875, 95.38357174273517, 72.58493626693004, 83.61232866855636, 61.42920239253603, 131.80169101380142, 66.00000000000001, 88.1142976989129, 51.60254738836585, 160.94107358669328, 41.156964145066624, 211.07938142561716, 140.57236588515903, 208.09805157079512, 67.46048730122845, 32.591745538805554, 89.45037365953401, 46.68336317844219, 98.86141037904241, 55.50000000000039, 198.49760791628734, 24.30000000000009, 41.24627993206999, 36.62992059636219, 36.79512472828809, 64.24123774839329, 108.55766547672931, 111.36280454506934, 75.1999999999999, 48.067908469018114, 36.50000000000025, 189.66079038343725, 95.91006582305201, 21.35875422893687, 33.822708866195825, 75.33441036197073, 189.46934755928154, 150.79522467964142, 164.97732416379748, 139.28231897522738, 237.8880810088217, 197.64502248102784, 96.72299900571865, 37.58991354451216, 102.7871131489238, 120.30576240637662, 57.253019371534606, 99.89999999999945, 78.41288989002379, 34.00656596317117, 160.68711904296308, 155.65650181806598, 96.33459387222412, 126.7814330991386, 118.23781035600285, 14.88059500321684, 32.800000000000196, 136.04365937111186, 67.72046874777578, 60.43050535164927, 196.22994277005824, 103.7382855514266, 93.90198261162085, 121.66858919709422, 61.8712567501542, 144.57250200346914, 71.24208618071198, 35.96725139989462, 110.7804508186399, 50.71965139563366, 90.64382410381958, 208.69669786725962, 65.14898869652373, 66.86047718984024, 127.36131217152534, 56.20328239545104, 61.30204842343287, 145.24571514149392, 120.48465554212267, 49.674056210907395, 77.7000000000001, 76.81274624915159, 42.19472741818894, 81.1322728031997, 141.0512965103853, 55.10000000000022, 34.71157827017639, 69.47848667489498, 108.62553236603607, 132.31795111552216, 106.67889946355075, 85.7104342635576, 135.82531003786028], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-109.68655137683004, -200.74342488463938, 22.822874495194313, -56.89283472485769, -73.81965690313591, -15.205559934446399, -174.69417985682583, -33.17505333814355, -83.80632864884294, 16.045176674287717, -77.70556473862531, -136.282384721199, -4.902301951219044, -288.10273052679906, -201.60286541617077, -17.623828027183947, -103.34345905559013, -148.5159310192589, -168.18174273329703, -36.29750025847541, -365.91599460135166, -48.3715256399325, -48.42843813346465, -226.0433817275555, -92.40651758229963, -45.861110982419675, -108.96990369300687, -100.82651166625101, -83.78495045423992, -204.2740251664841, -32.50884032832175, -333.5549965580934, -172.34609867274744, 43.15417472772533, -92.80731425245848, -89.65362076004241, 185.97728007271178, -80.96520733208021, 53.72944824399943, -78.52210885539161, 159.79296513935884, -344.56900121177574, -216.46488618356963, -43.459047979752526, -110.54005360034874, -235.11636243759105, -77.64757467362789, -27.92938609527154, -127.18939532596362, -208.0894011089943, -198.3376945835824, -108.64630023293947, 18.328956132939584, -65.341862514093, -23.256032466716274, 60.36543249629008, -67.93359745700224, -375.5456129195655, -71.95429241014378, 11.036363334503953, -103.22962686546747, -202.47198654492678, -189.64731653235438, -193.5468358076239, -117.1248678794598, 4.354505379470376, -68.45250956881026, -80.77462315877675, 7.900320987585234, -121.99926316946261, -152.75005072601655, -88.17737344002873, -275.603659115743, -65.23087859502415, -15.36903208492708, 8.284917517459904, 47.02534378064107, -71.24452675621119, -277.7108785486498, -26.048932685195425, -91.1463472578097, -166.25021467843652, -64.7176030091654, -180.39611297311555, -81.48380229797084, -77.654597757424, -371.341242487991, 126.93056705743396, -128.81788563697341, 28.884512046856187, -42.94438037180098, 82.79662462346485, 57.206676431593344, -193.11317667602964, -42.982487469292806, -322.27362270292195, -114.68566316705177, -6.053308738632495, -145.17616514351715, -28.06877063268746, -98.72388275165954, -154.14107905354453, -154.78163237764545, -90.77846396713963, 3.050794010159923, -222.19117393669472, -215.55157434678742, -135.1730531460798, 1.4971160307634774, -13.81207551676028, -145.8677941284364, -21.58281406206052, -246.1909343317213, 20.000000000000014, 59.360064184722916, -160.7198528660955, -514.3127875459982, -19.661722651970464, -35.70497384973455, -92.37028106491785, -207.09691629881158, -37.03855969699719, -46.668812149247294, -204.74270249166614, -186.26762838422655, -231.43239796899218, 0.432117364225756, -61.906058654604315, -54.172941738943514, -23.39041109304394, -132.12329599281503, -256.68957917614716, 13.949729955440198, -16.75791323232285, -112.68164971151879, 26.228643644650077, -15.397285283403303, -108.5510140844007, -5.34953314915394, -93.73642121355502, -10.747133336961639, -158.1966279333154, -32.79901242193754, -47.49819783530795, 43.70591723196696, -76.98708924637667, -40.678806211326815, -61.29937583961649, -374.72012815566626, -225.80665891531376, -12.693260456135452, -142.5744493754143, -146.58296375347092, -195.2821245577917, -189.25618282053534, -103.63179950004806, 169.10010717851202, -299.73368592257424, 30.350474406994056, -154.7601072016674, -140.9574108429415, -236.2480725147838, -99.54301471523135, -186.99435937297707, -2.3975405480411935, 29.10054279085271, -123.53863885313913, -69.27324862710218, -27.724809974773542, -17.97733446290351, -35.816922076918004, -80.33686031574048, -303.4690207866917, -138.18920994606464, 5.060044310248385, -84.55487090373838, -14.404401608783388, 7.714006251246353, -230.69938366322944, 1.5170947043857888, -103.38678486823297, -1.7719325691725047, -285.792324118305, 1.1212779728167102, -127.55556649324498, -0.07102283720485153, -209.94647087334343, -115.45906781228983, -72.1961578376427, -155.8696835710704, -180.1481835936925, -34.960475424061464, -52.280128416974165, 62.713004374414474, 0.6167013341076736, -87.79098271263412, -119.23500489640628, -105.96722247984033, 36.020346586815975, -140.55377413047032], "policy_predator_policy_reward": [273.1636977624989, 175.04078907037473, 31.919360701113803, 108.91923864286565, 172.75913888754454, 111.83272008912826, 206.59417985682558, 166.34547923660676, 76.88487352163142, 155.8579151740106, 92.12142387843551, 156.37887307464393, 159.74937815791154, 254.2054129610815, 231.67117865669306, 43.689290460100366, 145.7664366422585, 201.47652517532526, 166.88870128108428, 110.1754779776181, 179.09671065150573, 318.80313825833406, 63.13921726222902, 272.7618049913267, 89.50174664470559, 180.56757293381477, 141.0699036930069, 134.7265116662505, 60.83798936224365, 315.33528395739336, 147.24357523667712, 270.42280903810416, 100.29798396649699, 189.83501356521813, 98.76662053643813, 124.8512786211282, 89.54023134445923, 16.527077340526183, 124.18150837914091, 41.18351811741119, 48.20975007749616, 344.66433756571604, 221.9979601603934, 105.3864613041571, 231.36127600044108, 146.8868855763036, 103.88227673367213, 91.14505769476077, 82.23093184608689, 299.7312277673132, 196.86935863703218, 208.97604655853232, 55.652553594067996, 46.86035278708554, 129.68319682039936, 31.70501106631479, 88.43359745700151, 379.34561291956527, 91.25429241014302, 10.909916597565672, 158.79805267092894, 183.53348133582602, 192.46129126612988, 227.527985802136, 50.44455491595753, 126.56704533242464, 199.59602501696963, 58.18877318734743, 24.03384424468278, 201.42790248226385, 204.98558455120533, 111.14183961483961, 198.40607053852275, 190.49637564126172, 32.76903208492731, 10.815082482540062, 127.46635125173039, 86.4136221072768, 169.42958044108346, 230.2402966158141, 196.07776408668377, 82.67755207849821, 200.40707811164518, 78.52934673683033, 110.28127109586634, 124.19153932149928, 80.18385359083322, 353.6961693990052, 105.85941846215835, 144.8691798076007, 46.574575107606, 78.5505048045285, 48.891903008387104, 226.29691621127662, 319.4196311469632, 283.7245600340738, 214.5329137812296, 103.85108060548244, 94.17709977809297, 175.7908350038298, 116.91251533096764, 173.54236001874827, 177.91824543601632, 170.42896405769244, 159.48161878439498, 179.96452354851635, 143.32045569538352, 264.65719116901784, 48.17280953775625, 64.04214994824075, 146.37286744225386, 99.49063063826677, 256.3909343317209, 3.80656596317096, 124.37119546271443, 137.67571226162121, 216.8277773902145, 472.8032346258198, 144.2828029653022, 80.12704582157438, 164.6706015605956, 206.24630753435176, 245.66620460626197, 123.98312039065412, 223.54077757486652, 209.03984378156863, 17.7678826357742, 76.50605865460363, 120.02785978283217, 93.57915242026759, 209.61438299630362, 246.91896092043444, 14.20003968569865, 49.03864894283314, 130.89664172812874, 151.7863071087985, 52.43132798117459, 175.25525693805625, 31.794169948663278, 161.19376702566635, 115.71550734523329, 174.89684312213797, 62.93631813044689, 79.23214887695265, 121.02911016781181, 56.82456385006709, 91.21119690767796, 82.00907132397596, 314.31492762843953, 322.17911084243474, 101.83215105390774, 164.2160095962821, 304.5626388170329, 88.02210088986254, 251.8306711443059, 131.7011352800967, 270.72934611510124, 68.600930496221, 121.42577989484462, 68.13284159635245, 232.36300605899177, 211.70295448857274, 217.81428042697675, 196.084405832757, 5.473532645944603, 24.026747506694797, 161.15638276726335, 92.95755313641082, 31.702560306347312, 159.2452992728235, 172.73968256605517, 63.898755368726206, 247.1247047204689, 244.20758222319444, 57.239955689751646, 99.9548709037375, 12.358733380510744, 71.14440822617766, 248.39563801157954, 22.981378365452635, 106.26623179747304, 80.02475844313201, 199.70599001208546, 226.0163526437887, 94.19156133353266, 88.53502799691684, 212.70746311820292, 147.40965383760573, 183.5614223112178, 113.98290577239028, 221.6085923736003, 102.12559901019, 76.61315627989109, 45.271918878191045, 75.61286692607949, 118.24031391599846, 138.44273872583318, 172.4699229139704, 186.7906794116159, 53.568058169898336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.224138581617302, "mean_inference_ms": 6.474066552442143, "mean_action_processing_ms": 5.751923289186161, "mean_env_wait_ms": 12.950314097811036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04691433906555176, "StateBufferConnector_ms": 0.022943615913391113, "ViewRequirementAgentConnector_ms": 0.5667773485183716}, "num_episodes": 18, "episode_return_max": 237.8880810088217, "episode_return_min": 14.88059500321684, "episode_return_mean": 97.8842736762387, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 956480, "num_agent_steps_trained": 956480, "num_env_steps_sampled": 239120, "num_env_steps_trained": 239120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.11443268986457, "num_env_steps_trained_throughput_per_sec": 69.11443268986457, "timesteps_total": 239120, "num_env_steps_sampled_lifetime": 239120, "num_agent_steps_sampled_lifetime": 956480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 956480, "timers": {"training_iteration_time_ms": 91734.014, "restore_workers_time_ms": 2.984, "training_step_time_ms": 91722.605, "sample_time_ms": 16728.346, "learn_time_ms": 74862.566, "learn_throughput": 57.599, "synch_weights_time_ms": 114.32}, "counters": {"num_env_steps_sampled": 239120, "num_env_steps_trained": 239120, "num_agent_steps_sampled": 956480, "num_agent_steps_trained": 956480}, "done": false, "training_iteration": 59, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-15-48", "timestamp": 1724150748, "time_this_iter_s": 57.92761278152466, "time_total_s": 3309.717086791992, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12002df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3309.717086791992, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 56.16097560975611, "ram_util_percent": 83.41341463414633}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.28833230298663, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.712093774099198, "policy_loss": -0.01905607715724578, "vf_loss": 6.7287402243841266, "vf_explained_var": 0.04352292450016768, "kl": 0.012048057826832133, "entropy": 0.6947677288421248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 113925.5, "diff_num_grad_updates_vs_sampler_policy": 996.4750000000058}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.3972802661083366, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.9376101612414, "policy_loss": -0.012616393858414123, "vf_loss": 5.948459625244141, "vf_explained_var": 0.23733859005428495, "kl": 0.00883467480843325, "entropy": 0.800700800065641, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 113925.5, "diff_num_grad_updates_vs_sampler_policy": 996.4750000000058}}, "num_env_steps_sampled": 243120, "num_env_steps_trained": 243120, "num_agent_steps_sampled": 972480, "num_agent_steps_trained": 972480}, "env_runners": {"episode_reward_max": 237.8880810088217, "episode_reward_min": 12.453403193312349, "episode_reward_mean": 95.14914220612445, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -514.3127875459982, "predator_policy": 3.80656596317096}, "policy_reward_max": {"prey_policy": 190.58930269235384, "predator_policy": 472.8032346258198}, "policy_reward_mean": {"prey_policy": -91.76527635323835, "predator_policy": 139.33984745630048}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.156964145066624, 211.07938142561716, 140.57236588515903, 208.09805157079512, 67.46048730122845, 32.591745538805554, 89.45037365953401, 46.68336317844219, 98.86141037904241, 55.50000000000039, 198.49760791628734, 24.30000000000009, 41.24627993206999, 36.62992059636219, 36.79512472828809, 64.24123774839329, 108.55766547672931, 111.36280454506934, 75.1999999999999, 48.067908469018114, 36.50000000000025, 189.66079038343725, 95.91006582305201, 21.35875422893687, 33.822708866195825, 75.33441036197073, 189.46934755928154, 150.79522467964142, 164.97732416379748, 139.28231897522738, 237.8880810088217, 197.64502248102784, 96.72299900571865, 37.58991354451216, 102.7871131489238, 120.30576240637662, 57.253019371534606, 99.89999999999945, 78.41288989002379, 34.00656596317117, 160.68711904296308, 155.65650181806598, 96.33459387222412, 126.7814330991386, 118.23781035600285, 14.88059500321684, 32.800000000000196, 136.04365937111186, 67.72046874777578, 60.43050535164927, 196.22994277005824, 103.7382855514266, 93.90198261162085, 121.66858919709422, 61.8712567501542, 144.57250200346914, 71.24208618071198, 35.96725139989462, 110.7804508186399, 50.71965139563366, 90.64382410381958, 208.69669786725962, 65.14898869652373, 66.86047718984024, 127.36131217152534, 56.20328239545104, 61.30204842343287, 145.24571514149392, 120.48465554212267, 49.674056210907395, 77.7000000000001, 76.81274624915159, 42.19472741818894, 81.1322728031997, 141.0512965103853, 55.10000000000022, 34.71157827017639, 69.47848667489498, 108.62553236603607, 132.31795111552216, 106.67889946355075, 85.7104342635576, 135.82531003786028, 12.453403193312349, 118.90902911860493, 65.91136487904105, 18.86637040383935, 227.5597841278635, 59.26558026504179, 131.10758022628676, 78.00248975701558, 18.190951593973338, 16.03349828301297, 116.29258287734736, 40.30000000000019, 56.529073832917454, 114.35485138072382, 158.89999999999915, 222.09583076153606, 64.94184729861631], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-92.80731425245848, -89.65362076004241, 185.97728007271178, -80.96520733208021, 53.72944824399943, -78.52210885539161, 159.79296513935884, -344.56900121177574, -216.46488618356963, -43.459047979752526, -110.54005360034874, -235.11636243759105, -77.64757467362789, -27.92938609527154, -127.18939532596362, -208.0894011089943, -198.3376945835824, -108.64630023293947, 18.328956132939584, -65.341862514093, -23.256032466716274, 60.36543249629008, -67.93359745700224, -375.5456129195655, -71.95429241014378, 11.036363334503953, -103.22962686546747, -202.47198654492678, -189.64731653235438, -193.5468358076239, -117.1248678794598, 4.354505379470376, -68.45250956881026, -80.77462315877675, 7.900320987585234, -121.99926316946261, -152.75005072601655, -88.17737344002873, -275.603659115743, -65.23087859502415, -15.36903208492708, 8.284917517459904, 47.02534378064107, -71.24452675621119, -277.7108785486498, -26.048932685195425, -91.1463472578097, -166.25021467843652, -64.7176030091654, -180.39611297311555, -81.48380229797084, -77.654597757424, -371.341242487991, 126.93056705743396, -128.81788563697341, 28.884512046856187, -42.94438037180098, 82.79662462346485, 57.206676431593344, -193.11317667602964, -42.982487469292806, -322.27362270292195, -114.68566316705177, -6.053308738632495, -145.17616514351715, -28.06877063268746, -98.72388275165954, -154.14107905354453, -154.78163237764545, -90.77846396713963, 3.050794010159923, -222.19117393669472, -215.55157434678742, -135.1730531460798, 1.4971160307634774, -13.81207551676028, -145.8677941284364, -21.58281406206052, -246.1909343317213, 20.000000000000014, 59.360064184722916, -160.7198528660955, -514.3127875459982, -19.661722651970464, -35.70497384973455, -92.37028106491785, -207.09691629881158, -37.03855969699719, -46.668812149247294, -204.74270249166614, -186.26762838422655, -231.43239796899218, 0.432117364225756, -61.906058654604315, -54.172941738943514, -23.39041109304394, -132.12329599281503, -256.68957917614716, 13.949729955440198, -16.75791323232285, -112.68164971151879, 26.228643644650077, -15.397285283403303, -108.5510140844007, -5.34953314915394, -93.73642121355502, -10.747133336961639, -158.1966279333154, -32.79901242193754, -47.49819783530795, 43.70591723196696, -76.98708924637667, -40.678806211326815, -61.29937583961649, -374.72012815566626, -225.80665891531376, -12.693260456135452, -142.5744493754143, -146.58296375347092, -195.2821245577917, -189.25618282053534, -103.63179950004806, 169.10010717851202, -299.73368592257424, 30.350474406994056, -154.7601072016674, -140.9574108429415, -236.2480725147838, -99.54301471523135, -186.99435937297707, -2.3975405480411935, 29.10054279085271, -123.53863885313913, -69.27324862710218, -27.724809974773542, -17.97733446290351, -35.816922076918004, -80.33686031574048, -303.4690207866917, -138.18920994606464, 5.060044310248385, -84.55487090373838, -14.404401608783388, 7.714006251246353, -230.69938366322944, 1.5170947043857888, -103.38678486823297, -1.7719325691725047, -285.792324118305, 1.1212779728167102, -127.55556649324498, -0.07102283720485153, -209.94647087334343, -115.45906781228983, -72.1961578376427, -155.8696835710704, -180.1481835936925, -34.960475424061464, -52.280128416974165, 62.713004374414474, 0.6167013341076736, -87.79098271263412, -119.23500489640628, -105.96722247984033, 36.020346586815975, -140.55377413047032, -108.94493108760719, -190.97119381551659, 26.03776056431481, -93.77171446487955, -122.78188175152678, -22.104782001764693, -146.61554461110777, -151.16897362791022, 190.58930269235384, -343.35034564328646, -138.3750395504856, -173.07822365869254, 30.92869015794042, -261.62593412138045, -47.397228258070484, -24.01243973541233, -175.0513286327029, -208.18416976526984, -240.3440925529442, -114.40189403118121, -38.01859580676695, -3.6867454019951094, -116.50490081155567, -169.43195157999915, -127.12760614515153, -82.6978457764413, -97.07448545950776, 10.566736427433884, 87.17023655046317, -18.590878153481682, -138.24578276833185, 88.89196463845606, -11.368552259884213, -62.083599653800675], "policy_predator_policy_reward": [98.76662053643813, 124.8512786211282, 89.54023134445923, 16.527077340526183, 124.18150837914091, 41.18351811741119, 48.20975007749616, 344.66433756571604, 221.9979601603934, 105.3864613041571, 231.36127600044108, 146.8868855763036, 103.88227673367213, 91.14505769476077, 82.23093184608689, 299.7312277673132, 196.86935863703218, 208.97604655853232, 55.652553594067996, 46.86035278708554, 129.68319682039936, 31.70501106631479, 88.43359745700151, 379.34561291956527, 91.25429241014302, 10.909916597565672, 158.79805267092894, 183.53348133582602, 192.46129126612988, 227.527985802136, 50.44455491595753, 126.56704533242464, 199.59602501696963, 58.18877318734743, 24.03384424468278, 201.42790248226385, 204.98558455120533, 111.14183961483961, 198.40607053852275, 190.49637564126172, 32.76903208492731, 10.815082482540062, 127.46635125173039, 86.4136221072768, 169.42958044108346, 230.2402966158141, 196.07776408668377, 82.67755207849821, 200.40707811164518, 78.52934673683033, 110.28127109586634, 124.19153932149928, 80.18385359083322, 353.6961693990052, 105.85941846215835, 144.8691798076007, 46.574575107606, 78.5505048045285, 48.891903008387104, 226.29691621127662, 319.4196311469632, 283.7245600340738, 214.5329137812296, 103.85108060548244, 94.17709977809297, 175.7908350038298, 116.91251533096764, 173.54236001874827, 177.91824543601632, 170.42896405769244, 159.48161878439498, 179.96452354851635, 143.32045569538352, 264.65719116901784, 48.17280953775625, 64.04214994824075, 146.37286744225386, 99.49063063826677, 256.3909343317209, 3.80656596317096, 124.37119546271443, 137.67571226162121, 216.8277773902145, 472.8032346258198, 144.2828029653022, 80.12704582157438, 164.6706015605956, 206.24630753435176, 245.66620460626197, 123.98312039065412, 223.54077757486652, 209.03984378156863, 17.7678826357742, 76.50605865460363, 120.02785978283217, 93.57915242026759, 209.61438299630362, 246.91896092043444, 14.20003968569865, 49.03864894283314, 130.89664172812874, 151.7863071087985, 52.43132798117459, 175.25525693805625, 31.794169948663278, 161.19376702566635, 115.71550734523329, 174.89684312213797, 62.93631813044689, 79.23214887695265, 121.02911016781181, 56.82456385006709, 91.21119690767796, 82.00907132397596, 314.31492762843953, 322.17911084243474, 101.83215105390774, 164.2160095962821, 304.5626388170329, 88.02210088986254, 251.8306711443059, 131.7011352800967, 270.72934611510124, 68.600930496221, 121.42577989484462, 68.13284159635245, 232.36300605899177, 211.70295448857274, 217.81428042697675, 196.084405832757, 5.473532645944603, 24.026747506694797, 161.15638276726335, 92.95755313641082, 31.702560306347312, 159.2452992728235, 172.73968256605517, 63.898755368726206, 247.1247047204689, 244.20758222319444, 57.239955689751646, 99.9548709037375, 12.358733380510744, 71.14440822617766, 248.39563801157954, 22.981378365452635, 106.26623179747304, 80.02475844313201, 199.70599001208546, 226.0163526437887, 94.19156133353266, 88.53502799691684, 212.70746311820292, 147.40965383760573, 183.5614223112178, 113.98290577239028, 221.6085923736003, 102.12559901019, 76.61315627989109, 45.271918878191045, 75.61286692607949, 118.24031391599846, 138.44273872583318, 172.4699229139704, 186.7906794116159, 53.568058169898336, 142.80764527374672, 169.56188282268934, 170.72260984182108, 15.920373177348477, 98.45481674732164, 112.34321188501083, 192.50921427229608, 124.14167437056099, 327.50320292184915, 52.817624156946884, 230.5371996456358, 140.18164382858336, 181.77873666576343, 180.0260875239642, 76.29123547755879, 73.1209222729406, 154.81071292420464, 246.61573706774095, 222.954002084485, 147.82548278265256, 72.09438087420551, 85.90354321190455, 133.104900811555, 193.1319515799988, 167.42760614515166, 98.92691960935794, 44.11351445270678, 156.7490859600914, 31.071065300518995, 59.249576302499264, 77.72981882962047, 193.71983006179136, 62.368552259884304, 76.02544695241613]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.24056413747905, "mean_inference_ms": 6.496001448500778, "mean_action_processing_ms": 5.42005867354659, "mean_env_wait_ms": 13.060896317466664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11136913299560547, "StateBufferConnector_ms": 0.024094104766845703, "ViewRequirementAgentConnector_ms": 0.6115994453430176}, "num_episodes": 17, "episode_return_max": 237.8880810088217, "episode_return_min": 12.453403193312349, "episode_return_mean": 95.14914220612445, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972480, "num_agent_steps_trained": 972480, "num_env_steps_sampled": 243120, "num_env_steps_trained": 243120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.08486295814001, "num_env_steps_trained_throughput_per_sec": 70.08486295814001, "timesteps_total": 243120, "num_env_steps_sampled_lifetime": 243120, "num_agent_steps_sampled_lifetime": 972480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 972480, "timers": {"training_iteration_time_ms": 91979.311, "restore_workers_time_ms": 2.984, "training_step_time_ms": 91967.91, "sample_time_ms": 16785.458, "learn_time_ms": 75048.464, "learn_throughput": 57.456, "synch_weights_time_ms": 116.278}, "counters": {"num_env_steps_sampled": 243120, "num_env_steps_trained": 243120, "num_agent_steps_sampled": 972480, "num_agent_steps_trained": 972480}, "done": false, "training_iteration": 60, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-16-45", "timestamp": 1724150805, "time_this_iter_s": 57.114402055740356, "time_total_s": 3366.8314888477325, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120099790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3366.8314888477325, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 55.165432098765436, "ram_util_percent": 83.37654320987654}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.065828051390472, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.759883546576929, "policy_loss": -0.01470072708762788, "vf_loss": 6.772456074265576, "vf_explained_var": 0.17456538305080757, "kl": 0.01064091649943736, "entropy": 0.7015478954744087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 115815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.14419365282412, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.766633439947058, "policy_loss": -0.013369316238634013, "vf_loss": 5.777970125309374, "vf_explained_var": 0.19338865560829324, "kl": 0.010163147549548989, "entropy": 0.7548749689702634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 115815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 247120, "num_env_steps_trained": 247120, "num_agent_steps_sampled": 988480, "num_agent_steps_trained": 988480}, "env_runners": {"episode_reward_max": 237.8880810088217, "episode_reward_min": 12.453403193312349, "episode_reward_mean": 93.83907549579791, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -514.3127875459982, "predator_policy": 3.80656596317096}, "policy_reward_max": {"prey_policy": 190.58930269235384, "predator_policy": 472.8032346258198}, "policy_reward_mean": {"prey_policy": -96.00428500953629, "predator_policy": 142.9238227574352}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.33441036197073, 189.46934755928154, 150.79522467964142, 164.97732416379748, 139.28231897522738, 237.8880810088217, 197.64502248102784, 96.72299900571865, 37.58991354451216, 102.7871131489238, 120.30576240637662, 57.253019371534606, 99.89999999999945, 78.41288989002379, 34.00656596317117, 160.68711904296308, 155.65650181806598, 96.33459387222412, 126.7814330991386, 118.23781035600285, 14.88059500321684, 32.800000000000196, 136.04365937111186, 67.72046874777578, 60.43050535164927, 196.22994277005824, 103.7382855514266, 93.90198261162085, 121.66858919709422, 61.8712567501542, 144.57250200346914, 71.24208618071198, 35.96725139989462, 110.7804508186399, 50.71965139563366, 90.64382410381958, 208.69669786725962, 65.14898869652373, 66.86047718984024, 127.36131217152534, 56.20328239545104, 61.30204842343287, 145.24571514149392, 120.48465554212267, 49.674056210907395, 77.7000000000001, 76.81274624915159, 42.19472741818894, 81.1322728031997, 141.0512965103853, 55.10000000000022, 34.71157827017639, 69.47848667489498, 108.62553236603607, 132.31795111552216, 106.67889946355075, 85.7104342635576, 135.82531003786028, 12.453403193312349, 118.90902911860493, 65.91136487904105, 18.86637040383935, 227.5597841278635, 59.26558026504179, 131.10758022628676, 78.00248975701558, 18.190951593973338, 16.03349828301297, 116.29258287734736, 40.30000000000019, 56.529073832917454, 114.35485138072382, 158.89999999999915, 222.09583076153606, 64.94184729861631, 66.37279748783936, 24.234717220093472, 51.68359410129746, 40.27229571929843, 141.4921459246036, 31.155720667621015, 99.16194942982816, 53.35801727058299, 172.49023170892272, 52.29122847548841, 41.06050892999366, 61.36558792327027, 218.21073348985394, 84.59608591566759, 74.72526833998721, 113.89646967133055, 39.877461582664885, 48.779883636421545, 29.700000000000177, 149.05625594070548, 92.2057271409195, 48.655191894683576, 43.21216766438564, 61.270872080405475, 143.47342854901467], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-81.48380229797084, -77.654597757424, -371.341242487991, 126.93056705743396, -128.81788563697341, 28.884512046856187, -42.94438037180098, 82.79662462346485, 57.206676431593344, -193.11317667602964, -42.982487469292806, -322.27362270292195, -114.68566316705177, -6.053308738632495, -145.17616514351715, -28.06877063268746, -98.72388275165954, -154.14107905354453, -154.78163237764545, -90.77846396713963, 3.050794010159923, -222.19117393669472, -215.55157434678742, -135.1730531460798, 1.4971160307634774, -13.81207551676028, -145.8677941284364, -21.58281406206052, -246.1909343317213, 20.000000000000014, 59.360064184722916, -160.7198528660955, -514.3127875459982, -19.661722651970464, -35.70497384973455, -92.37028106491785, -207.09691629881158, -37.03855969699719, -46.668812149247294, -204.74270249166614, -186.26762838422655, -231.43239796899218, 0.432117364225756, -61.906058654604315, -54.172941738943514, -23.39041109304394, -132.12329599281503, -256.68957917614716, 13.949729955440198, -16.75791323232285, -112.68164971151879, 26.228643644650077, -15.397285283403303, -108.5510140844007, -5.34953314915394, -93.73642121355502, -10.747133336961639, -158.1966279333154, -32.79901242193754, -47.49819783530795, 43.70591723196696, -76.98708924637667, -40.678806211326815, -61.29937583961649, -374.72012815566626, -225.80665891531376, -12.693260456135452, -142.5744493754143, -146.58296375347092, -195.2821245577917, -189.25618282053534, -103.63179950004806, 169.10010717851202, -299.73368592257424, 30.350474406994056, -154.7601072016674, -140.9574108429415, -236.2480725147838, -99.54301471523135, -186.99435937297707, -2.3975405480411935, 29.10054279085271, -123.53863885313913, -69.27324862710218, -27.724809974773542, -17.97733446290351, -35.816922076918004, -80.33686031574048, -303.4690207866917, -138.18920994606464, 5.060044310248385, -84.55487090373838, -14.404401608783388, 7.714006251246353, -230.69938366322944, 1.5170947043857888, -103.38678486823297, -1.7719325691725047, -285.792324118305, 1.1212779728167102, -127.55556649324498, -0.07102283720485153, -209.94647087334343, -115.45906781228983, -72.1961578376427, -155.8696835710704, -180.1481835936925, -34.960475424061464, -52.280128416974165, 62.713004374414474, 0.6167013341076736, -87.79098271263412, -119.23500489640628, -105.96722247984033, 36.020346586815975, -140.55377413047032, -108.94493108760719, -190.97119381551659, 26.03776056431481, -93.77171446487955, -122.78188175152678, -22.104782001764693, -146.61554461110777, -151.16897362791022, 190.58930269235384, -343.35034564328646, -138.3750395504856, -173.07822365869254, 30.92869015794042, -261.62593412138045, -47.397228258070484, -24.01243973541233, -175.0513286327029, -208.18416976526984, -240.3440925529442, -114.40189403118121, -38.01859580676695, -3.6867454019951094, -116.50490081155567, -169.43195157999915, -127.12760614515153, -82.6978457764413, -97.07448545950776, 10.566736427433884, 87.17023655046317, -18.590878153481682, -138.24578276833185, 88.89196463845606, -11.368552259884213, -62.083599653800675, -60.921083321547826, 3.2849368539200086, -69.53683958292125, -112.94400542402329, -407.84315102841526, -39.31720443003579, 0.23881891825411652, -202.05785038855467, -265.27766823949, -17.874763901277653, -183.48852648366133, -40.04448163276014, -24.31514141553314, -99.61000596044815, -244.21913816370102, -80.89714814313665, 9.568279589594617, -84.49027760449901, -483.7127582554307, -62.887615729377046, -168.70672649480116, -291.5826180443935, -64.80977442499315, -42.42101706408005, 44.62608120577094, -27.10553149682405, 32.048189590350454, -326.9652317251389, -195.32731820910587, 30.38338943765794, -79.85545862938633, -23.17240249438853, -329.6583262034389, 6.17614131754816, -10.28070961095682, -114.62905534107989, -127.5971010077946, -182.24378575346114, 50.03028613717659, -149.8085626740707, -4.313434109878143, -135.37103866006623, -37.143250646957995, -252.1646850319538, -37.239406060554124, -46.2195676336949, -68.52648595363993, -82.11752493292995, -193.05171743539222, -193.47532367922264], "policy_predator_policy_reward": [110.28127109586634, 124.19153932149928, 80.18385359083322, 353.6961693990052, 105.85941846215835, 144.8691798076007, 46.574575107606, 78.5505048045285, 48.891903008387104, 226.29691621127662, 319.4196311469632, 283.7245600340738, 214.5329137812296, 103.85108060548244, 94.17709977809297, 175.7908350038298, 116.91251533096764, 173.54236001874827, 177.91824543601632, 170.42896405769244, 159.48161878439498, 179.96452354851635, 143.32045569538352, 264.65719116901784, 48.17280953775625, 64.04214994824075, 146.37286744225386, 99.49063063826677, 256.3909343317209, 3.80656596317096, 124.37119546271443, 137.67571226162121, 216.8277773902145, 472.8032346258198, 144.2828029653022, 80.12704582157438, 164.6706015605956, 206.24630753435176, 245.66620460626197, 123.98312039065412, 223.54077757486652, 209.03984378156863, 17.7678826357742, 76.50605865460363, 120.02785978283217, 93.57915242026759, 209.61438299630362, 246.91896092043444, 14.20003968569865, 49.03864894283314, 130.89664172812874, 151.7863071087985, 52.43132798117459, 175.25525693805625, 31.794169948663278, 161.19376702566635, 115.71550734523329, 174.89684312213797, 62.93631813044689, 79.23214887695265, 121.02911016781181, 56.82456385006709, 91.21119690767796, 82.00907132397596, 314.31492762843953, 322.17911084243474, 101.83215105390774, 164.2160095962821, 304.5626388170329, 88.02210088986254, 251.8306711443059, 131.7011352800967, 270.72934611510124, 68.600930496221, 121.42577989484462, 68.13284159635245, 232.36300605899177, 211.70295448857274, 217.81428042697675, 196.084405832757, 5.473532645944603, 24.026747506694797, 161.15638276726335, 92.95755313641082, 31.702560306347312, 159.2452992728235, 172.73968256605517, 63.898755368726206, 247.1247047204689, 244.20758222319444, 57.239955689751646, 99.9548709037375, 12.358733380510744, 71.14440822617766, 248.39563801157954, 22.981378365452635, 106.26623179747304, 80.02475844313201, 199.70599001208546, 226.0163526437887, 94.19156133353266, 88.53502799691684, 212.70746311820292, 147.40965383760573, 183.5614223112178, 113.98290577239028, 221.6085923736003, 102.12559901019, 76.61315627989109, 45.271918878191045, 75.61286692607949, 118.24031391599846, 138.44273872583318, 172.4699229139704, 186.7906794116159, 53.568058169898336, 142.80764527374672, 169.56188282268934, 170.72260984182108, 15.920373177348477, 98.45481674732164, 112.34321188501083, 192.50921427229608, 124.14167437056099, 327.50320292184915, 52.817624156946884, 230.5371996456358, 140.18164382858336, 181.77873666576343, 180.0260875239642, 76.29123547755879, 73.1209222729406, 154.81071292420464, 246.61573706774095, 222.954002084485, 147.82548278265256, 72.09438087420551, 85.90354321190455, 133.104900811555, 193.1319515799988, 167.42760614515166, 98.92691960935794, 44.11351445270678, 156.7490859600914, 31.071065300518995, 59.249576302499264, 77.72981882962047, 193.71983006179136, 62.368552259884304, 76.02544695241613, 46.181395524372086, 77.82754843109493, 84.32376248676633, 122.39179974027076, 408.5431510284154, 90.30079853133327, 96.67552171900184, 145.41580547059704, 219.3306951064499, 205.31388295892225, 181.32322691910778, 73.36550186493415, 157.27467064383035, 65.81242616197889, 114.50197635477282, 263.9723272226469, 91.71530408079758, 155.69692564302963, 417.81840765648644, 181.0731948038094, 298.663705330972, 202.68614813821634, 114.80911744904752, 53.78726196329599, 124.94285296487092, 75.74733081603654, 183.32106237985275, 196.19206567060374, 112.1670450428772, 127.50215206855796, 137.12656702274944, 79.79776377235618, 31.63951851477689, 331.7201279537785, 163.31294786346695, 10.376700724991336, 148.99710100779396, 190.54378575346078, 159.81320273886, 89.02132973873965, 117.74368959455873, 114.14651031630562, 73.96366230256547, 263.9994652710299, 55.445530508408, 71.22561085022674, 87.08897137505828, 124.82591159191712, 290.58506906178906, 239.41540060184036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.269807611845868, "mean_inference_ms": 6.523566664838259, "mean_action_processing_ms": 5.0372934670234795, "mean_env_wait_ms": 13.181723314653123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08445596694946289, "StateBufferConnector_ms": 0.02824580669403076, "ViewRequirementAgentConnector_ms": 0.5087442398071289}, "num_episodes": 25, "episode_return_max": 237.8880810088217, "episode_return_min": 12.453403193312349, "episode_return_mean": 93.83907549579791, "episodes_this_iter": 25}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 988480, "num_agent_steps_trained": 988480, "num_env_steps_sampled": 247120, "num_env_steps_trained": 247120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.88434421149935, "num_env_steps_trained_throughput_per_sec": 69.88434421149935, "timesteps_total": 247120, "num_env_steps_sampled_lifetime": 247120, "num_agent_steps_sampled_lifetime": 988480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 988480, "timers": {"training_iteration_time_ms": 83751.319, "restore_workers_time_ms": 2.986, "training_step_time_ms": 83739.954, "sample_time_ms": 16808.7, "learn_time_ms": 66893.92, "learn_throughput": 64.46, "synch_weights_time_ms": 21.99}, "counters": {"num_env_steps_sampled": 247120, "num_env_steps_trained": 247120, "num_agent_steps_sampled": 988480, "num_agent_steps_trained": 988480}, "done": false, "training_iteration": 61, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-17-42", "timestamp": 1724150862, "time_this_iter_s": 57.303910970687866, "time_total_s": 3424.1353998184204, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120099820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3424.1353998184204, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 54.98148148148148, "ram_util_percent": 83.3395061728395}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.23118528733178, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.49752794220334, "policy_loss": -0.015785263684361422, "vf_loss": 7.511219266356615, "vf_explained_var": 0.2933156137113218, "kl": 0.010469665311193144, "entropy": 0.7158934612122793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 117705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.594214921022849, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.850665115427088, "policy_loss": -0.014153891141777711, "vf_loss": 5.862661906903383, "vf_explained_var": 0.10696779820654127, "kl": 0.010785506519602327, "entropy": 0.7880757563013249, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 117705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 251120, "num_env_steps_trained": 251120, "num_agent_steps_sampled": 1004480, "num_agent_steps_trained": 1004480}, "env_runners": {"episode_reward_max": 227.5597841278635, "episode_reward_min": 6.754588265870245, "episode_reward_mean": 86.29461413358605, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -483.7127582554307, "predator_policy": 5.473532645944603}, "policy_reward_max": {"prey_policy": 190.58930269235384, "predator_policy": 417.81840765648644}, "policy_reward_mean": {"prey_policy": -94.7470390884598, "predator_policy": 137.89434615525278}, "custom_metrics": {}, "hist_stats": {"episode_reward": [126.7814330991386, 118.23781035600285, 14.88059500321684, 32.800000000000196, 136.04365937111186, 67.72046874777578, 60.43050535164927, 196.22994277005824, 103.7382855514266, 93.90198261162085, 121.66858919709422, 61.8712567501542, 144.57250200346914, 71.24208618071198, 35.96725139989462, 110.7804508186399, 50.71965139563366, 90.64382410381958, 208.69669786725962, 65.14898869652373, 66.86047718984024, 127.36131217152534, 56.20328239545104, 61.30204842343287, 145.24571514149392, 120.48465554212267, 49.674056210907395, 77.7000000000001, 76.81274624915159, 42.19472741818894, 81.1322728031997, 141.0512965103853, 55.10000000000022, 34.71157827017639, 69.47848667489498, 108.62553236603607, 132.31795111552216, 106.67889946355075, 85.7104342635576, 135.82531003786028, 12.453403193312349, 118.90902911860493, 65.91136487904105, 18.86637040383935, 227.5597841278635, 59.26558026504179, 131.10758022628676, 78.00248975701558, 18.190951593973338, 16.03349828301297, 116.29258287734736, 40.30000000000019, 56.529073832917454, 114.35485138072382, 158.89999999999915, 222.09583076153606, 64.94184729861631, 66.37279748783936, 24.234717220093472, 51.68359410129746, 40.27229571929843, 141.4921459246036, 31.155720667621015, 99.16194942982816, 53.35801727058299, 172.49023170892272, 52.29122847548841, 41.06050892999366, 61.36558792327027, 218.21073348985394, 84.59608591566759, 74.72526833998721, 113.89646967133055, 39.877461582664885, 48.779883636421545, 29.700000000000177, 149.05625594070548, 92.2057271409195, 48.655191894683576, 43.21216766438564, 61.270872080405475, 143.47342854901467, 76.54668659111461, 205.68163129653047, 85.8165298475987, 104.11051626169551, 90.26969685180384, 97.52563527527755, 46.58418107625287, 61.115663856961596, 23.654063993148917, 57.800000000000374, 87.83561736447349, 97.855209634798, 6.754588265870245, 53.408351544144686, 48.6000000000002, 38.53124856248382, 59.19050897848118, 199.32194167145792], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-207.09691629881158, -37.03855969699719, -46.668812149247294, -204.74270249166614, -186.26762838422655, -231.43239796899218, 0.432117364225756, -61.906058654604315, -54.172941738943514, -23.39041109304394, -132.12329599281503, -256.68957917614716, 13.949729955440198, -16.75791323232285, -112.68164971151879, 26.228643644650077, -15.397285283403303, -108.5510140844007, -5.34953314915394, -93.73642121355502, -10.747133336961639, -158.1966279333154, -32.79901242193754, -47.49819783530795, 43.70591723196696, -76.98708924637667, -40.678806211326815, -61.29937583961649, -374.72012815566626, -225.80665891531376, -12.693260456135452, -142.5744493754143, -146.58296375347092, -195.2821245577917, -189.25618282053534, -103.63179950004806, 169.10010717851202, -299.73368592257424, 30.350474406994056, -154.7601072016674, -140.9574108429415, -236.2480725147838, -99.54301471523135, -186.99435937297707, -2.3975405480411935, 29.10054279085271, -123.53863885313913, -69.27324862710218, -27.724809974773542, -17.97733446290351, -35.816922076918004, -80.33686031574048, -303.4690207866917, -138.18920994606464, 5.060044310248385, -84.55487090373838, -14.404401608783388, 7.714006251246353, -230.69938366322944, 1.5170947043857888, -103.38678486823297, -1.7719325691725047, -285.792324118305, 1.1212779728167102, -127.55556649324498, -0.07102283720485153, -209.94647087334343, -115.45906781228983, -72.1961578376427, -155.8696835710704, -180.1481835936925, -34.960475424061464, -52.280128416974165, 62.713004374414474, 0.6167013341076736, -87.79098271263412, -119.23500489640628, -105.96722247984033, 36.020346586815975, -140.55377413047032, -108.94493108760719, -190.97119381551659, 26.03776056431481, -93.77171446487955, -122.78188175152678, -22.104782001764693, -146.61554461110777, -151.16897362791022, 190.58930269235384, -343.35034564328646, -138.3750395504856, -173.07822365869254, 30.92869015794042, -261.62593412138045, -47.397228258070484, -24.01243973541233, -175.0513286327029, -208.18416976526984, -240.3440925529442, -114.40189403118121, -38.01859580676695, -3.6867454019951094, -116.50490081155567, -169.43195157999915, -127.12760614515153, -82.6978457764413, -97.07448545950776, 10.566736427433884, 87.17023655046317, -18.590878153481682, -138.24578276833185, 88.89196463845606, -11.368552259884213, -62.083599653800675, -60.921083321547826, 3.2849368539200086, -69.53683958292125, -112.94400542402329, -407.84315102841526, -39.31720443003579, 0.23881891825411652, -202.05785038855467, -265.27766823949, -17.874763901277653, -183.48852648366133, -40.04448163276014, -24.31514141553314, -99.61000596044815, -244.21913816370102, -80.89714814313665, 9.568279589594617, -84.49027760449901, -483.7127582554307, -62.887615729377046, -168.70672649480116, -291.5826180443935, -64.80977442499315, -42.42101706408005, 44.62608120577094, -27.10553149682405, 32.048189590350454, -326.9652317251389, -195.32731820910587, 30.38338943765794, -79.85545862938633, -23.17240249438853, -329.6583262034389, 6.17614131754816, -10.28070961095682, -114.62905534107989, -127.5971010077946, -182.24378575346114, 50.03028613717659, -149.8085626740707, -4.313434109878143, -135.37103866006623, -37.143250646957995, -252.1646850319538, -37.239406060554124, -46.2195676336949, -68.52648595363993, -82.11752493292995, -193.05171743539222, -193.47532367922264, -163.52049420294196, -62.50668994423621, 84.80471700156382, -60.28571111510078, -224.0892005786813, 42.97986271517694, -128.0857165394887, -116.82718584141246, -164.91626811470175, 4.658358751859067, -173.38445852371513, -66.4206821002088, -232.16450118006506, -94.88383531103229, -89.80898790135979, 1.6499827844424166, -303.0816888896981, -4.953121579523122, 30.861716277788254, -46.095652636065935, 11.40418151291365, -135.35745422448892, -31.866959607701492, -28.765630682295765, -45.86772590986905, -96.8669539210525, 23.5833775841882, -184.96350873955672, -98.69803724717282, -41.005740987148755, -288.81984645915855, -139.25708174133894, -78.86827037472364, -208.50244815706574, -269.8149630295266, 134.75295883214983], "policy_predator_policy_reward": [164.6706015605956, 206.24630753435176, 245.66620460626197, 123.98312039065412, 223.54077757486652, 209.03984378156863, 17.7678826357742, 76.50605865460363, 120.02785978283217, 93.57915242026759, 209.61438299630362, 246.91896092043444, 14.20003968569865, 49.03864894283314, 130.89664172812874, 151.7863071087985, 52.43132798117459, 175.25525693805625, 31.794169948663278, 161.19376702566635, 115.71550734523329, 174.89684312213797, 62.93631813044689, 79.23214887695265, 121.02911016781181, 56.82456385006709, 91.21119690767796, 82.00907132397596, 314.31492762843953, 322.17911084243474, 101.83215105390774, 164.2160095962821, 304.5626388170329, 88.02210088986254, 251.8306711443059, 131.7011352800967, 270.72934611510124, 68.600930496221, 121.42577989484462, 68.13284159635245, 232.36300605899177, 211.70295448857274, 217.81428042697675, 196.084405832757, 5.473532645944603, 24.026747506694797, 161.15638276726335, 92.95755313641082, 31.702560306347312, 159.2452992728235, 172.73968256605517, 63.898755368726206, 247.1247047204689, 244.20758222319444, 57.239955689751646, 99.9548709037375, 12.358733380510744, 71.14440822617766, 248.39563801157954, 22.981378365452635, 106.26623179747304, 80.02475844313201, 199.70599001208546, 226.0163526437887, 94.19156133353266, 88.53502799691684, 212.70746311820292, 147.40965383760573, 183.5614223112178, 113.98290577239028, 221.6085923736003, 102.12559901019, 76.61315627989109, 45.271918878191045, 75.61286692607949, 118.24031391599846, 138.44273872583318, 172.4699229139704, 186.7906794116159, 53.568058169898336, 142.80764527374672, 169.56188282268934, 170.72260984182108, 15.920373177348477, 98.45481674732164, 112.34321188501083, 192.50921427229608, 124.14167437056099, 327.50320292184915, 52.817624156946884, 230.5371996456358, 140.18164382858336, 181.77873666576343, 180.0260875239642, 76.29123547755879, 73.1209222729406, 154.81071292420464, 246.61573706774095, 222.954002084485, 147.82548278265256, 72.09438087420551, 85.90354321190455, 133.104900811555, 193.1319515799988, 167.42760614515166, 98.92691960935794, 44.11351445270678, 156.7490859600914, 31.071065300518995, 59.249576302499264, 77.72981882962047, 193.71983006179136, 62.368552259884304, 76.02544695241613, 46.181395524372086, 77.82754843109493, 84.32376248676633, 122.39179974027076, 408.5431510284154, 90.30079853133327, 96.67552171900184, 145.41580547059704, 219.3306951064499, 205.31388295892225, 181.32322691910778, 73.36550186493415, 157.27467064383035, 65.81242616197889, 114.50197635477282, 263.9723272226469, 91.71530408079758, 155.69692564302963, 417.81840765648644, 181.0731948038094, 298.663705330972, 202.68614813821634, 114.80911744904752, 53.78726196329599, 124.94285296487092, 75.74733081603654, 183.32106237985275, 196.19206567060374, 112.1670450428772, 127.50215206855796, 137.12656702274944, 79.79776377235618, 31.63951851477689, 331.7201279537785, 163.31294786346695, 10.376700724991336, 148.99710100779396, 190.54378575346078, 159.81320273886, 89.02132973873965, 117.74368959455873, 114.14651031630562, 73.96366230256547, 263.9994652710299, 55.445530508408, 71.22561085022674, 87.08897137505828, 124.82591159191712, 290.58506906178906, 239.41540060184036, 138.4645752697779, 164.10929546851438, 65.917932408509, 115.24469300155857, 199.28246918746038, 67.64339852364253, 155.007668938702, 194.01574970389467, 81.59493442206805, 168.93267179257867, 180.77240290698418, 156.55837299221753, 124.55914370353263, 249.07337386381735, 125.63747599936775, 23.63719297451032, 312.6925240030144, 18.996350459356346, 67.38255246263812, 5.651383895639884, 47.911460156415195, 163.8774299196343, 58.961362131927366, 99.52643779286784, 63.38318365471591, 86.10608444207563, 19.137040725921004, 195.65144197359214, 113.29803724717279, 75.00574098714877, 197.80191110189966, 268.806265661081, 172.5442553872114, 174.01697212305805, 266.4924416283949, 67.8915042404418]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.118497460107196, "mean_inference_ms": 6.446816126338816, "mean_action_processing_ms": 5.496135602313147, "mean_env_wait_ms": 13.257132365342306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07223784923553467, "StateBufferConnector_ms": 0.03233635425567627, "ViewRequirementAgentConnector_ms": 0.4480605125427246}, "num_episodes": 18, "episode_return_max": 227.5597841278635, "episode_return_min": 6.754588265870245, "episode_return_mean": 86.29461413358605, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1004480, "num_agent_steps_trained": 1004480, "num_env_steps_sampled": 251120, "num_env_steps_trained": 251120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.60757152176055, "num_env_steps_trained_throughput_per_sec": 67.60757152176055, "timesteps_total": 251120, "num_env_steps_sampled_lifetime": 251120, "num_agent_steps_sampled_lifetime": 1004480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1004480, "timers": {"training_iteration_time_ms": 57754.951, "restore_workers_time_ms": 0.018, "training_step_time_ms": 57754.878, "sample_time_ms": 4392.098, "learn_time_ms": 53333.564, "learn_throughput": 75.0, "synch_weights_time_ms": 23.036}, "counters": {"num_env_steps_sampled": 251120, "num_env_steps_trained": 251120, "num_agent_steps_sampled": 1004480, "num_agent_steps_trained": 1004480}, "done": false, "training_iteration": 62, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-18-42", "timestamp": 1724150922, "time_this_iter_s": 59.209882974624634, "time_total_s": 3483.345282793045, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12002de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3483.345282793045, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 59.88452380952381, "ram_util_percent": 83.4154761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.674619754786214, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.713251170910224, "policy_loss": -0.016176287478966905, "vf_loss": 7.727386751376763, "vf_explained_var": 0.19913925509604197, "kl": 0.010203460868812663, "entropy": 0.705321858957331, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 119595.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.974245104335603, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.245531187612544, "policy_loss": -0.01500197145496569, "vf_loss": 6.258381868039489, "vf_explained_var": 0.18461579175853224, "kl": 0.010756364312126405, "entropy": 0.7356649029507208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 119595.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}}, "num_env_steps_sampled": 255120, "num_env_steps_trained": 255120, "num_agent_steps_sampled": 1020480, "num_agent_steps_trained": 1020480}, "env_runners": {"episode_reward_max": 227.5597841278635, "episode_reward_min": -5.473495972347568, "episode_reward_mean": 85.82533476616806, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -483.7127582554307, "predator_policy": 5.473532645944603}, "policy_reward_max": {"prey_policy": 190.58930269235384, "predator_policy": 417.81840765648644}, "policy_reward_mean": {"prey_policy": -95.64131402286719, "predator_policy": 138.55398140595116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.14898869652373, 66.86047718984024, 127.36131217152534, 56.20328239545104, 61.30204842343287, 145.24571514149392, 120.48465554212267, 49.674056210907395, 77.7000000000001, 76.81274624915159, 42.19472741818894, 81.1322728031997, 141.0512965103853, 55.10000000000022, 34.71157827017639, 69.47848667489498, 108.62553236603607, 132.31795111552216, 106.67889946355075, 85.7104342635576, 135.82531003786028, 12.453403193312349, 118.90902911860493, 65.91136487904105, 18.86637040383935, 227.5597841278635, 59.26558026504179, 131.10758022628676, 78.00248975701558, 18.190951593973338, 16.03349828301297, 116.29258287734736, 40.30000000000019, 56.529073832917454, 114.35485138072382, 158.89999999999915, 222.09583076153606, 64.94184729861631, 66.37279748783936, 24.234717220093472, 51.68359410129746, 40.27229571929843, 141.4921459246036, 31.155720667621015, 99.16194942982816, 53.35801727058299, 172.49023170892272, 52.29122847548841, 41.06050892999366, 61.36558792327027, 218.21073348985394, 84.59608591566759, 74.72526833998721, 113.89646967133055, 39.877461582664885, 48.779883636421545, 29.700000000000177, 149.05625594070548, 92.2057271409195, 48.655191894683576, 43.21216766438564, 61.270872080405475, 143.47342854901467, 76.54668659111461, 205.68163129653047, 85.8165298475987, 104.11051626169551, 90.26969685180384, 97.52563527527755, 46.58418107625287, 61.115663856961596, 23.654063993148917, 57.800000000000374, 87.83561736447349, 97.855209634798, 6.754588265870245, 53.408351544144686, 48.6000000000002, 38.53124856248382, 59.19050897848118, 199.32194167145792, 47.2362219966885, 179.97343896776036, 143.247315634946, 27.17522230466569, 188.507212839751, 27.690895089050002, 147.02351333478373, 175.56048702199428, 57.24040765715116, 40.72415754648677, 42.40318386150766, 39.99333465437214, -5.473495972347568, 32.14072180722854, 200.86702593589723, 150.1999999999993, 128.79877667359526, 76.80040747009272, 99.89022901325625], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [30.350474406994056, -154.7601072016674, -140.9574108429415, -236.2480725147838, -99.54301471523135, -186.99435937297707, -2.3975405480411935, 29.10054279085271, -123.53863885313913, -69.27324862710218, -27.724809974773542, -17.97733446290351, -35.816922076918004, -80.33686031574048, -303.4690207866917, -138.18920994606464, 5.060044310248385, -84.55487090373838, -14.404401608783388, 7.714006251246353, -230.69938366322944, 1.5170947043857888, -103.38678486823297, -1.7719325691725047, -285.792324118305, 1.1212779728167102, -127.55556649324498, -0.07102283720485153, -209.94647087334343, -115.45906781228983, -72.1961578376427, -155.8696835710704, -180.1481835936925, -34.960475424061464, -52.280128416974165, 62.713004374414474, 0.6167013341076736, -87.79098271263412, -119.23500489640628, -105.96722247984033, 36.020346586815975, -140.55377413047032, -108.94493108760719, -190.97119381551659, 26.03776056431481, -93.77171446487955, -122.78188175152678, -22.104782001764693, -146.61554461110777, -151.16897362791022, 190.58930269235384, -343.35034564328646, -138.3750395504856, -173.07822365869254, 30.92869015794042, -261.62593412138045, -47.397228258070484, -24.01243973541233, -175.0513286327029, -208.18416976526984, -240.3440925529442, -114.40189403118121, -38.01859580676695, -3.6867454019951094, -116.50490081155567, -169.43195157999915, -127.12760614515153, -82.6978457764413, -97.07448545950776, 10.566736427433884, 87.17023655046317, -18.590878153481682, -138.24578276833185, 88.89196463845606, -11.368552259884213, -62.083599653800675, -60.921083321547826, 3.2849368539200086, -69.53683958292125, -112.94400542402329, -407.84315102841526, -39.31720443003579, 0.23881891825411652, -202.05785038855467, -265.27766823949, -17.874763901277653, -183.48852648366133, -40.04448163276014, -24.31514141553314, -99.61000596044815, -244.21913816370102, -80.89714814313665, 9.568279589594617, -84.49027760449901, -483.7127582554307, -62.887615729377046, -168.70672649480116, -291.5826180443935, -64.80977442499315, -42.42101706408005, 44.62608120577094, -27.10553149682405, 32.048189590350454, -326.9652317251389, -195.32731820910587, 30.38338943765794, -79.85545862938633, -23.17240249438853, -329.6583262034389, 6.17614131754816, -10.28070961095682, -114.62905534107989, -127.5971010077946, -182.24378575346114, 50.03028613717659, -149.8085626740707, -4.313434109878143, -135.37103866006623, -37.143250646957995, -252.1646850319538, -37.239406060554124, -46.2195676336949, -68.52648595363993, -82.11752493292995, -193.05171743539222, -193.47532367922264, -163.52049420294196, -62.50668994423621, 84.80471700156382, -60.28571111510078, -224.0892005786813, 42.97986271517694, -128.0857165394887, -116.82718584141246, -164.91626811470175, 4.658358751859067, -173.38445852371513, -66.4206821002088, -232.16450118006506, -94.88383531103229, -89.80898790135979, 1.6499827844424166, -303.0816888896981, -4.953121579523122, 30.861716277788254, -46.095652636065935, 11.40418151291365, -135.35745422448892, -31.866959607701492, -28.765630682295765, -45.86772590986905, -96.8669539210525, 23.5833775841882, -184.96350873955672, -98.69803724717282, -41.005740987148755, -288.81984645915855, -139.25708174133894, -78.86827037472364, -208.50244815706574, -269.8149630295266, 134.75295883214983, -308.4456008297589, -97.49223025694897, -188.22523434291014, 48.03106260810362, -327.2398120598609, 2.9780464263357964, -92.15410670345008, -138.37967865864343, 39.93070269210275, -164.91138815654676, -203.74930762498988, -155.29554000234347, -142.56765123055155, -51.42806953947161, -250.57475116106215, 136.90563707418787, -193.35656937636358, -365.0843107864904, -110.86927907768677, 13.506019634920722, -123.4845594080471, -167.49317730152924, -92.5487339398489, -339.65017497452607, -164.17451682683998, -54.34684360005737, -133.39302330662048, -71.82656089842469, -206.58146957339378, 162.41755254222235, 111.71311044433514, -63.127733886201575, 56.41362132843381, 52.740691304162304, -6.1408953421589425, -134.40254615147083, -59.33814233897031, -56.28362480795757], "policy_predator_policy_reward": [121.42577989484462, 68.13284159635245, 232.36300605899177, 211.70295448857274, 217.81428042697675, 196.084405832757, 5.473532645944603, 24.026747506694797, 161.15638276726335, 92.95755313641082, 31.702560306347312, 159.2452992728235, 172.73968256605517, 63.898755368726206, 247.1247047204689, 244.20758222319444, 57.239955689751646, 99.9548709037375, 12.358733380510744, 71.14440822617766, 248.39563801157954, 22.981378365452635, 106.26623179747304, 80.02475844313201, 199.70599001208546, 226.0163526437887, 94.19156133353266, 88.53502799691684, 212.70746311820292, 147.40965383760573, 183.5614223112178, 113.98290577239028, 221.6085923736003, 102.12559901019, 76.61315627989109, 45.271918878191045, 75.61286692607949, 118.24031391599846, 138.44273872583318, 172.4699229139704, 186.7906794116159, 53.568058169898336, 142.80764527374672, 169.56188282268934, 170.72260984182108, 15.920373177348477, 98.45481674732164, 112.34321188501083, 192.50921427229608, 124.14167437056099, 327.50320292184915, 52.817624156946884, 230.5371996456358, 140.18164382858336, 181.77873666576343, 180.0260875239642, 76.29123547755879, 73.1209222729406, 154.81071292420464, 246.61573706774095, 222.954002084485, 147.82548278265256, 72.09438087420551, 85.90354321190455, 133.104900811555, 193.1319515799988, 167.42760614515166, 98.92691960935794, 44.11351445270678, 156.7490859600914, 31.071065300518995, 59.249576302499264, 77.72981882962047, 193.71983006179136, 62.368552259884304, 76.02544695241613, 46.181395524372086, 77.82754843109493, 84.32376248676633, 122.39179974027076, 408.5431510284154, 90.30079853133327, 96.67552171900184, 145.41580547059704, 219.3306951064499, 205.31388295892225, 181.32322691910778, 73.36550186493415, 157.27467064383035, 65.81242616197889, 114.50197635477282, 263.9723272226469, 91.71530408079758, 155.69692564302963, 417.81840765648644, 181.0731948038094, 298.663705330972, 202.68614813821634, 114.80911744904752, 53.78726196329599, 124.94285296487092, 75.74733081603654, 183.32106237985275, 196.19206567060374, 112.1670450428772, 127.50215206855796, 137.12656702274944, 79.79776377235618, 31.63951851477689, 331.7201279537785, 163.31294786346695, 10.376700724991336, 148.99710100779396, 190.54378575346078, 159.81320273886, 89.02132973873965, 117.74368959455873, 114.14651031630562, 73.96366230256547, 263.9994652710299, 55.445530508408, 71.22561085022674, 87.08897137505828, 124.82591159191712, 290.58506906178906, 239.41540060184036, 138.4645752697779, 164.10929546851438, 65.917932408509, 115.24469300155857, 199.28246918746038, 67.64339852364253, 155.007668938702, 194.01574970389467, 81.59493442206805, 168.93267179257867, 180.77240290698418, 156.55837299221753, 124.55914370353263, 249.07337386381735, 125.63747599936775, 23.63719297451032, 312.6925240030144, 18.996350459356346, 67.38255246263812, 5.651383895639884, 47.911460156415195, 163.8774299196343, 58.961362131927366, 99.52643779286784, 63.38318365471591, 86.10608444207563, 19.137040725921004, 195.65144197359214, 113.29803724717279, 75.00574098714877, 197.80191110189966, 268.806265661081, 172.5442553872114, 174.01697212305805, 266.4924416283949, 67.8915042404418, 258.95478259640896, 194.21927048698723, 97.7048133504822, 222.4627973520852, 294.78879137632697, 172.72028989214516, 101.91329948111778, 155.79570818563994, 203.717365497081, 109.77053280711407, 149.04783497853984, 237.687907737843, 162.02565759966689, 178.99357650514003, 101.25055743964307, 187.97904366922546, 247.49697703351475, 368.1843107864904, 106.3828407003355, 31.704576288916346, 139.7877432695545, 193.59317730152907, 166.88964891716614, 305.30259465158053, 36.251704156173254, 176.79616029837612, 146.35211311196136, 91.00819290031171, 24.649473393675557, 220.38146957339305, 14.999817241633604, 86.61480620023202, 8.285155345162307, 11.359308695837676, 75.23248942309148, 142.11135954063113, 125.16207304009454, 90.34992312008963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.215413022385565, "mean_inference_ms": 6.490337821427894, "mean_action_processing_ms": 4.637534167168109, "mean_env_wait_ms": 13.342074739558804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07267200946807861, "StateBufferConnector_ms": 0.04471087455749512, "ViewRequirementAgentConnector_ms": 0.40450966358184814}, "num_episodes": 19, "episode_return_max": 227.5597841278635, "episode_return_min": -5.473495972347568, "episode_return_mean": 85.82533476616806, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020480, "num_agent_steps_trained": 1020480, "num_env_steps_sampled": 255120, "num_env_steps_trained": 255120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.16145415081301, "num_env_steps_trained_throughput_per_sec": 75.16145415081301, "timesteps_total": 255120, "num_env_steps_sampled_lifetime": 255120, "num_agent_steps_sampled_lifetime": 1020480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1020480, "timers": {"training_iteration_time_ms": 57278.327, "restore_workers_time_ms": 0.017, "training_step_time_ms": 57278.254, "sample_time_ms": 4267.071, "learn_time_ms": 52981.406, "learn_throughput": 75.498, "synch_weights_time_ms": 23.779}, "counters": {"num_env_steps_sampled": 255120, "num_env_steps_trained": 255120, "num_agent_steps_sampled": 1020480, "num_agent_steps_trained": 1020480}, "done": false, "training_iteration": 63, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-19-35", "timestamp": 1724150975, "time_this_iter_s": 53.274051904678345, "time_total_s": 3536.6193346977234, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120b71820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3536.6193346977234, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 49.498666666666665, "ram_util_percent": 82.49466666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.28420255461698, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.300115937530679, "policy_loss": -0.017477003738983834, "vf_loss": 7.315200337404927, "vf_explained_var": 0.10124493367457515, "kl": 0.011962977575049515, "entropy": 0.6713495669541536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.950880830376237, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.227240897234155, "policy_loss": -0.013918458662247137, "vf_loss": 6.238984562606408, "vf_explained_var": 0.05417612772139292, "kl": 0.010873960507245211, "entropy": 0.7394360021308616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 259120, "num_env_steps_trained": 259120, "num_agent_steps_sampled": 1036480, "num_agent_steps_trained": 1036480}, "env_runners": {"episode_reward_max": 269.5999999999999, "episode_reward_min": -5.473495972347568, "episode_reward_mean": 90.5150288483579, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -483.7127582554307, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.58930269235384, "predator_policy": 417.81840765648644}, "policy_reward_mean": {"prey_policy": -92.2564974800667, "predator_policy": 137.5140119042456}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.67889946355075, 85.7104342635576, 135.82531003786028, 12.453403193312349, 118.90902911860493, 65.91136487904105, 18.86637040383935, 227.5597841278635, 59.26558026504179, 131.10758022628676, 78.00248975701558, 18.190951593973338, 16.03349828301297, 116.29258287734736, 40.30000000000019, 56.529073832917454, 114.35485138072382, 158.89999999999915, 222.09583076153606, 64.94184729861631, 66.37279748783936, 24.234717220093472, 51.68359410129746, 40.27229571929843, 141.4921459246036, 31.155720667621015, 99.16194942982816, 53.35801727058299, 172.49023170892272, 52.29122847548841, 41.06050892999366, 61.36558792327027, 218.21073348985394, 84.59608591566759, 74.72526833998721, 113.89646967133055, 39.877461582664885, 48.779883636421545, 29.700000000000177, 149.05625594070548, 92.2057271409195, 48.655191894683576, 43.21216766438564, 61.270872080405475, 143.47342854901467, 76.54668659111461, 205.68163129653047, 85.8165298475987, 104.11051626169551, 90.26969685180384, 97.52563527527755, 46.58418107625287, 61.115663856961596, 23.654063993148917, 57.800000000000374, 87.83561736447349, 97.855209634798, 6.754588265870245, 53.408351544144686, 48.6000000000002, 38.53124856248382, 59.19050897848118, 199.32194167145792, 47.2362219966885, 179.97343896776036, 143.247315634946, 27.17522230466569, 188.507212839751, 27.690895089050002, 147.02351333478373, 175.56048702199428, 57.24040765715116, 40.72415754648677, 42.40318386150766, 39.99333465437214, -5.473495972347568, 32.14072180722854, 200.86702593589723, 150.1999999999993, 128.79877667359526, 76.80040747009272, 99.89022901325625, 22.97671505326869, 7.6472752977076155, 29.52336227785046, 98.15658027218063, 93.54783715020767, 36.489920086851065, 210.91919265544564, 7.880667911258477, 47.030570562241714, 77.83770417272075, 163.7681167689591, 163.65364074522606, 269.5999999999999, 262.46208867276926, 121.70008274420819, 143.6411989373153, 31.880977640564556, 191.65860444906244], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.6167013341076736, -87.79098271263412, -119.23500489640628, -105.96722247984033, 36.020346586815975, -140.55377413047032, -108.94493108760719, -190.97119381551659, 26.03776056431481, -93.77171446487955, -122.78188175152678, -22.104782001764693, -146.61554461110777, -151.16897362791022, 190.58930269235384, -343.35034564328646, -138.3750395504856, -173.07822365869254, 30.92869015794042, -261.62593412138045, -47.397228258070484, -24.01243973541233, -175.0513286327029, -208.18416976526984, -240.3440925529442, -114.40189403118121, -38.01859580676695, -3.6867454019951094, -116.50490081155567, -169.43195157999915, -127.12760614515153, -82.6978457764413, -97.07448545950776, 10.566736427433884, 87.17023655046317, -18.590878153481682, -138.24578276833185, 88.89196463845606, -11.368552259884213, -62.083599653800675, -60.921083321547826, 3.2849368539200086, -69.53683958292125, -112.94400542402329, -407.84315102841526, -39.31720443003579, 0.23881891825411652, -202.05785038855467, -265.27766823949, -17.874763901277653, -183.48852648366133, -40.04448163276014, -24.31514141553314, -99.61000596044815, -244.21913816370102, -80.89714814313665, 9.568279589594617, -84.49027760449901, -483.7127582554307, -62.887615729377046, -168.70672649480116, -291.5826180443935, -64.80977442499315, -42.42101706408005, 44.62608120577094, -27.10553149682405, 32.048189590350454, -326.9652317251389, -195.32731820910587, 30.38338943765794, -79.85545862938633, -23.17240249438853, -329.6583262034389, 6.17614131754816, -10.28070961095682, -114.62905534107989, -127.5971010077946, -182.24378575346114, 50.03028613717659, -149.8085626740707, -4.313434109878143, -135.37103866006623, -37.143250646957995, -252.1646850319538, -37.239406060554124, -46.2195676336949, -68.52648595363993, -82.11752493292995, -193.05171743539222, -193.47532367922264, -163.52049420294196, -62.50668994423621, 84.80471700156382, -60.28571111510078, -224.0892005786813, 42.97986271517694, -128.0857165394887, -116.82718584141246, -164.91626811470175, 4.658358751859067, -173.38445852371513, -66.4206821002088, -232.16450118006506, -94.88383531103229, -89.80898790135979, 1.6499827844424166, -303.0816888896981, -4.953121579523122, 30.861716277788254, -46.095652636065935, 11.40418151291365, -135.35745422448892, -31.866959607701492, -28.765630682295765, -45.86772590986905, -96.8669539210525, 23.5833775841882, -184.96350873955672, -98.69803724717282, -41.005740987148755, -288.81984645915855, -139.25708174133894, -78.86827037472364, -208.50244815706574, -269.8149630295266, 134.75295883214983, -308.4456008297589, -97.49223025694897, -188.22523434291014, 48.03106260810362, -327.2398120598609, 2.9780464263357964, -92.15410670345008, -138.37967865864343, 39.93070269210275, -164.91138815654676, -203.74930762498988, -155.29554000234347, -142.56765123055155, -51.42806953947161, -250.57475116106215, 136.90563707418787, -193.35656937636358, -365.0843107864904, -110.86927907768677, 13.506019634920722, -123.4845594080471, -167.49317730152924, -92.5487339398489, -339.65017497452607, -164.17451682683998, -54.34684360005737, -133.39302330662048, -71.82656089842469, -206.58146957339378, 162.41755254222235, 111.71311044433514, -63.127733886201575, 56.41362132843381, 52.740691304162304, -6.1408953421589425, -134.40254615147083, -59.33814233897031, -56.28362480795757, -125.0910304265937, -129.24275413103985, -275.9656400198611, -241.9473876143604, -174.41461208390248, 18.023362277850293, -148.74120718604698, -53.939509875260434, -18.588067097449425, -85.31995095200736, -88.24914818618699, -52.50194836430018, 30.14167430768428, -15.843999332589028, -175.77664424072532, -42.776419295493255, -118.68984613686168, -177.0032156286378, 15.962857507808708, -65.3511488198279, 101.72865651002593, -201.896493676185, -178.00426287079824, 1.2531512109845835, 170.17238680720098, -11.339579275918354, 176.18877523279463, -199.20438401210944, 11.967080479185581, -6.307281243890035, -24.023189460287796, -18.974508350318203, -98.99294860276618, -194.25002712140093, -234.44022893986633, 159.65423715224367], "policy_predator_policy_reward": [75.61286692607949, 118.24031391599846, 138.44273872583318, 172.4699229139704, 186.7906794116159, 53.568058169898336, 142.80764527374672, 169.56188282268934, 170.72260984182108, 15.920373177348477, 98.45481674732164, 112.34321188501083, 192.50921427229608, 124.14167437056099, 327.50320292184915, 52.817624156946884, 230.5371996456358, 140.18164382858336, 181.77873666576343, 180.0260875239642, 76.29123547755879, 73.1209222729406, 154.81071292420464, 246.61573706774095, 222.954002084485, 147.82548278265256, 72.09438087420551, 85.90354321190455, 133.104900811555, 193.1319515799988, 167.42760614515166, 98.92691960935794, 44.11351445270678, 156.7490859600914, 31.071065300518995, 59.249576302499264, 77.72981882962047, 193.71983006179136, 62.368552259884304, 76.02544695241613, 46.181395524372086, 77.82754843109493, 84.32376248676633, 122.39179974027076, 408.5431510284154, 90.30079853133327, 96.67552171900184, 145.41580547059704, 219.3306951064499, 205.31388295892225, 181.32322691910778, 73.36550186493415, 157.27467064383035, 65.81242616197889, 114.50197635477282, 263.9723272226469, 91.71530408079758, 155.69692564302963, 417.81840765648644, 181.0731948038094, 298.663705330972, 202.68614813821634, 114.80911744904752, 53.78726196329599, 124.94285296487092, 75.74733081603654, 183.32106237985275, 196.19206567060374, 112.1670450428772, 127.50215206855796, 137.12656702274944, 79.79776377235618, 31.63951851477689, 331.7201279537785, 163.31294786346695, 10.376700724991336, 148.99710100779396, 190.54378575346078, 159.81320273886, 89.02132973873965, 117.74368959455873, 114.14651031630562, 73.96366230256547, 263.9994652710299, 55.445530508408, 71.22561085022674, 87.08897137505828, 124.82591159191712, 290.58506906178906, 239.41540060184036, 138.4645752697779, 164.10929546851438, 65.917932408509, 115.24469300155857, 199.28246918746038, 67.64339852364253, 155.007668938702, 194.01574970389467, 81.59493442206805, 168.93267179257867, 180.77240290698418, 156.55837299221753, 124.55914370353263, 249.07337386381735, 125.63747599936775, 23.63719297451032, 312.6925240030144, 18.996350459356346, 67.38255246263812, 5.651383895639884, 47.911460156415195, 163.8774299196343, 58.961362131927366, 99.52643779286784, 63.38318365471591, 86.10608444207563, 19.137040725921004, 195.65144197359214, 113.29803724717279, 75.00574098714877, 197.80191110189966, 268.806265661081, 172.5442553872114, 174.01697212305805, 266.4924416283949, 67.8915042404418, 258.95478259640896, 194.21927048698723, 97.7048133504822, 222.4627973520852, 294.78879137632697, 172.72028989214516, 101.91329948111778, 155.79570818563994, 203.717365497081, 109.77053280711407, 149.04783497853984, 237.687907737843, 162.02565759966689, 178.99357650514003, 101.25055743964307, 187.97904366922546, 247.49697703351475, 368.1843107864904, 106.3828407003355, 31.704576288916346, 139.7877432695545, 193.59317730152907, 166.88964891716614, 305.30259465158053, 36.251704156173254, 176.79616029837612, 146.35211311196136, 91.00819290031171, 24.649473393675557, 220.38146957339305, 14.999817241633604, 86.61480620023202, 8.285155345162307, 11.359308695837676, 75.23248942309148, 142.11135954063113, 125.16207304009454, 90.34992312008963, 195.9502409300579, 81.360258680843, 260.46736560358426, 265.0929373283443, 185.91461208390183, 0.0, 107.10722577532339, 193.73007155816424, 128.0941075434311, 69.36174765623382, 75.65086576843646, 101.5901508689018, 196.62151768035073, 0.0, 114.46607680189213, 111.96765464558507, 182.78339461837336, 159.9402377093671, 15.220647005737066, 112.00534847900303, 211.852656310354, 52.083297624764356, 137.9672019939317, 202.43755041110816, 12.627613192799018, 98.1395792759183, 31.251286108329214, 254.22641134375485, 6.65019639778411, 109.39008711112918, 26.020760143484868, 160.61813660443678, 217.57046856347833, 107.55348480125295, 223.98569217431972, 42.458904062365264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.093014239124397, "mean_inference_ms": 6.436672689800727, "mean_action_processing_ms": 5.151468804971755, "mean_env_wait_ms": 13.36457658334667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07235360145568848, "StateBufferConnector_ms": 0.03717827796936035, "ViewRequirementAgentConnector_ms": 0.30821502208709717}, "num_episodes": 18, "episode_return_max": 269.5999999999999, "episode_return_min": -5.473495972347568, "episode_return_mean": 90.5150288483579, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1036480, "num_agent_steps_trained": 1036480, "num_env_steps_sampled": 259120, "num_env_steps_trained": 259120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 68.20875500240052, "num_env_steps_trained_throughput_per_sec": 68.20875500240052, "timesteps_total": 259120, "num_env_steps_sampled_lifetime": 259120, "num_agent_steps_sampled_lifetime": 1036480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1036480, "timers": {"training_iteration_time_ms": 57454.602, "restore_workers_time_ms": 0.018, "training_step_time_ms": 57454.525, "sample_time_ms": 4363.814, "learn_time_ms": 53060.435, "learn_throughput": 75.386, "synch_weights_time_ms": 24.519}, "counters": {"num_env_steps_sampled": 259120, "num_env_steps_trained": 259120, "num_agent_steps_sampled": 1036480, "num_agent_steps_trained": 1036480}, "done": false, "training_iteration": 64, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-20-34", "timestamp": 1724151034, "time_this_iter_s": 58.69118785858154, "time_total_s": 3595.310522556305, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120b71550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3595.310522556305, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 55.503614457831326, "ram_util_percent": 83.39638554216867}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.48556414710151, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.343502341124116, "policy_loss": -0.017945287009225618, "vf_loss": 7.35906359884474, "vf_explained_var": 0.27298301354287163, "kl": 0.011920137852726002, "entropy": 0.7203709150748278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.6879456264632084, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.309946538783886, "policy_loss": -0.018123209653742534, "vf_loss": 6.3253131866455075, "vf_explained_var": 0.09153996157267737, "kl": 0.013782805960783094, "entropy": 0.703684542765693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 263120, "num_env_steps_trained": 263120, "num_agent_steps_sampled": 1052480, "num_agent_steps_trained": 1052480}, "env_runners": {"episode_reward_max": 269.5999999999999, "episode_reward_min": -5.473495972347568, "episode_reward_mean": 96.19900217436853, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -483.7127582554307, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 432.37682423011387}, "policy_reward_mean": {"prey_policy": -97.54943245352491, "predator_policy": 145.64893354070915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.27229571929843, 141.4921459246036, 31.155720667621015, 99.16194942982816, 53.35801727058299, 172.49023170892272, 52.29122847548841, 41.06050892999366, 61.36558792327027, 218.21073348985394, 84.59608591566759, 74.72526833998721, 113.89646967133055, 39.877461582664885, 48.779883636421545, 29.700000000000177, 149.05625594070548, 92.2057271409195, 48.655191894683576, 43.21216766438564, 61.270872080405475, 143.47342854901467, 76.54668659111461, 205.68163129653047, 85.8165298475987, 104.11051626169551, 90.26969685180384, 97.52563527527755, 46.58418107625287, 61.115663856961596, 23.654063993148917, 57.800000000000374, 87.83561736447349, 97.855209634798, 6.754588265870245, 53.408351544144686, 48.6000000000002, 38.53124856248382, 59.19050897848118, 199.32194167145792, 47.2362219966885, 179.97343896776036, 143.247315634946, 27.17522230466569, 188.507212839751, 27.690895089050002, 147.02351333478373, 175.56048702199428, 57.24040765715116, 40.72415754648677, 42.40318386150766, 39.99333465437214, -5.473495972347568, 32.14072180722854, 200.86702593589723, 150.1999999999993, 128.79877667359526, 76.80040747009272, 99.89022901325625, 22.97671505326869, 7.6472752977076155, 29.52336227785046, 98.15658027218063, 93.54783715020767, 36.489920086851065, 210.91919265544564, 7.880667911258477, 47.030570562241714, 77.83770417272075, 163.7681167689591, 163.65364074522606, 269.5999999999999, 262.46208867276926, 121.70008274420819, 143.6411989373153, 31.880977640564556, 191.65860444906244, 34.97476699834255, 167.59999999999923, 149.4031014364961, 120.32358150190677, 95.22984061455136, 20.66583182910671, 182.58828138499766, 87.45353241635635, 76.95373137737201, 77.403755219289, 226.32242977062072, 104.47470615630198, 124.89723037982432, 117.42845560174993, 78.88311305202937, 77.07297665247103, 94.1149771226532, 128.49624991585821, 213.89999999999952, 199.67560888668302, 32.515590392632035, 69.42475389692946, 78.81480856822168], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.23881891825411652, -202.05785038855467, -265.27766823949, -17.874763901277653, -183.48852648366133, -40.04448163276014, -24.31514141553314, -99.61000596044815, -244.21913816370102, -80.89714814313665, 9.568279589594617, -84.49027760449901, -483.7127582554307, -62.887615729377046, -168.70672649480116, -291.5826180443935, -64.80977442499315, -42.42101706408005, 44.62608120577094, -27.10553149682405, 32.048189590350454, -326.9652317251389, -195.32731820910587, 30.38338943765794, -79.85545862938633, -23.17240249438853, -329.6583262034389, 6.17614131754816, -10.28070961095682, -114.62905534107989, -127.5971010077946, -182.24378575346114, 50.03028613717659, -149.8085626740707, -4.313434109878143, -135.37103866006623, -37.143250646957995, -252.1646850319538, -37.239406060554124, -46.2195676336949, -68.52648595363993, -82.11752493292995, -193.05171743539222, -193.47532367922264, -163.52049420294196, -62.50668994423621, 84.80471700156382, -60.28571111510078, -224.0892005786813, 42.97986271517694, -128.0857165394887, -116.82718584141246, -164.91626811470175, 4.658358751859067, -173.38445852371513, -66.4206821002088, -232.16450118006506, -94.88383531103229, -89.80898790135979, 1.6499827844424166, -303.0816888896981, -4.953121579523122, 30.861716277788254, -46.095652636065935, 11.40418151291365, -135.35745422448892, -31.866959607701492, -28.765630682295765, -45.86772590986905, -96.8669539210525, 23.5833775841882, -184.96350873955672, -98.69803724717282, -41.005740987148755, -288.81984645915855, -139.25708174133894, -78.86827037472364, -208.50244815706574, -269.8149630295266, 134.75295883214983, -308.4456008297589, -97.49223025694897, -188.22523434291014, 48.03106260810362, -327.2398120598609, 2.9780464263357964, -92.15410670345008, -138.37967865864343, 39.93070269210275, -164.91138815654676, -203.74930762498988, -155.29554000234347, -142.56765123055155, -51.42806953947161, -250.57475116106215, 136.90563707418787, -193.35656937636358, -365.0843107864904, -110.86927907768677, 13.506019634920722, -123.4845594080471, -167.49317730152924, -92.5487339398489, -339.65017497452607, -164.17451682683998, -54.34684360005737, -133.39302330662048, -71.82656089842469, -206.58146957339378, 162.41755254222235, 111.71311044433514, -63.127733886201575, 56.41362132843381, 52.740691304162304, -6.1408953421589425, -134.40254615147083, -59.33814233897031, -56.28362480795757, -125.0910304265937, -129.24275413103985, -275.9656400198611, -241.9473876143604, -174.41461208390248, 18.023362277850293, -148.74120718604698, -53.939509875260434, -18.588067097449425, -85.31995095200736, -88.24914818618699, -52.50194836430018, 30.14167430768428, -15.843999332589028, -175.77664424072532, -42.776419295493255, -118.68984613686168, -177.0032156286378, 15.962857507808708, -65.3511488198279, 101.72865651002593, -201.896493676185, -178.00426287079824, 1.2531512109845835, 170.17238680720098, -11.339579275918354, 176.18877523279463, -199.20438401210944, 11.967080479185581, -6.307281243890035, -24.023189460287796, -18.974508350318203, -98.99294860276618, -194.25002712140093, -234.44022893986633, 159.65423715224367, -136.2537118126295, -137.91086619843634, 51.0132707203281, 97.0979471839296, -367.4716408302595, -12.771675071098004, -236.40212155598155, 84.6418313828531, -38.74298043378949, -139.1328298903956, -314.2219758756, -147.29891055452958, 53.798359559439476, -418.007924577908, -71.35788728307325, -138.53067502468852, -157.8339793626305, -26.081408002395804, -84.97243309103345, -196.7599680661319, -371.46832100593474, 50.15444968708793, -236.9362982169843, -22.763378888966763, -9.156651828347142, -99.88480153202822, 17.81880203713525, -382.1180000192819, -152.29548028121712, -296.5519635470423, -198.33300628618284, -66.79654171086348, -129.33871410440005, -284.31813137192495, -79.14152537043243, -46.32643639617606, 200.0, -79.7933629732709, 165.94681833375586, -101.46914306905974, -163.75834501707777, -130.18218180156111, -138.25870768376686, -52.472303571519575, -138.89368313259635, -72.06376148410156], "policy_predator_policy_reward": [96.67552171900184, 145.41580547059704, 219.3306951064499, 205.31388295892225, 181.32322691910778, 73.36550186493415, 157.27467064383035, 65.81242616197889, 114.50197635477282, 263.9723272226469, 91.71530408079758, 155.69692564302963, 417.81840765648644, 181.0731948038094, 298.663705330972, 202.68614813821634, 114.80911744904752, 53.78726196329599, 124.94285296487092, 75.74733081603654, 183.32106237985275, 196.19206567060374, 112.1670450428772, 127.50215206855796, 137.12656702274944, 79.79776377235618, 31.63951851477689, 331.7201279537785, 163.31294786346695, 10.376700724991336, 148.99710100779396, 190.54378575346078, 159.81320273886, 89.02132973873965, 117.74368959455873, 114.14651031630562, 73.96366230256547, 263.9994652710299, 55.445530508408, 71.22561085022674, 87.08897137505828, 124.82591159191712, 290.58506906178906, 239.41540060184036, 138.4645752697779, 164.10929546851438, 65.917932408509, 115.24469300155857, 199.28246918746038, 67.64339852364253, 155.007668938702, 194.01574970389467, 81.59493442206805, 168.93267179257867, 180.77240290698418, 156.55837299221753, 124.55914370353263, 249.07337386381735, 125.63747599936775, 23.63719297451032, 312.6925240030144, 18.996350459356346, 67.38255246263812, 5.651383895639884, 47.911460156415195, 163.8774299196343, 58.961362131927366, 99.52643779286784, 63.38318365471591, 86.10608444207563, 19.137040725921004, 195.65144197359214, 113.29803724717279, 75.00574098714877, 197.80191110189966, 268.806265661081, 172.5442553872114, 174.01697212305805, 266.4924416283949, 67.8915042404418, 258.95478259640896, 194.21927048698723, 97.7048133504822, 222.4627973520852, 294.78879137632697, 172.72028989214516, 101.91329948111778, 155.79570818563994, 203.717365497081, 109.77053280711407, 149.04783497853984, 237.687907737843, 162.02565759966689, 178.99357650514003, 101.25055743964307, 187.97904366922546, 247.49697703351475, 368.1843107864904, 106.3828407003355, 31.704576288916346, 139.7877432695545, 193.59317730152907, 166.88964891716614, 305.30259465158053, 36.251704156173254, 176.79616029837612, 146.35211311196136, 91.00819290031171, 24.649473393675557, 220.38146957339305, 14.999817241633604, 86.61480620023202, 8.285155345162307, 11.359308695837676, 75.23248942309148, 142.11135954063113, 125.16207304009454, 90.34992312008963, 195.9502409300579, 81.360258680843, 260.46736560358426, 265.0929373283443, 185.91461208390183, 0.0, 107.10722577532339, 193.73007155816424, 128.0941075434311, 69.36174765623382, 75.65086576843646, 101.5901508689018, 196.62151768035073, 0.0, 114.46607680189213, 111.96765464558507, 182.78339461837336, 159.9402377093671, 15.220647005737066, 112.00534847900303, 211.852656310354, 52.083297624764356, 137.9672019939317, 202.43755041110816, 12.627613192799018, 98.1395792759183, 31.251286108329214, 254.22641134375485, 6.65019639778411, 109.39008711112918, 26.020760143484868, 160.61813660443678, 217.57046856347833, 107.55348480125295, 223.98569217431972, 42.458904062365264, 190.27190974161127, 118.8674352677966, 3.6867292796718774, 15.802052816070004, 432.37682423011387, 97.26959310774002, 66.68707803054275, 205.3967936444925, 122.24807559981599, 150.85757533892, 290.9315346558859, 191.255183603351, 118.5504497246782, 428.2473966787883, 128.20506923773246, 169.137025486385, 134.86909992271947, 126.0000188196789, 179.98690353760605, 179.14925283884756, 227.73474344558912, 319.9015576438788, 224.56743103924333, 139.60695222300964, 148.22950653348144, 85.7091772067183, 349.7295255582881, 131.99812802560857, 190.36378281196062, 337.36677406832814, 48.78043878766166, 293.42208586185603, 177.80419953258115, 329.96762306639675, 120.46704513119167, 133.4971665512752, 0.0, 93.69336297327105, 16.073514173059017, 119.12441944892785, 172.99436170344129, 153.4617555078292, 212.65290183502552, 47.50286331718978, 130.18740744082024, 159.58484574409857]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.059187863502045, "mean_inference_ms": 6.3992269787375085, "mean_action_processing_ms": 5.342952016747851, "mean_env_wait_ms": 13.401608589996776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006315469741821289, "StateBufferConnector_ms": 0.03594183921813965, "ViewRequirementAgentConnector_ms": 0.24879348278045654}, "num_episodes": 23, "episode_return_max": 269.5999999999999, "episode_return_min": -5.473495972347568, "episode_return_mean": 96.19900217436853, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1052480, "num_agent_steps_trained": 1052480, "num_env_steps_sampled": 263120, "num_env_steps_trained": 263120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.22306949611082, "num_env_steps_trained_throughput_per_sec": 70.22306949611082, "timesteps_total": 263120, "num_env_steps_sampled_lifetime": 263120, "num_agent_steps_sampled_lifetime": 1052480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1052480, "timers": {"training_iteration_time_ms": 57357.196, "restore_workers_time_ms": 0.018, "training_step_time_ms": 57357.123, "sample_time_ms": 4435.14, "learn_time_ms": 52892.062, "learn_throughput": 75.626, "synch_weights_time_ms": 25.043}, "counters": {"num_env_steps_sampled": 263120, "num_env_steps_trained": 263120, "num_agent_steps_sampled": 1052480, "num_agent_steps_trained": 1052480}, "done": false, "training_iteration": 65, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-21-31", "timestamp": 1724151091, "time_this_iter_s": 57.01033020019531, "time_total_s": 3652.3208527565002, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33132be50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3652.3208527565002, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 54.685, "ram_util_percent": 83.39874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.567068048507448, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.072947072730494, "policy_loss": -0.015407853777564708, "vf_loss": 7.085905892508371, "vf_explained_var": 0.1141987216851068, "kl": 0.012245197877874254, "entropy": 0.6824686660968438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.326402520313465, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.823174221805795, "policy_loss": -0.015811778829930716, "vf_loss": 5.836450276299129, "vf_explained_var": 0.07828844290561777, "kl": 0.012678616752641068, "entropy": 0.7327194864157016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 267120, "num_env_steps_trained": 267120, "num_agent_steps_sampled": 1068480, "num_agent_steps_trained": 1068480}, "env_runners": {"episode_reward_max": 269.5999999999999, "episode_reward_min": -5.473495972347568, "episode_reward_mean": 96.06051700632342, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -418.007924577908, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 432.37682423011387}, "policy_reward_mean": {"prey_policy": -97.71914591086858, "predator_policy": 145.74940441403024}, "custom_metrics": {}, "hist_stats": {"episode_reward": [205.68163129653047, 85.8165298475987, 104.11051626169551, 90.26969685180384, 97.52563527527755, 46.58418107625287, 61.115663856961596, 23.654063993148917, 57.800000000000374, 87.83561736447349, 97.855209634798, 6.754588265870245, 53.408351544144686, 48.6000000000002, 38.53124856248382, 59.19050897848118, 199.32194167145792, 47.2362219966885, 179.97343896776036, 143.247315634946, 27.17522230466569, 188.507212839751, 27.690895089050002, 147.02351333478373, 175.56048702199428, 57.24040765715116, 40.72415754648677, 42.40318386150766, 39.99333465437214, -5.473495972347568, 32.14072180722854, 200.86702593589723, 150.1999999999993, 128.79877667359526, 76.80040747009272, 99.89022901325625, 22.97671505326869, 7.6472752977076155, 29.52336227785046, 98.15658027218063, 93.54783715020767, 36.489920086851065, 210.91919265544564, 7.880667911258477, 47.030570562241714, 77.83770417272075, 163.7681167689591, 163.65364074522606, 269.5999999999999, 262.46208867276926, 121.70008274420819, 143.6411989373153, 31.880977640564556, 191.65860444906244, 34.97476699834255, 167.59999999999923, 149.4031014364961, 120.32358150190677, 95.22984061455136, 20.66583182910671, 182.58828138499766, 87.45353241635635, 76.95373137737201, 77.403755219289, 226.32242977062072, 104.47470615630198, 124.89723037982432, 117.42845560174993, 78.88311305202937, 77.07297665247103, 94.1149771226532, 128.49624991585821, 213.89999999999952, 199.67560888668302, 32.515590392632035, 69.42475389692946, 78.81480856822168, 59.93268101183198, 113.51216879649294, 84.0272782047467, 132.22492619788585, 38.83905248227085, 62.43105246467856, 128.02810260489568, 106.51045330361126, 112.88024075732481, 125.90743458899995, 207.63792511513492, 126.76320145827398, 61.08155397165865, -2.1941963488898812, 44.70850898536403, 108.98651652558912, 84.42087129996946, 1.3186087184576334, 58.15089755191388, 69.75232263983682, 64.2138769107311, 73.12329895961413, 40.748625541860115], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [84.80471700156382, -60.28571111510078, -224.0892005786813, 42.97986271517694, -128.0857165394887, -116.82718584141246, -164.91626811470175, 4.658358751859067, -173.38445852371513, -66.4206821002088, -232.16450118006506, -94.88383531103229, -89.80898790135979, 1.6499827844424166, -303.0816888896981, -4.953121579523122, 30.861716277788254, -46.095652636065935, 11.40418151291365, -135.35745422448892, -31.866959607701492, -28.765630682295765, -45.86772590986905, -96.8669539210525, 23.5833775841882, -184.96350873955672, -98.69803724717282, -41.005740987148755, -288.81984645915855, -139.25708174133894, -78.86827037472364, -208.50244815706574, -269.8149630295266, 134.75295883214983, -308.4456008297589, -97.49223025694897, -188.22523434291014, 48.03106260810362, -327.2398120598609, 2.9780464263357964, -92.15410670345008, -138.37967865864343, 39.93070269210275, -164.91138815654676, -203.74930762498988, -155.29554000234347, -142.56765123055155, -51.42806953947161, -250.57475116106215, 136.90563707418787, -193.35656937636358, -365.0843107864904, -110.86927907768677, 13.506019634920722, -123.4845594080471, -167.49317730152924, -92.5487339398489, -339.65017497452607, -164.17451682683998, -54.34684360005737, -133.39302330662048, -71.82656089842469, -206.58146957339378, 162.41755254222235, 111.71311044433514, -63.127733886201575, 56.41362132843381, 52.740691304162304, -6.1408953421589425, -134.40254615147083, -59.33814233897031, -56.28362480795757, -125.0910304265937, -129.24275413103985, -275.9656400198611, -241.9473876143604, -174.41461208390248, 18.023362277850293, -148.74120718604698, -53.939509875260434, -18.588067097449425, -85.31995095200736, -88.24914818618699, -52.50194836430018, 30.14167430768428, -15.843999332589028, -175.77664424072532, -42.776419295493255, -118.68984613686168, -177.0032156286378, 15.962857507808708, -65.3511488198279, 101.72865651002593, -201.896493676185, -178.00426287079824, 1.2531512109845835, 170.17238680720098, -11.339579275918354, 176.18877523279463, -199.20438401210944, 11.967080479185581, -6.307281243890035, -24.023189460287796, -18.974508350318203, -98.99294860276618, -194.25002712140093, -234.44022893986633, 159.65423715224367, -136.2537118126295, -137.91086619843634, 51.0132707203281, 97.0979471839296, -367.4716408302595, -12.771675071098004, -236.40212155598155, 84.6418313828531, -38.74298043378949, -139.1328298903956, -314.2219758756, -147.29891055452958, 53.798359559439476, -418.007924577908, -71.35788728307325, -138.53067502468852, -157.8339793626305, -26.081408002395804, -84.97243309103345, -196.7599680661319, -371.46832100593474, 50.15444968708793, -236.9362982169843, -22.763378888966763, -9.156651828347142, -99.88480153202822, 17.81880203713525, -382.1180000192819, -152.29548028121712, -296.5519635470423, -198.33300628618284, -66.79654171086348, -129.33871410440005, -284.31813137192495, -79.14152537043243, -46.32643639617606, 200.0, -79.7933629732709, 165.94681833375586, -101.46914306905974, -163.75834501707777, -130.18218180156111, -138.25870768376686, -52.472303571519575, -138.89368313259635, -72.06376148410156, -14.990513672867293, -191.2500904848017, -45.33937714338472, -185.93576008875837, -162.48238656085556, -180.86652741371597, -32.57968966719255, -247.44438375988415, -63.618112902882146, 20.000000000000014, -129.09342391539235, -93.03033932142493, -101.22658134785988, -70.19880176286631, -186.5013869170166, -42.4621182157873, -43.7301866815224, -51.340877134490185, -187.24778123765253, -22.863456373871795, 12.465429152813513, 30.329324186270426, -136.8214646187639, 38.13968398605599, -98.14738626009112, 0.2383212367748815, -124.48979644886309, -120.52006535819002, -20.49358321774178, -254.28768498057747, -45.88668113848753, -130.22830753684988, 24.636265756742596, -187.98269014983185, -110.32239999750867, -58.911301762883326, -87.65672472665491, -127.98731579321583, -154.86347436778752, -251.17789534196723, -129.4819395407882, -299.76563035230913, -139.74491115078217, -291.694899548436, -274.7491778485237, -87.95401823180659], "policy_predator_policy_reward": [65.917932408509, 115.24469300155857, 199.28246918746038, 67.64339852364253, 155.007668938702, 194.01574970389467, 81.59493442206805, 168.93267179257867, 180.77240290698418, 156.55837299221753, 124.55914370353263, 249.07337386381735, 125.63747599936775, 23.63719297451032, 312.6925240030144, 18.996350459356346, 67.38255246263812, 5.651383895639884, 47.911460156415195, 163.8774299196343, 58.961362131927366, 99.52643779286784, 63.38318365471591, 86.10608444207563, 19.137040725921004, 195.65144197359214, 113.29803724717279, 75.00574098714877, 197.80191110189966, 268.806265661081, 172.5442553872114, 174.01697212305805, 266.4924416283949, 67.8915042404418, 258.95478259640896, 194.21927048698723, 97.7048133504822, 222.4627973520852, 294.78879137632697, 172.72028989214516, 101.91329948111778, 155.79570818563994, 203.717365497081, 109.77053280711407, 149.04783497853984, 237.687907737843, 162.02565759966689, 178.99357650514003, 101.25055743964307, 187.97904366922546, 247.49697703351475, 368.1843107864904, 106.3828407003355, 31.704576288916346, 139.7877432695545, 193.59317730152907, 166.88964891716614, 305.30259465158053, 36.251704156173254, 176.79616029837612, 146.35211311196136, 91.00819290031171, 24.649473393675557, 220.38146957339305, 14.999817241633604, 86.61480620023202, 8.285155345162307, 11.359308695837676, 75.23248942309148, 142.11135954063113, 125.16207304009454, 90.34992312008963, 195.9502409300579, 81.360258680843, 260.46736560358426, 265.0929373283443, 185.91461208390183, 0.0, 107.10722577532339, 193.73007155816424, 128.0941075434311, 69.36174765623382, 75.65086576843646, 101.5901508689018, 196.62151768035073, 0.0, 114.46607680189213, 111.96765464558507, 182.78339461837336, 159.9402377093671, 15.220647005737066, 112.00534847900303, 211.852656310354, 52.083297624764356, 137.9672019939317, 202.43755041110816, 12.627613192799018, 98.1395792759183, 31.251286108329214, 254.22641134375485, 6.65019639778411, 109.39008711112918, 26.020760143484868, 160.61813660443678, 217.57046856347833, 107.55348480125295, 223.98569217431972, 42.458904062365264, 190.27190974161127, 118.8674352677966, 3.6867292796718774, 15.802052816070004, 432.37682423011387, 97.26959310774002, 66.68707803054275, 205.3967936444925, 122.24807559981599, 150.85757533892, 290.9315346558859, 191.255183603351, 118.5504497246782, 428.2473966787883, 128.20506923773246, 169.137025486385, 134.86909992271947, 126.0000188196789, 179.98690353760605, 179.14925283884756, 227.73474344558912, 319.9015576438788, 224.56743103924333, 139.60695222300964, 148.22950653348144, 85.7091772067183, 349.7295255582881, 131.99812802560857, 190.36378281196062, 337.36677406832814, 48.78043878766166, 293.42208586185603, 177.80419953258115, 329.96762306639675, 120.46704513119167, 133.4971665512752, 0.0, 93.69336297327105, 16.073514173059017, 119.12441944892785, 172.99436170344129, 153.4617555078292, 212.65290183502552, 47.50286331718978, 130.18740744082024, 159.58484574409857, 179.1656560626722, 87.00762910682832, 117.42893143091086, 227.35837459772497, 216.15786596005415, 211.21832621926393, 235.44428298662274, 176.80471663834032, 75.39587254857118, 7.061292836580995, 64.46799304510013, 220.0868226563952, 136.75208075515772, 162.70140496046395, 212.27818908717256, 123.19576934924234, 89.7305906398883, 118.22071393344946, 183.497170740016, 152.52150146050826, 81.97693754723083, 82.86623422881993, 139.72423112169471, 85.72075096928752, 115.49289301753281, 43.49772597744193, 62.142104434329305, 180.67356102383374, 65.61443327014551, 253.87534391353762, 138.13293583758724, 146.96856936333896, 97.23810204059714, 150.52919365246152, 137.95636899065545, 32.59594148819389, 203.29562556738327, 70.49931250440059, 268.4377875291909, 207.35590482040024, 164.42133318740795, 329.040113616421, 178.6292943222621, 325.9338153365707, 232.8878697638997, 170.5639518582895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.028913048061211, "mean_inference_ms": 6.379992459879756, "mean_action_processing_ms": 5.33307245542038, "mean_env_wait_ms": 13.418345397883279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007246494293212891, "StateBufferConnector_ms": 0.031138181686401367, "ViewRequirementAgentConnector_ms": 0.25552666187286377}, "num_episodes": 23, "episode_return_max": 269.5999999999999, "episode_return_min": -5.473495972347568, "episode_return_mean": 96.06051700632342, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068480, "num_agent_steps_trained": 1068480, "num_env_steps_sampled": 267120, "num_env_steps_trained": 267120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.53094902178462, "num_env_steps_trained_throughput_per_sec": 69.53094902178462, "timesteps_total": 267120, "num_env_steps_sampled_lifetime": 267120, "num_agent_steps_sampled_lifetime": 1068480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1068480, "timers": {"training_iteration_time_ms": 57140.368, "restore_workers_time_ms": 0.018, "training_step_time_ms": 57140.278, "sample_time_ms": 4482.959, "learn_time_ms": 52627.768, "learn_throughput": 76.006, "synch_weights_time_ms": 24.709}, "counters": {"num_env_steps_sampled": 267120, "num_env_steps_trained": 267120, "num_agent_steps_sampled": 1068480, "num_agent_steps_trained": 1068480}, "done": false, "training_iteration": 66, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-22-28", "timestamp": 1724151148, "time_this_iter_s": 57.58922028541565, "time_total_s": 3709.910073041916, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120b843a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3709.910073041916, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 53.45679012345679, "ram_util_percent": 83.30864197530865}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.887571821578597, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.535714792574524, "policy_loss": -0.017389639442116415, "vf_loss": 7.550554311590851, "vf_explained_var": 0.23314663146538708, "kl": 0.012750588278483264, "entropy": 0.6621961919403581, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.434076034644294, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.485145741165, "policy_loss": -0.01396549485214843, "vf_loss": 6.497100711751867, "vf_explained_var": 0.08328669626246053, "kl": 0.01005263572888912, "entropy": 0.6723281108828448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 271120, "num_env_steps_trained": 271120, "num_agent_steps_sampled": 1084480, "num_agent_steps_trained": 1084480}, "env_runners": {"episode_reward_max": 309.5624025127498, "episode_reward_min": -5.473495972347568, "episode_reward_mean": 98.47300046530296, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -418.007924577908, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 432.37682423011387}, "policy_reward_mean": {"prey_policy": -100.0018898172062, "predator_policy": 149.23839004985763}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.53124856248382, 59.19050897848118, 199.32194167145792, 47.2362219966885, 179.97343896776036, 143.247315634946, 27.17522230466569, 188.507212839751, 27.690895089050002, 147.02351333478373, 175.56048702199428, 57.24040765715116, 40.72415754648677, 42.40318386150766, 39.99333465437214, -5.473495972347568, 32.14072180722854, 200.86702593589723, 150.1999999999993, 128.79877667359526, 76.80040747009272, 99.89022901325625, 22.97671505326869, 7.6472752977076155, 29.52336227785046, 98.15658027218063, 93.54783715020767, 36.489920086851065, 210.91919265544564, 7.880667911258477, 47.030570562241714, 77.83770417272075, 163.7681167689591, 163.65364074522606, 269.5999999999999, 262.46208867276926, 121.70008274420819, 143.6411989373153, 31.880977640564556, 191.65860444906244, 34.97476699834255, 167.59999999999923, 149.4031014364961, 120.32358150190677, 95.22984061455136, 20.66583182910671, 182.58828138499766, 87.45353241635635, 76.95373137737201, 77.403755219289, 226.32242977062072, 104.47470615630198, 124.89723037982432, 117.42845560174993, 78.88311305202937, 77.07297665247103, 94.1149771226532, 128.49624991585821, 213.89999999999952, 199.67560888668302, 32.515590392632035, 69.42475389692946, 78.81480856822168, 59.93268101183198, 113.51216879649294, 84.0272782047467, 132.22492619788585, 38.83905248227085, 62.43105246467856, 128.02810260489568, 106.51045330361126, 112.88024075732481, 125.90743458899995, 207.63792511513492, 126.76320145827398, 61.08155397165865, -2.1941963488898812, 44.70850898536403, 108.98651652558912, 84.42087129996946, 1.3186087184576334, 58.15089755191388, 69.75232263983682, 64.2138769107311, 73.12329895961413, 40.748625541860115, 45.6052601782618, 50.40091418828018, 95.7070139907595, 38.20000000000027, 38.480572381745915, 86.72105881802318, 42.5395771816865, 33.52945570709379, 309.5624025127498, 94.9290391498643, 83.46301252490932, 187.4227005639599, 129.74381398781287, 71.95520998136213], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-288.81984645915855, -139.25708174133894, -78.86827037472364, -208.50244815706574, -269.8149630295266, 134.75295883214983, -308.4456008297589, -97.49223025694897, -188.22523434291014, 48.03106260810362, -327.2398120598609, 2.9780464263357964, -92.15410670345008, -138.37967865864343, 39.93070269210275, -164.91138815654676, -203.74930762498988, -155.29554000234347, -142.56765123055155, -51.42806953947161, -250.57475116106215, 136.90563707418787, -193.35656937636358, -365.0843107864904, -110.86927907768677, 13.506019634920722, -123.4845594080471, -167.49317730152924, -92.5487339398489, -339.65017497452607, -164.17451682683998, -54.34684360005737, -133.39302330662048, -71.82656089842469, -206.58146957339378, 162.41755254222235, 111.71311044433514, -63.127733886201575, 56.41362132843381, 52.740691304162304, -6.1408953421589425, -134.40254615147083, -59.33814233897031, -56.28362480795757, -125.0910304265937, -129.24275413103985, -275.9656400198611, -241.9473876143604, -174.41461208390248, 18.023362277850293, -148.74120718604698, -53.939509875260434, -18.588067097449425, -85.31995095200736, -88.24914818618699, -52.50194836430018, 30.14167430768428, -15.843999332589028, -175.77664424072532, -42.776419295493255, -118.68984613686168, -177.0032156286378, 15.962857507808708, -65.3511488198279, 101.72865651002593, -201.896493676185, -178.00426287079824, 1.2531512109845835, 170.17238680720098, -11.339579275918354, 176.18877523279463, -199.20438401210944, 11.967080479185581, -6.307281243890035, -24.023189460287796, -18.974508350318203, -98.99294860276618, -194.25002712140093, -234.44022893986633, 159.65423715224367, -136.2537118126295, -137.91086619843634, 51.0132707203281, 97.0979471839296, -367.4716408302595, -12.771675071098004, -236.40212155598155, 84.6418313828531, -38.74298043378949, -139.1328298903956, -314.2219758756, -147.29891055452958, 53.798359559439476, -418.007924577908, -71.35788728307325, -138.53067502468852, -157.8339793626305, -26.081408002395804, -84.97243309103345, -196.7599680661319, -371.46832100593474, 50.15444968708793, -236.9362982169843, -22.763378888966763, -9.156651828347142, -99.88480153202822, 17.81880203713525, -382.1180000192819, -152.29548028121712, -296.5519635470423, -198.33300628618284, -66.79654171086348, -129.33871410440005, -284.31813137192495, -79.14152537043243, -46.32643639617606, 200.0, -79.7933629732709, 165.94681833375586, -101.46914306905974, -163.75834501707777, -130.18218180156111, -138.25870768376686, -52.472303571519575, -138.89368313259635, -72.06376148410156, -14.990513672867293, -191.2500904848017, -45.33937714338472, -185.93576008875837, -162.48238656085556, -180.86652741371597, -32.57968966719255, -247.44438375988415, -63.618112902882146, 20.000000000000014, -129.09342391539235, -93.03033932142493, -101.22658134785988, -70.19880176286631, -186.5013869170166, -42.4621182157873, -43.7301866815224, -51.340877134490185, -187.24778123765253, -22.863456373871795, 12.465429152813513, 30.329324186270426, -136.8214646187639, 38.13968398605599, -98.14738626009112, 0.2383212367748815, -124.48979644886309, -120.52006535819002, -20.49358321774178, -254.28768498057747, -45.88668113848753, -130.22830753684988, 24.636265756742596, -187.98269014983185, -110.32239999750867, -58.911301762883326, -87.65672472665491, -127.98731579321583, -154.86347436778752, -251.17789534196723, -129.4819395407882, -299.76563035230913, -139.74491115078217, -291.694899548436, -274.7491778485237, -87.95401823180659, -8.607508420572824, -271.5358126128899, 12.186962313302102, -281.44204736881807, -12.764660460063816, -247.0840893424894, 15.584848968984456, 7.339632731200341, -71.52319547772694, -57.921817227297225, -297.8138862306986, 1.1908991964959357, 10.663015120260216, -105.68518893223406, -270.7100419401798, -130.87740761572582, -73.42195000682389, 186.13879796775012, -23.514260474170765, -35.44997231398913, -67.91268059423388, -196.55465702598323, 131.12663423493956, -146.7948803307919, -295.4979178521266, -62.40080188459477, -263.9347060166669, -67.77891467478983], "policy_predator_policy_reward": [197.80191110189966, 268.806265661081, 172.5442553872114, 174.01697212305805, 266.4924416283949, 67.8915042404418, 258.95478259640896, 194.21927048698723, 97.7048133504822, 222.4627973520852, 294.78879137632697, 172.72028989214516, 101.91329948111778, 155.79570818563994, 203.717365497081, 109.77053280711407, 149.04783497853984, 237.687907737843, 162.02565759966689, 178.99357650514003, 101.25055743964307, 187.97904366922546, 247.49697703351475, 368.1843107864904, 106.3828407003355, 31.704576288916346, 139.7877432695545, 193.59317730152907, 166.88964891716614, 305.30259465158053, 36.251704156173254, 176.79616029837612, 146.35211311196136, 91.00819290031171, 24.649473393675557, 220.38146957339305, 14.999817241633604, 86.61480620023202, 8.285155345162307, 11.359308695837676, 75.23248942309148, 142.11135954063113, 125.16207304009454, 90.34992312008963, 195.9502409300579, 81.360258680843, 260.46736560358426, 265.0929373283443, 185.91461208390183, 0.0, 107.10722577532339, 193.73007155816424, 128.0941075434311, 69.36174765623382, 75.65086576843646, 101.5901508689018, 196.62151768035073, 0.0, 114.46607680189213, 111.96765464558507, 182.78339461837336, 159.9402377093671, 15.220647005737066, 112.00534847900303, 211.852656310354, 52.083297624764356, 137.9672019939317, 202.43755041110816, 12.627613192799018, 98.1395792759183, 31.251286108329214, 254.22641134375485, 6.65019639778411, 109.39008711112918, 26.020760143484868, 160.61813660443678, 217.57046856347833, 107.55348480125295, 223.98569217431972, 42.458904062365264, 190.27190974161127, 118.8674352677966, 3.6867292796718774, 15.802052816070004, 432.37682423011387, 97.26959310774002, 66.68707803054275, 205.3967936444925, 122.24807559981599, 150.85757533892, 290.9315346558859, 191.255183603351, 118.5504497246782, 428.2473966787883, 128.20506923773246, 169.137025486385, 134.86909992271947, 126.0000188196789, 179.98690353760605, 179.14925283884756, 227.73474344558912, 319.9015576438788, 224.56743103924333, 139.60695222300964, 148.22950653348144, 85.7091772067183, 349.7295255582881, 131.99812802560857, 190.36378281196062, 337.36677406832814, 48.78043878766166, 293.42208586185603, 177.80419953258115, 329.96762306639675, 120.46704513119167, 133.4971665512752, 0.0, 93.69336297327105, 16.073514173059017, 119.12441944892785, 172.99436170344129, 153.4617555078292, 212.65290183502552, 47.50286331718978, 130.18740744082024, 159.58484574409857, 179.1656560626722, 87.00762910682832, 117.42893143091086, 227.35837459772497, 216.15786596005415, 211.21832621926393, 235.44428298662274, 176.80471663834032, 75.39587254857118, 7.061292836580995, 64.46799304510013, 220.0868226563952, 136.75208075515772, 162.70140496046395, 212.27818908717256, 123.19576934924234, 89.7305906398883, 118.22071393344946, 183.497170740016, 152.52150146050826, 81.97693754723083, 82.86623422881993, 139.72423112169471, 85.72075096928752, 115.49289301753281, 43.49772597744193, 62.142104434329305, 180.67356102383374, 65.61443327014551, 253.87534391353762, 138.13293583758724, 146.96856936333896, 97.23810204059714, 150.52919365246152, 137.95636899065545, 32.59594148819389, 203.29562556738327, 70.49931250440059, 268.4377875291909, 207.35590482040024, 164.42133318740795, 329.040113616421, 178.6292943222621, 325.9338153365707, 232.8878697638997, 170.5639518582895, 62.50364419880559, 263.24493701291874, 136.4999943929603, 183.1560048508355, 191.53571252139898, 164.02005127191376, 3.915151031015508, 11.36036726879963, 97.11938981861844, 70.80619526815072, 240.91046282987477, 142.43358302235146, 90.90501200748584, 46.65673898617411, 253.72299894018207, 181.3939063228175, 93.70963240139437, 103.1359221504292, 109.17716515678299, 44.71610678124173, 259.9308196994736, 87.99953044565261, 110.87716963574942, 92.21377702406261, 219.66763890936923, 267.97489481516527, 211.89913656508932, 191.76969410772935]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.080408493426381, "mean_inference_ms": 6.418363151665578, "mean_action_processing_ms": 4.533855116999984, "mean_env_wait_ms": 13.444164222412937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006517171859741211, "StateBufferConnector_ms": 0.026877522468566895, "ViewRequirementAgentConnector_ms": 0.2122248411178589}, "num_episodes": 14, "episode_return_max": 309.5624025127498, "episode_return_min": -5.473495972347568, "episode_return_mean": 98.47300046530296, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1084480, "num_agent_steps_trained": 1084480, "num_env_steps_sampled": 271120, "num_env_steps_trained": 271120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.6000411164094, "num_env_steps_trained_throughput_per_sec": 70.6000411164094, "timesteps_total": 271120, "num_env_steps_sampled_lifetime": 271120, "num_agent_steps_sampled_lifetime": 1084480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1084480, "timers": {"training_iteration_time_ms": 56856.07, "restore_workers_time_ms": 0.018, "training_step_time_ms": 56855.972, "sample_time_ms": 4212.313, "learn_time_ms": 52613.585, "learn_throughput": 76.026, "synch_weights_time_ms": 25.025}, "counters": {"num_env_steps_sampled": 271120, "num_env_steps_trained": 271120, "num_agent_steps_sampled": 1084480, "num_agent_steps_trained": 1084480}, "done": false, "training_iteration": 67, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-23-25", "timestamp": 1724151205, "time_this_iter_s": 56.75127601623535, "time_total_s": 3766.6613490581512, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12002b040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3766.6613490581512, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 54.973749999999995, "ram_util_percent": 83.4125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.832139694375336, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.730202483373975, "policy_loss": -0.016794083216079763, "vf_loss": 7.744759946399265, "vf_explained_var": 0.17957438170594514, "kl": 0.011183220031548036, "entropy": 0.6474645697881305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.28149090607961, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.606231101101669, "policy_loss": -0.01612243837129975, "vf_loss": 6.620267707582504, "vf_explained_var": 0.03693313046737953, "kl": 0.010429184718387665, "entropy": 0.7099376329669246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 275120, "num_env_steps_trained": 275120, "num_agent_steps_sampled": 1100480, "num_agent_steps_trained": 1100480}, "env_runners": {"episode_reward_max": 309.5624025127498, "episode_reward_min": -2.1941963488898812, "episode_reward_mean": 95.25409682427363, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -418.007924577908, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 432.37682423011387}, "policy_reward_mean": {"prey_policy": -103.12565163380941, "predator_policy": 150.75270004594617}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.97671505326869, 7.6472752977076155, 29.52336227785046, 98.15658027218063, 93.54783715020767, 36.489920086851065, 210.91919265544564, 7.880667911258477, 47.030570562241714, 77.83770417272075, 163.7681167689591, 163.65364074522606, 269.5999999999999, 262.46208867276926, 121.70008274420819, 143.6411989373153, 31.880977640564556, 191.65860444906244, 34.97476699834255, 167.59999999999923, 149.4031014364961, 120.32358150190677, 95.22984061455136, 20.66583182910671, 182.58828138499766, 87.45353241635635, 76.95373137737201, 77.403755219289, 226.32242977062072, 104.47470615630198, 124.89723037982432, 117.42845560174993, 78.88311305202937, 77.07297665247103, 94.1149771226532, 128.49624991585821, 213.89999999999952, 199.67560888668302, 32.515590392632035, 69.42475389692946, 78.81480856822168, 59.93268101183198, 113.51216879649294, 84.0272782047467, 132.22492619788585, 38.83905248227085, 62.43105246467856, 128.02810260489568, 106.51045330361126, 112.88024075732481, 125.90743458899995, 207.63792511513492, 126.76320145827398, 61.08155397165865, -2.1941963488898812, 44.70850898536403, 108.98651652558912, 84.42087129996946, 1.3186087184576334, 58.15089755191388, 69.75232263983682, 64.2138769107311, 73.12329895961413, 40.748625541860115, 45.6052601782618, 50.40091418828018, 95.7070139907595, 38.20000000000027, 38.480572381745915, 86.72105881802318, 42.5395771816865, 33.52945570709379, 309.5624025127498, 94.9290391498643, 83.46301252490932, 187.4227005639599, 129.74381398781287, 71.95520998136213, 32.40000000000006, 33.36035796379795, 45.981908287454864, 68.39766468808482, 150.1602343561409, 120.53069996144788, 105.80000000000028, 17.65422784181318, 150.60452050944448, 104.95426074849867, 63.037150505089215, 146.01064739073948, 106.60195436853968, 29.6885712722827, 44.98878795187024, 28.018221830774685, 41.212561768544774, 51.9029731957673, 167.09829291784862, 82.19999999999932, 53.31719923724874, 131.23215615098692], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-125.0910304265937, -129.24275413103985, -275.9656400198611, -241.9473876143604, -174.41461208390248, 18.023362277850293, -148.74120718604698, -53.939509875260434, -18.588067097449425, -85.31995095200736, -88.24914818618699, -52.50194836430018, 30.14167430768428, -15.843999332589028, -175.77664424072532, -42.776419295493255, -118.68984613686168, -177.0032156286378, 15.962857507808708, -65.3511488198279, 101.72865651002593, -201.896493676185, -178.00426287079824, 1.2531512109845835, 170.17238680720098, -11.339579275918354, 176.18877523279463, -199.20438401210944, 11.967080479185581, -6.307281243890035, -24.023189460287796, -18.974508350318203, -98.99294860276618, -194.25002712140093, -234.44022893986633, 159.65423715224367, -136.2537118126295, -137.91086619843634, 51.0132707203281, 97.0979471839296, -367.4716408302595, -12.771675071098004, -236.40212155598155, 84.6418313828531, -38.74298043378949, -139.1328298903956, -314.2219758756, -147.29891055452958, 53.798359559439476, -418.007924577908, -71.35788728307325, -138.53067502468852, -157.8339793626305, -26.081408002395804, -84.97243309103345, -196.7599680661319, -371.46832100593474, 50.15444968708793, -236.9362982169843, -22.763378888966763, -9.156651828347142, -99.88480153202822, 17.81880203713525, -382.1180000192819, -152.29548028121712, -296.5519635470423, -198.33300628618284, -66.79654171086348, -129.33871410440005, -284.31813137192495, -79.14152537043243, -46.32643639617606, 200.0, -79.7933629732709, 165.94681833375586, -101.46914306905974, -163.75834501707777, -130.18218180156111, -138.25870768376686, -52.472303571519575, -138.89368313259635, -72.06376148410156, -14.990513672867293, -191.2500904848017, -45.33937714338472, -185.93576008875837, -162.48238656085556, -180.86652741371597, -32.57968966719255, -247.44438375988415, -63.618112902882146, 20.000000000000014, -129.09342391539235, -93.03033932142493, -101.22658134785988, -70.19880176286631, -186.5013869170166, -42.4621182157873, -43.7301866815224, -51.340877134490185, -187.24778123765253, -22.863456373871795, 12.465429152813513, 30.329324186270426, -136.8214646187639, 38.13968398605599, -98.14738626009112, 0.2383212367748815, -124.48979644886309, -120.52006535819002, -20.49358321774178, -254.28768498057747, -45.88668113848753, -130.22830753684988, 24.636265756742596, -187.98269014983185, -110.32239999750867, -58.911301762883326, -87.65672472665491, -127.98731579321583, -154.86347436778752, -251.17789534196723, -129.4819395407882, -299.76563035230913, -139.74491115078217, -291.694899548436, -274.7491778485237, -87.95401823180659, -8.607508420572824, -271.5358126128899, 12.186962313302102, -281.44204736881807, -12.764660460063816, -247.0840893424894, 15.584848968984456, 7.339632731200341, -71.52319547772694, -57.921817227297225, -297.8138862306986, 1.1908991964959357, 10.663015120260216, -105.68518893223406, -270.7100419401798, -130.87740761572582, -73.42195000682389, 186.13879796775012, -23.514260474170765, -35.44997231398913, -67.91268059423388, -196.55465702598323, 131.12663423493956, -146.7948803307919, -295.4979178521266, -62.40080188459477, -263.9347060166669, -67.77891467478983, -117.4719497579522, -181.55105639239306, -228.21549955067772, -41.614121130219104, -67.22795362823209, -258.39371537590114, -120.92831830596445, -214.29763985761025, -252.54064259626458, 68.23293814195625, 17.21069588995563, -216.50634061756483, 35.58847149501392, 25.799419410305312, -117.46459781928405, -321.49541286366644, -72.03579965416023, -16.74155103050165, -161.19649429449086, -49.498112725447314, -287.10939063012347, -61.041775849585676, -239.89227460689142, -39.89533976257701, -33.15241485078563, -158.83734310770183, -131.2712758593155, -156.24532426883738, -182.5490396997613, -117.81249482338768, -87.81935474965324, -205.99852593485946, -49.385371896603964, -218.63363744429773, -184.69055720342647, -212.68861593897049, -129.35669579776257, 9.725512889811249, -85.4495786638644, -93.83973047514189, -11.147053254271485, -74.98717900577623, -253.9823083347159, -16.783652427025082], "policy_predator_policy_reward": [195.9502409300579, 81.360258680843, 260.46736560358426, 265.0929373283443, 185.91461208390183, 0.0, 107.10722577532339, 193.73007155816424, 128.0941075434311, 69.36174765623382, 75.65086576843646, 101.5901508689018, 196.62151768035073, 0.0, 114.46607680189213, 111.96765464558507, 182.78339461837336, 159.9402377093671, 15.220647005737066, 112.00534847900303, 211.852656310354, 52.083297624764356, 137.9672019939317, 202.43755041110816, 12.627613192799018, 98.1395792759183, 31.251286108329214, 254.22641134375485, 6.65019639778411, 109.39008711112918, 26.020760143484868, 160.61813660443678, 217.57046856347833, 107.55348480125295, 223.98569217431972, 42.458904062365264, 190.27190974161127, 118.8674352677966, 3.6867292796718774, 15.802052816070004, 432.37682423011387, 97.26959310774002, 66.68707803054275, 205.3967936444925, 122.24807559981599, 150.85757533892, 290.9315346558859, 191.255183603351, 118.5504497246782, 428.2473966787883, 128.20506923773246, 169.137025486385, 134.86909992271947, 126.0000188196789, 179.98690353760605, 179.14925283884756, 227.73474344558912, 319.9015576438788, 224.56743103924333, 139.60695222300964, 148.22950653348144, 85.7091772067183, 349.7295255582881, 131.99812802560857, 190.36378281196062, 337.36677406832814, 48.78043878766166, 293.42208586185603, 177.80419953258115, 329.96762306639675, 120.46704513119167, 133.4971665512752, 0.0, 93.69336297327105, 16.073514173059017, 119.12441944892785, 172.99436170344129, 153.4617555078292, 212.65290183502552, 47.50286331718978, 130.18740744082024, 159.58484574409857, 179.1656560626722, 87.00762910682832, 117.42893143091086, 227.35837459772497, 216.15786596005415, 211.21832621926393, 235.44428298662274, 176.80471663834032, 75.39587254857118, 7.061292836580995, 64.46799304510013, 220.0868226563952, 136.75208075515772, 162.70140496046395, 212.27818908717256, 123.19576934924234, 89.7305906398883, 118.22071393344946, 183.497170740016, 152.52150146050826, 81.97693754723083, 82.86623422881993, 139.72423112169471, 85.72075096928752, 115.49289301753281, 43.49772597744193, 62.142104434329305, 180.67356102383374, 65.61443327014551, 253.87534391353762, 138.13293583758724, 146.96856936333896, 97.23810204059714, 150.52919365246152, 137.95636899065545, 32.59594148819389, 203.29562556738327, 70.49931250440059, 268.4377875291909, 207.35590482040024, 164.42133318740795, 329.040113616421, 178.6292943222621, 325.9338153365707, 232.8878697638997, 170.5639518582895, 62.50364419880559, 263.24493701291874, 136.4999943929603, 183.1560048508355, 191.53571252139898, 164.02005127191376, 3.915151031015508, 11.36036726879963, 97.11938981861844, 70.80619526815072, 240.91046282987477, 142.43358302235146, 90.90501200748584, 46.65673898617411, 253.72299894018207, 181.3939063228175, 93.70963240139437, 103.1359221504292, 109.17716515678299, 44.71610678124173, 259.9308196994736, 87.99953044565261, 110.87716963574942, 92.21377702406261, 219.66763890936923, 267.97489481516527, 211.89913656508932, 191.76969410772935, 137.67194975795167, 193.75105639239277, 188.22223330788285, 114.9677453368115, 159.6437619718593, 211.9598153197286, 138.58594088430036, 265.0376819673591, 232.70051268364844, 101.76742612680056, 88.14047612872817, 231.6858685603287, 26.890935817096615, 17.521173277584165, 274.5951722587219, 182.01906626604122, 152.08038213158903, 87.30148906251787, 157.3523547683724, 158.2965130000645, 145.71479807036297, 265.4735189144352, 136.3411368510476, 289.4571249091603, 168.99965253039073, 129.5920597966359, 99.91615087609634, 217.28902052433878, 141.70835038690737, 203.6419720881106, 181.35316874672938, 140.48293376855744, 85.14505080127218, 224.08652030817407, 210.96698592936752, 238.3151604087964, 185.16383808148728, 101.56563774431339, 153.9941658528709, 107.49514328613473, 44.75144586472482, 94.69998563257137, 159.73790009190225, 242.26021682082546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.992460862552143, "mean_inference_ms": 6.3616903747306885, "mean_action_processing_ms": 5.025123934263891, "mean_env_wait_ms": 13.432249649899772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00601506233215332, "StateBufferConnector_ms": 0.005762696266174316, "ViewRequirementAgentConnector_ms": 0.2086200714111328}, "num_episodes": 22, "episode_return_max": 309.5624025127498, "episode_return_min": -2.1941963488898812, "episode_return_mean": 95.25409682427363, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1100480, "num_agent_steps_trained": 1100480, "num_env_steps_sampled": 275120, "num_env_steps_trained": 275120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.40068859462993, "num_env_steps_trained_throughput_per_sec": 74.40068859462993, "timesteps_total": 275120, "num_env_steps_sampled_lifetime": 275120, "num_agent_steps_sampled_lifetime": 1100480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1100480, "timers": {"training_iteration_time_ms": 56812.326, "restore_workers_time_ms": 0.018, "training_step_time_ms": 56812.228, "sample_time_ms": 4176.741, "learn_time_ms": 52605.571, "learn_throughput": 76.038, "synch_weights_time_ms": 24.56}, "counters": {"num_env_steps_sampled": 275120, "num_env_steps_trained": 275120, "num_agent_steps_sampled": 1100480, "num_agent_steps_trained": 1100480}, "done": false, "training_iteration": 68, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-24-19", "timestamp": 1724151259, "time_this_iter_s": 53.80617809295654, "time_total_s": 3820.467527151108, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120b84670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3820.467527151108, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 50.91973684210526, "ram_util_percent": 83.38026315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.54989808829373, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.350270354810846, "policy_loss": -0.01608715853616891, "vf_loss": 7.364345739758204, "vf_explained_var": 0.12435652014439699, "kl": 0.010058867174974352, "entropy": 0.6491711840427742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 130935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.637662016399323, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.345154480707078, "policy_loss": -0.016204518697066874, "vf_loss": 6.359444290241867, "vf_explained_var": 0.06182561087860632, "kl": 0.009573527902029652, "entropy": 0.6663263943775621, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 130935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 279120, "num_env_steps_trained": 279120, "num_agent_steps_sampled": 1116480, "num_agent_steps_trained": 1116480}, "env_runners": {"episode_reward_max": 309.5624025127498, "episode_reward_min": -2.1941963488898812, "episode_reward_mean": 92.02029186917794, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -418.007924577908, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 432.37682423011387}, "policy_reward_mean": {"prey_policy": -112.95836409602151, "predator_policy": 158.9685100306104}, "custom_metrics": {}, "hist_stats": {"episode_reward": [167.59999999999923, 149.4031014364961, 120.32358150190677, 95.22984061455136, 20.66583182910671, 182.58828138499766, 87.45353241635635, 76.95373137737201, 77.403755219289, 226.32242977062072, 104.47470615630198, 124.89723037982432, 117.42845560174993, 78.88311305202937, 77.07297665247103, 94.1149771226532, 128.49624991585821, 213.89999999999952, 199.67560888668302, 32.515590392632035, 69.42475389692946, 78.81480856822168, 59.93268101183198, 113.51216879649294, 84.0272782047467, 132.22492619788585, 38.83905248227085, 62.43105246467856, 128.02810260489568, 106.51045330361126, 112.88024075732481, 125.90743458899995, 207.63792511513492, 126.76320145827398, 61.08155397165865, -2.1941963488898812, 44.70850898536403, 108.98651652558912, 84.42087129996946, 1.3186087184576334, 58.15089755191388, 69.75232263983682, 64.2138769107311, 73.12329895961413, 40.748625541860115, 45.6052601782618, 50.40091418828018, 95.7070139907595, 38.20000000000027, 38.480572381745915, 86.72105881802318, 42.5395771816865, 33.52945570709379, 309.5624025127498, 94.9290391498643, 83.46301252490932, 187.4227005639599, 129.74381398781287, 71.95520998136213, 32.40000000000006, 33.36035796379795, 45.981908287454864, 68.39766468808482, 150.1602343561409, 120.53069996144788, 105.80000000000028, 17.65422784181318, 150.60452050944448, 104.95426074849867, 63.037150505089215, 146.01064739073948, 106.60195436853968, 29.6885712722827, 44.98878795187024, 28.018221830774685, 41.212561768544774, 51.9029731957673, 167.09829291784862, 82.19999999999932, 53.31719923724874, 131.23215615098692, 119.55273902812543, 113.04103363212208, 152.82691653952887, 41.673662153630985, 73.16587410818576, 78.21776766130071, 83.36373379133086, 26.51743969672549, 80.18098095786502, 121.27772264579633, 37.04157484925189, 104.54671917932069, 89.97338754303316, 158.54792923210798, 35.900007152062166, 128.09945083895863, 183.88587880317831, 44.30194346534347, 19.854045608740098], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [51.0132707203281, 97.0979471839296, -367.4716408302595, -12.771675071098004, -236.40212155598155, 84.6418313828531, -38.74298043378949, -139.1328298903956, -314.2219758756, -147.29891055452958, 53.798359559439476, -418.007924577908, -71.35788728307325, -138.53067502468852, -157.8339793626305, -26.081408002395804, -84.97243309103345, -196.7599680661319, -371.46832100593474, 50.15444968708793, -236.9362982169843, -22.763378888966763, -9.156651828347142, -99.88480153202822, 17.81880203713525, -382.1180000192819, -152.29548028121712, -296.5519635470423, -198.33300628618284, -66.79654171086348, -129.33871410440005, -284.31813137192495, -79.14152537043243, -46.32643639617606, 200.0, -79.7933629732709, 165.94681833375586, -101.46914306905974, -163.75834501707777, -130.18218180156111, -138.25870768376686, -52.472303571519575, -138.89368313259635, -72.06376148410156, -14.990513672867293, -191.2500904848017, -45.33937714338472, -185.93576008875837, -162.48238656085556, -180.86652741371597, -32.57968966719255, -247.44438375988415, -63.618112902882146, 20.000000000000014, -129.09342391539235, -93.03033932142493, -101.22658134785988, -70.19880176286631, -186.5013869170166, -42.4621182157873, -43.7301866815224, -51.340877134490185, -187.24778123765253, -22.863456373871795, 12.465429152813513, 30.329324186270426, -136.8214646187639, 38.13968398605599, -98.14738626009112, 0.2383212367748815, -124.48979644886309, -120.52006535819002, -20.49358321774178, -254.28768498057747, -45.88668113848753, -130.22830753684988, 24.636265756742596, -187.98269014983185, -110.32239999750867, -58.911301762883326, -87.65672472665491, -127.98731579321583, -154.86347436778752, -251.17789534196723, -129.4819395407882, -299.76563035230913, -139.74491115078217, -291.694899548436, -274.7491778485237, -87.95401823180659, -8.607508420572824, -271.5358126128899, 12.186962313302102, -281.44204736881807, -12.764660460063816, -247.0840893424894, 15.584848968984456, 7.339632731200341, -71.52319547772694, -57.921817227297225, -297.8138862306986, 1.1908991964959357, 10.663015120260216, -105.68518893223406, -270.7100419401798, -130.87740761572582, -73.42195000682389, 186.13879796775012, -23.514260474170765, -35.44997231398913, -67.91268059423388, -196.55465702598323, 131.12663423493956, -146.7948803307919, -295.4979178521266, -62.40080188459477, -263.9347060166669, -67.77891467478983, -117.4719497579522, -181.55105639239306, -228.21549955067772, -41.614121130219104, -67.22795362823209, -258.39371537590114, -120.92831830596445, -214.29763985761025, -252.54064259626458, 68.23293814195625, 17.21069588995563, -216.50634061756483, 35.58847149501392, 25.799419410305312, -117.46459781928405, -321.49541286366644, -72.03579965416023, -16.74155103050165, -161.19649429449086, -49.498112725447314, -287.10939063012347, -61.041775849585676, -239.89227460689142, -39.89533976257701, -33.15241485078563, -158.83734310770183, -131.2712758593155, -156.24532426883738, -182.5490396997613, -117.81249482338768, -87.81935474965324, -205.99852593485946, -49.385371896603964, -218.63363744429773, -184.69055720342647, -212.68861593897049, -129.35669579776257, 9.725512889811249, -85.4495786638644, -93.83973047514189, -11.147053254271485, -74.98717900577623, -253.9823083347159, -16.783652427025082, -57.51832838158714, 61.18574552571991, -244.36415845743645, 41.31221117786864, -74.4587575718148, -18.252709998091575, -25.579894660246772, -229.48887726864336, -101.83742050642925, -204.52255560131866, -208.41340846544938, -119.15998748827703, -189.92750746993977, -63.453386965748706, -226.3676654513301, -28.234140595917538, -186.53882733805605, -152.1758012769379, -191.46567615481078, -128.11627095986734, -142.6742372099589, -358.64560646626074, -47.68894528055918, 44.837953099899366, 14.737217436325754, -248.02838817827256, -9.004119596449968, -91.54313304738298, -191.99980522851928, -191.0491333383436, -205.80294355181843, 1.4939802699004747, 165.57259670667338, -344.7649419769525, -309.0137153246723, -115.72251983395921, -196.06311577735258, -139.75404670637326], "policy_predator_policy_reward": [3.6867292796718774, 15.802052816070004, 432.37682423011387, 97.26959310774002, 66.68707803054275, 205.3967936444925, 122.24807559981599, 150.85757533892, 290.9315346558859, 191.255183603351, 118.5504497246782, 428.2473966787883, 128.20506923773246, 169.137025486385, 134.86909992271947, 126.0000188196789, 179.98690353760605, 179.14925283884756, 227.73474344558912, 319.9015576438788, 224.56743103924333, 139.60695222300964, 148.22950653348144, 85.7091772067183, 349.7295255582881, 131.99812802560857, 190.36378281196062, 337.36677406832814, 48.78043878766166, 293.42208586185603, 177.80419953258115, 329.96762306639675, 120.46704513119167, 133.4971665512752, 0.0, 93.69336297327105, 16.073514173059017, 119.12441944892785, 172.99436170344129, 153.4617555078292, 212.65290183502552, 47.50286331718978, 130.18740744082024, 159.58484574409857, 179.1656560626722, 87.00762910682832, 117.42893143091086, 227.35837459772497, 216.15786596005415, 211.21832621926393, 235.44428298662274, 176.80471663834032, 75.39587254857118, 7.061292836580995, 64.46799304510013, 220.0868226563952, 136.75208075515772, 162.70140496046395, 212.27818908717256, 123.19576934924234, 89.7305906398883, 118.22071393344946, 183.497170740016, 152.52150146050826, 81.97693754723083, 82.86623422881993, 139.72423112169471, 85.72075096928752, 115.49289301753281, 43.49772597744193, 62.142104434329305, 180.67356102383374, 65.61443327014551, 253.87534391353762, 138.13293583758724, 146.96856936333896, 97.23810204059714, 150.52919365246152, 137.95636899065545, 32.59594148819389, 203.29562556738327, 70.49931250440059, 268.4377875291909, 207.35590482040024, 164.42133318740795, 329.040113616421, 178.6292943222621, 325.9338153365707, 232.8878697638997, 170.5639518582895, 62.50364419880559, 263.24493701291874, 136.4999943929603, 183.1560048508355, 191.53571252139898, 164.02005127191376, 3.915151031015508, 11.36036726879963, 97.11938981861844, 70.80619526815072, 240.91046282987477, 142.43358302235146, 90.90501200748584, 46.65673898617411, 253.72299894018207, 181.3939063228175, 93.70963240139437, 103.1359221504292, 109.17716515678299, 44.71610678124173, 259.9308196994736, 87.99953044565261, 110.87716963574942, 92.21377702406261, 219.66763890936923, 267.97489481516527, 211.89913656508932, 191.76969410772935, 137.67194975795167, 193.75105639239277, 188.22223330788285, 114.9677453368115, 159.6437619718593, 211.9598153197286, 138.58594088430036, 265.0376819673591, 232.70051268364844, 101.76742612680056, 88.14047612872817, 231.6858685603287, 26.890935817096615, 17.521173277584165, 274.5951722587219, 182.01906626604122, 152.08038213158903, 87.30148906251787, 157.3523547683724, 158.2965130000645, 145.71479807036297, 265.4735189144352, 136.3411368510476, 289.4571249091603, 168.99965253039073, 129.5920597966359, 99.91615087609634, 217.28902052433878, 141.70835038690737, 203.6419720881106, 181.35316874672938, 140.48293376855744, 85.14505080127218, 224.08652030817407, 210.96698592936752, 238.3151604087964, 185.16383808148728, 101.56563774431339, 153.9941658528709, 107.49514328613473, 44.75144586472482, 94.69998563257137, 159.73790009190225, 242.26021682082546, 24.562174416929622, 91.32314746706298, 176.64237191909228, 139.45060899259755, 114.81253399040133, 130.72585011903357, 61.644505602567634, 235.09792847995328, 171.43479623147348, 208.09105398445965, 230.95456957799013, 174.83659403703658, 256.42733023634014, 80.31729799067911, 149.00855682006951, 132.11068892390327, 97.74794875589286, 321.14766081696604, 206.02420509525575, 234.83546466521847, 167.99665328230222, 370.36476524316924, 77.71173402773482, 29.68597733224691, 149.39584970755882, 173.86870857742076, 100.69530159234048, 158.3998802836004, 232.55813898524354, 186.39080673368065, 229.54921674257233, 102.85919737830434, 37.99763920879326, 325.08058486466444, 314.3152056090851, 154.72297301488976, 212.87681778402182, 142.79439030844324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.021835230762271, "mean_inference_ms": 6.375613740120501, "mean_action_processing_ms": 5.004235943723415, "mean_env_wait_ms": 13.467173762015937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00697171688079834, "StateBufferConnector_ms": 0.008589625358581543, "ViewRequirementAgentConnector_ms": 0.24397921562194824}, "num_episodes": 19, "episode_return_max": 309.5624025127498, "episode_return_min": -2.1941963488898812, "episode_return_mean": 92.02029186917794, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116480, "num_agent_steps_trained": 1116480, "num_env_steps_sampled": 279120, "num_env_steps_trained": 279120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.631365807019, "num_env_steps_trained_throughput_per_sec": 67.631365807019, "timesteps_total": 279120, "num_env_steps_sampled_lifetime": 279120, "num_agent_steps_sampled_lifetime": 1116480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1116480, "timers": {"training_iteration_time_ms": 56939.238, "restore_workers_time_ms": 0.018, "training_step_time_ms": 56939.13, "sample_time_ms": 4273.122, "learn_time_ms": 52635.506, "learn_throughput": 75.994, "synch_weights_time_ms": 24.507}, "counters": {"num_env_steps_sampled": 279120, "num_env_steps_trained": 279120, "num_agent_steps_sampled": 1116480, "num_agent_steps_trained": 1116480}, "done": false, "training_iteration": 69, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-25-18", "timestamp": 1724151318, "time_this_iter_s": 59.20180010795593, "time_total_s": 3879.6693272590637, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120b844c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3879.6693272590637, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 57.097619047619034, "ram_util_percent": 83.25238095238095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.003776429696057, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.455963467794751, "policy_loss": -0.01528530488377092, "vf_loss": 7.468997858945655, "vf_explained_var": 0.20025266456225563, "kl": 0.011254692594299004, "entropy": 0.6440610102560155, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 132825.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999885}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.436583173338067, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.436537017519512, "policy_loss": -0.015640338300111353, "vf_loss": 6.450308045382222, "vf_explained_var": -0.007275712363934391, "kl": 0.00934658210808362, "entropy": 0.6569567927134731, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 132825.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999885}}, "num_env_steps_sampled": 283120, "num_env_steps_trained": 283120, "num_agent_steps_sampled": 1132480, "num_agent_steps_trained": 1132480}, "env_runners": {"episode_reward_max": 309.5624025127498, "episode_reward_min": -2.1941963488898812, "episode_reward_mean": 86.41002552335935, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -358.64560646626074, "predator_policy": 3.915151031015508}, "policy_reward_max": {"prey_policy": 186.13879796775012, "predator_policy": 370.36476524316924}, "policy_reward_mean": {"prey_policy": -110.97392112973623, "predator_policy": 154.17893389141582}, "custom_metrics": {}, "hist_stats": {"episode_reward": [113.51216879649294, 84.0272782047467, 132.22492619788585, 38.83905248227085, 62.43105246467856, 128.02810260489568, 106.51045330361126, 112.88024075732481, 125.90743458899995, 207.63792511513492, 126.76320145827398, 61.08155397165865, -2.1941963488898812, 44.70850898536403, 108.98651652558912, 84.42087129996946, 1.3186087184576334, 58.15089755191388, 69.75232263983682, 64.2138769107311, 73.12329895961413, 40.748625541860115, 45.6052601782618, 50.40091418828018, 95.7070139907595, 38.20000000000027, 38.480572381745915, 86.72105881802318, 42.5395771816865, 33.52945570709379, 309.5624025127498, 94.9290391498643, 83.46301252490932, 187.4227005639599, 129.74381398781287, 71.95520998136213, 32.40000000000006, 33.36035796379795, 45.981908287454864, 68.39766468808482, 150.1602343561409, 120.53069996144788, 105.80000000000028, 17.65422784181318, 150.60452050944448, 104.95426074849867, 63.037150505089215, 146.01064739073948, 106.60195436853968, 29.6885712722827, 44.98878795187024, 28.018221830774685, 41.212561768544774, 51.9029731957673, 167.09829291784862, 82.19999999999932, 53.31719923724874, 131.23215615098692, 119.55273902812543, 113.04103363212208, 152.82691653952887, 41.673662153630985, 73.16587410818576, 78.21776766130071, 83.36373379133086, 26.51743969672549, 80.18098095786502, 121.27772264579633, 37.04157484925189, 104.54671917932069, 89.97338754303316, 158.54792923210798, 35.900007152062166, 128.09945083895863, 183.88587880317831, 44.30194346534347, 19.854045608740098, 50.30141533968675, 42.264628681401945, 34.021831437259316, 110.71842396080359, 49.413669191874455, 75.53841245846488, 135.48610232299092, 43.33991503584, 31.72487594427709, 86.52816910705853, 204.24601764639087, 122.1491082143133, 252.13579681408274, 92.38085060496132, 60.716925057616635, 44.79716644751443, 109.4819168081322, 23.25889304317776, 45.82174333483542, 120.19100105644947, 206.7392315035648, 60.40027620907789, 20.892232386246906], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-45.33937714338472, -185.93576008875837, -162.48238656085556, -180.86652741371597, -32.57968966719255, -247.44438375988415, -63.618112902882146, 20.000000000000014, -129.09342391539235, -93.03033932142493, -101.22658134785988, -70.19880176286631, -186.5013869170166, -42.4621182157873, -43.7301866815224, -51.340877134490185, -187.24778123765253, -22.863456373871795, 12.465429152813513, 30.329324186270426, -136.8214646187639, 38.13968398605599, -98.14738626009112, 0.2383212367748815, -124.48979644886309, -120.52006535819002, -20.49358321774178, -254.28768498057747, -45.88668113848753, -130.22830753684988, 24.636265756742596, -187.98269014983185, -110.32239999750867, -58.911301762883326, -87.65672472665491, -127.98731579321583, -154.86347436778752, -251.17789534196723, -129.4819395407882, -299.76563035230913, -139.74491115078217, -291.694899548436, -274.7491778485237, -87.95401823180659, -8.607508420572824, -271.5358126128899, 12.186962313302102, -281.44204736881807, -12.764660460063816, -247.0840893424894, 15.584848968984456, 7.339632731200341, -71.52319547772694, -57.921817227297225, -297.8138862306986, 1.1908991964959357, 10.663015120260216, -105.68518893223406, -270.7100419401798, -130.87740761572582, -73.42195000682389, 186.13879796775012, -23.514260474170765, -35.44997231398913, -67.91268059423388, -196.55465702598323, 131.12663423493956, -146.7948803307919, -295.4979178521266, -62.40080188459477, -263.9347060166669, -67.77891467478983, -117.4719497579522, -181.55105639239306, -228.21549955067772, -41.614121130219104, -67.22795362823209, -258.39371537590114, -120.92831830596445, -214.29763985761025, -252.54064259626458, 68.23293814195625, 17.21069588995563, -216.50634061756483, 35.58847149501392, 25.799419410305312, -117.46459781928405, -321.49541286366644, -72.03579965416023, -16.74155103050165, -161.19649429449086, -49.498112725447314, -287.10939063012347, -61.041775849585676, -239.89227460689142, -39.89533976257701, -33.15241485078563, -158.83734310770183, -131.2712758593155, -156.24532426883738, -182.5490396997613, -117.81249482338768, -87.81935474965324, -205.99852593485946, -49.385371896603964, -218.63363744429773, -184.69055720342647, -212.68861593897049, -129.35669579776257, 9.725512889811249, -85.4495786638644, -93.83973047514189, -11.147053254271485, -74.98717900577623, -253.9823083347159, -16.783652427025082, -57.51832838158714, 61.18574552571991, -244.36415845743645, 41.31221117786864, -74.4587575718148, -18.252709998091575, -25.579894660246772, -229.48887726864336, -101.83742050642925, -204.52255560131866, -208.41340846544938, -119.15998748827703, -189.92750746993977, -63.453386965748706, -226.3676654513301, -28.234140595917538, -186.53882733805605, -152.1758012769379, -191.46567615481078, -128.11627095986734, -142.6742372099589, -358.64560646626074, -47.68894528055918, 44.837953099899366, 14.737217436325754, -248.02838817827256, -9.004119596449968, -91.54313304738298, -191.99980522851928, -191.0491333383436, -205.80294355181843, 1.4939802699004747, 165.57259670667338, -344.7649419769525, -309.0137153246723, -115.72251983395921, -196.06311577735258, -139.75404670637326, -149.05231024805684, -56.151957392475985, -220.65401735425624, -281.0750806074294, -311.76960295200814, -114.49278563854385, -108.46369822286141, -6.889793149829998, -304.84116496451844, 3.3703361961985228, 0.9573448738470958, -317.28400888149326, 81.85848547351344, -309.0503972138552, -145.72247510277148, -42.51632620042437, -182.7068703370651, 16.977571822923263, -57.182342364627566, 6.140411197630545, -54.22469545168758, 106.6609902355701, -161.33052822246503, 23.343391819065474, -47.946597293229786, 155.03771056437904, -56.02553256400392, -36.7406258300099, -106.60040846620497, -95.28082709559298, -203.4242582852838, 13.720671844943528, -110.87685457946888, -24.26197225600292, -45.93999288974714, -76.7940409995775, -118.71119820385994, -279.8776124704684, -66.46758985612318, -181.36328896731808, 61.45462336487971, -249.45967309583494, -276.63823918457217, -65.85588154336969, -143.92579763852083, -150.7107727777305], "policy_predator_policy_reward": [117.42893143091086, 227.35837459772497, 216.15786596005415, 211.21832621926393, 235.44428298662274, 176.80471663834032, 75.39587254857118, 7.061292836580995, 64.46799304510013, 220.0868226563952, 136.75208075515772, 162.70140496046395, 212.27818908717256, 123.19576934924234, 89.7305906398883, 118.22071393344946, 183.497170740016, 152.52150146050826, 81.97693754723083, 82.86623422881993, 139.72423112169471, 85.72075096928752, 115.49289301753281, 43.49772597744193, 62.142104434329305, 180.67356102383374, 65.61443327014551, 253.87534391353762, 138.13293583758724, 146.96856936333896, 97.23810204059714, 150.52919365246152, 137.95636899065545, 32.59594148819389, 203.29562556738327, 70.49931250440059, 268.4377875291909, 207.35590482040024, 164.42133318740795, 329.040113616421, 178.6292943222621, 325.9338153365707, 232.8878697638997, 170.5639518582895, 62.50364419880559, 263.24493701291874, 136.4999943929603, 183.1560048508355, 191.53571252139898, 164.02005127191376, 3.915151031015508, 11.36036726879963, 97.11938981861844, 70.80619526815072, 240.91046282987477, 142.43358302235146, 90.90501200748584, 46.65673898617411, 253.72299894018207, 181.3939063228175, 93.70963240139437, 103.1359221504292, 109.17716515678299, 44.71610678124173, 259.9308196994736, 87.99953044565261, 110.87716963574942, 92.21377702406261, 219.66763890936923, 267.97489481516527, 211.89913656508932, 191.76969410772935, 137.67194975795167, 193.75105639239277, 188.22223330788285, 114.9677453368115, 159.6437619718593, 211.9598153197286, 138.58594088430036, 265.0376819673591, 232.70051268364844, 101.76742612680056, 88.14047612872817, 231.6858685603287, 26.890935817096615, 17.521173277584165, 274.5951722587219, 182.01906626604122, 152.08038213158903, 87.30148906251787, 157.3523547683724, 158.2965130000645, 145.71479807036297, 265.4735189144352, 136.3411368510476, 289.4571249091603, 168.99965253039073, 129.5920597966359, 99.91615087609634, 217.28902052433878, 141.70835038690737, 203.6419720881106, 181.35316874672938, 140.48293376855744, 85.14505080127218, 224.08652030817407, 210.96698592936752, 238.3151604087964, 185.16383808148728, 101.56563774431339, 153.9941658528709, 107.49514328613473, 44.75144586472482, 94.69998563257137, 159.73790009190225, 242.26021682082546, 24.562174416929622, 91.32314746706298, 176.64237191909228, 139.45060899259755, 114.81253399040133, 130.72585011903357, 61.644505602567634, 235.09792847995328, 171.43479623147348, 208.09105398445965, 230.95456957799013, 174.83659403703658, 256.42733023634014, 80.31729799067911, 149.00855682006951, 132.11068892390327, 97.74794875589286, 321.14766081696604, 206.02420509525575, 234.83546466521847, 167.99665328230222, 370.36476524316924, 77.71173402773482, 29.68597733224691, 149.39584970755882, 173.86870857742076, 100.69530159234048, 158.3998802836004, 232.55813898524354, 186.39080673368065, 229.54921674257233, 102.85919737830434, 37.99763920879326, 325.08058486466444, 314.3152056090851, 154.72297301488976, 212.87681778402182, 142.79439030844324, 214.4184457587984, 41.08723722142055, 300.37327570641116, 243.6204509366761, 330.8112873800754, 129.47293264773614, 114.64031114383356, 111.43160418966112, 210.80110576083786, 140.0833921993558, 128.86255491931752, 263.0025215467932, 286.54323852893464, 76.1347755343981, 190.3992443476524, 41.17947199138342, 179.63263298169153, 17.821541476726967, 8.911443961125759, 128.65865631293025, 102.73916282850473, 49.070560034004316, 162.78410300682813, 97.3521416108845, 26.311181732398882, 118.73350181053455, 80.41513890215003, 104.73187009682567, 142.50189336485533, 120.09626725455942, 186.25180469214243, 48.248948195711556, 133.94878696184122, 110.6719566817626, 47.29523631562883, 98.69769061687367, 291.5040927523024, 152.90646125686118, 129.84068757499543, 238.18119230489563, 256.6878325755597, 138.05644865896093, 296.14179704498974, 106.75259989202999, 192.54362020312408, 122.98518259937427]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.009224437998187, "mean_inference_ms": 6.374953042853162, "mean_action_processing_ms": 4.699955051110285, "mean_env_wait_ms": 13.493350734276486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020974397659301758, "StateBufferConnector_ms": 0.008271455764770508, "ViewRequirementAgentConnector_ms": 0.23729324340820312}, "num_episodes": 23, "episode_return_max": 309.5624025127498, "episode_return_min": -2.1941963488898812, "episode_return_mean": 86.41002552335935, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1132480, "num_agent_steps_trained": 1132480, "num_env_steps_sampled": 283120, "num_env_steps_trained": 283120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.91491964718564, "num_env_steps_trained_throughput_per_sec": 70.91491964718564, "timesteps_total": 283120, "num_env_steps_sampled_lifetime": 283120, "num_agent_steps_sampled_lifetime": 1132480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1132480, "timers": {"training_iteration_time_ms": 56872.433, "restore_workers_time_ms": 0.018, "training_step_time_ms": 56872.326, "sample_time_ms": 4143.247, "learn_time_ms": 52700.209, "learn_throughput": 75.901, "synch_weights_time_ms": 23.087}, "counters": {"num_env_steps_sampled": 283120, "num_env_steps_trained": 283120, "num_agent_steps_sampled": 1132480, "num_agent_steps_trained": 1132480}, "done": false, "training_iteration": 70, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-26-15", "timestamp": 1724151375, "time_this_iter_s": 56.455827951431274, "time_total_s": 3936.125155210495, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12002d0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3936.125155210495, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 54.8074074074074, "ram_util_percent": 83.19135802469135}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.15544719897881, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.085662673263953, "policy_loss": -0.018964610030756345, "vf_loss": 7.102465207740743, "vf_explained_var": 0.22809806891850062, "kl": 0.010810382179324588, "entropy": 0.6451444783854106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 134715.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999885}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.402577387655853, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.853463190320938, "policy_loss": -0.01551809221316405, "vf_loss": 5.866693563309926, "vf_explained_var": 0.12164763041904994, "kl": 0.01143861500763152, "entropy": 0.7144924086237711, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 134715.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999885}}, "num_env_steps_sampled": 287120, "num_env_steps_trained": 287120, "num_agent_steps_sampled": 1148480, "num_agent_steps_trained": 1148480}, "env_runners": {"episode_reward_max": 309.5624025127498, "episode_reward_min": 17.65422784181318, "episode_reward_mean": 90.45994827754672, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -358.64560646626074, "predator_policy": 3.915151031015508}, "policy_reward_max": {"prey_policy": 186.13879796775012, "predator_policy": 370.36476524316924}, "policy_reward_mean": {"prey_policy": -112.95277907965446, "predator_policy": 158.1827532184278}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.2138769107311, 73.12329895961413, 40.748625541860115, 45.6052601782618, 50.40091418828018, 95.7070139907595, 38.20000000000027, 38.480572381745915, 86.72105881802318, 42.5395771816865, 33.52945570709379, 309.5624025127498, 94.9290391498643, 83.46301252490932, 187.4227005639599, 129.74381398781287, 71.95520998136213, 32.40000000000006, 33.36035796379795, 45.981908287454864, 68.39766468808482, 150.1602343561409, 120.53069996144788, 105.80000000000028, 17.65422784181318, 150.60452050944448, 104.95426074849867, 63.037150505089215, 146.01064739073948, 106.60195436853968, 29.6885712722827, 44.98878795187024, 28.018221830774685, 41.212561768544774, 51.9029731957673, 167.09829291784862, 82.19999999999932, 53.31719923724874, 131.23215615098692, 119.55273902812543, 113.04103363212208, 152.82691653952887, 41.673662153630985, 73.16587410818576, 78.21776766130071, 83.36373379133086, 26.51743969672549, 80.18098095786502, 121.27772264579633, 37.04157484925189, 104.54671917932069, 89.97338754303316, 158.54792923210798, 35.900007152062166, 128.09945083895863, 183.88587880317831, 44.30194346534347, 19.854045608740098, 50.30141533968675, 42.264628681401945, 34.021831437259316, 110.71842396080359, 49.413669191874455, 75.53841245846488, 135.48610232299092, 43.33991503584, 31.72487594427709, 86.52816910705853, 204.24601764639087, 122.1491082143133, 252.13579681408274, 92.38085060496132, 60.716925057616635, 44.79716644751443, 109.4819168081322, 23.25889304317776, 45.82174333483542, 120.19100105644947, 206.7392315035648, 60.40027620907789, 20.892232386246906, 27.800000000000068, 255.20603709656493, 113.48058300952161, 28.678777429935792, 151.58145623808673, 64.38286978521892, 44.8099422825318, 261.78523601853374, 103.62795472169321, 79.47998250284405, 210.36294651965247, 131.229156310891, 90.32406050785794, 37.19259462408195, 32.767479918603215, 87.870053285522, 65.97126967845773, 110.76285648774427, 172.6659383192114], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-129.4819395407882, -299.76563035230913, -139.74491115078217, -291.694899548436, -274.7491778485237, -87.95401823180659, -8.607508420572824, -271.5358126128899, 12.186962313302102, -281.44204736881807, -12.764660460063816, -247.0840893424894, 15.584848968984456, 7.339632731200341, -71.52319547772694, -57.921817227297225, -297.8138862306986, 1.1908991964959357, 10.663015120260216, -105.68518893223406, -270.7100419401798, -130.87740761572582, -73.42195000682389, 186.13879796775012, -23.514260474170765, -35.44997231398913, -67.91268059423388, -196.55465702598323, 131.12663423493956, -146.7948803307919, -295.4979178521266, -62.40080188459477, -263.9347060166669, -67.77891467478983, -117.4719497579522, -181.55105639239306, -228.21549955067772, -41.614121130219104, -67.22795362823209, -258.39371537590114, -120.92831830596445, -214.29763985761025, -252.54064259626458, 68.23293814195625, 17.21069588995563, -216.50634061756483, 35.58847149501392, 25.799419410305312, -117.46459781928405, -321.49541286366644, -72.03579965416023, -16.74155103050165, -161.19649429449086, -49.498112725447314, -287.10939063012347, -61.041775849585676, -239.89227460689142, -39.89533976257701, -33.15241485078563, -158.83734310770183, -131.2712758593155, -156.24532426883738, -182.5490396997613, -117.81249482338768, -87.81935474965324, -205.99852593485946, -49.385371896603964, -218.63363744429773, -184.69055720342647, -212.68861593897049, -129.35669579776257, 9.725512889811249, -85.4495786638644, -93.83973047514189, -11.147053254271485, -74.98717900577623, -253.9823083347159, -16.783652427025082, -57.51832838158714, 61.18574552571991, -244.36415845743645, 41.31221117786864, -74.4587575718148, -18.252709998091575, -25.579894660246772, -229.48887726864336, -101.83742050642925, -204.52255560131866, -208.41340846544938, -119.15998748827703, -189.92750746993977, -63.453386965748706, -226.3676654513301, -28.234140595917538, -186.53882733805605, -152.1758012769379, -191.46567615481078, -128.11627095986734, -142.6742372099589, -358.64560646626074, -47.68894528055918, 44.837953099899366, 14.737217436325754, -248.02838817827256, -9.004119596449968, -91.54313304738298, -191.99980522851928, -191.0491333383436, -205.80294355181843, 1.4939802699004747, 165.57259670667338, -344.7649419769525, -309.0137153246723, -115.72251983395921, -196.06311577735258, -139.75404670637326, -149.05231024805684, -56.151957392475985, -220.65401735425624, -281.0750806074294, -311.76960295200814, -114.49278563854385, -108.46369822286141, -6.889793149829998, -304.84116496451844, 3.3703361961985228, 0.9573448738470958, -317.28400888149326, 81.85848547351344, -309.0503972138552, -145.72247510277148, -42.51632620042437, -182.7068703370651, 16.977571822923263, -57.182342364627566, 6.140411197630545, -54.22469545168758, 106.6609902355701, -161.33052822246503, 23.343391819065474, -47.946597293229786, 155.03771056437904, -56.02553256400392, -36.7406258300099, -106.60040846620497, -95.28082709559298, -203.4242582852838, 13.720671844943528, -110.87685457946888, -24.26197225600292, -45.93999288974714, -76.7940409995775, -118.71119820385994, -279.8776124704684, -66.46758985612318, -181.36328896731808, 61.45462336487971, -249.45967309583494, -276.63823918457217, -65.85588154336969, -143.92579763852083, -150.7107727777305, -121.48470183153887, -151.19012445693238, 75.03806250591049, 22.634428481186976, -144.46186215143575, -80.94395483541315, -217.26299933862845, -199.68304105519977, -130.3923498798331, 92.32188263707076, -107.30873467419642, -28.079368954733667, -79.41503519502459, -92.4870125950576, -229.08447345043945, 107.0738156133446, -37.44143663535761, -292.84030514797877, -141.14045005282154, -15.702414113160582, -112.37544131791269, 176.17116399316816, -137.0906825143348, 5.981966626064631, -251.04509474967165, -113.95848265656707, -166.5455152104986, -215.97813567040666, -243.30783413104032, -172.01692314745324, -241.06795477682286, 49.318447603020175, -224.9772393824115, -141.2250908534284, -234.54101845981836, -181.40029312858397, 116.43729929557767, -166.22962419760316], "policy_predator_policy_reward": [164.42133318740795, 329.040113616421, 178.6292943222621, 325.9338153365707, 232.8878697638997, 170.5639518582895, 62.50364419880559, 263.24493701291874, 136.4999943929603, 183.1560048508355, 191.53571252139898, 164.02005127191376, 3.915151031015508, 11.36036726879963, 97.11938981861844, 70.80619526815072, 240.91046282987477, 142.43358302235146, 90.90501200748584, 46.65673898617411, 253.72299894018207, 181.3939063228175, 93.70963240139437, 103.1359221504292, 109.17716515678299, 44.71610678124173, 259.9308196994736, 87.99953044565261, 110.87716963574942, 92.21377702406261, 219.66763890936923, 267.97489481516527, 211.89913656508932, 191.76969410772935, 137.67194975795167, 193.75105639239277, 188.22223330788285, 114.9677453368115, 159.6437619718593, 211.9598153197286, 138.58594088430036, 265.0376819673591, 232.70051268364844, 101.76742612680056, 88.14047612872817, 231.6858685603287, 26.890935817096615, 17.521173277584165, 274.5951722587219, 182.01906626604122, 152.08038213158903, 87.30148906251787, 157.3523547683724, 158.2965130000645, 145.71479807036297, 265.4735189144352, 136.3411368510476, 289.4571249091603, 168.99965253039073, 129.5920597966359, 99.91615087609634, 217.28902052433878, 141.70835038690737, 203.6419720881106, 181.35316874672938, 140.48293376855744, 85.14505080127218, 224.08652030817407, 210.96698592936752, 238.3151604087964, 185.16383808148728, 101.56563774431339, 153.9941658528709, 107.49514328613473, 44.75144586472482, 94.69998563257137, 159.73790009190225, 242.26021682082546, 24.562174416929622, 91.32314746706298, 176.64237191909228, 139.45060899259755, 114.81253399040133, 130.72585011903357, 61.644505602567634, 235.09792847995328, 171.43479623147348, 208.09105398445965, 230.95456957799013, 174.83659403703658, 256.42733023634014, 80.31729799067911, 149.00855682006951, 132.11068892390327, 97.74794875589286, 321.14766081696604, 206.02420509525575, 234.83546466521847, 167.99665328230222, 370.36476524316924, 77.71173402773482, 29.68597733224691, 149.39584970755882, 173.86870857742076, 100.69530159234048, 158.3998802836004, 232.55813898524354, 186.39080673368065, 229.54921674257233, 102.85919737830434, 37.99763920879326, 325.08058486466444, 314.3152056090851, 154.72297301488976, 212.87681778402182, 142.79439030844324, 214.4184457587984, 41.08723722142055, 300.37327570641116, 243.6204509366761, 330.8112873800754, 129.47293264773614, 114.64031114383356, 111.43160418966112, 210.80110576083786, 140.0833921993558, 128.86255491931752, 263.0025215467932, 286.54323852893464, 76.1347755343981, 190.3992443476524, 41.17947199138342, 179.63263298169153, 17.821541476726967, 8.911443961125759, 128.65865631293025, 102.73916282850473, 49.070560034004316, 162.78410300682813, 97.3521416108845, 26.311181732398882, 118.73350181053455, 80.41513890215003, 104.73187009682567, 142.50189336485533, 120.09626725455942, 186.25180469214243, 48.248948195711556, 133.94878696184122, 110.6719566817626, 47.29523631562883, 98.69769061687367, 291.5040927523024, 152.90646125686118, 129.84068757499543, 238.18119230489563, 256.6878325755597, 138.05644865896093, 296.14179704498974, 106.75259989202999, 192.54362020312408, 122.98518259937427, 132.4847018315388, 167.99012445693216, 75.65760213329006, 81.87594397617742, 174.1962379209242, 164.69016207544615, 212.40663962208305, 233.2181782016802, 101.72829562781114, 87.92362785303791, 107.29026004530672, 92.48071336884169, 126.95627678923469, 89.75571328337931, 162.1242903315794, 221.67160352404903, 174.9457021665973, 258.9639943384327, 138.82398142703155, 97.49886524179463, 126.28305141821339, 20.28417242618388, 137.06223050976286, 125.27564168939897, 255.96701635886734, 199.36062155522916, 192.3381098345802, 227.37813567040627, 245.36235984158373, 202.72987735551234, 245.27106713462382, 34.34849332470165, 241.83550413284104, 190.33809578145645, 166.2885434009051, 360.41562467524136, 150.48511909472967, 71.97314412650708]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.962100787991835, "mean_inference_ms": 6.347007538889598, "mean_action_processing_ms": 4.916679612195882, "mean_env_wait_ms": 13.528320050957728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020519733428955078, "StateBufferConnector_ms": 0.00932323932647705, "ViewRequirementAgentConnector_ms": 0.2387235164642334}, "num_episodes": 19, "episode_return_max": 309.5624025127498, "episode_return_min": 17.65422784181318, "episode_return_mean": 90.45994827754672, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1148480, "num_agent_steps_trained": 1148480, "num_env_steps_sampled": 287120, "num_env_steps_trained": 287120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.7997425631213, "num_env_steps_trained_throughput_per_sec": 67.7997425631213, "timesteps_total": 287120, "num_env_steps_sampled_lifetime": 287120, "num_agent_steps_sampled_lifetime": 1148480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1148480, "timers": {"training_iteration_time_ms": 57048.418, "restore_workers_time_ms": 0.016, "training_step_time_ms": 57048.288, "sample_time_ms": 4183.935, "learn_time_ms": 52833.784, "learn_throughput": 75.709, "synch_weights_time_ms": 22.875}, "counters": {"num_env_steps_sampled": 287120, "num_env_steps_trained": 287120, "num_agent_steps_sampled": 1148480, "num_agent_steps_trained": 1148480}, "done": false, "training_iteration": 71, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-27-14", "timestamp": 1724151434, "time_this_iter_s": 59.429404973983765, "time_total_s": 3995.5545601844788, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17235f280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3995.5545601844788, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 57.071084337349404, "ram_util_percent": 83.33614457831325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.671125275243526, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.025286876083051, "policy_loss": -0.01401557626237196, "vf_loss": 7.037363133102498, "vf_explained_var": 0.3376517601114101, "kl": 0.009696620273053961, "entropy": 0.653462225135672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 136605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.607376450962491, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.101158142594433, "policy_loss": -0.015501810311556612, "vf_loss": 6.114368161448726, "vf_explained_var": 0.08096440980043361, "kl": 0.011458993961950813, "entropy": 0.7007739881674449, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 136605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 291120, "num_env_steps_trained": 291120, "num_agent_steps_sampled": 1164480, "num_agent_steps_trained": 1164480}, "env_runners": {"episode_reward_max": 261.78523601853374, "episode_reward_min": 17.65422784181318, "episode_reward_mean": 92.67895572518363, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -358.64560646626074, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 178.4, "predator_policy": 370.36476524316924}, "policy_reward_mean": {"prey_policy": -113.03002996471136, "predator_policy": 159.3695078273031}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.40000000000006, 33.36035796379795, 45.981908287454864, 68.39766468808482, 150.1602343561409, 120.53069996144788, 105.80000000000028, 17.65422784181318, 150.60452050944448, 104.95426074849867, 63.037150505089215, 146.01064739073948, 106.60195436853968, 29.6885712722827, 44.98878795187024, 28.018221830774685, 41.212561768544774, 51.9029731957673, 167.09829291784862, 82.19999999999932, 53.31719923724874, 131.23215615098692, 119.55273902812543, 113.04103363212208, 152.82691653952887, 41.673662153630985, 73.16587410818576, 78.21776766130071, 83.36373379133086, 26.51743969672549, 80.18098095786502, 121.27772264579633, 37.04157484925189, 104.54671917932069, 89.97338754303316, 158.54792923210798, 35.900007152062166, 128.09945083895863, 183.88587880317831, 44.30194346534347, 19.854045608740098, 50.30141533968675, 42.264628681401945, 34.021831437259316, 110.71842396080359, 49.413669191874455, 75.53841245846488, 135.48610232299092, 43.33991503584, 31.72487594427709, 86.52816910705853, 204.24601764639087, 122.1491082143133, 252.13579681408274, 92.38085060496132, 60.716925057616635, 44.79716644751443, 109.4819168081322, 23.25889304317776, 45.82174333483542, 120.19100105644947, 206.7392315035648, 60.40027620907789, 20.892232386246906, 27.800000000000068, 255.20603709656493, 113.48058300952161, 28.678777429935792, 151.58145623808673, 64.38286978521892, 44.8099422825318, 261.78523601853374, 103.62795472169321, 79.47998250284405, 210.36294651965247, 131.229156310891, 90.32406050785794, 37.19259462408195, 32.767479918603215, 87.870053285522, 65.97126967845773, 110.76285648774427, 172.6659383192114, 20.595657882280307, 205.44702022372124, 97.77514378813379, 199.80453411172599, 210.81819303391836, 38.880911904668054, 72.70020488460942, 36.719992748693166, 72.36289055965052, 44.022140314874214, 226.34429286953278, 40.237917715008905, 66.46164418913293, 35.371319775258215, 76.35893983788263, 74.34313104265505, 190.0026424606596], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-117.4719497579522, -181.55105639239306, -228.21549955067772, -41.614121130219104, -67.22795362823209, -258.39371537590114, -120.92831830596445, -214.29763985761025, -252.54064259626458, 68.23293814195625, 17.21069588995563, -216.50634061756483, 35.58847149501392, 25.799419410305312, -117.46459781928405, -321.49541286366644, -72.03579965416023, -16.74155103050165, -161.19649429449086, -49.498112725447314, -287.10939063012347, -61.041775849585676, -239.89227460689142, -39.89533976257701, -33.15241485078563, -158.83734310770183, -131.2712758593155, -156.24532426883738, -182.5490396997613, -117.81249482338768, -87.81935474965324, -205.99852593485946, -49.385371896603964, -218.63363744429773, -184.69055720342647, -212.68861593897049, -129.35669579776257, 9.725512889811249, -85.4495786638644, -93.83973047514189, -11.147053254271485, -74.98717900577623, -253.9823083347159, -16.783652427025082, -57.51832838158714, 61.18574552571991, -244.36415845743645, 41.31221117786864, -74.4587575718148, -18.252709998091575, -25.579894660246772, -229.48887726864336, -101.83742050642925, -204.52255560131866, -208.41340846544938, -119.15998748827703, -189.92750746993977, -63.453386965748706, -226.3676654513301, -28.234140595917538, -186.53882733805605, -152.1758012769379, -191.46567615481078, -128.11627095986734, -142.6742372099589, -358.64560646626074, -47.68894528055918, 44.837953099899366, 14.737217436325754, -248.02838817827256, -9.004119596449968, -91.54313304738298, -191.99980522851928, -191.0491333383436, -205.80294355181843, 1.4939802699004747, 165.57259670667338, -344.7649419769525, -309.0137153246723, -115.72251983395921, -196.06311577735258, -139.75404670637326, -149.05231024805684, -56.151957392475985, -220.65401735425624, -281.0750806074294, -311.76960295200814, -114.49278563854385, -108.46369822286141, -6.889793149829998, -304.84116496451844, 3.3703361961985228, 0.9573448738470958, -317.28400888149326, 81.85848547351344, -309.0503972138552, -145.72247510277148, -42.51632620042437, -182.7068703370651, 16.977571822923263, -57.182342364627566, 6.140411197630545, -54.22469545168758, 106.6609902355701, -161.33052822246503, 23.343391819065474, -47.946597293229786, 155.03771056437904, -56.02553256400392, -36.7406258300099, -106.60040846620497, -95.28082709559298, -203.4242582852838, 13.720671844943528, -110.87685457946888, -24.26197225600292, -45.93999288974714, -76.7940409995775, -118.71119820385994, -279.8776124704684, -66.46758985612318, -181.36328896731808, 61.45462336487971, -249.45967309583494, -276.63823918457217, -65.85588154336969, -143.92579763852083, -150.7107727777305, -121.48470183153887, -151.19012445693238, 75.03806250591049, 22.634428481186976, -144.46186215143575, -80.94395483541315, -217.26299933862845, -199.68304105519977, -130.3923498798331, 92.32188263707076, -107.30873467419642, -28.079368954733667, -79.41503519502459, -92.4870125950576, -229.08447345043945, 107.0738156133446, -37.44143663535761, -292.84030514797877, -141.14045005282154, -15.702414113160582, -112.37544131791269, 176.17116399316816, -137.0906825143348, 5.981966626064631, -251.04509474967165, -113.95848265656707, -166.5455152104986, -215.97813567040666, -243.30783413104032, -172.01692314745324, -241.06795477682286, 49.318447603020175, -224.9772393824115, -141.2250908534284, -234.54101845981836, -181.40029312858397, 116.43729929557767, -166.22962419760316, -61.16734789902197, -166.34148962985387, -257.60460531867506, 136.20007171839228, -270.6854150458323, -60.471935580451074, -91.62120035812347, -170.47863299967548, -258.0351078576142, 178.4, -112.28772877313153, -198.94006199484662, -104.86965212807063, 34.472904837866444, -310.2501939403821, -112.0051184246518, 26.056404398499513, 23.111099142824227, -70.3897313149679, -354.21901736580514, -43.72813219041009, -83.56916173389945, -116.04108390372836, -282.93758595090094, -162.08689079325225, -148.08422089454348, -120.63475979022523, 18.771319775258075, -198.91616717797805, -82.79813096810767, -129.8369890627671, -179.96630112344738, 80.91814871922725, -213.79964632566103], "policy_predator_policy_reward": [137.67194975795167, 193.75105639239277, 188.22223330788285, 114.9677453368115, 159.6437619718593, 211.9598153197286, 138.58594088430036, 265.0376819673591, 232.70051268364844, 101.76742612680056, 88.14047612872817, 231.6858685603287, 26.890935817096615, 17.521173277584165, 274.5951722587219, 182.01906626604122, 152.08038213158903, 87.30148906251787, 157.3523547683724, 158.2965130000645, 145.71479807036297, 265.4735189144352, 136.3411368510476, 289.4571249091603, 168.99965253039073, 129.5920597966359, 99.91615087609634, 217.28902052433878, 141.70835038690737, 203.6419720881106, 181.35316874672938, 140.48293376855744, 85.14505080127218, 224.08652030817407, 210.96698592936752, 238.3151604087964, 185.16383808148728, 101.56563774431339, 153.9941658528709, 107.49514328613473, 44.75144586472482, 94.69998563257137, 159.73790009190225, 242.26021682082546, 24.562174416929622, 91.32314746706298, 176.64237191909228, 139.45060899259755, 114.81253399040133, 130.72585011903357, 61.644505602567634, 235.09792847995328, 171.43479623147348, 208.09105398445965, 230.95456957799013, 174.83659403703658, 256.42733023634014, 80.31729799067911, 149.00855682006951, 132.11068892390327, 97.74794875589286, 321.14766081696604, 206.02420509525575, 234.83546466521847, 167.99665328230222, 370.36476524316924, 77.71173402773482, 29.68597733224691, 149.39584970755882, 173.86870857742076, 100.69530159234048, 158.3998802836004, 232.55813898524354, 186.39080673368065, 229.54921674257233, 102.85919737830434, 37.99763920879326, 325.08058486466444, 314.3152056090851, 154.72297301488976, 212.87681778402182, 142.79439030844324, 214.4184457587984, 41.08723722142055, 300.37327570641116, 243.6204509366761, 330.8112873800754, 129.47293264773614, 114.64031114383356, 111.43160418966112, 210.80110576083786, 140.0833921993558, 128.86255491931752, 263.0025215467932, 286.54323852893464, 76.1347755343981, 190.3992443476524, 41.17947199138342, 179.63263298169153, 17.821541476726967, 8.911443961125759, 128.65865631293025, 102.73916282850473, 49.070560034004316, 162.78410300682813, 97.3521416108845, 26.311181732398882, 118.73350181053455, 80.41513890215003, 104.73187009682567, 142.50189336485533, 120.09626725455942, 186.25180469214243, 48.248948195711556, 133.94878696184122, 110.6719566817626, 47.29523631562883, 98.69769061687367, 291.5040927523024, 152.90646125686118, 129.84068757499543, 238.18119230489563, 256.6878325755597, 138.05644865896093, 296.14179704498974, 106.75259989202999, 192.54362020312408, 122.98518259937427, 132.4847018315388, 167.99012445693216, 75.65760213329006, 81.87594397617742, 174.1962379209242, 164.69016207544615, 212.40663962208305, 233.2181782016802, 101.72829562781114, 87.92362785303791, 107.29026004530672, 92.48071336884169, 126.95627678923469, 89.75571328337931, 162.1242903315794, 221.67160352404903, 174.9457021665973, 258.9639943384327, 138.82398142703155, 97.49886524179463, 126.28305141821339, 20.28417242618388, 137.06223050976286, 125.27564168939897, 255.96701635886734, 199.36062155522916, 192.3381098345802, 227.37813567040627, 245.36235984158373, 202.72987735551234, 245.27106713462382, 34.34849332470165, 241.83550413284104, 190.33809578145645, 166.2885434009051, 360.41562467524136, 150.48511909472967, 71.97314412650708, 118.07349302217543, 130.03100238897972, 223.69747827461407, 103.15407554938987, 162.7500245236356, 266.1824698907814, 230.8097693835029, 231.09459808602216, 126.4770365201654, 163.97626437136714, 132.04297429392167, 218.0657283787241, 119.56965212806985, 23.527300046742813, 238.8551303152318, 220.12017479849519, 16.07431227620256, 7.121074742124528, 278.16419490431724, 190.46669409133008, 279.1328426603679, 74.50874413347442, 208.63130935466907, 230.58527821496904, 249.58825901599096, 127.04449686093712, 137.23475979022513, 0.0, 170.4606521113316, 187.61258587263694, 249.3016090258621, 134.84481220300668, 102.0109878412566, 220.8731522258368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.980261255518911, "mean_inference_ms": 6.382582236004074, "mean_action_processing_ms": 4.861293713288922, "mean_env_wait_ms": 13.604311511671968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04888570308685303, "StateBufferConnector_ms": 0.03924751281738281, "ViewRequirementAgentConnector_ms": 0.4079153537750244}, "num_episodes": 17, "episode_return_max": 261.78523601853374, "episode_return_min": 17.65422784181318, "episode_return_mean": 92.67895572518363, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164480, "num_agent_steps_trained": 1164480, "num_env_steps_sampled": 291120, "num_env_steps_trained": 291120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 57.038806069849, "num_env_steps_trained_throughput_per_sec": 57.038806069849, "timesteps_total": 291120, "num_env_steps_sampled_lifetime": 291120, "num_agent_steps_sampled_lifetime": 1164480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1164480, "timers": {"training_iteration_time_ms": 58144.742, "restore_workers_time_ms": 0.041, "training_step_time_ms": 58144.513, "sample_time_ms": 4908.339, "learn_time_ms": 53206.335, "learn_throughput": 75.179, "synch_weights_time_ms": 22.209}, "counters": {"num_env_steps_sampled": 291120, "num_env_steps_trained": 291120, "num_agent_steps_sampled": 1164480, "num_agent_steps_trained": 1164480}, "done": false, "training_iteration": 72, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-28-24", "timestamp": 1724151504, "time_this_iter_s": 70.2005820274353, "time_total_s": 4065.755142211914, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120b84700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4065.755142211914, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 66.018, "ram_util_percent": 83.40299999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.868006289257576, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.800291848813416, "policy_loss": -0.01670932894419859, "vf_loss": 6.814968981313958, "vf_explained_var": 0.33332775601003534, "kl": 0.0101608936901564, "entropy": 0.6461890805335272, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.645369793687548, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.930835384035867, "policy_loss": -0.01717358058732417, "vf_loss": 5.945920968938757, "vf_explained_var": 0.1078362985893532, "kl": 0.010440011032260757, "entropy": 0.7020990211496908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 295120, "num_env_steps_trained": 295120, "num_agent_steps_sampled": 1180480, "num_agent_steps_trained": 1180480}, "env_runners": {"episode_reward_max": 261.78523601853374, "episode_reward_min": 19.854045608740098, "episode_reward_mean": 99.15342908077083, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -358.64560646626074, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 178.4, "predator_policy": 370.36476524316924}, "policy_reward_mean": {"prey_policy": -102.70223218025939, "predator_policy": 152.27894672064477}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.16587410818576, 78.21776766130071, 83.36373379133086, 26.51743969672549, 80.18098095786502, 121.27772264579633, 37.04157484925189, 104.54671917932069, 89.97338754303316, 158.54792923210798, 35.900007152062166, 128.09945083895863, 183.88587880317831, 44.30194346534347, 19.854045608740098, 50.30141533968675, 42.264628681401945, 34.021831437259316, 110.71842396080359, 49.413669191874455, 75.53841245846488, 135.48610232299092, 43.33991503584, 31.72487594427709, 86.52816910705853, 204.24601764639087, 122.1491082143133, 252.13579681408274, 92.38085060496132, 60.716925057616635, 44.79716644751443, 109.4819168081322, 23.25889304317776, 45.82174333483542, 120.19100105644947, 206.7392315035648, 60.40027620907789, 20.892232386246906, 27.800000000000068, 255.20603709656493, 113.48058300952161, 28.678777429935792, 151.58145623808673, 64.38286978521892, 44.8099422825318, 261.78523601853374, 103.62795472169321, 79.47998250284405, 210.36294651965247, 131.229156310891, 90.32406050785794, 37.19259462408195, 32.767479918603215, 87.870053285522, 65.97126967845773, 110.76285648774427, 172.6659383192114, 20.595657882280307, 205.44702022372124, 97.77514378813379, 199.80453411172599, 210.81819303391836, 38.880911904668054, 72.70020488460942, 36.719992748693166, 72.36289055965052, 44.022140314874214, 226.34429286953278, 40.237917715008905, 66.46164418913293, 35.371319775258215, 76.35893983788263, 74.34313104265505, 190.0026424606596, 117.09999999999985, 135.642061130756, 160.28777843011824, 28.51592860419246, 111.20987442348978, 94.39754938897033, 163.4943374205823, 63.23320931040419, 44.637820997558315, 79.26995235926128, 52.41228040625476, 64.85409909369513, 88.02003285998002, 199.1984629915282, 112.39999999999941, 75.49298281587187, 80.56781835214939, 152.05450920299324, 47.3970124162299, 38.38366599349393, 218.15460635399452, 105.44559146661484, 148.6991793783207, 215.39784733251133, 97.72747712953677, 155.69999999999973], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-101.83742050642925, -204.52255560131866, -208.41340846544938, -119.15998748827703, -189.92750746993977, -63.453386965748706, -226.3676654513301, -28.234140595917538, -186.53882733805605, -152.1758012769379, -191.46567615481078, -128.11627095986734, -142.6742372099589, -358.64560646626074, -47.68894528055918, 44.837953099899366, 14.737217436325754, -248.02838817827256, -9.004119596449968, -91.54313304738298, -191.99980522851928, -191.0491333383436, -205.80294355181843, 1.4939802699004747, 165.57259670667338, -344.7649419769525, -309.0137153246723, -115.72251983395921, -196.06311577735258, -139.75404670637326, -149.05231024805684, -56.151957392475985, -220.65401735425624, -281.0750806074294, -311.76960295200814, -114.49278563854385, -108.46369822286141, -6.889793149829998, -304.84116496451844, 3.3703361961985228, 0.9573448738470958, -317.28400888149326, 81.85848547351344, -309.0503972138552, -145.72247510277148, -42.51632620042437, -182.7068703370651, 16.977571822923263, -57.182342364627566, 6.140411197630545, -54.22469545168758, 106.6609902355701, -161.33052822246503, 23.343391819065474, -47.946597293229786, 155.03771056437904, -56.02553256400392, -36.7406258300099, -106.60040846620497, -95.28082709559298, -203.4242582852838, 13.720671844943528, -110.87685457946888, -24.26197225600292, -45.93999288974714, -76.7940409995775, -118.71119820385994, -279.8776124704684, -66.46758985612318, -181.36328896731808, 61.45462336487971, -249.45967309583494, -276.63823918457217, -65.85588154336969, -143.92579763852083, -150.7107727777305, -121.48470183153887, -151.19012445693238, 75.03806250591049, 22.634428481186976, -144.46186215143575, -80.94395483541315, -217.26299933862845, -199.68304105519977, -130.3923498798331, 92.32188263707076, -107.30873467419642, -28.079368954733667, -79.41503519502459, -92.4870125950576, -229.08447345043945, 107.0738156133446, -37.44143663535761, -292.84030514797877, -141.14045005282154, -15.702414113160582, -112.37544131791269, 176.17116399316816, -137.0906825143348, 5.981966626064631, -251.04509474967165, -113.95848265656707, -166.5455152104986, -215.97813567040666, -243.30783413104032, -172.01692314745324, -241.06795477682286, 49.318447603020175, -224.9772393824115, -141.2250908534284, -234.54101845981836, -181.40029312858397, 116.43729929557767, -166.22962419760316, -61.16734789902197, -166.34148962985387, -257.60460531867506, 136.20007171839228, -270.6854150458323, -60.471935580451074, -91.62120035812347, -170.47863299967548, -258.0351078576142, 178.4, -112.28772877313153, -198.94006199484662, -104.86965212807063, 34.472904837866444, -310.2501939403821, -112.0051184246518, 26.056404398499513, 23.111099142824227, -70.3897313149679, -354.21901736580514, -43.72813219041009, -83.56916173389945, -116.04108390372836, -282.93758595090094, -162.08689079325225, -148.08422089454348, -120.63475979022523, 18.771319775258075, -198.91616717797805, -82.79813096810767, -129.8369890627671, -179.96630112344738, 80.91814871922725, -213.79964632566103, -94.93401962015572, 70.97087690434164, -141.469972773553, 28.99103345278138, -196.52788049992537, 96.83262222542686, -127.81928762581549, -100.8715288983575, -91.23505656654369, -114.82420632489485, -141.90595077106622, 32.07719612783264, -48.494184861209924, -34.342146276213214, 30.587879009609374, -246.2376233785966, -35.3974047869611, -150.7011732763747, -210.98000629570024, -59.8692189356427, 16.250311656576883, -202.5474626496096, -7.4439324792941335, -3.459637771471706, -108.8914702057844, -16.56292925654666, -16.37693618664963, -56.57347804062051, -42.85015365157841, -22.16192855031085, -84.36107955243322, -44.758040778898156, -4.757359442503093, -158.1936253681474, -294.87041860534265, 44.3038656571849, -98.0534058350888, -34.58899163863931, -121.38956994321526, -27.72863734735872, 35.995550375839315, 96.77416149993292, -183.57254930621158, -193.96260932728111, -56.71857509071957, -39.18104032984893, 81.88562134918618, -296.69882419608876, -5.581671831667924, -206.08289862642616, 99.60249196821802, -306.09103842664496], "policy_predator_policy_reward": [171.43479623147348, 208.09105398445965, 230.95456957799013, 174.83659403703658, 256.42733023634014, 80.31729799067911, 149.00855682006951, 132.11068892390327, 97.74794875589286, 321.14766081696604, 206.02420509525575, 234.83546466521847, 167.99665328230222, 370.36476524316924, 77.71173402773482, 29.68597733224691, 149.39584970755882, 173.86870857742076, 100.69530159234048, 158.3998802836004, 232.55813898524354, 186.39080673368065, 229.54921674257233, 102.85919737830434, 37.99763920879326, 325.08058486466444, 314.3152056090851, 154.72297301488976, 212.87681778402182, 142.79439030844324, 214.4184457587984, 41.08723722142055, 300.37327570641116, 243.6204509366761, 330.8112873800754, 129.47293264773614, 114.64031114383356, 111.43160418966112, 210.80110576083786, 140.0833921993558, 128.86255491931752, 263.0025215467932, 286.54323852893464, 76.1347755343981, 190.3992443476524, 41.17947199138342, 179.63263298169153, 17.821541476726967, 8.911443961125759, 128.65865631293025, 102.73916282850473, 49.070560034004316, 162.78410300682813, 97.3521416108845, 26.311181732398882, 118.73350181053455, 80.41513890215003, 104.73187009682567, 142.50189336485533, 120.09626725455942, 186.25180469214243, 48.248948195711556, 133.94878696184122, 110.6719566817626, 47.29523631562883, 98.69769061687367, 291.5040927523024, 152.90646125686118, 129.84068757499543, 238.18119230489563, 256.6878325755597, 138.05644865896093, 296.14179704498974, 106.75259989202999, 192.54362020312408, 122.98518259937427, 132.4847018315388, 167.99012445693216, 75.65760213329006, 81.87594397617742, 174.1962379209242, 164.69016207544615, 212.40663962208305, 233.2181782016802, 101.72829562781114, 87.92362785303791, 107.29026004530672, 92.48071336884169, 126.95627678923469, 89.75571328337931, 162.1242903315794, 221.67160352404903, 174.9457021665973, 258.9639943384327, 138.82398142703155, 97.49886524179463, 126.28305141821339, 20.28417242618388, 137.06223050976286, 125.27564168939897, 255.96701635886734, 199.36062155522916, 192.3381098345802, 227.37813567040627, 245.36235984158373, 202.72987735551234, 245.27106713462382, 34.34849332470165, 241.83550413284104, 190.33809578145645, 166.2885434009051, 360.41562467524136, 150.48511909472967, 71.97314412650708, 118.07349302217543, 130.03100238897972, 223.69747827461407, 103.15407554938987, 162.7500245236356, 266.1824698907814, 230.8097693835029, 231.09459808602216, 126.4770365201654, 163.97626437136714, 132.04297429392167, 218.0657283787241, 119.56965212806985, 23.527300046742813, 238.8551303152318, 220.12017479849519, 16.07431227620256, 7.121074742124528, 278.16419490431724, 190.46669409133008, 279.1328426603679, 74.50874413347442, 208.63130935466907, 230.58527821496904, 249.58825901599096, 127.04449686093712, 137.23475979022513, 0.0, 170.4606521113316, 187.61258587263694, 249.3016090258621, 134.84481220300668, 102.0109878412566, 220.8731522258368, 110.13401962015492, 30.929123095658458, 187.92014621939623, 60.2008542321314, 14.519764616901282, 245.46327208771538, 146.27903139906488, 110.92771372929926, 81.84087743629429, 235.4282598786339, 135.26756811945287, 68.9587359127508, 129.46344427631428, 116.86722428169143, 10.04225458299529, 268.840699096396, 52.9164114409116, 177.81998761998167, 213.20061056997073, 136.91856702063347, 169.05311575281738, 69.65631564646976, 50.343932479294175, 25.413736865166413, 116.05208491353778, 97.42234740877271, 164.36627285427232, 107.78260436452595, 123.47821029740656, 53.93387190448251, 151.484435272393, 53.12766787481045, 119.90600726168584, 123.6127959011145, 329.023431965556, 73.59763018559524, 71.7561414491548, 108.28326844080348, 90.77791621230195, 96.72395707176615, 42.62032952693251, 42.76456495128991, 199.63057269728333, 283.3501774028237, 198.38061733810494, 46.21817746078493, 164.90591832672152, 265.3051318526932, 211.7384790286666, 97.65356855896391, 120.86030771476608, 241.32823874366107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.099684447742941, "mean_inference_ms": 6.4703883486910705, "mean_action_processing_ms": 4.581248824309393, "mean_env_wait_ms": 13.728162273299843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0473635196685791, "StateBufferConnector_ms": 0.04893851280212402, "ViewRequirementAgentConnector_ms": 0.4037351608276367}, "num_episodes": 26, "episode_return_max": 261.78523601853374, "episode_return_min": 19.854045608740098, "episode_return_mean": 99.15342908077083, "episodes_this_iter": 26}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1180480, "num_agent_steps_trained": 1180480, "num_env_steps_sampled": 295120, "num_env_steps_trained": 295120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.55249915882008, "num_env_steps_trained_throughput_per_sec": 71.55249915882008, "timesteps_total": 295120, "num_env_steps_sampled_lifetime": 295120, "num_agent_steps_sampled_lifetime": 1180480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1180480, "timers": {"training_iteration_time_ms": 58413.165, "restore_workers_time_ms": 0.042, "training_step_time_ms": 58412.937, "sample_time_ms": 5007.814, "learn_time_ms": 53375.521, "learn_throughput": 74.941, "synch_weights_time_ms": 21.454}, "counters": {"num_env_steps_sampled": 295120, "num_env_steps_trained": 295120, "num_agent_steps_sampled": 1180480, "num_agent_steps_trained": 1180480}, "done": false, "training_iteration": 73, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-29-21", "timestamp": 1724151561, "time_this_iter_s": 55.93369698524475, "time_total_s": 4121.688839197159, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17235f430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4121.688839197159, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 51.91139240506329, "ram_util_percent": 83.06202531645572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.5339357696513, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.076490812200718, "policy_loss": -0.018284313756327032, "vf_loss": 7.092422879940618, "vf_explained_var": 0.22057316006806793, "kl": 0.011761313225093382, "entropy": 0.6529343912210414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140385.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.46888326646159, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.9145139797654736, "policy_loss": -0.015061410177972108, "vf_loss": 5.927587690807524, "vf_explained_var": 0.061732467804005535, "kl": 0.009938540259528925, "entropy": 0.7039351933532291, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140385.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}}, "num_env_steps_sampled": 299120, "num_env_steps_trained": 299120, "num_agent_steps_sampled": 1196480, "num_agent_steps_trained": 1196480}, "env_runners": {"episode_reward_max": 261.78523601853374, "episode_reward_min": -3.076368482102186, "episode_reward_mean": 101.23207659967699, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -358.99870185168874, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 178.4, "predator_policy": 360.41562467524136}, "policy_reward_mean": {"prey_policy": -95.22820878092652, "predator_policy": 145.84424708076497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.30141533968675, 42.264628681401945, 34.021831437259316, 110.71842396080359, 49.413669191874455, 75.53841245846488, 135.48610232299092, 43.33991503584, 31.72487594427709, 86.52816910705853, 204.24601764639087, 122.1491082143133, 252.13579681408274, 92.38085060496132, 60.716925057616635, 44.79716644751443, 109.4819168081322, 23.25889304317776, 45.82174333483542, 120.19100105644947, 206.7392315035648, 60.40027620907789, 20.892232386246906, 27.800000000000068, 255.20603709656493, 113.48058300952161, 28.678777429935792, 151.58145623808673, 64.38286978521892, 44.8099422825318, 261.78523601853374, 103.62795472169321, 79.47998250284405, 210.36294651965247, 131.229156310891, 90.32406050785794, 37.19259462408195, 32.767479918603215, 87.870053285522, 65.97126967845773, 110.76285648774427, 172.6659383192114, 20.595657882280307, 205.44702022372124, 97.77514378813379, 199.80453411172599, 210.81819303391836, 38.880911904668054, 72.70020488460942, 36.719992748693166, 72.36289055965052, 44.022140314874214, 226.34429286953278, 40.237917715008905, 66.46164418913293, 35.371319775258215, 76.35893983788263, 74.34313104265505, 190.0026424606596, 117.09999999999985, 135.642061130756, 160.28777843011824, 28.51592860419246, 111.20987442348978, 94.39754938897033, 163.4943374205823, 63.23320931040419, 44.637820997558315, 79.26995235926128, 52.41228040625476, 64.85409909369513, 88.02003285998002, 199.1984629915282, 112.39999999999941, 75.49298281587187, 80.56781835214939, 152.05450920299324, 47.3970124162299, 38.38366599349393, 218.15460635399452, 105.44559146661484, 148.6991793783207, 215.39784733251133, 97.72747712953677, 155.69999999999973, 38.04436804125662, 83.65572681885317, 50.155107796739, 146.92918216242072, 199.47853850486663, 83.39343223773932, 202.34649745180857, -3.076368482102186, 62.65827287099456, 145.95561863700613, 108.03036023155771, 128.63314328710047, 81.85454018575217, 75.89157281846492, 68.78921486135566], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-149.05231024805684, -56.151957392475985, -220.65401735425624, -281.0750806074294, -311.76960295200814, -114.49278563854385, -108.46369822286141, -6.889793149829998, -304.84116496451844, 3.3703361961985228, 0.9573448738470958, -317.28400888149326, 81.85848547351344, -309.0503972138552, -145.72247510277148, -42.51632620042437, -182.7068703370651, 16.977571822923263, -57.182342364627566, 6.140411197630545, -54.22469545168758, 106.6609902355701, -161.33052822246503, 23.343391819065474, -47.946597293229786, 155.03771056437904, -56.02553256400392, -36.7406258300099, -106.60040846620497, -95.28082709559298, -203.4242582852838, 13.720671844943528, -110.87685457946888, -24.26197225600292, -45.93999288974714, -76.7940409995775, -118.71119820385994, -279.8776124704684, -66.46758985612318, -181.36328896731808, 61.45462336487971, -249.45967309583494, -276.63823918457217, -65.85588154336969, -143.92579763852083, -150.7107727777305, -121.48470183153887, -151.19012445693238, 75.03806250591049, 22.634428481186976, -144.46186215143575, -80.94395483541315, -217.26299933862845, -199.68304105519977, -130.3923498798331, 92.32188263707076, -107.30873467419642, -28.079368954733667, -79.41503519502459, -92.4870125950576, -229.08447345043945, 107.0738156133446, -37.44143663535761, -292.84030514797877, -141.14045005282154, -15.702414113160582, -112.37544131791269, 176.17116399316816, -137.0906825143348, 5.981966626064631, -251.04509474967165, -113.95848265656707, -166.5455152104986, -215.97813567040666, -243.30783413104032, -172.01692314745324, -241.06795477682286, 49.318447603020175, -224.9772393824115, -141.2250908534284, -234.54101845981836, -181.40029312858397, 116.43729929557767, -166.22962419760316, -61.16734789902197, -166.34148962985387, -257.60460531867506, 136.20007171839228, -270.6854150458323, -60.471935580451074, -91.62120035812347, -170.47863299967548, -258.0351078576142, 178.4, -112.28772877313153, -198.94006199484662, -104.86965212807063, 34.472904837866444, -310.2501939403821, -112.0051184246518, 26.056404398499513, 23.111099142824227, -70.3897313149679, -354.21901736580514, -43.72813219041009, -83.56916173389945, -116.04108390372836, -282.93758595090094, -162.08689079325225, -148.08422089454348, -120.63475979022523, 18.771319775258075, -198.91616717797805, -82.79813096810767, -129.8369890627671, -179.96630112344738, 80.91814871922725, -213.79964632566103, -94.93401962015572, 70.97087690434164, -141.469972773553, 28.99103345278138, -196.52788049992537, 96.83262222542686, -127.81928762581549, -100.8715288983575, -91.23505656654369, -114.82420632489485, -141.90595077106622, 32.07719612783264, -48.494184861209924, -34.342146276213214, 30.587879009609374, -246.2376233785966, -35.3974047869611, -150.7011732763747, -210.98000629570024, -59.8692189356427, 16.250311656576883, -202.5474626496096, -7.4439324792941335, -3.459637771471706, -108.8914702057844, -16.56292925654666, -16.37693618664963, -56.57347804062051, -42.85015365157841, -22.16192855031085, -84.36107955243322, -44.758040778898156, -4.757359442503093, -158.1936253681474, -294.87041860534265, 44.3038656571849, -98.0534058350888, -34.58899163863931, -121.38956994321526, -27.72863734735872, 35.995550375839315, 96.77416149993292, -183.57254930621158, -193.96260932728111, -56.71857509071957, -39.18104032984893, 81.88562134918618, -296.69882419608876, -5.581671831667924, -206.08289862642616, 99.60249196821802, -306.09103842664496, 5.380992282350011, -73.67001246686759, -97.47877091677603, 18.0310278839644, -168.15945169934443, -19.15468822735639, 75.67976599928527, -143.3634639516307, -170.76969109196773, 121.15922769510368, -299.61227954726337, 42.36970484290465, 60.369735860454945, -262.54612247376883, -167.7948098176774, -358.99870185168874, 31.234188082703778, -200.37396564832844, -305.1216194586824, 2.4023950006382666, 14.043461512295472, -36.32213016789985, -133.34203655767882, -108.20759435772092, -114.10549425450972, -10.664523567198543, 28.80762760117077, -267.18558029702433, -7.615279802005993, -125.51278301706952], "policy_predator_policy_reward": [214.4184457587984, 41.08723722142055, 300.37327570641116, 243.6204509366761, 330.8112873800754, 129.47293264773614, 114.64031114383356, 111.43160418966112, 210.80110576083786, 140.0833921993558, 128.86255491931752, 263.0025215467932, 286.54323852893464, 76.1347755343981, 190.3992443476524, 41.17947199138342, 179.63263298169153, 17.821541476726967, 8.911443961125759, 128.65865631293025, 102.73916282850473, 49.070560034004316, 162.78410300682813, 97.3521416108845, 26.311181732398882, 118.73350181053455, 80.41513890215003, 104.73187009682567, 142.50189336485533, 120.09626725455942, 186.25180469214243, 48.248948195711556, 133.94878696184122, 110.6719566817626, 47.29523631562883, 98.69769061687367, 291.5040927523024, 152.90646125686118, 129.84068757499543, 238.18119230489563, 256.6878325755597, 138.05644865896093, 296.14179704498974, 106.75259989202999, 192.54362020312408, 122.98518259937427, 132.4847018315388, 167.99012445693216, 75.65760213329006, 81.87594397617742, 174.1962379209242, 164.69016207544615, 212.40663962208305, 233.2181782016802, 101.72829562781114, 87.92362785303791, 107.29026004530672, 92.48071336884169, 126.95627678923469, 89.75571328337931, 162.1242903315794, 221.67160352404903, 174.9457021665973, 258.9639943384327, 138.82398142703155, 97.49886524179463, 126.28305141821339, 20.28417242618388, 137.06223050976286, 125.27564168939897, 255.96701635886734, 199.36062155522916, 192.3381098345802, 227.37813567040627, 245.36235984158373, 202.72987735551234, 245.27106713462382, 34.34849332470165, 241.83550413284104, 190.33809578145645, 166.2885434009051, 360.41562467524136, 150.48511909472967, 71.97314412650708, 118.07349302217543, 130.03100238897972, 223.69747827461407, 103.15407554938987, 162.7500245236356, 266.1824698907814, 230.8097693835029, 231.09459808602216, 126.4770365201654, 163.97626437136714, 132.04297429392167, 218.0657283787241, 119.56965212806985, 23.527300046742813, 238.8551303152318, 220.12017479849519, 16.07431227620256, 7.121074742124528, 278.16419490431724, 190.46669409133008, 279.1328426603679, 74.50874413347442, 208.63130935466907, 230.58527821496904, 249.58825901599096, 127.04449686093712, 137.23475979022513, 0.0, 170.4606521113316, 187.61258587263694, 249.3016090258621, 134.84481220300668, 102.0109878412566, 220.8731522258368, 110.13401962015492, 30.929123095658458, 187.92014621939623, 60.2008542321314, 14.519764616901282, 245.46327208771538, 146.27903139906488, 110.92771372929926, 81.84087743629429, 235.4282598786339, 135.26756811945287, 68.9587359127508, 129.46344427631428, 116.86722428169143, 10.04225458299529, 268.840699096396, 52.9164114409116, 177.81998761998167, 213.20061056997073, 136.91856702063347, 169.05311575281738, 69.65631564646976, 50.343932479294175, 25.413736865166413, 116.05208491353778, 97.42234740877271, 164.36627285427232, 107.78260436452595, 123.47821029740656, 53.93387190448251, 151.484435272393, 53.12766787481045, 119.90600726168584, 123.6127959011145, 329.023431965556, 73.59763018559524, 71.7561414491548, 108.28326844080348, 90.77791621230195, 96.72395707176615, 42.62032952693251, 42.76456495128991, 199.63057269728333, 283.3501774028237, 198.38061733810494, 46.21817746078493, 164.90591832672152, 265.3051318526932, 211.7384790286666, 97.65356855896391, 120.86030771476608, 241.32823874366107, 19.163375758906295, 87.17001246686684, 99.80867585456369, 63.29479399710068, 44.46085527309581, 193.00839245034354, 112.70970384986242, 101.9031762649038, 168.17471781991682, 80.9142840818139, 48.756280053415374, 291.8797268886835, 201.56506853486644, 202.9578155302568, 170.9665763048825, 352.750566882381, 119.47725837873874, 112.32079205788014, 209.27964915758483, 239.3951939374657, 60.037247875742786, 70.27178101141939, 177.55019023266473, 192.63258396983545, 61.94742305705068, 144.67713495041014, 28.883945217293974, 285.3855802970243, 104.93170594034827, 96.98557174008283]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.09692758542135, "mean_inference_ms": 6.477332099225049, "mean_action_processing_ms": 4.534616084091381, "mean_env_wait_ms": 13.791364475367489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050083041191101074, "StateBufferConnector_ms": 0.048948049545288086, "ViewRequirementAgentConnector_ms": 0.418190598487854}, "num_episodes": 15, "episode_return_max": 261.78523601853374, "episode_return_min": -3.076368482102186, "episode_return_mean": 101.23207659967699, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1196480, "num_agent_steps_trained": 1196480, "num_env_steps_sampled": 299120, "num_env_steps_trained": 299120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.37369165625661, "num_env_steps_trained_throughput_per_sec": 67.37369165625661, "timesteps_total": 299120, "num_env_steps_sampled_lifetime": 299120, "num_agent_steps_sampled_lifetime": 1196480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1196480, "timers": {"training_iteration_time_ms": 58485.851, "restore_workers_time_ms": 0.042, "training_step_time_ms": 58485.619, "sample_time_ms": 5078.97, "learn_time_ms": 53377.145, "learn_throughput": 74.938, "synch_weights_time_ms": 20.848}, "counters": {"num_env_steps_sampled": 299120, "num_env_steps_trained": 299120, "num_agent_steps_sampled": 1196480, "num_agent_steps_trained": 1196480}, "done": false, "training_iteration": 74, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-30-20", "timestamp": 1724151620, "time_this_iter_s": 59.423418045043945, "time_total_s": 4181.112257242203, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17235f160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4181.112257242203, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 56.025000000000006, "ram_util_percent": 82.70714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.20036259315632, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.229700840087164, "policy_loss": -0.017473237454846857, "vf_loss": 7.244696471804664, "vf_explained_var": 0.3997213903242949, "kl": 0.01238808393325637, "entropy": 0.6185344408428858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.381734750762818, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.1348737338232615, "policy_loss": -0.014648628998153581, "vf_loss": 6.147205822051517, "vf_explained_var": 0.13885255380282327, "kl": 0.01158268150957252, "entropy": 0.6363045277418914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 303120, "num_env_steps_trained": 303120, "num_agent_steps_sampled": 1212480, "num_agent_steps_trained": 1212480}, "env_runners": {"episode_reward_max": 261.78523601853374, "episode_reward_min": -21.28536012255802, "episode_reward_mean": 105.46331020641192, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -358.99870185168874, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 178.4, "predator_policy": 360.41562467524136}, "policy_reward_mean": {"prey_policy": -95.85287829480298, "predator_policy": 148.5845333980089}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.82174333483542, 120.19100105644947, 206.7392315035648, 60.40027620907789, 20.892232386246906, 27.800000000000068, 255.20603709656493, 113.48058300952161, 28.678777429935792, 151.58145623808673, 64.38286978521892, 44.8099422825318, 261.78523601853374, 103.62795472169321, 79.47998250284405, 210.36294651965247, 131.229156310891, 90.32406050785794, 37.19259462408195, 32.767479918603215, 87.870053285522, 65.97126967845773, 110.76285648774427, 172.6659383192114, 20.595657882280307, 205.44702022372124, 97.77514378813379, 199.80453411172599, 210.81819303391836, 38.880911904668054, 72.70020488460942, 36.719992748693166, 72.36289055965052, 44.022140314874214, 226.34429286953278, 40.237917715008905, 66.46164418913293, 35.371319775258215, 76.35893983788263, 74.34313104265505, 190.0026424606596, 117.09999999999985, 135.642061130756, 160.28777843011824, 28.51592860419246, 111.20987442348978, 94.39754938897033, 163.4943374205823, 63.23320931040419, 44.637820997558315, 79.26995235926128, 52.41228040625476, 64.85409909369513, 88.02003285998002, 199.1984629915282, 112.39999999999941, 75.49298281587187, 80.56781835214939, 152.05450920299324, 47.3970124162299, 38.38366599349393, 218.15460635399452, 105.44559146661484, 148.6991793783207, 215.39784733251133, 97.72747712953677, 155.69999999999973, 38.04436804125662, 83.65572681885317, 50.155107796739, 146.92918216242072, 199.47853850486663, 83.39343223773932, 202.34649745180857, -3.076368482102186, 62.65827287099456, 145.95561863700613, 108.03036023155771, 128.63314328710047, 81.85454018575217, 75.89157281846492, 68.78921486135566, 216.91744619179445, 182.26131033087978, 144.11587559003726, 79.46462920935487, -21.28536012255802, 85.02319149326865, 169.59140348710744, 133.3999999999997, 75.79999999999991, 153.99427796289598, 123.41352242292207, 65.2708925314383, 31.33263266712753, 14.599999999999905, 175.47389179097343, 126.09999999999971, 150.52840431413904, 85.6253609199598], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-118.71119820385994, -279.8776124704684, -66.46758985612318, -181.36328896731808, 61.45462336487971, -249.45967309583494, -276.63823918457217, -65.85588154336969, -143.92579763852083, -150.7107727777305, -121.48470183153887, -151.19012445693238, 75.03806250591049, 22.634428481186976, -144.46186215143575, -80.94395483541315, -217.26299933862845, -199.68304105519977, -130.3923498798331, 92.32188263707076, -107.30873467419642, -28.079368954733667, -79.41503519502459, -92.4870125950576, -229.08447345043945, 107.0738156133446, -37.44143663535761, -292.84030514797877, -141.14045005282154, -15.702414113160582, -112.37544131791269, 176.17116399316816, -137.0906825143348, 5.981966626064631, -251.04509474967165, -113.95848265656707, -166.5455152104986, -215.97813567040666, -243.30783413104032, -172.01692314745324, -241.06795477682286, 49.318447603020175, -224.9772393824115, -141.2250908534284, -234.54101845981836, -181.40029312858397, 116.43729929557767, -166.22962419760316, -61.16734789902197, -166.34148962985387, -257.60460531867506, 136.20007171839228, -270.6854150458323, -60.471935580451074, -91.62120035812347, -170.47863299967548, -258.0351078576142, 178.4, -112.28772877313153, -198.94006199484662, -104.86965212807063, 34.472904837866444, -310.2501939403821, -112.0051184246518, 26.056404398499513, 23.111099142824227, -70.3897313149679, -354.21901736580514, -43.72813219041009, -83.56916173389945, -116.04108390372836, -282.93758595090094, -162.08689079325225, -148.08422089454348, -120.63475979022523, 18.771319775258075, -198.91616717797805, -82.79813096810767, -129.8369890627671, -179.96630112344738, 80.91814871922725, -213.79964632566103, -94.93401962015572, 70.97087690434164, -141.469972773553, 28.99103345278138, -196.52788049992537, 96.83262222542686, -127.81928762581549, -100.8715288983575, -91.23505656654369, -114.82420632489485, -141.90595077106622, 32.07719612783264, -48.494184861209924, -34.342146276213214, 30.587879009609374, -246.2376233785966, -35.3974047869611, -150.7011732763747, -210.98000629570024, -59.8692189356427, 16.250311656576883, -202.5474626496096, -7.4439324792941335, -3.459637771471706, -108.8914702057844, -16.56292925654666, -16.37693618664963, -56.57347804062051, -42.85015365157841, -22.16192855031085, -84.36107955243322, -44.758040778898156, -4.757359442503093, -158.1936253681474, -294.87041860534265, 44.3038656571849, -98.0534058350888, -34.58899163863931, -121.38956994321526, -27.72863734735872, 35.995550375839315, 96.77416149993292, -183.57254930621158, -193.96260932728111, -56.71857509071957, -39.18104032984893, 81.88562134918618, -296.69882419608876, -5.581671831667924, -206.08289862642616, 99.60249196821802, -306.09103842664496, 5.380992282350011, -73.67001246686759, -97.47877091677603, 18.0310278839644, -168.15945169934443, -19.15468822735639, 75.67976599928527, -143.3634639516307, -170.76969109196773, 121.15922769510368, -299.61227954726337, 42.36970484290465, 60.369735860454945, -262.54612247376883, -167.7948098176774, -358.99870185168874, 31.234188082703778, -200.37396564832844, -305.1216194586824, 2.4023950006382666, 14.043461512295472, -36.32213016789985, -133.34203655767882, -108.20759435772092, -114.10549425450972, -10.664523567198543, 28.80762760117077, -267.18558029702433, -7.615279802005993, -125.51278301706952, -39.01358044143133, -172.91086226420407, 158.0285243256184, -254.42674806684354, -147.65974258030948, 2.694739352070795, 12.236766185331385, -13.404307182236252, -281.0329953753101, -246.30206150464198, -172.56399899010134, -94.923478097077, -317.00078297808994, 95.82199868814097, -80.46919433946019, 70.90542688288295, -187.42696229898192, -56.36432957650997, -172.7248440055751, 40.9133532276246, -175.48722128689465, 27.768267359473032, -321.0774309718059, -10.673415474870545, -67.17836565851992, -4.755036167490538, -261.09364496604724, -140.43551075753444, 76.39164534436237, -125.61727554209112, 28.43383147257515, -32.19183183183006, 37.77370610502436, -271.56753279708425, -84.27409785595486, -164.55916124291565], "policy_predator_policy_reward": [291.5040927523024, 152.90646125686118, 129.84068757499543, 238.18119230489563, 256.6878325755597, 138.05644865896093, 296.14179704498974, 106.75259989202999, 192.54362020312408, 122.98518259937427, 132.4847018315388, 167.99012445693216, 75.65760213329006, 81.87594397617742, 174.1962379209242, 164.69016207544615, 212.40663962208305, 233.2181782016802, 101.72829562781114, 87.92362785303791, 107.29026004530672, 92.48071336884169, 126.95627678923469, 89.75571328337931, 162.1242903315794, 221.67160352404903, 174.9457021665973, 258.9639943384327, 138.82398142703155, 97.49886524179463, 126.28305141821339, 20.28417242618388, 137.06223050976286, 125.27564168939897, 255.96701635886734, 199.36062155522916, 192.3381098345802, 227.37813567040627, 245.36235984158373, 202.72987735551234, 245.27106713462382, 34.34849332470165, 241.83550413284104, 190.33809578145645, 166.2885434009051, 360.41562467524136, 150.48511909472967, 71.97314412650708, 118.07349302217543, 130.03100238897972, 223.69747827461407, 103.15407554938987, 162.7500245236356, 266.1824698907814, 230.8097693835029, 231.09459808602216, 126.4770365201654, 163.97626437136714, 132.04297429392167, 218.0657283787241, 119.56965212806985, 23.527300046742813, 238.8551303152318, 220.12017479849519, 16.07431227620256, 7.121074742124528, 278.16419490431724, 190.46669409133008, 279.1328426603679, 74.50874413347442, 208.63130935466907, 230.58527821496904, 249.58825901599096, 127.04449686093712, 137.23475979022513, 0.0, 170.4606521113316, 187.61258587263694, 249.3016090258621, 134.84481220300668, 102.0109878412566, 220.8731522258368, 110.13401962015492, 30.929123095658458, 187.92014621939623, 60.2008542321314, 14.519764616901282, 245.46327208771538, 146.27903139906488, 110.92771372929926, 81.84087743629429, 235.4282598786339, 135.26756811945287, 68.9587359127508, 129.46344427631428, 116.86722428169143, 10.04225458299529, 268.840699096396, 52.9164114409116, 177.81998761998167, 213.20061056997073, 136.91856702063347, 169.05311575281738, 69.65631564646976, 50.343932479294175, 25.413736865166413, 116.05208491353778, 97.42234740877271, 164.36627285427232, 107.78260436452595, 123.47821029740656, 53.93387190448251, 151.484435272393, 53.12766787481045, 119.90600726168584, 123.6127959011145, 329.023431965556, 73.59763018559524, 71.7561414491548, 108.28326844080348, 90.77791621230195, 96.72395707176615, 42.62032952693251, 42.76456495128991, 199.63057269728333, 283.3501774028237, 198.38061733810494, 46.21817746078493, 164.90591832672152, 265.3051318526932, 211.7384790286666, 97.65356855896391, 120.86030771476608, 241.32823874366107, 19.163375758906295, 87.17001246686684, 99.80867585456369, 63.29479399710068, 44.46085527309581, 193.00839245034354, 112.70970384986242, 101.9031762649038, 168.17471781991682, 80.9142840818139, 48.756280053415374, 291.8797268886835, 201.56506853486644, 202.9578155302568, 170.9665763048825, 352.750566882381, 119.47725837873874, 112.32079205788014, 209.27964915758483, 239.3951939374657, 60.037247875742786, 70.27178101141939, 177.55019023266473, 192.63258396983545, 61.94742305705068, 144.67713495041014, 28.883945217293974, 285.3855802970243, 104.93170594034827, 96.98557174008283, 165.39063554425582, 263.4512533531741, 269.6832128705356, 8.976321201569446, 226.36320448514962, 62.717674333126304, 80.63217020625956, 0.0, 220.501843179864, 285.5478535775294, 275.0180764928222, 77.49259208762435, 244.76925888146445, 146.000928895592, 95.66919433945932, 47.29457311711713, 176.79399348131395, 142.79729839417774, 178.99900381755486, 106.8067649232921, 155.41622314642652, 115.71625320391703, 215.61649426784163, 181.4052447102725, 85.1653338837247, 18.100700609412957, 261.3936449660472, 154.735510757534, 60.3063966351255, 164.3931253535767, 81.66616852742493, 48.191831831830285, 113.62673795734415, 270.69549304885476, 132.36393507115244, 202.09468494767776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.067801878499877, "mean_inference_ms": 6.481149799480348, "mean_action_processing_ms": 4.985621435115547, "mean_env_wait_ms": 13.889638172270725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039464592933654785, "StateBufferConnector_ms": 0.05156600475311279, "ViewRequirementAgentConnector_ms": 0.4358006715774536}, "num_episodes": 18, "episode_return_max": 261.78523601853374, "episode_return_min": -21.28536012255802, "episode_return_mean": 105.46331020641192, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212480, "num_agent_steps_trained": 1212480, "num_env_steps_sampled": 303120, "num_env_steps_trained": 303120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.78912123403848, "num_env_steps_trained_throughput_per_sec": 66.78912123403848, "timesteps_total": 303120, "num_env_steps_sampled_lifetime": 303120, "num_agent_steps_sampled_lifetime": 1212480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1212480, "timers": {"training_iteration_time_ms": 58778.717, "restore_workers_time_ms": 0.042, "training_step_time_ms": 58778.484, "sample_time_ms": 4954.31, "learn_time_ms": 53794.296, "learn_throughput": 74.357, "synch_weights_time_ms": 20.709}, "counters": {"num_env_steps_sampled": 303120, "num_env_steps_trained": 303120, "num_agent_steps_sampled": 1212480, "num_agent_steps_trained": 1212480}, "done": false, "training_iteration": 75, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-31-20", "timestamp": 1724151680, "time_this_iter_s": 59.93679594993591, "time_total_s": 4241.049053192139, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120b84670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4241.049053192139, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 60.987058823529416, "ram_util_percent": 83.32588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.418191348055682, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.38420460690897, "policy_loss": -0.01982964768527795, "vf_loss": 7.40129743177424, "vf_explained_var": 0.46160436979046576, "kl": 0.013684196381893738, "entropy": 0.6512231094181222, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.611058402566052, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.986275506902624, "policy_loss": -0.014176974449646733, "vf_loss": 5.998263955999303, "vf_explained_var": 0.1927455547310057, "kl": 0.010942598506524941, "entropy": 0.6337057770560027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 307120, "num_env_steps_trained": 307120, "num_agent_steps_sampled": 1228480, "num_agent_steps_trained": 1228480}, "env_runners": {"episode_reward_max": 331.8000000000002, "episode_reward_min": -21.28536012255802, "episode_reward_mean": 107.93880073425325, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -358.99870185168874, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 183.97628020751498, "predator_policy": 352.750566882381}, "policy_reward_mean": {"prey_policy": -86.22444338393908, "predator_policy": 140.19384375106566}, "custom_metrics": {}, "hist_stats": {"episode_reward": [172.6659383192114, 20.595657882280307, 205.44702022372124, 97.77514378813379, 199.80453411172599, 210.81819303391836, 38.880911904668054, 72.70020488460942, 36.719992748693166, 72.36289055965052, 44.022140314874214, 226.34429286953278, 40.237917715008905, 66.46164418913293, 35.371319775258215, 76.35893983788263, 74.34313104265505, 190.0026424606596, 117.09999999999985, 135.642061130756, 160.28777843011824, 28.51592860419246, 111.20987442348978, 94.39754938897033, 163.4943374205823, 63.23320931040419, 44.637820997558315, 79.26995235926128, 52.41228040625476, 64.85409909369513, 88.02003285998002, 199.1984629915282, 112.39999999999941, 75.49298281587187, 80.56781835214939, 152.05450920299324, 47.3970124162299, 38.38366599349393, 218.15460635399452, 105.44559146661484, 148.6991793783207, 215.39784733251133, 97.72747712953677, 155.69999999999973, 38.04436804125662, 83.65572681885317, 50.155107796739, 146.92918216242072, 199.47853850486663, 83.39343223773932, 202.34649745180857, -3.076368482102186, 62.65827287099456, 145.95561863700613, 108.03036023155771, 128.63314328710047, 81.85454018575217, 75.89157281846492, 68.78921486135566, 216.91744619179445, 182.26131033087978, 144.11587559003726, 79.46462920935487, -21.28536012255802, 85.02319149326865, 169.59140348710744, 133.3999999999997, 75.79999999999991, 153.99427796289598, 123.41352242292207, 65.2708925314383, 31.33263266712753, 14.599999999999905, 175.47389179097343, 126.09999999999971, 150.52840431413904, 85.6253609199598, 83.4000925331764, 94.12899124208866, 70.8384918092273, 173.85926961947612, 331.8000000000002, 197.5999999999996, 44.38594304767757, 116.93334459293094, 77.92569322657599, 92.79463170562411, 57.727121447010695, 107.89577192094839, 67.80000000000013, 197.76265951979946, 174.74737516376118, 127.5348629745371, 116.50428082815068, 32.05506948414271, 118.3727760081612, 105.91773744369661, 27.88226713122034, 107.90676792426783, 73.13364606957441], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [116.43729929557767, -166.22962419760316, -61.16734789902197, -166.34148962985387, -257.60460531867506, 136.20007171839228, -270.6854150458323, -60.471935580451074, -91.62120035812347, -170.47863299967548, -258.0351078576142, 178.4, -112.28772877313153, -198.94006199484662, -104.86965212807063, 34.472904837866444, -310.2501939403821, -112.0051184246518, 26.056404398499513, 23.111099142824227, -70.3897313149679, -354.21901736580514, -43.72813219041009, -83.56916173389945, -116.04108390372836, -282.93758595090094, -162.08689079325225, -148.08422089454348, -120.63475979022523, 18.771319775258075, -198.91616717797805, -82.79813096810767, -129.8369890627671, -179.96630112344738, 80.91814871922725, -213.79964632566103, -94.93401962015572, 70.97087690434164, -141.469972773553, 28.99103345278138, -196.52788049992537, 96.83262222542686, -127.81928762581549, -100.8715288983575, -91.23505656654369, -114.82420632489485, -141.90595077106622, 32.07719612783264, -48.494184861209924, -34.342146276213214, 30.587879009609374, -246.2376233785966, -35.3974047869611, -150.7011732763747, -210.98000629570024, -59.8692189356427, 16.250311656576883, -202.5474626496096, -7.4439324792941335, -3.459637771471706, -108.8914702057844, -16.56292925654666, -16.37693618664963, -56.57347804062051, -42.85015365157841, -22.16192855031085, -84.36107955243322, -44.758040778898156, -4.757359442503093, -158.1936253681474, -294.87041860534265, 44.3038656571849, -98.0534058350888, -34.58899163863931, -121.38956994321526, -27.72863734735872, 35.995550375839315, 96.77416149993292, -183.57254930621158, -193.96260932728111, -56.71857509071957, -39.18104032984893, 81.88562134918618, -296.69882419608876, -5.581671831667924, -206.08289862642616, 99.60249196821802, -306.09103842664496, 5.380992282350011, -73.67001246686759, -97.47877091677603, 18.0310278839644, -168.15945169934443, -19.15468822735639, 75.67976599928527, -143.3634639516307, -170.76969109196773, 121.15922769510368, -299.61227954726337, 42.36970484290465, 60.369735860454945, -262.54612247376883, -167.7948098176774, -358.99870185168874, 31.234188082703778, -200.37396564832844, -305.1216194586824, 2.4023950006382666, 14.043461512295472, -36.32213016789985, -133.34203655767882, -108.20759435772092, -114.10549425450972, -10.664523567198543, 28.80762760117077, -267.18558029702433, -7.615279802005993, -125.51278301706952, -39.01358044143133, -172.91086226420407, 158.0285243256184, -254.42674806684354, -147.65974258030948, 2.694739352070795, 12.236766185331385, -13.404307182236252, -281.0329953753101, -246.30206150464198, -172.56399899010134, -94.923478097077, -317.00078297808994, 95.82199868814097, -80.46919433946019, 70.90542688288295, -187.42696229898192, -56.36432957650997, -172.7248440055751, 40.9133532276246, -175.48722128689465, 27.768267359473032, -321.0774309718059, -10.673415474870545, -67.17836565851992, -4.755036167490538, -261.09364496604724, -140.43551075753444, 76.39164534436237, -125.61727554209112, 28.43383147257515, -32.19183183183006, 37.77370610502436, -271.56753279708425, -84.27409785595486, -164.55916124291565, -133.49841315911942, -96.66590540859067, -183.882859785239, -20.68825553151227, -94.34192413024235, -195.87430921525555, -176.58050946630587, 14.408963012484444, 183.97628020751498, 119.61396376080259, 47.41082808646449, 102.50949932052893, -170.2255086103568, -91.19230228056793, -27.667533694328046, 46.23372265558188, -185.2472292160801, -54.01935245120842, -129.76097467784243, -234.8575039768901, -84.17236663641111, -154.12726580648018, 16.10257909557326, -140.17304723612972, -82.14952319811385, -30.996299747895073, -60.168695180314444, -133.7892902617327, 156.13757282971724, 0.4655372180984355, -21.81237728639708, -145.29314690810088, -259.86575773014386, -9.980002848869646, -82.69978815582124, -78.50712390782202, -9.182069827501422, -128.0060151856163, -49.61290173869352, -255.60060391585193, -130.73630961263876, -64.43481588939844, -240.01213922633946, 0.7489752092455002, -20.492537972525625, -233.06991262675112], "policy_predator_policy_reward": [150.48511909472967, 71.97314412650708, 118.07349302217543, 130.03100238897972, 223.69747827461407, 103.15407554938987, 162.7500245236356, 266.1824698907814, 230.8097693835029, 231.09459808602216, 126.4770365201654, 163.97626437136714, 132.04297429392167, 218.0657283787241, 119.56965212806985, 23.527300046742813, 238.8551303152318, 220.12017479849519, 16.07431227620256, 7.121074742124528, 278.16419490431724, 190.46669409133008, 279.1328426603679, 74.50874413347442, 208.63130935466907, 230.58527821496904, 249.58825901599096, 127.04449686093712, 137.23475979022513, 0.0, 170.4606521113316, 187.61258587263694, 249.3016090258621, 134.84481220300668, 102.0109878412566, 220.8731522258368, 110.13401962015492, 30.929123095658458, 187.92014621939623, 60.2008542321314, 14.519764616901282, 245.46327208771538, 146.27903139906488, 110.92771372929926, 81.84087743629429, 235.4282598786339, 135.26756811945287, 68.9587359127508, 129.46344427631428, 116.86722428169143, 10.04225458299529, 268.840699096396, 52.9164114409116, 177.81998761998167, 213.20061056997073, 136.91856702063347, 169.05311575281738, 69.65631564646976, 50.343932479294175, 25.413736865166413, 116.05208491353778, 97.42234740877271, 164.36627285427232, 107.78260436452595, 123.47821029740656, 53.93387190448251, 151.484435272393, 53.12766787481045, 119.90600726168584, 123.6127959011145, 329.023431965556, 73.59763018559524, 71.7561414491548, 108.28326844080348, 90.77791621230195, 96.72395707176615, 42.62032952693251, 42.76456495128991, 199.63057269728333, 283.3501774028237, 198.38061733810494, 46.21817746078493, 164.90591832672152, 265.3051318526932, 211.7384790286666, 97.65356855896391, 120.86030771476608, 241.32823874366107, 19.163375758906295, 87.17001246686684, 99.80867585456369, 63.29479399710068, 44.46085527309581, 193.00839245034354, 112.70970384986242, 101.9031762649038, 168.17471781991682, 80.9142840818139, 48.756280053415374, 291.8797268886835, 201.56506853486644, 202.9578155302568, 170.9665763048825, 352.750566882381, 119.47725837873874, 112.32079205788014, 209.27964915758483, 239.3951939374657, 60.037247875742786, 70.27178101141939, 177.55019023266473, 192.63258396983545, 61.94742305705068, 144.67713495041014, 28.883945217293974, 285.3855802970243, 104.93170594034827, 96.98557174008283, 165.39063554425582, 263.4512533531741, 269.6832128705356, 8.976321201569446, 226.36320448514962, 62.717674333126304, 80.63217020625956, 0.0, 220.501843179864, 285.5478535775294, 275.0180764928222, 77.49259208762435, 244.76925888146445, 146.000928895592, 95.66919433945932, 47.29457311711713, 176.79399348131395, 142.79729839417774, 178.99900381755486, 106.8067649232921, 155.41622314642652, 115.71625320391703, 215.61649426784163, 181.4052447102725, 85.1653338837247, 18.100700609412957, 261.3936449660472, 154.735510757534, 60.3063966351255, 164.3931253535767, 81.66616852742493, 48.191831831830285, 113.62673795734415, 270.69549304885476, 132.36393507115244, 202.09468494767776, 203.27220913717719, 110.29220196370854, 158.77005562726353, 139.93005093157709, 169.16210549407418, 191.89261966065078, 174.93343619466884, 161.09737987862894, 0.7503773820612335, 27.459378649621147, 31.98917191353565, 15.690500679471041, 30.88266642257618, 274.92108751602603, 50.83583834002291, 47.531317291655284, 217.64722921608004, 99.54504567778483, 204.47447140410475, 252.93863895625176, 133.7400777931903, 162.28667609671135, 137.58597247210227, 94.38026758940296, 172.13507263634781, 8.810750309661328, 171.90829179625067, 219.81235316559582, 18.144265115945956, 0.0, 139.8701577806189, 154.7702293884155, 230.46904151924295, 155.88099988792095, 73.21425442529348, 120.0477271224916, 82.79244903398602, 172.76841198729252, 128.13679193401913, 282.9944511642231, 142.9840653526255, 80.06932728063133, 20.68958876851879, 326.48034317284294, 228.09649469848858, 98.59960197036229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.190788138703539, "mean_inference_ms": 6.586044201300256, "mean_action_processing_ms": 4.228392227667245, "mean_env_wait_ms": 14.030039223000154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04336357116699219, "StateBufferConnector_ms": 0.05354189872741699, "ViewRequirementAgentConnector_ms": 0.5245803594589233}, "num_episodes": 23, "episode_return_max": 331.8000000000002, "episode_return_min": -21.28536012255802, "episode_return_mean": 107.93880073425325, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1228480, "num_agent_steps_trained": 1228480, "num_env_steps_sampled": 307120, "num_env_steps_trained": 307120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.60696344128287, "num_env_steps_trained_throughput_per_sec": 67.60696344128287, "timesteps_total": 307120, "num_env_steps_sampled_lifetime": 307120, "num_agent_steps_sampled_lifetime": 1228480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1228480, "timers": {"training_iteration_time_ms": 58942.433, "restore_workers_time_ms": 0.042, "training_step_time_ms": 58942.22, "sample_time_ms": 5044.822, "learn_time_ms": 53866.452, "learn_throughput": 74.258, "synch_weights_time_ms": 21.836}, "counters": {"num_env_steps_sampled": 307120, "num_env_steps_trained": 307120, "num_agent_steps_sampled": 1228480, "num_agent_steps_trained": 1228480}, "done": false, "training_iteration": 76, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-32-19", "timestamp": 1724151739, "time_this_iter_s": 59.205796241760254, "time_total_s": 4300.254849433899, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120b338b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4300.254849433899, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 57.060714285714276, "ram_util_percent": 83.17023809523809}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.837753956532353, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.573836009212272, "policy_loss": -0.021157616477030964, "vf_loss": 6.5923935239277185, "vf_explained_var": 0.43808806929638777, "kl": 0.0130005885281467, "entropy": 0.6696383630472517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146055.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.074102645008653, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.63154983318672, "policy_loss": -0.01293493854448633, "vf_loss": 5.642265923061068, "vf_explained_var": 0.17697433886073885, "kl": 0.011094251314853195, "entropy": 0.6579323885459748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146055.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}}, "num_env_steps_sampled": 311120, "num_env_steps_trained": 311120, "num_agent_steps_sampled": 1244480, "num_agent_steps_trained": 1244480}, "env_runners": {"episode_reward_max": 331.8000000000002, "episode_reward_min": -21.28536012255802, "episode_reward_mean": 114.11118966645444, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -378.9538981880416, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 183.97628020751498, "predator_policy": 376.5003807934066}, "policy_reward_mean": {"prey_policy": -81.75282186576742, "predator_policy": 138.80841669899462}, "custom_metrics": {}, "hist_stats": {"episode_reward": [111.20987442348978, 94.39754938897033, 163.4943374205823, 63.23320931040419, 44.637820997558315, 79.26995235926128, 52.41228040625476, 64.85409909369513, 88.02003285998002, 199.1984629915282, 112.39999999999941, 75.49298281587187, 80.56781835214939, 152.05450920299324, 47.3970124162299, 38.38366599349393, 218.15460635399452, 105.44559146661484, 148.6991793783207, 215.39784733251133, 97.72747712953677, 155.69999999999973, 38.04436804125662, 83.65572681885317, 50.155107796739, 146.92918216242072, 199.47853850486663, 83.39343223773932, 202.34649745180857, -3.076368482102186, 62.65827287099456, 145.95561863700613, 108.03036023155771, 128.63314328710047, 81.85454018575217, 75.89157281846492, 68.78921486135566, 216.91744619179445, 182.26131033087978, 144.11587559003726, 79.46462920935487, -21.28536012255802, 85.02319149326865, 169.59140348710744, 133.3999999999997, 75.79999999999991, 153.99427796289598, 123.41352242292207, 65.2708925314383, 31.33263266712753, 14.599999999999905, 175.47389179097343, 126.09999999999971, 150.52840431413904, 85.6253609199598, 83.4000925331764, 94.12899124208866, 70.8384918092273, 173.85926961947612, 331.8000000000002, 197.5999999999996, 44.38594304767757, 116.93334459293094, 77.92569322657599, 92.79463170562411, 57.727121447010695, 107.89577192094839, 67.80000000000013, 197.76265951979946, 174.74737516376118, 127.5348629745371, 116.50428082815068, 32.05506948414271, 118.3727760081612, 105.91773744369661, 27.88226713122034, 107.90676792426783, 73.13364606957441, 140.31535184890285, 76.40000000000026, 156.23612567548088, 243.45520085665584, 116.54920915709471, 78.91007324718083, 171.4135215736518, 113.20969298711361, 42.52626468878164, 69.11183172780973, 120.36679067876508, 167.3670956208757, 198.0321906166709, 52.63247763982392, 76.0511818117752, 171.09999999999948, 134.85974108067433, 210.24594367294293, 60.78713967345692, 184.5063747980047, 268.94957801025805, 86.67139168088269], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-91.23505656654369, -114.82420632489485, -141.90595077106622, 32.07719612783264, -48.494184861209924, -34.342146276213214, 30.587879009609374, -246.2376233785966, -35.3974047869611, -150.7011732763747, -210.98000629570024, -59.8692189356427, 16.250311656576883, -202.5474626496096, -7.4439324792941335, -3.459637771471706, -108.8914702057844, -16.56292925654666, -16.37693618664963, -56.57347804062051, -42.85015365157841, -22.16192855031085, -84.36107955243322, -44.758040778898156, -4.757359442503093, -158.1936253681474, -294.87041860534265, 44.3038656571849, -98.0534058350888, -34.58899163863931, -121.38956994321526, -27.72863734735872, 35.995550375839315, 96.77416149993292, -183.57254930621158, -193.96260932728111, -56.71857509071957, -39.18104032984893, 81.88562134918618, -296.69882419608876, -5.581671831667924, -206.08289862642616, 99.60249196821802, -306.09103842664496, 5.380992282350011, -73.67001246686759, -97.47877091677603, 18.0310278839644, -168.15945169934443, -19.15468822735639, 75.67976599928527, -143.3634639516307, -170.76969109196773, 121.15922769510368, -299.61227954726337, 42.36970484290465, 60.369735860454945, -262.54612247376883, -167.7948098176774, -358.99870185168874, 31.234188082703778, -200.37396564832844, -305.1216194586824, 2.4023950006382666, 14.043461512295472, -36.32213016789985, -133.34203655767882, -108.20759435772092, -114.10549425450972, -10.664523567198543, 28.80762760117077, -267.18558029702433, -7.615279802005993, -125.51278301706952, -39.01358044143133, -172.91086226420407, 158.0285243256184, -254.42674806684354, -147.65974258030948, 2.694739352070795, 12.236766185331385, -13.404307182236252, -281.0329953753101, -246.30206150464198, -172.56399899010134, -94.923478097077, -317.00078297808994, 95.82199868814097, -80.46919433946019, 70.90542688288295, -187.42696229898192, -56.36432957650997, -172.7248440055751, 40.9133532276246, -175.48722128689465, 27.768267359473032, -321.0774309718059, -10.673415474870545, -67.17836565851992, -4.755036167490538, -261.09364496604724, -140.43551075753444, 76.39164534436237, -125.61727554209112, 28.43383147257515, -32.19183183183006, 37.77370610502436, -271.56753279708425, -84.27409785595486, -164.55916124291565, -133.49841315911942, -96.66590540859067, -183.882859785239, -20.68825553151227, -94.34192413024235, -195.87430921525555, -176.58050946630587, 14.408963012484444, 183.97628020751498, 119.61396376080259, 47.41082808646449, 102.50949932052893, -170.2255086103568, -91.19230228056793, -27.667533694328046, 46.23372265558188, -185.2472292160801, -54.01935245120842, -129.76097467784243, -234.8575039768901, -84.17236663641111, -154.12726580648018, 16.10257909557326, -140.17304723612972, -82.14952319811385, -30.996299747895073, -60.168695180314444, -133.7892902617327, 156.13757282971724, 0.4655372180984355, -21.81237728639708, -145.29314690810088, -259.86575773014386, -9.980002848869646, -82.69978815582124, -78.50712390782202, -9.182069827501422, -128.0060151856163, -49.61290173869352, -255.60060391585193, -130.73630961263876, -64.43481588939844, -240.01213922633946, 0.7489752092455002, -20.492537972525625, -233.06991262675112, 52.442637472917816, -83.36414764185363, 15.492523269988856, -20.099086750740184, -112.93814331864613, 38.83430014973219, 99.32588382435378, -7.186237854053658, -296.06501143426806, -44.01569060750536, -328.96094086521146, 6.66150348029478, 79.33021510026776, -181.22427044676505, -18.892689092456365, -216.3712187946845, -62.95786058685264, -124.09700832506523, -378.9538981880416, -61.34862934129239, 38.54514620659524, -225.36562079379718, -118.39720787064553, 138.51832857567896, 27.884164151874725, -327.58085681466355, -44.201092077882734, -206.9394659476817, 11.114313683634814, -157.78416647839782, 126.67462036061855, -27.69032513181977, -127.82757855100411, 76.77563951787425, -261.0831296777316, -10.601805614608864, -64.45441102821569, -265.25907911374225, -186.95176340083907, 108.86903512297904, 182.17443024315017, -156.41075968712295, -343.4798072931854, -26.273376488093632], "policy_predator_policy_reward": [81.84087743629429, 235.4282598786339, 135.26756811945287, 68.9587359127508, 129.46344427631428, 116.86722428169143, 10.04225458299529, 268.840699096396, 52.9164114409116, 177.81998761998167, 213.20061056997073, 136.91856702063347, 169.05311575281738, 69.65631564646976, 50.343932479294175, 25.413736865166413, 116.05208491353778, 97.42234740877271, 164.36627285427232, 107.78260436452595, 123.47821029740656, 53.93387190448251, 151.484435272393, 53.12766787481045, 119.90600726168584, 123.6127959011145, 329.023431965556, 73.59763018559524, 71.7561414491548, 108.28326844080348, 90.77791621230195, 96.72395707176615, 42.62032952693251, 42.76456495128991, 199.63057269728333, 283.3501774028237, 198.38061733810494, 46.21817746078493, 164.90591832672152, 265.3051318526932, 211.7384790286666, 97.65356855896391, 120.86030771476608, 241.32823874366107, 19.163375758906295, 87.17001246686684, 99.80867585456369, 63.29479399710068, 44.46085527309581, 193.00839245034354, 112.70970384986242, 101.9031762649038, 168.17471781991682, 80.9142840818139, 48.756280053415374, 291.8797268886835, 201.56506853486644, 202.9578155302568, 170.9665763048825, 352.750566882381, 119.47725837873874, 112.32079205788014, 209.27964915758483, 239.3951939374657, 60.037247875742786, 70.27178101141939, 177.55019023266473, 192.63258396983545, 61.94742305705068, 144.67713495041014, 28.883945217293974, 285.3855802970243, 104.93170594034827, 96.98557174008283, 165.39063554425582, 263.4512533531741, 269.6832128705356, 8.976321201569446, 226.36320448514962, 62.717674333126304, 80.63217020625956, 0.0, 220.501843179864, 285.5478535775294, 275.0180764928222, 77.49259208762435, 244.76925888146445, 146.000928895592, 95.66919433945932, 47.29457311711713, 176.79399348131395, 142.79729839417774, 178.99900381755486, 106.8067649232921, 155.41622314642652, 115.71625320391703, 215.61649426784163, 181.4052447102725, 85.1653338837247, 18.100700609412957, 261.3936449660472, 154.735510757534, 60.3063966351255, 164.3931253535767, 81.66616852742493, 48.191831831830285, 113.62673795734415, 270.69549304885476, 132.36393507115244, 202.09468494767776, 203.27220913717719, 110.29220196370854, 158.77005562726353, 139.93005093157709, 169.16210549407418, 191.89261966065078, 174.93343619466884, 161.09737987862894, 0.7503773820612335, 27.459378649621147, 31.98917191353565, 15.690500679471041, 30.88266642257618, 274.92108751602603, 50.83583834002291, 47.531317291655284, 217.64722921608004, 99.54504567778483, 204.47447140410475, 252.93863895625176, 133.7400777931903, 162.28667609671135, 137.58597247210227, 94.38026758940296, 172.13507263634781, 8.810750309661328, 171.90829179625067, 219.81235316559582, 18.144265115945956, 0.0, 139.8701577806189, 154.7702293884155, 230.46904151924295, 155.88099988792095, 73.21425442529348, 120.0477271224916, 82.79244903398602, 172.76841198729252, 128.13679193401913, 282.9944511642231, 142.9840653526255, 80.06932728063133, 20.68958876851879, 326.48034317284294, 228.09649469848858, 98.59960197036229, 159.6241671065192, 11.612694911319453, 44.10747673001128, 36.89908675074042, 139.2115297031671, 91.12843914122845, 53.05670603641179, 98.25884884994392, 290.06090406876797, 166.56900713010003, 269.62410148163707, 131.58540915046103, 63.769784899732244, 209.5377920204169, 145.85466599504673, 202.6189348792082, 79.05786058685187, 150.52327301384676, 132.91397846373687, 376.5003807934066, 116.24555278747839, 190.94171247848868, 134.03633668827152, 13.20963822757071, 263.13156859080186, 234.59731468865863, 102.71545690985484, 201.0575787555332, 115.39275624494323, 107.32827836159531, 0.9927608603799211, 71.12294391082138, 94.54694791126899, 91.36473220253504, 221.29819926023163, 260.63267970505154, 134.51942862084306, 255.98120119457136, 170.85184776098077, 91.73725531488394, 1.5874844966546875, 241.5984229575762, 186.08494620122693, 270.3396292609354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.193669285121922, "mean_inference_ms": 6.575382352526284, "mean_action_processing_ms": 4.421928456213546, "mean_env_wait_ms": 14.075115985598183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023331522941589355, "StateBufferConnector_ms": 0.0213167667388916, "ViewRequirementAgentConnector_ms": 0.3684673309326172}, "num_episodes": 22, "episode_return_max": 331.8000000000002, "episode_return_min": -21.28536012255802, "episode_return_mean": 114.11118966645444, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1244480, "num_agent_steps_trained": 1244480, "num_env_steps_sampled": 311120, "num_env_steps_trained": 311120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.22142177253417, "num_env_steps_trained_throughput_per_sec": 69.22142177253417, "timesteps_total": 311120, "num_env_steps_sampled_lifetime": 311120, "num_agent_steps_sampled_lifetime": 1244480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1244480, "timers": {"training_iteration_time_ms": 59055.272, "restore_workers_time_ms": 0.042, "training_step_time_ms": 59055.067, "sample_time_ms": 5002.696, "learn_time_ms": 54022.391, "learn_throughput": 74.043, "synch_weights_time_ms": 20.904}, "counters": {"num_env_steps_sampled": 311120, "num_env_steps_trained": 311120, "num_agent_steps_sampled": 1244480, "num_agent_steps_trained": 1244480}, "done": false, "training_iteration": 77, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-33-17", "timestamp": 1724151797, "time_this_iter_s": 57.841468811035156, "time_total_s": 4358.096318244934, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120082b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4358.096318244934, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 55.26219512195123, "ram_util_percent": 83.3451219512195}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.056743436894088, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.981929944558118, "policy_loss": -0.017505568672444613, "vf_loss": 6.997138901866933, "vf_explained_var": 0.4590305662029004, "kl": 0.011483010294029204, "entropy": 0.6622914778807807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 147945.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.6777310464748, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.656502236260308, "policy_loss": -0.013704246114791622, "vf_loss": 5.668067894032393, "vf_explained_var": 0.13352801500174102, "kl": 0.010692896294190731, "entropy": 0.6767973837398348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 147945.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}}, "num_env_steps_sampled": 315120, "num_env_steps_trained": 315120, "num_agent_steps_sampled": 1260480, "num_agent_steps_trained": 1260480}, "env_runners": {"episode_reward_max": 331.8000000000002, "episode_reward_min": -21.28536012255802, "episode_reward_mean": 116.964597926607, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -418.0545651083237, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.41954470563945, "predator_policy": 376.5003807934066}, "policy_reward_mean": {"prey_policy": -84.76487093291423, "predator_policy": 143.2471698962177}, "custom_metrics": {}, "hist_stats": {"episode_reward": [215.39784733251133, 97.72747712953677, 155.69999999999973, 38.04436804125662, 83.65572681885317, 50.155107796739, 146.92918216242072, 199.47853850486663, 83.39343223773932, 202.34649745180857, -3.076368482102186, 62.65827287099456, 145.95561863700613, 108.03036023155771, 128.63314328710047, 81.85454018575217, 75.89157281846492, 68.78921486135566, 216.91744619179445, 182.26131033087978, 144.11587559003726, 79.46462920935487, -21.28536012255802, 85.02319149326865, 169.59140348710744, 133.3999999999997, 75.79999999999991, 153.99427796289598, 123.41352242292207, 65.2708925314383, 31.33263266712753, 14.599999999999905, 175.47389179097343, 126.09999999999971, 150.52840431413904, 85.6253609199598, 83.4000925331764, 94.12899124208866, 70.8384918092273, 173.85926961947612, 331.8000000000002, 197.5999999999996, 44.38594304767757, 116.93334459293094, 77.92569322657599, 92.79463170562411, 57.727121447010695, 107.89577192094839, 67.80000000000013, 197.76265951979946, 174.74737516376118, 127.5348629745371, 116.50428082815068, 32.05506948414271, 118.3727760081612, 105.91773744369661, 27.88226713122034, 107.90676792426783, 73.13364606957441, 140.31535184890285, 76.40000000000026, 156.23612567548088, 243.45520085665584, 116.54920915709471, 78.91007324718083, 171.4135215736518, 113.20969298711361, 42.52626468878164, 69.11183172780973, 120.36679067876508, 167.3670956208757, 198.0321906166709, 52.63247763982392, 76.0511818117752, 171.09999999999948, 134.85974108067433, 210.24594367294293, 60.78713967345692, 184.5063747980047, 268.94957801025805, 86.67139168088269, 199.39666682614114, 47.20434854774745, 201.9074070788348, 131.60340829703208, 182.862039160595, 219.48749797615474, 150.09650973238442, 51.24088735481476, 131.18622867847344, 57.700000000000195, 176.22437926408222, 140.09031451854727, 85.3111821932249, 143.18838196137241, 136.24956837472706, 66.7177062551595, 10.037111820392003, 41.44050104911625, 52.71967215785174], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [81.88562134918618, -296.69882419608876, -5.581671831667924, -206.08289862642616, 99.60249196821802, -306.09103842664496, 5.380992282350011, -73.67001246686759, -97.47877091677603, 18.0310278839644, -168.15945169934443, -19.15468822735639, 75.67976599928527, -143.3634639516307, -170.76969109196773, 121.15922769510368, -299.61227954726337, 42.36970484290465, 60.369735860454945, -262.54612247376883, -167.7948098176774, -358.99870185168874, 31.234188082703778, -200.37396564832844, -305.1216194586824, 2.4023950006382666, 14.043461512295472, -36.32213016789985, -133.34203655767882, -108.20759435772092, -114.10549425450972, -10.664523567198543, 28.80762760117077, -267.18558029702433, -7.615279802005993, -125.51278301706952, -39.01358044143133, -172.91086226420407, 158.0285243256184, -254.42674806684354, -147.65974258030948, 2.694739352070795, 12.236766185331385, -13.404307182236252, -281.0329953753101, -246.30206150464198, -172.56399899010134, -94.923478097077, -317.00078297808994, 95.82199868814097, -80.46919433946019, 70.90542688288295, -187.42696229898192, -56.36432957650997, -172.7248440055751, 40.9133532276246, -175.48722128689465, 27.768267359473032, -321.0774309718059, -10.673415474870545, -67.17836565851992, -4.755036167490538, -261.09364496604724, -140.43551075753444, 76.39164534436237, -125.61727554209112, 28.43383147257515, -32.19183183183006, 37.77370610502436, -271.56753279708425, -84.27409785595486, -164.55916124291565, -133.49841315911942, -96.66590540859067, -183.882859785239, -20.68825553151227, -94.34192413024235, -195.87430921525555, -176.58050946630587, 14.408963012484444, 183.97628020751498, 119.61396376080259, 47.41082808646449, 102.50949932052893, -170.2255086103568, -91.19230228056793, -27.667533694328046, 46.23372265558188, -185.2472292160801, -54.01935245120842, -129.76097467784243, -234.8575039768901, -84.17236663641111, -154.12726580648018, 16.10257909557326, -140.17304723612972, -82.14952319811385, -30.996299747895073, -60.168695180314444, -133.7892902617327, 156.13757282971724, 0.4655372180984355, -21.81237728639708, -145.29314690810088, -259.86575773014386, -9.980002848869646, -82.69978815582124, -78.50712390782202, -9.182069827501422, -128.0060151856163, -49.61290173869352, -255.60060391585193, -130.73630961263876, -64.43481588939844, -240.01213922633946, 0.7489752092455002, -20.492537972525625, -233.06991262675112, 52.442637472917816, -83.36414764185363, 15.492523269988856, -20.099086750740184, -112.93814331864613, 38.83430014973219, 99.32588382435378, -7.186237854053658, -296.06501143426806, -44.01569060750536, -328.96094086521146, 6.66150348029478, 79.33021510026776, -181.22427044676505, -18.892689092456365, -216.3712187946845, -62.95786058685264, -124.09700832506523, -378.9538981880416, -61.34862934129239, 38.54514620659524, -225.36562079379718, -118.39720787064553, 138.51832857567896, 27.884164151874725, -327.58085681466355, -44.201092077882734, -206.9394659476817, 11.114313683634814, -157.78416647839782, 126.67462036061855, -27.69032513181977, -127.82757855100411, 76.77563951787425, -261.0831296777316, -10.601805614608864, -64.45441102821569, -265.25907911374225, -186.95176340083907, 108.86903512297904, 182.17443024315017, -156.41075968712295, -343.4798072931854, -26.273376488093632, -121.04003450699133, 139.2614059401979, -102.81122188961162, -72.21664298693909, -329.55901813919115, 137.8845537359675, -79.56439908470055, -93.10496219078345, -71.01606332294986, 65.51000228776944, -135.53054782888822, 184.41954470563945, 33.462676202977164, -126.1787963994451, -177.37969060829994, -2.8576333424488833, -418.0545651083237, 58.34970808021329, -98.80403413330927, -170.92186837722423, -143.69160661997873, -12.44836149752362, 31.415990335396323, -12.933161675642415, -251.4203636654193, -29.86711493403947, 11.628416923900575, -197.3961530163161, -70.84012522027153, -42.8111408225285, 4.248019442822735, -208.36763685022868, -176.61672323207986, -179.28708142716968, -113.66953636627724, -62.73519001010522, -242.23863255338551, -222.22966377795575], "policy_predator_policy_reward": [164.90591832672152, 265.3051318526932, 211.7384790286666, 97.65356855896391, 120.86030771476608, 241.32823874366107, 19.163375758906295, 87.17001246686684, 99.80867585456369, 63.29479399710068, 44.46085527309581, 193.00839245034354, 112.70970384986242, 101.9031762649038, 168.17471781991682, 80.9142840818139, 48.756280053415374, 291.8797268886835, 201.56506853486644, 202.9578155302568, 170.9665763048825, 352.750566882381, 119.47725837873874, 112.32079205788014, 209.27964915758483, 239.3951939374657, 60.037247875742786, 70.27178101141939, 177.55019023266473, 192.63258396983545, 61.94742305705068, 144.67713495041014, 28.883945217293974, 285.3855802970243, 104.93170594034827, 96.98557174008283, 165.39063554425582, 263.4512533531741, 269.6832128705356, 8.976321201569446, 226.36320448514962, 62.717674333126304, 80.63217020625956, 0.0, 220.501843179864, 285.5478535775294, 275.0180764928222, 77.49259208762435, 244.76925888146445, 146.000928895592, 95.66919433945932, 47.29457311711713, 176.79399348131395, 142.79729839417774, 178.99900381755486, 106.8067649232921, 155.41622314642652, 115.71625320391703, 215.61649426784163, 181.4052447102725, 85.1653338837247, 18.100700609412957, 261.3936449660472, 154.735510757534, 60.3063966351255, 164.3931253535767, 81.66616852742493, 48.191831831830285, 113.62673795734415, 270.69549304885476, 132.36393507115244, 202.09468494767776, 203.27220913717719, 110.29220196370854, 158.77005562726353, 139.93005093157709, 169.16210549407418, 191.89261966065078, 174.93343619466884, 161.09737987862894, 0.7503773820612335, 27.459378649621147, 31.98917191353565, 15.690500679471041, 30.88266642257618, 274.92108751602603, 50.83583834002291, 47.531317291655284, 217.64722921608004, 99.54504567778483, 204.47447140410475, 252.93863895625176, 133.7400777931903, 162.28667609671135, 137.58597247210227, 94.38026758940296, 172.13507263634781, 8.810750309661328, 171.90829179625067, 219.81235316559582, 18.144265115945956, 0.0, 139.8701577806189, 154.7702293884155, 230.46904151924295, 155.88099988792095, 73.21425442529348, 120.0477271224916, 82.79244903398602, 172.76841198729252, 128.13679193401913, 282.9944511642231, 142.9840653526255, 80.06932728063133, 20.68958876851879, 326.48034317284294, 228.09649469848858, 98.59960197036229, 159.6241671065192, 11.612694911319453, 44.10747673001128, 36.89908675074042, 139.2115297031671, 91.12843914122845, 53.05670603641179, 98.25884884994392, 290.06090406876797, 166.56900713010003, 269.62410148163707, 131.58540915046103, 63.769784899732244, 209.5377920204169, 145.85466599504673, 202.6189348792082, 79.05786058685187, 150.52327301384676, 132.91397846373687, 376.5003807934066, 116.24555278747839, 190.94171247848868, 134.03633668827152, 13.20963822757071, 263.13156859080186, 234.59731468865863, 102.71545690985484, 201.0575787555332, 115.39275624494323, 107.32827836159531, 0.9927608603799211, 71.12294391082138, 94.54694791126899, 91.36473220253504, 221.29819926023163, 260.63267970505154, 134.51942862084306, 255.98120119457136, 170.85184776098077, 91.73725531488394, 1.5874844966546875, 241.5984229575762, 186.08494620122693, 270.3396292609354, 129.52823114310644, 51.647064249828034, 96.1753606383226, 126.05685278597508, 283.7588663931184, 109.8230050889399, 228.0469726180094, 76.22579695450672, 137.95811952812969, 50.4099806676456, 160.0347306419117, 10.563770457491863, 135.96506990645986, 106.8475600223925, 3.5130973800795764, 227.96511392548385, 128.08073322222432, 362.8103524843603, 275.3145653307742, 52.11133717975812, 154.9368569379776, 177.4274904436069, 1.6903145185475688, 119.9171713402463, 219.97473919077254, 146.62392160191118, 208.31391007516012, 120.64220797862781, 52.12768443881403, 197.77314997871287, 127.63127986580074, 143.20604379676433, 156.56708146909455, 209.37383501054606, 125.36953636627669, 92.47569105922048, 218.56392960576545, 298.62403888342664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.16438222130014, "mean_inference_ms": 6.569112418247105, "mean_action_processing_ms": 4.395559061660413, "mean_env_wait_ms": 14.152158593902623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023296594619750977, "StateBufferConnector_ms": 0.0115203857421875, "ViewRequirementAgentConnector_ms": 0.3531564474105835}, "num_episodes": 19, "episode_return_max": 331.8000000000002, "episode_return_min": -21.28536012255802, "episode_return_mean": 116.964597926607, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260480, "num_agent_steps_trained": 1260480, "num_env_steps_sampled": 315120, "num_env_steps_trained": 315120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.6265294127023, "num_env_steps_trained_throughput_per_sec": 73.6265294127023, "timesteps_total": 315120, "num_env_steps_sampled_lifetime": 315120, "num_agent_steps_sampled_lifetime": 1260480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1260480, "timers": {"training_iteration_time_ms": 59111.802, "restore_workers_time_ms": 0.042, "training_step_time_ms": 59111.594, "sample_time_ms": 5054.019, "learn_time_ms": 54026.012, "learn_throughput": 74.038, "synch_weights_time_ms": 22.481}, "counters": {"num_env_steps_sampled": 315120, "num_env_steps_trained": 315120, "num_agent_steps_sampled": 1260480, "num_agent_steps_trained": 1260480}, "done": false, "training_iteration": 78, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-34-11", "timestamp": 1724151851, "time_this_iter_s": 54.35929775238037, "time_total_s": 4412.455615997314, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120b28b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4412.455615997314, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 51.012987012987026, "ram_util_percent": 83.2961038961039}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.465174778050216, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.676201643262591, "policy_loss": -0.01784286399707001, "vf_loss": 6.692086063364826, "vf_explained_var": 0.5112236673554416, "kl": 0.00979215788024246, "entropy": 0.6880725867849179, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 149835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.102397892020997, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.026964575903756, "policy_loss": -0.013308033666809991, "vf_loss": 5.038346575933789, "vf_explained_var": 0.20573752554005417, "kl": 0.009630135945340117, "entropy": 0.7550716289767513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 149835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 319120, "num_env_steps_trained": 319120, "num_agent_steps_sampled": 1276480, "num_agent_steps_trained": 1276480}, "env_runners": {"episode_reward_max": 331.8000000000002, "episode_reward_min": -21.28536012255802, "episode_reward_mean": 120.84272881710247, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -418.0545651083237, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.902729791814, "predator_policy": 376.5003807934066}, "policy_reward_mean": {"prey_policy": -82.71244245140005, "predator_policy": 143.13380685995125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [68.78921486135566, 216.91744619179445, 182.26131033087978, 144.11587559003726, 79.46462920935487, -21.28536012255802, 85.02319149326865, 169.59140348710744, 133.3999999999997, 75.79999999999991, 153.99427796289598, 123.41352242292207, 65.2708925314383, 31.33263266712753, 14.599999999999905, 175.47389179097343, 126.09999999999971, 150.52840431413904, 85.6253609199598, 83.4000925331764, 94.12899124208866, 70.8384918092273, 173.85926961947612, 331.8000000000002, 197.5999999999996, 44.38594304767757, 116.93334459293094, 77.92569322657599, 92.79463170562411, 57.727121447010695, 107.89577192094839, 67.80000000000013, 197.76265951979946, 174.74737516376118, 127.5348629745371, 116.50428082815068, 32.05506948414271, 118.3727760081612, 105.91773744369661, 27.88226713122034, 107.90676792426783, 73.13364606957441, 140.31535184890285, 76.40000000000026, 156.23612567548088, 243.45520085665584, 116.54920915709471, 78.91007324718083, 171.4135215736518, 113.20969298711361, 42.52626468878164, 69.11183172780973, 120.36679067876508, 167.3670956208757, 198.0321906166709, 52.63247763982392, 76.0511818117752, 171.09999999999948, 134.85974108067433, 210.24594367294293, 60.78713967345692, 184.5063747980047, 268.94957801025805, 86.67139168088269, 199.39666682614114, 47.20434854774745, 201.9074070788348, 131.60340829703208, 182.862039160595, 219.48749797615474, 150.09650973238442, 51.24088735481476, 131.18622867847344, 57.700000000000195, 176.22437926408222, 140.09031451854727, 85.3111821932249, 143.18838196137241, 136.24956837472706, 66.7177062551595, 10.037111820392003, 41.44050104911625, 52.71967215785174, 184.93243071616033, 191.9540474134709, 165.60530598323336, 220.62594257323445, 123.41597747748631, 82.51860228598028, 97.98859481368291, 141.0810545410499, 109.11078718915437, 170.65970023892416, 24.199999999999996, 140.920612687664, 212.9999999999993, 138.87566258509318, 3.353314364683846, 76.72725569085414, 175.61911751337814], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-7.615279802005993, -125.51278301706952, -39.01358044143133, -172.91086226420407, 158.0285243256184, -254.42674806684354, -147.65974258030948, 2.694739352070795, 12.236766185331385, -13.404307182236252, -281.0329953753101, -246.30206150464198, -172.56399899010134, -94.923478097077, -317.00078297808994, 95.82199868814097, -80.46919433946019, 70.90542688288295, -187.42696229898192, -56.36432957650997, -172.7248440055751, 40.9133532276246, -175.48722128689465, 27.768267359473032, -321.0774309718059, -10.673415474870545, -67.17836565851992, -4.755036167490538, -261.09364496604724, -140.43551075753444, 76.39164534436237, -125.61727554209112, 28.43383147257515, -32.19183183183006, 37.77370610502436, -271.56753279708425, -84.27409785595486, -164.55916124291565, -133.49841315911942, -96.66590540859067, -183.882859785239, -20.68825553151227, -94.34192413024235, -195.87430921525555, -176.58050946630587, 14.408963012484444, 183.97628020751498, 119.61396376080259, 47.41082808646449, 102.50949932052893, -170.2255086103568, -91.19230228056793, -27.667533694328046, 46.23372265558188, -185.2472292160801, -54.01935245120842, -129.76097467784243, -234.8575039768901, -84.17236663641111, -154.12726580648018, 16.10257909557326, -140.17304723612972, -82.14952319811385, -30.996299747895073, -60.168695180314444, -133.7892902617327, 156.13757282971724, 0.4655372180984355, -21.81237728639708, -145.29314690810088, -259.86575773014386, -9.980002848869646, -82.69978815582124, -78.50712390782202, -9.182069827501422, -128.0060151856163, -49.61290173869352, -255.60060391585193, -130.73630961263876, -64.43481588939844, -240.01213922633946, 0.7489752092455002, -20.492537972525625, -233.06991262675112, 52.442637472917816, -83.36414764185363, 15.492523269988856, -20.099086750740184, -112.93814331864613, 38.83430014973219, 99.32588382435378, -7.186237854053658, -296.06501143426806, -44.01569060750536, -328.96094086521146, 6.66150348029478, 79.33021510026776, -181.22427044676505, -18.892689092456365, -216.3712187946845, -62.95786058685264, -124.09700832506523, -378.9538981880416, -61.34862934129239, 38.54514620659524, -225.36562079379718, -118.39720787064553, 138.51832857567896, 27.884164151874725, -327.58085681466355, -44.201092077882734, -206.9394659476817, 11.114313683634814, -157.78416647839782, 126.67462036061855, -27.69032513181977, -127.82757855100411, 76.77563951787425, -261.0831296777316, -10.601805614608864, -64.45441102821569, -265.25907911374225, -186.95176340083907, 108.86903512297904, 182.17443024315017, -156.41075968712295, -343.4798072931854, -26.273376488093632, -121.04003450699133, 139.2614059401979, -102.81122188961162, -72.21664298693909, -329.55901813919115, 137.8845537359675, -79.56439908470055, -93.10496219078345, -71.01606332294986, 65.51000228776944, -135.53054782888822, 184.41954470563945, 33.462676202977164, -126.1787963994451, -177.37969060829994, -2.8576333424488833, -418.0545651083237, 58.34970808021329, -98.80403413330927, -170.92186837722423, -143.69160661997873, -12.44836149752362, 31.415990335396323, -12.933161675642415, -251.4203636654193, -29.86711493403947, 11.628416923900575, -197.3961530163161, -70.84012522027153, -42.8111408225285, 4.248019442822735, -208.36763685022868, -176.61672323207986, -179.28708142716968, -113.66953636627724, -62.73519001010522, -242.23863255338551, -222.22966377795575, -202.42236968157346, 149.8705691785865, 65.25547217618204, -104.97252860761357, -238.51988850753102, 47.15872127340388, -147.29676924757638, 102.01140111813471, -168.90751675737314, -293.35043858773815, -200.82779705440157, -213.8089028911062, -244.08284552960754, 43.853504952315, -17.373557445372743, -138.2006815819364, -199.39418529098745, -118.3349247625807, 75.88490013170379, 0.04389606193812304, -250.02227490100685, -107.54365586382079, -112.18901409772126, -1.4584574265804378, 185.902729791814, 20.000000000000014, -134.72260590554853, 5.9869113096167705, -124.48088996148587, -257.09734195683814, -14.604242485265132, -105.84975650067852, 79.38683765203132, -139.7677316544855], "policy_predator_policy_reward": [104.93170594034827, 96.98557174008283, 165.39063554425582, 263.4512533531741, 269.6832128705356, 8.976321201569446, 226.36320448514962, 62.717674333126304, 80.63217020625956, 0.0, 220.501843179864, 285.5478535775294, 275.0180764928222, 77.49259208762435, 244.76925888146445, 146.000928895592, 95.66919433945932, 47.29457311711713, 176.79399348131395, 142.79729839417774, 178.99900381755486, 106.8067649232921, 155.41622314642652, 115.71625320391703, 215.61649426784163, 181.4052447102725, 85.1653338837247, 18.100700609412957, 261.3936449660472, 154.735510757534, 60.3063966351255, 164.3931253535767, 81.66616852742493, 48.191831831830285, 113.62673795734415, 270.69549304885476, 132.36393507115244, 202.09468494767776, 203.27220913717719, 110.29220196370854, 158.77005562726353, 139.93005093157709, 169.16210549407418, 191.89261966065078, 174.93343619466884, 161.09737987862894, 0.7503773820612335, 27.459378649621147, 31.98917191353565, 15.690500679471041, 30.88266642257618, 274.92108751602603, 50.83583834002291, 47.531317291655284, 217.64722921608004, 99.54504567778483, 204.47447140410475, 252.93863895625176, 133.7400777931903, 162.28667609671135, 137.58597247210227, 94.38026758940296, 172.13507263634781, 8.810750309661328, 171.90829179625067, 219.81235316559582, 18.144265115945956, 0.0, 139.8701577806189, 154.7702293884155, 230.46904151924295, 155.88099988792095, 73.21425442529348, 120.0477271224916, 82.79244903398602, 172.76841198729252, 128.13679193401913, 282.9944511642231, 142.9840653526255, 80.06932728063133, 20.68958876851879, 326.48034317284294, 228.09649469848858, 98.59960197036229, 159.6241671065192, 11.612694911319453, 44.10747673001128, 36.89908675074042, 139.2115297031671, 91.12843914122845, 53.05670603641179, 98.25884884994392, 290.06090406876797, 166.56900713010003, 269.62410148163707, 131.58540915046103, 63.769784899732244, 209.5377920204169, 145.85466599504673, 202.6189348792082, 79.05786058685187, 150.52327301384676, 132.91397846373687, 376.5003807934066, 116.24555278747839, 190.94171247848868, 134.03633668827152, 13.20963822757071, 263.13156859080186, 234.59731468865863, 102.71545690985484, 201.0575787555332, 115.39275624494323, 107.32827836159531, 0.9927608603799211, 71.12294391082138, 94.54694791126899, 91.36473220253504, 221.29819926023163, 260.63267970505154, 134.51942862084306, 255.98120119457136, 170.85184776098077, 91.73725531488394, 1.5874844966546875, 241.5984229575762, 186.08494620122693, 270.3396292609354, 129.52823114310644, 51.647064249828034, 96.1753606383226, 126.05685278597508, 283.7588663931184, 109.8230050889399, 228.0469726180094, 76.22579695450672, 137.95811952812969, 50.4099806676456, 160.0347306419117, 10.563770457491863, 135.96506990645986, 106.8475600223925, 3.5130973800795764, 227.96511392548385, 128.08073322222432, 362.8103524843603, 275.3145653307742, 52.11133717975812, 154.9368569379776, 177.4274904436069, 1.6903145185475688, 119.9171713402463, 219.97473919077254, 146.62392160191118, 208.31391007516012, 120.64220797862781, 52.12768443881403, 197.77314997871287, 127.63127986580074, 143.20604379676433, 156.56708146909455, 209.37383501054606, 125.36953636627669, 92.47569105922048, 218.56392960576545, 298.62403888342664, 78.56099680876781, 158.9232344103795, 118.41441922088025, 113.25668462402199, 168.48152400661195, 188.4849492107487, 164.85165674407546, 101.05965395860039, 323.62988544524165, 262.04404737735575, 270.2607616569029, 226.89454057458488, 112.19776768521066, 186.02016770576483, 140.83288651679536, 155.8224070515638, 227.60996223014064, 199.22993501258173, 55.597153149189324, 39.133750896093524, 184.07692853034328, 197.68900223448344, 100.3939415817672, 154.1741426301984, 7.097270208185999, 0.0, 227.99959039103217, 39.6117667899927, 205.53655897341142, 179.394987309596, 67.2085606404733, 129.9726940363235, 88.44582789708232, 147.55418361875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.154845814624863, "mean_inference_ms": 6.571347967657313, "mean_action_processing_ms": 4.369789274301861, "mean_env_wait_ms": 14.192993145161827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021050572395324707, "StateBufferConnector_ms": 0.013648271560668945, "ViewRequirementAgentConnector_ms": 0.3606588840484619}, "num_episodes": 17, "episode_return_max": 331.8000000000002, "episode_return_min": -21.28536012255802, "episode_return_mean": 120.84272881710247, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1276480, "num_agent_steps_trained": 1276480, "num_env_steps_sampled": 319120, "num_env_steps_trained": 319120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.12785013674902, "num_env_steps_trained_throughput_per_sec": 71.12785013674902, "timesteps_total": 319120, "num_env_steps_sampled_lifetime": 319120, "num_agent_steps_sampled_lifetime": 1276480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1276480, "timers": {"training_iteration_time_ms": 58821.062, "restore_workers_time_ms": 0.041, "training_step_time_ms": 58820.865, "sample_time_ms": 4926.868, "learn_time_ms": 53862.898, "learn_throughput": 74.263, "synch_weights_time_ms": 22.551}, "counters": {"num_env_steps_sampled": 319120, "num_env_steps_trained": 319120, "num_agent_steps_sampled": 1276480, "num_agent_steps_trained": 1276480}, "done": false, "training_iteration": 79, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-35-08", "timestamp": 1724151908, "time_this_iter_s": 56.291626930236816, "time_total_s": 4468.747242927551, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120b28d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4468.747242927551, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 54.46124999999999, "ram_util_percent": 83.32499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.377123289890392, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.7079396189835965, "policy_loss": -0.01662641109839555, "vf_loss": 6.722460715228288, "vf_explained_var": 0.5021988200447547, "kl": 0.010526538739306113, "entropy": 0.6471445234364303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 151725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.562752497953082, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.081491711404588, "policy_loss": -0.01611920713518485, "vf_loss": 5.095578021473354, "vf_explained_var": 0.18425451854549388, "kl": 0.010164474047321294, "entropy": 0.6610662172080348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 151725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 323120, "num_env_steps_trained": 323120, "num_agent_steps_sampled": 1292480, "num_agent_steps_trained": 1292480}, "env_runners": {"episode_reward_max": 280.0535692550807, "episode_reward_min": 3.353314364683846, "episode_reward_mean": 122.6110570797467, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -418.0545651083237, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.902729791814, "predator_policy": 383.6871714916094}, "policy_reward_mean": {"prey_policy": -83.87499870708444, "predator_policy": 145.18052724695775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [197.5999999999996, 44.38594304767757, 116.93334459293094, 77.92569322657599, 92.79463170562411, 57.727121447010695, 107.89577192094839, 67.80000000000013, 197.76265951979946, 174.74737516376118, 127.5348629745371, 116.50428082815068, 32.05506948414271, 118.3727760081612, 105.91773744369661, 27.88226713122034, 107.90676792426783, 73.13364606957441, 140.31535184890285, 76.40000000000026, 156.23612567548088, 243.45520085665584, 116.54920915709471, 78.91007324718083, 171.4135215736518, 113.20969298711361, 42.52626468878164, 69.11183172780973, 120.36679067876508, 167.3670956208757, 198.0321906166709, 52.63247763982392, 76.0511818117752, 171.09999999999948, 134.85974108067433, 210.24594367294293, 60.78713967345692, 184.5063747980047, 268.94957801025805, 86.67139168088269, 199.39666682614114, 47.20434854774745, 201.9074070788348, 131.60340829703208, 182.862039160595, 219.48749797615474, 150.09650973238442, 51.24088735481476, 131.18622867847344, 57.700000000000195, 176.22437926408222, 140.09031451854727, 85.3111821932249, 143.18838196137241, 136.24956837472706, 66.7177062551595, 10.037111820392003, 41.44050104911625, 52.71967215785174, 184.93243071616033, 191.9540474134709, 165.60530598323336, 220.62594257323445, 123.41597747748631, 82.51860228598028, 97.98859481368291, 141.0810545410499, 109.11078718915437, 170.65970023892416, 24.199999999999996, 140.920612687664, 212.9999999999993, 138.87566258509318, 3.353314364683846, 76.72725569085414, 175.61911751337814, 167.41788181193942, 153.11157802377204, 135.22722913550808, 221.03204468033852, 140.55686203185974, 84.64852540417033, 179.5895399500016, 121.29641439476742, 95.3070871222393, 59.03396874220682, 53.38294358287626, 70.10814555227114, 120.69999999999976, 224.4887556437206, 28.674203412502706, 156.98629998049202, 136.43104802205065, 112.20068363745051, 82.74455817022005, 72.78724165546734, 112.8883081515279, 92.60982931143839, 280.0535692550807, 89.99964744718717], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [47.41082808646449, 102.50949932052893, -170.2255086103568, -91.19230228056793, -27.667533694328046, 46.23372265558188, -185.2472292160801, -54.01935245120842, -129.76097467784243, -234.8575039768901, -84.17236663641111, -154.12726580648018, 16.10257909557326, -140.17304723612972, -82.14952319811385, -30.996299747895073, -60.168695180314444, -133.7892902617327, 156.13757282971724, 0.4655372180984355, -21.81237728639708, -145.29314690810088, -259.86575773014386, -9.980002848869646, -82.69978815582124, -78.50712390782202, -9.182069827501422, -128.0060151856163, -49.61290173869352, -255.60060391585193, -130.73630961263876, -64.43481588939844, -240.01213922633946, 0.7489752092455002, -20.492537972525625, -233.06991262675112, 52.442637472917816, -83.36414764185363, 15.492523269988856, -20.099086750740184, -112.93814331864613, 38.83430014973219, 99.32588382435378, -7.186237854053658, -296.06501143426806, -44.01569060750536, -328.96094086521146, 6.66150348029478, 79.33021510026776, -181.22427044676505, -18.892689092456365, -216.3712187946845, -62.95786058685264, -124.09700832506523, -378.9538981880416, -61.34862934129239, 38.54514620659524, -225.36562079379718, -118.39720787064553, 138.51832857567896, 27.884164151874725, -327.58085681466355, -44.201092077882734, -206.9394659476817, 11.114313683634814, -157.78416647839782, 126.67462036061855, -27.69032513181977, -127.82757855100411, 76.77563951787425, -261.0831296777316, -10.601805614608864, -64.45441102821569, -265.25907911374225, -186.95176340083907, 108.86903512297904, 182.17443024315017, -156.41075968712295, -343.4798072931854, -26.273376488093632, -121.04003450699133, 139.2614059401979, -102.81122188961162, -72.21664298693909, -329.55901813919115, 137.8845537359675, -79.56439908470055, -93.10496219078345, -71.01606332294986, 65.51000228776944, -135.53054782888822, 184.41954470563945, 33.462676202977164, -126.1787963994451, -177.37969060829994, -2.8576333424488833, -418.0545651083237, 58.34970808021329, -98.80403413330927, -170.92186837722423, -143.69160661997873, -12.44836149752362, 31.415990335396323, -12.933161675642415, -251.4203636654193, -29.86711493403947, 11.628416923900575, -197.3961530163161, -70.84012522027153, -42.8111408225285, 4.248019442822735, -208.36763685022868, -176.61672323207986, -179.28708142716968, -113.66953636627724, -62.73519001010522, -242.23863255338551, -222.22966377795575, -202.42236968157346, 149.8705691785865, 65.25547217618204, -104.97252860761357, -238.51988850753102, 47.15872127340388, -147.29676924757638, 102.01140111813471, -168.90751675737314, -293.35043858773815, -200.82779705440157, -213.8089028911062, -244.08284552960754, 43.853504952315, -17.373557445372743, -138.2006815819364, -199.39418529098745, -118.3349247625807, 75.88490013170379, 0.04389606193812304, -250.02227490100685, -107.54365586382079, -112.18901409772126, -1.4584574265804378, 185.902729791814, 20.000000000000014, -134.72260590554853, 5.9869113096167705, -124.48088996148587, -257.09734195683814, -14.604242485265132, -105.84975650067852, 79.38683765203132, -139.7677316544855, 137.02996329326174, 8.573953652485338, -99.8612836456253, -17.213980988919104, -206.00697923668258, 49.43966586182891, 81.17113248424255, 29.65427431234108, -17.31386676644975, -128.50451011260893, -211.25728236963653, -129.07932126723202, 2.1698436314511844, -83.93782081911063, -400.6067906963129, 9.995535333802398, -10.427297519305355, -212.80108837220104, -87.25656917184949, -194.9321257827384, -123.45827901133026, -114.04986944812096, -220.20359443907006, -172.47349146372582, -3.528331914643715, -63.681472954494666, -220.65321493123116, 180.1652800673872, -56.43980503190511, -207.49805434554068, -87.45554335351743, -359.3184900504033, -71.65685087399206, 75.74143916496178, 91.58325869723936, -197.35937358316076, -23.549392545310535, -45.24409985714576, -117.29155297092743, -65.43171526973856, -186.60852406209318, -200.12259020352755, -63.643394827920304, -162.00344858883471, -101.46283857229979, -89.46629243940939, 40.02612648909218, -247.0897724832002], "policy_predator_policy_reward": [31.98917191353565, 15.690500679471041, 30.88266642257618, 274.92108751602603, 50.83583834002291, 47.531317291655284, 217.64722921608004, 99.54504567778483, 204.47447140410475, 252.93863895625176, 133.7400777931903, 162.28667609671135, 137.58597247210227, 94.38026758940296, 172.13507263634781, 8.810750309661328, 171.90829179625067, 219.81235316559582, 18.144265115945956, 0.0, 139.8701577806189, 154.7702293884155, 230.46904151924295, 155.88099988792095, 73.21425442529348, 120.0477271224916, 82.79244903398602, 172.76841198729252, 128.13679193401913, 282.9944511642231, 142.9840653526255, 80.06932728063133, 20.68958876851879, 326.48034317284294, 228.09649469848858, 98.59960197036229, 159.6241671065192, 11.612694911319453, 44.10747673001128, 36.89908675074042, 139.2115297031671, 91.12843914122845, 53.05670603641179, 98.25884884994392, 290.06090406876797, 166.56900713010003, 269.62410148163707, 131.58540915046103, 63.769784899732244, 209.5377920204169, 145.85466599504673, 202.6189348792082, 79.05786058685187, 150.52327301384676, 132.91397846373687, 376.5003807934066, 116.24555278747839, 190.94171247848868, 134.03633668827152, 13.20963822757071, 263.13156859080186, 234.59731468865863, 102.71545690985484, 201.0575787555332, 115.39275624494323, 107.32827836159531, 0.9927608603799211, 71.12294391082138, 94.54694791126899, 91.36473220253504, 221.29819926023163, 260.63267970505154, 134.51942862084306, 255.98120119457136, 170.85184776098077, 91.73725531488394, 1.5874844966546875, 241.5984229575762, 186.08494620122693, 270.3396292609354, 129.52823114310644, 51.647064249828034, 96.1753606383226, 126.05685278597508, 283.7588663931184, 109.8230050889399, 228.0469726180094, 76.22579695450672, 137.95811952812969, 50.4099806676456, 160.0347306419117, 10.563770457491863, 135.96506990645986, 106.8475600223925, 3.5130973800795764, 227.96511392548385, 128.08073322222432, 362.8103524843603, 275.3145653307742, 52.11133717975812, 154.9368569379776, 177.4274904436069, 1.6903145185475688, 119.9171713402463, 219.97473919077254, 146.62392160191118, 208.31391007516012, 120.64220797862781, 52.12768443881403, 197.77314997871287, 127.63127986580074, 143.20604379676433, 156.56708146909455, 209.37383501054606, 125.36953636627669, 92.47569105922048, 218.56392960576545, 298.62403888342664, 78.56099680876781, 158.9232344103795, 118.41441922088025, 113.25668462402199, 168.48152400661195, 188.4849492107487, 164.85165674407546, 101.05965395860039, 323.62988544524165, 262.04404737735575, 270.2607616569029, 226.89454057458488, 112.19776768521066, 186.02016770576483, 140.83288651679536, 155.8224070515638, 227.60996223014064, 199.22993501258173, 55.597153149189324, 39.133750896093524, 184.07692853034328, 197.68900223448344, 100.3939415817672, 154.1741426301984, 7.097270208185999, 0.0, 227.99959039103217, 39.6117667899927, 205.53655897341142, 179.394987309596, 67.2085606404733, 129.9726940363235, 88.44582789708232, 147.55418361875, 10.587918518678093, 11.22604634751463, 93.15098139787537, 177.03586126044112, 234.8995159601301, 56.89502655023151, 61.186503192398156, 49.020134691357, 145.07072879831014, 141.3045101126084, 209.00545881800653, 215.9796702230315, 184.57664946063252, 76.78086767702916, 375.9646246191601, 135.943045138118, 73.75872035688087, 244.77675265686452, 131.32276363052296, 209.89990006627065, 65.739706743721, 225.15138529860565, 268.2018248506905, 194.58340660437574, 108.62833191464354, 79.28147295449381, 186.4451556632561, 78.53153484430862, 220.6361789105068, 71.97588387944121, 220.0731618928043, 383.6871714916094, 69.4233249876096, 62.923134743471984, 0.0, 217.97679852337168, 83.78482049918209, 67.75323007349442, 83.96207130459811, 171.5484385915348, 145.36134781664632, 354.2580746005027, 149.2709751332595, 168.98569759493344, 265.2700657517834, 205.71263451500664, 128.47303401187332, 168.59025942942205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.217744883542437, "mean_inference_ms": 6.617623782493454, "mean_action_processing_ms": 4.123688008395524, "mean_env_wait_ms": 14.212040896167384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02464759349822998, "StateBufferConnector_ms": 0.010882735252380371, "ViewRequirementAgentConnector_ms": 0.32562386989593506}, "num_episodes": 24, "episode_return_max": 280.0535692550807, "episode_return_min": 3.353314364683846, "episode_return_mean": 122.6110570797467, "episodes_this_iter": 24}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1292480, "num_agent_steps_trained": 1292480, "num_env_steps_sampled": 323120, "num_env_steps_trained": 323120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.63296450310588, "num_env_steps_trained_throughput_per_sec": 71.63296450310588, "timesteps_total": 323120, "num_env_steps_sampled_lifetime": 323120, "num_agent_steps_sampled_lifetime": 1292480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1292480, "timers": {"training_iteration_time_ms": 58764.522, "restore_workers_time_ms": 0.042, "training_step_time_ms": 58764.324, "sample_time_ms": 5047.579, "learn_time_ms": 53685.742, "learn_throughput": 74.508, "synch_weights_time_ms": 22.215}, "counters": {"num_env_steps_sampled": 323120, "num_env_steps_trained": 323120, "num_agent_steps_sampled": 1292480, "num_agent_steps_trained": 1292480}, "done": false, "training_iteration": 80, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-36-04", "timestamp": 1724151964, "time_this_iter_s": 55.901045083999634, "time_total_s": 4524.648288011551, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120082940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4524.648288011551, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 53.82784810126583, "ram_util_percent": 83.15569620253164}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.715609716107606, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.891949481308145, "policy_loss": -0.01562706111762771, "vf_loss": 6.905371709601589, "vf_explained_var": 0.44002864215739823, "kl": 0.011024234743503036, "entropy": 0.6701245620767906, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 153615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.54234283695776, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.876549268651892, "policy_loss": -0.015305052400891861, "vf_loss": 5.890099943504132, "vf_explained_var": 0.15509725695564633, "kl": 0.008771869440922741, "entropy": 0.6598783376040283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 153615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 327120, "num_env_steps_trained": 327120, "num_agent_steps_sampled": 1308480, "num_agent_steps_trained": 1308480}, "env_runners": {"episode_reward_max": 398.0, "episode_reward_min": 3.353314364683846, "episode_reward_mean": 140.44305962167576, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -418.0545651083237, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.16177943720504, "predator_policy": 383.6871714916094}, "policy_reward_mean": {"prey_policy": -66.18467649135137, "predator_policy": 136.4062063021892}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.54920915709471, 78.91007324718083, 171.4135215736518, 113.20969298711361, 42.52626468878164, 69.11183172780973, 120.36679067876508, 167.3670956208757, 198.0321906166709, 52.63247763982392, 76.0511818117752, 171.09999999999948, 134.85974108067433, 210.24594367294293, 60.78713967345692, 184.5063747980047, 268.94957801025805, 86.67139168088269, 199.39666682614114, 47.20434854774745, 201.9074070788348, 131.60340829703208, 182.862039160595, 219.48749797615474, 150.09650973238442, 51.24088735481476, 131.18622867847344, 57.700000000000195, 176.22437926408222, 140.09031451854727, 85.3111821932249, 143.18838196137241, 136.24956837472706, 66.7177062551595, 10.037111820392003, 41.44050104911625, 52.71967215785174, 184.93243071616033, 191.9540474134709, 165.60530598323336, 220.62594257323445, 123.41597747748631, 82.51860228598028, 97.98859481368291, 141.0810545410499, 109.11078718915437, 170.65970023892416, 24.199999999999996, 140.920612687664, 212.9999999999993, 138.87566258509318, 3.353314364683846, 76.72725569085414, 175.61911751337814, 167.41788181193942, 153.11157802377204, 135.22722913550808, 221.03204468033852, 140.55686203185974, 84.64852540417033, 179.5895399500016, 121.29641439476742, 95.3070871222393, 59.03396874220682, 53.38294358287626, 70.10814555227114, 120.69999999999976, 224.4887556437206, 28.674203412502706, 156.98629998049202, 136.43104802205065, 112.20068363745051, 82.74455817022005, 72.78724165546734, 112.8883081515279, 92.60982931143839, 280.0535692550807, 89.99964744718717, 79.56928077309783, 213.713573983201, 334.0, 220.53992177113417, 157.09999999999957, 213.56235557742778, 116.89999999999858, 198.2999999999993, 233.69999999999933, 134.30837607261407, 211.64101854942658, 157.75819897570355, 46.91929861617903, 398.0, 258.29999999999984, 310.00133706542573, 191.48425372534157, 209.13492960012422, 219.530512113885, 150.68076689639986, 156.22639003955763, 33.11666730250898], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-296.06501143426806, -44.01569060750536, -328.96094086521146, 6.66150348029478, 79.33021510026776, -181.22427044676505, -18.892689092456365, -216.3712187946845, -62.95786058685264, -124.09700832506523, -378.9538981880416, -61.34862934129239, 38.54514620659524, -225.36562079379718, -118.39720787064553, 138.51832857567896, 27.884164151874725, -327.58085681466355, -44.201092077882734, -206.9394659476817, 11.114313683634814, -157.78416647839782, 126.67462036061855, -27.69032513181977, -127.82757855100411, 76.77563951787425, -261.0831296777316, -10.601805614608864, -64.45441102821569, -265.25907911374225, -186.95176340083907, 108.86903512297904, 182.17443024315017, -156.41075968712295, -343.4798072931854, -26.273376488093632, -121.04003450699133, 139.2614059401979, -102.81122188961162, -72.21664298693909, -329.55901813919115, 137.8845537359675, -79.56439908470055, -93.10496219078345, -71.01606332294986, 65.51000228776944, -135.53054782888822, 184.41954470563945, 33.462676202977164, -126.1787963994451, -177.37969060829994, -2.8576333424488833, -418.0545651083237, 58.34970808021329, -98.80403413330927, -170.92186837722423, -143.69160661997873, -12.44836149752362, 31.415990335396323, -12.933161675642415, -251.4203636654193, -29.86711493403947, 11.628416923900575, -197.3961530163161, -70.84012522027153, -42.8111408225285, 4.248019442822735, -208.36763685022868, -176.61672323207986, -179.28708142716968, -113.66953636627724, -62.73519001010522, -242.23863255338551, -222.22966377795575, -202.42236968157346, 149.8705691785865, 65.25547217618204, -104.97252860761357, -238.51988850753102, 47.15872127340388, -147.29676924757638, 102.01140111813471, -168.90751675737314, -293.35043858773815, -200.82779705440157, -213.8089028911062, -244.08284552960754, 43.853504952315, -17.373557445372743, -138.2006815819364, -199.39418529098745, -118.3349247625807, 75.88490013170379, 0.04389606193812304, -250.02227490100685, -107.54365586382079, -112.18901409772126, -1.4584574265804378, 185.902729791814, 20.000000000000014, -134.72260590554853, 5.9869113096167705, -124.48088996148587, -257.09734195683814, -14.604242485265132, -105.84975650067852, 79.38683765203132, -139.7677316544855, 137.02996329326174, 8.573953652485338, -99.8612836456253, -17.213980988919104, -206.00697923668258, 49.43966586182891, 81.17113248424255, 29.65427431234108, -17.31386676644975, -128.50451011260893, -211.25728236963653, -129.07932126723202, 2.1698436314511844, -83.93782081911063, -400.6067906963129, 9.995535333802398, -10.427297519305355, -212.80108837220104, -87.25656917184949, -194.9321257827384, -123.45827901133026, -114.04986944812096, -220.20359443907006, -172.47349146372582, -3.528331914643715, -63.681472954494666, -220.65321493123116, 180.1652800673872, -56.43980503190511, -207.49805434554068, -87.45554335351743, -359.3184900504033, -71.65685087399206, 75.74143916496178, 91.58325869723936, -197.35937358316076, -23.549392545310535, -45.24409985714576, -117.29155297092743, -65.43171526973856, -186.60852406209318, -200.12259020352755, -63.643394827920304, -162.00344858883471, -101.46283857229979, -89.46629243940939, 40.02612648909218, -247.0897724832002, -292.1258254221982, -82.59222490489361, -43.42247428202742, 72.01369527477888, 143.50484371963836, 111.26882592864979, -107.2500050458169, 198.0821142503228, 20.000000000000014, 120.36258742088694, -221.2768413217796, 196.32125228397692, -34.12127421968478, 56.112870137684936, 167.87339126006788, -10.570681008916063, -13.284135460761618, 188.99180147155477, -4.441787571131911, 68.56614726814199, -30.536103413757413, 117.77960119762676, -274.6476318889565, 114.65928085301702, 19.12361211015887, -124.90916129559758, 197.99380119577953, 198.16177943720504, 153.74766671980893, 18.40943136862431, 71.82108062319375, 77.36872931193264, -248.42090422300907, 150.72741916499885, -69.55889264221938, 165.12136127601644, -140.47690365613167, 147.41717450004887, 97.2817088395778, -259.9519179076957, 49.81693806724607, 20.000000000000014, -305.84221052302155, -96.76964798663688], "policy_predator_policy_reward": [290.06090406876797, 166.56900713010003, 269.62410148163707, 131.58540915046103, 63.769784899732244, 209.5377920204169, 145.85466599504673, 202.6189348792082, 79.05786058685187, 150.52327301384676, 132.91397846373687, 376.5003807934066, 116.24555278747839, 190.94171247848868, 134.03633668827152, 13.20963822757071, 263.13156859080186, 234.59731468865863, 102.71545690985484, 201.0575787555332, 115.39275624494323, 107.32827836159531, 0.9927608603799211, 71.12294391082138, 94.54694791126899, 91.36473220253504, 221.29819926023163, 260.63267970505154, 134.51942862084306, 255.98120119457136, 170.85184776098077, 91.73725531488394, 1.5874844966546875, 241.5984229575762, 186.08494620122693, 270.3396292609354, 129.52823114310644, 51.647064249828034, 96.1753606383226, 126.05685278597508, 283.7588663931184, 109.8230050889399, 228.0469726180094, 76.22579695450672, 137.95811952812969, 50.4099806676456, 160.0347306419117, 10.563770457491863, 135.96506990645986, 106.8475600223925, 3.5130973800795764, 227.96511392548385, 128.08073322222432, 362.8103524843603, 275.3145653307742, 52.11133717975812, 154.9368569379776, 177.4274904436069, 1.6903145185475688, 119.9171713402463, 219.97473919077254, 146.62392160191118, 208.31391007516012, 120.64220797862781, 52.12768443881403, 197.77314997871287, 127.63127986580074, 143.20604379676433, 156.56708146909455, 209.37383501054606, 125.36953636627669, 92.47569105922048, 218.56392960576545, 298.62403888342664, 78.56099680876781, 158.9232344103795, 118.41441922088025, 113.25668462402199, 168.48152400661195, 188.4849492107487, 164.85165674407546, 101.05965395860039, 323.62988544524165, 262.04404737735575, 270.2607616569029, 226.89454057458488, 112.19776768521066, 186.02016770576483, 140.83288651679536, 155.8224070515638, 227.60996223014064, 199.22993501258173, 55.597153149189324, 39.133750896093524, 184.07692853034328, 197.68900223448344, 100.3939415817672, 154.1741426301984, 7.097270208185999, 0.0, 227.99959039103217, 39.6117667899927, 205.53655897341142, 179.394987309596, 67.2085606404733, 129.9726940363235, 88.44582789708232, 147.55418361875, 10.587918518678093, 11.22604634751463, 93.15098139787537, 177.03586126044112, 234.8995159601301, 56.89502655023151, 61.186503192398156, 49.020134691357, 145.07072879831014, 141.3045101126084, 209.00545881800653, 215.9796702230315, 184.57664946063252, 76.78086767702916, 375.9646246191601, 135.943045138118, 73.75872035688087, 244.77675265686452, 131.32276363052296, 209.89990006627065, 65.739706743721, 225.15138529860565, 268.2018248506905, 194.58340660437574, 108.62833191464354, 79.28147295449381, 186.4451556632561, 78.53153484430862, 220.6361789105068, 71.97588387944121, 220.0731618928043, 383.6871714916094, 69.4233249876096, 62.923134743471984, 0.0, 217.97679852337168, 83.78482049918209, 67.75323007349442, 83.96207130459811, 171.5484385915348, 145.36134781664632, 354.2580746005027, 149.2709751332595, 168.98569759493344, 265.2700657517834, 205.71263451500664, 128.47303401187332, 168.59025942942205, 294.56623274921833, 159.72109835097126, 104.22072397631129, 80.90162901413824, 28.495156280361673, 50.73117407135021, 81.60424591950762, 48.103566647120665, 0.0, 16.73741257911305, 101.83101435915168, 136.68693025607897, 94.01007351141465, 0.8983305705855575, 0.0, 40.997289748848374, 55.28413546076175, 2.708198528445232, 63.745128771227584, 6.43888760437661, 121.87668817860703, 2.520832586950284, 64.86881315282385, 252.87773685881905, 106.87367864910152, 45.831169152515415, 1.006198804220474, 0.83822056279496, 84.10003756079024, 2.042864350776575, 109.135627831368, 51.67589929893083, 239.82547729456698, 49.352261488784784, 30.729873076177714, 82.8425878901495, 104.14052720848731, 108.44971406148055, 120.75882091105922, 192.59215505345836, 16.871683730268522, 69.53776824204346, 184.33515584982518, 251.39336996234135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.144718078619317, "mean_inference_ms": 6.5616141740427585, "mean_action_processing_ms": 4.5202913986118896, "mean_env_wait_ms": 14.218194235986486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020613551139831543, "StateBufferConnector_ms": 0.01112830638885498, "ViewRequirementAgentConnector_ms": 0.25406455993652344}, "num_episodes": 22, "episode_return_max": 398.0, "episode_return_min": 3.353314364683846, "episode_return_mean": 140.44305962167576, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308480, "num_agent_steps_trained": 1308480, "num_env_steps_sampled": 327120, "num_env_steps_trained": 327120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.043484487166, "num_env_steps_trained_throughput_per_sec": 72.043484487166, "timesteps_total": 327120, "num_env_steps_sampled_lifetime": 327120, "num_agent_steps_sampled_lifetime": 1308480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1308480, "timers": {"training_iteration_time_ms": 58416.997, "restore_workers_time_ms": 0.041, "training_step_time_ms": 58416.824, "sample_time_ms": 5040.903, "learn_time_ms": 53347.555, "learn_throughput": 74.98, "synch_weights_time_ms": 21.623}, "counters": {"num_env_steps_sampled": 327120, "num_env_steps_trained": 327120, "num_agent_steps_sampled": 1308480, "num_agent_steps_trained": 1308480}, "done": false, "training_iteration": 81, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-36-59", "timestamp": 1724152019, "time_this_iter_s": 55.571512937545776, "time_total_s": 4580.219800949097, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120bce790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4580.219800949097, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 53.76075949367089, "ram_util_percent": 83.12911392405066}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.365180411225273, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.458830882380249, "policy_loss": -0.016180237815666097, "vf_loss": 7.472699453717186, "vf_explained_var": 0.21997413613178113, "kl": 0.011558366945338627, "entropy": 0.6230522249741529, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155505.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999885}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.036784653562718, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.161685345412562, "policy_loss": -0.01562931962377791, "vf_loss": 6.1753977013643455, "vf_explained_var": 0.17342691809412034, "kl": 0.009584771931940128, "entropy": 0.6054852568756336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155505.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999885}}, "num_env_steps_sampled": 331120, "num_env_steps_trained": 331120, "num_agent_steps_sampled": 1324480, "num_agent_steps_trained": 1324480}, "env_runners": {"episode_reward_max": 398.0, "episode_reward_min": 3.353314364683846, "episode_reward_mean": 138.6750632563263, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -418.0545651083237, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.16177943720504, "predator_policy": 383.6871714916094}, "policy_reward_mean": {"prey_policy": -70.81157799436798, "predator_policy": 140.14910962253109}, "custom_metrics": {}, "hist_stats": {"episode_reward": [268.94957801025805, 86.67139168088269, 199.39666682614114, 47.20434854774745, 201.9074070788348, 131.60340829703208, 182.862039160595, 219.48749797615474, 150.09650973238442, 51.24088735481476, 131.18622867847344, 57.700000000000195, 176.22437926408222, 140.09031451854727, 85.3111821932249, 143.18838196137241, 136.24956837472706, 66.7177062551595, 10.037111820392003, 41.44050104911625, 52.71967215785174, 184.93243071616033, 191.9540474134709, 165.60530598323336, 220.62594257323445, 123.41597747748631, 82.51860228598028, 97.98859481368291, 141.0810545410499, 109.11078718915437, 170.65970023892416, 24.199999999999996, 140.920612687664, 212.9999999999993, 138.87566258509318, 3.353314364683846, 76.72725569085414, 175.61911751337814, 167.41788181193942, 153.11157802377204, 135.22722913550808, 221.03204468033852, 140.55686203185974, 84.64852540417033, 179.5895399500016, 121.29641439476742, 95.3070871222393, 59.03396874220682, 53.38294358287626, 70.10814555227114, 120.69999999999976, 224.4887556437206, 28.674203412502706, 156.98629998049202, 136.43104802205065, 112.20068363745051, 82.74455817022005, 72.78724165546734, 112.8883081515279, 92.60982931143839, 280.0535692550807, 89.99964744718717, 79.56928077309783, 213.713573983201, 334.0, 220.53992177113417, 157.09999999999957, 213.56235557742778, 116.89999999999858, 198.2999999999993, 233.69999999999933, 134.30837607261407, 211.64101854942658, 157.75819897570355, 46.91929861617903, 398.0, 258.29999999999984, 310.00133706542573, 191.48425372534157, 209.13492960012422, 219.530512113885, 150.68076689639986, 156.22639003955763, 33.11666730250898, 76.90712094936552, 213.28302885981986, 60.79500893703467, 171.63471017383074, 87.93878953547913, 176.51103132123288, 240.09823536303875, 72.9533299699419, 34.34659164242059, 21.900000000000002, 41.159154562631414, 237.9866177574704, 77.21406158560532, 59.9411182680586, 178.32927972318404, 39.8718137905603], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [182.17443024315017, -156.41075968712295, -343.4798072931854, -26.273376488093632, -121.04003450699133, 139.2614059401979, -102.81122188961162, -72.21664298693909, -329.55901813919115, 137.8845537359675, -79.56439908470055, -93.10496219078345, -71.01606332294986, 65.51000228776944, -135.53054782888822, 184.41954470563945, 33.462676202977164, -126.1787963994451, -177.37969060829994, -2.8576333424488833, -418.0545651083237, 58.34970808021329, -98.80403413330927, -170.92186837722423, -143.69160661997873, -12.44836149752362, 31.415990335396323, -12.933161675642415, -251.4203636654193, -29.86711493403947, 11.628416923900575, -197.3961530163161, -70.84012522027153, -42.8111408225285, 4.248019442822735, -208.36763685022868, -176.61672323207986, -179.28708142716968, -113.66953636627724, -62.73519001010522, -242.23863255338551, -222.22966377795575, -202.42236968157346, 149.8705691785865, 65.25547217618204, -104.97252860761357, -238.51988850753102, 47.15872127340388, -147.29676924757638, 102.01140111813471, -168.90751675737314, -293.35043858773815, -200.82779705440157, -213.8089028911062, -244.08284552960754, 43.853504952315, -17.373557445372743, -138.2006815819364, -199.39418529098745, -118.3349247625807, 75.88490013170379, 0.04389606193812304, -250.02227490100685, -107.54365586382079, -112.18901409772126, -1.4584574265804378, 185.902729791814, 20.000000000000014, -134.72260590554853, 5.9869113096167705, -124.48088996148587, -257.09734195683814, -14.604242485265132, -105.84975650067852, 79.38683765203132, -139.7677316544855, 137.02996329326174, 8.573953652485338, -99.8612836456253, -17.213980988919104, -206.00697923668258, 49.43966586182891, 81.17113248424255, 29.65427431234108, -17.31386676644975, -128.50451011260893, -211.25728236963653, -129.07932126723202, 2.1698436314511844, -83.93782081911063, -400.6067906963129, 9.995535333802398, -10.427297519305355, -212.80108837220104, -87.25656917184949, -194.9321257827384, -123.45827901133026, -114.04986944812096, -220.20359443907006, -172.47349146372582, -3.528331914643715, -63.681472954494666, -220.65321493123116, 180.1652800673872, -56.43980503190511, -207.49805434554068, -87.45554335351743, -359.3184900504033, -71.65685087399206, 75.74143916496178, 91.58325869723936, -197.35937358316076, -23.549392545310535, -45.24409985714576, -117.29155297092743, -65.43171526973856, -186.60852406209318, -200.12259020352755, -63.643394827920304, -162.00344858883471, -101.46283857229979, -89.46629243940939, 40.02612648909218, -247.0897724832002, -292.1258254221982, -82.59222490489361, -43.42247428202742, 72.01369527477888, 143.50484371963836, 111.26882592864979, -107.2500050458169, 198.0821142503228, 20.000000000000014, 120.36258742088694, -221.2768413217796, 196.32125228397692, -34.12127421968478, 56.112870137684936, 167.87339126006788, -10.570681008916063, -13.284135460761618, 188.99180147155477, -4.441787571131911, 68.56614726814199, -30.536103413757413, 117.77960119762676, -274.6476318889565, 114.65928085301702, 19.12361211015887, -124.90916129559758, 197.99380119577953, 198.16177943720504, 153.74766671980893, 18.40943136862431, 71.82108062319375, 77.36872931193264, -248.42090422300907, 150.72741916499885, -69.55889264221938, 165.12136127601644, -140.47690365613167, 147.41717450004887, 97.2817088395778, -259.9519179076957, 49.81693806724607, 20.000000000000014, -305.84221052302155, -96.76964798663688, 13.622316909730108, -119.77022182364507, 176.68717485763682, -282.4393181218862, -184.92211388850887, -135.98926662634025, 88.90612685574295, -214.47586579387965, -134.91262235607988, -149.07015655183835, -67.29987166858353, -288.8077241943414, 176.23355714183302, -173.85537420392268, -49.85111777112725, -266.3032605924959, -142.90311341291, -105.37993750341037, -294.60966713190265, -292.40162158370737, -257.88875882092907, -114.040440334164, -152.31787506790795, 1.144350934672439, -206.90514131086772, -44.741340756441815, -4.869171836294045, -171.99241637300028, -364.02625095390306, 89.7448403994332, -115.70892521666862, -258.88784779097097], "policy_predator_policy_reward": [1.5874844966546875, 241.5984229575762, 186.08494620122693, 270.3396292609354, 129.52823114310644, 51.647064249828034, 96.1753606383226, 126.05685278597508, 283.7588663931184, 109.8230050889399, 228.0469726180094, 76.22579695450672, 137.95811952812969, 50.4099806676456, 160.0347306419117, 10.563770457491863, 135.96506990645986, 106.8475600223925, 3.5130973800795764, 227.96511392548385, 128.08073322222432, 362.8103524843603, 275.3145653307742, 52.11133717975812, 154.9368569379776, 177.4274904436069, 1.6903145185475688, 119.9171713402463, 219.97473919077254, 146.62392160191118, 208.31391007516012, 120.64220797862781, 52.12768443881403, 197.77314997871287, 127.63127986580074, 143.20604379676433, 156.56708146909455, 209.37383501054606, 125.36953636627669, 92.47569105922048, 218.56392960576545, 298.62403888342664, 78.56099680876781, 158.9232344103795, 118.41441922088025, 113.25668462402199, 168.48152400661195, 188.4849492107487, 164.85165674407546, 101.05965395860039, 323.62988544524165, 262.04404737735575, 270.2607616569029, 226.89454057458488, 112.19776768521066, 186.02016770576483, 140.83288651679536, 155.8224070515638, 227.60996223014064, 199.22993501258173, 55.597153149189324, 39.133750896093524, 184.07692853034328, 197.68900223448344, 100.3939415817672, 154.1741426301984, 7.097270208185999, 0.0, 227.99959039103217, 39.6117667899927, 205.53655897341142, 179.394987309596, 67.2085606404733, 129.9726940363235, 88.44582789708232, 147.55418361875, 10.587918518678093, 11.22604634751463, 93.15098139787537, 177.03586126044112, 234.8995159601301, 56.89502655023151, 61.186503192398156, 49.020134691357, 145.07072879831014, 141.3045101126084, 209.00545881800653, 215.9796702230315, 184.57664946063252, 76.78086767702916, 375.9646246191601, 135.943045138118, 73.75872035688087, 244.77675265686452, 131.32276363052296, 209.89990006627065, 65.739706743721, 225.15138529860565, 268.2018248506905, 194.58340660437574, 108.62833191464354, 79.28147295449381, 186.4451556632561, 78.53153484430862, 220.6361789105068, 71.97588387944121, 220.0731618928043, 383.6871714916094, 69.4233249876096, 62.923134743471984, 0.0, 217.97679852337168, 83.78482049918209, 67.75323007349442, 83.96207130459811, 171.5484385915348, 145.36134781664632, 354.2580746005027, 149.2709751332595, 168.98569759493344, 265.2700657517834, 205.71263451500664, 128.47303401187332, 168.59025942942205, 294.56623274921833, 159.72109835097126, 104.22072397631129, 80.90162901413824, 28.495156280361673, 50.73117407135021, 81.60424591950762, 48.103566647120665, 0.0, 16.73741257911305, 101.83101435915168, 136.68693025607897, 94.01007351141465, 0.8983305705855575, 0.0, 40.997289748848374, 55.28413546076175, 2.708198528445232, 63.745128771227584, 6.43888760437661, 121.87668817860703, 2.520832586950284, 64.86881315282385, 252.87773685881905, 106.87367864910152, 45.831169152515415, 1.006198804220474, 0.83822056279496, 84.10003756079024, 2.042864350776575, 109.135627831368, 51.67589929893083, 239.82547729456698, 49.352261488784784, 30.729873076177714, 82.8425878901495, 104.14052720848731, 108.44971406148055, 120.75882091105922, 192.59215505345836, 16.871683730268522, 69.53776824204346, 184.33515584982518, 251.39336996234135, 121.85913111206094, 61.19589475121878, 284.11837658805314, 34.91679553601606, 213.79115443618466, 167.9152350156984, 86.74521821540827, 210.45923089655903, 249.56266675797397, 122.358901685423, 259.57121565252356, 273.0474115316341, 193.70751714181736, 44.01253528331105, 90.10118951355828, 299.0065188200066, 106.12013785311079, 176.50950470562887, 316.5096671319032, 292.40162158370737, 301.64932107036105, 111.43903264736444, 171.5722462391855, 217.58789565152043, 188.17200283025608, 140.68854082265884, 109.04364915372537, 127.75905732362673, 262.9023440350403, 189.70834624261454, 198.6001166922497, 215.86847010594968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.126850603613363, "mean_inference_ms": 6.563051411813644, "mean_action_processing_ms": 4.281369634067716, "mean_env_wait_ms": 14.252729233510358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01233816146850586, "StateBufferConnector_ms": 0.011061787605285645, "ViewRequirementAgentConnector_ms": 0.2530621290206909}, "num_episodes": 16, "episode_return_max": 398.0, "episode_return_min": 3.353314364683846, "episode_return_mean": 138.6750632563263, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1324480, "num_agent_steps_trained": 1324480, "num_env_steps_sampled": 331120, "num_env_steps_trained": 331120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.07915485210583, "num_env_steps_trained_throughput_per_sec": 69.07915485210583, "timesteps_total": 331120, "num_env_steps_sampled_lifetime": 331120, "num_agent_steps_sampled_lifetime": 1324480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1324480, "timers": {"training_iteration_time_ms": 57194.635, "restore_workers_time_ms": 0.016, "training_step_time_ms": 57194.563, "sample_time_ms": 4237.318, "learn_time_ms": 52929.516, "learn_throughput": 75.572, "synch_weights_time_ms": 21.088}, "counters": {"num_env_steps_sampled": 331120, "num_env_steps_trained": 331120, "num_agent_steps_sampled": 1324480, "num_agent_steps_trained": 1324480}, "done": false, "training_iteration": 82, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-37-57", "timestamp": 1724152077, "time_this_iter_s": 57.9642219543457, "time_total_s": 4638.184022903442, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17235f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4638.184022903442, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 55.23333333333334, "ram_util_percent": 83.32469135802468}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.263004952133016, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.060648655260682, "policy_loss": -0.017929894685567844, "vf_loss": 7.076323520064984, "vf_explained_var": 0.33877980321172685, "kl": 0.011275084230496928, "entropy": 0.6573659825261938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157395.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999885}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.394093628156753, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.6544111072701755, "policy_loss": -0.016989094394175386, "vf_loss": 5.669408478812566, "vf_explained_var": 0.17478012376361424, "kl": 0.009958616230222914, "entropy": 0.6796073437052429, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157395.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999885}}, "num_env_steps_sampled": 335120, "num_env_steps_trained": 335120, "num_agent_steps_sampled": 1340480, "num_agent_steps_trained": 1340480}, "env_runners": {"episode_reward_max": 398.0, "episode_reward_min": 3.353314364683846, "episode_reward_mean": 136.9390865726308, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.6067906963129, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.16177943720504, "predator_policy": 383.6871714916094}, "policy_reward_mean": {"prey_policy": -68.71273192191849, "predator_policy": 137.18227520823388}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.71967215785174, 184.93243071616033, 191.9540474134709, 165.60530598323336, 220.62594257323445, 123.41597747748631, 82.51860228598028, 97.98859481368291, 141.0810545410499, 109.11078718915437, 170.65970023892416, 24.199999999999996, 140.920612687664, 212.9999999999993, 138.87566258509318, 3.353314364683846, 76.72725569085414, 175.61911751337814, 167.41788181193942, 153.11157802377204, 135.22722913550808, 221.03204468033852, 140.55686203185974, 84.64852540417033, 179.5895399500016, 121.29641439476742, 95.3070871222393, 59.03396874220682, 53.38294358287626, 70.10814555227114, 120.69999999999976, 224.4887556437206, 28.674203412502706, 156.98629998049202, 136.43104802205065, 112.20068363745051, 82.74455817022005, 72.78724165546734, 112.8883081515279, 92.60982931143839, 280.0535692550807, 89.99964744718717, 79.56928077309783, 213.713573983201, 334.0, 220.53992177113417, 157.09999999999957, 213.56235557742778, 116.89999999999858, 198.2999999999993, 233.69999999999933, 134.30837607261407, 211.64101854942658, 157.75819897570355, 46.91929861617903, 398.0, 258.29999999999984, 310.00133706542573, 191.48425372534157, 209.13492960012422, 219.530512113885, 150.68076689639986, 156.22639003955763, 33.11666730250898, 76.90712094936552, 213.28302885981986, 60.79500893703467, 171.63471017383074, 87.93878953547913, 176.51103132123288, 240.09823536303875, 72.9533299699419, 34.34659164242059, 21.900000000000002, 41.159154562631414, 237.9866177574704, 77.21406158560532, 59.9411182680586, 178.32927972318404, 39.8718137905603, 73.71512534903029, 197.9085775805856, 45.49038377253764, 139.42473395805058, 61.055633655178255, 49.60594136351772, 75.50827064320596, 147.41522105134516, 72.40967394936973, 170.23607580171213, 95.21294907411931, 302.7534932745563, 103.65585367707266, 179.0942102036132, 168.50669827437528, 98.08303587437307, 115.87042926022154, 74.06668982203962, 65.05444382548814, 118.89999999999989], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-242.23863255338551, -222.22966377795575, -202.42236968157346, 149.8705691785865, 65.25547217618204, -104.97252860761357, -238.51988850753102, 47.15872127340388, -147.29676924757638, 102.01140111813471, -168.90751675737314, -293.35043858773815, -200.82779705440157, -213.8089028911062, -244.08284552960754, 43.853504952315, -17.373557445372743, -138.2006815819364, -199.39418529098745, -118.3349247625807, 75.88490013170379, 0.04389606193812304, -250.02227490100685, -107.54365586382079, -112.18901409772126, -1.4584574265804378, 185.902729791814, 20.000000000000014, -134.72260590554853, 5.9869113096167705, -124.48088996148587, -257.09734195683814, -14.604242485265132, -105.84975650067852, 79.38683765203132, -139.7677316544855, 137.02996329326174, 8.573953652485338, -99.8612836456253, -17.213980988919104, -206.00697923668258, 49.43966586182891, 81.17113248424255, 29.65427431234108, -17.31386676644975, -128.50451011260893, -211.25728236963653, -129.07932126723202, 2.1698436314511844, -83.93782081911063, -400.6067906963129, 9.995535333802398, -10.427297519305355, -212.80108837220104, -87.25656917184949, -194.9321257827384, -123.45827901133026, -114.04986944812096, -220.20359443907006, -172.47349146372582, -3.528331914643715, -63.681472954494666, -220.65321493123116, 180.1652800673872, -56.43980503190511, -207.49805434554068, -87.45554335351743, -359.3184900504033, -71.65685087399206, 75.74143916496178, 91.58325869723936, -197.35937358316076, -23.549392545310535, -45.24409985714576, -117.29155297092743, -65.43171526973856, -186.60852406209318, -200.12259020352755, -63.643394827920304, -162.00344858883471, -101.46283857229979, -89.46629243940939, 40.02612648909218, -247.0897724832002, -292.1258254221982, -82.59222490489361, -43.42247428202742, 72.01369527477888, 143.50484371963836, 111.26882592864979, -107.2500050458169, 198.0821142503228, 20.000000000000014, 120.36258742088694, -221.2768413217796, 196.32125228397692, -34.12127421968478, 56.112870137684936, 167.87339126006788, -10.570681008916063, -13.284135460761618, 188.99180147155477, -4.441787571131911, 68.56614726814199, -30.536103413757413, 117.77960119762676, -274.6476318889565, 114.65928085301702, 19.12361211015887, -124.90916129559758, 197.99380119577953, 198.16177943720504, 153.74766671980893, 18.40943136862431, 71.82108062319375, 77.36872931193264, -248.42090422300907, 150.72741916499885, -69.55889264221938, 165.12136127601644, -140.47690365613167, 147.41717450004887, 97.2817088395778, -259.9519179076957, 49.81693806724607, 20.000000000000014, -305.84221052302155, -96.76964798663688, 13.622316909730108, -119.77022182364507, 176.68717485763682, -282.4393181218862, -184.92211388850887, -135.98926662634025, 88.90612685574295, -214.47586579387965, -134.91262235607988, -149.07015655183835, -67.29987166858353, -288.8077241943414, 176.23355714183302, -173.85537420392268, -49.85111777112725, -266.3032605924959, -142.90311341291, -105.37993750341037, -294.60966713190265, -292.40162158370737, -257.88875882092907, -114.040440334164, -152.31787506790795, 1.144350934672439, -206.90514131086772, -44.741340756441815, -4.869171836294045, -171.99241637300028, -364.02625095390306, 89.7448403994332, -115.70892521666862, -258.88784779097097, -259.9545652123223, -65.64746597387408, 162.01049762432433, -132.22568074782538, -92.46963486165899, -234.65445677384187, -137.28315938001316, 110.22551730466483, 33.635281189096425, -100.9139418004455, -38.43387800992632, -299.4693666515393, 18.06034825010279, -125.74478567935466, -46.18825322188852, -163.9870708872307, -119.43090538411434, -82.50060517721508, 93.40333944639252, -157.61191042337546, -110.56014205791287, -32.42985344383044, -209.3468178123066, 188.8101510150033, -180.15162886930148, -58.67669640714091, -143.9615094121487, 148.0827998143253, -143.14241267649575, 112.99419674394821, -78.42619030480853, -126.73599089548354, 8.132355156423333, -60.17259972602754, -28.03936520212572, -294.9408619401728, -77.96841519237604, -4.2159741822705925, 22.419090381932904, -51.653092956342064], "policy_predator_policy_reward": [218.56392960576545, 298.62403888342664, 78.56099680876781, 158.9232344103795, 118.41441922088025, 113.25668462402199, 168.48152400661195, 188.4849492107487, 164.85165674407546, 101.05965395860039, 323.62988544524165, 262.04404737735575, 270.2607616569029, 226.89454057458488, 112.19776768521066, 186.02016770576483, 140.83288651679536, 155.8224070515638, 227.60996223014064, 199.22993501258173, 55.597153149189324, 39.133750896093524, 184.07692853034328, 197.68900223448344, 100.3939415817672, 154.1741426301984, 7.097270208185999, 0.0, 227.99959039103217, 39.6117667899927, 205.53655897341142, 179.394987309596, 67.2085606404733, 129.9726940363235, 88.44582789708232, 147.55418361875, 10.587918518678093, 11.22604634751463, 93.15098139787537, 177.03586126044112, 234.8995159601301, 56.89502655023151, 61.186503192398156, 49.020134691357, 145.07072879831014, 141.3045101126084, 209.00545881800653, 215.9796702230315, 184.57664946063252, 76.78086767702916, 375.9646246191601, 135.943045138118, 73.75872035688087, 244.77675265686452, 131.32276363052296, 209.89990006627065, 65.739706743721, 225.15138529860565, 268.2018248506905, 194.58340660437574, 108.62833191464354, 79.28147295449381, 186.4451556632561, 78.53153484430862, 220.6361789105068, 71.97588387944121, 220.0731618928043, 383.6871714916094, 69.4233249876096, 62.923134743471984, 0.0, 217.97679852337168, 83.78482049918209, 67.75323007349442, 83.96207130459811, 171.5484385915348, 145.36134781664632, 354.2580746005027, 149.2709751332595, 168.98569759493344, 265.2700657517834, 205.71263451500664, 128.47303401187332, 168.59025942942205, 294.56623274921833, 159.72109835097126, 104.22072397631129, 80.90162901413824, 28.495156280361673, 50.73117407135021, 81.60424591950762, 48.103566647120665, 0.0, 16.73741257911305, 101.83101435915168, 136.68693025607897, 94.01007351141465, 0.8983305705855575, 0.0, 40.997289748848374, 55.28413546076175, 2.708198528445232, 63.745128771227584, 6.43888760437661, 121.87668817860703, 2.520832586950284, 64.86881315282385, 252.87773685881905, 106.87367864910152, 45.831169152515415, 1.006198804220474, 0.83822056279496, 84.10003756079024, 2.042864350776575, 109.135627831368, 51.67589929893083, 239.82547729456698, 49.352261488784784, 30.729873076177714, 82.8425878901495, 104.14052720848731, 108.44971406148055, 120.75882091105922, 192.59215505345836, 16.871683730268522, 69.53776824204346, 184.33515584982518, 251.39336996234135, 121.85913111206094, 61.19589475121878, 284.11837658805314, 34.91679553601606, 213.79115443618466, 167.9152350156984, 86.74521821540827, 210.45923089655903, 249.56266675797397, 122.358901685423, 259.57121565252356, 273.0474115316341, 193.70751714181736, 44.01253528331105, 90.10118951355828, 299.0065188200066, 106.12013785311079, 176.50950470562887, 316.5096671319032, 292.40162158370737, 301.64932107036105, 111.43903264736444, 171.5722462391855, 217.58789565152043, 188.17200283025608, 140.68854082265884, 109.04364915372537, 127.75905732362673, 262.9023440350403, 189.70834624261454, 198.6001166922497, 215.86847010594968, 303.8897387682153, 95.42741776701119, 71.78998641386463, 96.33377429022202, 125.72888029331817, 246.88559511471988, 154.9994847740234, 11.4828912593757, 19.010228623105075, 109.32406564342129, 128.6957860313943, 258.81339999359005, 152.87906256121883, 30.31364551123907, 142.92039440814028, 214.67015075232413, 132.79811255026243, 141.5430719604365, 195.6029061688916, 38.84174060980357, 149.7194771870371, 88.48346738882519, 124.07275076732182, 199.21740930453845, 95.6474998986606, 246.83667905485376, 71.28314485395468, 103.68977494748184, 194.07350092787902, 4.581413279043809, 199.7434195297709, 103.50179754489426, 81.9100036362967, 86.0006701935293, 134.95401012134175, 262.0929068429981, 107.86519563103121, 39.373637569102776, 123.40963542944002, 24.72436714496942]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.092110245696988, "mean_inference_ms": 6.550369370776815, "mean_action_processing_ms": 4.255682890491634, "mean_env_wait_ms": 14.242616694695464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012628436088562012, "StateBufferConnector_ms": 0.010901331901550293, "ViewRequirementAgentConnector_ms": 0.3165278434753418}, "num_episodes": 20, "episode_return_max": 398.0, "episode_return_min": 3.353314364683846, "episode_return_mean": 136.9390865726308, "episodes_this_iter": 20}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1340480, "num_agent_steps_trained": 1340480, "num_env_steps_sampled": 335120, "num_env_steps_trained": 335120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.77147971423872, "num_env_steps_trained_throughput_per_sec": 73.77147971423872, "timesteps_total": 335120, "num_env_steps_sampled_lifetime": 335120, "num_agent_steps_sampled_lifetime": 1340480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1340480, "timers": {"training_iteration_time_ms": 57026.483, "restore_workers_time_ms": 0.015, "training_step_time_ms": 57026.41, "sample_time_ms": 4176.351, "learn_time_ms": 52821.775, "learn_throughput": 75.726, "synch_weights_time_ms": 21.531}, "counters": {"num_env_steps_sampled": 335120, "num_env_steps_trained": 335120, "num_agent_steps_sampled": 1340480, "num_agent_steps_trained": 1340480}, "done": false, "training_iteration": 83, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-38-52", "timestamp": 1724152132, "time_this_iter_s": 54.289501905441284, "time_total_s": 4692.473524808884, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120bce8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4692.473524808884, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 52.73636363636365, "ram_util_percent": 83.28441558441558}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.246681879689454, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.362279697196193, "policy_loss": -0.020442630034605308, "vf_loss": 6.380288500003714, "vf_explained_var": 0.4690510385881656, "kl": 0.012169144074949954, "entropy": 0.6770334956191835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.6073149616756135, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.358425545061706, "policy_loss": -0.015313436457069306, "vf_loss": 5.371753077027659, "vf_explained_var": 0.20618616411925625, "kl": 0.00992950382334471, "entropy": 0.6770005014838365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 339120, "num_env_steps_trained": 339120, "num_agent_steps_sampled": 1356480, "num_agent_steps_trained": 1356480}, "env_runners": {"episode_reward_max": 398.0, "episode_reward_min": 17.443253389256434, "episode_reward_mean": 131.10879928926212, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.6067906963129, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.16177943720504, "predator_policy": 383.6871714916094}, "policy_reward_mean": {"prey_policy": -69.36980863882395, "predator_policy": 134.92420828345502}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.22722913550808, 221.03204468033852, 140.55686203185974, 84.64852540417033, 179.5895399500016, 121.29641439476742, 95.3070871222393, 59.03396874220682, 53.38294358287626, 70.10814555227114, 120.69999999999976, 224.4887556437206, 28.674203412502706, 156.98629998049202, 136.43104802205065, 112.20068363745051, 82.74455817022005, 72.78724165546734, 112.8883081515279, 92.60982931143839, 280.0535692550807, 89.99964744718717, 79.56928077309783, 213.713573983201, 334.0, 220.53992177113417, 157.09999999999957, 213.56235557742778, 116.89999999999858, 198.2999999999993, 233.69999999999933, 134.30837607261407, 211.64101854942658, 157.75819897570355, 46.91929861617903, 398.0, 258.29999999999984, 310.00133706542573, 191.48425372534157, 209.13492960012422, 219.530512113885, 150.68076689639986, 156.22639003955763, 33.11666730250898, 76.90712094936552, 213.28302885981986, 60.79500893703467, 171.63471017383074, 87.93878953547913, 176.51103132123288, 240.09823536303875, 72.9533299699419, 34.34659164242059, 21.900000000000002, 41.159154562631414, 237.9866177574704, 77.21406158560532, 59.9411182680586, 178.32927972318404, 39.8718137905603, 73.71512534903029, 197.9085775805856, 45.49038377253764, 139.42473395805058, 61.055633655178255, 49.60594136351772, 75.50827064320596, 147.41522105134516, 72.40967394936973, 170.23607580171213, 95.21294907411931, 302.7534932745563, 103.65585367707266, 179.0942102036132, 168.50669827437528, 98.08303587437307, 115.87042926022154, 74.06668982203962, 65.05444382548814, 118.89999999999989, 124.59019882049417, 74.8368928370254, 113.32704451995488, 157.09999999999957, 104.74068591990185, 38.40000000000031, 50.90375247101187, 169.92871625710185, 138.6221560619588, 96.2999999999999, 265.09999999999997, 107.08741608489066, 101.93221078991729, 78.08388347648315, 88.62694231711713, 63.793295267123305, 194.79236151851063, 29.80000000000011, 35.40000000000023, 17.443253389256434], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-206.00697923668258, 49.43966586182891, 81.17113248424255, 29.65427431234108, -17.31386676644975, -128.50451011260893, -211.25728236963653, -129.07932126723202, 2.1698436314511844, -83.93782081911063, -400.6067906963129, 9.995535333802398, -10.427297519305355, -212.80108837220104, -87.25656917184949, -194.9321257827384, -123.45827901133026, -114.04986944812096, -220.20359443907006, -172.47349146372582, -3.528331914643715, -63.681472954494666, -220.65321493123116, 180.1652800673872, -56.43980503190511, -207.49805434554068, -87.45554335351743, -359.3184900504033, -71.65685087399206, 75.74143916496178, 91.58325869723936, -197.35937358316076, -23.549392545310535, -45.24409985714576, -117.29155297092743, -65.43171526973856, -186.60852406209318, -200.12259020352755, -63.643394827920304, -162.00344858883471, -101.46283857229979, -89.46629243940939, 40.02612648909218, -247.0897724832002, -292.1258254221982, -82.59222490489361, -43.42247428202742, 72.01369527477888, 143.50484371963836, 111.26882592864979, -107.2500050458169, 198.0821142503228, 20.000000000000014, 120.36258742088694, -221.2768413217796, 196.32125228397692, -34.12127421968478, 56.112870137684936, 167.87339126006788, -10.570681008916063, -13.284135460761618, 188.99180147155477, -4.441787571131911, 68.56614726814199, -30.536103413757413, 117.77960119762676, -274.6476318889565, 114.65928085301702, 19.12361211015887, -124.90916129559758, 197.99380119577953, 198.16177943720504, 153.74766671980893, 18.40943136862431, 71.82108062319375, 77.36872931193264, -248.42090422300907, 150.72741916499885, -69.55889264221938, 165.12136127601644, -140.47690365613167, 147.41717450004887, 97.2817088395778, -259.9519179076957, 49.81693806724607, 20.000000000000014, -305.84221052302155, -96.76964798663688, 13.622316909730108, -119.77022182364507, 176.68717485763682, -282.4393181218862, -184.92211388850887, -135.98926662634025, 88.90612685574295, -214.47586579387965, -134.91262235607988, -149.07015655183835, -67.29987166858353, -288.8077241943414, 176.23355714183302, -173.85537420392268, -49.85111777112725, -266.3032605924959, -142.90311341291, -105.37993750341037, -294.60966713190265, -292.40162158370737, -257.88875882092907, -114.040440334164, -152.31787506790795, 1.144350934672439, -206.90514131086772, -44.741340756441815, -4.869171836294045, -171.99241637300028, -364.02625095390306, 89.7448403994332, -115.70892521666862, -258.88784779097097, -259.9545652123223, -65.64746597387408, 162.01049762432433, -132.22568074782538, -92.46963486165899, -234.65445677384187, -137.28315938001316, 110.22551730466483, 33.635281189096425, -100.9139418004455, -38.43387800992632, -299.4693666515393, 18.06034825010279, -125.74478567935466, -46.18825322188852, -163.9870708872307, -119.43090538411434, -82.50060517721508, 93.40333944639252, -157.61191042337546, -110.56014205791287, -32.42985344383044, -209.3468178123066, 188.8101510150033, -180.15162886930148, -58.67669640714091, -143.9615094121487, 148.0827998143253, -143.14241267649575, 112.99419674394821, -78.42619030480853, -126.73599089548354, 8.132355156423333, -60.17259972602754, -28.03936520212572, -294.9408619401728, -77.96841519237604, -4.2159741822705925, 22.419090381932904, -51.653092956342064, -77.29814842212033, 10.060569399306328, -84.35682245912183, -111.2345793958887, -155.6354999296923, -194.0544090942988, 102.58594749126382, 20.000000000000014, -144.35704620040818, -234.50674299676444, -83.43964101375134, -84.09915923382587, -376.7818325912032, -150.7828364335711, 109.08790389846848, -115.28184151631811, 89.73743784480112, -122.2162132832423, -37.185506256714696, -6.892047792234527, 70.18843254323903, 111.56992381243796, 55.26578420491746, -183.79559376028567, -217.24246144302992, 23.35734047396513, -67.27396847107596, -155.4027772727224, -250.39847189269537, 11.345531600038187, -226.8072842061546, 18.257663301515922, -133.54940859918582, 107.58833469840354, -84.18120006440407, -76.75681117001011, 7.351658560914972, -26.380829774295734, -322.64158246068473, -341.07223254990623], "policy_predator_policy_reward": [234.8995159601301, 56.89502655023151, 61.186503192398156, 49.020134691357, 145.07072879831014, 141.3045101126084, 209.00545881800653, 215.9796702230315, 184.57664946063252, 76.78086767702916, 375.9646246191601, 135.943045138118, 73.75872035688087, 244.77675265686452, 131.32276363052296, 209.89990006627065, 65.739706743721, 225.15138529860565, 268.2018248506905, 194.58340660437574, 108.62833191464354, 79.28147295449381, 186.4451556632561, 78.53153484430862, 220.6361789105068, 71.97588387944121, 220.0731618928043, 383.6871714916094, 69.4233249876096, 62.923134743471984, 0.0, 217.97679852337168, 83.78482049918209, 67.75323007349442, 83.96207130459811, 171.5484385915348, 145.36134781664632, 354.2580746005027, 149.2709751332595, 168.98569759493344, 265.2700657517834, 205.71263451500664, 128.47303401187332, 168.59025942942205, 294.56623274921833, 159.72109835097126, 104.22072397631129, 80.90162901413824, 28.495156280361673, 50.73117407135021, 81.60424591950762, 48.103566647120665, 0.0, 16.73741257911305, 101.83101435915168, 136.68693025607897, 94.01007351141465, 0.8983305705855575, 0.0, 40.997289748848374, 55.28413546076175, 2.708198528445232, 63.745128771227584, 6.43888760437661, 121.87668817860703, 2.520832586950284, 64.86881315282385, 252.87773685881905, 106.87367864910152, 45.831169152515415, 1.006198804220474, 0.83822056279496, 84.10003756079024, 2.042864350776575, 109.135627831368, 51.67589929893083, 239.82547729456698, 49.352261488784784, 30.729873076177714, 82.8425878901495, 104.14052720848731, 108.44971406148055, 120.75882091105922, 192.59215505345836, 16.871683730268522, 69.53776824204346, 184.33515584982518, 251.39336996234135, 121.85913111206094, 61.19589475121878, 284.11837658805314, 34.91679553601606, 213.79115443618466, 167.9152350156984, 86.74521821540827, 210.45923089655903, 249.56266675797397, 122.358901685423, 259.57121565252356, 273.0474115316341, 193.70751714181736, 44.01253528331105, 90.10118951355828, 299.0065188200066, 106.12013785311079, 176.50950470562887, 316.5096671319032, 292.40162158370737, 301.64932107036105, 111.43903264736444, 171.5722462391855, 217.58789565152043, 188.17200283025608, 140.68854082265884, 109.04364915372537, 127.75905732362673, 262.9023440350403, 189.70834624261454, 198.6001166922497, 215.86847010594968, 303.8897387682153, 95.42741776701119, 71.78998641386463, 96.33377429022202, 125.72888029331817, 246.88559511471988, 154.9994847740234, 11.4828912593757, 19.010228623105075, 109.32406564342129, 128.6957860313943, 258.81339999359005, 152.87906256121883, 30.31364551123907, 142.92039440814028, 214.67015075232413, 132.79811255026243, 141.5430719604365, 195.6029061688916, 38.84174060980357, 149.7194771870371, 88.48346738882519, 124.07275076732182, 199.21740930453845, 95.6474998986606, 246.83667905485376, 71.28314485395468, 103.68977494748184, 194.07350092787902, 4.581413279043809, 199.7434195297709, 103.50179754489426, 81.9100036362967, 86.0006701935293, 134.95401012134175, 262.0929068429981, 107.86519563103121, 39.373637569102776, 123.40963542944002, 24.72436714496942, 136.8153182816083, 55.01245956170071, 106.75333862164213, 163.67495607039268, 253.27670909209732, 209.74024445184835, 34.514052508736235, 0.0, 226.83840252918978, 256.7660725878845, 64.58389446991279, 141.3549057776632, 351.5594341541361, 226.90898734164966, 6.1772975095062215, 169.94535636544506, 17.21243744830692, 153.88849405209325, 57.28702995033798, 83.09052409861141, 57.01156745676101, 26.330076187562113, 112.94126863512018, 122.67595700513861, 59.686810224552076, 236.1305215344305, 132.55785194755893, 168.2027772727221, 179.333742750743, 148.34613985903187, 128.35235452886678, 143.99056164289476, 197.2494085991857, 23.504026820107153, 126.54826574872621, 64.1897454856869, 11.348341439084995, 43.08082977429597, 302.1187508971644, 379.0383175026833]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.077190202117254, "mean_inference_ms": 6.538821441765008, "mean_action_processing_ms": 4.233400160095457, "mean_env_wait_ms": 14.250171689380483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01276254653930664, "StateBufferConnector_ms": 0.008310675621032715, "ViewRequirementAgentConnector_ms": 0.30670106410980225}, "num_episodes": 20, "episode_return_max": 398.0, "episode_return_min": 17.443253389256434, "episode_return_mean": 131.10879928926212, "episodes_this_iter": 20}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356480, "num_agent_steps_trained": 1356480, "num_env_steps_sampled": 339120, "num_env_steps_trained": 339120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.1183648929706, "num_env_steps_trained_throughput_per_sec": 65.1183648929706, "timesteps_total": 339120, "num_env_steps_sampled_lifetime": 339120, "num_agent_steps_sampled_lifetime": 1356480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1356480, "timers": {"training_iteration_time_ms": 57232.108, "restore_workers_time_ms": 0.015, "training_step_time_ms": 57232.041, "sample_time_ms": 4088.606, "learn_time_ms": 53114.838, "learn_throughput": 75.309, "synch_weights_time_ms": 21.523}, "counters": {"num_env_steps_sampled": 339120, "num_env_steps_trained": 339120, "num_agent_steps_sampled": 1356480, "num_agent_steps_trained": 1356480}, "done": false, "training_iteration": 84, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-39-53", "timestamp": 1724152193, "time_this_iter_s": 61.5096390247345, "time_total_s": 4753.983163833618, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120bce5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4753.983163833618, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 66.21724137931035, "ram_util_percent": 83.58045977011496}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.47065028084649, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.986610135073384, "policy_loss": -0.017027540926984143, "vf_loss": 7.001303479532716, "vf_explained_var": 0.46331164057923374, "kl": 0.011670977225965726, "entropy": 0.6515506575347254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.976442698322276, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.732968142802123, "policy_loss": -0.016558667286742657, "vf_loss": 5.747268310804215, "vf_explained_var": 0.12838851191379405, "kl": 0.011292510766846437, "entropy": 0.7088906775706659, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 343120, "num_env_steps_trained": 343120, "num_agent_steps_sampled": 1372480, "num_agent_steps_trained": 1372480}, "env_runners": {"episode_reward_max": 398.0, "episode_reward_min": 7.236526204063881, "episode_reward_mean": 129.6927765990232, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -386.9269837174229, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.16177943720504, "predator_policy": 379.0383175026833}, "policy_reward_mean": {"prey_policy": -70.3767147603153, "predator_policy": 135.22310305982688}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.0535692550807, 89.99964744718717, 79.56928077309783, 213.713573983201, 334.0, 220.53992177113417, 157.09999999999957, 213.56235557742778, 116.89999999999858, 198.2999999999993, 233.69999999999933, 134.30837607261407, 211.64101854942658, 157.75819897570355, 46.91929861617903, 398.0, 258.29999999999984, 310.00133706542573, 191.48425372534157, 209.13492960012422, 219.530512113885, 150.68076689639986, 156.22639003955763, 33.11666730250898, 76.90712094936552, 213.28302885981986, 60.79500893703467, 171.63471017383074, 87.93878953547913, 176.51103132123288, 240.09823536303875, 72.9533299699419, 34.34659164242059, 21.900000000000002, 41.159154562631414, 237.9866177574704, 77.21406158560532, 59.9411182680586, 178.32927972318404, 39.8718137905603, 73.71512534903029, 197.9085775805856, 45.49038377253764, 139.42473395805058, 61.055633655178255, 49.60594136351772, 75.50827064320596, 147.41522105134516, 72.40967394936973, 170.23607580171213, 95.21294907411931, 302.7534932745563, 103.65585367707266, 179.0942102036132, 168.50669827437528, 98.08303587437307, 115.87042926022154, 74.06668982203962, 65.05444382548814, 118.89999999999989, 124.59019882049417, 74.8368928370254, 113.32704451995488, 157.09999999999957, 104.74068591990185, 38.40000000000031, 50.90375247101187, 169.92871625710185, 138.6221560619588, 96.2999999999999, 265.09999999999997, 107.08741608489066, 101.93221078991729, 78.08388347648315, 88.62694231711713, 63.793295267123305, 194.79236151851063, 29.80000000000011, 35.40000000000023, 17.443253389256434, 140.8131644196187, 52.392008443100494, 117.79999999999976, 31.898891838311734, 141.32472139728333, 49.81322911217373, 109.46518783077535, 7.236526204063881, 271.4888366617993, 157.91354197868992, 73.26870770897898, 27.65030856115913, 175.29105376486243, 248.63469784939542, 64.17006625163826, 36.44554638600377, 73.3637592452626, 81.29026948012907, 198.10998182895133, 100.72092059501853], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-101.46283857229979, -89.46629243940939, 40.02612648909218, -247.0897724832002, -292.1258254221982, -82.59222490489361, -43.42247428202742, 72.01369527477888, 143.50484371963836, 111.26882592864979, -107.2500050458169, 198.0821142503228, 20.000000000000014, 120.36258742088694, -221.2768413217796, 196.32125228397692, -34.12127421968478, 56.112870137684936, 167.87339126006788, -10.570681008916063, -13.284135460761618, 188.99180147155477, -4.441787571131911, 68.56614726814199, -30.536103413757413, 117.77960119762676, -274.6476318889565, 114.65928085301702, 19.12361211015887, -124.90916129559758, 197.99380119577953, 198.16177943720504, 153.74766671980893, 18.40943136862431, 71.82108062319375, 77.36872931193264, -248.42090422300907, 150.72741916499885, -69.55889264221938, 165.12136127601644, -140.47690365613167, 147.41717450004887, 97.2817088395778, -259.9519179076957, 49.81693806724607, 20.000000000000014, -305.84221052302155, -96.76964798663688, 13.622316909730108, -119.77022182364507, 176.68717485763682, -282.4393181218862, -184.92211388850887, -135.98926662634025, 88.90612685574295, -214.47586579387965, -134.91262235607988, -149.07015655183835, -67.29987166858353, -288.8077241943414, 176.23355714183302, -173.85537420392268, -49.85111777112725, -266.3032605924959, -142.90311341291, -105.37993750341037, -294.60966713190265, -292.40162158370737, -257.88875882092907, -114.040440334164, -152.31787506790795, 1.144350934672439, -206.90514131086772, -44.741340756441815, -4.869171836294045, -171.99241637300028, -364.02625095390306, 89.7448403994332, -115.70892521666862, -258.88784779097097, -259.9545652123223, -65.64746597387408, 162.01049762432433, -132.22568074782538, -92.46963486165899, -234.65445677384187, -137.28315938001316, 110.22551730466483, 33.635281189096425, -100.9139418004455, -38.43387800992632, -299.4693666515393, 18.06034825010279, -125.74478567935466, -46.18825322188852, -163.9870708872307, -119.43090538411434, -82.50060517721508, 93.40333944639252, -157.61191042337546, -110.56014205791287, -32.42985344383044, -209.3468178123066, 188.8101510150033, -180.15162886930148, -58.67669640714091, -143.9615094121487, 148.0827998143253, -143.14241267649575, 112.99419674394821, -78.42619030480853, -126.73599089548354, 8.132355156423333, -60.17259972602754, -28.03936520212572, -294.9408619401728, -77.96841519237604, -4.2159741822705925, 22.419090381932904, -51.653092956342064, -77.29814842212033, 10.060569399306328, -84.35682245912183, -111.2345793958887, -155.6354999296923, -194.0544090942988, 102.58594749126382, 20.000000000000014, -144.35704620040818, -234.50674299676444, -83.43964101375134, -84.09915923382587, -376.7818325912032, -150.7828364335711, 109.08790389846848, -115.28184151631811, 89.73743784480112, -122.2162132832423, -37.185506256714696, -6.892047792234527, 70.18843254323903, 111.56992381243796, 55.26578420491746, -183.79559376028567, -217.24246144302992, 23.35734047396513, -67.27396847107596, -155.4027772727224, -250.39847189269537, 11.345531600038187, -226.8072842061546, 18.257663301515922, -133.54940859918582, 107.58833469840354, -84.18120006440407, -76.75681117001011, 7.351658560914972, -26.380829774295734, -322.64158246068473, -341.07223254990623, -94.49835572220528, -122.25301542611442, -198.7126000758993, -77.91754725786271, -17.78475653269666, 20.000000000000014, -50.05216423483838, -165.56651898314584, -250.13702728414802, 58.1566316417956, 1.4840075469879637, 15.9842555507687, -210.17825925344192, -112.61734584645363, -211.958014524182, -373.9330457626167, 189.00987023168997, -309.0794657483332, -231.19492073243183, -73.46975062866986, -234.80887144458228, 29.55032986658086, -198.14427148346937, -258.86174470270515, -44.31397883646258, -120.13403154014607, -186.21874306925926, 122.61904135563888, -162.64124687861863, -29.019907044718295, -184.25334573653973, -100.23533191768774, -31.266097267604508, -386.9269837174229, -80.29232714402217, -44.89739504312797, 80.32377990554022, 49.130758146329384, -130.2740131244521, 0.12686613275200254], "policy_predator_policy_reward": [265.2700657517834, 205.71263451500664, 128.47303401187332, 168.59025942942205, 294.56623274921833, 159.72109835097126, 104.22072397631129, 80.90162901413824, 28.495156280361673, 50.73117407135021, 81.60424591950762, 48.103566647120665, 0.0, 16.73741257911305, 101.83101435915168, 136.68693025607897, 94.01007351141465, 0.8983305705855575, 0.0, 40.997289748848374, 55.28413546076175, 2.708198528445232, 63.745128771227584, 6.43888760437661, 121.87668817860703, 2.520832586950284, 64.86881315282385, 252.87773685881905, 106.87367864910152, 45.831169152515415, 1.006198804220474, 0.83822056279496, 84.10003756079024, 2.042864350776575, 109.135627831368, 51.67589929893083, 239.82547729456698, 49.352261488784784, 30.729873076177714, 82.8425878901495, 104.14052720848731, 108.44971406148055, 120.75882091105922, 192.59215505345836, 16.871683730268522, 69.53776824204346, 184.33515584982518, 251.39336996234135, 121.85913111206094, 61.19589475121878, 284.11837658805314, 34.91679553601606, 213.79115443618466, 167.9152350156984, 86.74521821540827, 210.45923089655903, 249.56266675797397, 122.358901685423, 259.57121565252356, 273.0474115316341, 193.70751714181736, 44.01253528331105, 90.10118951355828, 299.0065188200066, 106.12013785311079, 176.50950470562887, 316.5096671319032, 292.40162158370737, 301.64932107036105, 111.43903264736444, 171.5722462391855, 217.58789565152043, 188.17200283025608, 140.68854082265884, 109.04364915372537, 127.75905732362673, 262.9023440350403, 189.70834624261454, 198.6001166922497, 215.86847010594968, 303.8897387682153, 95.42741776701119, 71.78998641386463, 96.33377429022202, 125.72888029331817, 246.88559511471988, 154.9994847740234, 11.4828912593757, 19.010228623105075, 109.32406564342129, 128.6957860313943, 258.81339999359005, 152.87906256121883, 30.31364551123907, 142.92039440814028, 214.67015075232413, 132.79811255026243, 141.5430719604365, 195.6029061688916, 38.84174060980357, 149.7194771870371, 88.48346738882519, 124.07275076732182, 199.21740930453845, 95.6474998986606, 246.83667905485376, 71.28314485395468, 103.68977494748184, 194.07350092787902, 4.581413279043809, 199.7434195297709, 103.50179754489426, 81.9100036362967, 86.0006701935293, 134.95401012134175, 262.0929068429981, 107.86519563103121, 39.373637569102776, 123.40963542944002, 24.72436714496942, 136.8153182816083, 55.01245956170071, 106.75333862164213, 163.67495607039268, 253.27670909209732, 209.74024445184835, 34.514052508736235, 0.0, 226.83840252918978, 256.7660725878845, 64.58389446991279, 141.3549057776632, 351.5594341541361, 226.90898734164966, 6.1772975095062215, 169.94535636544506, 17.21243744830692, 153.88849405209325, 57.28702995033798, 83.09052409861141, 57.01156745676101, 26.330076187562113, 112.94126863512018, 122.67595700513861, 59.686810224552076, 236.1305215344305, 132.55785194755893, 168.2027772727221, 179.333742750743, 148.34613985903187, 128.35235452886678, 143.99056164289476, 197.2494085991857, 23.504026820107153, 126.54826574872621, 64.1897454856869, 11.348341439084995, 43.08082977429597, 302.1187508971644, 379.0383175026833, 145.744731034701, 211.81980453323737, 158.63325704964302, 170.38889872721856, 115.5847565326964, 0.0, 183.73531513779508, 63.78225991850045, 144.2118404035075, 189.09327663612822, 26.111180455478276, 6.233785558938265, 187.43991225194867, 244.82088067872212, 374.03304576261667, 219.0945407282455, 233.51408872959777, 158.04434344884487, 162.4384157677061, 300.1397975720857, 148.79740766384015, 129.72984162314077, 371.5805990426458, 113.07572570468754, 93.83008450111765, 245.9089796403533, 121.49521364756428, 190.7391859154516, 154.85086514457825, 100.98035503039699, 179.87705898007545, 141.057165060155, 145.640564528047, 345.91627570224335, 3.871553342647575, 202.6084383246322, 65.44546194813027, 3.2099818289515563, 119.55080475531095, 111.31726283140763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.030614159645486, "mean_inference_ms": 6.4995288282761825, "mean_action_processing_ms": 4.4180829414604235, "mean_env_wait_ms": 14.279466074982766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014174699783325195, "StateBufferConnector_ms": 0.006841778755187988, "ViewRequirementAgentConnector_ms": 0.3051488399505615}, "num_episodes": 20, "episode_return_max": 398.0, "episode_return_min": 7.236526204063881, "episode_return_mean": 129.6927765990232, "episodes_this_iter": 20}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1372480, "num_agent_steps_trained": 1372480, "num_env_steps_sampled": 343120, "num_env_steps_trained": 343120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.02126972660972, "num_env_steps_trained_throughput_per_sec": 69.02126972660972, "timesteps_total": 343120, "num_env_steps_sampled_lifetime": 343120, "num_agent_steps_sampled_lifetime": 1372480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1372480, "timers": {"training_iteration_time_ms": 57038.424, "restore_workers_time_ms": 0.015, "training_step_time_ms": 57038.351, "sample_time_ms": 4201.327, "learn_time_ms": 52808.906, "learn_throughput": 75.745, "synch_weights_time_ms": 21.534}, "counters": {"num_env_steps_sampled": 343120, "num_env_steps_trained": 343120, "num_agent_steps_sampled": 1372480, "num_agent_steps_trained": 1372480}, "done": false, "training_iteration": 85, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-40-51", "timestamp": 1724152251, "time_this_iter_s": 58.01316785812378, "time_total_s": 4811.996331691742, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120082820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4811.996331691742, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 55.812048192771094, "ram_util_percent": 83.43373493975905}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.32274165708552, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.096478407723563, "policy_loss": -0.016279950680546267, "vf_loss": 7.11058463369097, "vf_explained_var": 0.40749065484950153, "kl": 0.010868662658329836, "entropy": 0.6303003919029992, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.58945682174945, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.200858808699108, "policy_loss": -0.018303701199872034, "vf_loss": 6.216436137598028, "vf_explained_var": 0.10880871837732023, "kl": 0.013631857484061686, "entropy": 0.6220109312149583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 347120, "num_env_steps_trained": 347120, "num_agent_steps_sampled": 1388480, "num_agent_steps_trained": 1388480}, "env_runners": {"episode_reward_max": 336.9034308318719, "episode_reward_min": 7.236526204063881, "episode_reward_mean": 116.39444019636547, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -386.9269837174229, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.00987023168997, "predator_policy": 379.0383175026833}, "policy_reward_mean": {"prey_policy": -89.84309183115262, "predator_policy": 148.0403119293353}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.68076689639986, 156.22639003955763, 33.11666730250898, 76.90712094936552, 213.28302885981986, 60.79500893703467, 171.63471017383074, 87.93878953547913, 176.51103132123288, 240.09823536303875, 72.9533299699419, 34.34659164242059, 21.900000000000002, 41.159154562631414, 237.9866177574704, 77.21406158560532, 59.9411182680586, 178.32927972318404, 39.8718137905603, 73.71512534903029, 197.9085775805856, 45.49038377253764, 139.42473395805058, 61.055633655178255, 49.60594136351772, 75.50827064320596, 147.41522105134516, 72.40967394936973, 170.23607580171213, 95.21294907411931, 302.7534932745563, 103.65585367707266, 179.0942102036132, 168.50669827437528, 98.08303587437307, 115.87042926022154, 74.06668982203962, 65.05444382548814, 118.89999999999989, 124.59019882049417, 74.8368928370254, 113.32704451995488, 157.09999999999957, 104.74068591990185, 38.40000000000031, 50.90375247101187, 169.92871625710185, 138.6221560619588, 96.2999999999999, 265.09999999999997, 107.08741608489066, 101.93221078991729, 78.08388347648315, 88.62694231711713, 63.793295267123305, 194.79236151851063, 29.80000000000011, 35.40000000000023, 17.443253389256434, 140.8131644196187, 52.392008443100494, 117.79999999999976, 31.898891838311734, 141.32472139728333, 49.81322911217373, 109.46518783077535, 7.236526204063881, 271.4888366617993, 157.91354197868992, 73.26870770897898, 27.65030856115913, 175.29105376486243, 248.63469784939542, 64.17006625163826, 36.44554638600377, 73.3637592452626, 81.29026948012907, 198.10998182895133, 100.72092059501853, 246.54770351308005, 57.41318031662554, 187.01064712538346, 92.18033258010989, 197.56266541756798, 336.9034308318719, 70.66527496976082, 40.39618276692364, 221.82123603192304, 105.43340059557161, 83.87320479302625, 56.40190565862685, 64.40668076153241, 246.38275138418436, 238.91610730274232, 60.24213067251277, 98.71721763975295, 147.02775134000498, 206.10608909154647, 127.25566511651837, 59.41907535078519], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [97.2817088395778, -259.9519179076957, 49.81693806724607, 20.000000000000014, -305.84221052302155, -96.76964798663688, 13.622316909730108, -119.77022182364507, 176.68717485763682, -282.4393181218862, -184.92211388850887, -135.98926662634025, 88.90612685574295, -214.47586579387965, -134.91262235607988, -149.07015655183835, -67.29987166858353, -288.8077241943414, 176.23355714183302, -173.85537420392268, -49.85111777112725, -266.3032605924959, -142.90311341291, -105.37993750341037, -294.60966713190265, -292.40162158370737, -257.88875882092907, -114.040440334164, -152.31787506790795, 1.144350934672439, -206.90514131086772, -44.741340756441815, -4.869171836294045, -171.99241637300028, -364.02625095390306, 89.7448403994332, -115.70892521666862, -258.88784779097097, -259.9545652123223, -65.64746597387408, 162.01049762432433, -132.22568074782538, -92.46963486165899, -234.65445677384187, -137.28315938001316, 110.22551730466483, 33.635281189096425, -100.9139418004455, -38.43387800992632, -299.4693666515393, 18.06034825010279, -125.74478567935466, -46.18825322188852, -163.9870708872307, -119.43090538411434, -82.50060517721508, 93.40333944639252, -157.61191042337546, -110.56014205791287, -32.42985344383044, -209.3468178123066, 188.8101510150033, -180.15162886930148, -58.67669640714091, -143.9615094121487, 148.0827998143253, -143.14241267649575, 112.99419674394821, -78.42619030480853, -126.73599089548354, 8.132355156423333, -60.17259972602754, -28.03936520212572, -294.9408619401728, -77.96841519237604, -4.2159741822705925, 22.419090381932904, -51.653092956342064, -77.29814842212033, 10.060569399306328, -84.35682245912183, -111.2345793958887, -155.6354999296923, -194.0544090942988, 102.58594749126382, 20.000000000000014, -144.35704620040818, -234.50674299676444, -83.43964101375134, -84.09915923382587, -376.7818325912032, -150.7828364335711, 109.08790389846848, -115.28184151631811, 89.73743784480112, -122.2162132832423, -37.185506256714696, -6.892047792234527, 70.18843254323903, 111.56992381243796, 55.26578420491746, -183.79559376028567, -217.24246144302992, 23.35734047396513, -67.27396847107596, -155.4027772727224, -250.39847189269537, 11.345531600038187, -226.8072842061546, 18.257663301515922, -133.54940859918582, 107.58833469840354, -84.18120006440407, -76.75681117001011, 7.351658560914972, -26.380829774295734, -322.64158246068473, -341.07223254990623, -94.49835572220528, -122.25301542611442, -198.7126000758993, -77.91754725786271, -17.78475653269666, 20.000000000000014, -50.05216423483838, -165.56651898314584, -250.13702728414802, 58.1566316417956, 1.4840075469879637, 15.9842555507687, -210.17825925344192, -112.61734584645363, -211.958014524182, -373.9330457626167, 189.00987023168997, -309.0794657483332, -231.19492073243183, -73.46975062866986, -234.80887144458228, 29.55032986658086, -198.14427148346937, -258.86174470270515, -44.31397883646258, -120.13403154014607, -186.21874306925926, 122.61904135563888, -162.64124687861863, -29.019907044718295, -184.25334573653973, -100.23533191768774, -31.266097267604508, -386.9269837174229, -80.29232714402217, -44.89739504312797, 80.32377990554022, 49.130758146329384, -130.2740131244521, 0.12686613275200254, -83.63578100153129, 99.52224070363306, -47.31982074422384, -173.0358972457453, -52.28788939991884, 6.599948730167004, -118.03142463245831, -169.04138882334493, 62.37982572419591, 51.24434782456251, -116.0475456154347, 155.3982551071045, -260.34235642045144, -120.52984642697042, -117.2097652818083, 16.33778094540184, 13.894369106735269, -317.3885768486507, -42.580232693266396, 82.95600561734496, 11.526607537744635, -143.13851630587595, -29.120833176638357, -79.88863186559897, -78.5404383020898, -169.39342355728348, 129.3828304049017, -275.97964868125405, 41.835051745023364, -29.992213932622022, -59.01377573296282, -359.9481428067559, -22.02097318405811, -189.3131163805364, -163.83391131846744, 50.200303672604036, -310.2172850718796, 173.95749844901542, 43.64944897451131, -328.69770063068864, -8.186735387455402, -287.62321383102267], "policy_predator_policy_reward": [120.75882091105922, 192.59215505345836, 16.871683730268522, 69.53776824204346, 184.33515584982518, 251.39336996234135, 121.85913111206094, 61.19589475121878, 284.11837658805314, 34.91679553601606, 213.79115443618466, 167.9152350156984, 86.74521821540827, 210.45923089655903, 249.56266675797397, 122.358901685423, 259.57121565252356, 273.0474115316341, 193.70751714181736, 44.01253528331105, 90.10118951355828, 299.0065188200066, 106.12013785311079, 176.50950470562887, 316.5096671319032, 292.40162158370737, 301.64932107036105, 111.43903264736444, 171.5722462391855, 217.58789565152043, 188.17200283025608, 140.68854082265884, 109.04364915372537, 127.75905732362673, 262.9023440350403, 189.70834624261454, 198.6001166922497, 215.86847010594968, 303.8897387682153, 95.42741776701119, 71.78998641386463, 96.33377429022202, 125.72888029331817, 246.88559511471988, 154.9994847740234, 11.4828912593757, 19.010228623105075, 109.32406564342129, 128.6957860313943, 258.81339999359005, 152.87906256121883, 30.31364551123907, 142.92039440814028, 214.67015075232413, 132.79811255026243, 141.5430719604365, 195.6029061688916, 38.84174060980357, 149.7194771870371, 88.48346738882519, 124.07275076732182, 199.21740930453845, 95.6474998986606, 246.83667905485376, 71.28314485395468, 103.68977494748184, 194.07350092787902, 4.581413279043809, 199.7434195297709, 103.50179754489426, 81.9100036362967, 86.0006701935293, 134.95401012134175, 262.0929068429981, 107.86519563103121, 39.373637569102776, 123.40963542944002, 24.72436714496942, 136.8153182816083, 55.01245956170071, 106.75333862164213, 163.67495607039268, 253.27670909209732, 209.74024445184835, 34.514052508736235, 0.0, 226.83840252918978, 256.7660725878845, 64.58389446991279, 141.3549057776632, 351.5594341541361, 226.90898734164966, 6.1772975095062215, 169.94535636544506, 17.21243744830692, 153.88849405209325, 57.28702995033798, 83.09052409861141, 57.01156745676101, 26.330076187562113, 112.94126863512018, 122.67595700513861, 59.686810224552076, 236.1305215344305, 132.55785194755893, 168.2027772727221, 179.333742750743, 148.34613985903187, 128.35235452886678, 143.99056164289476, 197.2494085991857, 23.504026820107153, 126.54826574872621, 64.1897454856869, 11.348341439084995, 43.08082977429597, 302.1187508971644, 379.0383175026833, 145.744731034701, 211.81980453323737, 158.63325704964302, 170.38889872721856, 115.5847565326964, 0.0, 183.73531513779508, 63.78225991850045, 144.2118404035075, 189.09327663612822, 26.111180455478276, 6.233785558938265, 187.43991225194867, 244.82088067872212, 374.03304576261667, 219.0945407282455, 233.51408872959777, 158.04434344884487, 162.4384157677061, 300.1397975720857, 148.79740766384015, 129.72984162314077, 371.5805990426458, 113.07572570468754, 93.83008450111765, 245.9089796403533, 121.49521364756428, 190.7391859154516, 154.85086514457825, 100.98035503039699, 179.87705898007545, 141.057165060155, 145.640564528047, 345.91627570224335, 3.871553342647575, 202.6084383246322, 65.44546194813027, 3.2099818289515563, 119.55080475531095, 111.31726283140763, 75.22649341723627, 155.4347503937421, 163.92559203990348, 113.84330626669092, 179.72858001839128, 52.970007776744225, 112.16023694947158, 267.0929090864413, 1.9809458217793954, 81.95754604703106, 112.57631145626148, 184.9764098839407, 371.9780653760915, 79.55941244109165, 133.5097652818074, 7.7584018215214545, 276.0141817795542, 249.3012619942842, 55.51221281674862, 9.545414854744644, 14.246597255281484, 201.23851630587555, 10.919836862438583, 154.49153383842474, 118.6799293622871, 193.66061325861727, 230.52734076777682, 162.45222889276005, 139.4692746892334, 87.60399480110748, 137.6805773317793, 341.5234718804521, 106.33562074091093, 203.71568646343715, 115.39510308456695, 145.2662559013016, 31.39609985085658, 310.9697758635541, 132.64703982056722, 279.6568769521287, 83.39938710837576, 271.8296374608873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.005671361686998, "mean_inference_ms": 6.49425744981853, "mean_action_processing_ms": 4.397138619694381, "mean_env_wait_ms": 14.335056027533964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0140913724899292, "StateBufferConnector_ms": 0.006049036979675293, "ViewRequirementAgentConnector_ms": 0.3000352382659912}, "num_episodes": 21, "episode_return_max": 336.9034308318719, "episode_return_min": 7.236526204063881, "episode_return_mean": 116.39444019636547, "episodes_this_iter": 21}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1388480, "num_agent_steps_trained": 1388480, "num_env_steps_sampled": 347120, "num_env_steps_trained": 347120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.75331720196625, "num_env_steps_trained_throughput_per_sec": 72.75331720196625, "timesteps_total": 347120, "num_env_steps_sampled_lifetime": 347120, "num_agent_steps_sampled_lifetime": 1388480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1388480, "timers": {"training_iteration_time_ms": 56619.905, "restore_workers_time_ms": 0.015, "training_step_time_ms": 56619.836, "sample_time_ms": 3904.476, "learn_time_ms": 52688.557, "learn_throughput": 75.918, "synch_weights_time_ms": 20.389}, "counters": {"num_env_steps_sampled": 347120, "num_env_steps_trained": 347120, "num_agent_steps_sampled": 1388480, "num_agent_steps_trained": 1388480}, "done": false, "training_iteration": 86, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-41-46", "timestamp": 1724152306, "time_this_iter_s": 55.03506088256836, "time_total_s": 4867.03139257431, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120b35a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4867.03139257431, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 53.12820512820512, "ram_util_percent": 83.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.94713808039509, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.830076392743953, "policy_loss": -0.021267727037975515, "vf_loss": 6.84852475741553, "vf_explained_var": 0.39086610148192713, "kl": 0.014096803445782926, "entropy": 0.6905748101138564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 164955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.672709154578113, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.451310240780866, "policy_loss": -0.014945300020247935, "vf_loss": 5.463809734929806, "vf_explained_var": 0.10459469071140996, "kl": 0.0122290082523481, "entropy": 0.6849764834951472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 164955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 351120, "num_env_steps_trained": 351120, "num_agent_steps_sampled": 1404480, "num_agent_steps_trained": 1404480}, "env_runners": {"episode_reward_max": 336.9034308318719, "episode_reward_min": -46.51408771268966, "episode_reward_mean": 118.02314466795853, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -481.9272791752029, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 379.0383175026833}, "policy_reward_mean": {"prey_policy": -86.09866116897065, "predator_policy": 145.11023350294988}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.49038377253764, 139.42473395805058, 61.055633655178255, 49.60594136351772, 75.50827064320596, 147.41522105134516, 72.40967394936973, 170.23607580171213, 95.21294907411931, 302.7534932745563, 103.65585367707266, 179.0942102036132, 168.50669827437528, 98.08303587437307, 115.87042926022154, 74.06668982203962, 65.05444382548814, 118.89999999999989, 124.59019882049417, 74.8368928370254, 113.32704451995488, 157.09999999999957, 104.74068591990185, 38.40000000000031, 50.90375247101187, 169.92871625710185, 138.6221560619588, 96.2999999999999, 265.09999999999997, 107.08741608489066, 101.93221078991729, 78.08388347648315, 88.62694231711713, 63.793295267123305, 194.79236151851063, 29.80000000000011, 35.40000000000023, 17.443253389256434, 140.8131644196187, 52.392008443100494, 117.79999999999976, 31.898891838311734, 141.32472139728333, 49.81322911217373, 109.46518783077535, 7.236526204063881, 271.4888366617993, 157.91354197868992, 73.26870770897898, 27.65030856115913, 175.29105376486243, 248.63469784939542, 64.17006625163826, 36.44554638600377, 73.3637592452626, 81.29026948012907, 198.10998182895133, 100.72092059501853, 246.54770351308005, 57.41318031662554, 187.01064712538346, 92.18033258010989, 197.56266541756798, 336.9034308318719, 70.66527496976082, 40.39618276692364, 221.82123603192304, 105.43340059557161, 83.87320479302625, 56.40190565862685, 64.40668076153241, 246.38275138418436, 238.91610730274232, 60.24213067251277, 98.71721763975295, 147.02775134000498, 206.10608909154647, 127.25566511651837, 59.41907535078519, 173.435259802327, 85.58687004073366, 83.97746364858617, 139.9989748225933, 155.40089462901247, 48.79878881836937, 122.91187008298981, 86.30257309680442, 128.39999999999972, 175.70304393546968, 68.82204367895984, 196.2498344918119, 197.0655405153252, 262.0034807427985, 137.22770830129764, -46.51408771268966, 92.59923567841992, 159.13320069258984, 217.91692283072422, 40.37133658541716, 39.99691208552485], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-92.46963486165899, -234.65445677384187, -137.28315938001316, 110.22551730466483, 33.635281189096425, -100.9139418004455, -38.43387800992632, -299.4693666515393, 18.06034825010279, -125.74478567935466, -46.18825322188852, -163.9870708872307, -119.43090538411434, -82.50060517721508, 93.40333944639252, -157.61191042337546, -110.56014205791287, -32.42985344383044, -209.3468178123066, 188.8101510150033, -180.15162886930148, -58.67669640714091, -143.9615094121487, 148.0827998143253, -143.14241267649575, 112.99419674394821, -78.42619030480853, -126.73599089548354, 8.132355156423333, -60.17259972602754, -28.03936520212572, -294.9408619401728, -77.96841519237604, -4.2159741822705925, 22.419090381932904, -51.653092956342064, -77.29814842212033, 10.060569399306328, -84.35682245912183, -111.2345793958887, -155.6354999296923, -194.0544090942988, 102.58594749126382, 20.000000000000014, -144.35704620040818, -234.50674299676444, -83.43964101375134, -84.09915923382587, -376.7818325912032, -150.7828364335711, 109.08790389846848, -115.28184151631811, 89.73743784480112, -122.2162132832423, -37.185506256714696, -6.892047792234527, 70.18843254323903, 111.56992381243796, 55.26578420491746, -183.79559376028567, -217.24246144302992, 23.35734047396513, -67.27396847107596, -155.4027772727224, -250.39847189269537, 11.345531600038187, -226.8072842061546, 18.257663301515922, -133.54940859918582, 107.58833469840354, -84.18120006440407, -76.75681117001011, 7.351658560914972, -26.380829774295734, -322.64158246068473, -341.07223254990623, -94.49835572220528, -122.25301542611442, -198.7126000758993, -77.91754725786271, -17.78475653269666, 20.000000000000014, -50.05216423483838, -165.56651898314584, -250.13702728414802, 58.1566316417956, 1.4840075469879637, 15.9842555507687, -210.17825925344192, -112.61734584645363, -211.958014524182, -373.9330457626167, 189.00987023168997, -309.0794657483332, -231.19492073243183, -73.46975062866986, -234.80887144458228, 29.55032986658086, -198.14427148346937, -258.86174470270515, -44.31397883646258, -120.13403154014607, -186.21874306925926, 122.61904135563888, -162.64124687861863, -29.019907044718295, -184.25334573653973, -100.23533191768774, -31.266097267604508, -386.9269837174229, -80.29232714402217, -44.89739504312797, 80.32377990554022, 49.130758146329384, -130.2740131244521, 0.12686613275200254, -83.63578100153129, 99.52224070363306, -47.31982074422384, -173.0358972457453, -52.28788939991884, 6.599948730167004, -118.03142463245831, -169.04138882334493, 62.37982572419591, 51.24434782456251, -116.0475456154347, 155.3982551071045, -260.34235642045144, -120.52984642697042, -117.2097652818083, 16.33778094540184, 13.894369106735269, -317.3885768486507, -42.580232693266396, 82.95600561734496, 11.526607537744635, -143.13851630587595, -29.120833176638357, -79.88863186559897, -78.5404383020898, -169.39342355728348, 129.3828304049017, -275.97964868125405, 41.835051745023364, -29.992213932622022, -59.01377573296282, -359.9481428067559, -22.02097318405811, -189.3131163805364, -163.83391131846744, 50.200303672604036, -310.2172850718796, 173.95749844901542, 43.64944897451131, -328.69770063068864, -8.186735387455402, -287.62321383102267, 61.53265840374997, -184.00183566039868, -266.91129735211234, -187.96973402554818, -158.56913612301338, -85.6335967026982, 56.255959897750834, -83.42180454049756, -260.0590235514048, 50.85025922337046, -80.98870465441789, -130.60716127532925, -92.43177008463259, 42.45993138625277, -190.63569699180866, 40.00091649742323, -46.2644329004423, -43.21891269494262, -31.227214994170588, -134.65506722482516, -238.30366631231433, -22.142029649094514, -33.17188082995322, -80.58649133096017, 137.16470626500913, -26.47979646527559, 200.0, -481.9272791752029, 69.5095465863964, -193.13046298640046, -163.5479873131075, -189.884568441319, -64.05060920189133, -200.9492880403418, -103.3231931010531, -181.25598330679523, 184.62915565115256, -263.31045908492285, -137.9425337313547, -167.10309466878005, -196.5550844383228, -212.57060302828762], "policy_predator_policy_reward": [125.72888029331817, 246.88559511471988, 154.9994847740234, 11.4828912593757, 19.010228623105075, 109.32406564342129, 128.6957860313943, 258.81339999359005, 152.87906256121883, 30.31364551123907, 142.92039440814028, 214.67015075232413, 132.79811255026243, 141.5430719604365, 195.6029061688916, 38.84174060980357, 149.7194771870371, 88.48346738882519, 124.07275076732182, 199.21740930453845, 95.6474998986606, 246.83667905485376, 71.28314485395468, 103.68977494748184, 194.07350092787902, 4.581413279043809, 199.7434195297709, 103.50179754489426, 81.9100036362967, 86.0006701935293, 134.95401012134175, 262.0929068429981, 107.86519563103121, 39.373637569102776, 123.40963542944002, 24.72436714496942, 136.8153182816083, 55.01245956170071, 106.75333862164213, 163.67495607039268, 253.27670909209732, 209.74024445184835, 34.514052508736235, 0.0, 226.83840252918978, 256.7660725878845, 64.58389446991279, 141.3549057776632, 351.5594341541361, 226.90898734164966, 6.1772975095062215, 169.94535636544506, 17.21243744830692, 153.88849405209325, 57.28702995033798, 83.09052409861141, 57.01156745676101, 26.330076187562113, 112.94126863512018, 122.67595700513861, 59.686810224552076, 236.1305215344305, 132.55785194755893, 168.2027772727221, 179.333742750743, 148.34613985903187, 128.35235452886678, 143.99056164289476, 197.2494085991857, 23.504026820107153, 126.54826574872621, 64.1897454856869, 11.348341439084995, 43.08082977429597, 302.1187508971644, 379.0383175026833, 145.744731034701, 211.81980453323737, 158.63325704964302, 170.38889872721856, 115.5847565326964, 0.0, 183.73531513779508, 63.78225991850045, 144.2118404035075, 189.09327663612822, 26.111180455478276, 6.233785558938265, 187.43991225194867, 244.82088067872212, 374.03304576261667, 219.0945407282455, 233.51408872959777, 158.04434344884487, 162.4384157677061, 300.1397975720857, 148.79740766384015, 129.72984162314077, 371.5805990426458, 113.07572570468754, 93.83008450111765, 245.9089796403533, 121.49521364756428, 190.7391859154516, 154.85086514457825, 100.98035503039699, 179.87705898007545, 141.057165060155, 145.640564528047, 345.91627570224335, 3.871553342647575, 202.6084383246322, 65.44546194813027, 3.2099818289515563, 119.55080475531095, 111.31726283140763, 75.22649341723627, 155.4347503937421, 163.92559203990348, 113.84330626669092, 179.72858001839128, 52.970007776744225, 112.16023694947158, 267.0929090864413, 1.9809458217793954, 81.95754604703106, 112.57631145626148, 184.9764098839407, 371.9780653760915, 79.55941244109165, 133.5097652818074, 7.7584018215214545, 276.0141817795542, 249.3012619942842, 55.51221281674862, 9.545414854744644, 14.246597255281484, 201.23851630587555, 10.919836862438583, 154.49153383842474, 118.6799293622871, 193.66061325861727, 230.52734076777682, 162.45222889276005, 139.4692746892334, 87.60399480110748, 137.6805773317793, 341.5234718804521, 106.33562074091093, 203.71568646343715, 115.39510308456695, 145.2662559013016, 31.39609985085658, 310.9697758635541, 132.64703982056722, 279.6568769521287, 83.39938710837576, 271.8296374608873, 177.5865736403456, 118.31786341863044, 230.1755665785312, 310.29233483986314, 135.88098398192363, 192.29921249237356, 64.64311010861637, 102.5217093567234, 159.05090551563686, 205.5587534414097, 152.7604766728451, 107.63417807527004, 69.61050141109605, 103.27320737027415, 128.17820727632926, 108.75914631486077, 155.06443290044228, 62.818912694942824, 118.53793533380133, 223.04739082066416, 246.8036663123142, 82.4640733280547, 204.85591582667516, 105.15229082605022, 11.8349138502565, 74.54571686533566, 305.3745886556825, 238.55617126231868, 210.56490334556327, 50.28372135573832, 207.65859763629507, 99.25987040544125, 161.79664486975588, 195.80248805089687, 294.60552483581927, 149.1068522646189, 134.7914455871717, 161.80678067732273, 175.72867225634516, 169.68829272920567, 280.7376924702353, 168.3849070818996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.04230498657849, "mean_inference_ms": 6.506873609916327, "mean_action_processing_ms": 3.952124702373384, "mean_env_wait_ms": 14.36344488590138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014160752296447754, "StateBufferConnector_ms": 0.013518095016479492, "ViewRequirementAgentConnector_ms": 0.28642141819000244}, "num_episodes": 21, "episode_return_max": 336.9034308318719, "episode_return_min": -46.51408771268966, "episode_return_mean": 118.02314466795853, "episodes_this_iter": 21}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404480, "num_agent_steps_trained": 1404480, "num_env_steps_sampled": 351120, "num_env_steps_trained": 351120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.41305105236083, "num_env_steps_trained_throughput_per_sec": 72.41305105236083, "timesteps_total": 351120, "num_env_steps_sampled_lifetime": 351120, "num_agent_steps_sampled_lifetime": 1404480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1404480, "timers": {"training_iteration_time_ms": 56365.213, "restore_workers_time_ms": 0.015, "training_step_time_ms": 56365.145, "sample_time_ms": 3898.877, "learn_time_ms": 52440.376, "learn_throughput": 76.277, "synch_weights_time_ms": 19.741}, "counters": {"num_env_steps_sampled": 351120, "num_env_steps_trained": 351120, "num_agent_steps_sampled": 1404480, "num_agent_steps_trained": 1404480}, "done": false, "training_iteration": 87, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-42-42", "timestamp": 1724152362, "time_this_iter_s": 55.26039791107178, "time_total_s": 4922.291790485382, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120b28af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4922.291790485382, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 52.352564102564116, "ram_util_percent": 83.31153846153849}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.122391568794452, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.771779443347265, "policy_loss": -0.01734061788462063, "vf_loss": 6.786727145613817, "vf_explained_var": 0.38995599320956637, "kl": 0.01196459120967322, "entropy": 0.6457230789320809, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 166845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.63348880804405, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.932526832409006, "policy_loss": -0.012864481033658776, "vf_loss": 5.943434709972806, "vf_explained_var": 0.11158367688693697, "kl": 0.009783010204598583, "entropy": 0.6769870993006166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 166845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 355120, "num_env_steps_trained": 355120, "num_agent_steps_sampled": 1420480, "num_agent_steps_trained": 1420480}, "env_runners": {"episode_reward_max": 337.3639911489211, "episode_reward_min": -46.51408771268966, "episode_reward_mean": 123.35192285317784, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -481.9272791752029, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 379.0383175026833}, "policy_reward_mean": {"prey_policy": -85.82735722384565, "predator_policy": 147.50331865043452}, "custom_metrics": {}, "hist_stats": {"episode_reward": [113.32704451995488, 157.09999999999957, 104.74068591990185, 38.40000000000031, 50.90375247101187, 169.92871625710185, 138.6221560619588, 96.2999999999999, 265.09999999999997, 107.08741608489066, 101.93221078991729, 78.08388347648315, 88.62694231711713, 63.793295267123305, 194.79236151851063, 29.80000000000011, 35.40000000000023, 17.443253389256434, 140.8131644196187, 52.392008443100494, 117.79999999999976, 31.898891838311734, 141.32472139728333, 49.81322911217373, 109.46518783077535, 7.236526204063881, 271.4888366617993, 157.91354197868992, 73.26870770897898, 27.65030856115913, 175.29105376486243, 248.63469784939542, 64.17006625163826, 36.44554638600377, 73.3637592452626, 81.29026948012907, 198.10998182895133, 100.72092059501853, 246.54770351308005, 57.41318031662554, 187.01064712538346, 92.18033258010989, 197.56266541756798, 336.9034308318719, 70.66527496976082, 40.39618276692364, 221.82123603192304, 105.43340059557161, 83.87320479302625, 56.40190565862685, 64.40668076153241, 246.38275138418436, 238.91610730274232, 60.24213067251277, 98.71721763975295, 147.02775134000498, 206.10608909154647, 127.25566511651837, 59.41907535078519, 173.435259802327, 85.58687004073366, 83.97746364858617, 139.9989748225933, 155.40089462901247, 48.79878881836937, 122.91187008298981, 86.30257309680442, 128.39999999999972, 175.70304393546968, 68.82204367895984, 196.2498344918119, 197.0655405153252, 262.0034807427985, 137.22770830129764, -46.51408771268966, 92.59923567841992, 159.13320069258984, 217.91692283072422, 40.37133658541716, 39.99691208552485, 165.2726724090758, 62.697364466590216, 51.2870558546281, 337.3639911489211, 161.74469891463679, 122.60203269570982, 44.600000000000385, 214.3151147725424, 188.9522742726581, 28.80000000000014, 202.9938913656118, 81.46926132270166, 182.2129968307449, 251.83024820456393, 66.15598809817358, 145.39722632103405, 32.6169451575549, 214.21456056612024, 70.54522579581891, 189.5770994631376], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-155.6354999296923, -194.0544090942988, 102.58594749126382, 20.000000000000014, -144.35704620040818, -234.50674299676444, -83.43964101375134, -84.09915923382587, -376.7818325912032, -150.7828364335711, 109.08790389846848, -115.28184151631811, 89.73743784480112, -122.2162132832423, -37.185506256714696, -6.892047792234527, 70.18843254323903, 111.56992381243796, 55.26578420491746, -183.79559376028567, -217.24246144302992, 23.35734047396513, -67.27396847107596, -155.4027772727224, -250.39847189269537, 11.345531600038187, -226.8072842061546, 18.257663301515922, -133.54940859918582, 107.58833469840354, -84.18120006440407, -76.75681117001011, 7.351658560914972, -26.380829774295734, -322.64158246068473, -341.07223254990623, -94.49835572220528, -122.25301542611442, -198.7126000758993, -77.91754725786271, -17.78475653269666, 20.000000000000014, -50.05216423483838, -165.56651898314584, -250.13702728414802, 58.1566316417956, 1.4840075469879637, 15.9842555507687, -210.17825925344192, -112.61734584645363, -211.958014524182, -373.9330457626167, 189.00987023168997, -309.0794657483332, -231.19492073243183, -73.46975062866986, -234.80887144458228, 29.55032986658086, -198.14427148346937, -258.86174470270515, -44.31397883646258, -120.13403154014607, -186.21874306925926, 122.61904135563888, -162.64124687861863, -29.019907044718295, -184.25334573653973, -100.23533191768774, -31.266097267604508, -386.9269837174229, -80.29232714402217, -44.89739504312797, 80.32377990554022, 49.130758146329384, -130.2740131244521, 0.12686613275200254, -83.63578100153129, 99.52224070363306, -47.31982074422384, -173.0358972457453, -52.28788939991884, 6.599948730167004, -118.03142463245831, -169.04138882334493, 62.37982572419591, 51.24434782456251, -116.0475456154347, 155.3982551071045, -260.34235642045144, -120.52984642697042, -117.2097652818083, 16.33778094540184, 13.894369106735269, -317.3885768486507, -42.580232693266396, 82.95600561734496, 11.526607537744635, -143.13851630587595, -29.120833176638357, -79.88863186559897, -78.5404383020898, -169.39342355728348, 129.3828304049017, -275.97964868125405, 41.835051745023364, -29.992213932622022, -59.01377573296282, -359.9481428067559, -22.02097318405811, -189.3131163805364, -163.83391131846744, 50.200303672604036, -310.2172850718796, 173.95749844901542, 43.64944897451131, -328.69770063068864, -8.186735387455402, -287.62321383102267, 61.53265840374997, -184.00183566039868, -266.91129735211234, -187.96973402554818, -158.56913612301338, -85.6335967026982, 56.255959897750834, -83.42180454049756, -260.0590235514048, 50.85025922337046, -80.98870465441789, -130.60716127532925, -92.43177008463259, 42.45993138625277, -190.63569699180866, 40.00091649742323, -46.2644329004423, -43.21891269494262, -31.227214994170588, -134.65506722482516, -238.30366631231433, -22.142029649094514, -33.17188082995322, -80.58649133096017, 137.16470626500913, -26.47979646527559, 200.0, -481.9272791752029, 69.5095465863964, -193.13046298640046, -163.5479873131075, -189.884568441319, -64.05060920189133, -200.9492880403418, -103.3231931010531, -181.25598330679523, 184.62915565115256, -263.31045908492285, -137.9425337313547, -167.10309466878005, -196.5550844383228, -212.57060302828762, -217.3905829211871, 111.61765057958901, -162.0270440191072, -4.197361744606747, -118.3010178957555, -246.97738460454647, 41.30747380194557, 199.1, -131.47034173189587, -7.828764382712594, -85.63335947103378, -81.808932929195, 18.649007899875148, -23.333815151597474, -5.727379438195101, -130.89850873941361, -84.9914729058327, 149.0065944990751, -58.44128788884161, -117.98959298181109, -190.35271011150616, 135.726174210751, -192.09512637960108, -96.4874379824391, -4.9796670570066075, -116.35737209279617, -22.37064382317333, 160.2120803299997, -189.74616853089026, -114.80923494290721, -194.43180348783469, -50.92430953321701, -250.58676130947677, -211.46207081777382, 69.13134159649127, 45.685781136448966, -186.20042183290133, -189.44424022294845, -214.6317183550224, 99.5457973507694], "policy_predator_policy_reward": [253.27670909209732, 209.74024445184835, 34.514052508736235, 0.0, 226.83840252918978, 256.7660725878845, 64.58389446991279, 141.3549057776632, 351.5594341541361, 226.90898734164966, 6.1772975095062215, 169.94535636544506, 17.21243744830692, 153.88849405209325, 57.28702995033798, 83.09052409861141, 57.01156745676101, 26.330076187562113, 112.94126863512018, 122.67595700513861, 59.686810224552076, 236.1305215344305, 132.55785194755893, 168.2027772727221, 179.333742750743, 148.34613985903187, 128.35235452886678, 143.99056164289476, 197.2494085991857, 23.504026820107153, 126.54826574872621, 64.1897454856869, 11.348341439084995, 43.08082977429597, 302.1187508971644, 379.0383175026833, 145.744731034701, 211.81980453323737, 158.63325704964302, 170.38889872721856, 115.5847565326964, 0.0, 183.73531513779508, 63.78225991850045, 144.2118404035075, 189.09327663612822, 26.111180455478276, 6.233785558938265, 187.43991225194867, 244.82088067872212, 374.03304576261667, 219.0945407282455, 233.51408872959777, 158.04434344884487, 162.4384157677061, 300.1397975720857, 148.79740766384015, 129.72984162314077, 371.5805990426458, 113.07572570468754, 93.83008450111765, 245.9089796403533, 121.49521364756428, 190.7391859154516, 154.85086514457825, 100.98035503039699, 179.87705898007545, 141.057165060155, 145.640564528047, 345.91627570224335, 3.871553342647575, 202.6084383246322, 65.44546194813027, 3.2099818289515563, 119.55080475531095, 111.31726283140763, 75.22649341723627, 155.4347503937421, 163.92559203990348, 113.84330626669092, 179.72858001839128, 52.970007776744225, 112.16023694947158, 267.0929090864413, 1.9809458217793954, 81.95754604703106, 112.57631145626148, 184.9764098839407, 371.9780653760915, 79.55941244109165, 133.5097652818074, 7.7584018215214545, 276.0141817795542, 249.3012619942842, 55.51221281674862, 9.545414854744644, 14.246597255281484, 201.23851630587555, 10.919836862438583, 154.49153383842474, 118.6799293622871, 193.66061325861727, 230.52734076777682, 162.45222889276005, 139.4692746892334, 87.60399480110748, 137.6805773317793, 341.5234718804521, 106.33562074091093, 203.71568646343715, 115.39510308456695, 145.2662559013016, 31.39609985085658, 310.9697758635541, 132.64703982056722, 279.6568769521287, 83.39938710837576, 271.8296374608873, 177.5865736403456, 118.31786341863044, 230.1755665785312, 310.29233483986314, 135.88098398192363, 192.29921249237356, 64.64311010861637, 102.5217093567234, 159.05090551563686, 205.5587534414097, 152.7604766728451, 107.63417807527004, 69.61050141109605, 103.27320737027415, 128.17820727632926, 108.75914631486077, 155.06443290044228, 62.818912694942824, 118.53793533380133, 223.04739082066416, 246.8036663123142, 82.4640733280547, 204.85591582667516, 105.15229082605022, 11.8349138502565, 74.54571686533566, 305.3745886556825, 238.55617126231868, 210.56490334556327, 50.28372135573832, 207.65859763629507, 99.25987040544125, 161.79664486975588, 195.80248805089687, 294.60552483581927, 149.1068522646189, 134.7914455871717, 161.80678067732273, 175.72867225634516, 169.68829272920567, 280.7376924702353, 168.3849070818996, 263.58564620847136, 7.459958542202577, 114.25157888624506, 114.67019134405908, 240.955837461089, 175.60962089384026, 43.9191272206862, 53.03739012628934, 128.71465700598813, 172.32914802325712, 149.20180497313692, 140.8425201228014, 41.37407316192066, 7.910734089801858, 166.2404989103933, 184.7005040397581, 94.56291068237417, 30.374241997041914, 51.46456396384583, 153.76631690680648, 91.1614148471971, 166.45901241916982, 146.83269079290332, 223.21913489183837, 105.05052310084751, 198.49951287970083, 9.40086466791897, 104.58794702981866, 79.85655739316579, 290.8548341788043, 106.3562420929675, 284.39709724911796, 242.069383238372, 252.59639404643391, 9.235729062364241, 90.16170877081592, 218.9974360449172, 227.19245180675108, 125.65478445781848, 179.0082360095722]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.985396110634008, "mean_inference_ms": 6.477935257666145, "mean_action_processing_ms": 4.301285792135352, "mean_env_wait_ms": 14.378044527185407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03364133834838867, "StateBufferConnector_ms": 0.014178991317749023, "ViewRequirementAgentConnector_ms": 0.22271811962127686}, "num_episodes": 20, "episode_return_max": 337.3639911489211, "episode_return_min": -46.51408771268966, "episode_return_mean": 123.35192285317784, "episodes_this_iter": 20}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1420480, "num_agent_steps_trained": 1420480, "num_env_steps_sampled": 355120, "num_env_steps_trained": 355120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.77795546346108, "num_env_steps_trained_throughput_per_sec": 75.77795546346108, "timesteps_total": 355120, "num_env_steps_sampled_lifetime": 355120, "num_agent_steps_sampled_lifetime": 1420480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1420480, "timers": {"training_iteration_time_ms": 56210.969, "restore_workers_time_ms": 0.016, "training_step_time_ms": 56210.903, "sample_time_ms": 3825.308, "learn_time_ms": 52361.199, "learn_throughput": 76.392, "synch_weights_time_ms": 18.299}, "counters": {"num_env_steps_sampled": 355120, "num_env_steps_trained": 355120, "num_agent_steps_sampled": 1420480, "num_agent_steps_trained": 1420480}, "done": false, "training_iteration": 88, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-43-35", "timestamp": 1724152415, "time_this_iter_s": 52.82387185096741, "time_total_s": 4975.1156623363495, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120b35dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4975.1156623363495, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 48.230666666666664, "ram_util_percent": 83.34533333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.50783999344659, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.659753347578503, "policy_loss": -0.015565987030369422, "vf_loss": 6.673340197719594, "vf_explained_var": 0.4045639794654947, "kl": 0.009895636583062471, "entropy": 0.6529447033291771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 168735.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999885}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.4143507427008695, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.574829613973224, "policy_loss": -0.013629852166946326, "vf_loss": 5.586642140686196, "vf_explained_var": 0.21410966058256764, "kl": 0.009086566736118464, "entropy": 0.6965628627746824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 168735.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999885}}, "num_env_steps_sampled": 359120, "num_env_steps_trained": 359120, "num_agent_steps_sampled": 1436480, "num_agent_steps_trained": 1436480}, "env_runners": {"episode_reward_max": 337.3639911489211, "episode_reward_min": -46.51408771268966, "episode_reward_mean": 128.9855487860504, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -481.9272791752029, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 374.03304576261667}, "policy_reward_mean": {"prey_policy": -82.71673304740035, "predator_policy": 147.20950744042554}, "custom_metrics": {}, "hist_stats": {"episode_reward": [140.8131644196187, 52.392008443100494, 117.79999999999976, 31.898891838311734, 141.32472139728333, 49.81322911217373, 109.46518783077535, 7.236526204063881, 271.4888366617993, 157.91354197868992, 73.26870770897898, 27.65030856115913, 175.29105376486243, 248.63469784939542, 64.17006625163826, 36.44554638600377, 73.3637592452626, 81.29026948012907, 198.10998182895133, 100.72092059501853, 246.54770351308005, 57.41318031662554, 187.01064712538346, 92.18033258010989, 197.56266541756798, 336.9034308318719, 70.66527496976082, 40.39618276692364, 221.82123603192304, 105.43340059557161, 83.87320479302625, 56.40190565862685, 64.40668076153241, 246.38275138418436, 238.91610730274232, 60.24213067251277, 98.71721763975295, 147.02775134000498, 206.10608909154647, 127.25566511651837, 59.41907535078519, 173.435259802327, 85.58687004073366, 83.97746364858617, 139.9989748225933, 155.40089462901247, 48.79878881836937, 122.91187008298981, 86.30257309680442, 128.39999999999972, 175.70304393546968, 68.82204367895984, 196.2498344918119, 197.0655405153252, 262.0034807427985, 137.22770830129764, -46.51408771268966, 92.59923567841992, 159.13320069258984, 217.91692283072422, 40.37133658541716, 39.99691208552485, 165.2726724090758, 62.697364466590216, 51.2870558546281, 337.3639911489211, 161.74469891463679, 122.60203269570982, 44.600000000000385, 214.3151147725424, 188.9522742726581, 28.80000000000014, 202.9938913656118, 81.46926132270166, 182.2129968307449, 251.83024820456393, 66.15598809817358, 145.39722632103405, 32.6169451575549, 214.21456056612024, 70.54522579581891, 189.5770994631376, 204.56760174885542, 186.46775952232608, 23.60166109920547, 150.32788438757655, 60.168507902926955, 155.7102054850359, 61.77296752223821, 70.64283884722708, 199.75692572862312, 186.98697186661843, 172.02360132976298, 81.39037049220079, 109.83512382682568, 72.8000000000003, 220.425416652123, 138.1404424094987, 165.69591607299023, 154.43011646645462], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-94.49835572220528, -122.25301542611442, -198.7126000758993, -77.91754725786271, -17.78475653269666, 20.000000000000014, -50.05216423483838, -165.56651898314584, -250.13702728414802, 58.1566316417956, 1.4840075469879637, 15.9842555507687, -210.17825925344192, -112.61734584645363, -211.958014524182, -373.9330457626167, 189.00987023168997, -309.0794657483332, -231.19492073243183, -73.46975062866986, -234.80887144458228, 29.55032986658086, -198.14427148346937, -258.86174470270515, -44.31397883646258, -120.13403154014607, -186.21874306925926, 122.61904135563888, -162.64124687861863, -29.019907044718295, -184.25334573653973, -100.23533191768774, -31.266097267604508, -386.9269837174229, -80.29232714402217, -44.89739504312797, 80.32377990554022, 49.130758146329384, -130.2740131244521, 0.12686613275200254, -83.63578100153129, 99.52224070363306, -47.31982074422384, -173.0358972457453, -52.28788939991884, 6.599948730167004, -118.03142463245831, -169.04138882334493, 62.37982572419591, 51.24434782456251, -116.0475456154347, 155.3982551071045, -260.34235642045144, -120.52984642697042, -117.2097652818083, 16.33778094540184, 13.894369106735269, -317.3885768486507, -42.580232693266396, 82.95600561734496, 11.526607537744635, -143.13851630587595, -29.120833176638357, -79.88863186559897, -78.5404383020898, -169.39342355728348, 129.3828304049017, -275.97964868125405, 41.835051745023364, -29.992213932622022, -59.01377573296282, -359.9481428067559, -22.02097318405811, -189.3131163805364, -163.83391131846744, 50.200303672604036, -310.2172850718796, 173.95749844901542, 43.64944897451131, -328.69770063068864, -8.186735387455402, -287.62321383102267, 61.53265840374997, -184.00183566039868, -266.91129735211234, -187.96973402554818, -158.56913612301338, -85.6335967026982, 56.255959897750834, -83.42180454049756, -260.0590235514048, 50.85025922337046, -80.98870465441789, -130.60716127532925, -92.43177008463259, 42.45993138625277, -190.63569699180866, 40.00091649742323, -46.2644329004423, -43.21891269494262, -31.227214994170588, -134.65506722482516, -238.30366631231433, -22.142029649094514, -33.17188082995322, -80.58649133096017, 137.16470626500913, -26.47979646527559, 200.0, -481.9272791752029, 69.5095465863964, -193.13046298640046, -163.5479873131075, -189.884568441319, -64.05060920189133, -200.9492880403418, -103.3231931010531, -181.25598330679523, 184.62915565115256, -263.31045908492285, -137.9425337313547, -167.10309466878005, -196.5550844383228, -212.57060302828762, -217.3905829211871, 111.61765057958901, -162.0270440191072, -4.197361744606747, -118.3010178957555, -246.97738460454647, 41.30747380194557, 199.1, -131.47034173189587, -7.828764382712594, -85.63335947103378, -81.808932929195, 18.649007899875148, -23.333815151597474, -5.727379438195101, -130.89850873941361, -84.9914729058327, 149.0065944990751, -58.44128788884161, -117.98959298181109, -190.35271011150616, 135.726174210751, -192.09512637960108, -96.4874379824391, -4.9796670570066075, -116.35737209279617, -22.37064382317333, 160.2120803299997, -189.74616853089026, -114.80923494290721, -194.43180348783469, -50.92430953321701, -250.58676130947677, -211.46207081777382, 69.13134159649127, 45.685781136448966, -186.20042183290133, -189.44424022294845, -214.6317183550224, 99.5457973507694, 73.60337988622769, -221.34044565129767, -2.0279280176770538, -28.20376224245888, -176.26285996776366, -58.90591231316089, -252.50327143412414, 101.97951717095317, -3.6525653400381772, -282.49377039454345, 18.30939348306546, -133.80298986854126, -238.25413510939043, -34.59494606942796, -46.009259428436266, -6.806730212048745, 118.90199252772352, -222.15141243748025, 125.7654905928298, -195.4290355340844, 90.93942236806623, -161.60368083482317, -167.93962405934835, 10.608056626818223, -143.5553177074208, -110.87214629008989, -1.8213105017037599, -33.9809592875074, -208.1869676958417, 134.6742319839413, -221.02613330269338, -42.10321157965783, 124.74709338084698, -99.02622816589725, -244.2451810979079, 94.99660223543964], "policy_predator_policy_reward": [145.744731034701, 211.81980453323737, 158.63325704964302, 170.38889872721856, 115.5847565326964, 0.0, 183.73531513779508, 63.78225991850045, 144.2118404035075, 189.09327663612822, 26.111180455478276, 6.233785558938265, 187.43991225194867, 244.82088067872212, 374.03304576261667, 219.0945407282455, 233.51408872959777, 158.04434344884487, 162.4384157677061, 300.1397975720857, 148.79740766384015, 129.72984162314077, 371.5805990426458, 113.07572570468754, 93.83008450111765, 245.9089796403533, 121.49521364756428, 190.7391859154516, 154.85086514457825, 100.98035503039699, 179.87705898007545, 141.057165060155, 145.640564528047, 345.91627570224335, 3.871553342647575, 202.6084383246322, 65.44546194813027, 3.2099818289515563, 119.55080475531095, 111.31726283140763, 75.22649341723627, 155.4347503937421, 163.92559203990348, 113.84330626669092, 179.72858001839128, 52.970007776744225, 112.16023694947158, 267.0929090864413, 1.9809458217793954, 81.95754604703106, 112.57631145626148, 184.9764098839407, 371.9780653760915, 79.55941244109165, 133.5097652818074, 7.7584018215214545, 276.0141817795542, 249.3012619942842, 55.51221281674862, 9.545414854744644, 14.246597255281484, 201.23851630587555, 10.919836862438583, 154.49153383842474, 118.6799293622871, 193.66061325861727, 230.52734076777682, 162.45222889276005, 139.4692746892334, 87.60399480110748, 137.6805773317793, 341.5234718804521, 106.33562074091093, 203.71568646343715, 115.39510308456695, 145.2662559013016, 31.39609985085658, 310.9697758635541, 132.64703982056722, 279.6568769521287, 83.39938710837576, 271.8296374608873, 177.5865736403456, 118.31786341863044, 230.1755665785312, 310.29233483986314, 135.88098398192363, 192.29921249237356, 64.64311010861637, 102.5217093567234, 159.05090551563686, 205.5587534414097, 152.7604766728451, 107.63417807527004, 69.61050141109605, 103.27320737027415, 128.17820727632926, 108.75914631486077, 155.06443290044228, 62.818912694942824, 118.53793533380133, 223.04739082066416, 246.8036663123142, 82.4640733280547, 204.85591582667516, 105.15229082605022, 11.8349138502565, 74.54571686533566, 305.3745886556825, 238.55617126231868, 210.56490334556327, 50.28372135573832, 207.65859763629507, 99.25987040544125, 161.79664486975588, 195.80248805089687, 294.60552483581927, 149.1068522646189, 134.7914455871717, 161.80678067732273, 175.72867225634516, 169.68829272920567, 280.7376924702353, 168.3849070818996, 263.58564620847136, 7.459958542202577, 114.25157888624506, 114.67019134405908, 240.955837461089, 175.60962089384026, 43.9191272206862, 53.03739012628934, 128.71465700598813, 172.32914802325712, 149.20180497313692, 140.8425201228014, 41.37407316192066, 7.910734089801858, 166.2404989103933, 184.7005040397581, 94.56291068237417, 30.374241997041914, 51.46456396384583, 153.76631690680648, 91.1614148471971, 166.45901241916982, 146.83269079290332, 223.21913489183837, 105.05052310084751, 198.49951287970083, 9.40086466791897, 104.58794702981866, 79.85655739316579, 290.8548341788043, 106.3562420929675, 284.39709724911796, 242.069383238372, 252.59639404643391, 9.235729062364241, 90.16170877081592, 218.9974360449172, 227.19245180675108, 125.65478445781848, 179.0082360095722, 180.98285475857793, 171.32181275534734, 66.97035308713915, 149.72909669532342, 102.77499452004062, 155.99543886008922, 257.403271434124, 43.448367216623474, 167.78319068895178, 178.5316529485568, 217.07685602495653, 54.12694584555521, 146.44237721181227, 188.17967148924456, 51.26012850810498, 72.19869997960717, 169.18819855673974, 133.8181470816402, 160.2357207924895, 96.41479601538342, 51.76253705785696, 190.92532273866306, 154.28437513894897, 84.43756278578184, 161.41233343838076, 202.85025438595488, 41.096432931583834, 67.50583685762763, 112.05518072051615, 181.88297164350703, 199.76698808300816, 201.50279920884168, 18.130068984699093, 121.84498187334137, 57.58712545419114, 246.0915698747318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.987490460738968, "mean_inference_ms": 6.468088506442445, "mean_action_processing_ms": 4.080027051161057, "mean_env_wait_ms": 14.392401684708231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03376269340515137, "StateBufferConnector_ms": 0.013589262962341309, "ViewRequirementAgentConnector_ms": 0.20568084716796875}, "num_episodes": 18, "episode_return_max": 337.3639911489211, "episode_return_min": -46.51408771268966, "episode_return_mean": 128.9855487860504, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1436480, "num_agent_steps_trained": 1436480, "num_env_steps_sampled": 359120, "num_env_steps_trained": 359120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.33005599616811, "num_env_steps_trained_throughput_per_sec": 74.33005599616811, "timesteps_total": 359120, "num_env_steps_sampled_lifetime": 359120, "num_agent_steps_sampled_lifetime": 1436480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1436480, "timers": {"training_iteration_time_ms": 55968.696, "restore_workers_time_ms": 0.016, "training_step_time_ms": 55968.627, "sample_time_ms": 3715.01, "learn_time_ms": 52229.704, "learn_throughput": 76.585, "synch_weights_time_ms": 17.947}, "counters": {"num_env_steps_sampled": 359120, "num_env_steps_trained": 359120, "num_agent_steps_sampled": 1436480, "num_agent_steps_trained": 1436480}, "done": false, "training_iteration": 89, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-44-29", "timestamp": 1724152469, "time_this_iter_s": 53.870384216308594, "time_total_s": 5028.986046552658, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120b1eee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5028.986046552658, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 52.161842105263155, "ram_util_percent": 83.24078947368422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.54636447890095, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.853400164306479, "policy_loss": -0.019175396918900627, "vf_loss": 6.870142174776269, "vf_explained_var": 0.47874951845123653, "kl": 0.012166959853601401, "entropy": 0.6356942885294162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 170625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.199523477327256, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.6980821617065915, "policy_loss": -0.013385983980285428, "vf_loss": 5.7095828649228215, "vf_explained_var": 0.1595246923032892, "kl": 0.009426423258310746, "entropy": 0.630247966338087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 170625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 363120, "num_env_steps_trained": 363120, "num_agent_steps_sampled": 1452480, "num_agent_steps_trained": 1452480}, "env_runners": {"episode_reward_max": 337.3639911489211, "episode_reward_min": -46.51408771268966, "episode_reward_mean": 133.16609001458352, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -481.9272791752029, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 371.9780653760915}, "policy_reward_mean": {"prey_policy": -77.92653954660523, "predator_policy": 144.50958455389696}, "custom_metrics": {}, "hist_stats": {"episode_reward": [246.54770351308005, 57.41318031662554, 187.01064712538346, 92.18033258010989, 197.56266541756798, 336.9034308318719, 70.66527496976082, 40.39618276692364, 221.82123603192304, 105.43340059557161, 83.87320479302625, 56.40190565862685, 64.40668076153241, 246.38275138418436, 238.91610730274232, 60.24213067251277, 98.71721763975295, 147.02775134000498, 206.10608909154647, 127.25566511651837, 59.41907535078519, 173.435259802327, 85.58687004073366, 83.97746364858617, 139.9989748225933, 155.40089462901247, 48.79878881836937, 122.91187008298981, 86.30257309680442, 128.39999999999972, 175.70304393546968, 68.82204367895984, 196.2498344918119, 197.0655405153252, 262.0034807427985, 137.22770830129764, -46.51408771268966, 92.59923567841992, 159.13320069258984, 217.91692283072422, 40.37133658541716, 39.99691208552485, 165.2726724090758, 62.697364466590216, 51.2870558546281, 337.3639911489211, 161.74469891463679, 122.60203269570982, 44.600000000000385, 214.3151147725424, 188.9522742726581, 28.80000000000014, 202.9938913656118, 81.46926132270166, 182.2129968307449, 251.83024820456393, 66.15598809817358, 145.39722632103405, 32.6169451575549, 214.21456056612024, 70.54522579581891, 189.5770994631376, 204.56760174885542, 186.46775952232608, 23.60166109920547, 150.32788438757655, 60.168507902926955, 155.7102054850359, 61.77296752223821, 70.64283884722708, 199.75692572862312, 186.98697186661843, 172.02360132976298, 81.39037049220079, 109.83512382682568, 72.8000000000003, 220.425416652123, 138.1404424094987, 165.69591607299023, 154.43011646645462, 19.41993357517375, 153.09597181420972, 139.5, 27.23368228363746, 172.4999999999995, 54.859931681382854, 116.18456932483886, 122.64111190314364, 145.6055229809055, 86.23181361660009, 123.49999999999972, 90.87570908305584, 104.16371515384536, 123.30120634254223, 135.08305262735036, 209.47969595850776, 194.87455159064837, 218.5, 224.6939433416879, 115.40113113299387], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-83.63578100153129, 99.52224070363306, -47.31982074422384, -173.0358972457453, -52.28788939991884, 6.599948730167004, -118.03142463245831, -169.04138882334493, 62.37982572419591, 51.24434782456251, -116.0475456154347, 155.3982551071045, -260.34235642045144, -120.52984642697042, -117.2097652818083, 16.33778094540184, 13.894369106735269, -317.3885768486507, -42.580232693266396, 82.95600561734496, 11.526607537744635, -143.13851630587595, -29.120833176638357, -79.88863186559897, -78.5404383020898, -169.39342355728348, 129.3828304049017, -275.97964868125405, 41.835051745023364, -29.992213932622022, -59.01377573296282, -359.9481428067559, -22.02097318405811, -189.3131163805364, -163.83391131846744, 50.200303672604036, -310.2172850718796, 173.95749844901542, 43.64944897451131, -328.69770063068864, -8.186735387455402, -287.62321383102267, 61.53265840374997, -184.00183566039868, -266.91129735211234, -187.96973402554818, -158.56913612301338, -85.6335967026982, 56.255959897750834, -83.42180454049756, -260.0590235514048, 50.85025922337046, -80.98870465441789, -130.60716127532925, -92.43177008463259, 42.45993138625277, -190.63569699180866, 40.00091649742323, -46.2644329004423, -43.21891269494262, -31.227214994170588, -134.65506722482516, -238.30366631231433, -22.142029649094514, -33.17188082995322, -80.58649133096017, 137.16470626500913, -26.47979646527559, 200.0, -481.9272791752029, 69.5095465863964, -193.13046298640046, -163.5479873131075, -189.884568441319, -64.05060920189133, -200.9492880403418, -103.3231931010531, -181.25598330679523, 184.62915565115256, -263.31045908492285, -137.9425337313547, -167.10309466878005, -196.5550844383228, -212.57060302828762, -217.3905829211871, 111.61765057958901, -162.0270440191072, -4.197361744606747, -118.3010178957555, -246.97738460454647, 41.30747380194557, 199.1, -131.47034173189587, -7.828764382712594, -85.63335947103378, -81.808932929195, 18.649007899875148, -23.333815151597474, -5.727379438195101, -130.89850873941361, -84.9914729058327, 149.0065944990751, -58.44128788884161, -117.98959298181109, -190.35271011150616, 135.726174210751, -192.09512637960108, -96.4874379824391, -4.9796670570066075, -116.35737209279617, -22.37064382317333, 160.2120803299997, -189.74616853089026, -114.80923494290721, -194.43180348783469, -50.92430953321701, -250.58676130947677, -211.46207081777382, 69.13134159649127, 45.685781136448966, -186.20042183290133, -189.44424022294845, -214.6317183550224, 99.5457973507694, 73.60337988622769, -221.34044565129767, -2.0279280176770538, -28.20376224245888, -176.26285996776366, -58.90591231316089, -252.50327143412414, 101.97951717095317, -3.6525653400381772, -282.49377039454345, 18.30939348306546, -133.80298986854126, -238.25413510939043, -34.59494606942796, -46.009259428436266, -6.806730212048745, 118.90199252772352, -222.15141243748025, 125.7654905928298, -195.4290355340844, 90.93942236806623, -161.60368083482317, -167.93962405934835, 10.608056626818223, -143.5553177074208, -110.87214629008989, -1.8213105017037599, -33.9809592875074, -208.1869676958417, 134.6742319839413, -221.02613330269338, -42.10321157965783, 124.74709338084698, -99.02622816589725, -244.2451810979079, 94.99660223543964, -22.305493445100502, -269.2442219791426, -347.6872755049857, -52.379117698331704, 79.84022570657703, -269.6461709990884, -41.834103883809455, -149.66310336453105, -19.381709795387977, 78.69873662396772, -97.71671049366908, -225.8269019762432, 28.894633245414937, 16.732183459464096, -334.4851247351806, -13.913120187762821, -305.6235973046064, 18.169582642050532, -230.746419499362, 19.287796925186306, -64.55344645072951, 32.20208532431778, -10.621425991047499, 32.70184136909628, -104.21839036232923, -7.073649215533683, -183.61819727197675, -52.433217488020475, -214.3291679303595, 70.71886128494921, -350.05875972641667, 146.51789379449335, 80.71865848268315, -166.94476113644112, 196.3904249914964, -214.89499317756238, 53.35962124549371, -99.86525118114659, 45.68528252574934, -218.0703332489235], "policy_predator_policy_reward": [75.22649341723627, 155.4347503937421, 163.92559203990348, 113.84330626669092, 179.72858001839128, 52.970007776744225, 112.16023694947158, 267.0929090864413, 1.9809458217793954, 81.95754604703106, 112.57631145626148, 184.9764098839407, 371.9780653760915, 79.55941244109165, 133.5097652818074, 7.7584018215214545, 276.0141817795542, 249.3012619942842, 55.51221281674862, 9.545414854744644, 14.246597255281484, 201.23851630587555, 10.919836862438583, 154.49153383842474, 118.6799293622871, 193.66061325861727, 230.52734076777682, 162.45222889276005, 139.4692746892334, 87.60399480110748, 137.6805773317793, 341.5234718804521, 106.33562074091093, 203.71568646343715, 115.39510308456695, 145.2662559013016, 31.39609985085658, 310.9697758635541, 132.64703982056722, 279.6568769521287, 83.39938710837576, 271.8296374608873, 177.5865736403456, 118.31786341863044, 230.1755665785312, 310.29233483986314, 135.88098398192363, 192.29921249237356, 64.64311010861637, 102.5217093567234, 159.05090551563686, 205.5587534414097, 152.7604766728451, 107.63417807527004, 69.61050141109605, 103.27320737027415, 128.17820727632926, 108.75914631486077, 155.06443290044228, 62.818912694942824, 118.53793533380133, 223.04739082066416, 246.8036663123142, 82.4640733280547, 204.85591582667516, 105.15229082605022, 11.8349138502565, 74.54571686533566, 305.3745886556825, 238.55617126231868, 210.56490334556327, 50.28372135573832, 207.65859763629507, 99.25987040544125, 161.79664486975588, 195.80248805089687, 294.60552483581927, 149.1068522646189, 134.7914455871717, 161.80678067732273, 175.72867225634516, 169.68829272920567, 280.7376924702353, 168.3849070818996, 263.58564620847136, 7.459958542202577, 114.25157888624506, 114.67019134405908, 240.955837461089, 175.60962089384026, 43.9191272206862, 53.03739012628934, 128.71465700598813, 172.32914802325712, 149.20180497313692, 140.8425201228014, 41.37407316192066, 7.910734089801858, 166.2404989103933, 184.7005040397581, 94.56291068237417, 30.374241997041914, 51.46456396384583, 153.76631690680648, 91.1614148471971, 166.45901241916982, 146.83269079290332, 223.21913489183837, 105.05052310084751, 198.49951287970083, 9.40086466791897, 104.58794702981866, 79.85655739316579, 290.8548341788043, 106.3562420929675, 284.39709724911796, 242.069383238372, 252.59639404643391, 9.235729062364241, 90.16170877081592, 218.9974360449172, 227.19245180675108, 125.65478445781848, 179.0082360095722, 180.98285475857793, 171.32181275534734, 66.97035308713915, 149.72909669532342, 102.77499452004062, 155.99543886008922, 257.403271434124, 43.448367216623474, 167.78319068895178, 178.5316529485568, 217.07685602495653, 54.12694584555521, 146.44237721181227, 188.17967148924456, 51.26012850810498, 72.19869997960717, 169.18819855673974, 133.8181470816402, 160.2357207924895, 96.41479601538342, 51.76253705785696, 190.92532273866306, 154.28437513894897, 84.43756278578184, 161.41233343838076, 202.85025438595488, 41.096432931583834, 67.50583685762763, 112.05518072051615, 181.88297164350703, 199.76698808300816, 201.50279920884168, 18.130068984699093, 121.84498187334137, 57.58712545419114, 246.0915698747318, 38.75500836810234, 272.21464063131526, 247.36886480706625, 305.7935002104611, 59.65977429342301, 269.6461709990884, 23.098411671763973, 195.6324778602138, 38.10695549243518, 75.07601767898525, 242.22631058951558, 136.17723356177862, 64.76781654053603, 5.789936079423872, 194.90042267770005, 276.13893414838725, 248.27489870656524, 184.78463893689622, 46.592993611454894, 251.09744257932135, 82.8534464507287, 72.99791467568204, 68.79529370500731, 0.0, 46.01674507722463, 169.43900965448398, 127.71901449938092, 231.63360660315848, 224.80555775875078, 53.8878015140101, 363.1337726422758, 49.88678924815549, 83.42607784523415, 197.67457639917225, 0.8095750085036049, 236.19499317756217, 125.82136706400911, 145.37820621333208, 175.06807534358308, 112.71810651258501]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.931858179806077, "mean_inference_ms": 6.452393885465231, "mean_action_processing_ms": 4.061105654810919, "mean_env_wait_ms": 14.40419968748728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042025208473205566, "StateBufferConnector_ms": 0.015056133270263672, "ViewRequirementAgentConnector_ms": 0.27772998809814453}, "num_episodes": 20, "episode_return_max": 337.3639911489211, "episode_return_min": -46.51408771268966, "episode_return_mean": 133.16609001458352, "episodes_this_iter": 20}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452480, "num_agent_steps_trained": 1452480, "num_env_steps_sampled": 363120, "num_env_steps_trained": 363120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 68.42943271037969, "num_env_steps_trained_throughput_per_sec": 68.42943271037969, "timesteps_total": 363120, "num_env_steps_sampled_lifetime": 363120, "num_agent_steps_sampled_lifetime": 1452480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1452480, "timers": {"training_iteration_time_ms": 56230.113, "restore_workers_time_ms": 0.017, "training_step_time_ms": 56230.042, "sample_time_ms": 3708.387, "learn_time_ms": 52497.425, "learn_throughput": 76.194, "synch_weights_time_ms": 17.989}, "counters": {"num_env_steps_sampled": 363120, "num_env_steps_trained": 363120, "num_agent_steps_sampled": 1452480, "num_agent_steps_trained": 1452480}, "done": false, "training_iteration": 90, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-45-27", "timestamp": 1724152527, "time_this_iter_s": 58.52878475189209, "time_total_s": 5087.51483130455, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120bceee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5087.51483130455, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 57.61325301204819, "ram_util_percent": 82.69156626506025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.54811841369306, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.696276434388741, "policy_loss": -0.018745502870697428, "vf_loss": 6.712763351864285, "vf_explained_var": 0.4411905673445848, "kl": 0.011292950800624948, "entropy": 0.6423971535667541, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172515.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.02759525529922, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.499570258584603, "policy_loss": -0.013637553646091235, "vf_loss": 5.511271703810919, "vf_explained_var": 0.13965161732895665, "kl": 0.009680451857783491, "entropy": 0.6733782763203616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172515.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}}, "num_env_steps_sampled": 367120, "num_env_steps_trained": 367120, "num_agent_steps_sampled": 1468480, "num_agent_steps_trained": 1468480}, "env_runners": {"episode_reward_max": 337.3639911489211, "episode_reward_min": -46.51408771268966, "episode_reward_mean": 132.64196903010858, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -481.9272791752029, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 363.1337726422758}, "policy_reward_mean": {"prey_policy": -75.45456427782169, "predator_policy": 141.77554879287595}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.97746364858617, 139.9989748225933, 155.40089462901247, 48.79878881836937, 122.91187008298981, 86.30257309680442, 128.39999999999972, 175.70304393546968, 68.82204367895984, 196.2498344918119, 197.0655405153252, 262.0034807427985, 137.22770830129764, -46.51408771268966, 92.59923567841992, 159.13320069258984, 217.91692283072422, 40.37133658541716, 39.99691208552485, 165.2726724090758, 62.697364466590216, 51.2870558546281, 337.3639911489211, 161.74469891463679, 122.60203269570982, 44.600000000000385, 214.3151147725424, 188.9522742726581, 28.80000000000014, 202.9938913656118, 81.46926132270166, 182.2129968307449, 251.83024820456393, 66.15598809817358, 145.39722632103405, 32.6169451575549, 214.21456056612024, 70.54522579581891, 189.5770994631376, 204.56760174885542, 186.46775952232608, 23.60166109920547, 150.32788438757655, 60.168507902926955, 155.7102054850359, 61.77296752223821, 70.64283884722708, 199.75692572862312, 186.98697186661843, 172.02360132976298, 81.39037049220079, 109.83512382682568, 72.8000000000003, 220.425416652123, 138.1404424094987, 165.69591607299023, 154.43011646645462, 19.41993357517375, 153.09597181420972, 139.5, 27.23368228363746, 172.4999999999995, 54.859931681382854, 116.18456932483886, 122.64111190314364, 145.6055229809055, 86.23181361660009, 123.49999999999972, 90.87570908305584, 104.16371515384536, 123.30120634254223, 135.08305262735036, 209.47969595850776, 194.87455159064837, 218.5, 224.6939433416879, 115.40113113299387, 106.70773895578424, 91.94984527783188, 188.50781471436179, 154.65514467869457, 123.6, 40.52494995370747, 189.05064491241305, 147.97970299779126, 171.96174254465978, 202.10958629957315, 167.77041340706327, 47.19084686190058, 134.80401234583888, 184.80628932143821, 233.28031232181522, 271.67353296808085, 98.68360761306532, 103.32415593477988, 137.09475368277128, 47.825477709031716, 53.28732463425837, 195.4258450616467, 59.07892245910974], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-158.56913612301338, -85.6335967026982, 56.255959897750834, -83.42180454049756, -260.0590235514048, 50.85025922337046, -80.98870465441789, -130.60716127532925, -92.43177008463259, 42.45993138625277, -190.63569699180866, 40.00091649742323, -46.2644329004423, -43.21891269494262, -31.227214994170588, -134.65506722482516, -238.30366631231433, -22.142029649094514, -33.17188082995322, -80.58649133096017, 137.16470626500913, -26.47979646527559, 200.0, -481.9272791752029, 69.5095465863964, -193.13046298640046, -163.5479873131075, -189.884568441319, -64.05060920189133, -200.9492880403418, -103.3231931010531, -181.25598330679523, 184.62915565115256, -263.31045908492285, -137.9425337313547, -167.10309466878005, -196.5550844383228, -212.57060302828762, -217.3905829211871, 111.61765057958901, -162.0270440191072, -4.197361744606747, -118.3010178957555, -246.97738460454647, 41.30747380194557, 199.1, -131.47034173189587, -7.828764382712594, -85.63335947103378, -81.808932929195, 18.649007899875148, -23.333815151597474, -5.727379438195101, -130.89850873941361, -84.9914729058327, 149.0065944990751, -58.44128788884161, -117.98959298181109, -190.35271011150616, 135.726174210751, -192.09512637960108, -96.4874379824391, -4.9796670570066075, -116.35737209279617, -22.37064382317333, 160.2120803299997, -189.74616853089026, -114.80923494290721, -194.43180348783469, -50.92430953321701, -250.58676130947677, -211.46207081777382, 69.13134159649127, 45.685781136448966, -186.20042183290133, -189.44424022294845, -214.6317183550224, 99.5457973507694, 73.60337988622769, -221.34044565129767, -2.0279280176770538, -28.20376224245888, -176.26285996776366, -58.90591231316089, -252.50327143412414, 101.97951717095317, -3.6525653400381772, -282.49377039454345, 18.30939348306546, -133.80298986854126, -238.25413510939043, -34.59494606942796, -46.009259428436266, -6.806730212048745, 118.90199252772352, -222.15141243748025, 125.7654905928298, -195.4290355340844, 90.93942236806623, -161.60368083482317, -167.93962405934835, 10.608056626818223, -143.5553177074208, -110.87214629008989, -1.8213105017037599, -33.9809592875074, -208.1869676958417, 134.6742319839413, -221.02613330269338, -42.10321157965783, 124.74709338084698, -99.02622816589725, -244.2451810979079, 94.99660223543964, -22.305493445100502, -269.2442219791426, -347.6872755049857, -52.379117698331704, 79.84022570657703, -269.6461709990884, -41.834103883809455, -149.66310336453105, -19.381709795387977, 78.69873662396772, -97.71671049366908, -225.8269019762432, 28.894633245414937, 16.732183459464096, -334.4851247351806, -13.913120187762821, -305.6235973046064, 18.169582642050532, -230.746419499362, 19.287796925186306, -64.55344645072951, 32.20208532431778, -10.621425991047499, 32.70184136909628, -104.21839036232923, -7.073649215533683, -183.61819727197675, -52.433217488020475, -214.3291679303595, 70.71886128494921, -350.05875972641667, 146.51789379449335, 80.71865848268315, -166.94476113644112, 196.3904249914964, -214.89499317756238, 53.35962124549371, -99.86525118114659, 45.68528252574934, -218.0703332489235, -74.60748391669887, -293.10917836638674, -140.65555147696674, -218.5092208239555, 123.79665975001538, -204.34304411105282, 17.344999783616302, 20.74853454436038, 97.66726218820672, -261.60889459872595, -183.23999807750602, -43.28034666632799, 124.06367339757546, -193.29582184259118, -30.80954696577472, 24.855422654903016, 98.32516483007221, -84.29048753886264, -64.2823887229586, -44.47921565409869, -201.14276991763916, -33.21051973143116, 5.854114371101762, -120.41957377592412, 114.33519802895007, -215.8454834793292, -37.72286551636233, -34.220203101693926, 180.1070277515072, -155.0015548715236, -224.6483364284103, 186.1561463301718, -330.84552668358225, 9.207431228512993, -149.62652585761262, -53.447786470191204, -230.96468453658366, 46.75272972180935, -9.780255908814413, -238.58681040450927, -195.1448942071324, -136.34731643518577, 18.07018613385724, 124.88334110673424, -31.981737977015108, -253.14959339019873], "policy_predator_policy_reward": [135.88098398192363, 192.29921249237356, 64.64311010861637, 102.5217093567234, 159.05090551563686, 205.5587534414097, 152.7604766728451, 107.63417807527004, 69.61050141109605, 103.27320737027415, 128.17820727632926, 108.75914631486077, 155.06443290044228, 62.818912694942824, 118.53793533380133, 223.04739082066416, 246.8036663123142, 82.4640733280547, 204.85591582667516, 105.15229082605022, 11.8349138502565, 74.54571686533566, 305.3745886556825, 238.55617126231868, 210.56490334556327, 50.28372135573832, 207.65859763629507, 99.25987040544125, 161.79664486975588, 195.80248805089687, 294.60552483581927, 149.1068522646189, 134.7914455871717, 161.80678067732273, 175.72867225634516, 169.68829272920567, 280.7376924702353, 168.3849070818996, 263.58564620847136, 7.459958542202577, 114.25157888624506, 114.67019134405908, 240.955837461089, 175.60962089384026, 43.9191272206862, 53.03739012628934, 128.71465700598813, 172.32914802325712, 149.20180497313692, 140.8425201228014, 41.37407316192066, 7.910734089801858, 166.2404989103933, 184.7005040397581, 94.56291068237417, 30.374241997041914, 51.46456396384583, 153.76631690680648, 91.1614148471971, 166.45901241916982, 146.83269079290332, 223.21913489183837, 105.05052310084751, 198.49951287970083, 9.40086466791897, 104.58794702981866, 79.85655739316579, 290.8548341788043, 106.3562420929675, 284.39709724911796, 242.069383238372, 252.59639404643391, 9.235729062364241, 90.16170877081592, 218.9974360449172, 227.19245180675108, 125.65478445781848, 179.0082360095722, 180.98285475857793, 171.32181275534734, 66.97035308713915, 149.72909669532342, 102.77499452004062, 155.99543886008922, 257.403271434124, 43.448367216623474, 167.78319068895178, 178.5316529485568, 217.07685602495653, 54.12694584555521, 146.44237721181227, 188.17967148924456, 51.26012850810498, 72.19869997960717, 169.18819855673974, 133.8181470816402, 160.2357207924895, 96.41479601538342, 51.76253705785696, 190.92532273866306, 154.28437513894897, 84.43756278578184, 161.41233343838076, 202.85025438595488, 41.096432931583834, 67.50583685762763, 112.05518072051615, 181.88297164350703, 199.76698808300816, 201.50279920884168, 18.130068984699093, 121.84498187334137, 57.58712545419114, 246.0915698747318, 38.75500836810234, 272.21464063131526, 247.36886480706625, 305.7935002104611, 59.65977429342301, 269.6461709990884, 23.098411671763973, 195.6324778602138, 38.10695549243518, 75.07601767898525, 242.22631058951558, 136.17723356177862, 64.76781654053603, 5.789936079423872, 194.90042267770005, 276.13893414838725, 248.27489870656524, 184.78463893689622, 46.592993611454894, 251.09744257932135, 82.8534464507287, 72.99791467568204, 68.79529370500731, 0.0, 46.01674507722463, 169.43900965448398, 127.71901449938092, 231.63360660315848, 224.80555775875078, 53.8878015140101, 363.1337726422758, 49.88678924815549, 83.42607784523415, 197.67457639917225, 0.8095750085036049, 236.19499317756217, 125.82136706400911, 145.37820621333208, 175.06807534358308, 112.71810651258501, 178.71358765457904, 295.71081358429086, 205.78587964108902, 245.3287379376648, 41.28157573057993, 227.77262334481927, 87.61371493379434, 28.947895416923608, 25.032737811793364, 262.50889459872593, 118.7677388799885, 148.27755581755284, 146.29068099137342, 111.99211236605541, 74.04618068570325, 79.88764662296025, 64.73392563711667, 93.19313961633351, 159.52641431771616, 151.34477635891426, 135.54375008627727, 266.57995296985644, 36.22487173762957, 125.53143452909264, 14.00174168468998, 222.31255611152798, 77.62116222689338, 179.128195712601, 47.74768889513889, 160.4271505466928, 149.40205305853192, 160.76367000778794, 189.27425936953304, 231.047443698604, 179.9107984175313, 126.48766984505185, 239.86468453658333, 81.44202396096203, 116.29812665153626, 179.894417370819, 137.87998779907292, 246.89954747750303, 23.5098428461458, 28.962474974909796, 83.06066043612478, 261.14959339019845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.90988371107784, "mean_inference_ms": 6.424776273415805, "mean_action_processing_ms": 4.211258604362349, "mean_env_wait_ms": 14.393578234007991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04234051704406738, "StateBufferConnector_ms": 0.01748943328857422, "ViewRequirementAgentConnector_ms": 0.2964519262313843}, "num_episodes": 23, "episode_return_max": 337.3639911489211, "episode_return_min": -46.51408771268966, "episode_return_mean": 132.64196903010858, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1468480, "num_agent_steps_trained": 1468480, "num_env_steps_sampled": 367120, "num_env_steps_trained": 367120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.45270059349315, "num_env_steps_trained_throughput_per_sec": 74.45270059349315, "timesteps_total": 367120, "num_env_steps_sampled_lifetime": 367120, "num_agent_steps_sampled_lifetime": 1468480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1468480, "timers": {"training_iteration_time_ms": 56050.449, "restore_workers_time_ms": 0.017, "training_step_time_ms": 56050.379, "sample_time_ms": 3632.044, "learn_time_ms": 52392.999, "learn_throughput": 76.346, "synch_weights_time_ms": 18.619}, "counters": {"num_env_steps_sampled": 367120, "num_env_steps_trained": 367120, "num_agent_steps_sampled": 1468480, "num_agent_steps_trained": 1468480}, "done": false, "training_iteration": 91, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-46-21", "timestamp": 1724152581, "time_this_iter_s": 53.77650284767151, "time_total_s": 5141.291334152222, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x12002d670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5141.291334152222, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 51.58961038961039, "ram_util_percent": 82.76753246753246}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.58090946049917, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.587563424135642, "policy_loss": -0.015609553280882734, "vf_loss": 6.601073134134686, "vf_explained_var": 0.3864555467058111, "kl": 0.010499248982816145, "entropy": 0.6818904348151393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174405.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.516117087053874, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.220477188453472, "policy_loss": -0.016435612522178976, "vf_loss": 5.234641398828496, "vf_explained_var": 0.11965271953552488, "kl": 0.011356953484198403, "entropy": 0.6547288687140853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174405.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}}, "num_env_steps_sampled": 371120, "num_env_steps_trained": 371120, "num_agent_steps_sampled": 1484480, "num_agent_steps_trained": 1484480}, "env_runners": {"episode_reward_max": 337.3639911489211, "episode_reward_min": -46.51408771268966, "episode_reward_mean": 132.64196903010858, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -481.9272791752029, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 363.1337726422758}, "policy_reward_mean": {"prey_policy": -75.45456427782169, "predator_policy": 141.77554879287595}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.97746364858617, 139.9989748225933, 155.40089462901247, 48.79878881836937, 122.91187008298981, 86.30257309680442, 128.39999999999972, 175.70304393546968, 68.82204367895984, 196.2498344918119, 197.0655405153252, 262.0034807427985, 137.22770830129764, -46.51408771268966, 92.59923567841992, 159.13320069258984, 217.91692283072422, 40.37133658541716, 39.99691208552485, 165.2726724090758, 62.697364466590216, 51.2870558546281, 337.3639911489211, 161.74469891463679, 122.60203269570982, 44.600000000000385, 214.3151147725424, 188.9522742726581, 28.80000000000014, 202.9938913656118, 81.46926132270166, 182.2129968307449, 251.83024820456393, 66.15598809817358, 145.39722632103405, 32.6169451575549, 214.21456056612024, 70.54522579581891, 189.5770994631376, 204.56760174885542, 186.46775952232608, 23.60166109920547, 150.32788438757655, 60.168507902926955, 155.7102054850359, 61.77296752223821, 70.64283884722708, 199.75692572862312, 186.98697186661843, 172.02360132976298, 81.39037049220079, 109.83512382682568, 72.8000000000003, 220.425416652123, 138.1404424094987, 165.69591607299023, 154.43011646645462, 19.41993357517375, 153.09597181420972, 139.5, 27.23368228363746, 172.4999999999995, 54.859931681382854, 116.18456932483886, 122.64111190314364, 145.6055229809055, 86.23181361660009, 123.49999999999972, 90.87570908305584, 104.16371515384536, 123.30120634254223, 135.08305262735036, 209.47969595850776, 194.87455159064837, 218.5, 224.6939433416879, 115.40113113299387, 106.70773895578424, 91.94984527783188, 188.50781471436179, 154.65514467869457, 123.6, 40.52494995370747, 189.05064491241305, 147.97970299779126, 171.96174254465978, 202.10958629957315, 167.77041340706327, 47.19084686190058, 134.80401234583888, 184.80628932143821, 233.28031232181522, 271.67353296808085, 98.68360761306532, 103.32415593477988, 137.09475368277128, 47.825477709031716, 53.28732463425837, 195.4258450616467, 59.07892245910974], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-158.56913612301338, -85.6335967026982, 56.255959897750834, -83.42180454049756, -260.0590235514048, 50.85025922337046, -80.98870465441789, -130.60716127532925, -92.43177008463259, 42.45993138625277, -190.63569699180866, 40.00091649742323, -46.2644329004423, -43.21891269494262, -31.227214994170588, -134.65506722482516, -238.30366631231433, -22.142029649094514, -33.17188082995322, -80.58649133096017, 137.16470626500913, -26.47979646527559, 200.0, -481.9272791752029, 69.5095465863964, -193.13046298640046, -163.5479873131075, -189.884568441319, -64.05060920189133, -200.9492880403418, -103.3231931010531, -181.25598330679523, 184.62915565115256, -263.31045908492285, -137.9425337313547, -167.10309466878005, -196.5550844383228, -212.57060302828762, -217.3905829211871, 111.61765057958901, -162.0270440191072, -4.197361744606747, -118.3010178957555, -246.97738460454647, 41.30747380194557, 199.1, -131.47034173189587, -7.828764382712594, -85.63335947103378, -81.808932929195, 18.649007899875148, -23.333815151597474, -5.727379438195101, -130.89850873941361, -84.9914729058327, 149.0065944990751, -58.44128788884161, -117.98959298181109, -190.35271011150616, 135.726174210751, -192.09512637960108, -96.4874379824391, -4.9796670570066075, -116.35737209279617, -22.37064382317333, 160.2120803299997, -189.74616853089026, -114.80923494290721, -194.43180348783469, -50.92430953321701, -250.58676130947677, -211.46207081777382, 69.13134159649127, 45.685781136448966, -186.20042183290133, -189.44424022294845, -214.6317183550224, 99.5457973507694, 73.60337988622769, -221.34044565129767, -2.0279280176770538, -28.20376224245888, -176.26285996776366, -58.90591231316089, -252.50327143412414, 101.97951717095317, -3.6525653400381772, -282.49377039454345, 18.30939348306546, -133.80298986854126, -238.25413510939043, -34.59494606942796, -46.009259428436266, -6.806730212048745, 118.90199252772352, -222.15141243748025, 125.7654905928298, -195.4290355340844, 90.93942236806623, -161.60368083482317, -167.93962405934835, 10.608056626818223, -143.5553177074208, -110.87214629008989, -1.8213105017037599, -33.9809592875074, -208.1869676958417, 134.6742319839413, -221.02613330269338, -42.10321157965783, 124.74709338084698, -99.02622816589725, -244.2451810979079, 94.99660223543964, -22.305493445100502, -269.2442219791426, -347.6872755049857, -52.379117698331704, 79.84022570657703, -269.6461709990884, -41.834103883809455, -149.66310336453105, -19.381709795387977, 78.69873662396772, -97.71671049366908, -225.8269019762432, 28.894633245414937, 16.732183459464096, -334.4851247351806, -13.913120187762821, -305.6235973046064, 18.169582642050532, -230.746419499362, 19.287796925186306, -64.55344645072951, 32.20208532431778, -10.621425991047499, 32.70184136909628, -104.21839036232923, -7.073649215533683, -183.61819727197675, -52.433217488020475, -214.3291679303595, 70.71886128494921, -350.05875972641667, 146.51789379449335, 80.71865848268315, -166.94476113644112, 196.3904249914964, -214.89499317756238, 53.35962124549371, -99.86525118114659, 45.68528252574934, -218.0703332489235, -74.60748391669887, -293.10917836638674, -140.65555147696674, -218.5092208239555, 123.79665975001538, -204.34304411105282, 17.344999783616302, 20.74853454436038, 97.66726218820672, -261.60889459872595, -183.23999807750602, -43.28034666632799, 124.06367339757546, -193.29582184259118, -30.80954696577472, 24.855422654903016, 98.32516483007221, -84.29048753886264, -64.2823887229586, -44.47921565409869, -201.14276991763916, -33.21051973143116, 5.854114371101762, -120.41957377592412, 114.33519802895007, -215.8454834793292, -37.72286551636233, -34.220203101693926, 180.1070277515072, -155.0015548715236, -224.6483364284103, 186.1561463301718, -330.84552668358225, 9.207431228512993, -149.62652585761262, -53.447786470191204, -230.96468453658366, 46.75272972180935, -9.780255908814413, -238.58681040450927, -195.1448942071324, -136.34731643518577, 18.07018613385724, 124.88334110673424, -31.981737977015108, -253.14959339019873], "policy_predator_policy_reward": [135.88098398192363, 192.29921249237356, 64.64311010861637, 102.5217093567234, 159.05090551563686, 205.5587534414097, 152.7604766728451, 107.63417807527004, 69.61050141109605, 103.27320737027415, 128.17820727632926, 108.75914631486077, 155.06443290044228, 62.818912694942824, 118.53793533380133, 223.04739082066416, 246.8036663123142, 82.4640733280547, 204.85591582667516, 105.15229082605022, 11.8349138502565, 74.54571686533566, 305.3745886556825, 238.55617126231868, 210.56490334556327, 50.28372135573832, 207.65859763629507, 99.25987040544125, 161.79664486975588, 195.80248805089687, 294.60552483581927, 149.1068522646189, 134.7914455871717, 161.80678067732273, 175.72867225634516, 169.68829272920567, 280.7376924702353, 168.3849070818996, 263.58564620847136, 7.459958542202577, 114.25157888624506, 114.67019134405908, 240.955837461089, 175.60962089384026, 43.9191272206862, 53.03739012628934, 128.71465700598813, 172.32914802325712, 149.20180497313692, 140.8425201228014, 41.37407316192066, 7.910734089801858, 166.2404989103933, 184.7005040397581, 94.56291068237417, 30.374241997041914, 51.46456396384583, 153.76631690680648, 91.1614148471971, 166.45901241916982, 146.83269079290332, 223.21913489183837, 105.05052310084751, 198.49951287970083, 9.40086466791897, 104.58794702981866, 79.85655739316579, 290.8548341788043, 106.3562420929675, 284.39709724911796, 242.069383238372, 252.59639404643391, 9.235729062364241, 90.16170877081592, 218.9974360449172, 227.19245180675108, 125.65478445781848, 179.0082360095722, 180.98285475857793, 171.32181275534734, 66.97035308713915, 149.72909669532342, 102.77499452004062, 155.99543886008922, 257.403271434124, 43.448367216623474, 167.78319068895178, 178.5316529485568, 217.07685602495653, 54.12694584555521, 146.44237721181227, 188.17967148924456, 51.26012850810498, 72.19869997960717, 169.18819855673974, 133.8181470816402, 160.2357207924895, 96.41479601538342, 51.76253705785696, 190.92532273866306, 154.28437513894897, 84.43756278578184, 161.41233343838076, 202.85025438595488, 41.096432931583834, 67.50583685762763, 112.05518072051615, 181.88297164350703, 199.76698808300816, 201.50279920884168, 18.130068984699093, 121.84498187334137, 57.58712545419114, 246.0915698747318, 38.75500836810234, 272.21464063131526, 247.36886480706625, 305.7935002104611, 59.65977429342301, 269.6461709990884, 23.098411671763973, 195.6324778602138, 38.10695549243518, 75.07601767898525, 242.22631058951558, 136.17723356177862, 64.76781654053603, 5.789936079423872, 194.90042267770005, 276.13893414838725, 248.27489870656524, 184.78463893689622, 46.592993611454894, 251.09744257932135, 82.8534464507287, 72.99791467568204, 68.79529370500731, 0.0, 46.01674507722463, 169.43900965448398, 127.71901449938092, 231.63360660315848, 224.80555775875078, 53.8878015140101, 363.1337726422758, 49.88678924815549, 83.42607784523415, 197.67457639917225, 0.8095750085036049, 236.19499317756217, 125.82136706400911, 145.37820621333208, 175.06807534358308, 112.71810651258501, 178.71358765457904, 295.71081358429086, 205.78587964108902, 245.3287379376648, 41.28157573057993, 227.77262334481927, 87.61371493379434, 28.947895416923608, 25.032737811793364, 262.50889459872593, 118.7677388799885, 148.27755581755284, 146.29068099137342, 111.99211236605541, 74.04618068570325, 79.88764662296025, 64.73392563711667, 93.19313961633351, 159.52641431771616, 151.34477635891426, 135.54375008627727, 266.57995296985644, 36.22487173762957, 125.53143452909264, 14.00174168468998, 222.31255611152798, 77.62116222689338, 179.128195712601, 47.74768889513889, 160.4271505466928, 149.40205305853192, 160.76367000778794, 189.27425936953304, 231.047443698604, 179.9107984175313, 126.48766984505185, 239.86468453658333, 81.44202396096203, 116.29812665153626, 179.894417370819, 137.87998779907292, 246.89954747750303, 23.5098428461458, 28.962474974909796, 83.06066043612478, 261.14959339019845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.90988371107784, "mean_inference_ms": 6.424776273415805, "mean_action_processing_ms": 4.211258604362349, "mean_env_wait_ms": 14.393578234007991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04234051704406738, "StateBufferConnector_ms": 0.01748943328857422, "ViewRequirementAgentConnector_ms": 0.2964519262313843}, "num_episodes": 0, "episode_return_max": 337.3639911489211, "episode_return_min": -46.51408771268966, "episode_return_mean": 132.64196903010858, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1484480, "num_agent_steps_trained": 1484480, "num_env_steps_sampled": 371120, "num_env_steps_trained": 371120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 47.35405423951661, "num_env_steps_trained_throughput_per_sec": 47.35405423951661, "timesteps_total": 371120, "num_env_steps_sampled_lifetime": 371120, "num_agent_steps_sampled_lifetime": 1484480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1484480, "timers": {"training_iteration_time_ms": 58706.997, "restore_workers_time_ms": 0.017, "training_step_time_ms": 58706.691, "sample_time_ms": 3585.923, "learn_time_ms": 54028.367, "learn_throughput": 74.035, "synch_weights_time_ms": 1039.478}, "counters": {"num_env_steps_sampled": 371120, "num_env_steps_trained": 371120, "num_agent_steps_sampled": 1484480, "num_agent_steps_trained": 1484480}, "done": false, "training_iteration": 92, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-48-51", "timestamp": 1724152731, "time_this_iter_s": 149.5084731578827, "time_total_s": 5290.799807310104, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120b28790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5290.799807310104, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 62.14072164948454, "ram_util_percent": 86.39948453608247}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.208600232714698, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.594818078399335, "policy_loss": -0.01851372932928994, "vf_loss": 6.611123573969281, "vf_explained_var": 0.43682346744512124, "kl": 0.011041136127625587, "entropy": 0.6764035790054886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.305138548152157, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.180420400352074, "policy_loss": -0.0164279076647723, "vf_loss": 5.194653196435757, "vf_explained_var": 0.14849206445709107, "kl": 0.01097561471427855, "entropy": 0.6603128600688207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 375120, "num_env_steps_trained": 375120, "num_agent_steps_sampled": 1500480, "num_agent_steps_trained": 1500480}, "env_runners": {"episode_reward_max": 309.85431428277894, "episode_reward_min": 19.41993357517375, "episode_reward_mean": 131.54558845561073, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -375.36651251310263, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 363.1337726422758}, "policy_reward_mean": {"prey_policy": -73.48384524339085, "predator_policy": 139.25663947119617}, "custom_metrics": {}, "hist_stats": {"episode_reward": [122.60203269570982, 44.600000000000385, 214.3151147725424, 188.9522742726581, 28.80000000000014, 202.9938913656118, 81.46926132270166, 182.2129968307449, 251.83024820456393, 66.15598809817358, 145.39722632103405, 32.6169451575549, 214.21456056612024, 70.54522579581891, 189.5770994631376, 204.56760174885542, 186.46775952232608, 23.60166109920547, 150.32788438757655, 60.168507902926955, 155.7102054850359, 61.77296752223821, 70.64283884722708, 199.75692572862312, 186.98697186661843, 172.02360132976298, 81.39037049220079, 109.83512382682568, 72.8000000000003, 220.425416652123, 138.1404424094987, 165.69591607299023, 154.43011646645462, 19.41993357517375, 153.09597181420972, 139.5, 27.23368228363746, 172.4999999999995, 54.859931681382854, 116.18456932483886, 122.64111190314364, 145.6055229809055, 86.23181361660009, 123.49999999999972, 90.87570908305584, 104.16371515384536, 123.30120634254223, 135.08305262735036, 209.47969595850776, 194.87455159064837, 218.5, 224.6939433416879, 115.40113113299387, 106.70773895578424, 91.94984527783188, 188.50781471436179, 154.65514467869457, 123.6, 40.52494995370747, 189.05064491241305, 147.97970299779126, 171.96174254465978, 202.10958629957315, 167.77041340706327, 47.19084686190058, 134.80401234583888, 184.80628932143821, 233.28031232181522, 271.67353296808085, 98.68360761306532, 103.32415593477988, 137.09475368277128, 47.825477709031716, 53.28732463425837, 195.4258450616467, 59.07892245910974, 55.54669382863845, 172.4999999999995, 37.916886206535395, 25.313461184352725, 127.14119780844015, 92.1691502399341, 114.52924288626912, 43.57140389217489, 96.51118693058677, 21.08530490418753, 135.93108044568513, 294.05965955197115, 35.78328925262632, 50.815288663271225, 309.85431428277894, 75.59999999999997, 214.51027144451328, 222.6936591280305, 238.0342740684051, 52.50464783954048, 198.2, 238.09767570107562, 77.19999999999996, 45.5247740090508], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-85.63335947103378, -81.808932929195, 18.649007899875148, -23.333815151597474, -5.727379438195101, -130.89850873941361, -84.9914729058327, 149.0065944990751, -58.44128788884161, -117.98959298181109, -190.35271011150616, 135.726174210751, -192.09512637960108, -96.4874379824391, -4.9796670570066075, -116.35737209279617, -22.37064382317333, 160.2120803299997, -189.74616853089026, -114.80923494290721, -194.43180348783469, -50.92430953321701, -250.58676130947677, -211.46207081777382, 69.13134159649127, 45.685781136448966, -186.20042183290133, -189.44424022294845, -214.6317183550224, 99.5457973507694, 73.60337988622769, -221.34044565129767, -2.0279280176770538, -28.20376224245888, -176.26285996776366, -58.90591231316089, -252.50327143412414, 101.97951717095317, -3.6525653400381772, -282.49377039454345, 18.30939348306546, -133.80298986854126, -238.25413510939043, -34.59494606942796, -46.009259428436266, -6.806730212048745, 118.90199252772352, -222.15141243748025, 125.7654905928298, -195.4290355340844, 90.93942236806623, -161.60368083482317, -167.93962405934835, 10.608056626818223, -143.5553177074208, -110.87214629008989, -1.8213105017037599, -33.9809592875074, -208.1869676958417, 134.6742319839413, -221.02613330269338, -42.10321157965783, 124.74709338084698, -99.02622816589725, -244.2451810979079, 94.99660223543964, -22.305493445100502, -269.2442219791426, -347.6872755049857, -52.379117698331704, 79.84022570657703, -269.6461709990884, -41.834103883809455, -149.66310336453105, -19.381709795387977, 78.69873662396772, -97.71671049366908, -225.8269019762432, 28.894633245414937, 16.732183459464096, -334.4851247351806, -13.913120187762821, -305.6235973046064, 18.169582642050532, -230.746419499362, 19.287796925186306, -64.55344645072951, 32.20208532431778, -10.621425991047499, 32.70184136909628, -104.21839036232923, -7.073649215533683, -183.61819727197675, -52.433217488020475, -214.3291679303595, 70.71886128494921, -350.05875972641667, 146.51789379449335, 80.71865848268315, -166.94476113644112, 196.3904249914964, -214.89499317756238, 53.35962124549371, -99.86525118114659, 45.68528252574934, -218.0703332489235, -74.60748391669887, -293.10917836638674, -140.65555147696674, -218.5092208239555, 123.79665975001538, -204.34304411105282, 17.344999783616302, 20.74853454436038, 97.66726218820672, -261.60889459872595, -183.23999807750602, -43.28034666632799, 124.06367339757546, -193.29582184259118, -30.80954696577472, 24.855422654903016, 98.32516483007221, -84.29048753886264, -64.2823887229586, -44.47921565409869, -201.14276991763916, -33.21051973143116, 5.854114371101762, -120.41957377592412, 114.33519802895007, -215.8454834793292, -37.72286551636233, -34.220203101693926, 180.1070277515072, -155.0015548715236, -224.6483364284103, 186.1561463301718, -330.84552668358225, 9.207431228512993, -149.62652585761262, -53.447786470191204, -230.96468453658366, 46.75272972180935, -9.780255908814413, -238.58681040450927, -195.1448942071324, -136.34731643518577, 18.07018613385724, 124.88334110673424, -31.981737977015108, -253.14959339019873, -25.647541929636734, -208.76776470446177, 115.65090721860523, 12.698463154286701, -156.41916430823358, -358.74274233496385, -129.8675025748312, -119.09431081851284, 6.827314932087875, 54.28591126309289, -72.91878578916953, -257.1440176097109, -87.92329598676938, -221.55871418014164, -167.8216697483177, -44.89909965575192, -103.68837624164763, -121.19119786597747, -71.33401972731232, -136.31954904438317, -66.81150268213457, 9.662291822916364, -116.93107980352359, 189.80870164199857, -150.12443804740985, -24.460146106042536, -375.36651251310263, -237.80015368058952, 109.2055084740912, 173.74236880004256, -96.80710199839368, 20.000000000000014, -145.9034136200329, 123.27738041240262, -49.483462301820566, -90.35569610927794, -127.59441100624142, 200.0, -102.79295283149871, -236.36871765539286, 195.66927288110085, -265.07914220081204, -58.460356195448156, -103.4376474188795, -19.37918663559782, -159.88973209450478, -90.09174358765782, -65.4535949607536], "policy_predator_policy_reward": [149.20180497313692, 140.8425201228014, 41.37407316192066, 7.910734089801858, 166.2404989103933, 184.7005040397581, 94.56291068237417, 30.374241997041914, 51.46456396384583, 153.76631690680648, 91.1614148471971, 166.45901241916982, 146.83269079290332, 223.21913489183837, 105.05052310084751, 198.49951287970083, 9.40086466791897, 104.58794702981866, 79.85655739316579, 290.8548341788043, 106.3562420929675, 284.39709724911796, 242.069383238372, 252.59639404643391, 9.235729062364241, 90.16170877081592, 218.9974360449172, 227.19245180675108, 125.65478445781848, 179.0082360095722, 180.98285475857793, 171.32181275534734, 66.97035308713915, 149.72909669532342, 102.77499452004062, 155.99543886008922, 257.403271434124, 43.448367216623474, 167.78319068895178, 178.5316529485568, 217.07685602495653, 54.12694584555521, 146.44237721181227, 188.17967148924456, 51.26012850810498, 72.19869997960717, 169.18819855673974, 133.8181470816402, 160.2357207924895, 96.41479601538342, 51.76253705785696, 190.92532273866306, 154.28437513894897, 84.43756278578184, 161.41233343838076, 202.85025438595488, 41.096432931583834, 67.50583685762763, 112.05518072051615, 181.88297164350703, 199.76698808300816, 201.50279920884168, 18.130068984699093, 121.84498187334137, 57.58712545419114, 246.0915698747318, 38.75500836810234, 272.21464063131526, 247.36886480706625, 305.7935002104611, 59.65977429342301, 269.6461709990884, 23.098411671763973, 195.6324778602138, 38.10695549243518, 75.07601767898525, 242.22631058951558, 136.17723356177862, 64.76781654053603, 5.789936079423872, 194.90042267770005, 276.13893414838725, 248.27489870656524, 184.78463893689622, 46.592993611454894, 251.09744257932135, 82.8534464507287, 72.99791467568204, 68.79529370500731, 0.0, 46.01674507722463, 169.43900965448398, 127.71901449938092, 231.63360660315848, 224.80555775875078, 53.8878015140101, 363.1337726422758, 49.88678924815549, 83.42607784523415, 197.67457639917225, 0.8095750085036049, 236.19499317756217, 125.82136706400911, 145.37820621333208, 175.06807534358308, 112.71810651258501, 178.71358765457904, 295.71081358429086, 205.78587964108902, 245.3287379376648, 41.28157573057993, 227.77262334481927, 87.61371493379434, 28.947895416923608, 25.032737811793364, 262.50889459872593, 118.7677388799885, 148.27755581755284, 146.29068099137342, 111.99211236605541, 74.04618068570325, 79.88764662296025, 64.73392563711667, 93.19313961633351, 159.52641431771616, 151.34477635891426, 135.54375008627727, 266.57995296985644, 36.22487173762957, 125.53143452909264, 14.00174168468998, 222.31255611152798, 77.62116222689338, 179.128195712601, 47.74768889513889, 160.4271505466928, 149.40205305853192, 160.76367000778794, 189.27425936953304, 231.047443698604, 179.9107984175313, 126.48766984505185, 239.86468453658333, 81.44202396096203, 116.29812665153626, 179.894417370819, 137.87998779907292, 246.89954747750303, 23.5098428461458, 28.962474974909796, 83.06066043612478, 261.14959339019845, 54.08447567178524, 235.87752479095155, 37.549092781394805, 6.601536845713264, 312.5717403637844, 240.50705248594798, 156.24044984792147, 118.03482472977441, 10.639135538784075, 55.38883607447565, 171.64423427966705, 250.58771935914785, 220.794823207916, 203.21642984526392, 187.72889771631026, 68.56327557993345, 112.04371717153323, 209.3470438666776, 105.21690317827083, 123.52197049761097, 158.48968680064516, 34.590604504258344, 124.53949699892502, 96.6425407145709, 114.48348878477927, 95.88438462129916, 351.1390697446112, 312.8428851123516, 0.8119454827363224, 26.094491525908875, 142.70835326527936, 9.698748733114098, 33.10316681638883, 204.03313783575476, 207.98518897085467, 154.54762856827438, 45.480505433003906, 120.14817964164261, 336.2263756698899, 55.439942656541305, 2.330727118899154, 265.27914220081203, 215.5906772758631, 184.40500203954025, 81.84225120567844, 174.62666752442408, 71.05388177457174, 130.01623078289018]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.9316796242775585, "mean_inference_ms": 6.417302796292294, "mean_action_processing_ms": 3.9993195939639126, "mean_env_wait_ms": 14.433851921398755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025724411010742188, "StateBufferConnector_ms": 0.019048690795898438, "ViewRequirementAgentConnector_ms": 0.3199273347854614}, "num_episodes": 24, "episode_return_max": 309.85431428277894, "episode_return_min": 19.41993357517375, "episode_return_mean": 131.54558845561073, "episodes_this_iter": 24}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500480, "num_agent_steps_trained": 1500480, "num_env_steps_sampled": 375120, "num_env_steps_trained": 375120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 58.74499936435977, "num_env_steps_trained_throughput_per_sec": 58.74499936435977, "timesteps_total": 375120, "num_env_steps_sampled_lifetime": 375120, "num_agent_steps_sampled_lifetime": 1500480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1500480, "timers": {"training_iteration_time_ms": 60096.971, "restore_workers_time_ms": 7.366, "training_step_time_ms": 60084.237, "sample_time_ms": 4352.997, "learn_time_ms": 54637.787, "learn_throughput": 73.209, "synch_weights_time_ms": 1039.481}, "counters": {"num_env_steps_sampled": 375120, "num_env_steps_trained": 375120, "num_agent_steps_sampled": 1500480, "num_agent_steps_trained": 1500480}, "done": false, "training_iteration": 93, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-52-02", "timestamp": 1724152922, "time_this_iter_s": 68.27262902259827, "time_total_s": 5359.072436332703, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120bceee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5359.072436332703, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 59.26425855513308, "ram_util_percent": 85.8467680608365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.703248110271634, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.085570867982491, "policy_loss": -0.019995900932773356, "vf_loss": 7.1026973285372295, "vf_explained_var": 0.37930643202135805, "kl": 0.014347166745558814, "entropy": 0.6537354585354921, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.938104794012807, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.813909576052711, "policy_loss": -0.015192497433927008, "vf_loss": 5.827061554237648, "vf_explained_var": 0.18485173617721234, "kl": 0.010202616888650314, "entropy": 0.5983068207111308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 379120, "num_env_steps_trained": 379120, "num_agent_steps_sampled": 1516480, "num_agent_steps_trained": 1516480}, "env_runners": {"episode_reward_max": 345.4000000000001, "episode_reward_min": 19.41993357517375, "episode_reward_mean": 134.11848367576715, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -375.36651251310263, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 363.1337726422758}, "policy_reward_mean": {"prey_policy": -66.68461649088223, "predator_policy": 133.7438583287658}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.32788438757655, 60.168507902926955, 155.7102054850359, 61.77296752223821, 70.64283884722708, 199.75692572862312, 186.98697186661843, 172.02360132976298, 81.39037049220079, 109.83512382682568, 72.8000000000003, 220.425416652123, 138.1404424094987, 165.69591607299023, 154.43011646645462, 19.41993357517375, 153.09597181420972, 139.5, 27.23368228363746, 172.4999999999995, 54.859931681382854, 116.18456932483886, 122.64111190314364, 145.6055229809055, 86.23181361660009, 123.49999999999972, 90.87570908305584, 104.16371515384536, 123.30120634254223, 135.08305262735036, 209.47969595850776, 194.87455159064837, 218.5, 224.6939433416879, 115.40113113299387, 106.70773895578424, 91.94984527783188, 188.50781471436179, 154.65514467869457, 123.6, 40.52494995370747, 189.05064491241305, 147.97970299779126, 171.96174254465978, 202.10958629957315, 167.77041340706327, 47.19084686190058, 134.80401234583888, 184.80628932143821, 233.28031232181522, 271.67353296808085, 98.68360761306532, 103.32415593477988, 137.09475368277128, 47.825477709031716, 53.28732463425837, 195.4258450616467, 59.07892245910974, 55.54669382863845, 172.4999999999995, 37.916886206535395, 25.313461184352725, 127.14119780844015, 92.1691502399341, 114.52924288626912, 43.57140389217489, 96.51118693058677, 21.08530490418753, 135.93108044568513, 294.05965955197115, 35.78328925262632, 50.815288663271225, 309.85431428277894, 75.59999999999997, 214.51027144451328, 222.6936591280305, 238.0342740684051, 52.50464783954048, 198.2, 238.09767570107562, 77.19999999999996, 45.5247740090508, 118.18060853386082, 159.49999999999963, 105.9588118765553, 169.1918387900911, 212.88660031209218, 124.35788675194063, 147.87888729653457, 101.31656983176941, 80.51541801303371, 345.4000000000001, 116.54044659459636, 183.69999999999987, 70.46587544981998, 133.0068819219448, 195.01420465691245, 199.11179593856724, 211.13573098126068, 34.047852303427945], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-252.50327143412414, 101.97951717095317, -3.6525653400381772, -282.49377039454345, 18.30939348306546, -133.80298986854126, -238.25413510939043, -34.59494606942796, -46.009259428436266, -6.806730212048745, 118.90199252772352, -222.15141243748025, 125.7654905928298, -195.4290355340844, 90.93942236806623, -161.60368083482317, -167.93962405934835, 10.608056626818223, -143.5553177074208, -110.87214629008989, -1.8213105017037599, -33.9809592875074, -208.1869676958417, 134.6742319839413, -221.02613330269338, -42.10321157965783, 124.74709338084698, -99.02622816589725, -244.2451810979079, 94.99660223543964, -22.305493445100502, -269.2442219791426, -347.6872755049857, -52.379117698331704, 79.84022570657703, -269.6461709990884, -41.834103883809455, -149.66310336453105, -19.381709795387977, 78.69873662396772, -97.71671049366908, -225.8269019762432, 28.894633245414937, 16.732183459464096, -334.4851247351806, -13.913120187762821, -305.6235973046064, 18.169582642050532, -230.746419499362, 19.287796925186306, -64.55344645072951, 32.20208532431778, -10.621425991047499, 32.70184136909628, -104.21839036232923, -7.073649215533683, -183.61819727197675, -52.433217488020475, -214.3291679303595, 70.71886128494921, -350.05875972641667, 146.51789379449335, 80.71865848268315, -166.94476113644112, 196.3904249914964, -214.89499317756238, 53.35962124549371, -99.86525118114659, 45.68528252574934, -218.0703332489235, -74.60748391669887, -293.10917836638674, -140.65555147696674, -218.5092208239555, 123.79665975001538, -204.34304411105282, 17.344999783616302, 20.74853454436038, 97.66726218820672, -261.60889459872595, -183.23999807750602, -43.28034666632799, 124.06367339757546, -193.29582184259118, -30.80954696577472, 24.855422654903016, 98.32516483007221, -84.29048753886264, -64.2823887229586, -44.47921565409869, -201.14276991763916, -33.21051973143116, 5.854114371101762, -120.41957377592412, 114.33519802895007, -215.8454834793292, -37.72286551636233, -34.220203101693926, 180.1070277515072, -155.0015548715236, -224.6483364284103, 186.1561463301718, -330.84552668358225, 9.207431228512993, -149.62652585761262, -53.447786470191204, -230.96468453658366, 46.75272972180935, -9.780255908814413, -238.58681040450927, -195.1448942071324, -136.34731643518577, 18.07018613385724, 124.88334110673424, -31.981737977015108, -253.14959339019873, -25.647541929636734, -208.76776470446177, 115.65090721860523, 12.698463154286701, -156.41916430823358, -358.74274233496385, -129.8675025748312, -119.09431081851284, 6.827314932087875, 54.28591126309289, -72.91878578916953, -257.1440176097109, -87.92329598676938, -221.55871418014164, -167.8216697483177, -44.89909965575192, -103.68837624164763, -121.19119786597747, -71.33401972731232, -136.31954904438317, -66.81150268213457, 9.662291822916364, -116.93107980352359, 189.80870164199857, -150.12443804740985, -24.460146106042536, -375.36651251310263, -237.80015368058952, 109.2055084740912, 173.74236880004256, -96.80710199839368, 20.000000000000014, -145.9034136200329, 123.27738041240262, -49.483462301820566, -90.35569610927794, -127.59441100624142, 200.0, -102.79295283149871, -236.36871765539286, 195.66927288110085, -265.07914220081204, -58.460356195448156, -103.4376474188795, -19.37918663559782, -159.88973209450478, -90.09174358765782, -65.4535949607536, -117.74130099456275, 44.956909824326786, 43.033510696553414, 20.276893378042345, -154.46391930068106, -176.43583789834503, 73.13768731200322, -175.42863976787754, 108.63769329981989, 16.986949977839416, -56.65934570830167, -114.4854597553917, 16.001189487946757, -9.53431583577305, -214.26032040642423, 80.97972473596951, -162.12640683595782, -40.32654840054187, 115.44220802271559, 180.7816031910419, 11.21864087368393, -343.5844897593849, 11.753558886444523, 15.159532691905408, -118.9572713254901, -105.5428622138779, -1.5365711980433665, 26.668064871631756, -21.19029138105462, 167.5911317447596, 128.03129466265727, -174.67506900927808, -27.806943058502867, -60.095856440663454, -44.27373857607972, -130.570442557523], "policy_predator_policy_reward": [257.403271434124, 43.448367216623474, 167.78319068895178, 178.5316529485568, 217.07685602495653, 54.12694584555521, 146.44237721181227, 188.17967148924456, 51.26012850810498, 72.19869997960717, 169.18819855673974, 133.8181470816402, 160.2357207924895, 96.41479601538342, 51.76253705785696, 190.92532273866306, 154.28437513894897, 84.43756278578184, 161.41233343838076, 202.85025438595488, 41.096432931583834, 67.50583685762763, 112.05518072051615, 181.88297164350703, 199.76698808300816, 201.50279920884168, 18.130068984699093, 121.84498187334137, 57.58712545419114, 246.0915698747318, 38.75500836810234, 272.21464063131526, 247.36886480706625, 305.7935002104611, 59.65977429342301, 269.6461709990884, 23.098411671763973, 195.6324778602138, 38.10695549243518, 75.07601767898525, 242.22631058951558, 136.17723356177862, 64.76781654053603, 5.789936079423872, 194.90042267770005, 276.13893414838725, 248.27489870656524, 184.78463893689622, 46.592993611454894, 251.09744257932135, 82.8534464507287, 72.99791467568204, 68.79529370500731, 0.0, 46.01674507722463, 169.43900965448398, 127.71901449938092, 231.63360660315848, 224.80555775875078, 53.8878015140101, 363.1337726422758, 49.88678924815549, 83.42607784523415, 197.67457639917225, 0.8095750085036049, 236.19499317756217, 125.82136706400911, 145.37820621333208, 175.06807534358308, 112.71810651258501, 178.71358765457904, 295.71081358429086, 205.78587964108902, 245.3287379376648, 41.28157573057993, 227.77262334481927, 87.61371493379434, 28.947895416923608, 25.032737811793364, 262.50889459872593, 118.7677388799885, 148.27755581755284, 146.29068099137342, 111.99211236605541, 74.04618068570325, 79.88764662296025, 64.73392563711667, 93.19313961633351, 159.52641431771616, 151.34477635891426, 135.54375008627727, 266.57995296985644, 36.22487173762957, 125.53143452909264, 14.00174168468998, 222.31255611152798, 77.62116222689338, 179.128195712601, 47.74768889513889, 160.4271505466928, 149.40205305853192, 160.76367000778794, 189.27425936953304, 231.047443698604, 179.9107984175313, 126.48766984505185, 239.86468453658333, 81.44202396096203, 116.29812665153626, 179.894417370819, 137.87998779907292, 246.89954747750303, 23.5098428461458, 28.962474974909796, 83.06066043612478, 261.14959339019845, 54.08447567178524, 235.87752479095155, 37.549092781394805, 6.601536845713264, 312.5717403637844, 240.50705248594798, 156.24044984792147, 118.03482472977441, 10.639135538784075, 55.38883607447565, 171.64423427966705, 250.58771935914785, 220.794823207916, 203.21642984526392, 187.72889771631026, 68.56327557993345, 112.04371717153323, 209.3470438666776, 105.21690317827083, 123.52197049761097, 158.48968680064516, 34.590604504258344, 124.53949699892502, 96.6425407145709, 114.48348878477927, 95.88438462129916, 351.1390697446112, 312.8428851123516, 0.8119454827363224, 26.094491525908875, 142.70835326527936, 9.698748733114098, 33.10316681638883, 204.03313783575476, 207.98518897085467, 154.54762856827438, 45.480505433003906, 120.14817964164261, 336.2263756698899, 55.439942656541305, 2.330727118899154, 265.27914220081203, 215.5906772758631, 184.40500203954025, 81.84225120567844, 174.62666752442408, 71.05388177457174, 130.01623078289018, 134.7750951166592, 56.18990458743713, 53.16648930344668, 43.0231066219577, 195.5645386374273, 241.29403043815404, 201.67444268523374, 69.80834856073156, 33.98252152886313, 53.279435505570255, 108.33437347978865, 187.16831873584528, 119.3331263478263, 22.078887296535544, 177.97650013127748, 56.62066537094646, 145.88966050343467, 137.07871274609886, 41.65779197728443, 7.518396808958049, 236.24786911292944, 212.65842636736798, 44.024408158213866, 112.76250026343628, 99.73187715547449, 195.2341318337124, 84.31334773954555, 23.56204050881107, 46.51704612266757, 2.096318170540769, 54.49438740091129, 191.26118288427668, 159.20618056510045, 139.8323499153266, 76.7237099214382, 132.1683235155923]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.921975301034864, "mean_inference_ms": 6.42286649922914, "mean_action_processing_ms": 3.777464844992295, "mean_env_wait_ms": 14.478431999078033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025693416595458984, "StateBufferConnector_ms": 0.018833637237548828, "ViewRequirementAgentConnector_ms": 0.326493501663208}, "num_episodes": 18, "episode_return_max": 345.4000000000001, "episode_return_min": 19.41993357517375, "episode_return_mean": 134.11848367576715, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1516480, "num_agent_steps_trained": 1516480, "num_env_steps_sampled": 379120, "num_env_steps_trained": 379120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.7966126528485, "num_env_steps_trained_throughput_per_sec": 73.7966126528485, "timesteps_total": 379120, "num_env_steps_sampled_lifetime": 379120, "num_agent_steps_sampled_lifetime": 1516480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1516480, "timers": {"training_iteration_time_ms": 59374.615, "restore_workers_time_ms": 7.369, "training_step_time_ms": 59361.871, "sample_time_ms": 4256.14, "learn_time_ms": 54011.392, "learn_throughput": 74.058, "synch_weights_time_ms": 1041.187}, "counters": {"num_env_steps_sampled": 379120, "num_env_steps_trained": 379120, "num_agent_steps_sampled": 1516480, "num_agent_steps_trained": 1516480}, "done": false, "training_iteration": 94, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-52-57", "timestamp": 1724152977, "time_this_iter_s": 54.240572929382324, "time_total_s": 5413.313009262085, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120b1edc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5413.313009262085, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 54.34805194805195, "ram_util_percent": 83.28831168831168}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.094737983885265, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.11605792928625, "policy_loss": -0.014086042508167565, "vf_loss": 7.127848860826441, "vf_explained_var": 0.3239985255337266, "kl": 0.011475483714430421, "entropy": 0.6189489574186385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.987908227544613, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.045039524350847, "policy_loss": -0.015206193520993033, "vf_loss": 6.05823129295672, "vf_explained_var": 0.13902652717771985, "kl": 0.010072076128963282, "entropy": 0.5716912550900979, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 383120, "num_env_steps_trained": 383120, "num_agent_steps_sampled": 1532480, "num_agent_steps_trained": 1532480}, "env_runners": {"episode_reward_max": 353.4607603138288, "episode_reward_min": 21.08530490418753, "episode_reward_mean": 136.99518533973924, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -375.36651251310263, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 363.1337726422758}, "policy_reward_mean": {"prey_policy": -67.13864426577368, "predator_policy": 135.6362369356433}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.5, 27.23368228363746, 172.4999999999995, 54.859931681382854, 116.18456932483886, 122.64111190314364, 145.6055229809055, 86.23181361660009, 123.49999999999972, 90.87570908305584, 104.16371515384536, 123.30120634254223, 135.08305262735036, 209.47969595850776, 194.87455159064837, 218.5, 224.6939433416879, 115.40113113299387, 106.70773895578424, 91.94984527783188, 188.50781471436179, 154.65514467869457, 123.6, 40.52494995370747, 189.05064491241305, 147.97970299779126, 171.96174254465978, 202.10958629957315, 167.77041340706327, 47.19084686190058, 134.80401234583888, 184.80628932143821, 233.28031232181522, 271.67353296808085, 98.68360761306532, 103.32415593477988, 137.09475368277128, 47.825477709031716, 53.28732463425837, 195.4258450616467, 59.07892245910974, 55.54669382863845, 172.4999999999995, 37.916886206535395, 25.313461184352725, 127.14119780844015, 92.1691502399341, 114.52924288626912, 43.57140389217489, 96.51118693058677, 21.08530490418753, 135.93108044568513, 294.05965955197115, 35.78328925262632, 50.815288663271225, 309.85431428277894, 75.59999999999997, 214.51027144451328, 222.6936591280305, 238.0342740684051, 52.50464783954048, 198.2, 238.09767570107562, 77.19999999999996, 45.5247740090508, 118.18060853386082, 159.49999999999963, 105.9588118765553, 169.1918387900911, 212.88660031209218, 124.35788675194063, 147.87888729653457, 101.31656983176941, 80.51541801303371, 345.4000000000001, 116.54044659459636, 183.69999999999987, 70.46587544981998, 133.0068819219448, 195.01420465691245, 199.11179593856724, 211.13573098126068, 34.047852303427945, 177.78958410839735, 353.4607603138288, 129.15448070380813, 156.00874969816837, 52.78107754750224, 222.20062534540298, 150.99648186762644, 171.97889113626704, 87.241192901114, 110.4030334977599, 86.77952856640131, 72.76502269977141, 60.09581454349698, 170.5999999999995, 206.76277062979713, 39.01092407035958, 212.26442314699048], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [79.84022570657703, -269.6461709990884, -41.834103883809455, -149.66310336453105, -19.381709795387977, 78.69873662396772, -97.71671049366908, -225.8269019762432, 28.894633245414937, 16.732183459464096, -334.4851247351806, -13.913120187762821, -305.6235973046064, 18.169582642050532, -230.746419499362, 19.287796925186306, -64.55344645072951, 32.20208532431778, -10.621425991047499, 32.70184136909628, -104.21839036232923, -7.073649215533683, -183.61819727197675, -52.433217488020475, -214.3291679303595, 70.71886128494921, -350.05875972641667, 146.51789379449335, 80.71865848268315, -166.94476113644112, 196.3904249914964, -214.89499317756238, 53.35962124549371, -99.86525118114659, 45.68528252574934, -218.0703332489235, -74.60748391669887, -293.10917836638674, -140.65555147696674, -218.5092208239555, 123.79665975001538, -204.34304411105282, 17.344999783616302, 20.74853454436038, 97.66726218820672, -261.60889459872595, -183.23999807750602, -43.28034666632799, 124.06367339757546, -193.29582184259118, -30.80954696577472, 24.855422654903016, 98.32516483007221, -84.29048753886264, -64.2823887229586, -44.47921565409869, -201.14276991763916, -33.21051973143116, 5.854114371101762, -120.41957377592412, 114.33519802895007, -215.8454834793292, -37.72286551636233, -34.220203101693926, 180.1070277515072, -155.0015548715236, -224.6483364284103, 186.1561463301718, -330.84552668358225, 9.207431228512993, -149.62652585761262, -53.447786470191204, -230.96468453658366, 46.75272972180935, -9.780255908814413, -238.58681040450927, -195.1448942071324, -136.34731643518577, 18.07018613385724, 124.88334110673424, -31.981737977015108, -253.14959339019873, -25.647541929636734, -208.76776470446177, 115.65090721860523, 12.698463154286701, -156.41916430823358, -358.74274233496385, -129.8675025748312, -119.09431081851284, 6.827314932087875, 54.28591126309289, -72.91878578916953, -257.1440176097109, -87.92329598676938, -221.55871418014164, -167.8216697483177, -44.89909965575192, -103.68837624164763, -121.19119786597747, -71.33401972731232, -136.31954904438317, -66.81150268213457, 9.662291822916364, -116.93107980352359, 189.80870164199857, -150.12443804740985, -24.460146106042536, -375.36651251310263, -237.80015368058952, 109.2055084740912, 173.74236880004256, -96.80710199839368, 20.000000000000014, -145.9034136200329, 123.27738041240262, -49.483462301820566, -90.35569610927794, -127.59441100624142, 200.0, -102.79295283149871, -236.36871765539286, 195.66927288110085, -265.07914220081204, -58.460356195448156, -103.4376474188795, -19.37918663559782, -159.88973209450478, -90.09174358765782, -65.4535949607536, -117.74130099456275, 44.956909824326786, 43.033510696553414, 20.276893378042345, -154.46391930068106, -176.43583789834503, 73.13768731200322, -175.42863976787754, 108.63769329981989, 16.986949977839416, -56.65934570830167, -114.4854597553917, 16.001189487946757, -9.53431583577305, -214.26032040642423, 80.97972473596951, -162.12640683595782, -40.32654840054187, 115.44220802271559, 180.7816031910419, 11.21864087368393, -343.5844897593849, 11.753558886444523, 15.159532691905408, -118.9572713254901, -105.5428622138779, -1.5365711980433665, 26.668064871631756, -21.19029138105462, 167.5911317447596, 128.03129466265727, -174.67506900927808, -27.806943058502867, -60.095856440663454, -44.27373857607972, -130.570442557523, 44.53759795331622, -154.85579429526572, 30.57318477089633, 185.80083671592502, 25.254115608283115, -86.74321973155058, -165.14364868467453, -149.75944012077602, -244.65872855655533, -62.29728653847758, 41.55760046369484, -290.70858656634215, -157.94863853832507, -93.1394287398258, -230.4084984595345, 100.4322187126586, -89.64990253839642, -224.49657631406146, -147.39749300060092, 31.4803534248919, -152.07950634399901, -149.94843072372578, -197.69030194442252, -61.45160623493583, -23.40410376825624, -209.58777518008736, 93.11850859937775, 8.284591863684042, -191.80877066556386, 136.07493494521913, -231.51799522087683, -220.16315610085576, 105.22346603431156, -79.0372604123209], "policy_predator_policy_reward": [59.65977429342301, 269.6461709990884, 23.098411671763973, 195.6324778602138, 38.10695549243518, 75.07601767898525, 242.22631058951558, 136.17723356177862, 64.76781654053603, 5.789936079423872, 194.90042267770005, 276.13893414838725, 248.27489870656524, 184.78463893689622, 46.592993611454894, 251.09744257932135, 82.8534464507287, 72.99791467568204, 68.79529370500731, 0.0, 46.01674507722463, 169.43900965448398, 127.71901449938092, 231.63360660315848, 224.80555775875078, 53.8878015140101, 363.1337726422758, 49.88678924815549, 83.42607784523415, 197.67457639917225, 0.8095750085036049, 236.19499317756217, 125.82136706400911, 145.37820621333208, 175.06807534358308, 112.71810651258501, 178.71358765457904, 295.71081358429086, 205.78587964108902, 245.3287379376648, 41.28157573057993, 227.77262334481927, 87.61371493379434, 28.947895416923608, 25.032737811793364, 262.50889459872593, 118.7677388799885, 148.27755581755284, 146.29068099137342, 111.99211236605541, 74.04618068570325, 79.88764662296025, 64.73392563711667, 93.19313961633351, 159.52641431771616, 151.34477635891426, 135.54375008627727, 266.57995296985644, 36.22487173762957, 125.53143452909264, 14.00174168468998, 222.31255611152798, 77.62116222689338, 179.128195712601, 47.74768889513889, 160.4271505466928, 149.40205305853192, 160.76367000778794, 189.27425936953304, 231.047443698604, 179.9107984175313, 126.48766984505185, 239.86468453658333, 81.44202396096203, 116.29812665153626, 179.894417370819, 137.87998779907292, 246.89954747750303, 23.5098428461458, 28.962474974909796, 83.06066043612478, 261.14959339019845, 54.08447567178524, 235.87752479095155, 37.549092781394805, 6.601536845713264, 312.5717403637844, 240.50705248594798, 156.24044984792147, 118.03482472977441, 10.639135538784075, 55.38883607447565, 171.64423427966705, 250.58771935914785, 220.794823207916, 203.21642984526392, 187.72889771631026, 68.56327557993345, 112.04371717153323, 209.3470438666776, 105.21690317827083, 123.52197049761097, 158.48968680064516, 34.590604504258344, 124.53949699892502, 96.6425407145709, 114.48348878477927, 95.88438462129916, 351.1390697446112, 312.8428851123516, 0.8119454827363224, 26.094491525908875, 142.70835326527936, 9.698748733114098, 33.10316681638883, 204.03313783575476, 207.98518897085467, 154.54762856827438, 45.480505433003906, 120.14817964164261, 336.2263756698899, 55.439942656541305, 2.330727118899154, 265.27914220081203, 215.5906772758631, 184.40500203954025, 81.84225120567844, 174.62666752442408, 71.05388177457174, 130.01623078289018, 134.7750951166592, 56.18990458743713, 53.16648930344668, 43.0231066219577, 195.5645386374273, 241.29403043815404, 201.67444268523374, 69.80834856073156, 33.98252152886313, 53.279435505570255, 108.33437347978865, 187.16831873584528, 119.3331263478263, 22.078887296535544, 177.97650013127748, 56.62066537094646, 145.88966050343467, 137.07871274609886, 41.65779197728443, 7.518396808958049, 236.24786911292944, 212.65842636736798, 44.024408158213866, 112.76250026343628, 99.73187715547449, 195.2341318337124, 84.31334773954555, 23.56204050881107, 46.51704612266757, 2.096318170540769, 54.49438740091129, 191.26118288427668, 159.20618056510045, 139.8323499153266, 76.7237099214382, 132.1683235155923, 44.22571455454862, 243.88206589579823, 66.93115961082796, 70.1555792161795, 100.20113624457714, 90.44244858249883, 270.99669760573806, 199.915140897881, 304.6174003590265, 55.11969228350827, 286.5566527080104, 184.79495874003993, 258.23026429826575, 143.85428484751174, 124.96895234514926, 176.98621853799364, 225.5742194315528, 175.81345232201883, 102.09150560604245, 124.22866746742642, 65.86388885418691, 322.9435767799388, 210.43552404688538, 121.47140683224376, 66.38239685123594, 226.7052966406043, 57.981491400622275, 11.215408136315922, 233.4533604689734, 29.043245881168446, 234.99356868995648, 255.69850670213543, 85.85569101182604, 100.22252651317382]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.870957542260775, "mean_inference_ms": 6.3939296466243665, "mean_action_processing_ms": 3.937401925239844, "mean_env_wait_ms": 14.483503072887295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02532482147216797, "StateBufferConnector_ms": 0.018280029296875, "ViewRequirementAgentConnector_ms": 0.25290417671203613}, "num_episodes": 17, "episode_return_max": 353.4607603138288, "episode_return_min": 21.08530490418753, "episode_return_mean": 136.99518533973924, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1532480, "num_agent_steps_trained": 1532480, "num_env_steps_sampled": 383120, "num_env_steps_trained": 383120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.27593133312423, "num_env_steps_trained_throughput_per_sec": 74.27593133312423, "timesteps_total": 383120, "num_env_steps_sampled_lifetime": 383120, "num_agent_steps_sampled_lifetime": 1532480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1532480, "timers": {"training_iteration_time_ms": 58964.625, "restore_workers_time_ms": 7.369, "training_step_time_ms": 58951.887, "sample_time_ms": 4110.27, "learn_time_ms": 53748.29, "learn_throughput": 74.421, "synch_weights_time_ms": 1040.063}, "counters": {"num_env_steps_sampled": 383120, "num_env_steps_trained": 383120, "num_agent_steps_sampled": 1532480, "num_agent_steps_trained": 1532480}, "done": false, "training_iteration": 95, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-53-51", "timestamp": 1724153031, "time_this_iter_s": 53.91187405586243, "time_total_s": 5467.224883317947, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120bce940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5467.224883317947, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 51.54342105263157, "ram_util_percent": 83.35263157894735}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.176771380409361, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.241666920475228, "policy_loss": -0.020895555181300672, "vf_loss": 6.259785553765675, "vf_explained_var": 0.5260121970580368, "kl": 0.013884711256571034, "entropy": 0.6536273121203064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 181965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.440616822684253, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.1778043697750755, "policy_loss": -0.014025957649327302, "vf_loss": 5.1902354651658, "vf_explained_var": 0.21689970540621925, "kl": 0.007974318397679814, "entropy": 0.6441701838736812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 181965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 387120, "num_env_steps_trained": 387120, "num_agent_steps_sampled": 1548480, "num_agent_steps_trained": 1548480}, "env_runners": {"episode_reward_max": 353.4607603138288, "episode_reward_min": -28.386353167323772, "episode_reward_mean": 138.1598270843711, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -375.36651251310263, "predator_policy": 0.8119454827363224}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 351.1390697446112}, "policy_reward_mean": {"prey_policy": -63.370633596443376, "predator_policy": 132.4505471386289}, "custom_metrics": {}, "hist_stats": {"episode_reward": [123.6, 40.52494995370747, 189.05064491241305, 147.97970299779126, 171.96174254465978, 202.10958629957315, 167.77041340706327, 47.19084686190058, 134.80401234583888, 184.80628932143821, 233.28031232181522, 271.67353296808085, 98.68360761306532, 103.32415593477988, 137.09475368277128, 47.825477709031716, 53.28732463425837, 195.4258450616467, 59.07892245910974, 55.54669382863845, 172.4999999999995, 37.916886206535395, 25.313461184352725, 127.14119780844015, 92.1691502399341, 114.52924288626912, 43.57140389217489, 96.51118693058677, 21.08530490418753, 135.93108044568513, 294.05965955197115, 35.78328925262632, 50.815288663271225, 309.85431428277894, 75.59999999999997, 214.51027144451328, 222.6936591280305, 238.0342740684051, 52.50464783954048, 198.2, 238.09767570107562, 77.19999999999996, 45.5247740090508, 118.18060853386082, 159.49999999999963, 105.9588118765553, 169.1918387900911, 212.88660031209218, 124.35788675194063, 147.87888729653457, 101.31656983176941, 80.51541801303371, 345.4000000000001, 116.54044659459636, 183.69999999999987, 70.46587544981998, 133.0068819219448, 195.01420465691245, 199.11179593856724, 211.13573098126068, 34.047852303427945, 177.78958410839735, 353.4607603138288, 129.15448070380813, 156.00874969816837, 52.78107754750224, 222.20062534540298, 150.99648186762644, 171.97889113626704, 87.241192901114, 110.4030334977599, 86.77952856640131, 72.76502269977141, 60.09581454349698, 170.5999999999995, 206.76277062979713, 39.01092407035958, 212.26442314699048, 346.7682399481341, -28.386353167323772, 138.350714616974, 134.94490739493102, 119.59482541239336, 214.32798006447385, 162.98854005671504, 73.31721951841384, -16.537335168560787, 233.5, 163.09999999999974, 196.78257717363923, 151.94850643160157, 187.9773770141705, 84.38813400356167, 151.13898526505008, 60.400000000000304, 38.875373104800985, 223.5, 1.7999246601230705, 240.71207029251485, 183.42266848938766], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [97.66726218820672, -261.60889459872595, -183.23999807750602, -43.28034666632799, 124.06367339757546, -193.29582184259118, -30.80954696577472, 24.855422654903016, 98.32516483007221, -84.29048753886264, -64.2823887229586, -44.47921565409869, -201.14276991763916, -33.21051973143116, 5.854114371101762, -120.41957377592412, 114.33519802895007, -215.8454834793292, -37.72286551636233, -34.220203101693926, 180.1070277515072, -155.0015548715236, -224.6483364284103, 186.1561463301718, -330.84552668358225, 9.207431228512993, -149.62652585761262, -53.447786470191204, -230.96468453658366, 46.75272972180935, -9.780255908814413, -238.58681040450927, -195.1448942071324, -136.34731643518577, 18.07018613385724, 124.88334110673424, -31.981737977015108, -253.14959339019873, -25.647541929636734, -208.76776470446177, 115.65090721860523, 12.698463154286701, -156.41916430823358, -358.74274233496385, -129.8675025748312, -119.09431081851284, 6.827314932087875, 54.28591126309289, -72.91878578916953, -257.1440176097109, -87.92329598676938, -221.55871418014164, -167.8216697483177, -44.89909965575192, -103.68837624164763, -121.19119786597747, -71.33401972731232, -136.31954904438317, -66.81150268213457, 9.662291822916364, -116.93107980352359, 189.80870164199857, -150.12443804740985, -24.460146106042536, -375.36651251310263, -237.80015368058952, 109.2055084740912, 173.74236880004256, -96.80710199839368, 20.000000000000014, -145.9034136200329, 123.27738041240262, -49.483462301820566, -90.35569610927794, -127.59441100624142, 200.0, -102.79295283149871, -236.36871765539286, 195.66927288110085, -265.07914220081204, -58.460356195448156, -103.4376474188795, -19.37918663559782, -159.88973209450478, -90.09174358765782, -65.4535949607536, -117.74130099456275, 44.956909824326786, 43.033510696553414, 20.276893378042345, -154.46391930068106, -176.43583789834503, 73.13768731200322, -175.42863976787754, 108.63769329981989, 16.986949977839416, -56.65934570830167, -114.4854597553917, 16.001189487946757, -9.53431583577305, -214.26032040642423, 80.97972473596951, -162.12640683595782, -40.32654840054187, 115.44220802271559, 180.7816031910419, 11.21864087368393, -343.5844897593849, 11.753558886444523, 15.159532691905408, -118.9572713254901, -105.5428622138779, -1.5365711980433665, 26.668064871631756, -21.19029138105462, 167.5911317447596, 128.03129466265727, -174.67506900927808, -27.806943058502867, -60.095856440663454, -44.27373857607972, -130.570442557523, 44.53759795331622, -154.85579429526572, 30.57318477089633, 185.80083671592502, 25.254115608283115, -86.74321973155058, -165.14364868467453, -149.75944012077602, -244.65872855655533, -62.29728653847758, 41.55760046369484, -290.70858656634215, -157.94863853832507, -93.1394287398258, -230.4084984595345, 100.4322187126586, -89.64990253839642, -224.49657631406146, -147.39749300060092, 31.4803534248919, -152.07950634399901, -149.94843072372578, -197.69030194442252, -61.45160623493583, -23.40410376825624, -209.58777518008736, 93.11850859937775, 8.284591863684042, -191.80877066556386, 136.07493494521913, -231.51799522087683, -220.16315610085576, 105.22346603431156, -79.0372604123209, 196.1519852873995, -47.956800825208944, -299.5476331002911, -167.9984559086815, -137.1729308790483, 36.02793214177343, 9.628932215825103, -177.27461533768152, -47.146517272980134, -157.96569895447516, 47.33802643930976, -200.26548237119746, -185.0378829847856, 55.889908476039906, -223.46299529868028, -121.40680985555574, -167.37207473094563, -106.53798425826807, 172.77730440809069, -30.741612177431815, -147.0883061376906, 116.47239780344114, -101.72251181582723, 53.347167945697734, 127.00174783178699, -105.98901778008204, 123.30424675375664, -78.7186641393285, 2.0740005105987436, -47.268552271038274, -9.446644271142407, -209.51219582640962, 2.1032850897435504, 5.078866227701608, -8.612022920551993, -214.78111278413388, -37.55684656020199, 6.871507674828592, -275.2289460062544, -64.60082651772109, -249.3566138064934, 181.38785145071347, 7.241065496701072, -14.259349511495714], "policy_predator_policy_reward": [25.032737811793364, 262.50889459872593, 118.7677388799885, 148.27755581755284, 146.29068099137342, 111.99211236605541, 74.04618068570325, 79.88764662296025, 64.73392563711667, 93.19313961633351, 159.52641431771616, 151.34477635891426, 135.54375008627727, 266.57995296985644, 36.22487173762957, 125.53143452909264, 14.00174168468998, 222.31255611152798, 77.62116222689338, 179.128195712601, 47.74768889513889, 160.4271505466928, 149.40205305853192, 160.76367000778794, 189.27425936953304, 231.047443698604, 179.9107984175313, 126.48766984505185, 239.86468453658333, 81.44202396096203, 116.29812665153626, 179.894417370819, 137.87998779907292, 246.89954747750303, 23.5098428461458, 28.962474974909796, 83.06066043612478, 261.14959339019845, 54.08447567178524, 235.87752479095155, 37.549092781394805, 6.601536845713264, 312.5717403637844, 240.50705248594798, 156.24044984792147, 118.03482472977441, 10.639135538784075, 55.38883607447565, 171.64423427966705, 250.58771935914785, 220.794823207916, 203.21642984526392, 187.72889771631026, 68.56327557993345, 112.04371717153323, 209.3470438666776, 105.21690317827083, 123.52197049761097, 158.48968680064516, 34.590604504258344, 124.53949699892502, 96.6425407145709, 114.48348878477927, 95.88438462129916, 351.1390697446112, 312.8428851123516, 0.8119454827363224, 26.094491525908875, 142.70835326527936, 9.698748733114098, 33.10316681638883, 204.03313783575476, 207.98518897085467, 154.54762856827438, 45.480505433003906, 120.14817964164261, 336.2263756698899, 55.439942656541305, 2.330727118899154, 265.27914220081203, 215.5906772758631, 184.40500203954025, 81.84225120567844, 174.62666752442408, 71.05388177457174, 130.01623078289018, 134.7750951166592, 56.18990458743713, 53.16648930344668, 43.0231066219577, 195.5645386374273, 241.29403043815404, 201.67444268523374, 69.80834856073156, 33.98252152886313, 53.279435505570255, 108.33437347978865, 187.16831873584528, 119.3331263478263, 22.078887296535544, 177.97650013127748, 56.62066537094646, 145.88966050343467, 137.07871274609886, 41.65779197728443, 7.518396808958049, 236.24786911292944, 212.65842636736798, 44.024408158213866, 112.76250026343628, 99.73187715547449, 195.2341318337124, 84.31334773954555, 23.56204050881107, 46.51704612266757, 2.096318170540769, 54.49438740091129, 191.26118288427668, 159.20618056510045, 139.8323499153266, 76.7237099214382, 132.1683235155923, 44.22571455454862, 243.88206589579823, 66.93115961082796, 70.1555792161795, 100.20113624457714, 90.44244858249883, 270.99669760573806, 199.915140897881, 304.6174003590265, 55.11969228350827, 286.5566527080104, 184.79495874003993, 258.23026429826575, 143.85428484751174, 124.96895234514926, 176.98621853799364, 225.5742194315528, 175.81345232201883, 102.09150560604245, 124.22866746742642, 65.86388885418691, 322.9435767799388, 210.43552404688538, 121.47140683224376, 66.38239685123594, 226.7052966406043, 57.981491400622275, 11.215408136315922, 233.4533604689734, 29.043245881168446, 234.99356868995648, 255.69850670213543, 85.85569101182604, 100.22252651317382, 45.65273282269279, 152.92032266325077, 237.4656147883656, 201.6941210532826, 149.07293087904785, 90.4227824752008, 121.4746573516416, 181.11593316514566, 208.6035011231742, 116.10354051667468, 186.50054651652277, 180.75488947983888, 140.54055691511869, 151.5959576503422, 226.9629952986802, 191.22402937396956, 143.97189820720672, 113.40082561344566, 52.896737639391226, 38.56757012994989, 20.197286029326214, 173.51862230492299, 142.66902684318643, 102.48889420058254, 10.246758599814997, 120.6890177800812, 98.21810443058936, 45.173689969152875, 91.01530002372675, 38.56738574027438, 156.91733715677825, 213.18048820582393, 39.796714910256455, 13.421133772298358, 187.55202453813922, 74.71648427134744, 140.45684656020188, 113.72849232517139, 176.1507006253517, 165.4789965587467, 128.6212018169935, 180.05963083130135, 113.56010628391338, 76.88084622026939]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.884268711769969, "mean_inference_ms": 6.399837464287341, "mean_action_processing_ms": 3.900062405551976, "mean_env_wait_ms": 14.500628186626273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009028911590576172, "StateBufferConnector_ms": 0.03142344951629639, "ViewRequirementAgentConnector_ms": 0.23871421813964844}, "num_episodes": 22, "episode_return_max": 353.4607603138288, "episode_return_min": -28.386353167323772, "episode_return_mean": 138.1598270843711, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1548480, "num_agent_steps_trained": 1548480, "num_env_steps_sampled": 387120, "num_env_steps_trained": 387120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.76073607658927, "num_env_steps_trained_throughput_per_sec": 72.76073607658927, "timesteps_total": 387120, "num_env_steps_sampled_lifetime": 387120, "num_agent_steps_sampled_lifetime": 1548480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1548480, "timers": {"training_iteration_time_ms": 58964.064, "restore_workers_time_ms": 7.369, "training_step_time_ms": 58951.321, "sample_time_ms": 4156.664, "learn_time_ms": 53699.936, "learn_throughput": 74.488, "synch_weights_time_ms": 1041.062}, "counters": {"num_env_steps_sampled": 387120, "num_env_steps_trained": 387120, "num_agent_steps_sampled": 1548480, "num_agent_steps_trained": 1548480}, "done": false, "training_iteration": 96, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-54-46", "timestamp": 1724153086, "time_this_iter_s": 55.00404977798462, "time_total_s": 5522.228933095932, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3313221f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5522.228933095932, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 52.5923076923077, "ram_util_percent": 83.34743589743587}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.433249444873244, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.400348026790316, "policy_loss": -0.0188504783074475, "vf_loss": 6.4165787918857795, "vf_explained_var": 0.44954364577298445, "kl": 0.013098575326456398, "entropy": 0.6202263935848519, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 183855.5, "diff_num_grad_updates_vs_sampler_policy": 996.9475000000093}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.50703730721953, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.83836452090551, "policy_loss": -0.018182157191679513, "vf_loss": 5.854211263303403, "vf_explained_var": 0.11708756868170683, "kl": 0.011677130173137856, "entropy": 0.5996495657023929, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 183855.5, "diff_num_grad_updates_vs_sampler_policy": 996.9475000000093}}, "num_env_steps_sampled": 391120, "num_env_steps_trained": 391120, "num_agent_steps_sampled": 1564480, "num_agent_steps_trained": 1564480}, "env_runners": {"episode_reward_max": 353.4607603138288, "episode_reward_min": -28.386353167323772, "episode_reward_mean": 130.85535136391198, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -375.36651251310263, "predator_policy": 0.8119454827363224}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 351.1390697446112}, "policy_reward_mean": {"prey_policy": -71.21832287394268, "predator_policy": 136.64599855589861}, "custom_metrics": {}, "hist_stats": {"episode_reward": [172.4999999999995, 37.916886206535395, 25.313461184352725, 127.14119780844015, 92.1691502399341, 114.52924288626912, 43.57140389217489, 96.51118693058677, 21.08530490418753, 135.93108044568513, 294.05965955197115, 35.78328925262632, 50.815288663271225, 309.85431428277894, 75.59999999999997, 214.51027144451328, 222.6936591280305, 238.0342740684051, 52.50464783954048, 198.2, 238.09767570107562, 77.19999999999996, 45.5247740090508, 118.18060853386082, 159.49999999999963, 105.9588118765553, 169.1918387900911, 212.88660031209218, 124.35788675194063, 147.87888729653457, 101.31656983176941, 80.51541801303371, 345.4000000000001, 116.54044659459636, 183.69999999999987, 70.46587544981998, 133.0068819219448, 195.01420465691245, 199.11179593856724, 211.13573098126068, 34.047852303427945, 177.78958410839735, 353.4607603138288, 129.15448070380813, 156.00874969816837, 52.78107754750224, 222.20062534540298, 150.99648186762644, 171.97889113626704, 87.241192901114, 110.4030334977599, 86.77952856640131, 72.76502269977141, 60.09581454349698, 170.5999999999995, 206.76277062979713, 39.01092407035958, 212.26442314699048, 346.7682399481341, -28.386353167323772, 138.350714616974, 134.94490739493102, 119.59482541239336, 214.32798006447385, 162.98854005671504, 73.31721951841384, -16.537335168560787, 233.5, 163.09999999999974, 196.78257717363923, 151.94850643160157, 187.9773770141705, 84.38813400356167, 151.13898526505008, 60.400000000000304, 38.875373104800985, 223.5, 1.7999246601230705, 240.71207029251485, 183.42266848938766, 174.85822150332984, -6.58498364564349, 204.2000160271781, 205.74321788967296, 37.047708777954455, 122.09999999999974, 55.59844755715738, 103.70085840065553, 76.8493440515537, 224.06669610603552, 79.23958998898084, 177.20866624705042, 37.89074510906861, -3.621936912521111, 86.38557180694423, 60.89087157432238, 55.810375614105766, 66.6662518917879, -11.151775004593528, 187.67335582863225], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [115.65090721860523, 12.698463154286701, -156.41916430823358, -358.74274233496385, -129.8675025748312, -119.09431081851284, 6.827314932087875, 54.28591126309289, -72.91878578916953, -257.1440176097109, -87.92329598676938, -221.55871418014164, -167.8216697483177, -44.89909965575192, -103.68837624164763, -121.19119786597747, -71.33401972731232, -136.31954904438317, -66.81150268213457, 9.662291822916364, -116.93107980352359, 189.80870164199857, -150.12443804740985, -24.460146106042536, -375.36651251310263, -237.80015368058952, 109.2055084740912, 173.74236880004256, -96.80710199839368, 20.000000000000014, -145.9034136200329, 123.27738041240262, -49.483462301820566, -90.35569610927794, -127.59441100624142, 200.0, -102.79295283149871, -236.36871765539286, 195.66927288110085, -265.07914220081204, -58.460356195448156, -103.4376474188795, -19.37918663559782, -159.88973209450478, -90.09174358765782, -65.4535949607536, -117.74130099456275, 44.956909824326786, 43.033510696553414, 20.276893378042345, -154.46391930068106, -176.43583789834503, 73.13768731200322, -175.42863976787754, 108.63769329981989, 16.986949977839416, -56.65934570830167, -114.4854597553917, 16.001189487946757, -9.53431583577305, -214.26032040642423, 80.97972473596951, -162.12640683595782, -40.32654840054187, 115.44220802271559, 180.7816031910419, 11.21864087368393, -343.5844897593849, 11.753558886444523, 15.159532691905408, -118.9572713254901, -105.5428622138779, -1.5365711980433665, 26.668064871631756, -21.19029138105462, 167.5911317447596, 128.03129466265727, -174.67506900927808, -27.806943058502867, -60.095856440663454, -44.27373857607972, -130.570442557523, 44.53759795331622, -154.85579429526572, 30.57318477089633, 185.80083671592502, 25.254115608283115, -86.74321973155058, -165.14364868467453, -149.75944012077602, -244.65872855655533, -62.29728653847758, 41.55760046369484, -290.70858656634215, -157.94863853832507, -93.1394287398258, -230.4084984595345, 100.4322187126586, -89.64990253839642, -224.49657631406146, -147.39749300060092, 31.4803534248919, -152.07950634399901, -149.94843072372578, -197.69030194442252, -61.45160623493583, -23.40410376825624, -209.58777518008736, 93.11850859937775, 8.284591863684042, -191.80877066556386, 136.07493494521913, -231.51799522087683, -220.16315610085576, 105.22346603431156, -79.0372604123209, 196.1519852873995, -47.956800825208944, -299.5476331002911, -167.9984559086815, -137.1729308790483, 36.02793214177343, 9.628932215825103, -177.27461533768152, -47.146517272980134, -157.96569895447516, 47.33802643930976, -200.26548237119746, -185.0378829847856, 55.889908476039906, -223.46299529868028, -121.40680985555574, -167.37207473094563, -106.53798425826807, 172.77730440809069, -30.741612177431815, -147.0883061376906, 116.47239780344114, -101.72251181582723, 53.347167945697734, 127.00174783178699, -105.98901778008204, 123.30424675375664, -78.7186641393285, 2.0740005105987436, -47.268552271038274, -9.446644271142407, -209.51219582640962, 2.1032850897435504, 5.078866227701608, -8.612022920551993, -214.78111278413388, -37.55684656020199, 6.871507674828592, -275.2289460062544, -64.60082651772109, -249.3566138064934, 181.38785145071347, 7.241065496701072, -14.259349511495714, 5.4885358537434925, -306.2033317591641, -215.8243741092753, -159.78459631098806, -317.11611377959963, 60.30627590807924, 38.414755939390616, 67.09302350533153, -73.7615255720333, -223.9376624143084, 12.836615315746357, -82.49854919140984, -2.6505635274547155, -157.3471743128234, -230.46864899320326, -48.54606527163085, 20.000000000000014, -187.9545955860072, 54.138288933818096, 81.61401481382994, -118.56149550963744, -6.8961108295060605, -336.17618501020826, 63.68135117227919, -165.77814000327945, 0.3061126132641196, -140.68527803835863, -237.7019115972655, -269.8800390970003, -103.19687128335568, -109.25158202191562, -159.43231687877164, -327.0328221839764, -210.30361900771283, -126.10170453593419, -158.51097902784957, -164.89131784193847, -183.78924876279982, 145.11221717058157, -55.75697191920066], "policy_predator_policy_reward": [37.549092781394805, 6.601536845713264, 312.5717403637844, 240.50705248594798, 156.24044984792147, 118.03482472977441, 10.639135538784075, 55.38883607447565, 171.64423427966705, 250.58771935914785, 220.794823207916, 203.21642984526392, 187.72889771631026, 68.56327557993345, 112.04371717153323, 209.3470438666776, 105.21690317827083, 123.52197049761097, 158.48968680064516, 34.590604504258344, 124.53949699892502, 96.6425407145709, 114.48348878477927, 95.88438462129916, 351.1390697446112, 312.8428851123516, 0.8119454827363224, 26.094491525908875, 142.70835326527936, 9.698748733114098, 33.10316681638883, 204.03313783575476, 207.98518897085467, 154.54762856827438, 45.480505433003906, 120.14817964164261, 336.2263756698899, 55.439942656541305, 2.330727118899154, 265.27914220081203, 215.5906772758631, 184.40500203954025, 81.84225120567844, 174.62666752442408, 71.05388177457174, 130.01623078289018, 134.7750951166592, 56.18990458743713, 53.16648930344668, 43.0231066219577, 195.5645386374273, 241.29403043815404, 201.67444268523374, 69.80834856073156, 33.98252152886313, 53.279435505570255, 108.33437347978865, 187.16831873584528, 119.3331263478263, 22.078887296535544, 177.97650013127748, 56.62066537094646, 145.88966050343467, 137.07871274609886, 41.65779197728443, 7.518396808958049, 236.24786911292944, 212.65842636736798, 44.024408158213866, 112.76250026343628, 99.73187715547449, 195.2341318337124, 84.31334773954555, 23.56204050881107, 46.51704612266757, 2.096318170540769, 54.49438740091129, 191.26118288427668, 159.20618056510045, 139.8323499153266, 76.7237099214382, 132.1683235155923, 44.22571455454862, 243.88206589579823, 66.93115961082796, 70.1555792161795, 100.20113624457714, 90.44244858249883, 270.99669760573806, 199.915140897881, 304.6174003590265, 55.11969228350827, 286.5566527080104, 184.79495874003993, 258.23026429826575, 143.85428484751174, 124.96895234514926, 176.98621853799364, 225.5742194315528, 175.81345232201883, 102.09150560604245, 124.22866746742642, 65.86388885418691, 322.9435767799388, 210.43552404688538, 121.47140683224376, 66.38239685123594, 226.7052966406043, 57.981491400622275, 11.215408136315922, 233.4533604689734, 29.043245881168446, 234.99356868995648, 255.69850670213543, 85.85569101182604, 100.22252651317382, 45.65273282269279, 152.92032266325077, 237.4656147883656, 201.6941210532826, 149.07293087904785, 90.4227824752008, 121.4746573516416, 181.11593316514566, 208.6035011231742, 116.10354051667468, 186.50054651652277, 180.75488947983888, 140.54055691511869, 151.5959576503422, 226.9629952986802, 191.22402937396956, 143.97189820720672, 113.40082561344566, 52.896737639391226, 38.56757012994989, 20.197286029326214, 173.51862230492299, 142.66902684318643, 102.48889420058254, 10.246758599814997, 120.6890177800812, 98.21810443058936, 45.173689969152875, 91.01530002372675, 38.56738574027438, 156.91733715677825, 213.18048820582393, 39.796714910256455, 13.421133772298358, 187.55202453813922, 74.71648427134744, 140.45684656020188, 113.72849232517139, 176.1507006253517, 165.4789965587467, 128.6212018169935, 180.05963083130135, 113.56010628391338, 76.88084622026939, 288.08673320027214, 187.48628420847837, 149.59331295679, 219.43067381782922, 291.9031249980816, 169.10672890061724, 50.90941745287595, 49.32602099207508, 128.02188852320032, 206.72500824109434, 93.66338468425339, 98.09854919140895, 123.1798115562713, 92.41637384116333, 263.9205897247482, 118.79498294074158, 60.95172977170865, 183.852209865852, 62.767282020842686, 25.547110337544826, 128.36237272431813, 76.3348236038066, 233.63806583894313, 216.06543424603623, 180.85984025061995, 22.50293224846303, 234.16575773530568, 140.59949498779673, 269.8800390970003, 189.58244309029993, 142.1110517443034, 187.46371873070515, 348.20220505430353, 244.94461175149138, 182.36795642772208, 168.9109790278491, 120.23406082690478, 217.29473077323922, 27.86113865805135, 70.45697191920057]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.846986446587783, "mean_inference_ms": 6.380597565757555, "mean_action_processing_ms": 3.6902184401773424, "mean_env_wait_ms": 14.520022930402956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008659958839416504, "StateBufferConnector_ms": 0.02946305274963379, "ViewRequirementAgentConnector_ms": 0.2296280860900879}, "num_episodes": 20, "episode_return_max": 353.4607603138288, "episode_return_min": -28.386353167323772, "episode_return_mean": 130.85535136391198, "episodes_this_iter": 20}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1564480, "num_agent_steps_trained": 1564480, "num_env_steps_sampled": 391120, "num_env_steps_trained": 391120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.4647711148595, "num_env_steps_trained_throughput_per_sec": 75.4647711148595, "timesteps_total": 391120, "num_env_steps_sampled_lifetime": 391120, "num_agent_steps_sampled_lifetime": 1564480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1564480, "timers": {"training_iteration_time_ms": 58740.685, "restore_workers_time_ms": 7.368, "training_step_time_ms": 58727.941, "sample_time_ms": 4128.227, "learn_time_ms": 53504.671, "learn_throughput": 74.76, "synch_weights_time_ms": 1041.169}, "counters": {"num_env_steps_sampled": 391120, "num_env_steps_trained": 391120, "num_agent_steps_sampled": 1564480, "num_agent_steps_trained": 1564480}, "done": false, "training_iteration": 97, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-55-39", "timestamp": 1724153139, "time_this_iter_s": 53.047343015670776, "time_total_s": 5575.276276111603, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120b28790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5575.276276111603, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 48.36666666666667, "ram_util_percent": 83.22933333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.08446155679289, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.443452830793996, "policy_loss": -0.01999684678459609, "vf_loss": 6.4608628477369034, "vf_explained_var": 0.40794094318435303, "kl": 0.012934170431881236, "entropy": 0.6495970135643369, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 185745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.410827223081437, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.044609068058155, "policy_loss": -0.011555843246317218, "vf_loss": 6.054431396817404, "vf_explained_var": 0.2211424881188327, "kl": 0.008667597422997157, "entropy": 0.5946571541210962, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 185745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 395120, "num_env_steps_trained": 395120, "num_agent_steps_sampled": 1580480, "num_agent_steps_trained": 1580480}, "env_runners": {"episode_reward_max": 353.4607603138288, "episode_reward_min": -28.386353167323772, "episode_reward_mean": 128.7235621724329, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -399.0655105636003, "predator_policy": 2.096318170540769}, "policy_reward_max": {"prey_policy": 196.1519852873995, "predator_policy": 399.94917790772945}, "policy_reward_mean": {"prey_policy": -76.26294214289624, "predator_policy": 140.62472322911265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5247740090508, 118.18060853386082, 159.49999999999963, 105.9588118765553, 169.1918387900911, 212.88660031209218, 124.35788675194063, 147.87888729653457, 101.31656983176941, 80.51541801303371, 345.4000000000001, 116.54044659459636, 183.69999999999987, 70.46587544981998, 133.0068819219448, 195.01420465691245, 199.11179593856724, 211.13573098126068, 34.047852303427945, 177.78958410839735, 353.4607603138288, 129.15448070380813, 156.00874969816837, 52.78107754750224, 222.20062534540298, 150.99648186762644, 171.97889113626704, 87.241192901114, 110.4030334977599, 86.77952856640131, 72.76502269977141, 60.09581454349698, 170.5999999999995, 206.76277062979713, 39.01092407035958, 212.26442314699048, 346.7682399481341, -28.386353167323772, 138.350714616974, 134.94490739493102, 119.59482541239336, 214.32798006447385, 162.98854005671504, 73.31721951841384, -16.537335168560787, 233.5, 163.09999999999974, 196.78257717363923, 151.94850643160157, 187.9773770141705, 84.38813400356167, 151.13898526505008, 60.400000000000304, 38.875373104800985, 223.5, 1.7999246601230705, 240.71207029251485, 183.42266848938766, 174.85822150332984, -6.58498364564349, 204.2000160271781, 205.74321788967296, 37.047708777954455, 122.09999999999974, 55.59844755715738, 103.70085840065553, 76.8493440515537, 224.06669610603552, 79.23958998898084, 177.20866624705042, 37.89074510906861, -3.621936912521111, 86.38557180694423, 60.89087157432238, 55.810375614105766, 66.6662518917879, -11.151775004593528, 187.67335582863225, 334.35641943205303, 114.06789183698388, 63.983167667319044, 80.43894072490916, 3.359673252419436, 14.392311687626975, 63.57994615998411, 96.49242441752797, 219.03998852982667, 82.62497737923366, 238.28581347708575, 54.70647823965956, 122.70570794256719, 113.69999999999999, 202.23657035705867, 310.4, 61.29250186620465, -23.110390070704923, 287.9351264386895, 40.25300343512877, 36.679588422392314, 143.4229340865035], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-90.09174358765782, -65.4535949607536, -117.74130099456275, 44.956909824326786, 43.033510696553414, 20.276893378042345, -154.46391930068106, -176.43583789834503, 73.13768731200322, -175.42863976787754, 108.63769329981989, 16.986949977839416, -56.65934570830167, -114.4854597553917, 16.001189487946757, -9.53431583577305, -214.26032040642423, 80.97972473596951, -162.12640683595782, -40.32654840054187, 115.44220802271559, 180.7816031910419, 11.21864087368393, -343.5844897593849, 11.753558886444523, 15.159532691905408, -118.9572713254901, -105.5428622138779, -1.5365711980433665, 26.668064871631756, -21.19029138105462, 167.5911317447596, 128.03129466265727, -174.67506900927808, -27.806943058502867, -60.095856440663454, -44.27373857607972, -130.570442557523, 44.53759795331622, -154.85579429526572, 30.57318477089633, 185.80083671592502, 25.254115608283115, -86.74321973155058, -165.14364868467453, -149.75944012077602, -244.65872855655533, -62.29728653847758, 41.55760046369484, -290.70858656634215, -157.94863853832507, -93.1394287398258, -230.4084984595345, 100.4322187126586, -89.64990253839642, -224.49657631406146, -147.39749300060092, 31.4803534248919, -152.07950634399901, -149.94843072372578, -197.69030194442252, -61.45160623493583, -23.40410376825624, -209.58777518008736, 93.11850859937775, 8.284591863684042, -191.80877066556386, 136.07493494521913, -231.51799522087683, -220.16315610085576, 105.22346603431156, -79.0372604123209, 196.1519852873995, -47.956800825208944, -299.5476331002911, -167.9984559086815, -137.1729308790483, 36.02793214177343, 9.628932215825103, -177.27461533768152, -47.146517272980134, -157.96569895447516, 47.33802643930976, -200.26548237119746, -185.0378829847856, 55.889908476039906, -223.46299529868028, -121.40680985555574, -167.37207473094563, -106.53798425826807, 172.77730440809069, -30.741612177431815, -147.0883061376906, 116.47239780344114, -101.72251181582723, 53.347167945697734, 127.00174783178699, -105.98901778008204, 123.30424675375664, -78.7186641393285, 2.0740005105987436, -47.268552271038274, -9.446644271142407, -209.51219582640962, 2.1032850897435504, 5.078866227701608, -8.612022920551993, -214.78111278413388, -37.55684656020199, 6.871507674828592, -275.2289460062544, -64.60082651772109, -249.3566138064934, 181.38785145071347, 7.241065496701072, -14.259349511495714, 5.4885358537434925, -306.2033317591641, -215.8243741092753, -159.78459631098806, -317.11611377959963, 60.30627590807924, 38.414755939390616, 67.09302350533153, -73.7615255720333, -223.9376624143084, 12.836615315746357, -82.49854919140984, -2.6505635274547155, -157.3471743128234, -230.46864899320326, -48.54606527163085, 20.000000000000014, -187.9545955860072, 54.138288933818096, 81.61401481382994, -118.56149550963744, -6.8961108295060605, -336.17618501020826, 63.68135117227919, -165.77814000327945, 0.3061126132641196, -140.68527803835863, -237.7019115972655, -269.8800390970003, -103.19687128335568, -109.25158202191562, -159.43231687877164, -327.0328221839764, -210.30361900771283, -126.10170453593419, -158.51097902784957, -164.89131784193847, -183.78924876279982, 145.11221717058157, -55.75697191920066, 117.0866208755908, 138.26389275637504, 6.487140675242597, -183.92877360218236, 18.8763723103978, -104.57696562944514, -180.30363981639013, -154.96648251604836, -335.9079575934997, -399.0655105636003, -250.403985721704, -121.49452091709205, -111.36736161832903, 28.784258248147193, 26.416816372185163, -213.80421261307868, 87.37676976914207, -128.4568901520376, -148.4730349477323, -274.7670160470918, 52.03367192429482, -202.18728893742943, -150.07741936757054, -103.94387893981033, -42.364879196194366, -345.39127101021364, -223.95404694512212, -28.591618253571113, -52.28078810824864, 116.91824011827852, 82.25114631859601, 95.85751483369255, -174.8603355784911, -86.07353785775823, -273.3526329216374, -149.62043273436166, -138.4928899156305, 154.09231418602357, -19.90204607670527, -381.7553135565865, -61.41827895081903, 14.261248162755088, -230.0737510171766, 59.086922578326295], "policy_predator_policy_reward": [71.05388177457174, 130.01623078289018, 134.7750951166592, 56.18990458743713, 53.16648930344668, 43.0231066219577, 195.5645386374273, 241.29403043815404, 201.67444268523374, 69.80834856073156, 33.98252152886313, 53.279435505570255, 108.33437347978865, 187.16831873584528, 119.3331263478263, 22.078887296535544, 177.97650013127748, 56.62066537094646, 145.88966050343467, 137.07871274609886, 41.65779197728443, 7.518396808958049, 236.24786911292944, 212.65842636736798, 44.024408158213866, 112.76250026343628, 99.73187715547449, 195.2341318337124, 84.31334773954555, 23.56204050881107, 46.51704612266757, 2.096318170540769, 54.49438740091129, 191.26118288427668, 159.20618056510045, 139.8323499153266, 76.7237099214382, 132.1683235155923, 44.22571455454862, 243.88206589579823, 66.93115961082796, 70.1555792161795, 100.20113624457714, 90.44244858249883, 270.99669760573806, 199.915140897881, 304.6174003590265, 55.11969228350827, 286.5566527080104, 184.79495874003993, 258.23026429826575, 143.85428484751174, 124.96895234514926, 176.98621853799364, 225.5742194315528, 175.81345232201883, 102.09150560604245, 124.22866746742642, 65.86388885418691, 322.9435767799388, 210.43552404688538, 121.47140683224376, 66.38239685123594, 226.7052966406043, 57.981491400622275, 11.215408136315922, 233.4533604689734, 29.043245881168446, 234.99356868995648, 255.69850670213543, 85.85569101182604, 100.22252651317382, 45.65273282269279, 152.92032266325077, 237.4656147883656, 201.6941210532826, 149.07293087904785, 90.4227824752008, 121.4746573516416, 181.11593316514566, 208.6035011231742, 116.10354051667468, 186.50054651652277, 180.75488947983888, 140.54055691511869, 151.5959576503422, 226.9629952986802, 191.22402937396956, 143.97189820720672, 113.40082561344566, 52.896737639391226, 38.56757012994989, 20.197286029326214, 173.51862230492299, 142.66902684318643, 102.48889420058254, 10.246758599814997, 120.6890177800812, 98.21810443058936, 45.173689969152875, 91.01530002372675, 38.56738574027438, 156.91733715677825, 213.18048820582393, 39.796714910256455, 13.421133772298358, 187.55202453813922, 74.71648427134744, 140.45684656020188, 113.72849232517139, 176.1507006253517, 165.4789965587467, 128.6212018169935, 180.05963083130135, 113.56010628391338, 76.88084622026939, 288.08673320027214, 187.48628420847837, 149.59331295679, 219.43067381782922, 291.9031249980816, 169.10672890061724, 50.90941745287595, 49.32602099207508, 128.02188852320032, 206.72500824109434, 93.66338468425339, 98.09854919140895, 123.1798115562713, 92.41637384116333, 263.9205897247482, 118.79498294074158, 60.95172977170865, 183.852209865852, 62.767282020842686, 25.547110337544826, 128.36237272431813, 76.3348236038066, 233.63806583894313, 216.06543424603623, 180.85984025061995, 22.50293224846303, 234.16575773530568, 140.59949498779673, 269.8800390970003, 189.58244309029993, 142.1110517443034, 187.46371873070515, 348.20220505430353, 244.94461175149138, 182.36795642772208, 168.9109790278491, 120.23406082690478, 217.29473077323922, 27.86113865805135, 70.45697191920057, 27.265944227263187, 51.73996157282382, 65.69411530467134, 225.8154094592523, 29.827174001001396, 119.85658698536481, 159.46184766776364, 256.24721538958335, 338.3839635017901, 399.94917790772945, 251.59629740933093, 134.6945209170913, 127.30631709559177, 18.856732434573388, 36.503185983244535, 247.37663467517694, 59.96321876068461, 200.15689015203765, 195.6305999138422, 310.23442846021726, 285.5044058150766, 102.93502467514361, 202.13754927758407, 106.59022726945607, 195.78948253437693, 314.67237561459814, 229.45404694512206, 136.79161825357107, 117.75956958673598, 19.83954876029306, 74.348853681404, 57.94248516630746, 166.5080450096139, 155.71833029283945, 218.18537528364288, 181.6773003016513, 196.47285144001526, 75.86285072828112, 285.6341246169461, 156.27623845147457, 74.7980561853009, 9.038563025154739, 159.66135384147213, 154.7484086838821]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.800790807900391, "mean_inference_ms": 6.346029671214885, "mean_action_processing_ms": 4.026745987437505, "mean_env_wait_ms": 14.512697596172462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005139350891113281, "StateBufferConnector_ms": 0.02229177951812744, "ViewRequirementAgentConnector_ms": 0.19039976596832275}, "num_episodes": 22, "episode_return_max": 353.4607603138288, "episode_return_min": -28.386353167323772, "episode_return_mean": 128.7235621724329, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1580480, "num_agent_steps_trained": 1580480, "num_env_steps_sampled": 395120, "num_env_steps_trained": 395120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.32788845332315, "num_env_steps_trained_throughput_per_sec": 73.32788845332315, "timesteps_total": 395120, "num_env_steps_sampled_lifetime": 395120, "num_agent_steps_sampled_lifetime": 1580480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1580480, "timers": {"training_iteration_time_ms": 58917.055, "restore_workers_time_ms": 7.368, "training_step_time_ms": 58904.312, "sample_time_ms": 4052.36, "learn_time_ms": 53756.379, "learn_throughput": 74.41, "synch_weights_time_ms": 1041.103}, "counters": {"num_env_steps_sampled": 395120, "num_env_steps_trained": 395120, "num_agent_steps_sampled": 1580480, "num_agent_steps_trained": 1580480}, "done": false, "training_iteration": 98, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-56-34", "timestamp": 1724153194, "time_this_iter_s": 54.59822106361389, "time_total_s": 5629.874497175217, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120bcea60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5629.874497175217, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 51.65064935064935, "ram_util_percent": 83.36103896103897}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.280895571040098, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.019618270006129, "policy_loss": -0.015826476655811782, "vf_loss": 6.032964155156776, "vf_explained_var": 0.3735773893260451, "kl": 0.012402968747398407, "entropy": 0.6647596195261315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 187635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.6329081121575895, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.577123681578056, "policy_loss": -0.016165488027898526, "vf_loss": 5.591172753944599, "vf_explained_var": 0.17727021729504622, "kl": 0.010582020464747474, "entropy": 0.615111856422727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 187635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 399120, "num_env_steps_trained": 399120, "num_agent_steps_sampled": 1596480, "num_agent_steps_trained": 1596480}, "env_runners": {"episode_reward_max": 353.4607603138288, "episode_reward_min": -28.386353167323772, "episode_reward_mean": 126.16071244063832, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -399.0655105636003, "predator_policy": 5.250796506202257}, "policy_reward_max": {"prey_policy": 196.1519852873995, "predator_policy": 399.94917790772945}, "policy_reward_mean": {"prey_policy": -87.84368447938829, "predator_policy": 150.92404069970738}, "custom_metrics": {}, "hist_stats": {"episode_reward": [211.13573098126068, 34.047852303427945, 177.78958410839735, 353.4607603138288, 129.15448070380813, 156.00874969816837, 52.78107754750224, 222.20062534540298, 150.99648186762644, 171.97889113626704, 87.241192901114, 110.4030334977599, 86.77952856640131, 72.76502269977141, 60.09581454349698, 170.5999999999995, 206.76277062979713, 39.01092407035958, 212.26442314699048, 346.7682399481341, -28.386353167323772, 138.350714616974, 134.94490739493102, 119.59482541239336, 214.32798006447385, 162.98854005671504, 73.31721951841384, -16.537335168560787, 233.5, 163.09999999999974, 196.78257717363923, 151.94850643160157, 187.9773770141705, 84.38813400356167, 151.13898526505008, 60.400000000000304, 38.875373104800985, 223.5, 1.7999246601230705, 240.71207029251485, 183.42266848938766, 174.85822150332984, -6.58498364564349, 204.2000160271781, 205.74321788967296, 37.047708777954455, 122.09999999999974, 55.59844755715738, 103.70085840065553, 76.8493440515537, 224.06669610603552, 79.23958998898084, 177.20866624705042, 37.89074510906861, -3.621936912521111, 86.38557180694423, 60.89087157432238, 55.810375614105766, 66.6662518917879, -11.151775004593528, 187.67335582863225, 334.35641943205303, 114.06789183698388, 63.983167667319044, 80.43894072490916, 3.359673252419436, 14.392311687626975, 63.57994615998411, 96.49242441752797, 219.03998852982667, 82.62497737923366, 238.28581347708575, 54.70647823965956, 122.70570794256719, 113.69999999999999, 202.23657035705867, 310.4, 61.29250186620465, -23.110390070704923, 287.9351264386895, 40.25300343512877, 36.679588422392314, 143.4229340865035, 276.1507965062025, 101.00076241540233, 99.1810281568914, 184.81484400781437, 176.69999999999993, 98.16752624728889, 63.288888980398525, 240.92070460451458, 103.05293934212108, 29.172300598891894, 41.93396990973114, 130.86209995104593, 137.18093528654, 108.56397780567667, 115.60070237954571, 169.87415060524657, 175.79999999999953], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-27.806943058502867, -60.095856440663454, -44.27373857607972, -130.570442557523, 44.53759795331622, -154.85579429526572, 30.57318477089633, 185.80083671592502, 25.254115608283115, -86.74321973155058, -165.14364868467453, -149.75944012077602, -244.65872855655533, -62.29728653847758, 41.55760046369484, -290.70858656634215, -157.94863853832507, -93.1394287398258, -230.4084984595345, 100.4322187126586, -89.64990253839642, -224.49657631406146, -147.39749300060092, 31.4803534248919, -152.07950634399901, -149.94843072372578, -197.69030194442252, -61.45160623493583, -23.40410376825624, -209.58777518008736, 93.11850859937775, 8.284591863684042, -191.80877066556386, 136.07493494521913, -231.51799522087683, -220.16315610085576, 105.22346603431156, -79.0372604123209, 196.1519852873995, -47.956800825208944, -299.5476331002911, -167.9984559086815, -137.1729308790483, 36.02793214177343, 9.628932215825103, -177.27461533768152, -47.146517272980134, -157.96569895447516, 47.33802643930976, -200.26548237119746, -185.0378829847856, 55.889908476039906, -223.46299529868028, -121.40680985555574, -167.37207473094563, -106.53798425826807, 172.77730440809069, -30.741612177431815, -147.0883061376906, 116.47239780344114, -101.72251181582723, 53.347167945697734, 127.00174783178699, -105.98901778008204, 123.30424675375664, -78.7186641393285, 2.0740005105987436, -47.268552271038274, -9.446644271142407, -209.51219582640962, 2.1032850897435504, 5.078866227701608, -8.612022920551993, -214.78111278413388, -37.55684656020199, 6.871507674828592, -275.2289460062544, -64.60082651772109, -249.3566138064934, 181.38785145071347, 7.241065496701072, -14.259349511495714, 5.4885358537434925, -306.2033317591641, -215.8243741092753, -159.78459631098806, -317.11611377959963, 60.30627590807924, 38.414755939390616, 67.09302350533153, -73.7615255720333, -223.9376624143084, 12.836615315746357, -82.49854919140984, -2.6505635274547155, -157.3471743128234, -230.46864899320326, -48.54606527163085, 20.000000000000014, -187.9545955860072, 54.138288933818096, 81.61401481382994, -118.56149550963744, -6.8961108295060605, -336.17618501020826, 63.68135117227919, -165.77814000327945, 0.3061126132641196, -140.68527803835863, -237.7019115972655, -269.8800390970003, -103.19687128335568, -109.25158202191562, -159.43231687877164, -327.0328221839764, -210.30361900771283, -126.10170453593419, -158.51097902784957, -164.89131784193847, -183.78924876279982, 145.11221717058157, -55.75697191920066, 117.0866208755908, 138.26389275637504, 6.487140675242597, -183.92877360218236, 18.8763723103978, -104.57696562944514, -180.30363981639013, -154.96648251604836, -335.9079575934997, -399.0655105636003, -250.403985721704, -121.49452091709205, -111.36736161832903, 28.784258248147193, 26.416816372185163, -213.80421261307868, 87.37676976914207, -128.4568901520376, -148.4730349477323, -274.7670160470918, 52.03367192429482, -202.18728893742943, -150.07741936757054, -103.94387893981033, -42.364879196194366, -345.39127101021364, -223.95404694512212, -28.591618253571113, -52.28078810824864, 116.91824011827852, 82.25114631859601, 95.85751483369255, -174.8603355784911, -86.07353785775823, -273.3526329216374, -149.62043273436166, -138.4928899156305, 154.09231418602357, -19.90204607670527, -381.7553135565865, -61.41827895081903, 14.261248162755088, -230.0737510171766, 59.086922578326295, 176.6, -85.33397316223413, -194.1943842680425, -24.72442786608279, 9.13583195369205, -159.94178988982634, -94.5152875219776, 39.193484973142, -113.71274301894053, 15.032093038871832, -66.60519391730452, -233.64550307847284, -307.4728401952623, -24.419093966590765, -212.55369128772602, 178.4076443519704, -124.33982817681601, -120.50566411884341, -77.45347690029084, -265.23986810476595, -310.49319529285515, -143.93541906163563, 110.33566169675186, -211.93893135513193, -118.82750399942941, -87.40165267087191, -123.55299099161013, -153.51443468906186, -59.98867745903988, -277.7455992975716, 5.983717990148845, -320.229744668802, -148.5099115274959, 128.121530501638], "policy_predator_policy_reward": [159.20618056510045, 139.8323499153266, 76.7237099214382, 132.1683235155923, 44.22571455454862, 243.88206589579823, 66.93115961082796, 70.1555792161795, 100.20113624457714, 90.44244858249883, 270.99669760573806, 199.915140897881, 304.6174003590265, 55.11969228350827, 286.5566527080104, 184.79495874003993, 258.23026429826575, 143.85428484751174, 124.96895234514926, 176.98621853799364, 225.5742194315528, 175.81345232201883, 102.09150560604245, 124.22866746742642, 65.86388885418691, 322.9435767799388, 210.43552404688538, 121.47140683224376, 66.38239685123594, 226.7052966406043, 57.981491400622275, 11.215408136315922, 233.4533604689734, 29.043245881168446, 234.99356868995648, 255.69850670213543, 85.85569101182604, 100.22252651317382, 45.65273282269279, 152.92032266325077, 237.4656147883656, 201.6941210532826, 149.07293087904785, 90.4227824752008, 121.4746573516416, 181.11593316514566, 208.6035011231742, 116.10354051667468, 186.50054651652277, 180.75488947983888, 140.54055691511869, 151.5959576503422, 226.9629952986802, 191.22402937396956, 143.97189820720672, 113.40082561344566, 52.896737639391226, 38.56757012994989, 20.197286029326214, 173.51862230492299, 142.66902684318643, 102.48889420058254, 10.246758599814997, 120.6890177800812, 98.21810443058936, 45.173689969152875, 91.01530002372675, 38.56738574027438, 156.91733715677825, 213.18048820582393, 39.796714910256455, 13.421133772298358, 187.55202453813922, 74.71648427134744, 140.45684656020188, 113.72849232517139, 176.1507006253517, 165.4789965587467, 128.6212018169935, 180.05963083130135, 113.56010628391338, 76.88084622026939, 288.08673320027214, 187.48628420847837, 149.59331295679, 219.43067381782922, 291.9031249980816, 169.10672890061724, 50.90941745287595, 49.32602099207508, 128.02188852320032, 206.72500824109434, 93.66338468425339, 98.09854919140895, 123.1798115562713, 92.41637384116333, 263.9205897247482, 118.79498294074158, 60.95172977170865, 183.852209865852, 62.767282020842686, 25.547110337544826, 128.36237272431813, 76.3348236038066, 233.63806583894313, 216.06543424603623, 180.85984025061995, 22.50293224846303, 234.16575773530568, 140.59949498779673, 269.8800390970003, 189.58244309029993, 142.1110517443034, 187.46371873070515, 348.20220505430353, 244.94461175149138, 182.36795642772208, 168.9109790278491, 120.23406082690478, 217.29473077323922, 27.86113865805135, 70.45697191920057, 27.265944227263187, 51.73996157282382, 65.69411530467134, 225.8154094592523, 29.827174001001396, 119.85658698536481, 159.46184766776364, 256.24721538958335, 338.3839635017901, 399.94917790772945, 251.59629740933093, 134.6945209170913, 127.30631709559177, 18.856732434573388, 36.503185983244535, 247.37663467517694, 59.96321876068461, 200.15689015203765, 195.6305999138422, 310.23442846021726, 285.5044058150766, 102.93502467514361, 202.13754927758407, 106.59022726945607, 195.78948253437693, 314.67237561459814, 229.45404694512206, 136.79161825357107, 117.75956958673598, 19.83954876029306, 74.348853681404, 57.94248516630746, 166.5080450096139, 155.71833029283945, 218.18537528364288, 181.6773003016513, 196.47285144001526, 75.86285072828112, 285.6341246169461, 156.27623845147457, 74.7980561853009, 9.038563025154739, 159.66135384147213, 154.7484086838821, 5.250796506202257, 179.63397316223416, 265.5053755584837, 54.41419899104445, 57.02260304054015, 192.9643830524851, 156.9388283835534, 83.19781817309669, 245.09881501847585, 30.281834961592704, 150.40928984540415, 248.00893339766216, 232.11559395676755, 163.06522918548447, 166.05690757230116, 109.00984396796902, 146.30317320658293, 201.59525843119744, 264.2260283500925, 107.63961725385516, 313.3434680181508, 183.0191162460712, 5.761441534738596, 226.7039280746872, 247.92969106060266, 95.48040089623875, 86.4532403700892, 299.1781631162595, 218.0660267961717, 235.2689523399853, 216.72291322113884, 267.3972640627609, 179.7441375698454, 16.444243456011797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.773639251301496, "mean_inference_ms": 6.335887391263464, "mean_action_processing_ms": 3.8198365773498675, "mean_env_wait_ms": 14.497031988811548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021263837814331055, "StateBufferConnector_ms": 0.020790576934814453, "ViewRequirementAgentConnector_ms": 0.2021324634552002}, "num_episodes": 17, "episode_return_max": 353.4607603138288, "episode_return_min": -28.386353167323772, "episode_return_mean": 126.16071244063832, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1596480, "num_agent_steps_trained": 1596480, "num_env_steps_sampled": 399120, "num_env_steps_trained": 399120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.00084846352009, "num_env_steps_trained_throughput_per_sec": 72.00084846352009, "timesteps_total": 399120, "num_env_steps_sampled_lifetime": 399120, "num_agent_steps_sampled_lifetime": 1596480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1596480, "timers": {"training_iteration_time_ms": 59091.142, "restore_workers_time_ms": 7.368, "training_step_time_ms": 59078.402, "sample_time_ms": 4045.911, "learn_time_ms": 53937.237, "learn_throughput": 74.16, "synch_weights_time_ms": 1040.831}, "counters": {"num_env_steps_sampled": 399120, "num_env_steps_trained": 399120, "num_agent_steps_sampled": 1596480, "num_agent_steps_trained": 1596480}, "done": false, "training_iteration": 99, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-57-29", "timestamp": 1724153249, "time_this_iter_s": 55.66877317428589, "time_total_s": 5685.543270349503, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120b1ea60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5685.543270349503, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 58.54358974358975, "ram_util_percent": 83.18333333333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.173648404696632, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.164020975809248, "policy_loss": -0.01702158375933924, "vf_loss": 6.178731858036506, "vf_explained_var": 0.43121500097254595, "kl": 0.011553462228747627, "entropy": 0.6597815567223483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.521883211186323, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.414227344876244, "policy_loss": -0.01496102067373358, "vf_loss": 5.426918988505369, "vf_explained_var": 0.13215820754646623, "kl": 0.01134691613026594, "entropy": 0.6125533871865146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 403120, "num_env_steps_trained": 403120, "num_agent_steps_sampled": 1612480, "num_agent_steps_trained": 1612480}, "env_runners": {"episode_reward_max": 334.35641943205303, "episode_reward_min": -23.110390070704923, "episode_reward_mean": 123.17599318315065, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -399.0655105636003, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.59476844594326, "predator_policy": 399.94917790772945}, "policy_reward_mean": {"prey_policy": -92.45292233961597, "predator_policy": 154.04091893119121}, "custom_metrics": {}, "hist_stats": {"episode_reward": [138.350714616974, 134.94490739493102, 119.59482541239336, 214.32798006447385, 162.98854005671504, 73.31721951841384, -16.537335168560787, 233.5, 163.09999999999974, 196.78257717363923, 151.94850643160157, 187.9773770141705, 84.38813400356167, 151.13898526505008, 60.400000000000304, 38.875373104800985, 223.5, 1.7999246601230705, 240.71207029251485, 183.42266848938766, 174.85822150332984, -6.58498364564349, 204.2000160271781, 205.74321788967296, 37.047708777954455, 122.09999999999974, 55.59844755715738, 103.70085840065553, 76.8493440515537, 224.06669610603552, 79.23958998898084, 177.20866624705042, 37.89074510906861, -3.621936912521111, 86.38557180694423, 60.89087157432238, 55.810375614105766, 66.6662518917879, -11.151775004593528, 187.67335582863225, 334.35641943205303, 114.06789183698388, 63.983167667319044, 80.43894072490916, 3.359673252419436, 14.392311687626975, 63.57994615998411, 96.49242441752797, 219.03998852982667, 82.62497737923366, 238.28581347708575, 54.70647823965956, 122.70570794256719, 113.69999999999999, 202.23657035705867, 310.4, 61.29250186620465, -23.110390070704923, 287.9351264386895, 40.25300343512877, 36.679588422392314, 143.4229340865035, 276.1507965062025, 101.00076241540233, 99.1810281568914, 184.81484400781437, 176.69999999999993, 98.16752624728889, 63.288888980398525, 240.92070460451458, 103.05293934212108, 29.172300598891894, 41.93396990973114, 130.86209995104593, 137.18093528654, 108.56397780567667, 115.60070237954571, 169.87415060524657, 175.79999999999953, 32.500000000000114, 250.83168067756353, 287.40000000000003, 50.10779034040021, 52.560353000282774, 225.58747181833292, 8.383758864787072, 195.4776858550645, 258.3888711229834, 39.800000000000296, 94.61144839596172, 111.88436273317677, 169.18566990988398, 143.4893415193095, 34.09779800419919, 192.62209265279506, 93.9450532284192, 132.98944582058388, 159.29090856519645, 119.22163742423794, 73.01153516024596], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-137.1729308790483, 36.02793214177343, 9.628932215825103, -177.27461533768152, -47.146517272980134, -157.96569895447516, 47.33802643930976, -200.26548237119746, -185.0378829847856, 55.889908476039906, -223.46299529868028, -121.40680985555574, -167.37207473094563, -106.53798425826807, 172.77730440809069, -30.741612177431815, -147.0883061376906, 116.47239780344114, -101.72251181582723, 53.347167945697734, 127.00174783178699, -105.98901778008204, 123.30424675375664, -78.7186641393285, 2.0740005105987436, -47.268552271038274, -9.446644271142407, -209.51219582640962, 2.1032850897435504, 5.078866227701608, -8.612022920551993, -214.78111278413388, -37.55684656020199, 6.871507674828592, -275.2289460062544, -64.60082651772109, -249.3566138064934, 181.38785145071347, 7.241065496701072, -14.259349511495714, 5.4885358537434925, -306.2033317591641, -215.8243741092753, -159.78459631098806, -317.11611377959963, 60.30627590807924, 38.414755939390616, 67.09302350533153, -73.7615255720333, -223.9376624143084, 12.836615315746357, -82.49854919140984, -2.6505635274547155, -157.3471743128234, -230.46864899320326, -48.54606527163085, 20.000000000000014, -187.9545955860072, 54.138288933818096, 81.61401481382994, -118.56149550963744, -6.8961108295060605, -336.17618501020826, 63.68135117227919, -165.77814000327945, 0.3061126132641196, -140.68527803835863, -237.7019115972655, -269.8800390970003, -103.19687128335568, -109.25158202191562, -159.43231687877164, -327.0328221839764, -210.30361900771283, -126.10170453593419, -158.51097902784957, -164.89131784193847, -183.78924876279982, 145.11221717058157, -55.75697191920066, 117.0866208755908, 138.26389275637504, 6.487140675242597, -183.92877360218236, 18.8763723103978, -104.57696562944514, -180.30363981639013, -154.96648251604836, -335.9079575934997, -399.0655105636003, -250.403985721704, -121.49452091709205, -111.36736161832903, 28.784258248147193, 26.416816372185163, -213.80421261307868, 87.37676976914207, -128.4568901520376, -148.4730349477323, -274.7670160470918, 52.03367192429482, -202.18728893742943, -150.07741936757054, -103.94387893981033, -42.364879196194366, -345.39127101021364, -223.95404694512212, -28.591618253571113, -52.28078810824864, 116.91824011827852, 82.25114631859601, 95.85751483369255, -174.8603355784911, -86.07353785775823, -273.3526329216374, -149.62043273436166, -138.4928899156305, 154.09231418602357, -19.90204607670527, -381.7553135565865, -61.41827895081903, 14.261248162755088, -230.0737510171766, 59.086922578326295, 176.6, -85.33397316223413, -194.1943842680425, -24.72442786608279, 9.13583195369205, -159.94178988982634, -94.5152875219776, 39.193484973142, -113.71274301894053, 15.032093038871832, -66.60519391730452, -233.64550307847284, -307.4728401952623, -24.419093966590765, -212.55369128772602, 178.4076443519704, -124.33982817681601, -120.50566411884341, -77.45347690029084, -265.23986810476595, -310.49319529285515, -143.93541906163563, 110.33566169675186, -211.93893135513193, -118.82750399942941, -87.40165267087191, -123.55299099161013, -153.51443468906186, -59.98867745903988, -277.7455992975716, 5.983717990148845, -320.229744668802, -148.5099115274959, 128.121530501638, -174.0282078423977, -222.26069205015804, -389.0570699185429, 23.065832200222296, 92.02685706675199, 33.67544823802996, -259.70159783557835, -125.8730952030601, -210.3867916201841, -68.23634338583842, 101.4227168030963, -57.24769594973082, -290.11541434608506, -296.96179085433437, 60.73566989768446, -59.469886276539135, -337.9599611203984, 191.59476844594326, 20.000000000000014, 18.241031961432714, -166.65191215911517, 12.677091588745675, -16.03171969602583, -259.0090551165364, -158.82142840370665, 89.19995489569119, 102.33565553006022, -291.2542818161219, -6.229987715613412, -263.0099315422112, -213.24437222575597, 48.22672287223415, -18.38884812346439, -194.37444667833037, -389.0102070764987, -75.89908694808753, -97.40001290978398, -32.745454813708065, -110.7312510281025, -79.19420884358239, -146.74683873576043, -98.66435607689823], "policy_predator_policy_reward": [149.07293087904785, 90.4227824752008, 121.4746573516416, 181.11593316514566, 208.6035011231742, 116.10354051667468, 186.50054651652277, 180.75488947983888, 140.54055691511869, 151.5959576503422, 226.9629952986802, 191.22402937396956, 143.97189820720672, 113.40082561344566, 52.896737639391226, 38.56757012994989, 20.197286029326214, 173.51862230492299, 142.66902684318643, 102.48889420058254, 10.246758599814997, 120.6890177800812, 98.21810443058936, 45.173689969152875, 91.01530002372675, 38.56738574027438, 156.91733715677825, 213.18048820582393, 39.796714910256455, 13.421133772298358, 187.55202453813922, 74.71648427134744, 140.45684656020188, 113.72849232517139, 176.1507006253517, 165.4789965587467, 128.6212018169935, 180.05963083130135, 113.56010628391338, 76.88084622026939, 288.08673320027214, 187.48628420847837, 149.59331295679, 219.43067381782922, 291.9031249980816, 169.10672890061724, 50.90941745287595, 49.32602099207508, 128.02188852320032, 206.72500824109434, 93.66338468425339, 98.09854919140895, 123.1798115562713, 92.41637384116333, 263.9205897247482, 118.79498294074158, 60.95172977170865, 183.852209865852, 62.767282020842686, 25.547110337544826, 128.36237272431813, 76.3348236038066, 233.63806583894313, 216.06543424603623, 180.85984025061995, 22.50293224846303, 234.16575773530568, 140.59949498779673, 269.8800390970003, 189.58244309029993, 142.1110517443034, 187.46371873070515, 348.20220505430353, 244.94461175149138, 182.36795642772208, 168.9109790278491, 120.23406082690478, 217.29473077323922, 27.86113865805135, 70.45697191920057, 27.265944227263187, 51.73996157282382, 65.69411530467134, 225.8154094592523, 29.827174001001396, 119.85658698536481, 159.46184766776364, 256.24721538958335, 338.3839635017901, 399.94917790772945, 251.59629740933093, 134.6945209170913, 127.30631709559177, 18.856732434573388, 36.503185983244535, 247.37663467517694, 59.96321876068461, 200.15689015203765, 195.6305999138422, 310.23442846021726, 285.5044058150766, 102.93502467514361, 202.13754927758407, 106.59022726945607, 195.78948253437693, 314.67237561459814, 229.45404694512206, 136.79161825357107, 117.75956958673598, 19.83954876029306, 74.348853681404, 57.94248516630746, 166.5080450096139, 155.71833029283945, 218.18537528364288, 181.6773003016513, 196.47285144001526, 75.86285072828112, 285.6341246169461, 156.27623845147457, 74.7980561853009, 9.038563025154739, 159.66135384147213, 154.7484086838821, 5.250796506202257, 179.63397316223416, 265.5053755584837, 54.41419899104445, 57.02260304054015, 192.9643830524851, 156.9388283835534, 83.19781817309669, 245.09881501847585, 30.281834961592704, 150.40928984540415, 248.00893339766216, 232.11559395676755, 163.06522918548447, 166.05690757230116, 109.00984396796902, 146.30317320658293, 201.59525843119744, 264.2260283500925, 107.63961725385516, 313.3434680181508, 183.0191162460712, 5.761441534738596, 226.7039280746872, 247.92969106060266, 95.48040089623875, 86.4532403700892, 299.1781631162595, 218.0660267961717, 235.2689523399853, 216.72291322113884, 267.3972640627609, 179.7441375698454, 16.444243456011797, 196.32820784239772, 232.46069205015777, 289.9353099002157, 326.88760849566887, 74.6551580047466, 87.04253669047137, 262.15159783557993, 173.5308855434584, 238.78679162018392, 92.39669638612044, 56.411405875534996, 125.0010450894326, 296.1991732108722, 299.26179085433427, 17.959758175328794, 176.25214405859052, 149.98263175953258, 254.7714320379059, 0.0, 1.5589680385672786, 132.63654326424802, 115.94972570208284, 189.71419826216854, 197.21093928357016, 208.36572472953077, 30.441418688368632, 36.65368598924939, 295.754281816122, 41.43609518189832, 261.9016220801253, 127.15081357552415, 230.48892843079238, 164.33705898122489, 142.37128904898918, 382.14250223401217, 215.75623761115796, 194.61029422434967, 94.82608206433882, 165.1712670696813, 143.9758302262416, 206.95837389600635, 111.46435607689759]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.760369195000278, "mean_inference_ms": 6.308848198463561, "mean_action_processing_ms": 3.7943284221539115, "mean_env_wait_ms": 14.47983484742806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0208665132522583, "StateBufferConnector_ms": 0.020626425743103027, "ViewRequirementAgentConnector_ms": 0.22169911861419678}, "num_episodes": 21, "episode_return_max": 334.35641943205303, "episode_return_min": -23.110390070704923, "episode_return_mean": 123.17599318315065, "episodes_this_iter": 21}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1612480, "num_agent_steps_trained": 1612480, "num_env_steps_sampled": 403120, "num_env_steps_trained": 403120, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.19813773106608, "num_env_steps_trained_throughput_per_sec": 73.19813773106608, "timesteps_total": 403120, "num_env_steps_sampled_lifetime": 403120, "num_agent_steps_sampled_lifetime": 1612480, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1612480, "timers": {"training_iteration_time_ms": 58710.339, "restore_workers_time_ms": 7.367, "training_step_time_ms": 58697.567, "sample_time_ms": 3924.616, "learn_time_ms": 53675.518, "learn_throughput": 74.522, "synch_weights_time_ms": 1043.282}, "counters": {"num_env_steps_sampled": 403120, "num_env_steps_trained": 403120, "num_agent_steps_sampled": 1612480, "num_agent_steps_trained": 1612480}, "done": true, "training_iteration": 100, "trial_id": "2ee0d_00000", "date": "2024-08-20_16-58-24", "timestamp": 1724153304, "time_this_iter_s": 54.699195861816406, "time_total_s": 5740.242466211319, "pid": 44337, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x120b1cc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5740.242466211319, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 54.51558441558443, "ram_util_percent": 83.33116883116882}}
